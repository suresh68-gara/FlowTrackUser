{"ast":null,"code":"/** @license\n\ndhtmlxGantt v.9.0.15 Standard\n\nThis version of dhtmlxGantt is distributed under GPL 2.0 license and can be legally used in GPL projects.\n\nTo use dhtmlxGantt in non-GPL projects (and get Pro version of the product), please obtain Individual, Commercial, Enterprise or Ultimate license on our site https://dhtmlx.com/docs/products/dhtmlxGantt/#licensing or contact us at info@dhtmlx.com\n\n(c) XB Software\n\n*/\nfunction V(t) {\n  var e = 0,\n    n = 0,\n    i = 0,\n    a = 0;\n  if (t.getBoundingClientRect) {\n    var r = t.getBoundingClientRect(),\n      s = document.body,\n      o = document.documentElement || document.body.parentNode || document.body,\n      l = window.pageYOffset || o.scrollTop || s.scrollTop,\n      c = window.pageXOffset || o.scrollLeft || s.scrollLeft,\n      d = o.clientTop || s.clientTop || 0,\n      u = o.clientLeft || s.clientLeft || 0;\n    e = r.top + l - d, n = r.left + c - u, i = document.body.offsetWidth - r.right, a = document.body.offsetHeight - r.bottom;\n  } else {\n    for (; t;) e += parseInt(t.offsetTop, 10), n += parseInt(t.offsetLeft, 10), t = t.offsetParent;\n    i = document.body.offsetWidth - t.offsetWidth - n, a = document.body.offsetHeight - t.offsetHeight - e;\n  }\n  return {\n    y: Math.round(e),\n    x: Math.round(n),\n    width: t.offsetWidth,\n    height: t.offsetHeight,\n    right: Math.round(i),\n    bottom: Math.round(a)\n  };\n}\nfunction Dn(t) {\n  var e = !1,\n    n = !1;\n  if (window.getComputedStyle) {\n    var i = window.getComputedStyle(t, null);\n    e = i.display, n = i.visibility;\n  } else t.currentStyle && (e = t.currentStyle.display, n = t.currentStyle.visibility);\n  return e != \"none\" && n != \"hidden\";\n}\nfunction An(t) {\n  return !isNaN(t.getAttribute(\"tabindex\")) && 1 * t.getAttribute(\"tabindex\") >= 0;\n}\nfunction In(t) {\n  return !{\n    a: !0,\n    area: !0\n  }[t.nodeName.loLowerCase()] || !!t.getAttribute(\"href\");\n}\nfunction Mn(t) {\n  return !{\n    input: !0,\n    select: !0,\n    textarea: !0,\n    button: !0,\n    object: !0\n  }[t.nodeName.toLowerCase()] || !t.hasAttribute(\"disabled\");\n}\nfunction Lt(t) {\n  for (var e = t.querySelectorAll([\"a[href]\", \"area[href]\", \"input\", \"select\", \"textarea\", \"button\", \"iframe\", \"object\", \"embed\", \"[tabindex]\", \"[contenteditable]\"].join(\", \")), n = Array.prototype.slice.call(e, 0), i = 0; i < n.length; i++) n[i].$position = i;\n  for (n.sort(function (r, s) {\n    return r.tabIndex === 0 && s.tabIndex !== 0 ? 1 : r.tabIndex !== 0 && s.tabIndex === 0 ? -1 : r.tabIndex === s.tabIndex ? r.$position - s.$position : r.tabIndex < s.tabIndex ? -1 : 1;\n  }), i = 0; i < n.length; i++) {\n    var a = n[i];\n    (An(a) || Mn(a) || In(a)) && Dn(a) || (n.splice(i, 1), i--);\n  }\n  return n;\n}\nfunction Xe() {\n  var t = document.createElement(\"div\");\n  t.style.cssText = \"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\", document.body.appendChild(t);\n  var e = t.offsetWidth - t.clientWidth;\n  return document.body.removeChild(t), Math.max(e, 15);\n}\nfunction X(t) {\n  if (!t) return \"\";\n  var e = t.className || \"\";\n  return e.baseVal && (e = e.baseVal), e.indexOf || (e = \"\"), _e(e);\n}\nfunction wt(t, e) {\n  e && t.className.indexOf(e) === -1 && (t.className += \" \" + e);\n}\nfunction Gt(t, e) {\n  e = e.split(\" \");\n  for (var n = 0; n < e.length; n++) {\n    var i = new RegExp(\"\\\\s?\\\\b\" + e[n] + \"\\\\b(?![-_.])\", \"\");\n    t.className = t.className.replace(i, \"\");\n  }\n}\nfunction we(t) {\n  return typeof t == \"string\" ? document.getElementById(t) || document.querySelector(t) || document.body : t || document.body;\n}\nvar Bt;\nfunction Ze(t, e) {\n  Bt || (Bt = document.createElement(\"div\")), Bt.innerHTML = e;\n  var n = Bt.firstChild;\n  return t.appendChild(n), n;\n}\nfunction Qe(t) {\n  t && t.parentNode && t.parentNode.removeChild(t);\n}\nfunction tn(t, e) {\n  for (var n = t.childNodes, i = n.length, a = [], r = 0; r < i; r++) {\n    var s = n[r];\n    s.className && s.className.indexOf(e) !== -1 && a.push(s);\n  }\n  return a;\n}\nfunction yt(t) {\n  var e;\n  return t.tagName ? e = t : (e = (t = t || window.event).target || t.srcElement).shadowRoot && t.composedPath && (e = t.composedPath()[0]), e;\n}\nfunction nt(t, e) {\n  if (e) {\n    for (var n = yt(t); n;) {\n      if (n.getAttribute && n.getAttribute(e)) return n;\n      n = n.parentNode || n.host;\n    }\n    return null;\n  }\n}\nfunction _e(t) {\n  return (String.prototype.trim || function () {\n    return this.replace(/^\\s+|\\s+$/g, \"\");\n  }).apply(t);\n}\nfunction pt(t, e, n) {\n  var i = yt(t),\n    a = \"\";\n  for (n === void 0 && (n = !0); i;) {\n    if (a = X(i)) {\n      var r = a.indexOf(e);\n      if (r >= 0) {\n        if (!n) return i;\n        var s = r === 0 || !_e(a.charAt(r - 1)),\n          o = r + e.length >= a.length || !_e(a.charAt(r + e.length));\n        if (s && o) return i;\n      }\n    }\n    i = i.parentNode;\n  }\n  return null;\n}\nfunction rt(t, e) {\n  var s;\n  const n = document.documentElement,\n    i = V(e),\n    {\n      clientX: a,\n      clientY: r\n    } = ((s = t.touches) == null ? void 0 : s[0]) ?? t;\n  return {\n    x: a + n.scrollLeft - n.clientLeft - i.x + e.scrollLeft,\n    y: r + n.scrollTop - n.clientTop - i.y + e.scrollTop\n  };\n}\nfunction en(t, e) {\n  const n = V(t),\n    i = V(e);\n  return {\n    x: n.x - i.x,\n    y: n.y - i.y\n  };\n}\nfunction Y(t, e) {\n  if (!t || !e) return !1;\n  for (; t && t != e;) t = t.parentNode;\n  return t === e;\n}\nfunction dt(t, e) {\n  if (t.closest) return t.closest(e);\n  if (t.matches || t.msMatchesSelector || t.webkitMatchesSelector) {\n    var n = t;\n    if (!document.documentElement.contains(n)) return null;\n    do {\n      if ((n.matches || n.msMatchesSelector || n.webkitMatchesSelector).call(n, e)) return n;\n      n = n.parentElement || n.parentNode;\n    } while (n !== null && n.nodeType === 1);\n    return null;\n  }\n  return console.error(\"Your browser is not supported\"), null;\n}\nfunction nn(t) {\n  for (; t;) {\n    if (t.offsetWidth > 0 && t.offsetHeight > 0) return t;\n    t = t.parentElement;\n  }\n  return null;\n}\nfunction an() {\n  return document.head.createShadowRoot || document.head.attachShadow;\n}\nfunction ge() {\n  var t = document.activeElement;\n  return t.shadowRoot && (t = t.shadowRoot.activeElement), t === document.body && document.getSelection && (t = document.getSelection().focusNode || document.body), t;\n}\nfunction vt(t) {\n  if (!t || !an()) return document.body;\n  for (; t.parentNode && (t = t.parentNode);) if (t instanceof ShadowRoot) return t.host;\n  return document.body;\n}\nconst rn = Object.freeze(Object.defineProperty({\n    __proto__: null,\n    addClassName: wt,\n    closest: dt,\n    getActiveElement: ge,\n    getChildNodes: tn,\n    getClassName: X,\n    getClosestSizedElement: nn,\n    getFocusableNodes: Lt,\n    getNodePosition: V,\n    getRelativeEventPosition: rt,\n    getRelativeNodePosition: en,\n    getRootNode: vt,\n    getScrollSize: Xe,\n    getTargetNode: yt,\n    hasClass: function (t, e) {\n      return \"classList\" in t ? t.classList.contains(e) : new RegExp(\"\\\\b\" + e + \"\\\\b\").test(t.className);\n    },\n    hasShadowParent: function (t) {\n      return !!vt(t);\n    },\n    insertNode: Ze,\n    isChildOf: Y,\n    isShadowDomSupported: an,\n    locateAttribute: nt,\n    locateClassName: pt,\n    removeClassName: Gt,\n    removeNode: Qe,\n    toNode: we\n  }, Symbol.toStringTag, {\n    value: \"Module\"\n  })),\n  Z = typeof window < \"u\" ? window : global;\nlet Nn = class {\n  constructor(t) {\n    this._mouseDown = !1, this._touchStarts = !1, this._touchActive = !1, this._longTapTimer = !1, this._gantt = t, this._domEvents = t._createDomEventScope();\n  }\n  attach(t, e, n) {\n    const i = this._gantt,\n      a = t.getViewPort();\n    this._originPosition = Z.getComputedStyle(a).display, this._restoreOriginPosition = () => {\n      a.style.position = this._originPosition;\n    }, this._originPosition === \"static\" && (a.style.position = \"relative\");\n    const r = i.$services.getService(\"state\");\n    r.registerProvider(\"clickDrag\", () => ({\n      autoscroll: !1\n    }));\n    let s = null;\n    const o = () => {\n      s && (this._mouseDown = !0, t.setStart(i.copy(s)), t.setPosition(i.copy(s)), t.setEnd(i.copy(s)), s = null);\n    };\n    this._domEvents.attach(a, \"mousedown\", p => {\n      u(p);\n    });\n    const l = vt(i.$root) || document.body;\n    function c(p) {\n      return p.changedTouches && p.changedTouches[0] || p;\n    }\n    this._domEvents.attach(l, \"mouseup\", p => {\n      h(p);\n    }), this._domEvents.attach(a, \"mousemove\", p => {\n      _(p);\n    }), this._domEvents.attach(a, \"touchstart\", p => {\n      this._touchStarts = !0, this._longTapTimer = setTimeout(() => {\n        this._touchStarts && (u(c(p)), this._touchStarts = !1, this._touchActive = !0);\n      }, this._gantt.config.touch_drag);\n    }), this._domEvents.attach(l, \"touchend\", p => {\n      this._touchStarts = !1, this._touchActive = !1, clearTimeout(this._longTapTimer), h(c(p));\n    }), this._domEvents.attach(a, \"touchmove\", p => {\n      if (this._touchActive) {\n        let y = d();\n        if (y && i.utils.dom.closest(p.target, y)) return;\n        _(c(p)), p.preventDefault();\n      } else this._touchStarts = !1, clearTimeout(this._longTapTimer);\n    });\n    const d = () => {\n        let p = \".gantt_task_line, .gantt_task_link\";\n        return n !== void 0 && (p = n instanceof Array ? n.join(\", \") : n), p;\n      },\n      u = p => {\n        s = null;\n        let y = d();\n        y && i.utils.dom.closest(p.target, y) || (r.registerProvider(\"clickDrag\", () => ({\n          autoscroll: this._mouseDown\n        })), e && p[e] !== !0 || (s = this._getCoordinates(p, t)));\n      },\n      h = p => {\n        if (s = null, (!e || p[e] === !0) && this._mouseDown === !0) {\n          this._mouseDown = !1;\n          const y = this._getCoordinates(p, t);\n          t.dragEnd(y);\n        }\n      },\n      _ = p => {\n        if (e && p[e] !== !0) return;\n        const y = this._gantt.ext.clickDrag,\n          k = (this._gantt.config.drag_timeline || {}).useKey;\n        if (y && k && !e && p[k]) return;\n        let b = null;\n        if (!this._mouseDown && s) return b = this._getCoordinates(p, t), void (Math.abs(s.relative.left - b.relative.left) > 5 && o());\n        this._mouseDown === !0 && (b = this._getCoordinates(p, t), t.setEnd(b), t.render());\n      };\n  }\n  detach() {\n    const t = this._gantt;\n    this._domEvents.detachAll(), this._restoreOriginPosition && this._restoreOriginPosition(), t.$services.getService(\"state\").unregisterProvider(\"clickDrag\");\n  }\n  destructor() {\n    this.detach();\n  }\n  _getCoordinates(t, e) {\n    const n = e.getViewPort(),\n      i = n.getBoundingClientRect(),\n      {\n        clientX: a,\n        clientY: r\n      } = t;\n    return {\n      absolute: {\n        left: a,\n        top: r\n      },\n      relative: {\n        left: a - i.left + n.scrollLeft,\n        top: r - i.top + n.scrollTop\n      }\n    };\n  }\n};\nvar sn = function () {\n  this._silent_mode = !1, this.listeners = {};\n};\nsn.prototype = {\n  _silentStart: function () {\n    this._silent_mode = !0;\n  },\n  _silentEnd: function () {\n    this._silent_mode = !1;\n  }\n};\nfunction ot(t) {\n  var e = new sn();\n  t.attachEvent = function (n, i, a) {\n    n = \"ev_\" + n.toLowerCase(), e.listeners[n] || (e.listeners[n] = function (s) {\n      var o = {},\n        l = 0,\n        c = function () {\n          var d = !0;\n          for (var u in o) {\n            var h = o[u].apply(s, arguments);\n            d = d && h;\n          }\n          return d;\n        };\n      return c.addEvent = function (d, u) {\n        if (typeof d == \"function\") {\n          var h;\n          if (u && u.id ? h = u.id : (h = l, l++), u && u.once) {\n            var _ = d;\n            d = function () {\n              _(), c.removeEvent(h);\n            };\n          }\n          return o[h] = d, h;\n        }\n        return !1;\n      }, c.removeEvent = function (d) {\n        delete o[d];\n      }, c.clear = function () {\n        o = {};\n      }, c;\n    }(this)), a && a.thisObject && (i = i.bind(a.thisObject));\n    var r = n + \":\" + e.listeners[n].addEvent(i, a);\n    return a && a.id && (r = a.id), r;\n  }, t.attachAll = function (n) {\n    this.attachEvent(\"listen_all\", n);\n  }, t.callEvent = function (n, i) {\n    if (e._silent_mode) return !0;\n    var a = \"ev_\" + n.toLowerCase(),\n      r = e.listeners;\n    return r.ev_listen_all && r.ev_listen_all.apply(this, [n].concat(i)), !r[a] || r[a].apply(this, i);\n  }, t.checkEvent = function (n) {\n    return !!e.listeners[\"ev_\" + n.toLowerCase()];\n  }, t.detachEvent = function (n) {\n    if (n) {\n      var i = e.listeners;\n      for (var a in i) i[a].removeEvent(n);\n      var r = n.split(\":\");\n      if (i = e.listeners, r.length === 2) {\n        var s = r[0],\n          o = r[1];\n        i[s] && i[s].removeEvent(o);\n      }\n    }\n  }, t.detachAllEvents = function () {\n    for (var n in e.listeners) e.listeners[n].clear();\n  };\n}\nvar Ce = {\n  second: 1,\n  minute: 60,\n  hour: 3600,\n  day: 86400,\n  week: 604800,\n  month: 2592e3,\n  quarter: 7776e3,\n  year: 31536e3\n};\nfunction Vt(t) {\n  return Ce[t] || Ce.hour;\n}\nfunction kt(t, e) {\n  if (t.forEach) t.forEach(e);else for (var n = t.slice(), i = 0; i < n.length; i++) e(n[i], i);\n}\nfunction Ln(t, e) {\n  if (t.find) return t.find(e);\n  for (var n = 0; n < t.length; n++) if (e(t[n], n)) return t[n];\n}\nfunction zt(t, e) {\n  if (t.includes) return t.includes(e);\n  for (var n = 0; n < t.length; n++) if (t[n] === e) return !0;\n  return !1;\n}\nfunction fe(t) {\n  return Array.isArray ? Array.isArray(t) : t && t.length !== void 0 && t.pop && t.push;\n}\nfunction Q(t) {\n  return !(!t || typeof t != \"object\") && !!(t.getFullYear && t.getMonth && t.getDate);\n}\nfunction bt(t) {\n  return Q(t) && !isNaN(t.getTime());\n}\nfunction De(t, e) {\n  var n,\n    i = function () {\n      i.$cancelTimeout(), i.$pending = !0;\n      var a = Array.prototype.slice.call(arguments);\n      n = setTimeout(function () {\n        t.apply(this, a), i.$pending = !1;\n      }, e);\n    };\n  return i.$pending = !1, i.$cancelTimeout = function () {\n    clearTimeout(n), i.$pending = !1;\n  }, i.$execute = function () {\n    var a = Array.prototype.slice.call(arguments);\n    t.apply(this, a), i.$cancelTimeout();\n  }, i;\n}\nfunction at(t, e) {\n  return Ae(t) && !Ae(e) && (t = \"0\"), t;\n}\nfunction Ae(t) {\n  return t === 0;\n}\nfunction At(t, e) {\n  for (var n, i, a, r = 0, s = t.length - 1; r <= s;) if (i = +t[n = Math.floor((r + s) / 2)], a = +t[n - 1], i < e) r = n + 1;else {\n    if (!(i > e)) {\n      for (; +t[n] == +t[n + 1];) n++;\n      return n;\n    }\n    if (!isNaN(a) && a < e) return n - 1;\n    s = n - 1;\n  }\n  return t.length - 1;\n}\nclass Pn {\n  constructor(e, n, i) {\n    var a;\n    this._el = document.createElement(\"div\"), this.defaultRender = (r, s) => {\n      this._el || (this._el = document.createElement(\"div\"));\n      const o = this._el,\n        l = Math.min(r.relative.top, s.relative.top),\n        c = Math.max(r.relative.top, s.relative.top),\n        d = Math.min(r.relative.left, s.relative.left),\n        u = Math.max(r.relative.left, s.relative.left);\n      if (this._singleRow) {\n        const h = this._getTaskPositionByTop(this._startPoint.relative.top);\n        o.style.height = h.height + \"px\", o.style.top = h.top + \"px\";\n      } else o.style.height = Math.abs(c - l) + \"px\", o.style.top = l + \"px\";\n      return o.style.width = Math.abs(u - d) + \"px\", o.style.left = d + \"px\", o;\n    }, this._gantt = n, this._view = i, this._viewPort = e.viewPort, this._el.classList.add(e.className), typeof e.callback == \"function\" && (this._callback = e.callback), this.render = () => {\n      let r;\n      r = e.render ? e.render(this._startPoint, this._endPoint) : this.defaultRender(this._startPoint, this._endPoint), r !== this._el && (this._el && this._el.parentNode && this._el.parentNode.removeChild(this._el), this._el = r), e.className !== \"\" && this._el.classList.add(e.className), this.draw();\n    }, (a = this._viewPort).attachEvent && a.detachEvent || ot(this._viewPort), this._singleRow = e.singleRow, this._useRequestAnimationFrame = e.useRequestAnimationFrame;\n  }\n  draw() {\n    if (this._useRequestAnimationFrame) return requestAnimationFrame(() => {\n      this._viewPort.appendChild(this.getElement());\n    });\n    this._viewPort.appendChild(this.getElement());\n  }\n  clear() {\n    if (this._useRequestAnimationFrame) return requestAnimationFrame(() => {\n      this._el.parentNode && this._viewPort.removeChild(this._el);\n    });\n    this._el.parentNode && this._viewPort.removeChild(this._el);\n  }\n  getElement() {\n    return this._el;\n  }\n  getViewPort() {\n    return this._viewPort;\n  }\n  setStart(e) {\n    const n = this._gantt;\n    this._startPoint = e, this._startDate = n.dateFromPos(this._startPoint.relative.left), this._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\n  }\n  setEnd(e) {\n    const n = this._gantt;\n    if (this._endPoint = e, this._singleRow) {\n      const i = this._getTaskPositionByTop(this._startPoint.relative.top);\n      this._endPoint.relative.top = i.top;\n    }\n    this._endDate = n.dateFromPos(this._endPoint.relative.left), this._startPoint.relative.left > this._endPoint.relative.left && (this._positionPoint = {\n      relative: {\n        left: this._endPoint.relative.left,\n        top: this._positionPoint.relative.top\n      },\n      absolute: {\n        left: this._endPoint.absolute.left,\n        top: this._positionPoint.absolute.top\n      }\n    }), this._startPoint.relative.top > this._endPoint.relative.top && (this._positionPoint = {\n      relative: {\n        left: this._positionPoint.relative.left,\n        top: this._endPoint.relative.top\n      },\n      absolute: {\n        left: this._positionPoint.absolute.left,\n        top: this._endPoint.absolute.top\n      }\n    }), this._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\n  }\n  setPosition(e) {\n    this._positionPoint = e;\n  }\n  dragEnd(e) {\n    const n = this._gantt;\n    e.relative.left < 0 && (e.relative.left = 0), this._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, e]), this.setEnd(e), this._endDate = this._endDate || n.getState().max_date, this._startDate.valueOf() > this._endDate.valueOf() && ([this._startDate, this._endDate] = [this._endDate, this._startDate]), this.clear();\n    const i = n.getTaskByTime(this._startDate, this._endDate),\n      a = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\n    this._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]), this._callback && this._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, i, a);\n  }\n  getInBounds() {\n    return this._singleRow;\n  }\n  _getTasksByTop(e, n) {\n    const i = this._gantt;\n    let a = e,\n      r = n;\n    e > n && (a = n, r = e);\n    const s = this._getTaskPositionByTop(a).index,\n      o = this._getTaskPositionByTop(r).index,\n      l = [];\n    for (let c = s; c <= o; c++) i.getTaskByIndex(c) && l.push(i.getTaskByIndex(c));\n    return l;\n  }\n  _getTaskPositionByTop(e) {\n    const n = this._gantt,\n      i = this._view,\n      a = i.getItemIndexByTopPosition(e),\n      r = n.getTaskByIndex(a);\n    if (r) {\n      const s = i.getItemHeight(r.id);\n      return {\n        top: i.getItemTop(r.id) || 0,\n        height: s || 0,\n        index: a\n      };\n    }\n    {\n      const s = i.getTotalHeight();\n      return {\n        top: e > s ? s : 0,\n        height: n.config.row_height,\n        index: e > s ? n.getTaskCount() : 0\n      };\n    }\n  }\n}\nlet te = !1;\nclass Yt {\n  constructor(e) {\n    this._mouseDown = !1, this._calculateDirectionVector = () => {\n      if (this._trace.length >= 10) {\n        const n = this._trace.slice(this._trace.length - 10),\n          i = [];\n        for (let r = 1; r < n.length; r++) i.push({\n          x: n[r].x - n[r - 1].x,\n          y: n[r].y - n[r - 1].y\n        });\n        const a = {\n          x: 0,\n          y: 0\n        };\n        return i.forEach(r => {\n          a.x += r.x, a.y += r.y;\n        }), {\n          magnitude: Math.sqrt(a.x * a.x + a.y * a.y),\n          angleDegrees: 180 * Math.atan2(Math.abs(a.y), Math.abs(a.x)) / Math.PI\n        };\n      }\n      return null;\n    }, this._applyDndReadyStyles = () => {\n      this._timeline.$task.classList.add(\"gantt_timeline_move_available\");\n    }, this._clearDndReadyStyles = () => {\n      this._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\n    }, this._getScrollPosition = n => {\n      const i = this._gantt;\n      return {\n        x: i.$ui.getView(n.$config.scrollX).getScrollState().position,\n        y: i.$ui.getView(n.$config.scrollY).getScrollState().position\n      };\n    }, this._countNewScrollPosition = n => {\n      const i = this._calculateDirectionVector();\n      let a = this._startPoint.x - n.x,\n        r = this._startPoint.y - n.y;\n      return i && (i.angleDegrees < 15 ? r = 0 : i.angleDegrees > 75 && (a = 0)), {\n        x: this._scrollState.x + a,\n        y: this._scrollState.y + r\n      };\n    }, this._setScrollPosition = (n, i) => {\n      const a = this._gantt;\n      requestAnimationFrame(() => {\n        a.scrollLayoutCell(n.$id, i.x, i.y);\n      });\n    }, this._stopDrag = n => {\n      const i = this._gantt;\n      if (this._trace = [], i.$root.classList.remove(\"gantt_noselect\"), this._originalReadonly !== void 0 && this._mouseDown && (i.config.readonly = this._originalReadonly, i.config.drag_timeline && i.config.drag_timeline.render && i.render()), this._originAutoscroll !== void 0 && (i.config.autoscroll = this._originAutoscroll), i.config.drag_timeline) {\n        const {\n          useKey: a\n        } = i.config.drag_timeline;\n        if (a && n[a] !== !0) return;\n      }\n      this._mouseDown = !1, te = !1;\n    }, this._startDrag = n => {\n      const i = this._gantt;\n      this._originAutoscroll = i.config.autoscroll, i.config.autoscroll = !1, te = !0, i.$root.classList.add(\"gantt_noselect\"), this._originalReadonly = i.config.readonly, i.config.readonly = !0, i.config.drag_timeline && i.config.drag_timeline.render && i.render(), this._trace = [], this._mouseDown = !0;\n      const {\n        x: a,\n        y: r\n      } = this._getScrollPosition(this._timeline);\n      this._scrollState = {\n        x: a,\n        y: r\n      }, this._startPoint = {\n        x: n.clientX,\n        y: n.clientY\n      }, this._trace.push(this._startPoint);\n    }, this._gantt = e, this._domEvents = e._createDomEventScope(), this._trace = [];\n  }\n  static create(e) {\n    return new Yt(e);\n  }\n  static _isDragInProgress() {\n    return te;\n  }\n  destructor() {\n    this._domEvents.detachAll();\n  }\n  attach(e) {\n    this._timeline = e;\n    const n = this._gantt;\n    this._domEvents.attach(e.$task, \"mousedown\", i => {\n      if (!n.config.drag_timeline) return;\n      const {\n        useKey: a,\n        ignore: r,\n        enabled: s\n      } = n.config.drag_timeline;\n      if (s === !1) return;\n      let o = \".gantt_task_line, .gantt_task_link\";\n      r !== void 0 && (o = r instanceof Array ? r.join(\", \") : r), o && n.utils.dom.closest(i.target, o) || a && i[a] !== !0 || this._startDrag(i);\n    }), this._domEvents.attach(document, \"keydown\", i => {\n      if (!n.config.drag_timeline) return;\n      const {\n        useKey: a\n      } = n.config.drag_timeline;\n      a && i[a] === !0 && this._applyDndReadyStyles();\n    }), this._domEvents.attach(document, \"keyup\", i => {\n      if (!n.config.drag_timeline) return;\n      const {\n        useKey: a\n      } = n.config.drag_timeline;\n      a && i[a] === !1 && (this._clearDndReadyStyles(), this._stopDrag(i));\n    }), this._domEvents.attach(document, \"mouseup\", i => {\n      this._stopDrag(i);\n    }), this._domEvents.attach(n.$root, \"mouseup\", i => {\n      this._stopDrag(i);\n    }), this._domEvents.attach(document, \"mouseleave\", i => {\n      this._stopDrag(i);\n    }), this._domEvents.attach(n.$root, \"mouseleave\", i => {\n      this._stopDrag(i);\n    }), this._domEvents.attach(n.$root, \"mousemove\", i => {\n      if (!n.config.drag_timeline) return;\n      const {\n        useKey: a\n      } = n.config.drag_timeline;\n      if (a && i[a] !== !0) return;\n      const r = this._gantt.ext.clickDrag,\n        s = (this._gantt.config.click_drag || {}).useKey;\n      if ((!r || !s || a || !i[s]) && this._mouseDown === !0) {\n        this._trace.push({\n          x: i.clientX,\n          y: i.clientY\n        });\n        const o = this._countNewScrollPosition({\n          x: i.clientX,\n          y: i.clientY\n        });\n        this._setScrollPosition(e, o), this._scrollState = o, this._startPoint = {\n          x: i.clientX,\n          y: i.clientY\n        };\n      }\n    });\n  }\n}\nfunction Rn(t) {\n  (function () {\n    var e = [];\n    function n() {\n      return !!e.length;\n    }\n    function i(c) {\n      setTimeout(function () {\n        n() || t.$destroyed || t.focus();\n      }, 1);\n    }\n    function a(c) {\n      t.eventRemove(c, \"keydown\", s), t.event(c, \"keydown\", s), e.push(c);\n    }\n    function r() {\n      var c = e.pop();\n      c && t.eventRemove(c, \"keydown\", s), i();\n    }\n    function s(c) {\n      var d = c.currentTarget;\n      d == e[e.length - 1] && t.$keyboardNavigation.trapFocus(d, c);\n    }\n    function o() {\n      a(t.getLightbox());\n    }\n    t.attachEvent(\"onLightbox\", o), t.attachEvent(\"onAfterLightbox\", r), t.attachEvent(\"onLightboxChange\", function () {\n      r(), o();\n    }), t.attachEvent(\"onAfterQuickInfo\", function () {\n      i();\n    }), t.attachEvent(\"onMessagePopup\", function (c) {\n      l = t.utils.dom.getActiveElement(), a(c);\n    }), t.attachEvent(\"onAfterMessagePopup\", function () {\n      r(), setTimeout(function () {\n        l && l.focus && (l.focus(), l = null);\n      }, 1);\n    });\n    var l = null;\n    t.$keyboardNavigation.isModal = n;\n  })();\n}\nclass Hn {\n  constructor(e) {\n    this.show = (n, i) => {\n      i === void 0 ? this._showForTask(n) : this._showAtCoordinates(n, i);\n    }, this.hide = n => {\n      const i = this._gantt,\n        a = this._quickInfoBox;\n      this._quickInfoBoxId = 0;\n      const r = this._quickInfoTask;\n      if (this._quickInfoTask = null, a && a.parentNode) {\n        if (i.config.quick_info_detached) return i.callEvent(\"onAfterQuickInfo\", [r]), a.parentNode.removeChild(a);\n        a.className += \" gantt_qi_hidden\", a.style.right === \"auto\" ? a.style.left = \"-350px\" : a.style.right = \"-350px\", n && (a.style.left = a.style.right = \"\", a.parentNode.removeChild(a)), i.callEvent(\"onAfterQuickInfo\", [r]);\n      }\n    }, this.getNode = () => this._quickInfoBox ? this._quickInfoBox : null, this.setContainer = n => {\n      n && (this._container = typeof n == \"string\" ? document.getElementById(n) : n);\n    }, this.setContent = n => {\n      const i = this._gantt,\n        a = {\n          taskId: null,\n          header: {\n            title: \"\",\n            date: \"\"\n          },\n          content: \"\",\n          buttons: i.config.quickinfo_buttons\n        };\n      n || (n = a), n.taskId || (n.taskId = a.taskId), n.header || (n.header = a.header), n.header.title || (n.header.title = a.header.title), n.header.date || (n.header.date = a.header.date), n.content || (n.content = a.content), n.buttons || (n.buttons = a.buttons);\n      let r = this.getNode();\n      r || (r = this._createQuickInfoElement()), n.taskId && (this._quickInfoBoxId = n.taskId);\n      const s = r.querySelector(\".gantt_cal_qi_title\"),\n        o = s.querySelector(\".gantt_cal_qi_tcontent\"),\n        l = s.querySelector(\".gantt_cal_qi_tdate\"),\n        c = r.querySelector(\".gantt_cal_qi_content\"),\n        d = r.querySelector(\".gantt_cal_qi_controls\");\n      i._waiAria.quickInfoHeader(r, [n.header.title, n.header.date].join(\" \")), o.innerHTML = n.header.title, l.innerHTML = n.header.date, n.header.title || n.header.date ? s.style.display = \"\" : s.style.display = \"none\", c.innerHTML = n.content;\n      const u = n.buttons;\n      u.length ? d.style.display = \"\" : d.style.display = \"none\";\n      let h = \"\";\n      for (let _ = 0; _ < u.length; _++) {\n        const p = i._waiAria.quickInfoButtonAttrString(i.locale.labels[u[_]]);\n        h += `<div class=\"gantt_qi_big_icon ${u[_]} dhx_gantt_${u[_]}\" title=\"${i.locale.labels[u[_]]}\" ${p}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${u[_]} gantt_menu_icon dhx_gantt_${u[_]}'></div>\n            <div>${i.locale.labels[u[_]]}</div>\n         </div>`;\n      }\n      d.innerHTML = h, i.eventRemove(r, \"click\", this._qiButtonClickHandler), i.eventRemove(r, \"keypress\", this._qiKeyPressHandler), i.event(r, \"click\", this._qiButtonClickHandler), i.event(r, \"keypress\", this._qiKeyPressHandler);\n    }, this._qiButtonClickHandler = n => {\n      this._qi_button_click(n.target);\n    }, this._qiKeyPressHandler = n => {\n      const i = n.which;\n      i !== 13 && i !== 32 || setTimeout(() => {\n        this._qi_button_click(n.target);\n      }, 1);\n    }, this._gantt = e;\n  }\n  _showAtCoordinates(e, n) {\n    this.hide(!0), this._quickInfoBoxId = 0, this._quickInfoTask = null, this._quickInfoBox || (this._createQuickInfoElement(), this.setContent()), this._appendAtCoordinates(e, n), this._gantt.callEvent(\"onQuickInfo\", [null]);\n  }\n  _showForTask(e) {\n    const n = this._gantt;\n    if (e === this._quickInfoBoxId && n.utils.dom.isChildOf(this._quickInfoBox, document.body) || !n.config.show_quick_info) return;\n    this.hide(!0);\n    const i = this._getContainer(),\n      a = this._get_event_counter_part(e, 6, i.xViewport, i.yViewport);\n    a && (this._quickInfoBox = this._init_quick_info(e), this._quickInfoTask = e, this._quickInfoBox.className = this._prepare_quick_info_classname(e), this._fill_quick_data(e), this._show_quick_info(a, 6), n.callEvent(\"onQuickInfo\", [e]));\n  }\n  _get_event_counter_part(e, n, i, a) {\n    const r = this._gantt;\n    let s = r.getTaskNode(e);\n    if (!s && (s = r.getTaskRowNode(e), !s)) return null;\n    let o = 0;\n    const l = n + s.offsetTop + s.offsetHeight;\n    let c = s;\n    if (r.utils.dom.isChildOf(c, i)) for (; c && c !== i;) o += c.offsetLeft, c = c.offsetParent;\n    const d = r.getScrollState();\n    return c ? {\n      left: o,\n      top: l,\n      dx: o + s.offsetWidth / 2 - d.x > i.offsetWidth / 2 ? 1 : 0,\n      dy: l + s.offsetHeight / 2 - d.y > a.offsetHeight / 2 ? 1 : 0,\n      width: s.offsetWidth,\n      height: s.offsetHeight\n    } : null;\n  }\n  _createQuickInfoElement() {\n    const e = this._gantt,\n      n = document.createElement(\"div\");\n    n.className += \"gantt_cal_quick_info\", e._waiAria.quickInfoAttr(n);\n    var i = `\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\t\t</div>\n\t\t<div class=\"gantt_cal_qi_title\" ${e._waiAria.quickInfoHeaderAttrString()}>\n\t\t\t\t\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\n    if (i += '<div class=\"gantt_cal_qi_controls\">', i += \"</div>\", n.innerHTML = i, e.config.quick_info_detached) {\n      const a = this._getContainer();\n      e.event(a.parent, \"scroll\", () => {\n        this.hide();\n      });\n    }\n    return this._quickInfoBox = n, n;\n  }\n  _init_quick_info(e) {\n    const n = this._gantt,\n      i = n.getTask(e);\n    return typeof this._quickInfoReadonly == \"boolean\" && n.isReadonly(i) !== this._quickInfoReadonly && (this.hide(!0), this._quickInfoBox = null), this._quickInfoReadonly = n.isReadonly(i), this._quickInfoBox || (this._quickInfoBox = this._createQuickInfoElement()), this._quickInfoBox;\n  }\n  _prepare_quick_info_classname(e) {\n    const n = this._gantt,\n      i = n.getTask(e);\n    let a = `gantt_cal_quick_info gantt_${n.getTaskType(i)}`;\n    const r = n.templates.quick_info_class(i.start_date, i.end_date, i);\n    return r && (a += \" \" + r), a;\n  }\n  _fill_quick_data(e) {\n    const n = this._gantt,\n      i = n.getTask(e);\n    this._quickInfoBoxId = e;\n    let a = [];\n    if (this._quickInfoReadonly) {\n      const r = n.config.quickinfo_buttons,\n        s = {\n          icon_delete: !0,\n          icon_edit: !0\n        };\n      for (let o = 0; o < r.length; o++) this._quickInfoReadonly && s[r[o]] || a.push(r[o]);\n    } else a = n.config.quickinfo_buttons;\n    this.setContent({\n      header: {\n        title: n.templates.quick_info_title(i.start_date, i.end_date, i),\n        date: n.templates.quick_info_date(i.start_date, i.end_date, i)\n      },\n      content: n.templates.quick_info_content(i.start_date, i.end_date, i),\n      buttons: a\n    });\n  }\n  _appendAtCoordinates(e, n) {\n    const i = this._quickInfoBox,\n      a = this._getContainer();\n    i.parentNode && i.parentNode.nodeName.toLowerCase() !== \"#document-fragment\" || a.parent.appendChild(i), i.style.left = e + \"px\", i.style.top = n + \"px\";\n  }\n  _show_quick_info(e, n) {\n    const i = this._gantt,\n      a = this._quickInfoBox;\n    if (i.config.quick_info_detached) {\n      const r = this._getContainer();\n      a.parentNode && a.parentNode.nodeName.toLowerCase() !== \"#document-fragment\" || r.parent.appendChild(a);\n      const s = a.offsetWidth,\n        o = a.offsetHeight,\n        l = i.getScrollState(),\n        c = r.xViewport,\n        d = r.yViewport,\n        u = c.offsetWidth + l.x - s,\n        h = e.top - l.y + o;\n      let _ = e.top;\n      h > d.offsetHeight / 2 && (_ = e.top - (o + e.height + 2 * n), _ < l.y && h <= d.offsetHeight && (_ = e.top)), _ < l.y && (_ = l.y);\n      const p = Math.min(Math.max(l.x, e.left - e.dx * (s - e.width)), u),\n        y = _;\n      this._appendAtCoordinates(p, y);\n    } else a.style.top = \"20px\", e.dx === 1 ? (a.style.right = \"auto\", a.style.left = \"-300px\", setTimeout(() => {\n      a.style.left = \"10px\";\n    }, 1)) : (a.style.left = \"auto\", a.style.right = \"-300px\", setTimeout(() => {\n      a.style.right = \"10px\";\n    }, 1)), a.className += \" gantt_qi_\" + (e.dx === 1 ? \"left\" : \"right\"), i.$root.appendChild(a);\n  }\n  _qi_button_click(e) {\n    const n = this._gantt,\n      i = this._quickInfoBox;\n    if (!e || e === i) return;\n    if (e.closest(\".gantt_cal_qi_close_btn\")) return void this.hide();\n    const a = e.className;\n    if (a.indexOf(\"_icon\") !== -1) {\n      const r = this._quickInfoBoxId;\n      n.$click.buttons[a.split(\" \")[1].replace(\"icon_\", \"\")](r);\n    } else this._qi_button_click(e.parentNode);\n  }\n  _getContainer() {\n    const e = this._gantt;\n    let n = this._container ? this._container : e.$task_data;\n    return n && n.offsetHeight && n.offsetWidth ? {\n      parent: n,\n      xViewport: e.$task,\n      yViewport: e.$task_data\n    } : (n = this._container ? this._container : e.$grid_data, n && n.offsetHeight && n.offsetWidth ? {\n      parent: n,\n      xViewport: e.$grid,\n      yViewport: e.$grid_data\n    } : {\n      parent: this._container ? this._container : e.$layout,\n      xViewport: e.$layout,\n      yViewport: e.$layout\n    });\n  }\n}\nvar ee,\n  On = {}.constructor.toString();\nfunction q(t) {\n  var e, n;\n  if (t && typeof t == \"object\") switch (!0) {\n    case Q(t):\n      n = new Date(t);\n      break;\n    case fe(t):\n      for (n = new Array(t.length), e = 0; e < t.length; e++) n[e] = q(t[e]);\n      break;\n    default:\n      if (function (i) {\n        return i.constructor.toString() !== On;\n      }(t)) n = Object.create(t);else {\n        if (function (i) {\n          return i.$$typeof && i.$$typeof.toString().includes(\"react.\");\n        }(t)) return n = t;\n        n = {};\n      }\n      for (e in t) Object.prototype.hasOwnProperty.apply(t, [e]) && (n[e] = q(t[e]));\n  }\n  return n || t;\n}\nfunction P(t, e, n) {\n  for (var i in e) (t[i] === void 0 || n) && (t[i] = e[i]);\n  return t;\n}\nfunction W(t) {\n  return t !== void 0;\n}\nfunction st() {\n  return ee || (ee = (/* @__PURE__ */new Date()).valueOf()), ++ee;\n}\nfunction R(t, e) {\n  return t.bind ? t.bind(e) : function () {\n    return t.apply(e, arguments);\n  };\n}\nfunction on(t, e, n, i) {\n  t.addEventListener ? t.addEventListener(e, n, i !== void 0 && i) : t.attachEvent && t.attachEvent(\"on\" + e, n);\n}\nfunction ln(t, e, n, i) {\n  t.removeEventListener ? t.removeEventListener(e, n, i !== void 0 && i) : t.detachEvent && t.detachEvent(\"on\" + e, n);\n}\nconst Bn = Object.freeze(Object.defineProperty({\n  __proto__: null,\n  bind: R,\n  copy: q,\n  defined: W,\n  event: on,\n  eventRemove: ln,\n  mixin: P,\n  uid: st\n}, Symbol.toStringTag, {\n  value: \"Module\"\n}));\nfunction Se(t, e) {\n  t = t || on, e = e || ln;\n  var n = [],\n    i = {\n      attach: function (a, r, s, o) {\n        n.push({\n          element: a,\n          event: r,\n          callback: s,\n          capture: o\n        }), t(a, r, s, o);\n      },\n      detach: function (a, r, s, o) {\n        e(a, r, s, o);\n        for (var l = 0; l < n.length; l++) {\n          var c = n[l];\n          c.element === a && c.event === r && c.callback === s && c.capture === o && (n.splice(l, 1), l--);\n        }\n      },\n      detachAll: function () {\n        for (var a = n.slice(), r = 0; r < a.length; r++) {\n          var s = a[r];\n          i.detach(s.element, s.event, s.callback, s.capture), i.detach(s.element, s.event, s.callback, void 0), i.detach(s.element, s.event, s.callback, !1), i.detach(s.element, s.event, s.callback, !0);\n        }\n        n.splice(0, n.length);\n      },\n      extend: function () {\n        return Se(this.event, this.eventRemove);\n      }\n    };\n  return i;\n}\nclass zn {\n  constructor(e) {\n    this._gantt = e;\n  }\n  getNode() {\n    const e = this._gantt;\n    return this._tooltipNode || (this._tooltipNode = document.createElement(\"div\"), this._tooltipNode.className = \"gantt_tooltip\", e._waiAria.tooltipAttr(this._tooltipNode)), this._tooltipNode;\n  }\n  setViewport(e) {\n    return this._root = e, this;\n  }\n  show(e, n) {\n    const i = this._gantt,\n      a = document.body,\n      r = this.getNode();\n    if (Y(r, a) || (this.hide(), r.style.top = r.style.top || \"0px\", r.style.left = r.style.left || \"0px\", a.appendChild(r)), this._isLikeMouseEvent(e)) {\n      const s = this._calculateTooltipPosition(e);\n      n = s.top, e = s.left;\n    }\n    return r.style.top = n + \"px\", r.style.left = e + \"px\", i._waiAria.tooltipVisibleAttr(r), this;\n  }\n  hide() {\n    const e = this._gantt,\n      n = this.getNode();\n    return n && n.parentNode && n.parentNode.removeChild(n), e._waiAria.tooltipHiddenAttr(n), this;\n  }\n  setContent(e) {\n    return this.getNode().innerHTML = e, this;\n  }\n  _isLikeMouseEvent(e) {\n    return !(!e || typeof e != \"object\") && \"clientX\" in e && \"clientY\" in e;\n  }\n  _getViewPort() {\n    return this._root || document.body;\n  }\n  _calculateTooltipPosition(e) {\n    const n = this._gantt,\n      i = this._getViewPortSize(),\n      a = this.getNode(),\n      r = {\n        top: 0,\n        left: 0,\n        width: a.offsetWidth,\n        height: a.offsetHeight,\n        bottom: 0,\n        right: 0\n      },\n      s = n.config.tooltip_offset_x,\n      o = n.config.tooltip_offset_y,\n      l = document.body,\n      c = rt(e, l),\n      d = V(l);\n    c.y += d.y, r.top = c.y, r.left = c.x, r.top += o, r.left += s, r.bottom = r.top + r.height, r.right = r.left + r.width;\n    const u = window.scrollY + l.scrollTop;\n    return r.top < i.top - u ? (r.top = i.top, r.bottom = r.top + r.height) : r.bottom > i.bottom && (r.bottom = i.bottom, r.top = r.bottom - r.height), r.left < i.left ? (r.left = i.left, r.right = i.left + r.width) : r.right > i.right && (r.right = i.right, r.left = r.right - r.width), c.x >= r.left && c.x <= r.right && (r.left = c.x - r.width - s, r.right = r.left + r.width), c.y >= r.top && c.y <= r.bottom && (r.top = c.y - r.height - o, r.bottom = r.top + r.height), r.left < 0 && (r.left = 0), r.right < 0 && (r.right = 0), r;\n  }\n  _getViewPortSize() {\n    const e = this._gantt,\n      n = this._getViewPort();\n    let i,\n      a = n,\n      r = window.scrollY + document.body.scrollTop,\n      s = window.scrollX + document.body.scrollLeft;\n    return n === e.$task_data ? (a = e.$task, r = 0, s = 0, i = V(e.$task)) : i = V(a), {\n      left: i.x + s,\n      top: i.y + r,\n      width: i.width,\n      height: i.height,\n      bottom: i.y + i.height + r,\n      right: i.x + i.width + s\n    };\n  }\n}\nclass Wn {\n  constructor(e) {\n    this._listeners = {}, this.tooltip = new zn(e), this._gantt = e, this._domEvents = Se(), this._initDelayedFunctions();\n  }\n  destructor() {\n    this.tooltip.hide(), this._domEvents.detachAll();\n  }\n  hideTooltip() {\n    this.delayHide();\n  }\n  attach(e) {\n    let n = document.body;\n    const i = this._gantt;\n    e.global || (n = i.$root);\n    let a = null;\n    const r = s => {\n      const o = yt(s),\n        l = dt(o, e.selector);\n      if (Y(o, this.tooltip.getNode())) return;\n      const c = () => {\n        a = l, e.onmouseenter(s, l);\n      };\n      a ? l && l === a ? e.onmousemove(s, l) : (e.onmouseleave(s, a), a = null, l && l !== a && c()) : l && c();\n    };\n    this.detach(e.selector), this._domEvents.attach(n, \"mousemove\", r), this._listeners[e.selector] = {\n      node: n,\n      handler: r\n    };\n  }\n  detach(e) {\n    const n = this._listeners[e];\n    n && this._domEvents.detach(n.node, \"mousemove\", n.handler);\n  }\n  tooltipFor(e) {\n    const n = i => {\n      let a = i;\n      return document.createEventObject && !document.createEvent && (a = document.createEventObject(i)), a;\n    };\n    this._initDelayedFunctions(), this.attach({\n      selector: e.selector,\n      global: e.global,\n      onmouseenter: (i, a) => {\n        const r = e.html(i, a);\n        r && this.delayShow(n(i), r);\n      },\n      onmousemove: (i, a) => {\n        const r = e.html(i, a);\n        r ? this.delayShow(n(i), r) : (this.delayShow.$cancelTimeout(), this.delayHide());\n      },\n      onmouseleave: () => {\n        this.delayShow.$cancelTimeout(), this.delayHide();\n      }\n    });\n  }\n  _initDelayedFunctions() {\n    const e = this._gantt;\n    this.delayShow && this.delayShow.$cancelTimeout(), this.delayHide && this.delayHide.$cancelTimeout(), this.tooltip.hide(), this.delayShow = De((n, i) => {\n      e.callEvent(\"onBeforeTooltip\", [n]) === !1 ? this.tooltip.hide() : (this.tooltip.setContent(i), this.tooltip.show(n));\n    }, e.config.tooltip_timeout || 1), this.delayHide = De(() => {\n      this.delayShow.$cancelTimeout(), this.tooltip.hide();\n    }, e.config.tooltip_hide_timeout || 1);\n  }\n}\nconst Ie = {\n    onBeforeUndo: \"onAfterUndo\",\n    onBeforeRedo: \"onAfterRedo\"\n  },\n  Me = [\"onTaskDragStart\", \"onAfterTaskUpdate\", \"onAfterParentExpand\", \"onAfterTaskDelete\", \"onBeforeBatchUpdate\"];\nclass jn {\n  constructor(e, n) {\n    this._batchAction = null, this._batchMode = !1, this._ignore = !1, this._ignoreMoveEvents = !1, this._initialTasks = {}, this._initialLinks = {}, this._nestedTasks = {}, this._nestedLinks = {}, this._undo = e, this._gantt = n, this._attachEvents();\n  }\n  store(e, n, i = !1) {\n    return n === this._gantt.config.undo_types.task ? this._storeTask(e, i) : n === this._gantt.config.undo_types.link && this._storeLink(e, i);\n  }\n  isMoveEventsIgnored() {\n    return this._ignoreMoveEvents;\n  }\n  toggleIgnoreMoveEvents(e) {\n    this._ignoreMoveEvents = e || !1;\n  }\n  startIgnore() {\n    this._ignore = !0;\n  }\n  stopIgnore() {\n    this._ignore = !1;\n  }\n  startBatchAction() {\n    this._timeout || (this._timeout = setTimeout(() => {\n      this.stopBatchAction(), this._timeout = null;\n    }, 10)), this._ignore || this._batchMode || (this._batchMode = !0, this._batchAction = this._undo.action.create());\n  }\n  stopBatchAction() {\n    if (this._ignore) return;\n    const e = this._undo;\n    this._batchAction && e.logAction(this._batchAction), this._batchMode = !1, this._batchAction = null;\n  }\n  onTaskAdded(e) {\n    this._ignore || this._storeTaskCommand(e, this._undo.command.type.add);\n  }\n  onTaskUpdated(e) {\n    this._ignore || this._storeTaskCommand(e, this._undo.command.type.update);\n  }\n  onTaskMoved(e) {\n    this._ignore || (e.$local_index = this._gantt.getTaskIndex(e.id), this._storeEntityCommand(e, this.getInitialTask(e.id), this._undo.command.type.move, this._undo.command.entity.task));\n  }\n  onTaskDeleted(e) {\n    if (!this._ignore) {\n      if (this._storeTaskCommand(e, this._undo.command.type.remove), this._nestedTasks[e.id]) {\n        const n = this._nestedTasks[e.id];\n        for (let i = 0; i < n.length; i++) this._storeTaskCommand(n[i], this._undo.command.type.remove);\n      }\n      if (this._nestedLinks[e.id]) {\n        const n = this._nestedLinks[e.id];\n        for (let i = 0; i < n.length; i++) this._storeLinkCommand(n[i], this._undo.command.type.remove);\n      }\n    }\n  }\n  onLinkAdded(e) {\n    this._ignore || this._storeLinkCommand(e, this._undo.command.type.add);\n  }\n  onLinkUpdated(e) {\n    this._ignore || this._storeLinkCommand(e, this._undo.command.type.update);\n  }\n  onLinkDeleted(e) {\n    this._ignore || this._storeLinkCommand(e, this._undo.command.type.remove);\n  }\n  setNestedTasks(e, n) {\n    const i = this._gantt;\n    let a = null;\n    const r = [];\n    let s = this._getLinks(i.getTask(e));\n    for (let c = 0; c < n.length; c++) a = this.setInitialTask(n[c]), s = s.concat(this._getLinks(a)), r.push(a);\n    const o = {};\n    for (let c = 0; c < s.length; c++) o[s[c]] = !0;\n    const l = [];\n    for (const c in o) l.push(this.setInitialLink(c));\n    this._nestedTasks[e] = r, this._nestedLinks[e] = l;\n  }\n  setInitialTask(e, n) {\n    const i = this._gantt;\n    if (n || !this._initialTasks[e] || !this._batchMode) {\n      const a = i.copy(i.getTask(e));\n      a.$index = i.getGlobalTaskIndex(e), a.$local_index = i.getTaskIndex(e), this.setInitialTaskObject(e, a);\n    }\n    return this._initialTasks[e];\n  }\n  getInitialTask(e) {\n    return this._initialTasks[e];\n  }\n  clearInitialTasks() {\n    this._initialTasks = {};\n  }\n  setInitialTaskObject(e, n) {\n    this._initialTasks[e] = n;\n  }\n  setInitialLink(e, n) {\n    return this._initialLinks[e] && this._batchMode || (this._initialLinks[e] = this._gantt.copy(this._gantt.getLink(e))), this._initialLinks[e];\n  }\n  getInitialLink(e) {\n    return this._initialLinks[e];\n  }\n  clearInitialLinks() {\n    this._initialLinks = {};\n  }\n  _attachEvents() {\n    let e = null;\n    const n = this._gantt,\n      i = () => {\n        e || (e = setTimeout(() => {\n          e = null;\n        }), this.clearInitialTasks(), n.eachTask(l => {\n          this.setInitialTask(l.id);\n        }), this.clearInitialLinks(), n.getLinks().forEach(l => {\n          this.setInitialLink(l.id);\n        }));\n      },\n      a = l => n.copy(n.getTask(l));\n    for (const l in Ie) n.attachEvent(l, () => (this.startIgnore(), !0)), n.attachEvent(Ie[l], () => (this.stopIgnore(), !0));\n    for (let l = 0; l < Me.length; l++) n.attachEvent(Me[l], () => (this.startBatchAction(), !0));\n    n.attachEvent(\"onParse\", () => {\n      this._undo.clearUndoStack(), this._undo.clearRedoStack(), i();\n    }), n.attachEvent(\"onAfterTaskAdd\", (l, c) => {\n      this.setInitialTask(l, !0), this.onTaskAdded(c);\n    }), n.attachEvent(\"onAfterTaskUpdate\", (l, c) => {\n      this.onTaskUpdated(c);\n    }), n.attachEvent(\"onAfterParentExpand\", (l, c) => {\n      this.onTaskUpdated(c);\n    }), n.attachEvent(\"onAfterTaskDelete\", (l, c) => {\n      this.onTaskDeleted(c);\n    }), n.attachEvent(\"onAfterLinkAdd\", (l, c) => {\n      this.setInitialLink(l, !0), this.onLinkAdded(c);\n    }), n.attachEvent(\"onAfterLinkUpdate\", (l, c) => {\n      this.onLinkUpdated(c);\n    }), n.attachEvent(\"onAfterLinkDelete\", (l, c) => {\n      this.onLinkDeleted(c);\n    }), n.attachEvent(\"onRowDragEnd\", (l, c) => (this.onTaskMoved(a(l)), this.toggleIgnoreMoveEvents(), !0)), n.attachEvent(\"onBeforeTaskDelete\", l => {\n      this.store(l, n.config.undo_types.task);\n      const c = [];\n      return i(), n.eachTask(d => {\n        c.push(d.id);\n      }, l), this.setNestedTasks(l, c), !0;\n    });\n    const r = n.getDatastore(\"task\");\n    r.attachEvent(\"onBeforeItemMove\", (l, c, d) => (this.isMoveEventsIgnored() || i(), !0)), r.attachEvent(\"onAfterItemMove\", (l, c, d) => (this.isMoveEventsIgnored() || this.onTaskMoved(a(l)), !0)), n.attachEvent(\"onRowDragStart\", (l, c, d) => (this.toggleIgnoreMoveEvents(!0), i(), !0));\n    let s = null,\n      o = !1;\n    if (n.attachEvent(\"onBeforeTaskDrag\", l => {\n      if (s = n.getState().drag_id, s === l) {\n        const c = n.getTask(l);\n        n.isSummaryTask(c) && n.config.drag_project && (o = !0);\n      }\n      if (n.plugins().multiselect) {\n        const c = n.getSelectedTasks();\n        c.length > 1 && c.forEach(d => {\n          this.store(d, n.config.undo_types.task, !0);\n        });\n      }\n      return this.store(l, n.config.undo_types.task);\n    }), n.attachEvent(\"onAfterTaskDrag\", l => {\n      (o || n.plugins().multiselect && n.getSelectedTasks().length > 1) && s === l && (o = !1, s = null, this.stopBatchAction()), this.store(l, n.config.undo_types.task, !0);\n    }), n.attachEvent(\"onLightbox\", l => this.store(l, n.config.undo_types.task)), n.attachEvent(\"onBeforeTaskAutoSchedule\", l => (this.store(l.id, n.config.undo_types.task, !0), !0)), n.ext.inlineEditors) {\n      let l = null,\n        c = null;\n      n.attachEvent(\"onGanttLayoutReady\", () => {\n        l && n.ext.inlineEditors.detachEvent(l), c && n.ext.inlineEditors.detachEvent(c), c = n.ext.inlineEditors.attachEvent(\"onEditStart\", d => {\n          this.store(d.id, n.config.undo_types.task);\n        }), l = n.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", d => (this.stopBatchAction(), !0));\n      });\n    }\n  }\n  _storeCommand(e) {\n    const n = this._undo;\n    if (n.updateConfigs(), n.undoEnabled) if (this._batchMode) this._batchAction.commands.push(e);else {\n      const i = n.action.create([e]);\n      n.logAction(i);\n    }\n  }\n  _storeEntityCommand(e, n, i, a) {\n    const r = this._undo.command.create(e, n, i, a);\n    this._storeCommand(r);\n  }\n  _storeTaskCommand(e, n) {\n    this._gantt.isTaskExists(e.id) && (e.$local_index = this._gantt.getTaskIndex(e.id)), this._storeEntityCommand(e, this.getInitialTask(e.id), n, this._undo.command.entity.task);\n  }\n  _storeLinkCommand(e, n) {\n    this._storeEntityCommand(e, this.getInitialLink(e.id), n, this._undo.command.entity.link);\n  }\n  _getLinks(e) {\n    return e.$source.concat(e.$target);\n  }\n  _storeTask(e, n = !1) {\n    const i = this._gantt;\n    return this.setInitialTask(e, n), i.eachTask(a => {\n      this.setInitialTask(a.id);\n    }, e), !0;\n  }\n  _storeLink(e, n = !1) {\n    return this.setInitialLink(e, n), !0;\n  }\n}\nclass Fn {\n  constructor(e) {\n    this.maxSteps = 100, this.undoEnabled = !0, this.redoEnabled = !0, this.action = {\n      create: n => ({\n        commands: n ? n.slice() : []\n      }),\n      invert: n => {\n        const i = this._gantt.copy(n),\n          a = this.command;\n        for (let r = 0; r < n.commands.length; r++) {\n          const s = i.commands[r] = a.invert(i.commands[r]);\n          s.type !== a.type.update && s.type !== a.type.move || ([s.value, s.oldValue] = [s.oldValue, s.value]);\n        }\n        return i;\n      }\n    }, this.command = {\n      entity: null,\n      type: null,\n      create: (n, i, a, r) => {\n        const s = this._gantt;\n        return {\n          entity: r,\n          type: a,\n          value: s.copy(n),\n          oldValue: s.copy(i || n)\n        };\n      },\n      invert: n => {\n        const i = this._gantt.copy(n);\n        return i.type = this.command.inverseCommands(n.type), i;\n      },\n      inverseCommands: n => {\n        const i = this._gantt,\n          a = this.command.type;\n        switch (n) {\n          case a.update:\n            return a.update;\n          case a.remove:\n            return a.add;\n          case a.add:\n            return a.remove;\n          case a.move:\n            return a.move;\n          default:\n            return i.assert(!1, \"Invalid command \" + n), null;\n        }\n      }\n    }, this._undoStack = [], this._redoStack = [], this._gantt = e;\n  }\n  getUndoStack() {\n    return this._undoStack;\n  }\n  setUndoStack(e) {\n    this._undoStack = e;\n  }\n  getRedoStack() {\n    return this._redoStack;\n  }\n  setRedoStack(e) {\n    this._redoStack = e;\n  }\n  clearUndoStack() {\n    this._undoStack = [];\n  }\n  clearRedoStack() {\n    this._redoStack = [];\n  }\n  updateConfigs() {\n    const e = this._gantt;\n    this.maxSteps = e.config.undo_steps || 100, this.command.entity = e.config.undo_types, this.command.type = e.config.undo_actions, this.undoEnabled = !!e.config.undo, this.redoEnabled = !!e.config.redo;\n  }\n  undo() {\n    const e = this._gantt;\n    if (this.updateConfigs(), !this.undoEnabled) return;\n    const n = this._pop(this._undoStack);\n    if (n && this._reorderCommands(n), e.callEvent(\"onBeforeUndo\", [n]) !== !1 && n) return this._applyAction(this.action.invert(n)), this._push(this._redoStack, e.copy(n)), void e.callEvent(\"onAfterUndo\", [n]);\n    e.callEvent(\"onAfterUndo\", [null]);\n  }\n  redo() {\n    const e = this._gantt;\n    if (this.updateConfigs(), !this.redoEnabled) return;\n    const n = this._pop(this._redoStack);\n    if (n && this._reorderCommands(n), e.callEvent(\"onBeforeRedo\", [n]) !== !1 && n) return this._applyAction(n), this._push(this._undoStack, e.copy(n)), void e.callEvent(\"onAfterRedo\", [n]);\n    e.callEvent(\"onAfterRedo\", [null]);\n  }\n  logAction(e) {\n    this._push(this._undoStack, e), this._redoStack = [];\n  }\n  _push(e, n) {\n    const i = this._gantt;\n    if (!n.commands.length) return;\n    const a = e === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\n    if (i.callEvent(a, [n]) !== !1 && n.commands.length) {\n      for (e.push(n); e.length > this.maxSteps;) e.shift();\n      return n;\n    }\n  }\n  _pop(e) {\n    return e.pop();\n  }\n  _reorderCommands(e) {\n    const n = {\n        any: 0,\n        link: 1,\n        task: 2\n      },\n      i = {\n        move: 1,\n        any: 0\n      };\n    e.commands.sort(function (a, r) {\n      if (a.entity === \"task\" && r.entity === \"task\") return a.type !== r.type ? (i[r.type] || 0) - (i[a.type] || 0) : a.type === \"move\" && a.oldValue && r.oldValue && r.oldValue.parent === a.oldValue.parent ? a.oldValue.$index - r.oldValue.$index : 0;\n      {\n        const s = n[a.entity] || n.any;\n        return (n[r.entity] || n.any) - s;\n      }\n    });\n  }\n  _applyAction(e) {\n    let n = null;\n    const i = this.command.entity,\n      a = this.command.type,\n      r = this._gantt,\n      s = {};\n    s[i.task] = {\n      add: \"addTask\",\n      get: \"getTask\",\n      update: \"updateTask\",\n      remove: \"deleteTask\",\n      move: \"moveTask\",\n      isExists: \"isTaskExists\"\n    }, s[i.link] = {\n      add: \"addLink\",\n      get: \"getLink\",\n      update: \"updateLink\",\n      remove: \"deleteLink\",\n      isExists: \"isLinkExists\"\n    }, r.batchUpdate(function () {\n      for (let o = 0; o < e.commands.length; o++) {\n        n = e.commands[o];\n        const l = s[n.entity][n.type],\n          c = s[n.entity].get,\n          d = s[n.entity].isExists;\n        if (n.type === a.add) r[l](n.oldValue, n.oldValue.parent, n.oldValue.$local_index);else if (n.type === a.remove) r[d](n.value.id) && r[l](n.value.id);else if (n.type === a.update) {\n          const u = r[c](n.value.id);\n          for (const h in n.value) {\n            let _ = !(h.startsWith(\"$\") || h.startsWith(\"_\"));\n            [\"$open\"].indexOf(h) > -1 && (_ = !0), _ && (u[h] = n.value[h]);\n          }\n          r[l](n.value.id);\n        } else n.type === a.move && (r[l](n.value.id, n.value.$local_index, n.value.parent), r.callEvent(\"onRowDragEnd\", [n.value.id]));\n      }\n    });\n  }\n}\nconst Vn = {\n    click_drag: function (t) {\n      t.ext || (t.ext = {});\n      const e = {\n        className: \"gantt_click_drag_rect\",\n        useRequestAnimationFrame: !0,\n        callback: void 0,\n        singleRow: !1\n      };\n      function n() {\n        const i = {\n          viewPort: t.$task_data,\n          ...e\n        };\n        t.ext.clickDrag && t.ext.clickDrag.destructor(), t.ext.clickDrag = new Nn(t);\n        const a = t.config.click_drag;\n        i.render = a.render || e.render, i.className = a.className || e.className, i.callback = a.callback || e.callback, i.viewPort = a.viewPort || t.$task_data, i.useRequestAnimationFrame = a.useRequestAnimationFrame === void 0 ? e.useRequestAnimationFrame : a.useRequestAnimationFrame, i.singleRow = a.singleRow === void 0 ? e.singleRow : a.singleRow;\n        const r = t.$ui.getView(\"timeline\"),\n          s = new Pn(i, t, r);\n        t.ext.clickDrag.attach(s, a.useKey, a.ignore);\n      }\n      t.attachEvent(\"onGanttReady\", () => {\n        t.config.click_drag && n();\n      }), t.attachEvent(\"onGanttLayoutReady\", function () {\n        t.$container && t.config.click_drag && t.attachEvent(\"onGanttRender\", function () {\n          n();\n        }, {\n          once: !0\n        });\n      }), t.attachEvent(\"onDestroy\", () => {\n        t.ext.clickDrag && t.ext.clickDrag.destructor();\n      });\n    },\n    drag_timeline: function (t) {\n      t.ext || (t.ext = {}), t.ext.dragTimeline = {\n        create: () => Yt.create(t),\n        _isDragInProgress: () => Yt._isDragInProgress\n      }, t.config.drag_timeline = {\n        enabled: !0,\n        render: !1\n      };\n    },\n    fullscreen: function (t) {\n      function e() {\n        const d = document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement;\n        return !(!d || d !== document.body);\n      }\n      function n() {\n        try {\n          return document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled;\n        } catch (d) {\n          console.error(\"Fullscreen is not available:\", d);\n        }\n      }\n      t.$services.getService(\"state\").registerProvider(\"fullscreen\", () => n() ? {\n        fullscreen: e()\n      } : void 0);\n      let i = {\n        overflow: null,\n        padding: null,\n        paddingTop: null,\n        paddingRight: null,\n        paddingBottom: null,\n        paddingLeft: null\n      };\n      const a = {\n        width: null,\n        height: null,\n        top: null,\n        left: null,\n        position: null,\n        zIndex: null,\n        modified: !1\n      };\n      let r = null;\n      function s(d, u) {\n        u.width = d.width, u.height = d.height, u.top = d.top, u.left = d.left, u.position = d.position, u.zIndex = d.zIndex;\n      }\n      let o = !1;\n      function l() {\n        if (!t.$container) return;\n        let d;\n        e() ? o && (d = \"onExpand\", function () {\n          const u = t.ext.fullscreen.getFullscreenElement(),\n            h = document.body;\n          s(u.style, a), i = {\n            overflow: h.style.overflow,\n            padding: h.style.padding ? h.style.padding : null,\n            paddingTop: h.style.paddingTop ? h.style.paddingTop : null,\n            paddingRight: h.style.paddingRight ? h.style.paddingRight : null,\n            paddingBottom: h.style.paddingBottom ? h.style.paddingBottom : null,\n            paddingLeft: h.style.paddingLeft ? h.style.paddingLeft : null\n          }, h.style.padding && (h.style.padding = \"0\"), h.style.paddingTop && (h.style.paddingTop = \"0\"), h.style.paddingRight && (h.style.paddingRight = \"0\"), h.style.paddingBottom && (h.style.paddingBottom = \"0\"), h.style.paddingLeft && (h.style.paddingLeft = \"0\"), h.style.overflow = \"hidden\", u.style.width = \"100vw\", u.style.height = \"100vh\", u.style.top = \"0px\", u.style.left = \"0px\", u.style.position = \"absolute\", u.style.zIndex = 1, a.modified = !0, r = function (_) {\n            let p = _.parentNode;\n            const y = [];\n            for (; p && p.style;) y.push({\n              element: p,\n              originalPositioning: p.style.position\n            }), p.style.position = \"static\", p = p.parentNode;\n            return y;\n          }(u);\n        }()) : o && (o = !1, d = \"onCollapse\", function () {\n          const u = t.ext.fullscreen.getFullscreenElement(),\n            h = document.body;\n          a.modified && (i.padding && (h.style.padding = i.padding), i.paddingTop && (h.style.paddingTop = i.paddingTop), i.paddingRight && (h.style.paddingRight = i.paddingRight), i.paddingBottom && (h.style.paddingBottom = i.paddingBottom), i.paddingLeft && (h.style.paddingLeft = i.paddingLeft), h.style.overflow = i.overflow, i = {\n            overflow: null,\n            padding: null,\n            paddingTop: null,\n            paddingRight: null,\n            paddingBottom: null,\n            paddingLeft: null\n          }, s(a, u.style), a.modified = !1), r.forEach(_ => {\n            _.element.style.position = _.originalPositioning;\n          }), r = null;\n        }()), setTimeout(() => {\n          t.render();\n        }), setTimeout(() => {\n          t.callEvent(d, [t.ext.fullscreen.getFullscreenElement()]);\n        });\n      }\n      function c() {\n        return !t.$container || !t.ext.fullscreen.getFullscreenElement() ? !0 : n() ? !1 : ((console.warning || console.log)(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\"), !0);\n      }\n      t.ext.fullscreen = {\n        expand() {\n          if (c() || e() || !t.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) return;\n          o = !0;\n          const d = document.body,\n            u = d.webkitRequestFullscreen ? [Element.ALLOW_KEYBOARD_INPUT] : [],\n            h = d.msRequestFullscreen || d.mozRequestFullScreen || d.webkitRequestFullscreen || d.requestFullscreen;\n          h && h.apply(d, u);\n        },\n        collapse() {\n          if (c() || !e() || !t.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) return;\n          const d = document.msExitFullscreen || document.mozCancelFullScreen || document.webkitExitFullscreen || document.exitFullscreen;\n          d && d.apply(document);\n        },\n        toggle() {\n          c() || (e() ? this.collapse() : this.expand());\n        },\n        getFullscreenElement: () => t.$root\n      }, t.expand = function () {\n        t.ext.fullscreen.expand();\n      }, t.collapse = function () {\n        t.ext.fullscreen.collapse();\n      }, t.attachEvent(\"onGanttReady\", function () {\n        t.event(document, \"webkitfullscreenchange\", l), t.event(document, \"mozfullscreenchange\", l), t.event(document, \"MSFullscreenChange\", l), t.event(document, \"fullscreenChange\", l), t.event(document, \"fullscreenchange\", l);\n      });\n    },\n    keyboard_navigation: function (t) {\n      (function (e) {\n        e.config.keyboard_navigation = !0, e.config.keyboard_navigation_cells = !1, e.$keyboardNavigation = {}, e._compose = function () {\n          for (var n = Array.prototype.slice.call(arguments, 0), i = {}, a = 0; a < n.length; a++) {\n            var r = n[a];\n            for (var s in typeof r == \"function\" && (r = new r()), r) i[s] = r[s];\n          }\n          return i;\n        }, function (n) {\n          n.$keyboardNavigation.shortcuts = {\n            createCommand: function () {\n              return {\n                modifiers: {\n                  shift: !1,\n                  alt: !1,\n                  ctrl: !1,\n                  meta: !1\n                },\n                keyCode: null\n              };\n            },\n            parse: function (i) {\n              for (var a = [], r = this.getExpressions(this.trim(i)), s = 0; s < r.length; s++) {\n                for (var o = this.getWords(r[s]), l = this.createCommand(), c = 0; c < o.length; c++) this.commandKeys[o[c]] ? l.modifiers[o[c]] = !0 : this.specialKeys[o[c]] ? l.keyCode = this.specialKeys[o[c]] : l.keyCode = o[c].charCodeAt(0);\n                a.push(l);\n              }\n              return a;\n            },\n            getCommandFromEvent: function (i) {\n              var a = this.createCommand();\n              a.modifiers.shift = !!i.shiftKey, a.modifiers.alt = !!i.altKey, a.modifiers.ctrl = !!i.ctrlKey, a.modifiers.meta = !!i.metaKey, a.keyCode = i.which || i.keyCode, a.keyCode >= 96 && a.keyCode <= 105 && (a.keyCode -= 48);\n              var r = String.fromCharCode(a.keyCode);\n              return r && (a.keyCode = r.toLowerCase().charCodeAt(0)), a;\n            },\n            getHashFromEvent: function (i) {\n              return this.getHash(this.getCommandFromEvent(i));\n            },\n            getHash: function (i) {\n              var a = [];\n              for (var r in i.modifiers) i.modifiers[r] && a.push(r);\n              return a.push(i.keyCode), a.join(this.junctionChar);\n            },\n            getExpressions: function (i) {\n              return i.split(this.junctionChar);\n            },\n            getWords: function (i) {\n              return i.split(this.combinationChar);\n            },\n            trim: function (i) {\n              return i.replace(/\\s/g, \"\");\n            },\n            junctionChar: \",\",\n            combinationChar: \"+\",\n            commandKeys: {\n              shift: 16,\n              alt: 18,\n              ctrl: 17,\n              meta: !0\n            },\n            specialKeys: {\n              backspace: 8,\n              tab: 9,\n              enter: 13,\n              esc: 27,\n              space: 32,\n              up: 38,\n              down: 40,\n              left: 37,\n              right: 39,\n              home: 36,\n              end: 35,\n              pageup: 33,\n              pagedown: 34,\n              delete: 46,\n              insert: 45,\n              plus: 107,\n              f1: 112,\n              f2: 113,\n              f3: 114,\n              f4: 115,\n              f5: 116,\n              f6: 117,\n              f7: 118,\n              f8: 119,\n              f9: 120,\n              f10: 121,\n              f11: 122,\n              f12: 123\n            }\n          };\n        }(e), function (n) {\n          n.$keyboardNavigation.EventHandler = {\n            _handlers: null,\n            findHandler: function (i) {\n              this._handlers || (this._handlers = {});\n              var a = n.$keyboardNavigation.shortcuts.getHash(i);\n              return this._handlers[a];\n            },\n            doAction: function (i, a) {\n              var r = this.findHandler(i);\n              if (r) {\n                if (n.$keyboardNavigation.facade.callEvent(\"onBeforeAction\", [i, a]) === !1) return;\n                r.call(this, a), a.preventDefault ? a.preventDefault() : a.returnValue = !1;\n              }\n            },\n            bind: function (i, a) {\n              this._handlers || (this._handlers = {});\n              for (var r = n.$keyboardNavigation.shortcuts, s = r.parse(i), o = 0; o < s.length; o++) this._handlers[r.getHash(s[o])] = a;\n            },\n            unbind: function (i) {\n              for (var a = n.$keyboardNavigation.shortcuts, r = a.parse(i), s = 0; s < r.length; s++) this._handlers[a.getHash(r[s])] && delete this._handlers[a.getHash(r[s])];\n            },\n            bindAll: function (i) {\n              for (var a in i) this.bind(a, i[a]);\n            },\n            initKeys: function () {\n              this._handlers || (this._handlers = {}), this.keys && this.bindAll(this.keys);\n            }\n          };\n        }(e), function (n) {\n          n.$keyboardNavigation.getFocusableNodes = Lt, n.$keyboardNavigation.trapFocus = function (i, a) {\n            if (a.keyCode != 9) return !1;\n            for (var r = n.$keyboardNavigation.getFocusableNodes(i), s = ge(), o = -1, l = 0; l < r.length; l++) if (r[l] == s) {\n              o = l;\n              break;\n            }\n            if (a.shiftKey) {\n              if (o <= 0) {\n                var c = r[r.length - 1];\n                if (c) return c.focus(), a.preventDefault(), !0;\n              }\n            } else if (o >= r.length - 1) {\n              var d = r[0];\n              if (d) return d.focus(), a.preventDefault(), !0;\n            }\n            return !1;\n          };\n        }(e), function (n) {\n          n.$keyboardNavigation.GanttNode = function () {}, n.$keyboardNavigation.GanttNode.prototype = n._compose(n.$keyboardNavigation.EventHandler, {\n            focus: function () {\n              n.focus();\n            },\n            blur: function () {},\n            isEnabled: function () {\n              return n.$container.hasAttribute(\"tabindex\");\n            },\n            scrollHorizontal: function (i) {\n              var a = n.dateFromPos(n.getScrollState().x),\n                r = n.getScale(),\n                s = i < 0 ? -r.step : r.step;\n              a = n.date.add(a, s, r.unit), n.scrollTo(n.posFromDate(a));\n            },\n            scrollVertical: function (i) {\n              var a = n.getScrollState().y,\n                r = n.config.row_height;\n              n.scrollTo(null, a + (i < 0 ? -1 : 1) * r);\n            },\n            keys: {\n              \"alt+left\": function (i) {\n                this.scrollHorizontal(-1);\n              },\n              \"alt+right\": function (i) {\n                this.scrollHorizontal(1);\n              },\n              \"alt+up\": function (i) {\n                this.scrollVertical(-1);\n              },\n              \"alt+down\": function (i) {\n                this.scrollVertical(1);\n              },\n              \"ctrl+z\": function () {\n                n.undo && n.undo();\n              },\n              \"ctrl+r\": function () {\n                n.redo && n.redo();\n              }\n            }\n          }), n.$keyboardNavigation.GanttNode.prototype.bindAll(n.$keyboardNavigation.GanttNode.prototype.keys);\n        }(e), function (n) {\n          n.$keyboardNavigation.KeyNavNode = function () {}, n.$keyboardNavigation.KeyNavNode.prototype = n._compose(n.$keyboardNavigation.EventHandler, {\n            isValid: function () {\n              return !0;\n            },\n            fallback: function () {\n              return null;\n            },\n            moveTo: function (i) {\n              n.$keyboardNavigation.dispatcher.setActiveNode(i);\n            },\n            compareTo: function (i) {\n              if (!i) return !1;\n              for (var a in this) {\n                if (!!this[a] != !!i[a]) return !1;\n                var r = !(!this[a] || !this[a].toString),\n                  s = !(!i[a] || !i[a].toString);\n                if (s != r) return !1;\n                if (s && r) {\n                  if (i[a].toString() != this[a].toString()) return !1;\n                } else if (i[a] != this[a]) return !1;\n              }\n              return !0;\n            },\n            getNode: function () {},\n            focus: function () {\n              var i = this.getNode();\n              if (i) {\n                var a = n.$keyboardNavigation.facade;\n                a.callEvent(\"onBeforeFocus\", [i]) !== !1 && i && (i.setAttribute(\"tabindex\", \"-1\"), i.$eventAttached || (i.$eventAttached = !0, n.event(i, \"focus\", function (r) {\n                  return r.preventDefault(), !1;\n                }, !1)), n.utils.dom.isChildOf(document.activeElement, i) && (i = document.activeElement), i.focus && i.focus(), a.callEvent(\"onFocus\", [this.getNode()]));\n              }\n            },\n            blur: function () {\n              var i = this.getNode();\n              i && (n.$keyboardNavigation.facade.callEvent(\"onBlur\", [i]), i.setAttribute(\"tabindex\", \"-1\"));\n            }\n          });\n        }(e), function (n) {\n          n.$keyboardNavigation.HeaderCell = function (i) {\n            this.index = i || 0;\n          }, n.$keyboardNavigation.HeaderCell.prototype = n._compose(n.$keyboardNavigation.KeyNavNode, {\n            _handlers: null,\n            isValid: function () {\n              return !(!n.config.show_grid && n.getVisibleTaskCount() || !n.getGridColumns()[this.index] && n.getVisibleTaskCount());\n            },\n            fallback: function () {\n              if (!n.config.show_grid) return n.getVisibleTaskCount() ? new n.$keyboardNavigation.TaskRow() : null;\n              for (var i = n.getGridColumns(), a = this.index; a >= 0 && !i[a];) a--;\n              return i[a] ? new n.$keyboardNavigation.HeaderCell(a) : null;\n            },\n            fromDomElement: function (i) {\n              var a = pt(i, \"gantt_grid_head_cell\");\n              if (a) {\n                for (var r = 0; a && a.previousSibling;) a = a.previousSibling, r += 1;\n                return new n.$keyboardNavigation.HeaderCell(r);\n              }\n              return null;\n            },\n            getNode: function () {\n              const i = n.$grid_scale;\n              return i ? i.childNodes[this.index] : null;\n            },\n            keys: {\n              left: function () {\n                this.index > 0 && this.moveTo(new n.$keyboardNavigation.HeaderCell(this.index - 1));\n              },\n              right: function () {\n                var i = n.getGridColumns();\n                this.index < i.length - 1 && this.moveTo(new n.$keyboardNavigation.HeaderCell(this.index + 1));\n              },\n              down: function () {\n                var i,\n                  a = n.getChildren(n.config.root_id);\n                n.isTaskExists(a[0]) && (i = a[0]), i && (n.config.keyboard_navigation_cells ? this.moveTo(new n.$keyboardNavigation.TaskCell(i, this.index)) : this.moveTo(new n.$keyboardNavigation.TaskRow(i)));\n              },\n              end: function () {\n                var i = n.getGridColumns();\n                this.moveTo(new n.$keyboardNavigation.HeaderCell(i.length - 1));\n              },\n              home: function () {\n                this.moveTo(new n.$keyboardNavigation.HeaderCell(0));\n              },\n              \"enter, space\": function () {\n                ge().click();\n              },\n              \"ctrl+enter\": function () {\n                n.isReadonly(this) || n.createTask({}, this.taskId);\n              }\n            }\n          }), n.$keyboardNavigation.HeaderCell.prototype.bindAll(n.$keyboardNavigation.HeaderCell.prototype.keys);\n        }(e), function (n) {\n          n.$keyboardNavigation.TaskRow = function (i) {\n            if (!i) {\n              var a = n.getChildren(n.config.root_id);\n              a[0] && (i = a[0]);\n            }\n            this.taskId = i, n.isTaskExists(this.taskId) && (this.index = n.getTaskIndex(this.taskId), this.globalIndex = n.getGlobalTaskIndex(this.taskId), this.splitItem = !!n.getTask(this.taskId).$split_subtask, this.parentId = n.getParent(this.taskId));\n          }, n.$keyboardNavigation.TaskRow.prototype = n._compose(n.$keyboardNavigation.KeyNavNode, {\n            _handlers: null,\n            isValid: function () {\n              return n.isTaskExists(this.taskId) && n.getTaskIndex(this.taskId) > -1;\n            },\n            fallback: function () {\n              if (!n.getVisibleTaskCount()) {\n                var i = new n.$keyboardNavigation.HeaderCell();\n                return i.isValid() ? i : null;\n              }\n              if (this.splitItem) return new n.$keyboardNavigation.TaskRow(this.parentId);\n              var a = -1;\n              if (n.getTaskByIndex(this.globalIndex - 1)) a = this.globalIndex - 1;else if (n.getTaskByIndex(this.globalIndex + 1)) a = this.globalIndex + 1;else for (var r = this.globalIndex; r >= 0;) {\n                if (n.getTaskByIndex(r)) {\n                  a = r;\n                  break;\n                }\n                r--;\n              }\n              return a > -1 ? new n.$keyboardNavigation.TaskRow(n.getTaskByIndex(a).id) : void 0;\n            },\n            fromDomElement: function (i) {\n              if (n.config.keyboard_navigation_cells) return null;\n              var a = n.locate(i);\n              return n.isTaskExists(a) ? new n.$keyboardNavigation.TaskRow(a) : null;\n            },\n            getNode: function () {\n              if (n.isTaskExists(this.taskId) && n.isTaskVisible(this.taskId)) return n.config.show_grid ? n.$grid.querySelector(`.gantt_row[${n.config.task_attribute}=\"${String(this.taskId).replaceAll('\"', '\\\\\"')}\"]`) : n.getTaskNode(this.taskId);\n            },\n            focus: function (i) {\n              if (!i) {\n                const a = n.getTaskPosition(n.getTask(this.taskId)),\n                  r = n.getTaskHeight(this.taskId),\n                  s = n.getScrollState();\n                let o, l;\n                o = n.$task ? n.$task.offsetWidth : s.inner_width, l = n.$grid_data || n.$task_data ? (n.$grid_data || n.$task_data).offsetHeight : s.inner_height;\n                const c = n.config.show_chart && n.$ui.getView(\"timeline\");\n                a.top < s.y || a.top + r > s.y + l ? n.scrollTo(null, a.top - 20) : n.config.scroll_on_click && c && (a.left > s.x + o ? n.scrollTo(a.left - n.config.task_scroll_offset) : a.left + a.width < s.x && n.scrollTo(a.left + a.width - n.config.task_scroll_offset));\n              }\n              n.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [i]), function () {\n                var a = n.$ui.getView(\"grid\");\n                if (a && a.$grid_data) {\n                  var r = parseInt(a.$grid.scrollLeft),\n                    s = parseInt(a.$grid_data.scrollTop),\n                    o = a.$config.scrollX;\n                  if (o && a.$config.scrollable) {\n                    var l = n.$ui.getView(o);\n                    l && l.scrollTo(r, s);\n                  }\n                  var c = a.$config.scrollY;\n                  if (c) {\n                    var d = n.$ui.getView(c);\n                    d && d.scrollTo(r, s);\n                  }\n                }\n              }();\n            },\n            keys: {\n              pagedown: function () {\n                n.getVisibleTaskCount() && this.moveTo(new n.$keyboardNavigation.TaskRow(n.getTaskByIndex(n.getVisibleTaskCount() - 1).id));\n              },\n              pageup: function () {\n                n.getVisibleTaskCount() && this.moveTo(new n.$keyboardNavigation.TaskRow(n.getTaskByIndex(0).id));\n              },\n              up: function () {\n                var i = null,\n                  a = n.getPrev(this.taskId);\n                i = n.isTaskExists(a) ? new n.$keyboardNavigation.TaskRow(a) : new n.$keyboardNavigation.HeaderCell(), this.moveTo(i);\n              },\n              down: function () {\n                var i = n.getNext(this.taskId);\n                n.isTaskExists(i) && this.moveTo(new n.$keyboardNavigation.TaskRow(i));\n              },\n              \"shift+down\": function () {\n                n.hasChild(this.taskId) && !n.getTask(this.taskId).$open && n.open(this.taskId);\n              },\n              \"shift+up\": function () {\n                n.hasChild(this.taskId) && n.getTask(this.taskId).$open && n.close(this.taskId);\n              },\n              \"shift+right\": function () {\n                if (!n.isReadonly(this)) {\n                  var i = n.getPrevSibling(this.taskId);\n                  n.isTaskExists(i) && !n.isChildOf(this.taskId, i) && (n.getTask(i).$open = !0, n.moveTask(this.taskId, -1, i) !== !1 && n.updateTask(this.taskId));\n                }\n              },\n              \"shift+left\": function () {\n                if (!n.isReadonly(this)) {\n                  var i = n.getParent(this.taskId);\n                  n.isTaskExists(i) && n.moveTask(this.taskId, n.getTaskIndex(i) + 1, n.getParent(i)) !== !1 && n.updateTask(this.taskId);\n                }\n              },\n              space: function (i) {\n                n.isSelectedTask(this.taskId) ? n.unselectTask(this.taskId) : n.selectTask(this.taskId);\n              },\n              \"ctrl+left\": function (i) {\n                n.close(this.taskId);\n              },\n              \"ctrl+right\": function (i) {\n                n.open(this.taskId);\n              },\n              delete: function (i) {\n                n.isReadonly(this) || n.$click.buttons.delete(this.taskId);\n              },\n              enter: function () {\n                n.isReadonly(this) || n.showLightbox(this.taskId);\n              },\n              \"ctrl+enter\": function () {\n                n.isReadonly(this) || n.createTask({}, this.taskId);\n              }\n            }\n          }), n.$keyboardNavigation.TaskRow.prototype.bindAll(n.$keyboardNavigation.TaskRow.prototype.keys);\n        }(e), function (n) {\n          n.$keyboardNavigation.TaskCell = function (i, a) {\n            if (!(i = at(i, n.config.root_id))) {\n              var r = n.getChildren(n.config.root_id);\n              r[0] && (i = r[0]);\n            }\n            this.taskId = i, this.columnIndex = a || 0, n.isTaskExists(this.taskId) && (this.index = n.getTaskIndex(this.taskId), this.globalIndex = n.getGlobalTaskIndex(this.taskId));\n          }, n.$keyboardNavigation.TaskCell.prototype = n._compose(n.$keyboardNavigation.TaskRow, {\n            _handlers: null,\n            isValid: function () {\n              return n.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!n.getGridColumns()[this.columnIndex];\n            },\n            fallback: function () {\n              var i = n.$keyboardNavigation.TaskRow.prototype.fallback.call(this),\n                a = i;\n              if (i instanceof n.$keyboardNavigation.TaskRow) {\n                for (var r = n.getGridColumns(), s = this.columnIndex; s >= 0 && !r[s];) s--;\n                r[s] && (a = new n.$keyboardNavigation.TaskCell(i.taskId, s));\n              }\n              return a;\n            },\n            fromDomElement: function (i) {\n              if (!n.config.keyboard_navigation_cells) return null;\n              var a = n.locate(i);\n              if (n.isTaskExists(a)) {\n                var r = 0,\n                  s = nt(i, \"data-column-index\");\n                return s && (r = 1 * s.getAttribute(\"data-column-index\")), new n.$keyboardNavigation.TaskCell(a, r);\n              }\n              return null;\n            },\n            getNode: function () {\n              if (n.isTaskExists(this.taskId) && (n.isTaskVisible(this.taskId) || n.config.show_tasks_outside_timescale)) {\n                if (n.config.show_grid && n.$grid) {\n                  var i = n.$grid.querySelector(\".gantt_row[\" + n.config.task_attribute + \"='\" + this.taskId + \"']\");\n                  return i ? i.querySelector(\"[data-column-index='\" + this.columnIndex + \"']\") : null;\n                }\n                return n.getTaskNode(this.taskId);\n              }\n            },\n            keys: {\n              up: function () {\n                var i = null,\n                  a = n.getPrev(this.taskId);\n                i = n.isTaskExists(a) ? new n.$keyboardNavigation.TaskCell(a, this.columnIndex) : new n.$keyboardNavigation.HeaderCell(this.columnIndex), this.moveTo(i);\n              },\n              down: function () {\n                var i = n.getNext(this.taskId);\n                n.isTaskExists(i) && this.moveTo(new n.$keyboardNavigation.TaskCell(i, this.columnIndex));\n              },\n              left: function () {\n                this.columnIndex > 0 && this.moveTo(new n.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\n              },\n              right: function () {\n                var i = n.getGridColumns();\n                this.columnIndex < i.length - 1 && this.moveTo(new n.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\n              },\n              end: function () {\n                var i = n.getGridColumns();\n                this.moveTo(new n.$keyboardNavigation.TaskCell(this.taskId, i.length - 1));\n              },\n              home: function () {\n                this.moveTo(new n.$keyboardNavigation.TaskCell(this.taskId, 0));\n              },\n              pagedown: function () {\n                n.getVisibleTaskCount() && this.moveTo(new n.$keyboardNavigation.TaskCell(n.getTaskByIndex(n.getVisibleTaskCount() - 1).id, this.columnIndex));\n              },\n              pageup: function () {\n                n.getVisibleTaskCount() && this.moveTo(new n.$keyboardNavigation.TaskCell(n.getTaskByIndex(0).id, this.columnIndex));\n              }\n            }\n          }), n.$keyboardNavigation.TaskCell.prototype.bindAll(n.$keyboardNavigation.TaskRow.prototype.keys), n.$keyboardNavigation.TaskCell.prototype.bindAll(n.$keyboardNavigation.TaskCell.prototype.keys);\n        }(e), Rn(e), function (n) {\n          n.$keyboardNavigation.dispatcher = {\n            isActive: !1,\n            activeNode: null,\n            globalNode: new n.$keyboardNavigation.GanttNode(),\n            enable: function () {\n              this.isActive = !0, this.setActiveNode(this.getActiveNode());\n            },\n            disable: function () {\n              this.isActive = !1;\n            },\n            isEnabled: function () {\n              return !!this.isActive;\n            },\n            getDefaultNode: function () {\n              var i;\n              return (i = n.config.keyboard_navigation_cells ? new n.$keyboardNavigation.TaskCell() : new n.$keyboardNavigation.TaskRow()).isValid() || (i = i.fallback()), i;\n            },\n            setDefaultNode: function () {\n              this.setActiveNode(this.getDefaultNode());\n            },\n            getActiveNode: function () {\n              var i = this.activeNode;\n              return i && !i.isValid() && (i = i.fallback()), i;\n            },\n            fromDomElement: function (i) {\n              for (var a = [n.$keyboardNavigation.TaskRow, n.$keyboardNavigation.TaskCell, n.$keyboardNavigation.HeaderCell], r = 0; r < a.length; r++) if (a[r].prototype.fromDomElement) {\n                var s = a[r].prototype.fromDomElement(i);\n                if (s) return s;\n              }\n              return null;\n            },\n            focusGlobalNode: function () {\n              this.blurNode(this.globalNode), this.focusNode(this.globalNode);\n            },\n            setActiveNode: function (i) {\n              var a = !0;\n              this.activeNode && this.activeNode.compareTo(i) && (a = !1), this.isEnabled() && (a && this.blurNode(this.activeNode), this.activeNode = i, this.focusNode(this.activeNode, !a));\n            },\n            focusNode: function (i, a) {\n              i && i.focus && i.focus(a);\n            },\n            blurNode: function (i) {\n              i && i.blur && i.blur();\n            },\n            keyDownHandler: function (i) {\n              if (!n.$keyboardNavigation.isModal() && this.isEnabled() && !i.defaultPrevented) {\n                var a = this.globalNode,\n                  r = n.$keyboardNavigation.shortcuts.getCommandFromEvent(i),\n                  s = this.getActiveNode();\n                n.$keyboardNavigation.facade.callEvent(\"onKeyDown\", [r, i]) !== !1 && (s ? s.findHandler(r) ? s.doAction(r, i) : a.findHandler(r) && a.doAction(r, i) : this.setDefaultNode());\n              }\n            },\n            _timeout: null,\n            awaitsFocus: function () {\n              return this._timeout !== null;\n            },\n            delay: function (i, a) {\n              clearTimeout(this._timeout), this._timeout = setTimeout(n.bind(function () {\n                this._timeout = null, i();\n              }, this), a || 1);\n            },\n            clearDelay: function () {\n              clearTimeout(this._timeout);\n            }\n          };\n        }(e), function () {\n          var n = e.$keyboardNavigation.dispatcher;\n          n.isTaskFocused = function (k) {\n            var b = n.activeNode;\n            return (b instanceof e.$keyboardNavigation.TaskRow || b instanceof e.$keyboardNavigation.TaskCell) && b.taskId == k;\n          };\n          var i = function (k) {\n              if (e.config.keyboard_navigation && (e.config.keyboard_navigation_cells || !s(k)) && !o(k) && !function (b) {\n                return !!dt(b.target, \".gantt_cal_light\");\n              }(k)) return n.keyDownHandler(k);\n            },\n            a = function (k) {\n              if (n.$preventDefault) return k.preventDefault(), e.$container.blur(), !1;\n              n.awaitsFocus() || n.focusGlobalNode();\n            },\n            r = function () {\n              if (!n.isEnabled()) return;\n              const k = !Y(document.activeElement, e.$container) && document.activeElement.localName != \"body\";\n              var b = n.getActiveNode();\n              if (b && !k) {\n                var g,\n                  m,\n                  f = b.getNode();\n                f && f.parentNode && (g = f.parentNode.scrollTop, m = f.parentNode.scrollLeft), b.focus(!0), f && f.parentNode && (f.parentNode.scrollTop = g, f.parentNode.scrollLeft = m);\n              }\n            };\n          function s(k) {\n            return !!dt(k.target, \".gantt_grid_editor_placeholder\");\n          }\n          function o(k) {\n            return !!dt(k.target, \".no_keyboard_navigation\");\n          }\n          function l(k) {\n            if (!e.config.keyboard_navigation || !e.config.keyboard_navigation_cells && s(k)) return !0;\n            if (!o(k)) {\n              var b,\n                g = n.fromDomElement(k);\n              if (g && (n.activeNode instanceof e.$keyboardNavigation.TaskCell && Y(k.target, e.$task) && (g = new e.$keyboardNavigation.TaskCell(g.taskId, n.activeNode.columnIndex)), b = g, e.config.show_grid && e.$ui.getView(\"grid\") && e.config.keyboard_navigation_cells)) {\n                const m = k.target.classList.contains(\"gantt_row\"),\n                  f = k.target.closest(\".gantt_task_line\"),\n                  v = e.utils.dom.getNodePosition(e.$grid).x,\n                  x = v + e.$grid.offsetWidth,\n                  $ = e.utils.dom.getNodePosition(document.activeElement).x;\n                if (m || f && ($ < v || x < $)) {\n                  let w = e.$grid.scrollLeft;\n                  const S = w + e.$grid.offsetWidth;\n                  let T = 0;\n                  m && (w = e.utils.dom.getRelativeEventPosition(k, e.$grid).x);\n                  for (let E = 0; E < e.config.columns.length; E++) {\n                    const C = e.config.columns[E];\n                    if (!C.hide && (T += C.width, w < T)) {\n                      S < T && (T -= C.width), b.columnIndex = E;\n                      break;\n                    }\n                  }\n                }\n              }\n              b ? n.isEnabled() ? n.delay(function () {\n                n.setActiveNode(b);\n              }) : n.activeNode = b : (n.$preventDefault = !0, setTimeout(function () {\n                n.$preventDefault = !1;\n              }, 300));\n            }\n          }\n          e.attachEvent(\"onDataRender\", function () {\n            e.config.keyboard_navigation && r();\n          }), e.attachEvent(\"onGanttRender\", function () {\n            e.$root && (e.eventRemove(e.$root, \"keydown\", i), e.eventRemove(e.$container, \"focus\", a), e.eventRemove(e.$container, \"mousedown\", l), e.config.keyboard_navigation ? (e.event(e.$root, \"keydown\", i), e.event(e.$container, \"focus\", a), e.event(e.$container, \"mousedown\", l), e.$container.setAttribute(\"tabindex\", \"0\")) : e.$container.removeAttribute(\"tabindex\"));\n          });\n          var c = e.attachEvent(\"onGanttReady\", function () {\n            if (e.detachEvent(c), e.$data.tasksStore.attachEvent(\"onStoreUpdated\", function (b) {\n              if (e.config.keyboard_navigation && n.isEnabled()) {\n                const g = n.getActiveNode(),\n                  m = e.$ui.getView(\"grid\");\n                if (!m || !m.$grid_data) return;\n                const f = m.getItemTop(b),\n                  v = m.$grid_data.scrollTop,\n                  x = v + m.$grid_data.getBoundingClientRect().height;\n                g && g.taskId == b && v <= f && x >= f && r();\n              }\n            }), e._smart_render) {\n              var k = e._smart_render._redrawTasks;\n              e._smart_render._redrawTasks = function (b, g) {\n                if (e.config.keyboard_navigation && n.isEnabled()) {\n                  var m = n.getActiveNode();\n                  if (m && m.taskId !== void 0) {\n                    for (var f = !1, v = 0; v < g.length; v++) if (g[v].id == m.taskId && g[v].start_date) {\n                      f = !0;\n                      break;\n                    }\n                    f || g.push(e.getTask(m.taskId));\n                  }\n                }\n                return k.apply(this, arguments);\n              };\n            }\n          });\n          let d = null,\n            u = !1;\n          e.attachEvent(\"onTaskCreated\", function (k) {\n            return d = k.id, !0;\n          }), e.attachEvent(\"onAfterTaskAdd\", function (k, b) {\n            if (!e.config.keyboard_navigation) return !0;\n            if (n.isEnabled()) {\n              if (k == d && (u = !0, setTimeout(() => {\n                u = !1, d = null;\n              })), u && b.type == e.config.types.placeholder) return;\n              var g = 0,\n                m = n.activeNode;\n              m instanceof e.$keyboardNavigation.TaskCell && (g = m.columnIndex);\n              var f = e.config.keyboard_navigation_cells ? e.$keyboardNavigation.TaskCell : e.$keyboardNavigation.TaskRow;\n              b.type == e.config.types.placeholder && e.config.placeholder_task.focusOnCreate === !1 || n.setActiveNode(new f(k, g));\n            }\n          }), e.attachEvent(\"onTaskIdChange\", function (k, b) {\n            if (!e.config.keyboard_navigation) return !0;\n            var g = n.activeNode;\n            return n.isTaskFocused(k) && (g.taskId = b), !0;\n          });\n          var h = setInterval(function () {\n            e.config.keyboard_navigation && (n.isEnabled() || n.enable());\n          }, 500);\n          function _(k) {\n            var b = {\n              gantt: e.$keyboardNavigation.GanttNode,\n              headerCell: e.$keyboardNavigation.HeaderCell,\n              taskRow: e.$keyboardNavigation.TaskRow,\n              taskCell: e.$keyboardNavigation.TaskCell\n            };\n            return b[k] || b.gantt;\n          }\n          function p(k) {\n            for (var b = e.getGridColumns(), g = 0; g < b.length; g++) if (b[g].name == k) return g;\n            return 0;\n          }\n          e.attachEvent(\"onDestroy\", function () {\n            clearInterval(h);\n          });\n          var y = {};\n          ot(y), e.mixin(y, {\n            addShortcut: function (k, b, g) {\n              var m = _(g);\n              m && m.prototype.bind(k, b);\n            },\n            getShortcutHandler: function (k, b) {\n              var g = e.$keyboardNavigation.shortcuts.parse(k);\n              if (g.length) return y.getCommandHandler(g[0], b);\n            },\n            getCommandHandler: function (k, b) {\n              var g = _(b);\n              if (g && k) return g.prototype.findHandler(k);\n            },\n            removeShortcut: function (k, b) {\n              var g = _(b);\n              g && g.prototype.unbind(k);\n            },\n            focus: function (k) {\n              var b,\n                g = k ? k.type : null,\n                m = _(g);\n              switch (g) {\n                case \"taskCell\":\n                  b = new m(k.id, p(k.column));\n                  break;\n                case \"taskRow\":\n                  b = new m(k.id);\n                  break;\n                case \"headerCell\":\n                  b = new m(p(k.column));\n              }\n              n.delay(function () {\n                b ? n.setActiveNode(b) : (n.enable(), n.getActiveNode() ? n.awaitsFocus() || n.enable() : n.setDefaultNode());\n              });\n            },\n            getActiveNode: function () {\n              if (n.isEnabled()) {\n                var k = n.getActiveNode(),\n                  b = (m = k) instanceof e.$keyboardNavigation.GanttNode ? \"gantt\" : m instanceof e.$keyboardNavigation.HeaderCell ? \"headerCell\" : m instanceof e.$keyboardNavigation.TaskRow ? \"taskRow\" : m instanceof e.$keyboardNavigation.TaskCell ? \"taskCell\" : null,\n                  g = e.getGridColumns();\n                switch (b) {\n                  case \"taskCell\":\n                    return {\n                      type: \"taskCell\",\n                      id: k.taskId,\n                      column: g[k.columnIndex].name\n                    };\n                  case \"taskRow\":\n                    return {\n                      type: \"taskRow\",\n                      id: k.taskId\n                    };\n                  case \"headerCell\":\n                    return {\n                      type: \"headerCell\",\n                      column: g[k.index].name\n                    };\n                }\n              }\n              var m;\n              return null;\n            }\n          }), e.$keyboardNavigation.facade = y, e.ext.keyboardNavigation = y, e.focus = function () {\n            y.focus();\n          }, e.addShortcut = y.addShortcut, e.getShortcutHandler = y.getShortcutHandler, e.removeShortcut = y.removeShortcut;\n        }();\n      })(t);\n    },\n    quick_info: function (t) {\n      t.ext || (t.ext = {}), t.ext.quickInfo = new Hn(t), t.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"], t.config.quick_info_detached = !0, t.config.show_quick_info = !0, t.templates.quick_info_title = function (a, r, s) {\n        return s.text.substr(0, 50);\n      }, t.templates.quick_info_content = function (a, r, s) {\n        return s.details || s.text;\n      }, t.templates.quick_info_date = function (a, r, s) {\n        return t.templates.task_time(a, r, s);\n      }, t.templates.quick_info_class = function (a, r, s) {\n        return \"\";\n      }, t.attachEvent(\"onTaskClick\", function (a, r) {\n        const s = t.utils.dom.closest(r.target, \".gantt_add\"),\n          o = t.utils.dom.closest(r.target, \".gantt_close\"),\n          l = t.utils.dom.closest(r.target, \".gantt_open\");\n        return !s && !o && !l && setTimeout(function () {\n          t.ext.quickInfo.show(a);\n        }, 0), !0;\n      });\n      const e = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"],\n        n = function () {\n          return t.ext.quickInfo.hide(), !0;\n        };\n      for (let a = 0; a < e.length; a++) t.attachEvent(e[a], n);\n      function i() {\n        return t.ext.quickInfo.hide(), t.ext.quickInfo._quickInfoBox = null, !0;\n      }\n      t.attachEvent(\"onEmptyClick\", function (a) {\n        let r = !0;\n        const s = document.querySelector(\".gantt_cal_quick_info\");\n        s && t.utils.dom.isChildOf(a.target, s) && (r = !1), r && n();\n      }), t.attachEvent(\"onGanttReady\", i), t.attachEvent(\"onDestroy\", i), t.event(window, \"keydown\", function (a) {\n        a.keyCode === 27 && t.ext.quickInfo.hide();\n      }), t.showQuickInfo = function () {\n        t.ext.quickInfo.show.apply(t.ext.quickInfo, arguments);\n      }, t.hideQuickInfo = function () {\n        t.ext.quickInfo.hide.apply(t.ext.quickInfo, arguments);\n      };\n    },\n    tooltip: function (t) {\n      t.config.tooltip_timeout = 30, t.config.tooltip_offset_y = 20, t.config.tooltip_offset_x = 10, t.config.tooltip_hide_timeout = 30;\n      const e = new Wn(t);\n      t.ext.tooltips = e, t.attachEvent(\"onGanttReady\", function () {\n        t.$root && e.tooltipFor({\n          selector: \"[\" + t.config.task_attribute + \"]:not(.gantt_task_row)\",\n          html: n => {\n            if (t.config.touch && !t.config.touch_tooltip) return;\n            const i = t.locate(n);\n            if (t.isTaskExists(i)) {\n              const a = t.getTask(i);\n              return t.templates.tooltip_text(a.start_date, a.end_date, a);\n            }\n            return null;\n          },\n          global: !1\n        });\n      }), t.attachEvent(\"onDestroy\", function () {\n        e.destructor();\n      }), t.attachEvent(\"onLightbox\", function () {\n        e.hideTooltip();\n      }), t.attachEvent(\"onBeforeTooltip\", function () {\n        if (t.getState().link_source_id) return !1;\n      }), t.attachEvent(\"onGanttScroll\", function () {\n        e.hideTooltip();\n      });\n    },\n    undo: function (t) {\n      const e = new Fn(t),\n        n = new jn(e, t);\n      function i(d, u) {\n        return String(d) === String(u);\n      }\n      function a(d, u, h) {\n        d && (i(d.id, u) && (d.id = h), i(d.parent, u) && (d.parent = h));\n      }\n      function r(d, u, h) {\n        a(d.value, u, h), a(d.oldValue, u, h);\n      }\n      function s(d, u, h) {\n        d && (i(d.source, u) && (d.source = h), i(d.target, u) && (d.target = h));\n      }\n      function o(d, u, h) {\n        s(d.value, u, h), s(d.oldValue, u, h);\n      }\n      function l(d, u, h) {\n        const _ = e;\n        for (let p = 0; p < d.length; p++) {\n          const y = d[p];\n          for (let k = 0; k < y.commands.length; k++) y.commands[k].entity === _.command.entity.task ? r(y.commands[k], u, h) : y.commands[k].entity === _.command.entity.link && o(y.commands[k], u, h);\n        }\n      }\n      function c(d, u, h) {\n        const _ = e;\n        for (let p = 0; p < d.length; p++) {\n          const y = d[p];\n          for (let k = 0; k < y.commands.length; k++) {\n            const b = y.commands[k];\n            b.entity === _.command.entity.link && (b.value && b.value.id === u && (b.value.id = h), b.oldValue && b.oldValue.id === u && (b.oldValue.id = h));\n          }\n        }\n      }\n      t.config.undo = !0, t.config.redo = !0, t.config.undo_types = {\n        link: \"link\",\n        task: \"task\"\n      }, t.config.undo_actions = {\n        update: \"update\",\n        remove: \"remove\",\n        add: \"add\",\n        move: \"move\"\n      }, t.ext || (t.ext = {}), t.ext.undo = {\n        undo: () => e.undo(),\n        redo: () => e.redo(),\n        getUndoStack: () => e.getUndoStack(),\n        setUndoStack: d => e.setUndoStack(d),\n        getRedoStack: () => e.getRedoStack(),\n        setRedoStack: d => e.setRedoStack(d),\n        clearUndoStack: () => e.clearUndoStack(),\n        clearRedoStack: () => e.clearRedoStack(),\n        saveState: (d, u) => n.store(d, u, !0),\n        getInitialState: (d, u) => u === t.config.undo_types.link ? n.getInitialLink(d) : n.getInitialTask(d)\n      }, t.undo = t.ext.undo.undo, t.redo = t.ext.undo.redo, t.getUndoStack = t.ext.undo.getUndoStack, t.getRedoStack = t.ext.undo.getRedoStack, t.clearUndoStack = t.ext.undo.clearUndoStack, t.clearRedoStack = t.ext.undo.clearRedoStack, t.attachEvent(\"onTaskIdChange\", (d, u) => {\n        const h = e;\n        l(h.getUndoStack(), d, u), l(h.getRedoStack(), d, u);\n      }), t.attachEvent(\"onLinkIdChange\", (d, u) => {\n        const h = e;\n        c(h.getUndoStack(), d, u), c(h.getRedoStack(), d, u);\n      }), t.attachEvent(\"onGanttReady\", () => {\n        e.updateConfigs();\n      });\n    },\n    marker: function (t) {\n      function e(i) {\n        if (!t.config.show_markers || !i.start_date) return !1;\n        var a = t.getState();\n        if (+i.start_date > +a.max_date || (!i.end_date || +i.end_date < +a.min_date) && +i.start_date < +a.min_date) return;\n        var r = document.createElement(\"div\");\n        r.setAttribute(\"data-marker-id\", i.id);\n        var s = \"gantt_marker\";\n        t.templates.marker_class && (s += \" \" + t.templates.marker_class(i)), i.css && (s += \" \" + i.css), t.templates.marker_class && (s += \" \" + t.templates.marker_class(i)), i.title && (r.title = i.title), r.className = s;\n        var o = t.posFromDate(i.start_date);\n        r.style.left = o + \"px\";\n        let l = Math.max(t.getRowTop(t.getVisibleTaskCount()), 0) + \"px\";\n        if (t.config.timeline_placeholder && t.$task_data && (l = t.$task_data.scrollHeight + \"px\"), r.style.height = l, i.end_date) {\n          var c = t.posFromDate(i.end_date);\n          r.style.width = Math.max(c - o, 0) + \"px\";\n        }\n        if (i.text) {\n          let d = null;\n          d = typeof i.text == \"function\" ? i.text(i) : i.text, d && (t.config.external_render && t.config.external_render.isElement(d) ? (r.innerHTML = \"<div class='gantt_marker_content' ></div>\", t.config.external_render.renderElement(d, r.querySelector(\".gantt_marker_content\"))) : r.innerHTML = \"<div class='gantt_marker_content' >\" + i.text + \"</div>\");\n        }\n        return r;\n      }\n      function n() {\n        if (t.$task_data && t.$root.contains(t.$task_data)) {\n          if (!t.$marker_area || !t.$task_data.contains(t.$marker_area)) {\n            var i = document.createElement(\"div\");\n            i.className = \"gantt_marker_area\", t.$task_data.appendChild(i), t.$marker_area = i;\n          }\n        } else t.$marker_area = null;\n      }\n      t._markers || (t._markers = t.createDatastore({\n        name: \"marker\",\n        initItem: function (i) {\n          return i.id = i.id || t.uid(), i;\n        }\n      })), t.config.show_markers = !0, t.attachEvent(\"onBeforeGanttRender\", function () {\n        t.$marker_area || n();\n      }), t.attachEvent(\"onDataRender\", function () {\n        t.$marker_area || (n(), t.renderMarkers());\n      }), t.attachEvent(\"onGanttLayoutReady\", function () {\n        t.attachEvent(\"onBeforeGanttRender\", function () {\n          t.$marker_area && (t.$marker_area.innerHTML = \"\"), n(), t.$services.getService(\"layers\").createDataRender({\n            name: \"marker\",\n            defaultContainer: function () {\n              return t.$marker_area;\n            }\n          }).addLayer(e);\n        }, {\n          once: !0\n        });\n      }), t.getMarker = function (i) {\n        return this._markers ? this._markers.getItem(i) : null;\n      }, t.addMarker = function (i) {\n        return this._markers.addItem(i);\n      }, t.deleteMarker = function (i) {\n        return !!this._markers.exists(i) && (this._markers.removeItem(i), !0);\n      }, t.updateMarker = function (i) {\n        this._markers.refresh(i);\n      }, t._getMarkers = function () {\n        return this._markers.getItems();\n      }, t.renderMarkers = function () {\n        this._markers.refresh();\n      };\n    },\n    multiselect: function (t) {\n      t.config.multiselect = !0, t.config.multiselect_one_level = !1, t._multiselect = {\n        _selected: {},\n        _one_level: !1,\n        _active: !0,\n        _first_selected_when_shift: null,\n        getDefaultSelected: function () {\n          var e = this.getSelected();\n          return e.length ? e[e.length - 1] : null;\n        },\n        setFirstSelected: function (e) {\n          this._first_selected_when_shift = e;\n        },\n        getFirstSelected: function () {\n          return this._first_selected_when_shift;\n        },\n        isActive: function () {\n          return this.updateState(), this._active;\n        },\n        updateState: function () {\n          this._one_level = t.config.multiselect_one_level;\n          var e = this._active;\n          this._active = t.config.select_task, this._active != e && this.reset();\n        },\n        reset: function () {\n          this._selected = {};\n        },\n        setLastSelected: function (e) {\n          t.$data.tasksStore.silent(function () {\n            var n = t.$data.tasksStore;\n            e ? n.select(e + \"\") : n.unselect(null);\n          });\n        },\n        getLastSelected: function () {\n          var e = t.$data.tasksStore.getSelectedId();\n          return e && t.isTaskExists(e) ? e : null;\n        },\n        select: function (e, n) {\n          return !!(e && t.callEvent(\"onBeforeTaskMultiSelect\", [e, !0, n]) && t.callEvent(\"onBeforeTaskSelected\", [e])) && (this._selected[e] = !0, this.setLastSelected(e), this.afterSelect(e), t.callEvent(\"onTaskMultiSelect\", [e, !0, n]), t.callEvent(\"onTaskSelected\", [e]), !0);\n        },\n        toggle: function (e, n) {\n          this._selected[e] ? this.unselect(e, n) : this.select(e, n);\n        },\n        unselect: function (e, n) {\n          e && t.callEvent(\"onBeforeTaskMultiSelect\", [e, !1, n]) && (this._selected[e] = !1, this.getLastSelected() == e && this.setLastSelected(this.getDefaultSelected()), this.afterSelect(e), t.callEvent(\"onTaskMultiSelect\", [e, !1, n]), t.callEvent(\"onTaskUnselected\", [e]));\n        },\n        isSelected: function (e) {\n          return !(!t.isTaskExists(e) || !this._selected[e]);\n        },\n        getSelected: function () {\n          var e = [];\n          for (var n in this._selected) this._selected[n] && t.isTaskExists(n) ? e.push(n) : this._selected[n] = !1;\n          return e.sort(function (i, a) {\n            return t.getGlobalTaskIndex(i) > t.getGlobalTaskIndex(a) ? 1 : -1;\n          }), e;\n        },\n        forSelected: function (e) {\n          for (var n = this.getSelected(), i = 0; i < n.length; i++) e(n[i]);\n        },\n        isSameLevel: function (e) {\n          if (!this._one_level) return !0;\n          var n = this.getLastSelected();\n          return !n || !t.isTaskExists(n) || !t.isTaskExists(e) || t.calculateTaskLevel(t.getTask(n)) == t.calculateTaskLevel(t.getTask(e));\n        },\n        afterSelect: function (e) {\n          t.isTaskExists(e) && t._quickRefresh(function () {\n            t.refreshTask(e);\n          });\n        },\n        doSelection: function (e) {\n          if (!this.isActive() || t._is_icon_open_click(e)) return !1;\n          var n = t.locate(e);\n          if (!n || !t.callEvent(\"onBeforeMultiSelect\", [e])) return !1;\n          var i = this.getSelected(),\n            a = this.getFirstSelected(),\n            r = !1,\n            s = this.getLastSelected(),\n            o = t.config.multiselect,\n            l = function () {\n              const d = t.ext.inlineEditors;\n              if (d && d.getState) {\n                const h = d.getState(),\n                  _ = d.locateCell(e.target);\n                t.config.inline_editors_multiselect_open && _ && d.getEditorConfig(_.columnName) && (d.isVisible() && h.id == _.id && h.columnName == _.columnName || d.startEdit(_.id, _.columnName));\n              }\n              this.setFirstSelected(n), this.isSelected(n) || this.select(n, e), i = this.getSelected();\n              for (var u = 0; u < i.length; u++) i[u] !== n && this.unselect(i[u], e);\n            }.bind(this),\n            c = function () {\n              if (s) {\n                if (n) {\n                  var d = t.getGlobalTaskIndex(this.getFirstSelected()),\n                    u = t.getGlobalTaskIndex(n),\n                    h = t.getGlobalTaskIndex(s);\n                  d != -1 && h != -1 || (d = u, this.reset());\n                  for (var _ = s; t.getGlobalTaskIndex(_) !== d;) this.unselect(_, e), _ = d > h ? t.getNext(_) : t.getPrev(_);\n                  for (_ = n; t.getGlobalTaskIndex(_) !== d;) this.select(_, e) && !r && (r = !0, a = _), _ = d > u ? t.getNext(_) : t.getPrev(_);\n                }\n              } else s = n;\n            }.bind(this);\n          return o && (e.ctrlKey || e.metaKey) ? (this.isSelected(n) || this.setFirstSelected(n), n && this.toggle(n, e)) : o && e.shiftKey ? (t.isTaskExists(this.getFirstSelected()) && this.getFirstSelected() !== null || this.setFirstSelected(n), i.length ? c() : l()) : l(), this.isSelected(n) ? this.setLastSelected(n) : a ? n == s && this.setLastSelected(e.shiftKey ? a : this.getDefaultSelected()) : this.setLastSelected(null), this.getSelected().length || this.setLastSelected(null), this.getLastSelected() && this.isSelected(this.getFirstSelected()) || this.setFirstSelected(this.getLastSelected()), !0;\n        }\n      }, function () {\n        var e = t.selectTask;\n        t.selectTask = function (i) {\n          if (!(i = at(i, this.config.root_id))) return !1;\n          var a = t._multiselect,\n            r = i;\n          return a.isActive() ? (a.select(i, null) && a.setLastSelected(i), a.setFirstSelected(a.getLastSelected())) : r = e.call(this, i), r;\n        };\n        var n = t.unselectTask;\n        t.unselectTask = function (i) {\n          var a = t._multiselect,\n            r = a.isActive();\n          (i = i || a.getLastSelected()) && r && (a.unselect(i, null), i == a.getLastSelected() && a.setLastSelected(null), t.refreshTask(i), a.setFirstSelected(a.getLastSelected()));\n          var s = i;\n          return r || (s = n.call(this, i)), s;\n        }, t.toggleTaskSelection = function (i) {\n          var a = t._multiselect;\n          i && a.isActive() && (a.toggle(i), a.setFirstSelected(a.getLastSelected()));\n        }, t.getSelectedTasks = function () {\n          var i = t._multiselect;\n          return i.isActive(), i.getSelected();\n        }, t.eachSelectedTask = function (i) {\n          return this._multiselect.forSelected(i);\n        }, t.isSelectedTask = function (i) {\n          return this._multiselect.isSelected(i);\n        }, t.getLastSelectedTask = function () {\n          return this._multiselect.getLastSelected();\n        }, t.attachEvent(\"onGanttReady\", function () {\n          var i = t.$data.tasksStore.isSelected;\n          t.$data.tasksStore.isSelected = function (a) {\n            return t._multiselect.isActive() ? t._multiselect.isSelected(a) : i.call(this, a);\n          };\n        });\n      }(), t.attachEvent(\"onTaskIdChange\", function (e, n) {\n        var i = t._multiselect;\n        if (!i.isActive()) return !0;\n        t.isSelectedTask(e) && (i.unselect(e, null), i.select(n, null));\n      }), t.attachEvent(\"onAfterTaskDelete\", function (e, n) {\n        var i = t._multiselect;\n        if (!i.isActive()) return !0;\n        i._selected[e] && (i._selected[e] = !1, i.setLastSelected(i.getDefaultSelected())), i.forSelected(function (a) {\n          t.isTaskExists(a) || i.unselect(a, null);\n        });\n      }), t.attachEvent(\"onBeforeTaskMultiSelect\", function (e, n, i) {\n        const a = t._multiselect;\n        if (n && a.isActive()) {\n          let r = t.getSelectedId(),\n            s = null;\n          r && (s = t.getTask(r));\n          let o = t.getTask(e),\n            l = !1;\n          if (s && s.$level != o.$level && (l = !0), t.config.multiselect_one_level && l && !i.ctrlKey && !i.shiftKey) return !0;\n          if (a._one_level) return a.isSameLevel(e);\n        }\n        return !0;\n      }), t.attachEvent(\"onTaskClick\", function (e, n) {\n        return t._multiselect.doSelection(n) && t.callEvent(\"onMultiSelect\", [n]), !0;\n      });\n    },\n    export_api: function (t) {\n      return t.ext = t.ext || {}, t.ext.export_api = t.ext.export_api || {\n        _apiUrl: \"https://export.dhtmlx.com/gantt\",\n        _preparePDFConfigRaw(e, n) {\n          let i = null;\n          e.start && e.end && (i = {\n            start_date: t.config.start_date,\n            end_date: t.config.end_date\n          }, t.config.start_date = t.date.str_to_date(t.config.date_format)(e.start), t.config.end_date = t.date.str_to_date(t.config.date_format)(e.end)), e = t.mixin(e, {\n            name: \"gantt.\" + n,\n            data: t.ext.export_api._serializeHtml()\n          }), i && (t.config.start_date = i.start_date, t.config.end_date = i.end_date);\n        },\n        _prepareConfigPDF: (e, n) => (e = t.mixin(e || {}, {\n          name: \"gantt.\" + n,\n          data: t.ext.export_api._serializeAll(),\n          config: t.config\n        }), t.ext.export_api._fixColumns(e.config.columns), e),\n        _pdfExportRouter(e, n) {\n          e && e.raw ? t.ext.export_api._preparePDFConfigRaw(e, n) : e = t.ext.export_api._prepareConfigPDF(e, n), e.version = t.version, t.ext.export_api._sendToExport(e, n);\n        },\n        exportToPDF(e) {\n          t.ext.export_api._pdfExportRouter(e, \"pdf\");\n        },\n        exportToPNG(e) {\n          t.ext.export_api._pdfExportRouter(e, \"png\");\n        },\n        exportToICal(e) {\n          e = t.mixin(e || {}, {\n            name: \"gantt.ical\",\n            data: t.ext.export_api._serializePlain().data,\n            version: t.version\n          }), t.ext.export_api._sendToExport(e, \"ical\");\n        },\n        exportToExcel(e) {\n          let n, i, a, r;\n          e = e || {};\n          const s = t.config.smart_rendering;\n          if (e.visual === \"base-colors\" && (t.config.smart_rendering = !1), e.start || e.end) {\n            a = t.getState(), i = [t.config.start_date, t.config.end_date], r = t.getScrollState();\n            const o = t.date.str_to_date(t.config.date_format);\n            n = t.eachTask, e.start && (t.config.start_date = o(e.start)), e.end && (t.config.end_date = o(e.end)), t.render(), t.config.smart_rendering = s, t.eachTask = t.ext.export_api._eachTaskTimed(t.config.start_date, t.config.end_date);\n          } else e.visual === \"base-colors\" && (t.render(), t.config.smart_rendering = s);\n          t._no_progress_colors = e.visual === \"base-colors\", (e = t.mixin(e, {\n            name: \"gantt.xlsx\",\n            title: \"Tasks\",\n            data: t.ext.export_api._serializeTimeline(e).data,\n            columns: t.ext.export_api._serializeGrid({\n              rawDates: !0\n            }),\n            version: t.version\n          })).visual && (e.scales = t.ext.export_api._serializeScales(e)), t.ext.export_api._sendToExport(e, \"excel\"), (e.start || e.end) && (t.config.start_date = a.min_date, t.config.end_date = a.max_date, t.eachTask = n, t.render(), t.scrollTo(r.x, r.y), t.config.start_date = i[0], t.config.end_date = i[1]);\n        },\n        exportToJSON(e) {\n          e = t.mixin(e || {}, {\n            name: \"gantt.json\",\n            data: t.ext.export_api._serializeAll(),\n            config: t.config,\n            columns: t.ext.export_api._serializeGrid(),\n            worktime: t.ext.export_api._getWorktimeSettings(),\n            version: t.version\n          }), t.ext.export_api._sendToExport(e, \"json\");\n        },\n        importFromExcel(e) {\n          try {\n            const n = e.data;\n            if (n instanceof File) {\n              const i = new FormData();\n              i.append(\"file\", n), e.data = i;\n            }\n          } catch {}\n          t.ext.export_api._sendImportAjaxExcel(e);\n        },\n        importFromMSProject(e) {\n          const n = e.data;\n          try {\n            if (n instanceof File) {\n              const i = new FormData();\n              i.append(\"file\", n), e.data = i;\n            }\n          } catch {}\n          t.ext.export_api._sendImportAjaxMSP(e);\n        },\n        importFromPrimaveraP6: e => (e.type = \"primaveraP6-parse\", t.importFromMSProject(e)),\n        exportToMSProject(e) {\n          (e = e || {}).skip_circular_links = e.skip_circular_links === void 0 || !!e.skip_circular_links;\n          const n = t.templates.xml_format,\n            i = t.templates.format_date,\n            a = t.config.xml_date,\n            r = t.config.date_format,\n            s = \"%d-%m-%Y %H:%i:%s\";\n          t.config.xml_date = s, t.config.date_format = s, t.templates.xml_format = t.date.date_to_str(s), t.templates.format_date = t.date.date_to_str(s);\n          const o = t.ext.export_api._serializeAll();\n          t.ext.export_api._customProjectProperties(o, e), t.ext.export_api._customTaskProperties(o, e), e.skip_circular_links && t.ext.export_api._clearRecLinks(o), e = t.ext.export_api._exportConfig(o, e), t.ext.export_api._sendToExport(e, e.type || \"msproject\"), t.config.xml_date = a, t.config.date_format = r, t.templates.xml_format = n, t.templates.format_date = i, t.config.$custom_data = null, t.config.custom = null;\n        },\n        exportToPrimaveraP6: e => ((e = e || {}).type = \"primaveraP6\", t.exportToMSProject(e)),\n        _fixColumns(e) {\n          for (let n = 0; n < e.length; n++) e[n].label = e[n].label || t.locale.labels[\"column_\" + e[n].name], typeof e[n].width == \"string\" && (e[n].width = 1 * e[n].width);\n        },\n        _xdr(e, n, i) {\n          t.ajax.post(e, n, i);\n        },\n        _markColumns(e) {\n          const n = e.config.columns;\n          if (n) for (let i = 0; i < n.length; i++) n[i].template && (n[i].$template = !0);\n        },\n        _sendImportAjaxExcel(e) {\n          const n = e.server || t.ext.export_api._apiUrl,\n            i = e.store || 0,\n            a = e.data,\n            r = e.callback;\n          a.append(\"type\", \"excel-parse\"), a.append(\"data\", JSON.stringify({\n            sheet: e.sheet || 0\n          })), i && a.append(\"store\", i);\n          const s = new XMLHttpRequest();\n          s.onreadystatechange = function (o) {\n            s.readyState === 4 && s.status === 0 && r && r(null);\n          }, s.onload = function () {\n            let o = null;\n            if (!(s.status > 400)) try {\n              o = JSON.parse(s.responseText);\n            } catch {}\n            r && r(o);\n          }, s.open(\"POST\", n, !0), s.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\"), s.send(a);\n        },\n        _ajaxToExport(e, n, i) {\n          delete e.callback;\n          const a = e.server || t.ext.export_api._apiUrl,\n            r = \"type=\" + n + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(e));\n          t.ext.export_api._xdr(a, r, function (s) {\n            const o = s.xmlDoc || s;\n            let l = null;\n            if (!(o.status > 400)) try {\n              l = JSON.parse(o.responseText);\n            } catch {}\n            i(l);\n          });\n        },\n        _serializableGanttConfig(e) {\n          const n = t.mixin({}, e);\n          return n.columns && (n.columns = n.columns.map(function (i) {\n            const a = t.mixin({}, i);\n            return delete a.editor, a;\n          })), delete n.editor_types, n;\n        },\n        _sendToExport(e, n) {\n          const i = t.date.date_to_str(t.config.date_format || t.config.xml_date);\n          if (e.skin || (e.skin = t.skin), e.config && (e.config = t.copy(t.ext.export_api._serializableGanttConfig(e.config)), t.ext.export_api._markColumns(e, n), e.config.start_date && e.config.end_date && (e.config.start_date instanceof Date && (e.config.start_date = i(e.config.start_date)), e.config.end_date instanceof Date && (e.config.end_date = i(e.config.end_date)))), e.callback) return t.ext.export_api._ajaxToExport(e, n, e.callback);\n          const a = t.ext.export_api._createHiddenForm();\n          a.firstChild.action = e.server || t.ext.export_api._apiUrl, a.firstChild.childNodes[0].value = JSON.stringify(e), a.firstChild.childNodes[1].value = n, a.firstChild.submit();\n        },\n        _createHiddenForm() {\n          if (!t.ext.export_api._hidden_export_form) {\n            const e = t.ext.export_api._hidden_export_form = document.createElement(\"div\");\n            e.style.display = \"none\", e.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\", document.body.appendChild(e);\n          }\n          return t.ext.export_api._hidden_export_form;\n        },\n        _copyObjectBase(e) {\n          const n = {\n            start_date: void 0,\n            end_date: void 0,\n            constraint_date: void 0,\n            deadline: void 0\n          };\n          for (const a in e) a.charAt(0) !== \"$\" && a !== \"baselines\" && (n[a] = e[a]);\n          const i = t.templates.xml_format || t.templates.format_date;\n          return n.start_date = i(n.start_date), n.end_date && (n.end_date = i(n.end_date)), n.constraint_date && (n.constraint_date = i(n.constraint_date)), n.deadline && (n.deadline = i(n.deadline)), n;\n        },\n        _color_box: null,\n        _color_hash: {},\n        _getStyles(e) {\n          if (t.ext.export_api._color_box || (t.ext.export_api._color_box = document.createElement(\"DIV\"), t.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\", document.body.appendChild(t.ext.export_api._color_box)), t.ext.export_api._color_hash[e]) return t.ext.export_api._color_hash[e];\n          t.ext.export_api._color_box.className = e;\n          const n = t.ext.export_api._getColor(t.ext.export_api._color_box, \"color\"),\n            i = t.ext.export_api._getColor(t.ext.export_api._color_box, \"backgroundColor\");\n          return t.ext.export_api._color_hash[e] = n + \";\" + i;\n        },\n        _getMinutesWorktimeSettings(e) {\n          const n = [];\n          return e.forEach(function (i) {\n            n.push(i.startMinute), n.push(i.endMinute);\n          }), n;\n        },\n        _getWorktimeSettings() {\n          const e = {\n            hours: [0, 24],\n            minutes: null,\n            dates: {\n              0: !0,\n              1: !0,\n              2: !0,\n              3: !0,\n              4: !0,\n              5: !0,\n              6: !0\n            }\n          };\n          let n;\n          if (t.config.work_time) {\n            const i = t._working_time_helper;\n            if (i && i.get_calendar) n = i.get_calendar();else if (i) n = {\n              hours: i.hours,\n              minutes: null,\n              dates: i.dates\n            };else if (t.config.worktimes && t.config.worktimes.global) {\n              const a = t.config.worktimes.global;\n              if (a.parsed) {\n                n = {\n                  hours: null,\n                  minutes: t.ext.export_api._getMinutesWorktimeSettings(a.parsed.hours),\n                  dates: {}\n                };\n                for (const r in a.parsed.dates) Array.isArray(a.parsed.dates[r]) ? n.dates[r] = t.ext.export_api._getMinutesWorktimeSettings(a.parsed.dates[r]) : n.dates[r] = a.parsed.dates[r];\n              } else n = {\n                hours: a.hours,\n                minutes: null,\n                dates: a.dates\n              };\n            } else n = e;\n          } else n = e;\n          return n;\n        },\n        _eachTaskTimed: (e, n) => function (i, a, r) {\n          a = a || t.config.root_id, r = r || t;\n          const s = t.getChildren(a);\n          if (s) for (let o = 0; o < s.length; o++) {\n            const l = t._pull[s[o]];\n            (!e || l.end_date > e) && (!n || l.start_date < n) && i.call(r, l), t.hasChild(l.id) && t.eachTask(i, l.id, r);\n          }\n        },\n        _originalCopyObject: t.json._copyObject,\n        _copyObjectPlain(e) {\n          const n = t.templates.task_text(e.start_date, e.end_date, e),\n            i = t.ext.export_api._copyObjectBase(e);\n          return i.text = n || i.text, i;\n        },\n        _getColor(e, n) {\n          const i = e.currentStyle ? e.currentStyle[n] : getComputedStyle(e, null)[n],\n            a = i.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\n          return (a && a.length === 4 ? (\"0\" + parseInt(a[1], 10).toString(16)).slice(-2) + (\"0\" + parseInt(a[2], 10).toString(16)).slice(-2) + (\"0\" + parseInt(a[3], 10).toString(16)).slice(-2) : i).replace(\"#\", \"\");\n        },\n        _copyObjectTable(e) {\n          const n = t.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\"),\n            i = t.ext.export_api._copyObjectColumns(e, t.ext.export_api._copyObjectPlain(e));\n          i.start_date && (i.start_date = n(e.start_date)), i.end_date && (i.end_date = n(e.end_date));\n          const a = t._day_index_by_date ? t._day_index_by_date : t.columnIndexByDate;\n          i.$start = a.call(t, e.start_date), i.$end = a.call(t, e.end_date);\n          let r = 0;\n          const s = t.getScale().width;\n          if (s.indexOf(0) > -1) {\n            let l = 0;\n            for (; l < i.$start; l++) s[l] || r++;\n            for (i.$start -= r; l < i.$end; l++) s[l] || r++;\n            i.$end -= r;\n          }\n          i.$level = e.$level, i.$type = e.$rendered_type;\n          const o = t.templates;\n          return i.$text = o.task_text(e.start, e.end_date, e), i.$left = o.leftside_text ? o.leftside_text(e.start, e.end_date, e) : \"\", i.$right = o.rightside_text ? o.rightside_text(e.start, e.end_date, e) : \"\", i;\n        },\n        _copyObjectColors(e) {\n          const n = t.ext.export_api._copyObjectTable(e),\n            i = t.getTaskNode(e.id);\n          if (i && i.firstChild) {\n            let a = t.ext.export_api._getColor(t._no_progress_colors ? i : i.firstChild, \"backgroundColor\");\n            a === \"363636\" && (a = t.ext.export_api._getColor(i, \"backgroundColor\")), n.$color = a;\n          } else e.color && (n.$color = e.color);\n          return n;\n        },\n        _copyObjectColumns(e, n) {\n          for (let i = 0; i < t.config.columns.length; i++) {\n            const a = t.config.columns[i].template;\n            if (a) {\n              let r = a(e);\n              r instanceof Date && (r = t.templates.date_grid(r, e)), n[\"_\" + i] = r;\n            }\n          }\n          return n;\n        },\n        _copyObjectAll(e) {\n          const n = t.ext.export_api._copyObjectBase(e),\n            i = [\"leftside_text\", \"rightside_text\", \"task_text\", \"progress_text\", \"task_class\"];\n          for (let a = 0; a < i.length; a++) {\n            const r = t.templates[i[a]];\n            r && (n[\"$\" + a] = r(e.start_date, e.end_date, e));\n          }\n          return t.ext.export_api._copyObjectColumns(e, n), n.open = e.$open, n;\n        },\n        _serializeHtml() {\n          const e = t.config.smart_scales,\n            n = t.config.smart_rendering;\n          (e || n) && (t.config.smart_rendering = !1, t.config.smart_scales = !1, t.render());\n          const i = t.$container.parentNode.innerHTML;\n          return (e || n) && (t.config.smart_scales = e, t.config.smart_rendering = n, t.render()), i;\n        },\n        _serializeAll() {\n          t.json._copyObject = t.ext.export_api._copyObjectAll;\n          const e = t.ext.export_api._exportSerialize();\n          return t.json._copyObject = t.ext.export_api._originalCopyObject, e;\n        },\n        _serializePlain() {\n          const e = t.templates.xml_format,\n            n = t.templates.format_date;\n          t.templates.xml_format = t.date.date_to_str(\"%Y%m%dT%H%i%s\", !0), t.templates.format_date = t.date.date_to_str(\"%Y%m%dT%H%i%s\", !0), t.json._copyObject = t.ext.export_api._copyObjectPlain;\n          const i = t.ext.export_api._exportSerialize();\n          return t.templates.xml_format = e, t.templates.format_date = n, t.json._copyObject = t.ext.export_api._originalCopyObject, delete i.links, i;\n        },\n        _getRaw() {\n          if (t._scale_helpers) {\n            const e = t._get_scales(),\n              n = t.config.min_column_width,\n              i = t._get_resize_options().x ? Math.max(t.config.autosize_min_width, 0) : t.config.$task.offsetWidth,\n              a = t.config.config.scale_height - 1;\n            return t._scale_helpers.prepareConfigs(e, n, i, a);\n          }\n          {\n            const e = t.$ui.getView(\"timeline\");\n            if (e) {\n              let n = e.$config.width;\n              t.config.autosize !== \"x\" && t.config.autosize !== \"xy\" || (n = Math.max(t.config.autosize_min_width, 0));\n              const i = t.getState(),\n                a = e._getScales(),\n                r = t.config.min_column_width,\n                s = t.config.scale_height - 1,\n                o = t.config.rtl;\n              return e.$scaleHelper.prepareConfigs(a, r, n, s, i.min_date, i.max_date, o);\n            }\n          }\n        },\n        _serializeTimeline(e) {\n          t.json._copyObject = e.visual ? t.ext.export_api._copyObjectColors : t.ext.export_api._copyObjectTable;\n          const n = t.ext.export_api._exportSerialize();\n          if (t.json._copyObject = t.ext.export_api._originalCopyObject, delete n.links, e.cellColors) {\n            const i = t.templates.timeline_cell_class || t.templates.task_cell_class;\n            if (i) {\n              const a = t.ext.export_api._getRaw();\n              let r = a[0].trace_x;\n              for (let s = 1; s < a.length; s++) a[s].trace_x.length > r.length && (r = a[s].trace_x);\n              for (let s = 0; s < n.data.length; s++) {\n                n.data[s].styles = [];\n                const o = t.getTask(n.data[s].id);\n                for (let l = 0; l < r.length; l++) {\n                  const c = i(o, r[l]);\n                  c && n.data[s].styles.push({\n                    index: l,\n                    styles: t.ext.export_api._getStyles(c)\n                  });\n                }\n              }\n            }\n          }\n          return n;\n        },\n        _serializeScales(e) {\n          const n = [],\n            i = t.ext.export_api._getRaw();\n          let a = 1 / 0,\n            r = 0;\n          for (let s = 0; s < i.length; s++) a = Math.min(a, i[s].col_width);\n          for (let s = 0; s < i.length; s++) {\n            let o = 0,\n              l = 0;\n            const c = [];\n            n.push(c);\n            const d = i[s];\n            r = Math.max(r, d.trace_x.length);\n            const u = d.format || d.template || (d.date ? t.date.date_to_str(d.date) : t.config.date_scale);\n            for (let h = 0; h < d.trace_x.length; h++) {\n              const _ = d.trace_x[h];\n              l = o + Math.round(d.width[h] / a);\n              const p = {\n                text: u(_),\n                start: o,\n                end: l,\n                styles: \"\"\n              };\n              if (e.cellColors) {\n                const y = d.css || t.templates.scaleCell_class;\n                if (y) {\n                  const k = y(_);\n                  k && (p.styles = t.ext.export_api._getStyles(k));\n                }\n              }\n              c.push(p), o = l;\n            }\n          }\n          return {\n            width: r,\n            height: n.length,\n            data: n\n          };\n        },\n        _serializeGrid(e) {\n          t.exportMode = !0;\n          const n = [],\n            i = t.config.columns;\n          let a = 0;\n          for (let r = 0; r < i.length; r++) i[r].name !== \"add\" && i[r].name !== \"buttons\" && (n[a] = {\n            id: i[r].template ? \"_\" + r : i[r].name,\n            header: i[r].label || t.locale.labels[\"column_\" + i[r].name],\n            width: i[r].width ? Math.floor(i[r].width / 4) : \"\",\n            tree: i[r].tree || !1\n          }, i[r].name === \"duration\" && (n[a].type = \"number\"), i[r].name !== \"start_date\" && i[r].name !== \"end_date\" || (n[a].type = \"date\", e && e.rawDates && (n[a].id = i[r].name)), a++);\n          return t.exportMode = !1, n;\n        },\n        _exportSerialize() {\n          t.exportMode = !0;\n          const e = t.templates.xml_format,\n            n = t.templates.format_date;\n          t.templates.xml_format = t.templates.format_date = t.date.date_to_str(t.config.date_format || t.config.xml_date);\n          const i = t.serialize();\n          return t.templates.xml_format = e, t.templates.format_date = n, t.exportMode = !1, i;\n        },\n        _setLevel(e) {\n          for (let n = 0; n < e.length; n++) {\n            e[n].parent == 0 && (e[n]._lvl = 1);\n            for (let i = n + 1; i < e.length; i++) e[n].id == e[i].parent && (e[i]._lvl = e[n]._lvl + 1);\n          }\n        },\n        _clearLevel(e) {\n          for (let n = 0; n < e.length; n++) delete e[n]._lvl;\n        },\n        _clearRecLinks(e) {\n          t.ext.export_api._setLevel(e.data);\n          const n = {};\n          for (let r = 0; r < e.data.length; r++) n[e.data[r].id] = e.data[r];\n          const i = {};\n          for (let r = 0; r < e.links.length; r++) {\n            const s = e.links[r];\n            t.isTaskExists(s.source) && t.isTaskExists(s.target) && n[s.source] && n[s.target] && (i[s.id] = s);\n          }\n          for (const r in i) t.ext.export_api._makeLinksSameLevel(i[r], n);\n          const a = {};\n          for (const r in n) t.ext.export_api._clearCircDependencies(n[r], i, n, {}, a, null);\n          Object.keys(i) && t.ext.export_api._clearLinksSameLevel(i, n);\n          for (let r = 0; r < e.links.length; r++) i[e.links[r].id] || (e.links.splice(r, 1), r--);\n          t.ext.export_api._clearLevel(e.data);\n        },\n        _clearCircDependencies(e, n, i, a, r, s) {\n          const o = e.$_source;\n          if (!o) return;\n          a[e.id] && t.ext.export_api._onCircDependencyFind(s, n, a, r), a[e.id] = !0;\n          const l = {};\n          for (let c = 0; c < o.length; c++) {\n            if (r[o[c]]) continue;\n            const d = n[o[c]],\n              u = i[d._target];\n            l[u.id] && t.ext.export_api._onCircDependencyFind(d, n, a, r), l[u.id] = !0, t.ext.export_api._clearCircDependencies(u, n, i, a, r, d);\n          }\n          a[e.id] = !1;\n        },\n        _onCircDependencyFind(e, n, i, a) {\n          e && (t.callEvent(\"onExportCircularDependency\", [e.id, e]) && delete n[e.id], delete i[e._source], delete i[e._target], a[e.id] = !0);\n        },\n        _makeLinksSameLevel(e, n) {\n          let i, a;\n          const r = {\n            target: n[e.target],\n            source: n[e.source]\n          };\n          if (r.target._lvl != r.source._lvl) {\n            r.target._lvl < r.source._lvl ? (i = \"source\", a = r.target._lvl) : (i = \"target\", a = r.source._lvl);\n            do {\n              const l = n[r[i].parent];\n              if (!l) break;\n              r[i] = l;\n            } while (r[i]._lvl < a);\n            let s = n[r.source.parent],\n              o = n[r.target.parent];\n            for (; s && o && s.id != o.id;) r.source = s, r.target = o, s = n[r.source.parent], o = n[r.target.parent];\n          }\n          e._target = r.target.id, e._source = r.source.id, r.target.$_target || (r.target.$_target = []), r.target.$_target.push(e.id), r.source.$_source || (r.source.$_source = []), r.source.$_source.push(e.id);\n        },\n        _clearLinksSameLevel(e, n) {\n          for (const i in e) delete e[i]._target, delete e[i]._source;\n          for (const i in n) delete n[i].$_source, delete n[i].$_target;\n        },\n        _customProjectProperties(e, n) {\n          if (n && n.project) {\n            for (const i in n.project) t.config.$custom_data || (t.config.$custom_data = {}), t.config.$custom_data[i] = typeof n.project[i] == \"function\" ? n.project[i](t.config) : n.project[i];\n            delete n.project;\n          }\n        },\n        _customTaskProperties(e, n) {\n          n && n.tasks && (e.data.forEach(function (i) {\n            for (const a in n.tasks) i.$custom_data || (i.$custom_data = {}), i.$custom_data[a] = typeof n.tasks[a] == \"function\" ? n.tasks[a](i, t.config) : n.tasks[a];\n          }), delete n.tasks);\n        },\n        _exportConfig(e, n) {\n          const i = n.name || \"gantt.xml\";\n          delete n.name, t.config.custom = n;\n          const a = t.ext.export_api._getWorktimeSettings(),\n            r = t.getSubtaskDates();\n          if (r.start_date && r.end_date) {\n            const l = t.templates.format_date || t.templates.xml_format;\n            t.config.start_end = {\n              start_date: l(r.start_date),\n              end_date: l(r.end_date)\n            };\n          }\n          const s = n.auto_scheduling !== void 0 && !!n.auto_scheduling,\n            o = {\n              callback: n.callback || null,\n              config: t.config,\n              data: e,\n              manual: s,\n              name: i,\n              worktime: a\n            };\n          for (const l in n) o[l] = n[l];\n          return o;\n        },\n        _sendImportAjaxMSP(e) {\n          const n = e.server || t.ext.export_api._apiUrl,\n            i = e.store || 0,\n            a = e.data,\n            r = e.callback,\n            s = {\n              durationUnit: e.durationUnit || void 0,\n              projectProperties: e.projectProperties || void 0,\n              taskProperties: e.taskProperties || void 0\n            };\n          a.append(\"type\", e.type || \"msproject-parse\"), a.append(\"data\", JSON.stringify(s)), i && a.append(\"store\", i);\n          const o = new XMLHttpRequest();\n          o.onreadystatechange = function (l) {\n            o.readyState === 4 && o.status === 0 && r && r(null);\n          }, o.onload = function () {\n            let l = null;\n            if (!(o.status > 400)) try {\n              l = JSON.parse(o.responseText);\n            } catch {}\n            r && r(l);\n          }, o.open(\"POST\", n, !0), o.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\"), o.send(a);\n        }\n      }, t.exportToPDF = t.ext.export_api.exportToPDF, t.exportToPNG = t.ext.export_api.exportToPNG, t.exportToICal = t.ext.export_api.exportToICal, t.exportToExcel = t.ext.export_api.exportToExcel, t.exportToJSON = t.ext.export_api.exportToJSON, t.importFromExcel = t.ext.export_api.importFromExcel, t.importFromMSProject = t.ext.export_api.importFromMSProject, t.exportToMSProject = t.ext.export_api.exportToMSProject, t.importFromPrimaveraP6 = t.ext.export_api.importFromPrimaveraP6, t.exportToPrimaveraP6 = t.ext.export_api.exportToPrimaveraP6, t.ext.export_api;\n    }\n  },\n  Un = {\n    KEY_CODES: {\n      UP: 38,\n      DOWN: 40,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACE: 32,\n      ENTER: 13,\n      DELETE: 46,\n      ESC: 27,\n      TAB: 9\n    }\n  };\nclass qn {\n  constructor(e) {\n    this.addExtension = (n, i) => {\n      this._extensions[n] = i;\n    }, this.getExtension = n => this._extensions[n], this._extensions = {};\n    for (const n in e) this._extensions[n] = e[n];\n  }\n}\nvar ut = typeof window < \"u\";\nconst mt = {\n  isIE: ut && (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0),\n  isOpera: ut && (navigator.userAgent.indexOf(\"Opera\") >= 0 || navigator.userAgent.indexOf(\"OPR\") >= 0),\n  isChrome: ut && navigator.userAgent.indexOf(\"Chrome\") >= 0,\n  isSafari: ut && (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0),\n  isFF: ut && navigator.userAgent.indexOf(\"Firefox\") >= 0,\n  isIPad: ut && navigator.userAgent.search(/iPad/gi) >= 0,\n  isEdge: ut && navigator.userAgent.indexOf(\"Edge\") != -1,\n  isNode: !ut || typeof navigator > \"u\" || !1,\n  isSalesforce: ut && (!!Z.Sfdc || !!Z.$A || Z.Aura)\n};\nfunction Ne(t) {\n  if (typeof t == \"string\" || typeof t == \"number\") return t;\n  let e = \"\";\n  for (const n in t) {\n    let i = \"\";\n    t.hasOwnProperty(n) && (i = typeof t[n] == \"string\" ? encodeURIComponent(t[n]) : typeof t[n] == \"number\" ? String(t[n]) : encodeURIComponent(JSON.stringify(t[n])), i = n + \"=\" + i, e.length && (i = \"&\" + i), e += i);\n  }\n  return e;\n}\nfunction xt(t, e) {\n  var n = {\n    method: t\n  };\n  if (e.length === 0) throw new Error(\"Arguments list of query is wrong.\");\n  if (e.length === 1) return typeof e[0] == \"string\" ? (n.url = e[0], n.async = !0) : (n.url = e[0].url, n.async = e[0].async || !0, n.callback = e[0].callback, n.headers = e[0].headers), e[0].data ? typeof e[0].data != \"string\" ? n.data = Ne(e[0].data) : n.data = e[0].data : n.data = \"\", n;\n  switch (n.url = e[0], t) {\n    case \"GET\":\n    case \"DELETE\":\n      n.callback = e[1], n.headers = e[2];\n      break;\n    case \"POST\":\n    case \"PUT\":\n      e[1] ? typeof e[1] != \"string\" ? n.data = Ne(e[1]) : n.data = e[1] : n.data = \"\", n.callback = e[2], n.headers = e[3];\n  }\n  return n;\n}\nconst Le = {\n    date_to_str: (t, e, n) => {\n      t = t.replace(/%[a-zA-Z]/g, a => {\n        switch (a) {\n          case \"%d\":\n            return `\"+to_fixed(date.get${e ? \"UTC\" : \"\"}Date())+\"`;\n          case \"%m\":\n            return `\"+to_fixed((date.get${e ? \"UTC\" : \"\"}Month()+1))+\"`;\n          case \"%j\":\n            return `\"+date.get${e ? \"UTC\" : \"\"}Date()+\"`;\n          case \"%n\":\n            return `\"+(date.get${e ? \"UTC\" : \"\"}Month()+1)+\"`;\n          case \"%y\":\n            return `\"+to_fixed(date.get${e ? \"UTC\" : \"\"}FullYear()%100)+\"`;\n          case \"%Y\":\n            return `\"+date.get${e ? \"UTC\" : \"\"}FullYear()+\"`;\n          case \"%D\":\n            return `\"+locale.date.day_short[date.get${e ? \"UTC\" : \"\"}Day()]+\"`;\n          case \"%l\":\n            return `\"+locale.date.day_full[date.get${e ? \"UTC\" : \"\"}Day()]+\"`;\n          case \"%M\":\n            return `\"+locale.date.month_short[date.get${e ? \"UTC\" : \"\"}Month()]+\"`;\n          case \"%F\":\n            return `\"+locale.date.month_full[date.get${e ? \"UTC\" : \"\"}Month()]+\"`;\n          case \"%h\":\n            return `\"+to_fixed((date.get${e ? \"UTC\" : \"\"}Hours()+11)%12+1)+\"`;\n          case \"%g\":\n            return `\"+((date.get${e ? \"UTC\" : \"\"}Hours()+11)%12+1)+\"`;\n          case \"%G\":\n            return `\"+date.get${e ? \"UTC\" : \"\"}Hours()+\"`;\n          case \"%H\":\n            return `\"+to_fixed(date.get${e ? \"UTC\" : \"\"}Hours())+\"`;\n          case \"%i\":\n            return `\"+to_fixed(date.get${e ? \"UTC\" : \"\"}Minutes())+\"`;\n          case \"%a\":\n            return `\"+(date.get${e ? \"UTC\" : \"\"}Hours()>11?\"pm\":\"am\")+\"`;\n          case \"%A\":\n            return `\"+(date.get${e ? \"UTC\" : \"\"}Hours()>11?\"PM\":\"AM\")+\"`;\n          case \"%s\":\n            return `\"+to_fixed(date.get${e ? \"UTC\" : \"\"}Seconds())+\"`;\n          case \"%W\":\n            return '\"+to_fixed(getISOWeek(date))+\"';\n          case \"%w\":\n            return '\"+to_fixed(getWeek(date))+\"';\n          default:\n            return a;\n        }\n      });\n      const i = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${t}\";`);\n      return a => i(a, n.date.to_fixed, n.locale, n.date.getISOWeek, n.date.getWeek);\n    },\n    str_to_date: (t, e, n) => {\n      let i = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n      const a = t.match(/%[a-zA-Z]/g);\n      for (let o = 0; o < a.length; o++) switch (a[o]) {\n        case \"%j\":\n        case \"%d\":\n          i += `set[2]=temp[${o}]||1;`;\n          break;\n        case \"%n\":\n        case \"%m\":\n          i += `set[1]=(temp[${o}]||1)-1;`;\n          break;\n        case \"%y\":\n          i += `set[0]=temp[${o}]*1+(temp[${o}]>50?1900:2000);`;\n          break;\n        case \"%g\":\n        case \"%G\":\n        case \"%h\":\n        case \"%H\":\n          i += `set[3]=temp[${o}]||0;`;\n          break;\n        case \"%i\":\n          i += `set[4]=temp[${o}]||0;`;\n          break;\n        case \"%Y\":\n          i += `set[0]=temp[${o}]||0;`;\n          break;\n        case \"%a\":\n        case \"%A\":\n          i += `set[3]=set[3]%12+((temp[${o}]||'').toLowerCase()=='am'?0:12);`;\n          break;\n        case \"%s\":\n          i += `set[5]=temp[${o}]||0;`;\n          break;\n        case \"%M\":\n          i += `set[1]=locale.date.month_short_hash[temp[${o}]]||0;`;\n          break;\n        case \"%F\":\n          i += `set[1]=locale.date.month_full_hash[temp[${o}]]||0;`;\n      }\n      let r = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n      e && (r = ` Date.UTC(${r})`);\n      const s = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${i} return new Date(${r});`);\n      return o => s(o, n.locale);\n    }\n  },\n  Pe = {\n    date_to_str: (t, e, n) => i => t.replace(/%[a-zA-Z]/g, a => {\n      switch (a) {\n        case \"%d\":\n          return e ? n.date.to_fixed(i.getUTCDate()) : n.date.to_fixed(i.getDate());\n        case \"%m\":\n          return e ? n.date.to_fixed(i.getUTCMonth() + 1) : n.date.to_fixed(i.getMonth() + 1);\n        case \"%j\":\n          return e ? i.getUTCDate() : i.getDate();\n        case \"%n\":\n          return e ? i.getUTCMonth() + 1 : i.getMonth() + 1;\n        case \"%y\":\n          return e ? n.date.to_fixed(i.getUTCFullYear() % 100) : n.date.to_fixed(i.getFullYear() % 100);\n        case \"%Y\":\n          return e ? i.getUTCFullYear() : i.getFullYear();\n        case \"%D\":\n          return e ? n.locale.date.day_short[i.getUTCDay()] : n.locale.date.day_short[i.getDay()];\n        case \"%l\":\n          return e ? n.locale.date.day_full[i.getUTCDay()] : n.locale.date.day_full[i.getDay()];\n        case \"%M\":\n          return e ? n.locale.date.month_short[i.getUTCMonth()] : n.locale.date.month_short[i.getMonth()];\n        case \"%F\":\n          return e ? n.locale.date.month_full[i.getUTCMonth()] : n.locale.date.month_full[i.getMonth()];\n        case \"%h\":\n          return e ? n.date.to_fixed((i.getUTCHours() + 11) % 12 + 1) : n.date.to_fixed((i.getHours() + 11) % 12 + 1);\n        case \"%g\":\n          return e ? (i.getUTCHours() + 11) % 12 + 1 : (i.getHours() + 11) % 12 + 1;\n        case \"%G\":\n          return e ? i.getUTCHours() : i.getHours();\n        case \"%H\":\n          return e ? n.date.to_fixed(i.getUTCHours()) : n.date.to_fixed(i.getHours());\n        case \"%i\":\n          return e ? n.date.to_fixed(i.getUTCMinutes()) : n.date.to_fixed(i.getMinutes());\n        case \"%a\":\n          return e ? i.getUTCHours() > 11 ? \"pm\" : \"am\" : i.getHours() > 11 ? \"pm\" : \"am\";\n        case \"%A\":\n          return e ? i.getUTCHours() > 11 ? \"PM\" : \"AM\" : i.getHours() > 11 ? \"PM\" : \"AM\";\n        case \"%s\":\n          return e ? n.date.to_fixed(i.getUTCSeconds()) : n.date.to_fixed(i.getSeconds());\n        case \"%W\":\n          return e ? n.date.to_fixed(n.date.getUTCISOWeek(i)) : n.date.to_fixed(n.date.getISOWeek(i));\n        default:\n          return a;\n      }\n    }),\n    str_to_date: (t, e, n) => i => {\n      const a = [0, 0, 1, 0, 0, 0],\n        r = i.match(/[a-zA-Z]+|[0-9]+/g),\n        s = t.match(/%[a-zA-Z]/g);\n      for (let o = 0; o < s.length; o++) switch (s[o]) {\n        case \"%j\":\n        case \"%d\":\n          a[2] = r[o] || 1;\n          break;\n        case \"%n\":\n        case \"%m\":\n          a[1] = (r[o] || 1) - 1;\n          break;\n        case \"%y\":\n          a[0] = 1 * r[o] + (r[o] > 50 ? 1900 : 2e3);\n          break;\n        case \"%g\":\n        case \"%G\":\n        case \"%h\":\n        case \"%H\":\n          a[3] = r[o] || 0;\n          break;\n        case \"%i\":\n          a[4] = r[o] || 0;\n          break;\n        case \"%Y\":\n          a[0] = r[o] || 0;\n          break;\n        case \"%a\":\n        case \"%A\":\n          a[3] = a[3] % 12 + ((r[o] || \"\").toLowerCase() === \"am\" ? 0 : 12);\n          break;\n        case \"%s\":\n          a[5] = r[o] || 0;\n          break;\n        case \"%M\":\n          a[1] = n.locale.date.month_short_hash[r[o]] || 0;\n          break;\n        case \"%F\":\n          a[1] = n.locale.date.month_full_hash[r[o]] || 0;\n      }\n      return e ? new Date(Date.UTC(a[0], a[1], a[2], a[3], a[4], a[5])) : new Date(a[0], a[1], a[2], a[3], a[4], a[5]);\n    }\n  };\nfunction Gn(t) {\n  var e = null;\n  function n() {\n    var a = !1;\n    return t.config.csp === \"auto\" ? (e === null && function () {\n      try {\n        new Function(\"canUseCsp = false;\");\n      } catch {\n        e = !0;\n      }\n    }(), a = e) : a = t.config.csp, a;\n  }\n  var i = {\n    init: function () {\n      for (var a = t.locale, r = a.date.month_short, s = a.date.month_short_hash = {}, o = 0; o < r.length; o++) s[r[o]] = o;\n      for (r = a.date.month_full, s = a.date.month_full_hash = {}, o = 0; o < r.length; o++) s[r[o]] = o;\n    },\n    date_part: function (a) {\n      var r = new Date(a);\n      return a.setHours(0), this.hour_start(a), a.getHours() && (a.getDate() < r.getDate() || a.getMonth() < r.getMonth() || a.getFullYear() < r.getFullYear()) && a.setTime(a.getTime() + 36e5 * (24 - a.getHours())), a;\n    },\n    time_part: function (a) {\n      return (a.valueOf() / 1e3 - 60 * a.getTimezoneOffset()) % 86400;\n    },\n    week_start: function (a) {\n      var r = a.getDay();\n      return t.config.start_on_monday && (r === 0 ? r = 6 : r--), this.date_part(this.add(a, -1 * r, \"day\"));\n    },\n    month_start: function (a) {\n      return a.setDate(1), this.date_part(a);\n    },\n    quarter_start: function (a) {\n      this.month_start(a);\n      var r,\n        s = a.getMonth();\n      return r = s >= 9 ? 9 : s >= 6 ? 6 : s >= 3 ? 3 : 0, a.setMonth(r), a;\n    },\n    year_start: function (a) {\n      return a.setMonth(0), this.month_start(a);\n    },\n    day_start: function (a) {\n      return this.date_part(a);\n    },\n    hour_start: function (a) {\n      return a.getMinutes() && a.setMinutes(0), this.minute_start(a), a;\n    },\n    minute_start: function (a) {\n      return a.getSeconds() && a.setSeconds(0), a.getMilliseconds() && a.setMilliseconds(0), a;\n    },\n    _add_days: function (a, r, s) {\n      a.setDate(a.getDate() + r);\n      var o = r >= 0,\n        l = !s.getHours() && a.getHours(),\n        c = a.getDate() <= s.getDate() || a.getMonth() < s.getMonth() || a.getFullYear() < s.getFullYear();\n      return o && l && c && a.setTime(a.getTime() + 36e5 * (24 - a.getHours())), r > 1 && l && a.setHours(0), a;\n    },\n    add: function (a, r, s) {\n      var o = new Date(a.valueOf());\n      switch (s) {\n        case \"day\":\n          o = this._add_days(o, r, a);\n          break;\n        case \"week\":\n          o = this._add_days(o, 7 * r, a);\n          break;\n        case \"month\":\n          o.setMonth(o.getMonth() + r);\n          break;\n        case \"year\":\n          o.setYear(o.getFullYear() + r);\n          break;\n        case \"hour\":\n          o.setTime(o.getTime() + 60 * r * 60 * 1e3);\n          break;\n        case \"minute\":\n          o.setTime(o.getTime() + 60 * r * 1e3);\n          break;\n        default:\n          return this[\"add_\" + s](a, r, s);\n      }\n      return o;\n    },\n    add_quarter: function (a, r) {\n      return this.add(a, 3 * r, \"month\");\n    },\n    to_fixed: function (a) {\n      return a < 10 ? \"0\" + a : a;\n    },\n    copy: function (a) {\n      return new Date(a.valueOf());\n    },\n    date_to_str: function (a, r) {\n      var s = Le;\n      return n() && (s = Pe), s.date_to_str(a, r, t);\n    },\n    str_to_date: function (a, r) {\n      var s = Le;\n      return n() && (s = Pe), s.str_to_date(a, r, t);\n    },\n    getISOWeek: function (a) {\n      return t.date._getWeekNumber(a, !0);\n    },\n    _getWeekNumber: function (a, r) {\n      if (!a) return !1;\n      var s = a.getDay();\n      r && s === 0 && (s = 7);\n      var o = new Date(a.valueOf());\n      o.setDate(a.getDate() + (4 - s));\n      var l = o.getFullYear(),\n        c = Math.round((o.getTime() - new Date(l, 0, 1).getTime()) / 864e5);\n      return 1 + Math.floor(c / 7);\n    },\n    getWeek: function (a) {\n      return t.date._getWeekNumber(a, t.config.start_on_monday);\n    },\n    getUTCISOWeek: function (a) {\n      return t.date.getISOWeek(a);\n    },\n    convert_to_utc: function (a) {\n      return new Date(a.getUTCFullYear(), a.getUTCMonth(), a.getUTCDate(), a.getUTCHours(), a.getUTCMinutes(), a.getUTCSeconds());\n    },\n    parseDate: function (a, r) {\n      return a && !a.getFullYear && (typeof r != \"function\" && (r = typeof r == \"string\" ? r === \"parse_date\" || r === \"xml_date\" ? t.defined(t.templates.xml_date) ? t.templates.xml_date : t.templates.parse_date : t.defined(t.templates[r]) ? t.templates[r] : t.date.str_to_date(r) : t.defined(t.templates.xml_date) ? t.templates.xml_date : t.templates.parse_date), a = a ? r(a) : null), a;\n    }\n  };\n  return i;\n}\nclass Yn {\n  constructor(e) {\n    const {\n      url: n,\n      token: i\n    } = e;\n    this._url = n, this._token = i, this._mode = 1, this._seed = 1, this._queue = [], this.data = {}, this.api = {}, this._events = {};\n  }\n  headers() {\n    return {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      \"Remote-Token\": this._token\n    };\n  }\n  fetch(e, n) {\n    const i = {\n      credentials: \"include\",\n      headers: this.headers()\n    };\n    return n && (i.method = \"POST\", i.body = n), fetch(e, i).then(a => a.json());\n  }\n  load(e) {\n    return e && (this._url = e), this.fetch(this._url).then(n => this.parse(n));\n  }\n  parse(e) {\n    const {\n      key: n,\n      websocket: i\n    } = e;\n    n && (this._token = e.key);\n    for (const a in e.data) this.data[a] = e.data[a];\n    for (const a in e.api) {\n      const r = this.api[a] = {},\n        s = e.api[a];\n      for (const o in s) r[o] = this._wrapper(a + \".\" + o);\n    }\n    return i && this.connect(), this;\n  }\n  connect() {\n    const e = this._socket;\n    e && (this._socket = null, e.onclose = function () {}, e.close()), this._mode = 2, this._socket = function (n, i, a, r) {\n      let s = i;\n      s[0] === \"/\" && (s = document.location.protocol + \"//\" + document.location.host + i), s = s.replace(/^http(s|):/, \"ws$1:\");\n      const o = s.indexOf(\"?\") != -1 ? \"&\" : \"?\";\n      s = `${s}${o}token=${a}&ws=1`;\n      const l = new WebSocket(s);\n      return l.onclose = () => setTimeout(() => n.connect(), 2e3), l.onmessage = c => {\n        const d = JSON.parse(c.data);\n        switch (d.action) {\n          case \"result\":\n            n.result(d.body, []);\n            break;\n          case \"event\":\n            n.fire(d.body.name, d.body.value);\n            break;\n          case \"start\":\n            r();\n            break;\n          default:\n            n.onError(d.data);\n        }\n      }, l;\n    }(this, this._url, this._token, () => (this._mode = 3, this._send(), this._resubscribe(), this));\n  }\n  _wrapper(e) {\n    return function () {\n      const n = [].slice.call(arguments);\n      let i = null;\n      const a = new Promise((r, s) => {\n        i = {\n          data: {\n            id: this._uid(),\n            name: e,\n            args: n\n          },\n          status: 1,\n          resolve: r,\n          reject: s\n        }, this._queue.push(i);\n      });\n      return this.onCall(i, a), this._mode === 3 ? this._send(i) : setTimeout(() => this._send(), 1), a;\n    }.bind(this);\n  }\n  _uid() {\n    return (this._seed++).toString();\n  }\n  _send(e) {\n    if (this._mode == 2) return void setTimeout(() => this._send(), 100);\n    const n = e ? [e] : this._queue.filter(a => a.status === 1);\n    if (!n.length) return;\n    const i = n.map(a => (a.status = 2, a.data));\n    this._mode !== 3 ? this.fetch(this._url, JSON.stringify(i)).catch(a => this.onError(a)).then(a => this.result(a, i)) : this._socket.send(JSON.stringify({\n      action: \"call\",\n      body: i\n    }));\n  }\n  result(e, n) {\n    const i = {};\n    if (e) for (let a = 0; a < e.length; a++) i[e[a].id] = e[a];else for (let a = 0; a < n.length; a++) i[n[a].id] = {\n      id: n[a].id,\n      error: \"Network Error\",\n      data: null\n    };\n    for (let a = this._queue.length - 1; a >= 0; a--) {\n      const r = this._queue[a],\n        s = i[r.data.id];\n      s && (this.onResponse(r, s), s.error ? r.reject(s.error) : r.resolve(s.data), this._queue.splice(a, 1));\n    }\n  }\n  on(e, n) {\n    const i = this._uid();\n    let a = this._events[e];\n    const r = !!a;\n    return r || (a = this._events[e] = []), a.push({\n      id: i,\n      handler: n\n    }), r || this._mode != 3 || this._socket.send(JSON.stringify({\n      action: \"subscribe\",\n      name: e\n    })), {\n      name: e,\n      id: i\n    };\n  }\n  _resubscribe() {\n    if (this._mode == 3) for (const e in this._events) this._socket.send(JSON.stringify({\n      action: \"subscribe\",\n      name: e\n    }));\n  }\n  detach(e) {\n    if (!e) {\n      if (this._mode == 3) for (const r in this._events) this._socket.send(JSON.stringify({\n        action: \"unsubscribe\",\n        key: r\n      }));\n      return void (this._events = {});\n    }\n    const {\n        id: n,\n        name: i\n      } = e,\n      a = this._events[i];\n    if (a) {\n      const r = a.filter(s => s.id != n);\n      r.length ? this._events[i] = r : (delete this._events[i], this._mode == 3 && this._socket.send(JSON.stringify({\n        action: \"unsubscribe\",\n        name: i\n      })));\n    }\n  }\n  fire(e, n) {\n    const i = this._events[e];\n    if (i) for (let a = 0; a < i.length; a++) i[a].handler(n);\n  }\n  onError(e) {\n    return null;\n  }\n  onCall(e, n) {}\n  onResponse(e, n) {}\n}\nconst Jn = function (t, e) {\n  const n = new Yn({\n    url: t,\n    token: e\n  });\n  n.fetch = function (i, a) {\n    const r = {\n      headers: this.headers()\n    };\n    return a && (r.method = \"POST\", r.body = a), fetch(i, r).then(s => s.json());\n  }, this._ready = n.load().then(i => this._remote = i), this.ready = function () {\n    return this._ready;\n  }, this.on = function (i, a) {\n    this.ready().then(r => {\n      if (typeof i == \"string\") r.on(i, a);else for (const s in i) r.on(s, i[s]);\n    });\n  };\n};\nfunction dn(t, e) {\n  if (!e) return !0;\n  if (t._on_timeout) return !1;\n  var n = Math.ceil(1e3 / e);\n  return n < 2 || (setTimeout(function () {\n    delete t._on_timeout;\n  }, n), t._on_timeout = !0), !0;\n}\nvar Kn = function () {\n  var t = {};\n  return {\n    getState: function (e) {\n      if (t[e]) return t[e].method();\n      var n = {};\n      for (var i in t) t[i].internal || P(n, t[i].method(), !0);\n      return n;\n    },\n    registerProvider: function (e, n, i) {\n      t[e] = {\n        method: n,\n        internal: i\n      };\n    },\n    unregisterProvider: function (e) {\n      delete t[e];\n    }\n  };\n};\nconst Xn = Promise;\nvar et = {\n  $create: function (t) {\n    return P(t || [], this);\n  },\n  $removeAt: function (t, e) {\n    t >= 0 && this.splice(t, e || 1);\n  },\n  $remove: function (t) {\n    this.$removeAt(this.$find(t));\n  },\n  $insertAt: function (t, e) {\n    if (e || e === 0) {\n      var n = this.splice(e, this.length - e);\n      this[e] = t, this.push.apply(this, n);\n    } else this.push(t);\n  },\n  $find: function (t) {\n    for (var e = 0; e < this.length; e++) if (t == this[e]) return e;\n    return -1;\n  },\n  $each: function (t, e) {\n    for (var n = 0; n < this.length; n++) t.call(e || this, this[n]);\n  },\n  $map: function (t, e) {\n    for (var n = 0; n < this.length; n++) this[n] = t.call(e || this, this[n]);\n    return this;\n  },\n  $filter: function (t, e) {\n    for (var n = 0; n < this.length; n++) t.call(e || this, this[n]) || (this.splice(n, 1), n--);\n    return this;\n  }\n};\nfunction Rt(t, e, n, i) {\n  return (i = e ? e.config : i) && i.placeholder_task && n.exists(t) ? n.getItem(t).type === i.types.placeholder : !1;\n}\nvar it = function (t) {\n  return this.pull = {}, this.$initItem = t.initItem, this.visibleOrder = et.$create(), this.fullOrder = et.$create(), this._skip_refresh = !1, this._filterRule = null, this._searchVisibleOrder = {}, this._indexRangeCache = {}, this._getItemsCache = null, this.$config = t, ot(this), this._attachDataChange(function () {\n    return this._indexRangeCache = {}, this._getItemsCache = null, !0;\n  }), this;\n};\nit.prototype = {\n  _attachDataChange: function (t) {\n    this.attachEvent(\"onClearAll\", t), this.attachEvent(\"onBeforeParse\", t), this.attachEvent(\"onBeforeUpdate\", t), this.attachEvent(\"onBeforeDelete\", t), this.attachEvent(\"onBeforeAdd\", t), this.attachEvent(\"onParse\", t), this.attachEvent(\"onBeforeFilter\", t);\n  },\n  _parseInner: function (t) {\n    for (var e = null, n = [], i = 0, a = t.length; i < a; i++) e = t[i], this.$initItem && (this.$config.copyOnParse() && (e = q(e)), e = this.$initItem(e)), this.callEvent(\"onItemLoading\", [e]) && (this.pull.hasOwnProperty(e.id) || this.fullOrder.push(e.id), n.push(e), this.pull[e.id] = e);\n    return n;\n  },\n  parse: function (t) {\n    this.isSilent() || this.callEvent(\"onBeforeParse\", [t]);\n    var e = this._parseInner(t);\n    this.isSilent() || (this.refresh(), this.callEvent(\"onParse\", [e]));\n  },\n  getItem: function (t) {\n    return this.pull[t];\n  },\n  _updateOrder: function (t) {\n    t.call(this.visibleOrder), t.call(this.fullOrder);\n  },\n  updateItem: function (t, e) {\n    if (W(e) || (e = this.getItem(t)), !this.isSilent() && this.callEvent(\"onBeforeUpdate\", [e.id, e]) === !1) return !1;\n    P(this.pull[t], e, !0), this.isSilent() || (this.callEvent(\"onAfterUpdate\", [e.id, e]), this.callEvent(\"onStoreUpdated\", [e.id, e, \"update\"]));\n  },\n  _removeItemInner: function (t) {\n    this._updateOrder(function () {\n      this.$remove(t);\n    }), delete this.pull[t];\n  },\n  removeItem: function (t) {\n    var e = this.getItem(t);\n    if (!this.isSilent() && this.callEvent(\"onBeforeDelete\", [e.id, e]) === !1) return !1;\n    this.callEvent(\"onAfterDeleteConfirmed\", [e.id, e]), this._removeItemInner(t), this.isSilent() && this.callEvent(\"onAfterSilentDelete\", [e.id, e]), this.isSilent() || (this.filter(), this.callEvent(\"onAfterDelete\", [e.id, e]), this.callEvent(\"onStoreUpdated\", [e.id, e, \"delete\"]));\n  },\n  _addItemInner: function (t, e) {\n    if (this.exists(t.id)) this.silent(function () {\n      this.updateItem(t.id, t);\n    });else {\n      var n = this.visibleOrder,\n        i = n.length;\n      (!W(e) || e < 0) && (e = i), e > i && (e = Math.min(n.length, e));\n    }\n    this.pull[t.id] = t, this._updateOrder(function () {\n      this.$find(t.id) === -1 && this.$insertAt(t.id, e);\n    }), this.filter();\n  },\n  isVisible: function (t) {\n    return this.visibleOrder.$find(t) > -1;\n  },\n  getVisibleItems: function () {\n    return this.getIndexRange();\n  },\n  addItem: function (t, e) {\n    return W(t.id) || (t.id = st()), this.$initItem && (t = this.$initItem(t)), !(!this.isSilent() && this.callEvent(\"onBeforeAdd\", [t.id, t]) === !1) && (this._addItemInner(t, e), this.isSilent() || (this.callEvent(\"onAfterAdd\", [t.id, t]), this.callEvent(\"onStoreUpdated\", [t.id, t, \"add\"])), t.id);\n  },\n  _changeIdInner: function (t, e) {\n    this.pull[t] && (this.pull[e] = this.pull[t]);\n    var n = this._searchVisibleOrder[t];\n    this.pull[e].id = e, this._updateOrder(function () {\n      this[this.$find(t)] = e;\n    }), this._searchVisibleOrder[e] = n, delete this._searchVisibleOrder[t], delete this.pull[t];\n  },\n  changeId: function (t, e) {\n    this._changeIdInner(t, e), this.callEvent(\"onIdChange\", [t, e]);\n  },\n  exists: function (t) {\n    return !!this.pull[t];\n  },\n  _moveInner: function (t, e) {\n    var n = this.getIdByIndex(t);\n    this._updateOrder(function () {\n      this.$removeAt(t), this.$insertAt(n, Math.min(this.length, e));\n    });\n  },\n  move: function (t, e) {\n    var n = this.getIdByIndex(t),\n      i = this.getItem(n);\n    this._moveInner(t, e), this.isSilent() || this.callEvent(\"onStoreUpdated\", [i.id, i, \"move\"]);\n  },\n  clearAll: function () {\n    this.$destroyed || (this.silent(function () {\n      this.unselect();\n    }), this.pull = {}, this.visibleOrder = et.$create(), this.fullOrder = et.$create(), this.isSilent() || (this.callEvent(\"onClearAll\", []), this.refresh()));\n  },\n  silent: function (t, e) {\n    var n = !1;\n    this.isSilent() && (n = !0), this._skip_refresh = !0, t.call(e || this), n || (this._skip_refresh = !1);\n  },\n  isSilent: function () {\n    return !!this._skip_refresh;\n  },\n  arraysEqual: function (t, e) {\n    if (t.length !== e.length) return !1;\n    for (var n = 0; n < t.length; n++) if (t[n] !== e[n]) return !1;\n    return !0;\n  },\n  refresh: function (t, e) {\n    var n, i;\n    if (!this.$destroyed && !this.isSilent() && (t && (n = this.getItem(t)), i = t ? [t, n, \"paint\"] : [null, null, null], this.callEvent(\"onBeforeStoreUpdate\", i) !== !1)) {\n      var a = this._quick_refresh && !this._mark_recompute;\n      if (this._mark_recompute = !1, t) {\n        if (!e && !a) {\n          var r = this.visibleOrder;\n          this.filter(), this.arraysEqual(r, this.visibleOrder) || (t = void 0);\n        }\n      } else a || this.filter();\n      i = t ? [t, n, \"paint\"] : [null, null, null], this.callEvent(\"onStoreUpdated\", i);\n    }\n  },\n  count: function () {\n    return this.fullOrder.length;\n  },\n  countVisible: function () {\n    return this.visibleOrder.length;\n  },\n  sort: function (t) {},\n  serialize: function () {},\n  eachItem: function (t) {\n    for (var e = 0; e < this.fullOrder.length; e++) {\n      var n = this.getItem(this.fullOrder[e]);\n      t.call(this, n);\n    }\n  },\n  find: function (t) {\n    var e = [];\n    return this.eachItem(function (n) {\n      t(n) && e.push(n);\n    }), e;\n  },\n  filter: function (t) {\n    this.isSilent() || this.callEvent(\"onBeforeFilter\", []), this.callEvent(\"onPreFilter\", []);\n    var e = et.$create(),\n      n = [];\n    this.eachItem(function (a) {\n      this.callEvent(\"onFilterItem\", [a.id, a]) && (Rt(a.id, null, this, this._ganttConfig) ? n.push(a.id) : e.push(a.id));\n    });\n    for (var i = 0; i < n.length; i++) e.push(n[i]);\n    for (this.visibleOrder = e, this._searchVisibleOrder = {}, i = 0; i < this.visibleOrder.length; i++) this._searchVisibleOrder[this.visibleOrder[i]] = i;\n    this.isSilent() || this.callEvent(\"onFilter\", []);\n  },\n  getIndexRange: function (t, e) {\n    var n = Math.min(e || 1 / 0, this.countVisible() - 1),\n      i = t || 0,\n      a = i + \"-\" + n;\n    if (this._indexRangeCache[a]) return this._indexRangeCache[a].slice();\n    for (var r = [], s = i; s <= n; s++) r.push(this.getItem(this.visibleOrder[s]));\n    return this._indexRangeCache[a] = r.slice(), r;\n  },\n  getItems: function () {\n    if (this._getItemsCache) return this._getItemsCache.slice();\n    var t = [];\n    for (var e in this.pull) t.push(this.pull[e]);\n    return this._getItemsCache = t.slice(), t;\n  },\n  getIdByIndex: function (t) {\n    return this.visibleOrder[t];\n  },\n  getIndexById: function (t) {\n    var e = this._searchVisibleOrder[t];\n    return e === void 0 && (e = -1), e;\n  },\n  _getNullIfUndefined: function (t) {\n    return t === void 0 ? null : t;\n  },\n  getFirst: function () {\n    return this._getNullIfUndefined(this.visibleOrder[0]);\n  },\n  getLast: function () {\n    return this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length - 1]);\n  },\n  getNext: function (t) {\n    return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t) + 1]);\n  },\n  getPrev: function (t) {\n    return this._getNullIfUndefined(this.visibleOrder[this.getIndexById(t) - 1]);\n  },\n  destructor: function () {\n    this.callEvent(\"onDestroy\", []), this.detachAllEvents(), this.$destroyed = !0, this.pull = null, this.$initItem = null, this.visibleOrder = null, this.fullOrder = null, this._skip_refresh = null, this._filterRule = null, this._searchVisibleOrder = null, this._indexRangeCache = {};\n  }\n};\nvar cn = function (t) {\n  var e;\n  it.apply(this, [t]), this._branches = {}, this.pull = {}, this.$initItem = function (o) {\n    var l = o;\n    t.initItem && (l = t.initItem(l));\n    var c = this.getItem(o.id);\n    return c && !lt(c.parent, l.parent) && this.move(l.id, l.$index || -1, l.parent || this._ganttConfig.root_id), l;\n  }, this.$parentProperty = t.parentProperty || \"parent\", typeof t.rootId != \"function\" ? this.$getRootId = (e = t.rootId || 0, function () {\n    return e;\n  }) : this.$getRootId = t.rootId, this.$openInitially = t.openInitially, this.visibleOrder = et.$create(), this.fullOrder = et.$create(), this._searchVisibleOrder = {}, this._indexRangeCache = {}, this._eachItemMainRangeCache = null, this._getItemsCache = null, this._skip_refresh = !1, this._ganttConfig = null, t.getConfig && (this._ganttConfig = t.getConfig());\n  var n = {},\n    i = {},\n    a = {},\n    r = {},\n    s = !1;\n  return this._attachDataChange(function () {\n    return this._indexRangeCache = {}, this._eachItemMainRangeCache = null, this._getItemsCache = null, !0;\n  }), this.attachEvent(\"onPreFilter\", function () {\n    this._indexRangeCache = {}, this._eachItemMainRangeCache = null, n = {}, i = {}, a = {}, r = {}, s = !1, this.eachItem(function (o) {\n      var l = this.getParent(o.id);\n      o.$open && a[l] !== !1 ? a[o.id] = !0 : a[o.id] = !1, this._isSplitItem(o) && (s = !0, n[o.id] = !0, i[o.id] = !0), s && i[l] && (i[o.id] = !0), a[l] || a[l] === void 0 ? r[o.id] = !0 : r[o.id] = !1;\n    });\n  }), this.attachEvent(\"onFilterItem\", function (o, l) {\n    var c = !1;\n    this._ganttConfig && (c = this._ganttConfig.open_split_tasks);\n    var d = r[l.id];\n    return s && (d && i[l.id] && !n[l.id] && (d = !!c), i[l.id] && !n[l.id] && (l.$split_subtask = !0)), l.$expanded_branch = !!r[l.id], !!d;\n  }), this.attachEvent(\"onFilter\", function () {\n    n = {}, i = {}, a = {}, r = {};\n  }), this;\n};\nfunction lt(t, e) {\n  return String(t) === String(e);\n}\nfunction F(t) {\n  return mt.isNode || !t.$root;\n}\ncn.prototype = P({\n  _buildTree: function (t) {\n    for (var e = null, n = this.$getRootId(), i = 0, a = t.length; i < a; i++) e = t[i], this.setParent(e, at(this.getParent(e), n) || n);\n    for (i = 0, a = t.length; i < a; i++) e = t[i], this._add_branch(e), e.$level = this.calculateItemLevel(e), e.$local_index = this.getBranchIndex(e.id), W(e.$open) || (e.$open = W(e.open) ? e.open : this.$openInitially());\n    this._updateOrder();\n  },\n  _isSplitItem: function (t) {\n    return t.render == \"split\" && this.hasChild(t.id);\n  },\n  parse: function (t) {\n    this._skip_refresh || this.callEvent(\"onBeforeParse\", [t]);\n    var e = this._parseInner(t);\n    this._buildTree(e), this.filter(), this._skip_refresh || this.callEvent(\"onParse\", [e]);\n  },\n  _addItemInner: function (t, e) {\n    var n = this.getParent(t);\n    W(n) || (n = this.$getRootId(), this.setParent(t, n));\n    var i = this.getIndexById(n) + Math.min(Math.max(e, 0), this.visibleOrder.length);\n    1 * i !== i && (i = void 0), it.prototype._addItemInner.call(this, t, i), this.setParent(t, n), t.hasOwnProperty(\"$rendered_parent\") && this._move_branch(t, t.$rendered_parent), this._add_branch(t, e);\n  },\n  _changeIdInner: function (t, e) {\n    var n = this.getChildren(t),\n      i = this._searchVisibleOrder[t];\n    it.prototype._changeIdInner.call(this, t, e);\n    var a = this.getParent(e);\n    this._replace_branch_child(a, t, e), this._branches[t] && (this._branches[e] = this._branches[t]);\n    for (var r = 0; r < n.length; r++) {\n      var s = this.getItem(n[r]);\n      s[this.$parentProperty] = e, s.$rendered_parent = e;\n    }\n    this._searchVisibleOrder[e] = i, delete this._branches[t];\n  },\n  _traverseBranches: function (t, e) {\n    W(e) || (e = this.$getRootId());\n    var n = this._branches[e];\n    if (n) for (var i = 0; i < n.length; i++) {\n      var a = n[i];\n      t.call(this, a), this._branches[a] && this._traverseBranches(t, a);\n    }\n  },\n  _updateOrder: function (t) {\n    this.fullOrder = et.$create(), this._traverseBranches(function (e) {\n      this.fullOrder.push(e);\n    }), t && it.prototype._updateOrder.call(this, t);\n  },\n  _removeItemInner: function (t) {\n    var e = [];\n    this.eachItem(function (i) {\n      e.push(i);\n    }, t), e.push(this.getItem(t));\n    for (var n = 0; n < e.length; n++) this._move_branch(e[n], this.getParent(e[n]), null), it.prototype._removeItemInner.call(this, e[n].id), this._move_branch(e[n], this.getParent(e[n]), null);\n  },\n  move: function (t, e, n) {\n    var i = arguments[3],\n      a = (this._ganttConfig || {}).root_id || 0;\n    if (i = at(i, a)) {\n      if (i === t) return;\n      n = this.getParent(i), e = this.getBranchIndex(i);\n    }\n    if (!lt(t, n)) {\n      W(n) || (n = this.$getRootId());\n      var r = this.getItem(t),\n        s = this.getParent(r.id),\n        o = this.getChildren(n);\n      if (e == -1 && (e = o.length + 1), lt(s, n) && this.getBranchIndex(t) == e) return;\n      if (this.callEvent(\"onBeforeItemMove\", [t, n, e]) === !1) return !1;\n      for (var l = [], c = 0; c < o.length; c++) Rt(o[c], null, this, this._ganttConfig) && (l.push(o[c]), o.splice(c, 1), c--);\n      this._replace_branch_child(s, t);\n      var d = (o = this.getChildren(n))[e];\n      (d = at(d, a)) ? o = o.slice(0, e).concat([t]).concat(o.slice(e)) : o.push(t), l.length && (o = o.concat(l)), lt(r.$rendered_parent, s) || lt(s, n) || (r.$rendered_parent = s), this.setParent(r, n), this._branches[n] = o;\n      var u = this.calculateItemLevel(r) - r.$level;\n      r.$level += u, this.eachItem(function (h) {\n        h.$level += u;\n      }, r.id, this), this._moveInner(this.getIndexById(t), this.getIndexById(n) + e), this.callEvent(\"onAfterItemMove\", [t, n, e]), this.refresh();\n    }\n  },\n  getBranchIndex: function (t) {\n    var e = this.getChildren(this.getParent(t));\n    let n = e.indexOf(t + \"\");\n    return n == -1 && (n = e.indexOf(+t)), n;\n  },\n  hasChild: function (t) {\n    var e = this._branches[t];\n    return e && e.length;\n  },\n  getChildren: function (t) {\n    var e = this._branches[t];\n    return e || et.$create();\n  },\n  isChildOf: function (t, e) {\n    if (!this.exists(t)) return !1;\n    if (e === this.$getRootId()) return !0;\n    if (!this.hasChild(e)) return !1;\n    var n = this.getItem(t),\n      i = this.getParent(t);\n    if (this.getItem(e).$level >= n.$level) return !1;\n    for (; n && this.exists(i);) {\n      if ((n = this.getItem(i)) && lt(n.id, e)) return !0;\n      i = this.getParent(n);\n    }\n    return !1;\n  },\n  getSiblings: function (t) {\n    if (!this.exists(t)) return et.$create();\n    var e = this.getParent(t);\n    return this.getChildren(e);\n  },\n  getNextSibling: function (t) {\n    for (var e = this.getSiblings(t), n = 0, i = e.length; n < i; n++) if (lt(e[n], t)) {\n      var a = e[n + 1];\n      return a === 0 && n > 0 && (a = \"0\"), a || null;\n    }\n    return null;\n  },\n  getPrevSibling: function (t) {\n    for (var e = this.getSiblings(t), n = 0, i = e.length; n < i; n++) if (lt(e[n], t)) {\n      var a = e[n - 1];\n      return a === 0 && n > 0 && (a = \"0\"), a || null;\n    }\n    return null;\n  },\n  getParent: function (t) {\n    var e = null;\n    return (e = t.id !== void 0 ? t : this.getItem(t)) ? e[this.$parentProperty] : this.$getRootId();\n  },\n  clearAll: function () {\n    this._branches = {}, it.prototype.clearAll.call(this);\n  },\n  calculateItemLevel: function (t) {\n    var e = 0;\n    return this.eachParent(function () {\n      e++;\n    }, t), e;\n  },\n  _setParentInner: function (t, e, n) {\n    n || (t.hasOwnProperty(\"$rendered_parent\") ? this._move_branch(t, t.$rendered_parent, e) : this._move_branch(t, t[this.$parentProperty], e));\n  },\n  setParent: function (t, e, n) {\n    this._setParentInner(t, e, n), t[this.$parentProperty] = e;\n  },\n  _eachItemCached: function (t, e) {\n    for (var n = 0, i = e.length; n < i; n++) t.call(this, e[n]);\n  },\n  _eachItemIterate: function (t, e, n) {\n    var i = this.getChildren(e);\n    for (i.length && (i = i.slice().reverse()); i.length;) {\n      var a = i.pop(),\n        r = this.getItem(a);\n      if (t.call(this, r), n && n.push(r), this.hasChild(r.id)) for (var s = this.getChildren(r.id), o = s.length - 1; o >= 0; o--) i.push(s[o]);\n    }\n  },\n  eachItem: function (t, e) {\n    var n = this.$getRootId();\n    W(e) || (e = n);\n    var i = at(e, n) || n,\n      a = !1,\n      r = !1,\n      s = null;\n    i === n && (this._eachItemMainRangeCache ? (a = !0, s = this._eachItemMainRangeCache) : (r = !0, s = this._eachItemMainRangeCache = [])), a ? this._eachItemCached(t, s) : this._eachItemIterate(t, i, r ? s : null);\n  },\n  eachParent: function (t, e) {\n    for (var n = {}, i = e, a = this.getParent(i); this.exists(a);) {\n      if (n[a]) throw new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + a);\n      n[a] = !0, i = this.getItem(a), t.call(this, i), a = this.getParent(i);\n    }\n  },\n  _add_branch: function (t, e, n) {\n    var i = n === void 0 ? this.getParent(t) : n;\n    this.hasChild(i) || (this._branches[i] = et.$create());\n    var a = this.getChildren(i);\n    a.indexOf(t.id + \"\") > -1 || a.indexOf(+t.id) > -1 || (1 * e == e ? a.splice(e, 0, t.id) : a.push(t.id), t.$rendered_parent = i);\n  },\n  _move_branch: function (t, e, n) {\n    this._eachItemMainRangeCache = null, this._replace_branch_child(e, t.id), this.exists(n) || lt(n, this.$getRootId()) ? this._add_branch(t, void 0, n) : delete this._branches[t.id], t.$level = this.calculateItemLevel(t), this.eachItem(function (i) {\n      i.$level = this.calculateItemLevel(i);\n    }, t.id);\n  },\n  _replace_branch_child: function (t, e, n) {\n    var i = this.getChildren(t);\n    if (i && t !== void 0) {\n      var a = et.$create();\n      let r = i.indexOf(e + \"\");\n      r != -1 || isNaN(+e) || (r = i.indexOf(+e)), r > -1 && (n ? i.splice(r, 1, n) : i.splice(r, 1)), a = i, this._branches[t] = a;\n    }\n  },\n  sort: function (t, e, n) {\n    this.exists(n) || (n = this.$getRootId()), t || (t = \"order\");\n    var i = typeof t == \"string\" ? function (l, c) {\n      return l[t] == c[t] || Q(l[t]) && Q(c[t]) && l[t].valueOf() == c[t].valueOf() ? 0 : l[t] > c[t] ? 1 : -1;\n    } : t;\n    if (e) {\n      var a = i;\n      i = function (l, c) {\n        return a(c, l);\n      };\n    }\n    var r = this.getChildren(n);\n    if (r) {\n      for (var s = [], o = r.length - 1; o >= 0; o--) s[o] = this.getItem(r[o]);\n      for (s.sort(i), o = 0; o < s.length; o++) r[o] = s[o].id, this.sort(t, e, r[o]);\n    }\n  },\n  filter: function (t) {\n    for (let e in this.pull) {\n      const n = this.pull[e].$rendered_parent,\n        i = this.getParent(this.pull[e]);\n      lt(n, i) || this._move_branch(this.pull[e], n, i);\n    }\n    return it.prototype.filter.apply(this, arguments);\n  },\n  open: function (t) {\n    this.exists(t) && (this.getItem(t).$open = !0, this._skipTaskRecalculation = !0, this.callEvent(\"onItemOpen\", [t]));\n  },\n  close: function (t) {\n    this.exists(t) && (this.getItem(t).$open = !1, this._skipTaskRecalculation = !0, this.callEvent(\"onItemClose\", [t]));\n  },\n  destructor: function () {\n    it.prototype.destructor.call(this), this._branches = null, this._indexRangeCache = {}, this._eachItemMainRangeCache = null;\n  }\n}, it.prototype);\nconst Zn = function (t, e) {\n  const n = e.getDatastore(t),\n    i = function (o, l) {\n      const c = l.getLayers(),\n        d = n.getItem(o);\n      if (d && n.isVisible(o)) for (let u = 0; u < c.length; u++) c[u].render_item(d);\n    },\n    a = function (o) {\n      const l = o.getLayers();\n      for (let _ = 0; _ < l.length; _++) l[_].clear();\n      let c = null;\n      const d = {};\n      for (let _ = 0; _ < l.length; _++) {\n        const p = l[_];\n        let y;\n        if (p.get_visible_range) {\n          var u = p.get_visible_range(n);\n          if (u.start !== void 0 && u.end !== void 0) {\n            var h = u.start + \" - \" + u.end;\n            d[h] ? y = d[h] : (y = n.getIndexRange(u.start, u.end), d[h] = y);\n          } else {\n            if (u.ids === void 0) throw new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n            y = u.ids.map(function (k) {\n              return n.getItem(k);\n            });\n          }\n        } else c || (c = n.getVisibleItems()), y = c;\n        p.prepare_data && p.prepare_data(y), l[_].render_items(y);\n      }\n    },\n    r = function (o) {\n      if (o.update_items) {\n        let c = [];\n        if (o.get_visible_range) {\n          var l = o.get_visible_range(n);\n          if (l.start !== void 0 && l.end !== void 0 && (c = n.getIndexRange(l.start, l.end)), l.ids !== void 0) {\n            let d = l.ids.map(function (u) {\n              return n.getItem(u);\n            });\n            d.length > 0 && (d = d.filter(u => u !== void 0), c = c.concat(d));\n          }\n          if ((l.start == null || l.end == null) && l.ids == null) throw new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n        } else c = n.getVisibleItems();\n        o.prepare_data && o.prepare_data(c, o), o.update_items(c);\n      }\n    };\n  function s(o) {\n    return !!o.$services.getService(\"state\").getState(\"batchUpdate\").batch_update;\n  }\n  n.attachEvent(\"onStoreUpdated\", function (o, l, c) {\n    if (F(e)) return !0;\n    const d = e.$services.getService(\"layers\").getDataRender(t);\n    d && (d.onUpdateRequest = function (u) {\n      r(u);\n    });\n  }), n.attachEvent(\"onStoreUpdated\", function (o, l, c) {\n    s(e) || (o && c != \"move\" && c != \"delete\" ? (n.callEvent(\"onBeforeRefreshItem\", [l.id]), n.callEvent(\"onAfterRefreshItem\", [l.id])) : (n.callEvent(\"onBeforeRefreshAll\", []), n.callEvent(\"onAfterRefreshAll\", [])));\n  }), n.attachEvent(\"onAfterRefreshAll\", function () {\n    if (F(e)) return !0;\n    const o = e.$services.getService(\"layers\").getDataRender(t);\n    o && !s(e) && a(o);\n  }), n.attachEvent(\"onAfterRefreshItem\", function (o) {\n    if (F(e)) return !0;\n    const l = e.$services.getService(\"layers\").getDataRender(t);\n    l && i(o, l);\n  }), n.attachEvent(\"onItemOpen\", function () {\n    if (F(e) || n.isSilent()) return !0;\n    e.render();\n  }), n.attachEvent(\"onItemClose\", function () {\n    if (F(e) || n.isSilent()) return !0;\n    e.render();\n  }), n.attachEvent(\"onIdChange\", function (o, l) {\n    if (F(e)) return !0;\n    if (n.callEvent(\"onBeforeIdChange\", [o, l]), !s(e) && !n.isSilent()) {\n      const c = e.$services.getService(\"layers\").getDataRender(t);\n      c ? (function (d, u, h) {\n        for (let _ = 0; _ < d.length; _++) d[_].change_id(u, h);\n      }(c.getLayers(), o, l, n.getItem(l)), i(l, c)) : e.render();\n    }\n  });\n};\nfunction ne() {\n  for (var t = this.$services.getService(\"datastores\"), e = [], n = 0; n < t.length; n++) {\n    var i = this.getDatastore(t[n]);\n    i.$destroyed || e.push(i);\n  }\n  return e;\n}\nconst Qn = {\n  create: function () {\n    var t = P({}, {\n      createDatastore: function (e) {\n        var n = (e.type || \"\").toLowerCase() == \"treedatastore\" ? cn : it;\n        if (e) {\n          var i = this;\n          e.openInitially = function () {\n            return i.config.open_tree_initially;\n          }, e.copyOnParse = function () {\n            return i.config.deepcopy_on_parse;\n          };\n        }\n        var a = new n(e);\n        if (this.mixin(a, function (o) {\n          var l = null,\n            c = o._removeItemInner;\n          function d(u) {\n            l = null, this.callEvent(\"onAfterUnselect\", [u]);\n          }\n          return o._removeItemInner = function (u) {\n            return l == u && d.call(this, u), l && this.eachItem && this.eachItem(function (h) {\n              h.id == l && d.call(this, h.id);\n            }, u), c.apply(this, arguments);\n          }, o.attachEvent(\"onIdChange\", function (u, h) {\n            o.getSelectedId() == u && o.silent(function () {\n              o.unselect(u), o.select(h);\n            });\n          }), {\n            select: function (u) {\n              if (u) {\n                if (l == u) return l;\n                if (!this._skip_refresh && !this.callEvent(\"onBeforeSelect\", [u])) return !1;\n                this.unselect(), l = u, this._skip_refresh || (this.refresh(u), this.callEvent(\"onAfterSelect\", [u]));\n              }\n              return l;\n            },\n            getSelectedId: function () {\n              return l;\n            },\n            isSelected: function (u) {\n              return u == l;\n            },\n            unselect: function (u) {\n              (u = u || l) && (l = null, this._skip_refresh || (this.refresh(u), d.call(this, u)));\n            }\n          };\n        }(a)), e.name) {\n          var r = \"datastore:\" + e.name;\n          a.attachEvent(\"onDestroy\", function () {\n            this.$services.dropService(r);\n            for (var o = this.$services.getService(\"datastores\"), l = 0; l < o.length; l++) if (o[l] === e.name) {\n              o.splice(l, 1);\n              break;\n            }\n          }.bind(this)), this.$services.dropService(r), this.$services.setService(r, function () {\n            return a;\n          });\n          var s = this.$services.getService(\"datastores\");\n          s ? s.indexOf(e.name) < 0 && s.push(e.name) : (s = [], this.$services.setService(\"datastores\", function () {\n            return s;\n          }), s.push(e.name)), Zn(e.name, this);\n        }\n        return a;\n      },\n      getDatastore: function (e) {\n        return this.$services.getService(\"datastore:\" + e);\n      },\n      _getDatastores: ne,\n      refreshData: function () {\n        var e;\n        F(this) || (e = this.getScrollState()), this.callEvent(\"onBeforeDataRender\", []);\n        for (var n = ne.call(this), i = 0; i < n.length; i++) n[i].refresh();\n        this.config.preserve_scroll && !F(this) && (e.x || e.y) && this.scrollTo(e.x, e.y), this.callEvent(\"onDataRender\", []);\n      },\n      isChildOf: function (e, n) {\n        return this.$data.tasksStore.isChildOf(e, n);\n      },\n      refreshTask: function (e, n) {\n        var i = this.getTask(e),\n          a = this;\n        function r() {\n          if (n === void 0 || n) {\n            for (var o = 0; o < i.$source.length; o++) a.refreshLink(i.$source[o]);\n            for (o = 0; o < i.$target.length; o++) a.refreshLink(i.$target[o]);\n          }\n        }\n        if (i && this.isTaskVisible(e)) this.$data.tasksStore.refresh(e, !!this.getState(\"tasksDnd\").drag_id || n === !1), r();else if (this.isTaskExists(e) && this.isTaskExists(this.getParent(e)) && !this._bulk_dnd) {\n          this.refreshTask(this.getParent(e));\n          var s = !1;\n          this.eachParent(function (o) {\n            (s || this.isSplitTask(o)) && (s = !0);\n          }, e), s && r();\n        }\n      },\n      refreshLink: function (e) {\n        this.$data.linksStore.refresh(e, !!this.getState(\"tasksDnd\").drag_id);\n      },\n      silent: function (e) {\n        var n = this;\n        n.$data.tasksStore.silent(function () {\n          n.$data.linksStore.silent(function () {\n            e();\n          });\n        });\n      },\n      clearAll: function () {\n        for (var e = ne.call(this), n = 0; n < e.length; n++) e[n].silent(function () {\n          e[n].clearAll();\n        });\n        for (n = 0; n < e.length; n++) e[n].clearAll();\n        this._update_flags(), this.userdata = {}, this.callEvent(\"onClear\", []), this.render();\n      },\n      _clear_data: function () {\n        this.$data.tasksStore.clearAll(), this.$data.linksStore.clearAll(), this._update_flags(), this.userdata = {};\n      },\n      selectTask: function (e) {\n        var n = this.$data.tasksStore;\n        if (!this.config.select_task) return !1;\n        if (e = at(e, this.config.root_id)) {\n          let i = this.getSelectedId();\n          n._skipResourceRepaint = !0, n.select(e), n._skipResourceRepaint = !1, i && n.pull[i].$split_subtask && i != e && this.refreshTask(i), n.pull[e].$split_subtask && i != e && this.refreshTask(e);\n        }\n        return n.getSelectedId();\n      },\n      unselectTask: function (e) {\n        var n = this.$data.tasksStore;\n        n.unselect(e), e && n.pull[e].$split_subtask && this.refreshTask(e);\n      },\n      isSelectedTask: function (e) {\n        return this.$data.tasksStore.isSelected(e);\n      },\n      getSelectedId: function () {\n        return this.$data.tasksStore.getSelectedId();\n      }\n    });\n    return P(t, {\n      getTask: function (e) {\n        e = at(e, this.config.root_id), this.assert(e, \"Invalid argument for gantt.getTask\");\n        var n = this.$data.tasksStore.getItem(e);\n        return this.assert(n, \"Task not found id=\" + e), n;\n      },\n      getTaskByTime: function (e, n) {\n        var i = this.$data.tasksStore.getItems(),\n          a = [];\n        if (e || n) {\n          e = +e || -1 / 0, n = +n || 1 / 0;\n          for (var r = 0; r < i.length; r++) {\n            var s = i[r];\n            +s.start_date < n && +s.end_date > e && a.push(s);\n          }\n        } else a = i;\n        return a;\n      },\n      isTaskExists: function (e) {\n        return !(!this.$data || !this.$data.tasksStore) && this.$data.tasksStore.exists(e);\n      },\n      updateTask: function (e, n) {\n        W(n) || (n = this.getTask(e)), this.$data.tasksStore.updateItem(e, n), this.isTaskExists(e) && this.refreshTask(e);\n      },\n      addTask: function (e, n, i) {\n        if (W(e.id) || (e.id = st()), this.isTaskExists(e.id) && this.getTask(e.id).$index != e.$index) return e.start_date && typeof e.start_date == \"string\" && (e.start_date = this.date.parseDate(e.start_date, \"parse_date\")), e.end_date && typeof e.end_date == \"string\" && (e.end_date = this.date.parseDate(e.end_date, \"parse_date\")), this.$data.tasksStore.updateItem(e.id, e);\n        if (W(n) || (n = this.getParent(e) || 0), this.isTaskExists(n) || (n = this.config.root_id), this.setParent(e, n), this.getState().lightbox && this.isTaskExists(n)) {\n          var a = this.getTask(n);\n          this.callEvent(\"onAfterParentExpand\", [n, a]);\n        }\n        return this.$data.tasksStore.addItem(e, i, n);\n      },\n      deleteTask: function (e) {\n        return e = at(e, this.config.root_id), this.$data.tasksStore.removeItem(e);\n      },\n      getTaskCount: function () {\n        return this.$data.tasksStore.count();\n      },\n      getVisibleTaskCount: function () {\n        return this.$data.tasksStore.countVisible();\n      },\n      getTaskIndex: function (e) {\n        return this.$data.tasksStore.getBranchIndex(e);\n      },\n      getGlobalTaskIndex: function (e) {\n        return e = at(e, this.config.root_id), this.assert(e, \"Invalid argument\"), this.$data.tasksStore.getIndexById(e);\n      },\n      eachTask: function (e, n, i) {\n        return this.$data.tasksStore.eachItem(R(e, i || this), n);\n      },\n      eachParent: function (e, n, i) {\n        return this.$data.tasksStore.eachParent(R(e, i || this), n);\n      },\n      changeTaskId: function (e, n) {\n        this.$data.tasksStore.changeId(e, n);\n        var i = this.$data.tasksStore.getItem(n),\n          a = [];\n        i.$source && (a = a.concat(i.$source)), i.$target && (a = a.concat(i.$target));\n        for (var r = 0; r < a.length; r++) {\n          var s = this.getLink(a[r]);\n          s.source == e && (s.source = n), s.target == e && (s.target = n);\n        }\n      },\n      calculateTaskLevel: function (e) {\n        return this.$data.tasksStore.calculateItemLevel(e);\n      },\n      getNext: function (e) {\n        return this.$data.tasksStore.getNext(e);\n      },\n      getPrev: function (e) {\n        return this.$data.tasksStore.getPrev(e);\n      },\n      getParent: function (e) {\n        return this.$data.tasksStore.getParent(e);\n      },\n      setParent: function (e, n, i) {\n        return this.$data.tasksStore.setParent(e, n, i);\n      },\n      getSiblings: function (e) {\n        return this.$data.tasksStore.getSiblings(e).slice();\n      },\n      getNextSibling: function (e) {\n        return this.$data.tasksStore.getNextSibling(e);\n      },\n      getPrevSibling: function (e) {\n        return this.$data.tasksStore.getPrevSibling(e);\n      },\n      getTaskByIndex: function (e) {\n        var n = this.$data.tasksStore.getIdByIndex(e);\n        return this.isTaskExists(n) ? this.getTask(n) : null;\n      },\n      getChildren: function (e) {\n        return this.hasChild(e) ? this.$data.tasksStore.getChildren(e).slice() : [];\n      },\n      hasChild: function (e) {\n        return this.$data.tasksStore.hasChild(e);\n      },\n      open: function (e) {\n        this.$data.tasksStore.open(e);\n      },\n      close: function (e) {\n        this.$data.tasksStore.close(e);\n      },\n      moveTask: function (e, n, i) {\n        return i = at(i, this.config.root_id), this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\n      },\n      sort: function (e, n, i, a) {\n        var r = !a;\n        this.$data.tasksStore.sort(e, n, i), this.callEvent(\"onAfterSort\", [e, n, i]), r && this.render();\n      }\n    }), P(t, {\n      getLinkCount: function () {\n        return this.$data.linksStore.count();\n      },\n      getLink: function (e) {\n        return this.$data.linksStore.getItem(e);\n      },\n      getLinks: function () {\n        return this.$data.linksStore.getItems();\n      },\n      isLinkExists: function (e) {\n        return this.$data.linksStore.exists(e);\n      },\n      addLink: function (e) {\n        return this.$data.linksStore.addItem(e);\n      },\n      updateLink: function (e, n) {\n        W(n) || (n = this.getLink(e)), this.$data.linksStore.updateItem(e, n);\n      },\n      deleteLink: function (e) {\n        return this.$data.linksStore.removeItem(e);\n      },\n      changeLinkId: function (e, n) {\n        return this.$data.linksStore.changeId(e, n);\n      }\n    }), t;\n  }\n};\nfunction pe(t) {\n  var e = t.date,\n    n = t.$services;\n  return {\n    getSum: function (i, a, r) {\n      r === void 0 && (r = i.length - 1), a === void 0 && (a = 0);\n      for (var s = 0, o = a; o <= r; o++) s += i[o];\n      return s;\n    },\n    setSumWidth: function (i, a, r, s) {\n      var o = a.width;\n      s === void 0 && (s = o.length - 1), r === void 0 && (r = 0);\n      var l = s - r + 1;\n      if (!(r > o.length - 1 || l <= 0 || s > o.length - 1)) {\n        var c = i - this.getSum(o, r, s);\n        this.adjustSize(c, o, r, s), this.adjustSize(-c, o, s + 1), a.full_width = this.getSum(o);\n      }\n    },\n    splitSize: function (i, a) {\n      for (var r = [], s = 0; s < a; s++) r[s] = 0;\n      return this.adjustSize(i, r), r;\n    },\n    adjustSize: function (i, a, r, s) {\n      r || (r = 0), s === void 0 && (s = a.length - 1);\n      for (var o = s - r + 1, l = this.getSum(a, r, s), c = r; c <= s; c++) {\n        var d = Math.floor(i * (l ? a[c] / l : 1 / o));\n        l -= a[c], i -= d, o--, a[c] += d;\n      }\n      a[a.length - 1] += i;\n    },\n    sortScales: function (i) {\n      function a(s, o) {\n        var l = new Date(1970, 0, 1);\n        return e.add(l, o, s) - l;\n      }\n      i.sort(function (s, o) {\n        return a(s.unit, s.step) < a(o.unit, o.step) ? 1 : a(s.unit, s.step) > a(o.unit, o.step) ? -1 : 0;\n      });\n      for (var r = 0; r < i.length; r++) i[r].index = r;\n    },\n    _isLegacyMode: function (i) {\n      var a = i || t.config;\n      return a.scale_unit || a.date_scale || a.subscales;\n    },\n    _prepareScaleObject: function (i) {\n      var a = i.format;\n      return a || (a = i.template || i.date || \"%d %M\"), typeof a == \"string\" && (a = t.date.date_to_str(a)), {\n        unit: i.unit || \"day\",\n        step: i.step || 1,\n        format: a,\n        css: i.css\n      };\n    },\n    primaryScale: function (i) {\n      var a,\n        r = n.getService(\"templateLoader\"),\n        s = this._isLegacyMode(i),\n        o = i || t.config;\n      if (s) r.initTemplate(\"date_scale\", void 0, void 0, o, t.config.templates), a = {\n        unit: t.config.scale_unit,\n        step: t.config.step,\n        template: t.templates.date_scale,\n        date: t.config.date_scale,\n        css: t.templates.scale_cell_class\n      };else {\n        var l = o.scales[0];\n        a = {\n          unit: l.unit,\n          step: l.step,\n          template: l.template,\n          format: l.format,\n          date: l.date,\n          css: l.css || t.templates.scale_cell_class\n        };\n      }\n      return this._prepareScaleObject(a);\n    },\n    getSubScales: function (i) {\n      var a,\n        r = this._isLegacyMode(i),\n        s = i || t.config;\n      if (r) {\n        let o = \"https://docs.dhtmlx.com/gantt/migrating.html#:~:text=%3D%20false%3B-,Time%20scale%20settings,-Configuration%20of%20time\";\n        t.env.isFF && (o = \"https://docs.dhtmlx.com/gantt/migrating.html#6162\"), console.warn(`You are using the obsolete scale configuration.\nIt will stop working in the future versions.\nPlease migrate the configuration to the newer version:\n${o}`), a = s.subscales || [];\n      } else a = s.scales.slice(1);\n      return a.map(function (o) {\n        return this._prepareScaleObject(o);\n      }.bind(this));\n    },\n    prepareConfigs: function (i, a, r, s, o, l, c) {\n      for (var d = this.splitSize(s, i.length), u = r, h = [], _ = i.length - 1; _ >= 0; _--) {\n        var p = _ == i.length - 1,\n          y = this.initScaleConfig(i[_], o, l);\n        p && this.processIgnores(y), this.initColSizes(y, a, u, d[_]), this.limitVisibleRange(y), p && (u = y.full_width), h.unshift(y);\n      }\n      for (_ = 0; _ < h.length - 1; _++) this.alineScaleColumns(h[h.length - 1], h[_]);\n      for (_ = 0; _ < h.length; _++) c && this.reverseScale(h[_]), this.setPosSettings(h[_]);\n      return h;\n    },\n    reverseScale: function (i) {\n      i.width = i.width.reverse(), i.trace_x = i.trace_x.reverse();\n      var a = i.trace_indexes;\n      i.trace_indexes = {}, i.trace_index_transition = {}, i.rtl = !0;\n      for (var r = 0; r < i.trace_x.length; r++) i.trace_indexes[i.trace_x[r].valueOf()] = r, i.trace_index_transition[a[i.trace_x[r].valueOf()]] = r;\n      return i;\n    },\n    setPosSettings: function (i) {\n      for (var a = 0, r = i.trace_x.length; a < r; a++) i.left.push((i.width[a - 1] || 0) + (i.left[a - 1] || 0));\n    },\n    _ignore_time_config: function (i, a) {\n      if (t.config.skip_off_time) {\n        for (var r = !0, s = i, o = 0; o < a.step; o++) o && (s = e.add(i, o, a.unit)), r = r && !this.isWorkTime(s, a.unit);\n        return r;\n      }\n      return !1;\n    },\n    processIgnores: function (i) {\n      i.ignore_x = {}, i.display_count = i.count;\n    },\n    initColSizes: function (i, a, r, s) {\n      var o = r;\n      i.height = s;\n      var l = i.display_count === void 0 ? i.count : i.display_count;\n      l || (l = 1), i.col_width = Math.floor(o / l), a && i.col_width < a && (i.col_width = a, o = i.col_width * l), i.width = [];\n      for (var c = i.ignore_x || {}, d = 0; d < i.trace_x.length; d++) if (c[i.trace_x[d].valueOf()] || i.display_count == i.count) i.width[d] = 0;else {\n        var u = 1;\n        i.unit == \"month\" && (u = Math.round((e.add(i.trace_x[d], i.step, i.unit) - i.trace_x[d]) / 864e5)), i.width[d] = u;\n      }\n      this.adjustSize(o - this.getSum(i.width), i.width), i.full_width = this.getSum(i.width);\n    },\n    initScaleConfig: function (i, a, r) {\n      var s = P({\n        count: 0,\n        col_width: 0,\n        full_width: 0,\n        height: 0,\n        width: [],\n        left: [],\n        trace_x: [],\n        trace_indexes: {},\n        min_date: new Date(a),\n        max_date: new Date(r)\n      }, i);\n      return this.eachColumn(i.unit, i.step, a, r, function (o) {\n        s.count++, s.trace_x.push(new Date(o)), s.trace_indexes[o.valueOf()] = s.trace_x.length - 1;\n      }), s.trace_x_ascending = s.trace_x.slice(), s;\n    },\n    iterateScales: function (i, a, r, s, o) {\n      for (var l = a.trace_x, c = i.trace_x, d = r || 0, u = s || c.length - 1, h = 0, _ = 1; _ < l.length; _++) {\n        var p = i.trace_indexes[+l[_]];\n        p !== void 0 && p <= u && (o && o.apply(this, [h, _, d, p]), d = p, h = _);\n      }\n    },\n    alineScaleColumns: function (i, a, r, s) {\n      this.iterateScales(i, a, r, s, function (o, l, c, d) {\n        var u = this.getSum(i.width, c, d - 1);\n        this.getSum(a.width, o, l - 1) != u && this.setSumWidth(u, a, o, l - 1);\n      });\n    },\n    eachColumn: function (i, a, r, s, o) {\n      var l = new Date(r),\n        c = new Date(s);\n      e[i + \"_start\"] && (l = e[i + \"_start\"](l));\n      var d = new Date(l);\n      for (+d >= +c && (c = e.add(d, a, i)); +d < +c;) {\n        o.call(this, new Date(d));\n        var u = d.getTimezoneOffset();\n        d = e.add(d, a, i), d = t._correct_dst_change(d, u, a, i), e[i + \"_start\"] && (d = e[i + \"_start\"](d));\n      }\n    },\n    limitVisibleRange: function (i) {\n      var a = i.trace_x,\n        r = i.width.length - 1,\n        s = 0;\n      if (+a[0] < +i.min_date && r != 0) {\n        var o = Math.floor(i.width[0] * ((a[1] - i.min_date) / (a[1] - a[0])));\n        s += i.width[0] - o, i.width[0] = o, a[0] = new Date(i.min_date);\n      }\n      var l = a.length - 1,\n        c = a[l],\n        d = e.add(c, i.step, i.unit);\n      if (+d > +i.max_date && l > 0 && (o = i.width[l] - Math.floor(i.width[l] * ((d - i.max_date) / (d - c))), s += i.width[l] - o, i.width[l] = o), s) {\n        for (var u = this.getSum(i.width), h = 0, _ = 0; _ < i.width.length; _++) {\n          var p = Math.floor(s * (i.width[_] / u));\n          i.width[_] += p, h += p;\n        }\n        this.adjustSize(s - h, i.width);\n      }\n    }\n  };\n}\nfunction ti(t) {\n  var e = function (d) {\n      var u = new pe(d).primaryScale(),\n        h = u.unit,\n        _ = u.step;\n      if (d.config.scale_offset_minimal) {\n        var p = new pe(d),\n          y = [p.primaryScale()].concat(p.getSubScales());\n        p.sortScales(y), h = y[y.length - 1].unit, _ = y[y.length - 1].step || 1;\n      }\n      return {\n        unit: h,\n        step: _\n      };\n    }(t),\n    n = e.unit,\n    i = e.step,\n    a = function (d, u) {\n      var h = {\n        start_date: null,\n        end_date: null\n      };\n      if (u.config.start_date && u.config.end_date) {\n        h.start_date = u.date[d + \"_start\"](new Date(u.config.start_date));\n        var _ = new Date(u.config.end_date),\n          p = u.date[d + \"_start\"](new Date(_));\n        _ = +_ != +p ? u.date.add(p, 1, d) : p, h.end_date = _;\n      }\n      return h;\n    }(n, t);\n  if (!a.start_date || !a.end_date) {\n    for (var r = !0, s = t.getTaskByTime(), o = 0; o < s.length; o++) if (s[o].type !== t.config.types.project) {\n      r = !1;\n      break;\n    }\n    if (s.length && r) {\n      var l = s[0].start_date,\n        c = t.date.add(l, 1, t.config.duration_unit);\n      a = {\n        start_date: new Date(l),\n        end_date: new Date(c)\n      };\n    } else a = t.getSubtaskDates();\n    a.start_date && a.end_date || (a = {\n      start_date: /* @__PURE__ */new Date(),\n      end_date: /* @__PURE__ */new Date()\n    }), t.eachTask(function (d) {\n      t.config.deadlines && d.deadline && ie(a, d.deadline, d.deadline), d.constraint_date && d.constraint_type && t.config.constraint_types && d.constraint_type !== t.config.constraint_types.ASAP && d.constraint_type !== t.config.constraint_types.ALAP && ie(a, d.constraint_date, d.constraint_date), t.config.baselines && d.baselines && d.baselines.forEach(function (u) {\n        ie(a, u.start_date, u.end_date);\n      });\n    }), a.start_date = t.date[n + \"_start\"](a.start_date), a.start_date = t.calculateEndDate({\n      start_date: t.date[n + \"_start\"](a.start_date),\n      duration: -1,\n      unit: n,\n      step: i\n    }), a.end_date = t.date[n + \"_start\"](a.end_date), a.end_date = t.calculateEndDate({\n      start_date: a.end_date,\n      duration: 2,\n      unit: n,\n      step: i\n    });\n  }\n  t._min_date = a.start_date, t._max_date = a.end_date;\n}\nfunction ie(t, e, n) {\n  e < t.start_date && (t.start_date = new Date(e)), n > t.end_date && (t.end_date = new Date(n));\n}\nfunction me(t) {\n  ti(t), function (e) {\n    if (e.config.fit_tasks) {\n      var n = +e._min_date,\n        i = +e._max_date;\n      if (+e._min_date != n || +e._max_date != i) return e.render(), e.callEvent(\"onScaleAdjusted\", []), !0;\n    }\n  }(t);\n}\nfunction Re(t, e, n) {\n  for (var i = 0; i < e.length; i++) t.isLinkExists(e[i]) && (n[e[i]] = t.getLink(e[i]));\n}\nfunction He(t, e, n) {\n  Re(t, e.$source, n), Re(t, e.$target, n);\n}\nconst ve = {\n  getSubtreeLinks: function (t, e) {\n    var n = {};\n    return t.isTaskExists(e) && He(t, t.getTask(e), n), t.eachTask(function (i) {\n      He(t, i, n);\n    }, e), n;\n  },\n  getSubtreeTasks: function (t, e) {\n    var n = {};\n    return t.eachTask(function (i) {\n      n[i.id] = i;\n    }, e), n;\n  }\n};\nclass ei {\n  constructor(e, n) {\n    this.$gantt = e, this.$dp = n, this._dataProcessorHandlers = [];\n  }\n  attach() {\n    const e = this.$dp,\n      n = this.$gantt,\n      i = {},\n      a = o => this.clientSideDelete(o, e, n);\n    this._dataProcessorHandlers.push(n.attachEvent(\"onAfterTaskAdd\", function (o, l) {\n      n.isTaskExists(o) && (e.setGanttMode(\"tasks\"), e.setUpdated(o, !0, \"inserted\"));\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onAfterTaskUpdate\", function (o, l) {\n      n.isTaskExists(o) && (e.setGanttMode(\"tasks\"), e.setUpdated(o, !0), n._sendTaskOrder && n._sendTaskOrder(o, l));\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onBeforeTaskDelete\", function (o, l) {\n      return n.config.cascade_delete && (i[o] = {\n        tasks: ve.getSubtreeTasks(n, o),\n        links: ve.getSubtreeLinks(n, o)\n      }), !e.deleteAfterConfirmation || (e.setGanttMode(\"tasks\"), e.setUpdated(o, !0, \"deleted\"), !1);\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onAfterTaskDelete\", function (o, l) {\n      e.setGanttMode(\"tasks\");\n      const c = !a(o),\n        d = n.config.cascade_delete && i[o];\n      if (c || d) {\n        if (d) {\n          const u = e.updateMode;\n          e.setUpdateMode(\"off\");\n          const h = i[o];\n          for (const _ in h.tasks) a(_) || (e.storeItem(h.tasks[_]), e.setUpdated(_, !0, \"deleted\"));\n          e.setGanttMode(\"links\");\n          for (const _ in h.links) a(_) || (e.storeItem(h.links[_]), e.setUpdated(_, !0, \"deleted\"));\n          i[o] = null, u !== \"off\" && e.sendAllData(), e.setGanttMode(\"tasks\"), e.setUpdateMode(u);\n        }\n        c && (e.storeItem(l), e.deleteAfterConfirmation || e.setUpdated(o, !0, \"deleted\")), e.updateMode === \"off\" || e._tSend || e.sendAllData();\n      }\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onAfterLinkUpdate\", function (o, l) {\n      n.isLinkExists(o) && (e.setGanttMode(\"links\"), e.setUpdated(o, !0));\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onAfterLinkAdd\", function (o, l) {\n      n.isLinkExists(o) && (e.setGanttMode(\"links\"), e.setUpdated(o, !0, \"inserted\"));\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onAfterLinkDelete\", function (o, l) {\n      e.setGanttMode(\"links\"), !a(o) && (e.storeItem(l), e.setUpdated(o, !0, \"deleted\"));\n    })), this._dataProcessorHandlers.push(n.attachEvent(\"onRowDragEnd\", function (o, l) {\n      n._sendTaskOrder(o, n.getTask(o));\n    }));\n    let r = null,\n      s = null;\n    this._dataProcessorHandlers.push(n.attachEvent(\"onTaskIdChange\", function (o, l) {\n      if (!e._waitMode) return;\n      const c = n.getChildren(l);\n      if (c.length) {\n        r = r || {};\n        for (let u = 0; u < c.length; u++) {\n          const h = this.getTask(c[u]);\n          r[h.id] = h;\n        }\n      }\n      const d = function (u) {\n        let h = [];\n        return u.$source && (h = h.concat(u.$source)), u.$target && (h = h.concat(u.$target)), h;\n      }(this.getTask(l));\n      if (d.length) {\n        s = s || {};\n        for (let u = 0; u < d.length; u++) {\n          const h = this.getLink(d[u]);\n          s[h.id] = h;\n        }\n      }\n    })), e.attachEvent(\"onAfterUpdateFinish\", function () {\n      (r || s) && (n.batchUpdate(function () {\n        for (const o in r) n.updateTask(r[o].id);\n        for (const o in s) n.updateLink(s[o].id);\n        r = null, s = null;\n      }), r ? n._dp.setGanttMode(\"tasks\") : n._dp.setGanttMode(\"links\"));\n    }), e.attachEvent(\"onBeforeDataSending\", function () {\n      if (this._tMode === \"CUSTOM\") return !0;\n      let o = this._serverProcessor;\n      if (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\n        const l = this._ganttMode;\n        o = o.substring(0, o.indexOf(\"?\") > -1 ? o.indexOf(\"?\") : o.length), this.serverProcessor = o + (o.slice(-1) === \"/\" ? \"\" : \"/\") + l;\n      } else {\n        const l = this._ganttMode + \"s\";\n        this.serverProcessor = o + n.ajax.urlSeparator(o) + \"gantt_mode=\" + l;\n      }\n      return !0;\n    }), e.attachEvent(\"insertCallback\", function (o, l, c, d) {\n      const u = o.data || n.xml._xmlNodeToJSON(o.firstChild),\n        h = {\n          add: n.addTask,\n          isExist: n.isTaskExists\n        };\n      d === \"links\" && (h.add = n.addLink, h.isExist = n.isLinkExists), h.isExist.call(n, l) || (u.id = l, h.add.call(n, u));\n    }), e.attachEvent(\"updateCallback\", function (o, l) {\n      const c = o.data || n.xml._xmlNodeToJSON(o.firstChild);\n      if (!n.isTaskExists(l)) return;\n      const d = n.getTask(l);\n      for (const u in c) {\n        let h = c[u];\n        switch (u) {\n          case \"id\":\n            continue;\n          case \"start_date\":\n          case \"end_date\":\n            h = n.defined(n.templates.xml_date) ? n.templates.xml_date(h) : n.templates.parse_date(h);\n            break;\n          case \"duration\":\n            d.end_date = n.calculateEndDate({\n              start_date: d.start_date,\n              duration: h,\n              task: d\n            });\n        }\n        d[u] = h;\n      }\n      n.updateTask(l), n.refreshData();\n    }), e.attachEvent(\"deleteCallback\", function (o, l, c, d) {\n      const u = {\n        delete: n.deleteTask,\n        isExist: n.isTaskExists\n      };\n      d === \"links\" ? (u.delete = n.deleteLink, u.isExist = n.isLinkExists) : d === \"assignment\" && (u.delete = function (h) {\n        n.$data.assignmentsStore.remove(h);\n      }, u.isExist = function (h) {\n        return n.$data.assignmentsStore.exists(h);\n      }), u.isExist.call(n, l) && u.delete.call(n, l);\n    }), this.handleResourceCRUD(e, n), this.handleResourceAssignmentCRUD(e, n), this.handleBaselineCRUD(e, n);\n  }\n  clientSideDelete(e, n, i) {\n    const a = n.updatedRows.slice();\n    let r = !1;\n    i.getUserData(e, \"!nativeeditor_status\", n._ganttMode) === \"true_deleted\" && (r = !0, n.setUpdated(e, !1));\n    for (let s = 0; s < a.length && !n._in_progress[e]; s++) a[s] === e && (i.getUserData(e, \"!nativeeditor_status\", n._ganttMode) === \"inserted\" && (r = !0), n.setUpdated(e, !1));\n    return r;\n  }\n  handleResourceAssignmentCRUD(e, n) {\n    if (!n.config.resources || n.config.resources.dataprocessor_assignments !== !0) return;\n    const i = n.getDatastore(n.config.resource_assignment_store),\n      a = {},\n      r = {};\n    function s(o) {\n      const l = o.id;\n      i.exists(l) && (e.setGanttMode(\"assignment\"), e.setUpdated(l, !0, \"inserted\")), delete r[l];\n    }\n    n.attachEvent(\"onBeforeTaskAdd\", function (o, l) {\n      return a[o] = !0, !0;\n    }), n.attachEvent(\"onTaskIdChange\", function (o, l) {\n      delete a[o];\n    }), i.attachEvent(\"onAfterAdd\", (o, l) => {\n      a[l.task_id] ? function (c) {\n        r[c.id] = c, a[c.task_id] = !0;\n      }(l) : s(l);\n    }), i.attachEvent(\"onAfterUpdate\", (o, l) => {\n      i.exists(o) && (r[o] ? s(l) : (e.setGanttMode(\"assignment\"), e.setUpdated(o, !0)));\n    }), i.attachEvent(\"onAfterDelete\", (o, l) => {\n      e.setGanttMode(\"assignment\"), !this.clientSideDelete(o, e, n) && (e.storeItem(l), e.setUpdated(o, !0, \"deleted\"));\n    });\n  }\n  handleResourceCRUD(e, n) {\n    if (!n.config.resources || n.config.resources.dataprocessor_resources !== !0) return;\n    const i = n.getDatastore(n.config.resource_store);\n    i.attachEvent(\"onAfterAdd\", (a, r) => {\n      (function (s) {\n        const o = s.id;\n        i.exists(o) && (e.setGanttMode(\"resource\"), e.setUpdated(o, !0, \"inserted\"));\n      })(r);\n    }), i.attachEvent(\"onAfterUpdate\", (a, r) => {\n      i.exists(a) && (e.setGanttMode(\"resource\"), e.setUpdated(a, !0));\n    }), i.attachEvent(\"onAfterDelete\", (a, r) => {\n      e.setGanttMode(\"resource\"), !this.clientSideDelete(a, e, n) && (e.storeItem(r), e.setUpdated(a, !0, \"deleted\"));\n    });\n  }\n  handleBaselineCRUD(e, n) {\n    if (!n.config.baselines || n.config.baselines.dataprocessor_baselines !== !0) return;\n    const i = n.getDatastore(n.config.baselines.datastore);\n    i.attachEvent(\"onAfterAdd\", (a, r) => {\n      (function (s) {\n        const o = s.id;\n        i.exists(o) && (e.setGanttMode(\"baseline\"), e.setUpdated(o, !0, \"inserted\"));\n      })(r);\n    }), i.attachEvent(\"onAfterUpdate\", (a, r) => {\n      i.exists(a) && (e.setGanttMode(\"baseline\"), e.setUpdated(a, !0));\n    }), i.attachEvent(\"onAfterDelete\", (a, r) => {\n      e.setGanttMode(\"baseline\"), !this.clientSideDelete(a, e, n) && (e.storeItem(r), e.setUpdated(a, !0, \"deleted\"));\n    });\n  }\n  detach() {\n    kt(this._dataProcessorHandlers, e => {\n      this.$gantt.detachEvent(e);\n    }), this._dataProcessorHandlers = [];\n  }\n}\nconst Xt = class Xt {\n  constructor() {\n    this.clear = () => {\n      this._storage = {};\n    }, this.storeItem = e => {\n      this._storage[e.id] = q(e);\n    }, this.getStoredItem = e => this._storage[e] || null, this._storage = {};\n  }\n};\nXt.create = () => new Xt();\nlet Jt = Xt,\n  un = class {\n    constructor(t) {\n      this.serverProcessor = t, this.action_param = \"!nativeeditor_status\", this.updatedRows = [], this.autoUpdate = !0, this.updateMode = \"cell\", this._headers = null, this._payload = null, this._postDelim = \"_\", this._routerParametersFormat = \"parameters\", this._waitMode = 0, this._in_progress = {}, this._storage = Jt.create(), this._invalid = {}, this.messages = [], this.styles = {\n        updated: \"font-weight:bold;\",\n        inserted: \"font-weight:bold;\",\n        deleted: \"text-decoration : line-through;\",\n        invalid: \"background-color:FFE0E0;\",\n        invalid_cell: \"border-bottom:2px solid red;\",\n        error: \"color:red;\",\n        clear: \"font-weight:normal;text-decoration:none;\"\n      }, this.enableUTFencoding(!0), ot(this);\n    }\n    setTransactionMode(t, e) {\n      typeof t == \"object\" ? (this._tMode = t.mode || this._tMode, W(t.headers) && (this._headers = t.headers), W(t.payload) && (this._payload = t.payload), this._tSend = !!e) : (this._tMode = t, this._tSend = e), this._tMode === \"REST\" && (this._tSend = !1), this._tMode === \"JSON\" || this._tMode === \"REST-JSON\" ? (this._tSend = !1, this._serializeAsJson = !0, this._headers = this._headers || {}, this._headers[\"Content-Type\"] = \"application/json\") : this._headers && !this._headers[\"Content-Type\"] && (this._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\"), this._tMode === \"CUSTOM\" && (this._tSend = !1, this._router = t.router);\n    }\n    escape(t) {\n      return this._utf ? encodeURIComponent(t) : escape(t);\n    }\n    enableUTFencoding(t) {\n      this._utf = !!t;\n    }\n    getSyncState() {\n      return !this.updatedRows.length;\n    }\n    setUpdateMode(t, e) {\n      this.autoUpdate = t === \"cell\", this.updateMode = t, this.dnd = e;\n    }\n    ignore(t, e) {\n      this._silent_mode = !0, t.call(e || Z), this._silent_mode = !1;\n    }\n    setUpdated(t, e, n) {\n      if (this._silent_mode) return;\n      const i = this.findRow(t);\n      n = n || \"updated\";\n      const a = this.$gantt.getUserData(t, this.action_param, this._ganttMode);\n      a && n === \"updated\" && (n = a), e ? (this.set_invalid(t, !1), this.updatedRows[i] = t, this.$gantt.setUserData(t, this.action_param, n, this._ganttMode), this._in_progress[t] && (this._in_progress[t] = \"wait\")) : this.is_invalid(t) || (this.updatedRows.splice(i, 1), this.$gantt.setUserData(t, this.action_param, \"\", this._ganttMode)), this.markRow(t, e, n), e && this.autoUpdate && this.sendData(t);\n    }\n    markRow(t, e, n) {\n      let i = \"\";\n      const a = this.is_invalid(t);\n      if (a && (i = this.styles[a], e = !0), this.callEvent(\"onRowMark\", [t, e, n, a]) && (i = this.styles[e ? n : \"clear\"] + \" \" + i, this.$gantt[this._methods[0]](t, i), a && a.details)) {\n        i += this.styles[a + \"_cell\"];\n        for (let r = 0; r < a.details.length; r++) a.details[r] && this.$gantt[this._methods[1]](t, r, i);\n      }\n    }\n    getActionByState(t) {\n      return t === \"inserted\" ? \"create\" : t === \"updated\" ? \"update\" : t === \"deleted\" ? \"delete\" : \"update\";\n    }\n    getState(t) {\n      return this.$gantt.getUserData(t, this.action_param, this._ganttMode);\n    }\n    is_invalid(t) {\n      return this._invalid[t];\n    }\n    set_invalid(t, e, n) {\n      n && (e = {\n        value: e,\n        details: n,\n        toString: function () {\n          return this.value.toString();\n        }\n      }), this._invalid[t] = e;\n    }\n    checkBeforeUpdate(t) {\n      return !0;\n    }\n    sendData(t) {\n      if (this.$gantt.editStop && this.$gantt.editStop(), t === void 0 || this._tSend) {\n        const e = [];\n        if (this.modes && [\"task\", \"link\", \"assignment\", \"baseline\"].forEach(n => {\n          this.modes[n] && this.modes[n].updatedRows.length && e.push(n);\n        }), e.length) {\n          for (let n = 0; n < e.length; n++) this.setGanttMode(e[n]), this.sendAllData();\n          return;\n        }\n        return this.sendAllData();\n      }\n      return !this._in_progress[t] && (this.messages = [], !(!this.checkBeforeUpdate(t) && this.callEvent(\"onValidationError\", [t, this.messages])) && void this._beforeSendData(this._getRowData(t), t));\n    }\n    serialize(t, e) {\n      if (this._serializeAsJson) return this._serializeAsJSON(t);\n      if (typeof t == \"string\") return t;\n      if (e !== void 0) return this.serialize_one(t, \"\");\n      {\n        const n = [],\n          i = [];\n        for (const a in t) t.hasOwnProperty(a) && (n.push(this.serialize_one(t[a], a + this._postDelim)), i.push(a));\n        return n.push(\"ids=\" + this.escape(i.join(\",\"))), this.$gantt.security_key && n.push(\"dhx_security=\" + this.$gantt.security_key), n.join(\"&\");\n      }\n    }\n    serialize_one(t, e) {\n      if (typeof t == \"string\") return t;\n      const n = [];\n      let i = \"\";\n      for (const a in t) if (t.hasOwnProperty(a)) {\n        if ((a === \"id\" || a == this.action_param) && this._tMode === \"REST\") continue;\n        i = typeof t[a] == \"string\" || typeof t[a] == \"number\" ? String(t[a]) : JSON.stringify(t[a]), n.push(this.escape((e || \"\") + a) + \"=\" + this.escape(i));\n      }\n      return n.join(\"&\");\n    }\n    sendAllData() {\n      if (!this.updatedRows.length) return;\n      this.messages = [];\n      let t = !0;\n      if (this._forEachUpdatedRow(function (e) {\n        t = t && this.checkBeforeUpdate(e);\n      }), !t && !this.callEvent(\"onValidationError\", [\"\", this.messages])) return !1;\n      this._tSend ? this._sendData(this._getAllData()) : this._forEachUpdatedRow(function (e) {\n        if (!this._in_progress[e]) {\n          if (this.is_invalid(e)) return;\n          this._beforeSendData(this._getRowData(e), e);\n        }\n      });\n    }\n    findRow(t) {\n      let e = 0;\n      for (e = 0; e < this.updatedRows.length && t != this.updatedRows[e]; e++);\n      return e;\n    }\n    defineAction(t, e) {\n      this._uActions || (this._uActions = {}), this._uActions[t] = e;\n    }\n    afterUpdateCallback(t, e, n, i, a) {\n      if (!this.$gantt) return;\n      this.setGanttMode(a);\n      const r = t,\n        s = n !== \"error\" && n !== \"invalid\";\n      if (s || this.set_invalid(t, n), this._uActions && this._uActions[n] && !this._uActions[n](i)) return delete this._in_progress[r];\n      this._in_progress[r] !== \"wait\" && this.setUpdated(t, !1);\n      const o = t;\n      switch (n) {\n        case \"inserted\":\n        case \"insert\":\n          e != t && (this.setUpdated(t, !1), this.$gantt[this._methods[2]](t, e), t = e);\n          break;\n        case \"delete\":\n        case \"deleted\":\n          if (this.deleteAfterConfirmation && this._ganttMode === \"task\") {\n            if (this._ganttMode === \"task\" && this.$gantt.isTaskExists(t)) {\n              this.$gantt.setUserData(t, this.action_param, \"true_deleted\", this._ganttMode);\n              const l = this.$gantt.getTask(t);\n              this.$gantt.silent(() => {\n                this.$gantt.deleteTask(t);\n              }), this.$gantt.callEvent(\"onAfterTaskDelete\", [t, l]), this.$gantt.render(), delete this._in_progress[r];\n            }\n            return this.callEvent(\"onAfterUpdate\", [t, n, e, i]);\n          }\n          return this.$gantt.setUserData(t, this.action_param, \"true_deleted\", this._ganttMode), this.$gantt[this._methods[3]](t), delete this._in_progress[r], this.callEvent(\"onAfterUpdate\", [t, n, e, i]);\n      }\n      this._in_progress[r] !== \"wait\" ? (s && this.$gantt.setUserData(t, this.action_param, \"\", this._ganttMode), delete this._in_progress[r]) : (delete this._in_progress[r], this.setUpdated(e, !0, this.$gantt.getUserData(t, this.action_param, this._ganttMode))), this.callEvent(\"onAfterUpdate\", [o, n, e, i]);\n    }\n    afterUpdate(t, e, n) {\n      let i;\n      i = arguments.length === 3 ? arguments[1] : arguments[4];\n      let a = this.getGanttMode();\n      const r = i.filePath || i.url;\n      a = this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\" ? r.indexOf(\"gantt_mode=links\") !== -1 ? \"link\" : r.indexOf(\"gantt_mode=assignments\") !== -1 ? \"assignment\" : r.indexOf(\"gantt_mode=baselines\") !== -1 ? \"baseline\" : \"task\" : r.indexOf(\"/link\") >= 0 ? \"link\" : r.indexOf(\"/assignment\") >= 0 ? \"assignment\" : r.indexOf(\"/baseline\") >= 0 ? \"baseline\" : \"task\", this.setGanttMode(a);\n      const s = this.$gantt.ajax;\n      let o;\n      try {\n        o = JSON.parse(e.xmlDoc.responseText);\n      } catch {\n        e.xmlDoc.responseText.length || (o = {});\n      }\n      const l = u => {\n        const h = o.action || this.getState(u) || \"updated\",\n          _ = o.sid || u[0],\n          p = o.tid || u[0];\n        t.afterUpdateCallback(_, p, h, o, a);\n      };\n      if (o) return Array.isArray(n) && n.length > 1 ? n.forEach(u => l(u)) : l(n), t.finalizeUpdate(), void this.setGanttMode(a);\n      const c = s.xmltop(\"data\", e.xmlDoc);\n      if (!c) return this.cleanUpdate(n);\n      const d = s.xpath(\"//data/action\", c);\n      if (!d.length) return this.cleanUpdate(n);\n      for (let u = 0; u < d.length; u++) {\n        const h = d[u],\n          _ = h.getAttribute(\"type\"),\n          p = h.getAttribute(\"sid\"),\n          y = h.getAttribute(\"tid\");\n        t.afterUpdateCallback(p, y, _, h, a);\n      }\n      t.finalizeUpdate();\n    }\n    cleanUpdate(t) {\n      if (t) for (let e = 0; e < t.length; e++) delete this._in_progress[t[e]];\n    }\n    finalizeUpdate() {\n      this._waitMode && this._waitMode--, this.callEvent(\"onAfterUpdateFinish\", []), this.updatedRows.length || this.callEvent(\"onFullSync\", []);\n    }\n    init(t) {\n      if (this._initialized) return;\n      this.$gantt = t, this.$gantt._dp_init && this.$gantt._dp_init(this), this._setDefaultTransactionMode(), this.styles = {\n        updated: \"gantt_updated\",\n        order: \"gantt_updated\",\n        inserted: \"gantt_inserted\",\n        deleted: \"gantt_deleted\",\n        delete_confirmation: \"gantt_deleted\",\n        invalid: \"gantt_invalid\",\n        error: \"gantt_error\",\n        clear: \"\"\n      }, this._methods = [\"_row_style\", \"setCellTextStyle\", \"_change_id\", \"_delete_task\"], function (n, i) {\n        n.getUserData = function (a, r, s) {\n          return this.userdata || (this.userdata = {}), this.userdata[s] = this.userdata[s] || {}, this.userdata[s][a] && this.userdata[s][a][r] ? this.userdata[s][a][r] : \"\";\n        }, n.setUserData = function (a, r, s, o) {\n          this.userdata || (this.userdata = {}), this.userdata[o] = this.userdata[o] || {}, this.userdata[o][a] = this.userdata[o][a] || {}, this.userdata[o][a][r] = s;\n        }, n._change_id = function (a, r) {\n          switch (this._dp._ganttMode) {\n            case \"task\":\n              this.changeTaskId(a, r);\n              break;\n            case \"link\":\n              this.changeLinkId(a, r);\n              break;\n            case \"assignment\":\n              this.$data.assignmentsStore.changeId(a, r);\n              break;\n            case \"resource\":\n              this.$data.resourcesStore.changeId(a, r);\n              break;\n            case \"baseline\":\n              this.$data.baselineStore.changeId(a, r);\n              break;\n            default:\n              throw new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${r}`);\n          }\n        }, n._row_style = function (a, r) {\n          this._dp._ganttMode === \"task\" && n.isTaskExists(a) && (n.getTask(a).$dataprocessor_class = r, n.refreshTask(a));\n        }, n._delete_task = function (a, r) {}, n._sendTaskOrder = function (a, r) {\n          r.$drop_target && (this._dp.setGanttMode(\"task\"), this.getTask(a).target = r.$drop_target, this._dp.setUpdated(a, !0, \"order\"), delete this.getTask(a).$drop_target);\n        }, n.setDp = function () {\n          this._dp = i;\n        }, n.setDp();\n      }(this.$gantt, this);\n      const e = new ei(this.$gantt, this);\n      e.attach(), this.attachEvent(\"onDestroy\", function () {\n        delete this.setGanttMode, delete this._getRowData, delete this.$gantt._dp, delete this.$gantt._change_id, delete this.$gantt._row_style, delete this.$gantt._delete_task, delete this.$gantt._sendTaskOrder, delete this.$gantt, e.detach();\n      }), this.$gantt.callEvent(\"onDataProcessorReady\", [this]), this._initialized = !0;\n    }\n    setOnAfterUpdate(t) {\n      this.attachEvent(\"onAfterUpdate\", t);\n    }\n    setOnBeforeUpdateHandler(t) {\n      this.attachEvent(\"onBeforeDataSending\", t);\n    }\n    setAutoUpdate(t, e) {\n      t = t || 2e3, this._user = e || (/* @__PURE__ */new Date()).valueOf(), this._needUpdate = !1, this._updateBusy = !1, this.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate), this.attachEvent(\"onFullSync\", this.fullSync), setInterval(() => {\n        this.loadUpdate();\n      }, t);\n    }\n    afterAutoUpdate(t, e, n, i) {\n      return e !== \"collision\" || (this._needUpdate = !0, !1);\n    }\n    fullSync() {\n      return this._needUpdate && (this._needUpdate = !1, this.loadUpdate()), !0;\n    }\n    getUpdates(t, e) {\n      const n = this.$gantt.ajax;\n      if (this._updateBusy) return !1;\n      this._updateBusy = !0, n.get(t, e);\n    }\n    loadUpdate() {\n      const t = this.$gantt.ajax,\n        e = this.$gantt.getUserData(0, \"version\", this._ganttMode);\n      let n = this.serverProcessor + t.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + e].join(\"&\");\n      n = n.replace(\"editing=true&\", \"\"), this.getUpdates(n, i => {\n        const a = t.xpath(\"//userdata\", i);\n        this.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(a[0]), this._ganttMode);\n        const r = t.xpath(\"//update\", i);\n        if (r.length) {\n          this._silent_mode = !0;\n          for (let s = 0; s < r.length; s++) {\n            const o = r[s].getAttribute(\"status\"),\n              l = r[s].getAttribute(\"id\"),\n              c = r[s].getAttribute(\"parent\");\n            switch (o) {\n              case \"inserted\":\n                this.callEvent(\"insertCallback\", [r[s], l, c]);\n                break;\n              case \"updated\":\n                this.callEvent(\"updateCallback\", [r[s], l, c]);\n                break;\n              case \"deleted\":\n                this.callEvent(\"deleteCallback\", [r[s], l, c]);\n            }\n          }\n          this._silent_mode = !1;\n        }\n        this._updateBusy = !1;\n      });\n    }\n    destructor() {\n      this.callEvent(\"onDestroy\", []), this.detachAllEvents(), this.updatedRows = [], this._in_progress = {}, this._invalid = {}, this._storage.clear(), this._storage = null, this._headers = null, this._payload = null, delete this._initialized;\n    }\n    setGanttMode(t) {\n      t === \"tasks\" ? t = \"task\" : t === \"links\" && (t = \"link\");\n      const e = this.modes || {},\n        n = this.getGanttMode();\n      n && (e[n] = {\n        _in_progress: this._in_progress,\n        _invalid: this._invalid,\n        _storage: this._storage,\n        updatedRows: this.updatedRows\n      });\n      let i = e[t];\n      i || (i = e[t] = {\n        _in_progress: {},\n        _invalid: {},\n        _storage: Jt.create(),\n        updatedRows: []\n      }), this._in_progress = i._in_progress, this._invalid = i._invalid, this._storage = i._storage, this.updatedRows = i.updatedRows, this.modes = e, this._ganttMode = t;\n    }\n    getGanttMode() {\n      return this._ganttMode;\n    }\n    storeItem(t) {\n      this._storage.storeItem(t);\n    }\n    url(t) {\n      this.serverProcessor = this._serverProcessor = t;\n    }\n    _beforeSendData(t, e) {\n      if (!this.callEvent(\"onBeforeUpdate\", [e, this.getState(e), t])) return !1;\n      this._sendData(t, e);\n    }\n    _serializeAsJSON(t) {\n      if (typeof t == \"string\") return t;\n      const e = q(t);\n      return this._tMode === \"REST-JSON\" && (delete e.id, delete e[this.action_param]), JSON.stringify(e);\n    }\n    _applyPayload(t) {\n      const e = this.$gantt.ajax;\n      if (this._payload) for (const n in this._payload) t = t + e.urlSeparator(t) + this.escape(n) + \"=\" + this.escape(this._payload[n]);\n      return t;\n    }\n    _cleanupArgumentsBeforeSend(t) {\n      let e;\n      if (t[this.action_param] === void 0) {\n        e = {};\n        for (const n in t) e[n] = this._cleanupArgumentsBeforeSend(t[n]);\n      } else e = this._cleanupItemBeforeSend(t);\n      return e;\n    }\n    _cleanupItemBeforeSend(t) {\n      let e = null;\n      return t && (t[this.action_param] === \"deleted\" ? (e = {}, e.id = t.id, e[this.action_param] = t[this.action_param]) : e = t), e;\n    }\n    _sendData(t, e) {\n      if (!t) return;\n      if (!this.callEvent(\"onBeforeDataSending\", e ? [e, this.getState(e), t] : [null, null, t])) return !1;\n      e && (this._in_progress[e] = (/* @__PURE__ */new Date()).valueOf());\n      const n = this.$gantt.ajax;\n      if (this._tMode === \"CUSTOM\") {\n        const l = this.getState(e),\n          c = this.getActionByState(l);\n        delete t[this.action_param];\n        const d = this.getGanttMode(),\n          u = _ => {\n            let p = l || \"updated\",\n              y = e,\n              k = e;\n            _ && (p = _.action || l, y = _.sid || y, k = _.id || _.tid || k), this.afterUpdateCallback(y, k, p, _, d);\n          };\n        let h;\n        if (this._router instanceof Function) {\n          if (this._routerParametersFormat === \"object\") {\n            const _ = {\n              entity: d,\n              action: c,\n              data: t,\n              id: e\n            };\n            h = this._router(_);\n          } else h = this._router(d, c, t, e);\n        } else if (this._router[d] instanceof Function) h = this._router[d](c, t, e);else {\n          const _ = \"Incorrect configuration of gantt.createDataProcessor\",\n            p = `\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\n          if (!this._router[d]) throw new Error(`${_}: router for the **${d}** entity is not defined. ${p}`);\n          switch (l) {\n            case \"inserted\":\n              if (!this._router[d].create) throw new Error(`${_}: **create** action for the **${d}** entity is not defined. ${p}`);\n              h = this._router[d].create(t);\n              break;\n            case \"deleted\":\n              if (!this._router[d].delete) throw new Error(`${_}: **delete** action for the **${d}** entity is not defined. ${p}`);\n              h = this._router[d].delete(e);\n              break;\n            default:\n              if (!this._router[d].update) throw new Error(`${_}: **update**\" action for the **${d}** entity is not defined. ${p}`);\n              h = this._router[d].update(t, e);\n          }\n        }\n        if (h) {\n          if (!h.then && h.id === void 0 && h.tid === void 0 && h.action === void 0) throw new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n          h.then ? h.then(u).catch(_ => {\n            _ && _.action ? u(_) : u({\n              action: \"error\",\n              value: _\n            });\n          }) : u(h);\n        } else u(null);\n        return;\n      }\n      let i;\n      i = {\n        callback: l => {\n          const c = [];\n          if (e) c.push(e);else if (t) for (const d in t) c.push(d);\n          return this.afterUpdate(this, l, c);\n        },\n        headers: this._headers\n      };\n      const a = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode),\n        r = this.serverProcessor + (this._user ? n.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, a].join(\"&\") : \"\");\n      let s,\n        o = this._applyPayload(r);\n      switch (this._tMode) {\n        case \"GET\":\n          s = this._cleanupArgumentsBeforeSend(t), i.url = o + n.urlSeparator(o) + this.serialize(s, e), i.method = \"GET\";\n          break;\n        case \"POST\":\n          s = this._cleanupArgumentsBeforeSend(t), i.url = o, i.method = \"POST\", i.data = this.serialize(s, e);\n          break;\n        case \"JSON\":\n          s = {};\n          const l = this._cleanupItemBeforeSend(t);\n          for (const c in l) c !== this.action_param && c !== \"id\" && c !== \"gr_id\" && (s[c] = l[c]);\n          i.url = o, i.method = \"POST\", i.data = JSON.stringify({\n            id: e,\n            action: t[this.action_param],\n            data: s\n          });\n          break;\n        case \"REST\":\n        case \"REST-JSON\":\n          switch (o = r.replace(/(&|\\?)editing=true/, \"\"), s = \"\", this.getState(e)) {\n            case \"inserted\":\n              i.method = \"POST\", i.data = this.serialize(t, e);\n              break;\n            case \"deleted\":\n              i.method = \"DELETE\", o = o + (o.slice(-1) === \"/\" ? \"\" : \"/\") + e;\n              break;\n            default:\n              i.method = \"PUT\", i.data = this.serialize(t, e), o = o + (o.slice(-1) === \"/\" ? \"\" : \"/\") + e;\n          }\n          i.url = this._applyPayload(o);\n      }\n      return this._waitMode++, n.query(i);\n    }\n    _forEachUpdatedRow(t) {\n      const e = this.updatedRows.slice();\n      for (let n = 0; n < e.length; n++) {\n        const i = e[n];\n        this.$gantt.getUserData(i, this.action_param, this._ganttMode) && t.call(this, i);\n      }\n    }\n    _setDefaultTransactionMode() {\n      this.serverProcessor && (this.setTransactionMode(\"POST\", !0), this.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\", this._serverProcessor = this.serverProcessor);\n    }\n    _getXmlNodeValue(t) {\n      return t.firstChild ? t.firstChild.nodeValue : \"\";\n    }\n    _getAllData() {\n      const t = {};\n      let e = !1;\n      return this._forEachUpdatedRow(function (n) {\n        if (this._in_progress[n] || this.is_invalid(n)) return;\n        const i = this._getRowData(n);\n        this.callEvent(\"onBeforeUpdate\", [n, this.getState(n), i]) && (t[n] = i, e = !0, this._in_progress[n] = (/* @__PURE__ */new Date()).valueOf());\n      }), e ? t : null;\n    }\n    _prepareDate(t) {\n      return this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(t) : this.$gantt.templates.format_date(t);\n    }\n    _prepareArray(t, e) {\n      return e.push(t), t.map(n => Q(n) ? this._prepareDate(n) : Array.isArray(n) && !zt(e, n) ? this._prepareArray(n, e) : n && typeof n == \"object\" && !zt(e, n) ? this._prepareObject(n, e) : n);\n    }\n    _prepareObject(t, e) {\n      const n = {};\n      e.push(t);\n      for (const i in t) {\n        if (i.substr(0, 1) === \"$\") continue;\n        const a = t[i];\n        Q(a) ? n[i] = this._prepareDate(a) : a === null ? n[i] = \"\" : Array.isArray(a) && !zt(e, a) ? n[i] = this._prepareArray(a, e) : a && typeof a == \"object\" && !zt(e, a) ? n[i] = this._prepareObject(a, e) : n[i] = a;\n      }\n      return n;\n    }\n    _prepareDataItem(t) {\n      const e = this._prepareObject(t, []);\n      return e[this.action_param] = this.$gantt.getUserData(t.id, this.action_param, this._ganttMode), e;\n    }\n    getStoredItem(t) {\n      return this._storage.getStoredItem(t);\n    }\n    _getRowData(t) {\n      let e;\n      const n = this.$gantt;\n      return this.getGanttMode() === \"task\" ? n.isTaskExists(t) && (e = this.$gantt.getTask(t)) : this.getGanttMode() === \"assignment\" ? this.$gantt.$data.assignmentsStore.exists(t) && (e = this.$gantt.$data.assignmentsStore.getItem(t)) : this.getGanttMode() === \"baseline\" ? this.$gantt.$data.baselineStore.exists(t) && (e = this.$gantt.$data.baselineStore.getItem(t)) : n.isLinkExists(t) && (e = this.$gantt.getLink(t)), e || (e = this.getStoredItem(t)), e || (e = {\n        id: t\n      }), this._prepareDataItem(e);\n    }\n  };\nconst ni = function (t) {\n    return new un(t);\n  },\n  ii = function (t) {\n    let e, n, i;\n    t instanceof Function ? e = t : t.hasOwnProperty(\"router\") ? e = t.router : t.hasOwnProperty(\"assignment\") || t.hasOwnProperty(\"baseline\") || t.hasOwnProperty(\"link\") || t.hasOwnProperty(\"task\") ? e = t : t.hasOwnProperty(\"headers\") && (i = t.headers), n = e ? \"CUSTOM\" : t.mode || \"REST-JSON\";\n    const a = new un(t.url);\n    return a.init(this), a.setTransactionMode({\n      mode: n,\n      router: e,\n      headers: i\n    }, t.batchUpdate), t.deleteAfterConfirmation && (a.deleteAfterConfirmation = t.deleteAfterConfirmation), a;\n  };\nfunction ai(t) {\n  var e = {},\n    n = !1;\n  function i(l, c) {\n    c = typeof c == \"function\" ? c : function () {}, e[l] || (e[l] = this[l], this[l] = c);\n  }\n  function a(l) {\n    e[l] && (this[l] = e[l], e[l] = null);\n  }\n  function r(l) {\n    for (var c in l) i.call(this, c, l[c]);\n  }\n  function s() {\n    for (var l in e) a.call(this, l);\n  }\n  function o(l) {\n    try {\n      l();\n    } catch (c) {\n      Z.console.error(c);\n    }\n  }\n  return t.$services.getService(\"state\").registerProvider(\"batchUpdate\", function () {\n    return {\n      batch_update: n\n    };\n  }, !1), function (l, c) {\n    if (n) o(l);else {\n      var d,\n        u = this._dp && this._dp.updateMode != \"off\";\n      u && (d = this._dp.updateMode, this._dp.setUpdateMode(\"off\"));\n      var h = {},\n        _ = {\n          render: !0,\n          refreshData: !0,\n          refreshTask: !0,\n          refreshLink: !0,\n          resetProjectDates: function (y) {\n            h[y.id] = y;\n          }\n        };\n      for (var p in r.call(this, _), n = !0, this.callEvent(\"onBeforeBatchUpdate\", []), o(l), this.callEvent(\"onAfterBatchUpdate\", []), s.call(this), h) this.resetProjectDates(h[p]);\n      n = !1, c || this.render(), u && (this._dp.setUpdateMode(d), this._dp.setGanttMode(\"task\"), this._dp.sendData(), this._dp.setGanttMode(\"link\"), this._dp.sendData());\n    }\n  };\n}\nfunction ri(t) {\n  t.batchUpdate = ai(t);\n}\nfunction si(t) {\n  const e = /* @__PURE__ */function (i) {\n    return {\n      _needRecalc: !0,\n      reset: function () {\n        this._needRecalc = !0;\n      },\n      _isRecalcNeeded: function () {\n        return !this._isGroupSort() && this._needRecalc;\n      },\n      _isGroupSort: function () {\n        return !!i.getState().group_mode;\n      },\n      _getWBSCode: function (a) {\n        return a ? (this._isRecalcNeeded() && this._calcWBS(), a.$virtual ? \"\" : this._isGroupSort() ? a.$wbs || \"\" : (a.$wbs || (this.reset(), this._calcWBS()), a.$wbs)) : \"\";\n      },\n      _setWBSCode: function (a, r) {\n        a.$wbs = r;\n      },\n      getWBSCode: function (a) {\n        return this._getWBSCode(a);\n      },\n      getByWBSCode: function (a) {\n        let r = a.split(\".\"),\n          s = i.config.root_id;\n        for (let o = 0; o < r.length; o++) {\n          const l = i.getChildren(s);\n          let c = 1 * r[o] - 1;\n          if (!i.isTaskExists(l[c])) return null;\n          s = l[c];\n        }\n        return i.isTaskExists(s) ? i.getTask(s) : null;\n      },\n      _calcWBS: function () {\n        if (!this._isRecalcNeeded()) return;\n        let a = !0;\n        i.eachTask(function (r) {\n          if (r.type == i.config.types.placeholder) return;\n          if (a) return a = !1, void this._setWBSCode(r, \"1\");\n          const s = this._getPrevNonPlaceholderSibling(r.id);\n          if (s !== null) this._increaseWBS(r, s);else {\n            let o = i.getParent(r.id);\n            this._setWBSCode(r, i.getTask(o).$wbs + \".1\");\n          }\n        }, i.config.root_id, this), this._needRecalc = !1;\n      },\n      _increaseWBS: function (a, r) {\n        let s = i.getTask(r).$wbs;\n        s && (s = s.split(\".\"), s[s.length - 1]++, this._setWBSCode(a, s.join(\".\")));\n      },\n      _getPrevNonPlaceholderSibling: function (a) {\n        let r,\n          s = a;\n        do r = i.getPrevSibling(s), s = r; while (r !== null && i.getTask(r).type == i.config.types.placeholder);\n        return r;\n      }\n    };\n  }(t);\n  function n() {\n    return e.reset(), !0;\n  }\n  t.getWBSCode = function (i) {\n    return e.getWBSCode(i);\n  }, t.getTaskByWBSCode = function (i) {\n    return e.getByWBSCode(i);\n  }, t.attachEvent(\"onAfterTaskMove\", n), t.attachEvent(\"onBeforeParse\", n), t.attachEvent(\"onAfterTaskDelete\", n), t.attachEvent(\"onAfterTaskAdd\", n), t.attachEvent(\"onAfterSort\", n);\n}\nfunction oi(t) {\n  var e = {},\n    n = !1;\n  t.$data.tasksStore.attachEvent(\"onStoreUpdated\", function () {\n    e = {}, n = !1;\n  }), t.attachEvent(\"onBeforeGanttRender\", function () {\n    e = {};\n  });\n  var i = String(Math.random());\n  function a(l) {\n    return l === null ? i + String(l) : String(l);\n  }\n  function r(l, c, d) {\n    return Array.isArray(l) ? l.map(function (u) {\n      return a(u);\n    }).join(\"_\") + `_${c}_${d}` : a(l) + `_${c}_${d}`;\n  }\n  function s(l, c, d) {\n    var u,\n      h = r(c, l, JSON.stringify(d)),\n      _ = {};\n    return kt(c, function (p) {\n      _[a(p)] = !0;\n    }), e[h] ? u = e[h] : (u = e[h] = [], t.eachTask(function (p) {\n      if (d) {\n        if (!d[t.getTaskType(p)]) return;\n      } else if (p.type == t.config.types.project) return;\n      l in p && kt(fe(p[l]) ? p[l] : [p[l]], function (y) {\n        var k = y && y.resource_id ? y.resource_id : y;\n        if (_[a(k)]) u.push(p);else if (!n) {\n          var b = r(y, l);\n          e[b] || (e[b] = []), e[b].push(p);\n        }\n      });\n    }), n = !0), u;\n  }\n  function o(l, c, d) {\n    var u = t.config.resource_property,\n      h = [];\n    if (t.getDatastore(\"task\").exists(c)) {\n      var _ = t.getTask(c);\n      h = _[u] || [];\n    }\n    Array.isArray(h) || (h = [h]);\n    for (var p = 0; p < h.length; p++) h[p].resource_id == l && d.push({\n      task_id: _.id,\n      resource_id: h[p].resource_id,\n      value: h[p].value\n    });\n  }\n  return {\n    getTaskBy: function (l, c, d) {\n      return typeof l == \"function\" ? (u = l, h = [], t.eachTask(function (_) {\n        u(_) && h.push(_);\n      }), h) : fe(c) ? s(l, c, d) : s(l, [c], d);\n      var u, h;\n    },\n    getResourceAssignments: function (l, c) {\n      var d = [],\n        u = t.config.resource_property;\n      return c !== void 0 ? o(l, c, d) : t.getTaskBy(u, l).forEach(function (h) {\n        o(l, h.id, d);\n      }), d;\n    }\n  };\n}\nfunction li(t) {\n  var e = oi(t);\n  t.ext.resources = /* @__PURE__ */function (a) {\n    const r = {\n      renderEditableLabel: function (s, o, l, c, d) {\n        const u = a.config.readonly ? \"\" : \"contenteditable\";\n        if (s < l.end_date && o > l.start_date) {\n          for (let h = 0; h < d.length; h++) {\n            const _ = d[h];\n            return \"<div \" + u + \" data-assignment-cell data-assignment-id='\" + _.id + \"' data-row-id='\" + l.id + \"' data-task='\" + l.$task_id + \"' data-start-date='\" + a.templates.format_date(s) + \"' data-end-date='\" + a.templates.format_date(o) + \"'>\" + _.value + \"</div>\";\n          }\n          return \"<div \" + u + \" data-assignment-cell data-empty  data-row-id='\" + l.id + \"' data-resource-id='\" + l.$resource_id + \"' data-task='\" + l.$task_id + \"' data-start-date='\" + a.templates.format_date(s) + \"''  data-end-date='\" + a.templates.format_date(o) + \"'>-</div>\";\n        }\n        return \"\";\n      },\n      renderSummaryLabel: function (s, o, l, c, d) {\n        let u = d.reduce(function (h, _) {\n          return h + Number(_.value);\n        }, 0);\n        return u % 1 && (u = Math.round(10 * u) / 10), u ? \"<div>\" + u + \"</div>\" : \"\";\n      },\n      editableResourceCellTemplate: function (s, o, l, c, d) {\n        return l.$role === \"task\" ? r.renderEditableLabel(s, o, l, c, d) : r.renderSummaryLabel(s, o, l, c, d);\n      },\n      editableResourceCellClass: function (s, o, l, c, d) {\n        const u = [];\n        u.push(\"resource_marker\"), l.$role === \"task\" ? u.push(\"task_cell\") : u.push(\"resource_cell\");\n        const h = d.reduce(function (p, y) {\n          return p + Number(y.value);\n        }, 0);\n        let _ = Number(l.capacity);\n        return isNaN(_) && (_ = 8), h <= _ ? u.push(\"workday_ok\") : u.push(\"workday_over\"), u.join(\" \");\n      },\n      getSummaryResourceAssignments: function (s) {\n        let o;\n        const l = a.getDatastore(a.config.resource_store),\n          c = l.getItem(s);\n        return c.$role === \"task\" ? o = a.getResourceAssignments(c.$resource_id, c.$task_id) : (o = a.getResourceAssignments(s), l.eachItem && l.eachItem(function (d) {\n          d.$role !== \"task\" && (o = o.concat(a.getResourceAssignments(d.id)));\n        }, s)), o;\n      },\n      initEditableDiagram: function () {\n        a.config.resource_render_empty_cells = !0, function () {\n          let l = null;\n          function c() {\n            return l && cancelAnimationFrame(l), l = requestAnimationFrame(function () {\n              a.$container && Array.prototype.slice.call(a.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\")).forEach(function (d) {\n                d.contentEditable = !0;\n              });\n            }), !0;\n          }\n          a.attachEvent(\"onGanttReady\", function () {\n            a.getDatastore(a.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", c), a.getDatastore(a.config.resource_store).attachEvent(\"onStoreUpdated\", c);\n          }, {\n            once: !0\n          }), a.attachEvent(\"onGanttLayoutReady\", function () {\n            a.$layout.getCellsByType(\"viewCell\").forEach(function (d) {\n              d.$config && d.$config.view === \"resourceTimeline\" && d.$content && d.$content.attachEvent(\"onScroll\", c);\n            });\n          });\n        }();\n        let s = null;\n        function o() {\n          setTimeout(function () {\n            const l = Lt(a.$container);\n            s > -1 && l[s + 1].focus();\n          }, 300);\n        }\n        a.attachEvent(\"onGanttReady\", function () {\n          let l = !1;\n          a.event(a.$container, \"keypress\", function (c) {\n            var d = c.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n            d && (c.keyCode !== 13 && c.keyCode !== 27 || d.blur());\n          }), a.event(a.$container, \"keydown\", function (c) {\n            c.key === \"Tab\" && (s = Lt(a.$container).indexOf(document.activeElement));\n          }), a.event(a.$container, \"focusout\", function (c) {\n            if (!l) {\n              l = !0, setTimeout(function () {\n                l = !1;\n              }, 300);\n              var d = c.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n              if (d) {\n                var u = (d.innerText || \"\").trim();\n                u == \"-\" && (u = \"0\");\n                var h = Number(u),\n                  _ = d.getAttribute(\"data-row-id\"),\n                  p = d.getAttribute(\"data-assignment-id\"),\n                  y = d.getAttribute(\"data-task\"),\n                  k = d.getAttribute(\"data-resource-id\"),\n                  b = a.templates.parse_date(d.getAttribute(\"data-start-date\")),\n                  g = a.templates.parse_date(d.getAttribute(\"data-end-date\")),\n                  m = a.getDatastore(a.config.resource_assignment_store);\n                if (isNaN(h)) a.getDatastore(a.config.resource_store).refresh(_);else {\n                  var f = a.getTask(y);\n                  if (a.plugins().undo && a.ext.undo.saveState(y, \"task\"), p) {\n                    if (h === (x = m.getItem(p)).value) return;\n                    if (x.start_date.valueOf() === b.valueOf() && x.end_date.valueOf() === g.valueOf()) x.value = h, h ? m.updateItem(x.id) : m.removeItem(x.id);else {\n                      if (x.end_date.valueOf() > g.valueOf()) {\n                        var v = a.copy(x);\n                        v.id = a.uid(), v.start_date = g, v.duration = a.calculateDuration({\n                          start_date: v.start_date,\n                          end_date: v.end_date,\n                          task: f\n                        }), v.delay = a.calculateDuration({\n                          start_date: f.start_date,\n                          end_date: v.start_date,\n                          task: f\n                        }), v.mode = x.mode || \"default\", v.duration !== 0 && m.addItem(v);\n                      }\n                      x.start_date.valueOf() < b.valueOf() ? (x.end_date = b, x.duration = a.calculateDuration({\n                        start_date: x.start_date,\n                        end_date: x.end_date,\n                        task: f\n                      }), x.mode = \"fixedDuration\", x.duration === 0 ? m.removeItem(x.id) : m.updateItem(x.id)) : m.removeItem(x.id), h && m.addItem({\n                        task_id: x.task_id,\n                        resource_id: x.resource_id,\n                        value: h,\n                        start_date: b,\n                        end_date: g,\n                        duration: a.calculateDuration({\n                          start_date: b,\n                          end_date: g,\n                          task: f\n                        }),\n                        delay: a.calculateDuration({\n                          start_date: f.start_date,\n                          end_date: b,\n                          task: f\n                        }),\n                        mode: \"fixedDuration\"\n                      });\n                    }\n                    a.updateTaskAssignments(f.id), a.updateTask(f.id), o();\n                  } else if (h) {\n                    var x = {\n                      task_id: y,\n                      resource_id: k,\n                      value: h,\n                      start_date: b,\n                      end_date: g,\n                      duration: a.calculateDuration({\n                        start_date: b,\n                        end_date: g,\n                        task: f\n                      }),\n                      delay: a.calculateDuration({\n                        start_date: f.start_date,\n                        end_date: b,\n                        task: f\n                      }),\n                      mode: \"fixedDuration\"\n                    };\n                    m.addItem(x), a.updateTaskAssignments(f.id), a.updateTask(f.id), o();\n                  }\n                }\n              }\n            }\n          });\n        }, {\n          once: !0\n        });\n      }\n    };\n    return r;\n  }(t), t.config.resources = {\n    dataprocessor_assignments: !1,\n    dataprocessor_resources: !1,\n    editable_resource_diagram: !1,\n    resource_store: {\n      type: \"treeDataStore\",\n      fetchTasks: !1,\n      initItem: function (a) {\n        return a.parent = a.parent || t.config.root_id, a[t.config.resource_property] = a.parent, a.open = !0, a;\n      }\n    },\n    lightbox_resources: function (a) {\n      const r = [],\n        s = t.getDatastore(t.config.resource_store);\n      return a.forEach(function (o) {\n        if (!s.hasChild(o.id)) {\n          const l = t.copy(o);\n          l.key = o.id, l.label = o.text, r.push(l);\n        }\n      }), r;\n    }\n  }, t.attachEvent(\"onBeforeGanttReady\", function () {\n    if (t.getDatastore(t.config.resource_store)) return;\n    const a = t.config.resources ? t.config.resources.resource_store : void 0;\n    let r = a ? a.fetchTasks : void 0;\n    t.config.resources && t.config.resources.editable_resource_diagram && (r = !0);\n    let s = function (l) {\n      return l.parent = l.parent || t.config.root_id, l[t.config.resource_property] = l.parent, l.open = !0, l;\n    };\n    a && a.initItem && (s = a.initItem);\n    const o = a && a.type ? a.type : \"treeDatastore\";\n    t.$resourcesStore = t.createDatastore({\n      name: t.config.resource_store,\n      type: o,\n      fetchTasks: r !== void 0 && r,\n      initItem: s\n    }), t.$data.resourcesStore = t.$resourcesStore, t.$resourcesStore.attachEvent(\"onParse\", function () {\n      let l,\n        c = function (d) {\n          const u = [];\n          return d.forEach(function (h) {\n            const _ = t.copy(h);\n            _.key = h.id, _.label = h.text, u.push(_);\n          }), u;\n        };\n      t.config.resources && t.config.resources.lightbox_resources && (c = t.config.resources.lightbox_resources), t.config.resources && t.config.resources.editable_resource_diagram ? l = c(t.$resourcesStore.getItems().filter(d => {\n        let u = t.getResourceAssignments(d.id);\n        if (!t.$resourcesStore.hasChild(d.id) || u && u.length) return !d.$resource_id || !d.$task_id;\n      })) : l = c(t.$resourcesStore.getItems()), t.updateCollection(\"resourceOptions\", l);\n    });\n  }), t.getTaskBy = e.getTaskBy, t.getResourceAssignments = e.getResourceAssignments, t.config.resource_property = \"owner_id\", t.config.resource_store = \"resource\", t.config.resource_render_empty_cells = !1, t.templates.histogram_cell_class = function (a, r, s, o, l) {}, t.templates.histogram_cell_label = function (a, r, s, o, l) {\n    return o.length + \"/3\";\n  }, t.templates.histogram_cell_allocated = function (a, r, s, o, l) {\n    return o.length / 3;\n  }, t.templates.histogram_cell_capacity = function (a, r, s, o, l) {\n    return 0;\n  };\n  const n = function (a, r, s, o, l) {\n      return o.length <= 1 ? \"gantt_resource_marker_ok\" : \"gantt_resource_marker_overtime\";\n    },\n    i = function (a, r, s, o, l) {\n      return 8 * o.length;\n    };\n  t.templates.resource_cell_value = i, t.templates.resource_cell_class = n, t.attachEvent(\"onBeforeGanttReady\", function () {\n    t.config.resources && t.config.resources.editable_resource_diagram && (t.config.resource_render_empty_cells = !0, t.templates.resource_cell_value === i && (t.templates.resource_cell_value = t.ext.resources.editableResourceCellTemplate), t.templates.resource_cell_class === n && (t.templates.resource_cell_class = t.ext.resources.editableResourceCellClass), t.ext.resources.initEditableDiagram(t));\n  });\n}\nfunction di(t) {\n  var e = \"$resourceAssignments\";\n  t.config.resource_assignment_store = \"resourceAssignments\", t.config.process_resource_assignments = !0;\n  var n = \"auto\",\n    i = \"singleValue\",\n    a = \"valueArray\",\n    r = \"resourceValueArray\",\n    s = \"assignmentsArray\",\n    o = n,\n    l = \"fixedDates\",\n    c = \"fixedDuration\",\n    d = \"default\";\n  function u(f, v) {\n    f.start_date ? f.start_date = t.date.parseDate(f.start_date, \"parse_date\") : f.start_date = null, f.end_date ? f.end_date = t.date.parseDate(f.end_date, \"parse_date\") : f.end_date = null;\n    var x = Number(f.delay),\n      $ = !1;\n    if (isNaN(x) ? (f.delay = 0, $ = !0) : f.delay = x, t.defined(f.value) || (f.value = null), !f.task_id || !f.resource_id) return !1;\n    if (f.mode = f.mode || d, f.mode === c && (isNaN(Number(f.duration)) && (v = v || t.getTask(f.task_id), f.duration = t.calculateDuration({\n      start_date: f.start_date,\n      end_date: f.end_date,\n      id: v\n    })), $ && (v = v || t.getTask(f.task_id), f.delay = t.calculateDuration({\n      start_date: v.start_date,\n      end_date: f.start_date,\n      id: v\n    }))), f.mode !== l && (v || t.isTaskExists(f.task_id))) {\n      var w = _(f, v = v || t.getTask(f.task_id));\n      f.start_date = w.start_date, f.end_date = w.end_date, f.duration = w.duration;\n    }\n  }\n  var h = t.createDatastore({\n    name: t.config.resource_assignment_store,\n    initItem: function (f) {\n      return f.id || (f.id = t.uid()), u(f), f;\n    }\n  });\n  function _(f, v) {\n    if (f.mode === l) return {\n      start_date: f.start_date,\n      end_date: f.end_date,\n      duration: f.duration\n    };\n    var x,\n      $,\n      w = f.delay ? t.calculateEndDate({\n        start_date: v.start_date,\n        duration: f.delay,\n        task: v\n      }) : new Date(v.start_date);\n    return f.mode === c ? (x = t.calculateEndDate({\n      start_date: w,\n      duration: f.duration,\n      task: v\n    }), $ = f.duration) : (x = new Date(v.end_date), $ = v.duration - f.delay), {\n      start_date: w,\n      end_date: x,\n      duration: $\n    };\n  }\n  function p(f) {\n    const v = t.config.resource_property;\n    let x = f[v];\n    const $ = [];\n    let w = o === n;\n    if (t.defined(x) && x) {\n      Array.isArray(x) || (x = [x], w && (o = i, w = !1));\n      const S = {};\n      x.forEach(function (T) {\n        T.resource_id || (T = {\n          resource_id: T\n        }, w && (o = a, w = !1)), w && (T.id && T.resource_id ? (o = s, w = !1) : (o = r, w = !1));\n        let E,\n          C = d;\n        T.mode || (T.start_date && T.end_date || T.start_date && T.duration) && (C = c), E = T.id || !T.$id || S[T.$id] ? T.id && !S[T.id] ? T.id : t.uid() : T.$id, S[E] = !0;\n        const D = {\n          id: E,\n          start_date: T.start_date,\n          duration: T.duration,\n          end_date: T.end_date,\n          delay: T.delay,\n          task_id: f.id,\n          resource_id: T.resource_id,\n          value: T.value,\n          mode: T.mode || C\n        };\n        Object.keys(T).forEach(M => {\n          M != \"$id\" && (D[M] = T[M]);\n        }), D.start_date && D.start_date.getMonth && D.end_date && D.end_date.getMonth && typeof D.duration == \"number\" || u(D, f), $.push(D);\n      });\n    }\n    return $;\n  }\n  function y(f) {\n    if (t.isTaskExists(f)) {\n      var v = t.getTask(f);\n      k(v, t.getTaskAssignments(v.id));\n    }\n  }\n  function k(f, v) {\n    v.sort(function (x, $) {\n      return x.start_date && $.start_date && x.start_date.valueOf() != $.start_date.valueOf() ? x.start_date - $.start_date : 0;\n    }), o == s ? f[t.config.resource_property] = v : o == r && (f[t.config.resource_property] = v.map(function (x) {\n      return {\n        $id: x.id,\n        start_date: x.start_date,\n        duration: x.duration,\n        end_date: x.end_date,\n        delay: x.delay,\n        resource_id: x.resource_id,\n        value: x.value,\n        mode: x.mode\n      };\n    })), f[e] = v;\n  }\n  function b(f) {\n    var v = p(f);\n    return v.forEach(function (x) {\n      x.id = x.id || t.uid();\n    }), v;\n  }\n  function g(f, v) {\n    var x = function ($, w) {\n      var S = {\n        inBoth: [],\n        inTaskNotInStore: [],\n        inStoreNotInTask: []\n      };\n      if (o == i) {\n        var T = $[0],\n          E = T ? T.resource_id : null,\n          C = !1;\n        w.forEach(function (A) {\n          A.resource_id != E ? S.inStoreNotInTask.push(A) : A.resource_id == E && (S.inBoth.push({\n            store: A,\n            task: T\n          }), C = !0);\n        }), !C && T && S.inTaskNotInStore.push(T);\n      } else if (o == a) {\n        var D = {},\n          M = {},\n          I = {};\n        $.forEach(function (A) {\n          D[A.resource_id] = A;\n        }), w.forEach(function (A) {\n          M[A.resource_id] = A;\n        }), $.concat(w).forEach(function (A) {\n          if (!I[A.resource_id]) {\n            I[A.resource_id] = !0;\n            var N = D[A.resource_id],\n              L = M[A.resource_id];\n            N && L ? S.inBoth.push({\n              store: L,\n              task: N\n            }) : N && !L ? S.inTaskNotInStore.push(N) : !N && L && S.inStoreNotInTask.push(L);\n          }\n        });\n      } else o != s && o != r || (D = {}, M = {}, I = {}, $.forEach(function (A) {\n        D[A.id || A.$id] = A;\n      }), w.forEach(function (A) {\n        M[A.id] = A;\n      }), $.concat(w).forEach(function (A) {\n        var N = A.id || A.$id;\n        if (!I[N]) {\n          I[N] = !0;\n          var L = D[N],\n            O = M[N];\n          L && O ? S.inBoth.push({\n            store: O,\n            task: L\n          }) : L && !O ? S.inTaskNotInStore.push(L) : !L && O && S.inStoreNotInTask.push(O);\n        }\n      }));\n      return S;\n    }(p(f), v);\n    x.inStoreNotInTask.forEach(function ($) {\n      h.removeItem($.id);\n    }), x.inTaskNotInStore.forEach(function ($) {\n      h.addItem($);\n    }), x.inBoth.forEach(function ($) {\n      if (function (S, T) {\n        var E = {\n          id: !0\n        };\n        for (var C in S) if (!E[C] && String(S[C]) !== String(T[C])) return !0;\n        return !1;\n      }($.task, $.store)) (function (S, T) {\n        var E = {\n          id: !0\n        };\n        for (var C in S) E[C] || (T[C] = S[C]);\n      })($.task, $.store), h.updateItem($.store.id);else if ($.task.start_date && $.task.end_date && $.task.mode !== l) {\n        var w = _($.store, f);\n        $.store.start_date.valueOf() == w.start_date.valueOf() && $.store.end_date.valueOf() == w.end_date.valueOf() || ($.store.start_date = w.start_date, $.store.end_date = w.end_date, $.store.duration = w.duration, h.updateItem($.store.id));\n      }\n    }), y(f.id);\n  }\n  function m(f) {\n    var v = f[e] || h.find(function (x) {\n      return x.task_id == f.id;\n    });\n    g(f, v);\n  }\n  t.$data.assignmentsStore = h, t.attachEvent(\"onGanttReady\", function () {\n    if (t.config.process_resource_assignments) {\n      t.attachEvent(\"onParse\", function () {\n        t.silent(function () {\n          h.clearAll();\n          var E = [];\n          t.eachTask(function (C) {\n            if (C.type !== t.config.types.project) {\n              var D = b(C);\n              k(C, D), D.forEach(function (M) {\n                E.push(M);\n              });\n            }\n          }), h.parse(E);\n        });\n      });\n      var f = !1,\n        v = !1,\n        x = {},\n        $ = !1;\n      t.attachEvent(\"onBeforeBatchUpdate\", function () {\n        f = !0;\n      }), t.attachEvent(\"onAfterBatchUpdate\", function () {\n        if (v) {\n          var E = {};\n          for (var C in x) E[C] = t.getTaskAssignments(x[C].id);\n          for (var C in t.config.process_resource_assignments && o === \"resourceValueArray\" && (T = null), x) g(x[C], E[C]);\n        }\n        v = !1, f = !1, x = {};\n      }), t.attachEvent(\"onTaskCreated\", function (E) {\n        var C = b(E);\n        return h.parse(C), k(E, C), !0;\n      }), t.attachEvent(\"onAfterTaskUpdate\", function (E, C) {\n        f ? (v = !0, x[E] = C) : C.unscheduled || m(C);\n      }), t.attachEvent(\"onAfterTaskAdd\", function (E, C) {\n        f ? (v = !0, x[E] = C) : m(C);\n      }), t.attachEvent(\"onRowDragEnd\", function (E) {\n        m(t.getTask(E));\n      }), t.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (E, C) {\n        var D,\n          M = [E];\n        t.eachTask(function (I) {\n          M.push(I.id);\n        }, E), D = {}, M.forEach(function (I) {\n          D[I] = !0;\n        }), h.find(function (I) {\n          return D[I.task_id];\n        }).forEach(function (I) {\n          h.removeItem(I.id);\n        });\n      }), t.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n        return w = null, S = null, T = null, h.clearAll(), !0;\n      }), t.attachEvent(\"onTaskIdChange\", function (E, C) {\n        h.find(function (D) {\n          return D.task_id == E;\n        }).forEach(function (D) {\n          D.task_id = C, h.updateItem(D.id);\n        }), y(C);\n      }), t.attachEvent(\"onBeforeUndo\", function (E) {\n        return $ = !0, !0;\n      }), t.attachEvent(\"onAfterUndo\", function (E) {\n        $ = !0;\n      });\n      var w = null,\n        S = null,\n        T = null;\n      h.attachEvent(\"onStoreUpdated\", function () {\n        return f && !$ || (w = null, S = null, T = null), !0;\n      }), t.getResourceAssignments = function (E, C) {\n        var D = t.defined(C) && C !== null;\n        return w === null && (w = {}, S = {}, h.eachItem(function (M) {\n          w[M.resource_id] || (w[M.resource_id] = []), w[M.resource_id].push(M);\n          var I = M.resource_id + \"-\" + M.task_id;\n          S[I] || (S[I] = []), S[I].push(M);\n        })), D ? (S[E + \"-\" + C] || []).slice() : (w[E] || []).slice();\n      }, t.getTaskAssignments = function (E) {\n        if (T === null) {\n          var C = [];\n          T = {}, h.eachItem(function (D) {\n            T[D.task_id] || (T[D.task_id] = []), T[D.task_id].push(D), D.task_id == E && C.push(D);\n          });\n        }\n        return (T[E] || []).slice();\n      }, t.getTaskResources = function (E) {\n        const C = t.getDatastore(\"resource\"),\n          D = t.getTaskAssignments(E),\n          M = {};\n        D.forEach(function (A) {\n          M[A.resource_id] || (M[A.resource_id] = A.resource_id);\n        });\n        const I = [];\n        for (const A in M) {\n          const N = C.getItem(M[A]);\n          N && I.push(N);\n        }\n        return I;\n      }, t.updateTaskAssignments = y;\n    }\n  }, {\n    once: !0\n  });\n}\nfunction ci(t) {\n  function e(o) {\n    return function () {\n      return !t.config.placeholder_task || o.apply(this, arguments);\n    };\n  }\n  function n() {\n    var o = t.getTaskBy(\"type\", t.config.types.placeholder);\n    if (!o.length || !t.isTaskExists(o[0].id)) {\n      var l = {\n        unscheduled: !0,\n        type: t.config.types.placeholder,\n        duration: 0,\n        text: t.locale.labels.new_task\n      };\n      if (t.callEvent(\"onTaskCreated\", [l]) === !1) return;\n      t.addTask(l);\n    }\n  }\n  function i(o) {\n    var l = t.getTask(o);\n    l.type == t.config.types.placeholder && (l.start_date && l.end_date && l.unscheduled && (l.unscheduled = !1), t.batchUpdate(function () {\n      var c = t.copy(l);\n      t.silent(function () {\n        t.deleteTask(l.id);\n      }), delete c[\"!nativeeditor_status\"], c.type = t.config.types.task, c.id = t.uid(), t.addTask(c);\n    }));\n  }\n  t.config.types.placeholder = \"placeholder\", t.attachEvent(\"onDataProcessorReady\", e(function (o) {\n    o && !o._silencedPlaceholder && (o._silencedPlaceholder = !0, o.attachEvent(\"onBeforeUpdate\", e(function (l, c, d) {\n      return d.type != t.config.types.placeholder || (o.setUpdated(l, !1), !1);\n    })));\n  }));\n  var a = !1;\n  function r(o) {\n    return !!(t.config.types.placeholder && t.isTaskExists(o) && t.getTask(o).type == t.config.types.placeholder);\n  }\n  function s(o) {\n    return !(!r(o.source) && !r(o.target));\n  }\n  t.attachEvent(\"onGanttReady\", function () {\n    a || (a = !0, t.attachEvent(\"onAfterTaskUpdate\", e(i)), t.attachEvent(\"onAfterTaskAdd\", e(function (o, l) {\n      l.type != t.config.types.placeholder && (t.getTaskBy(\"type\", t.config.types.placeholder).forEach(function (c) {\n        t.silent(function () {\n          t.isTaskExists(c.id) && t.deleteTask(c.id);\n        });\n      }), n());\n    })), t.attachEvent(\"onParse\", e(n)));\n  }), t.attachEvent(\"onLinkValidation\", function (o) {\n    return !s(o);\n  }), t.attachEvent(\"onBeforeLinkAdd\", function (o, l) {\n    return !s(l);\n  }), t.attachEvent(\"onBeforeUndoStack\", function (o) {\n    for (var l = 0; l < o.commands.length; l++) {\n      var c = o.commands[l];\n      c.entity === \"task\" && c.value.type === t.config.types.placeholder && (o.commands.splice(l, 1), l--);\n    }\n    return !0;\n  });\n}\nfunction ui(t) {\n  function e(d) {\n    return function () {\n      return !t.config.auto_types || t.getTaskType(t.config.types.project) != t.config.types.project || d.apply(this, arguments);\n    };\n  }\n  function n(d, u) {\n    var h = t.getTask(d),\n      _ = r(h);\n    _ !== !1 && t.getTaskType(h) !== _ && (u.$needsUpdate = !0, u[h.id] = {\n      task: h,\n      type: _\n    });\n  }\n  function i(d) {\n    if (!t.getState().group_mode) {\n      var u = function (h, _) {\n        return n(h, _ = _ || {}), t.eachParent(function (p) {\n          n(p.id, _);\n        }, h), _;\n      }(d);\n      u.$needsUpdate && t.batchUpdate(function () {\n        (function (h) {\n          for (var _ in h) if (h[_] && h[_].task) {\n            var p = h[_].task;\n            p.type = h[_].type, t.updateTask(p.id);\n          }\n        })(u);\n      });\n    }\n  }\n  var a;\n  function r(d) {\n    var u = t.config.types,\n      h = t.hasChild(d.id),\n      _ = t.getTaskType(d.type);\n    return h && _ === u.task ? u.project : !h && _ === u.project && u.task;\n  }\n  var s,\n    o,\n    l = !0;\n  function c(d) {\n    d != t.config.root_id && t.isTaskExists(d) && i(d);\n  }\n  t.attachEvent(\"onParse\", e(function () {\n    l = !1, t.getState().group_mode || (t.batchUpdate(function () {\n      t.eachTask(function (d) {\n        var u = r(d);\n        u !== !1 && function (h, _) {\n          t.getState().group_mode || (h.type = _, t.updateTask(h.id));\n        }(d, u);\n      });\n    }), l = !0);\n  })), t.attachEvent(\"onAfterTaskAdd\", e(function (d) {\n    l && i(d);\n  })), t.attachEvent(\"onAfterTaskUpdate\", e(function (d) {\n    l && i(d);\n  })), t.attachEvent(\"onBeforeTaskDelete\", e(function (d, u) {\n    return a = t.getParent(d), !0;\n  })), t.attachEvent(\"onAfterTaskDelete\", e(function (d, u) {\n    c(a);\n  })), t.attachEvent(\"onRowDragStart\", e(function (d, u, h) {\n    return s = t.getParent(d), !0;\n  })), t.attachEvent(\"onRowDragEnd\", e(function (d, u) {\n    c(s), i(d);\n  })), t.attachEvent(\"onBeforeTaskMove\", e(function (d, u, h) {\n    return o = t.getParent(d), !0;\n  })), t.attachEvent(\"onAfterTaskMove\", e(function (d, u, h) {\n    document.querySelector(\".gantt_drag_marker\") || (c(o), i(d));\n  }));\n}\nconst Zt = class Zt {\n  constructor() {\n    this.canParse = e => !isNaN(this.parse(e)), this.format = e => String(e), this.parse = e => parseInt(e, 10);\n  }\n};\nZt.create = (e = null) => new Zt();\nlet Pt = Zt;\nconst Qt = class Qt {\n  constructor(e) {\n    this.format = n => this._getWBSCode(n.source), this.canParse = n => this._linkReg.test(n), this.parse = n => {\n      if (!this.canParse(n)) return null;\n      const i = this._linkReg.exec(n)[0].trim();\n      return {\n        id: void 0,\n        source: this._findSource(i) || null,\n        target: null,\n        type: this._gantt.config.links.finish_to_start,\n        lag: 0\n      };\n    }, this._getWBSCode = n => {\n      const i = this._gantt.getTask(n);\n      return this._gantt.getWBSCode(i);\n    }, this._findSource = n => {\n      const i = new RegExp(\"^[0-9.]+\", \"i\");\n      if (i.exec(n)) {\n        const a = i.exec(n)[0],\n          r = this._gantt.getTaskByWBSCode(a);\n        if (r) return r.id;\n      }\n      return null;\n    }, this._linkReg = /^[0-9\\.]+/, this._gantt = e;\n  }\n};\nQt.create = (e = null, n) => new Qt(n);\nlet ke = Qt;\nfunction hi(t) {\n  t.ext.formatters = {\n    durationFormatter: function (e) {\n      return e || (e = {}), e.store || (e.store = t.config.duration_unit), e.enter || (e.enter = t.config.duration_unit), Pt.create(e, t);\n    },\n    linkFormatter: function (e) {\n      return ke.create(e, t);\n    }\n  };\n}\nfunction _i(t) {\n  t.ext = t.ext || {}, t.config.show_empty_state = !1, t.ext.emptyStateElement = t.ext.emptyStateElement || {\n    isEnabled: () => t.config.show_empty_state === !0,\n    isGanttEmpty: () => !t.getTaskByTime().length,\n    renderContent(e) {\n      const n = `<div class='gantt_empty_state'><div class='gantt_empty_state_image'></div>${`<div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${t.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${t.locale.labels.empty_state_text_description}</div>\n    </div>`}</div>`;\n      e.innerHTML = n;\n    },\n    clickEvents: [],\n    attachAddTaskEvent() {\n      const e = t.attachEvent(\"onEmptyClick\", function (n) {\n        t.utils.dom.closest(n.target, \"[data-empty-state-create-task]\") && t.createTask({\n          id: t.uid(),\n          text: \"New Task\"\n        });\n      });\n      this.clickEvents.push(e);\n    },\n    detachAddTaskEvents() {\n      this.clickEvents.forEach(function (e) {\n        t.detachEvent(e);\n      }), this.clickEvents = [];\n    },\n    getContainer() {\n      if (t.$container) {\n        const e = t.utils.dom;\n        if (t.$container.contains(t.$grid_data)) return e.closest(t.$grid_data, \".gantt_layout_content\");\n        if (t.$container.contains(t.$task_data)) return e.closest(t.$task_data, \".gantt_layout_content\");\n      }\n      return null;\n    },\n    getNode() {\n      const e = this.getContainer();\n      return e ? e.querySelector(\".gantt_empty_state_wrapper\") : null;\n    },\n    show() {\n      const e = this.getContainer();\n      if (!e && this.isGanttEmpty()) return null;\n      const n = document.createElement(\"div\");\n      n.className = \"gantt_empty_state_wrapper\", n.style.marginTop = t.config.scale_height - e.offsetHeight + \"px\";\n      const i = t.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\n      Array.prototype.forEach.call(i, function (a) {\n        a.parentNode.removeChild(a);\n      }), this.detachAddTaskEvents(), this.attachAddTaskEvent(), e.appendChild(n), this.renderContent(n);\n    },\n    hide() {\n      const e = this.getNode();\n      if (!e) return !1;\n      e.parentNode.removeChild(e);\n    },\n    init() {}\n  }, t.attachEvent(\"onDataRender\", function () {\n    const e = t.ext.emptyStateElement;\n    e.isEnabled() && e.isGanttEmpty() ? e.show() : e.hide();\n  });\n}\nconst hn = function (t, e) {\n    const n = e.baselines && e.baselines.length,\n      i = t.config.baselines.render_mode == \"separateRow\" || t.config.baselines.render_mode == \"individualRow\";\n    if (n && i) return !0;\n  },\n  $t = function (t) {\n    return t.render && t.render == \"split\" && !t.$open;\n  };\nfunction gi(t) {\n  t.config.baselines = {\n    datastore: \"baselines\",\n    render_mode: !1,\n    dataprocessor_baselines: !1,\n    row_height: 16,\n    bar_height: 8\n  };\n  const e = t.createDatastore({\n    name: t.config.baselines.datastore,\n    initItem: function (a) {\n      return a.id || (a.id = t.uid()), function (r) {\n        if (!r.task_id || !r.start_date && !r.end_date) return !1;\n        r.start_date ? r.start_date = t.date.parseDate(r.start_date, \"parse_date\") : r.start_date = null, r.end_date ? r.end_date = t.date.parseDate(r.end_date, \"parse_date\") : r.end_date = null, r.duration = r.duration || 1, r.start_date && !r.end_date ? r.end_date = t.calculateEndDate(r.start_date, r.duration) : r.end_date && !r.start_date && (r.start_date = t.calculateEndDate(r.end_date, -r.duration));\n      }(a), a;\n    }\n  });\n  function n(a) {\n    let r = 0;\n    t.adjustTaskHeightForBaselines(a), t.eachTask(function (s) {\n      let o = s.row_height || t.config.row_height;\n      r = r || o, o > r && (r = o);\n    }, a.id), a.row_height < r && (a.row_height = r);\n  }\n  function i(a) {\n    t.eachParent(function (r) {\n      if ($t(r)) {\n        const s = r.row_height || t.getLayoutView(\"timeline\").getBarHeight(r.id);\n        let o = a.row_height;\n        t.getChildren(r.id).forEach(function (l) {\n          const c = t.getTask(l);\n          if (c.id == a.id) return;\n          const d = c.row_height || t.getLayoutView(\"timeline\").getBarHeight(c.id);\n          o = o || d, d > o && (o = d);\n        }), r.row_height = o, r.bar_height = r.bar_height || s;\n      }\n    }, a.id);\n  }\n  t.$data.baselineStore = e, t.adjustTaskHeightForBaselines = function (a) {\n    let r,\n      s,\n      o = a.baselines && a.baselines.length || 0;\n    const l = t.config.baselines.row_height,\n      c = t.getLayoutView(\"timeline\");\n    if (c && t.config.show_chart) switch (t.config.baselines.render_mode) {\n      case \"taskRow\":\n      default:\n        a.row_height = a.bar_height + 8;\n        break;\n      case \"separateRow\":\n        r = c.getBarHeight(a.id), o ? (a.bar_height = a.bar_height || r, a.bar_height > r && (r = a.bar_height), a.row_height = r + l) : a.bar_height && (a.row_height = a.bar_height + 4), i(a);\n        break;\n      case \"individualRow\":\n        r = c.getBarHeight(a.id), o ? (a.bar_height = a.bar_height || r, a.bar_height > r && (r = a.bar_height), s = l * o, a.row_height = r + s + 2) : a.bar_height && (a.row_height = a.bar_height + 4), i(a);\n    }\n  }, t.attachEvent(\"onGanttReady\", function () {\n    t.config.baselines && (t.attachEvent(\"onParse\", function () {\n      e.eachItem(function (a) {\n        const r = a.task_id;\n        if (t.isTaskExists(r)) {\n          const s = t.getTask(r);\n          s.baselines = s.baselines || [];\n          let o = !0;\n          for (let l = 0; l < s.baselines.length; l++) {\n            let c = s.baselines[l];\n            if (c.id == a.id) {\n              o = !1, t.mixin(c, a, !0);\n              break;\n            }\n          }\n          o && s.baselines.push(a), F(t) || ($t(s) ? n(s) : t.adjustTaskHeightForBaselines(s));\n        }\n      });\n    }), t.attachEvent(\"onBeforeTaskUpdate\", function (a, r) {\n      return function (s) {\n        let o = !1;\n        const l = {},\n          c = s.baselines || [],\n          d = t.getTaskBaselines(s.id);\n        c.length != d.length && (o = !0), c.forEach(function (u) {\n          l[u.id] = !0;\n          const h = e.getItem(u.id);\n          if (h) {\n            const _ = +h.start_date != +u.start_date,\n              p = +h.end_date != +u.end_date;\n            (_ || p) && e.updateItem(u.id, u);\n          } else e.addItem(u);\n        }), d.forEach(function (u) {\n          l[u.id] || e.removeItem(u.id);\n        }), o && ($t(s) ? n(s) : t.adjustTaskHeightForBaselines(s), t.render());\n      }(r), !0;\n    }), t.attachEvent(\"onAfterUndo\", function (a) {\n      if ((t.config.baselines.render_mode == \"separateRow\" || t.config.baselines.render_mode == \"individualRow\") && a) {\n        let r = !1;\n        a.commands.forEach(function (s) {\n          if (s.entity == \"task\") {\n            const o = s.value.id;\n            if (t.isTaskExists(o)) {\n              const l = t.getTask(o);\n              if (l.parent && t.isTaskExists(l.parent)) {\n                const c = t.getTask(l.parent);\n                $t(c) && (n(c), r = !0);\n              }\n            }\n          }\n        }), r && t.render();\n      }\n    }), t.attachEvent(\"onAfterTaskDelete\", function (a, r) {\n      if (hn && r.parent && t.isTaskExists(r.parent)) {\n        const s = t.getTask(r.parent);\n        $t(s) && n(s);\n      }\n      e.eachItem(function (s) {\n        t.isTaskExists(s.task_id) || e.removeItem(s.id);\n      });\n    }), t.getTaskBaselines = function (a) {\n      const r = [];\n      return e.eachItem(function (s) {\n        s.task_id == a && r.push(s);\n      }), r;\n    }, t.$data.baselineStore.attachEvent(\"onClearAll\", function () {\n      return t.eachTask(function (a) {\n        a.baselines && delete a.baselines;\n      }), !0;\n    }), t.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n      return e.clearAll(), !0;\n    }), t.attachEvent(\"onTaskIdChange\", function (a, r) {\n      e.find(function (s) {\n        return s.task_id == a;\n      }).forEach(function (s) {\n        s.task_id = r, e.updateItem(s.id);\n      });\n    }));\n  }, {\n    once: !0\n  });\n}\nfunction fi(t) {\n  function e(n) {\n    throw t.assert(!1, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: \" + JSON.stringify(n)), new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \" + JSON.stringify(n));\n  }\n  t.load = function () {\n    throw new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\n  }, t.parse = function (n, i) {\n    this.on_load({\n      xmlDoc: {\n        responseText: n\n      }\n    }, i);\n  }, t.serialize = function (n) {\n    return this[n = n || \"json\"].serialize();\n  }, t.on_load = function (n, i) {\n    if (n.xmlDoc && n.xmlDoc.status === 404) this.assert(!1, \"Failed to load the data from <a href='\" + n.xmlDoc.responseURL + \"' target='_blank'>\" + n.xmlDoc.responseURL + \"</a>, server returns 404\");else if (!t.$destroyed) {\n      this.callEvent(\"onBeforeParse\", []), i || (i = \"json\"), this.assert(this[i], \"Invalid data type:'\" + i + \"'\");\n      var a = n.xmlDoc.responseText,\n        r = this[i].parse(a, n);\n      this._process_loading(r);\n    }\n  }, t._process_loading = function (n) {\n    n.collections && this._load_collections(n.collections), n.resources && this.$data.resourcesStore && this.$data.resourcesStore.parse(n.resources), t.config.baselines && n.baselines && this.$data.baselineStore && this.$data.baselineStore.parse(n.baselines);\n    const i = n.data || n.tasks;\n    n.assignments && function (r, s) {\n      const o = {};\n      s.forEach(l => {\n        o[l.task_id] || (o[l.task_id] = []), o[l.task_id].push(l);\n      }), r.forEach(l => {\n        l[t.config.resource_property] = o[l.id] || [];\n      });\n    }(i, n.assignments), this.$data.tasksStore.parse(i);\n    var a = n.links || (n.collections && n.collections.links ? n.collections.links : []);\n    this.$data.linksStore.parse(a), this.callEvent(\"onParse\", []), this.render();\n  }, t._load_collections = function (n) {\n    var i = !1;\n    for (var a in n) if (n.hasOwnProperty(a)) {\n      i = !0;\n      var r = n[a];\n      this.serverList[a] = this.serverList[a] || [];\n      var s = this.serverList[a];\n      if (!s) continue;\n      s.splice(0, s.length);\n      for (var o = 0; o < r.length; o++) {\n        var l = r[o],\n          c = this.copy(l);\n        for (var d in c.key = c.value, l) if (l.hasOwnProperty(d)) {\n          if (d == \"value\" || d == \"label\") continue;\n          c[d] = l[d];\n        }\n        s.push(c);\n      }\n    }\n    i && this.callEvent(\"onOptionsLoad\", []);\n  }, t.attachEvent(\"onBeforeTaskDisplay\", function (n, i) {\n    return !i.$ignore;\n  }), t.json = {\n    parse: function (n) {\n      if (n || e(n), typeof n == \"string\") if (typeof JSON != null) try {\n        n = JSON.parse(n);\n      } catch {\n        e(n);\n      } else t.assert(!1, \"JSON is not supported\");\n      return n.data || n.tasks || e(n), n.dhx_security && (t.security_key = n.dhx_security), n;\n    },\n    serializeTask: function (n) {\n      return this._copyObject(n);\n    },\n    serializeLink: function (n) {\n      return this._copyLink(n);\n    },\n    _copyLink: function (n) {\n      var i = {};\n      for (var a in n) i[a] = n[a];\n      return i;\n    },\n    _copyObject: function (n) {\n      var i = {};\n      for (var a in n) a.charAt(0) != \"$\" && (i[a] = n[a], Q(i[a]) && (i[a] = t.defined(t.templates.xml_format) ? t.templates.xml_format(i[a]) : t.templates.format_date(i[a])));\n      return i;\n    },\n    serialize: function () {\n      var n = [],\n        i = [];\n      let a = [];\n      t.eachTask(function (o) {\n        t.resetProjectDates(o), n.push(this.serializeTask(o));\n      }, t.config.root_id, this);\n      for (var r = t.getLinks(), s = 0; s < r.length; s++) i.push(this.serializeLink(r[s]));\n      return t.getDatastore(\"baselines\").eachItem(function (o) {\n        const l = t.json.serializeTask(o);\n        a.push(l);\n      }), {\n        data: n,\n        links: i,\n        baselines: a\n      };\n    }\n  }, t.xml = {\n    _xmlNodeToJSON: function (n, i) {\n      for (var a = {}, r = 0; r < n.attributes.length; r++) a[n.attributes[r].name] = n.attributes[r].value;\n      if (!i) {\n        for (r = 0; r < n.childNodes.length; r++) {\n          var s = n.childNodes[r];\n          s.nodeType == 1 && (a[s.tagName] = s.firstChild ? s.firstChild.nodeValue : \"\");\n        }\n        a.text || (a.text = n.firstChild ? n.firstChild.nodeValue : \"\");\n      }\n      return a;\n    },\n    _getCollections: function (n) {\n      for (var i = {}, a = t.ajax.xpath(\"//coll_options\", n), r = 0; r < a.length; r++) for (var s = i[a[r].getAttribute(\"for\")] = [], o = t.ajax.xpath(\".//item\", a[r]), l = 0; l < o.length; l++) {\n        for (var c = o[l].attributes, d = {\n            key: o[l].getAttribute(\"value\"),\n            label: o[l].getAttribute(\"label\")\n          }, u = 0; u < c.length; u++) {\n          var h = c[u];\n          h.nodeName != \"value\" && h.nodeName != \"label\" && (d[h.nodeName] = h.nodeValue);\n        }\n        s.push(d);\n      }\n      return i;\n    },\n    _getXML: function (n, i, a) {\n      a = a || \"data\", i.getXMLTopNode || (i = t.ajax.parse(i));\n      var r = t.ajax.xmltop(a, i.xmlDoc);\n      r && r.tagName == a || function (o) {\n        throw t.assert(!1, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. Actual argument value: \" + JSON.stringify(o)), new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \" + JSON.stringify(o));\n      }(n);\n      var s = r.getAttribute(\"dhx_security\");\n      return s && (t.security_key = s), r;\n    },\n    parse: function (n, i) {\n      i = this._getXML(n, i);\n      for (var a = {}, r = a.data = [], s = t.ajax.xpath(\"//task\", i), o = 0; o < s.length; o++) r[o] = this._xmlNodeToJSON(s[o]);\n      return a.collections = this._getCollections(i), a;\n    },\n    _copyLink: function (n) {\n      return \"<item id='\" + n.id + \"' source='\" + n.source + \"' target='\" + n.target + \"' type='\" + n.type + \"' />\";\n    },\n    _copyObject: function (n) {\n      return \"<task id='\" + n.id + \"' parent='\" + (n.parent || \"\") + \"' start_date='\" + n.start_date + \"' duration='\" + n.duration + \"' open='\" + !!n.open + \"' progress='\" + n.progress + \"' end_date='\" + n.end_date + \"'><![CDATA[\" + n.text + \"]]></task>\";\n    },\n    serialize: function () {\n      for (var n = [], i = [], a = t.json.serialize(), r = 0, s = a.data.length; r < s; r++) n.push(this._copyObject(a.data[r]));\n      for (r = 0, s = a.links.length; r < s; r++) i.push(this._copyLink(a.links[r]));\n      return \"<data>\" + n.join(\"\") + \"<coll_options for='links'>\" + i.join(\"\") + \"</coll_options></data>\";\n    }\n  }, t.oldxml = {\n    parse: function (n, i) {\n      i = t.xml._getXML(n, i, \"projects\");\n      for (var a = {\n          collections: {\n            links: []\n          }\n        }, r = a.data = [], s = t.ajax.xpath(\"//task\", i), o = 0; o < s.length; o++) {\n        r[o] = t.xml._xmlNodeToJSON(s[o]);\n        var l = s[o].parentNode;\n        l.tagName == \"project\" ? r[o].parent = \"project-\" + l.getAttribute(\"id\") : r[o].parent = l.parentNode.getAttribute(\"id\");\n      }\n      for (s = t.ajax.xpath(\"//project\", i), o = 0; o < s.length; o++) (c = t.xml._xmlNodeToJSON(s[o], !0)).id = \"project-\" + c.id, r.push(c);\n      for (o = 0; o < r.length; o++) {\n        var c;\n        (c = r[o]).start_date = c.startdate || c.est, c.end_date = c.enddate, c.text = c.name, c.duration = c.duration / 8, c.open = 1, c.duration || c.end_date || (c.duration = 1), c.predecessortasks && a.collections.links.push({\n          target: c.id,\n          source: c.predecessortasks,\n          type: t.config.links.finish_to_start\n        });\n      }\n      return a;\n    },\n    serialize: function () {\n      t.message(\"Serialization to 'old XML' is not implemented\");\n    }\n  }, t.serverList = function (n, i) {\n    return i ? this.serverList[n] = i.slice(0) : this.serverList[n] || (this.serverList[n] = []), this.serverList[n];\n  };\n}\nfunction ae(t, e, n, i, a) {\n  return this.date = t, this.unit = e, this.task = n, this.id = i, this.calendar = a, this;\n}\nfunction re(t, e, n, i, a, r) {\n  return this.date = t, this.dir = e, this.unit = n, this.task = i, this.id = a, this.calendar = r, this;\n}\nfunction se(t, e, n, i, a, r, s) {\n  return this.start_date = t, this.duration = e, this.unit = n, this.step = i, this.task = a, this.id = r, this.calendar = s, this;\n}\nfunction pi(t, e, n, i) {\n  return this.start_date = t, this.end_date = e, this.task = n, this.calendar = i, this.unit = null, this.step = null, this;\n}\nvar _n = function (t) {\n  return {\n    getWorkHoursArguments: function () {\n      var e = arguments[0];\n      if (!bt((e = Q(e) ? {\n        date: e\n      } : P({}, e)).date)) throw t.assert(!1, \"Invalid date argument for getWorkHours method\"), new Error(\"Invalid date argument for getWorkHours method\");\n      return e;\n    },\n    setWorkTimeArguments: function () {\n      return arguments[0];\n    },\n    unsetWorkTimeArguments: function () {\n      return arguments[0];\n    },\n    isWorkTimeArguments: function () {\n      var e,\n        n = arguments[0];\n      if (n instanceof ae) return n;\n      if ((e = n.date ? new ae(n.date, n.unit, n.task, null, n.calendar) : new ae(arguments[0], arguments[1], arguments[2], null, arguments[3])).unit = e.unit || t.config.duration_unit, !bt(e.date)) throw t.assert(!1, \"Invalid date argument for isWorkTime method\"), new Error(\"Invalid date argument for isWorkTime method\");\n      return e;\n    },\n    getClosestWorkTimeArguments: function (e) {\n      var n,\n        i = arguments[0];\n      if (i instanceof re) return i;\n      if (n = Q(i) ? new re(i) : new re(i.date, i.dir, i.unit, i.task, null, i.calendar), i.id && (n.task = i), n.dir = i.dir || \"any\", n.unit = i.unit || t.config.duration_unit, !bt(n.date)) throw t.assert(!1, \"Invalid date argument for getClosestWorkTime method\"), new Error(\"Invalid date argument for getClosestWorkTime method\");\n      return n;\n    },\n    _getStartEndConfig: function (e) {\n      var n,\n        i = pi;\n      if (e instanceof i) return e;\n      if (Q(e) ? n = new i(arguments[0], arguments[1], arguments[2], arguments[3]) : (n = new i(e.start_date, e.end_date, e.task), e.id !== null && e.id !== void 0 && (n.task = e)), n.unit = n.unit || t.config.duration_unit, n.step = n.step || t.config.duration_step, n.start_date = n.start_date || n.start || n.date, !bt(n.start_date)) throw t.assert(!1, \"Invalid start_date argument for getDuration method\"), new Error(\"Invalid start_date argument for getDuration method\");\n      if (!bt(n.end_date)) throw t.assert(!1, \"Invalid end_date argument for getDuration method\"), new Error(\"Invalid end_date argument for getDuration method\");\n      return n;\n    },\n    getDurationArguments: function (e, n, i, a) {\n      return this._getStartEndConfig.apply(this, arguments);\n    },\n    hasDurationArguments: function (e, n, i, a) {\n      return this._getStartEndConfig.apply(this, arguments);\n    },\n    calculateEndDateArguments: function (e, n, i, a) {\n      var r,\n        s = arguments[0];\n      if (s instanceof se) return s;\n      if (r = Q(s) ? new se(arguments[0], arguments[1], arguments[2], void 0, arguments[3], void 0, arguments[4]) : new se(s.start_date, s.duration, s.unit, s.step, s.task, null, s.calendar), s.id !== null && s.id !== void 0 && (r.task = s, r.unit = null, r.step = null), r.unit = r.unit || t.config.duration_unit, r.step = r.step || t.config.duration_step, !bt(r.start_date)) throw t.assert(!1, \"Invalid start_date argument for calculateEndDate method\"), new Error(\"Invalid start_date argument for calculateEndDate method\");\n      return r;\n    }\n  };\n};\nfunction gn() {}\ngn.prototype = {\n  _getIntervals: function (t) {\n    for (var e = [], n = 0; n < t.length; n += 2) e.push({\n      start: t[n],\n      end: t[n + 1]\n    });\n    return e;\n  },\n  _toHoursArray: function (t) {\n    var e = [];\n    function n(a) {\n      var r,\n        s = Math.floor(a / 3600),\n        o = a - 60 * s * 60,\n        l = Math.floor(o / 60);\n      return s + \":\" + ((r = String(l)).length < 2 && (r = \"0\" + r), r);\n    }\n    for (var i = 0; i < t.length; i++) e.push(n(t[i].start) + \"-\" + n(t[i].end));\n    return e;\n  },\n  _intersectHourRanges: function (t, e) {\n    var n = [],\n      i = t.length > e.length ? t : e,\n      a = t === i ? e : t;\n    i = i.slice(), a = a.slice(), n = [];\n    for (var r = 0; r < i.length; r++) for (var s = i[r], o = 0; o < a.length; o++) {\n      var l = a[o];\n      l.start < s.end && l.end > s.start && (n.push({\n        start: Math.max(s.start, l.start),\n        end: Math.min(s.end, l.end)\n      }), s.end > l.end && (a.splice(o, 1), o--, r--));\n    }\n    return n;\n  },\n  _mergeAdjacentIntervals: function (t) {\n    var e = t.slice();\n    e.sort(function (r, s) {\n      return r.start - s.start;\n    });\n    for (var n = e[0], i = 1; i < e.length; i++) {\n      var a = e[i];\n      a.start <= n.end ? (a.end > n.end && (n.end = a.end), e.splice(i, 1), i--) : n = a;\n    }\n    return e;\n  },\n  _mergeHoursConfig: function (t, e) {\n    return this._mergeAdjacentIntervals(this._intersectHourRanges(t, e));\n  },\n  merge: function (t, e) {\n    const n = q(t.getConfig()),\n      i = q(e.getConfig()),\n      a = n.parsed,\n      r = i.parsed;\n    a.customWeeks = n.customWeeks, r.customWeeks = i.customWeeks;\n    var s = {\n      hours: this._toHoursArray(this._mergeHoursConfig(a.hours, r.hours)),\n      dates: {},\n      customWeeks: {}\n    };\n    const o = (c, d) => {\n      for (let u in c.dates) {\n        const h = c.dates[u];\n        +u > 1e3 && (s.dates[u] = !1);\n        for (const _ in d.dates) {\n          const p = d.dates[_];\n          if (_ == u && (s.dates[u] = !(!h || !p)), Array.isArray(h)) {\n            const y = Array.isArray(p) ? p : d.hours;\n            s.dates[u] = this._toHoursArray(this._mergeHoursConfig(h, y));\n          }\n        }\n      }\n    };\n    if (o(a, r), o(r, a), a.customWeeks) for (var l in a.customWeeks) s.customWeeks[l] = a.customWeeks[l];\n    if (r.customWeeks) for (var l in r.customWeeks) s.customWeeks[l] ? s.customWeeks[l + \"_second\"] = r.customWeeks[l] : s.customWeeks[l] = r.customWeeks[l];\n    return s;\n  }\n};\nclass mi {\n  constructor() {\n    this.clear();\n  }\n  getItem(e, n, i) {\n    if (this._cache.has(e)) {\n      const a = this._cache.get(e)[i.getFullYear()];\n      if (a && a.has(n)) return a.get(n);\n    }\n    return -1;\n  }\n  setItem(e, n, i, a) {\n    if (!e || !n) return;\n    const r = this._cache,\n      s = a.getFullYear();\n    let o;\n    r.has(e) ? o = r.get(e) : (o = [], r.set(e, o));\n    let l = o[s];\n    l || (l = o[s] = /* @__PURE__ */new Map()), l.set(n, i);\n  }\n  clear() {\n    this._cache = /* @__PURE__ */new Map();\n  }\n}\nclass vi {\n  constructor() {\n    this.clear();\n  }\n  getItem(e, n, i) {\n    const a = this._cache;\n    if (a && a[e]) {\n      const r = a[e];\n      if (r === void 0) return -1;\n      const s = r[i.getFullYear()];\n      if (s && s[n] !== void 0) return s[n];\n    }\n    return -1;\n  }\n  setItem(e, n, i, a) {\n    if (!e || !n) return;\n    const r = this._cache;\n    if (!r) return;\n    r[e] || (r[e] = []);\n    const s = r[e],\n      o = a.getFullYear();\n    let l = s[o];\n    l || (l = s[o] = {}), l[n] = i;\n  }\n  clear() {\n    this._cache = {};\n  }\n}\nclass ki {\n  constructor(e) {\n    this.getMinutesPerWeek = n => {\n      const i = n.valueOf();\n      if (this._weekCache.has(i)) return this._weekCache.get(i);\n      const a = this._calendar,\n        r = this._calendar.$gantt;\n      let s = 0,\n        o = r.date.week_start(new Date(n));\n      for (let l = 0; l < 7; l++) s += 60 * a.getHoursPerDay(o), o = r.date.add(o, 1, \"day\");\n      return this._weekCache.set(i, s), s;\n    }, this.getMinutesPerMonth = n => {\n      const i = n.valueOf();\n      if (this._monthCache.has(i)) return this._monthCache.get(i);\n      const a = this._calendar,\n        r = this._calendar.$gantt;\n      let s = 0,\n        o = r.date.week_start(new Date(n));\n      const l = r.date.add(o, 1, \"month\").valueOf();\n      for (; o.valueOf() < l;) s += 60 * a.getHoursPerDay(o), o = r.date.add(o, 1, \"day\");\n      return this._monthCache.set(i, s), s;\n    }, this.clear = () => {\n      this._weekCache = /* @__PURE__ */new Map(), this._monthCache = /* @__PURE__ */new Map();\n    }, this.clear(), this._calendar = e;\n  }\n}\nclass yi {\n  constructor() {\n    this.clear();\n  }\n  _getCacheObject(e, n, i) {\n    const a = this._cache;\n    a[n] || (a[n] = []);\n    let r = a[n];\n    r || (r = a[n] = {});\n    let s = r[i];\n    s || (s = r[i] = {});\n    const o = e.getFullYear();\n    let l = s[o];\n    return l || (l = s[o] = {\n      durations: {},\n      endDates: {}\n    }), l;\n  }\n  _endDateCacheKey(e, n) {\n    return String(e) + \"-\" + String(n);\n  }\n  _durationCacheKey(e, n) {\n    return String(e) + \"-\" + String(n);\n  }\n  getEndDate(e, n, i, a, r) {\n    const s = this._getCacheObject(e, i, a),\n      o = e.valueOf(),\n      l = this._endDateCacheKey(o, n);\n    let c;\n    if (s.endDates[l] === void 0) {\n      const d = r(),\n        u = d.valueOf();\n      s.endDates[l] = u, s.durations[this._durationCacheKey(o, u)] = n, c = d;\n    } else c = new Date(s.endDates[l]);\n    return c;\n  }\n  getDuration(e, n, i, a, r) {\n    const s = this._getCacheObject(e, i, a),\n      o = e.valueOf(),\n      l = n.valueOf(),\n      c = this._durationCacheKey(o, l);\n    let d;\n    if (s.durations[c] === void 0) {\n      const u = r();\n      s.durations[c] = u.valueOf(), d = u;\n    } else d = s.durations[c];\n    return d;\n  }\n  clear() {\n    this._cache = {};\n  }\n}\nfunction ye(t, e) {\n  this.argumentsHelper = e, this.$gantt = t, this._workingUnitsCache = typeof Map < \"u\" ? new mi() : new vi(), this._largeUnitsCache = new ki(this), this._dateDurationCache = new yi(), this._worktime = null, this._cached_timestamps = {}, this._cached_timestamps_count = 0;\n}\nye.prototype = {\n  units: [\"year\", \"month\", \"week\", \"day\", \"hour\", \"minute\"],\n  _clearCaches: function () {\n    this._workingUnitsCache.clear(), this._largeUnitsCache.clear(), this._dateDurationCache.clear();\n  },\n  _getUnitOrder: function (t) {\n    for (var e = 0, n = this.units.length; e < n; e++) if (this.units[e] == t) return e;\n  },\n  _resetTimestampCache: function () {\n    this._cached_timestamps = {}, this._cached_timestamps_count = 0;\n  },\n  _timestamp: function (t) {\n    this._cached_timestamps_count > 1e6 && this._resetTimestampCache();\n    var e = null;\n    if (t.day || t.day === 0) e = t.day;else if (t.date) {\n      var n = String(t.date.valueOf());\n      this._cached_timestamps[n] ? e = this._cached_timestamps[n] : (e = Date.UTC(t.date.getFullYear(), t.date.getMonth(), t.date.getDate()), this._cached_timestamps[n] = e, this._cached_timestamps_count++);\n    }\n    return e;\n  },\n  _checkIfWorkingUnit: function (t, e) {\n    if (!this[\"_is_work_\" + e]) {\n      const n = this.$gantt.date[`${e}_start`](new Date(t)),\n        i = this.$gantt.date.add(n, 1, e);\n      return this.hasDuration(n, i);\n    }\n    return this[\"_is_work_\" + e](t);\n  },\n  _is_work_day: function (t) {\n    var e = this._getWorkHours(t);\n    return !!Array.isArray(e) && e.length > 0;\n  },\n  _is_work_hour: function (t) {\n    for (var e = this._getWorkHours(t), n = t.getHours(), i = 0; i < e.length; i++) if (n >= e[i].startHour && n < e[i].endHour) return !0;\n    return !1;\n  },\n  _getTimeOfDayStamp: function (t, e) {\n    var n = t.getHours();\n    return t.getHours() || t.getMinutes() || !e || (n = 24), 60 * n * 60 + 60 * t.getMinutes();\n  },\n  _is_work_minute: function (t) {\n    for (var e = this._getWorkHours(t), n = this._getTimeOfDayStamp(t), i = 0; i < e.length; i++) if (n >= e[i].start && n < e[i].end) return !0;\n    return !1;\n  },\n  _nextDate: function (t, e, n) {\n    return this.$gantt.date.add(t, n, e);\n  },\n  _getWorkUnitsBetweenGeneric: function (t, e, n, i) {\n    var a = this.$gantt.date,\n      r = new Date(t),\n      s = new Date(e);\n    i = i || 1;\n    var o,\n      l,\n      c = 0,\n      d = null,\n      u = !1;\n    (o = a[n + \"_start\"](new Date(r))).valueOf() != r.valueOf() && (u = !0);\n    var h = !1;\n    (l = a[n + \"_start\"](new Date(e))).valueOf() != e.valueOf() && (h = !0);\n    for (var _ = !1; r.valueOf() < s.valueOf();) {\n      if (_ = (d = this._nextDate(r, n, i)).valueOf() > s.valueOf(), this._isWorkTime(r, n)) (u || h && _) && (o = a[n + \"_start\"](new Date(r)), l = a.add(o, i, n)), u ? (u = !1, d = this._nextDate(o, n, i), c += (l.valueOf() - r.valueOf()) / (l.valueOf() - o.valueOf())) : h && _ ? (h = !1, c += (s.valueOf() - r.valueOf()) / (l.valueOf() - o.valueOf())) : c++;else {\n        var p = this._getUnitOrder(n),\n          y = this.units[p - 1];\n        y && !this._isWorkTime(r, y) && (d = this._getClosestWorkTimeFuture(r, y));\n      }\n      r = d;\n    }\n    return c;\n  },\n  _getMinutesPerHour: function (t) {\n    var e = this._getTimeOfDayStamp(t),\n      n = this._getTimeOfDayStamp(this._nextDate(t, \"hour\", 1));\n    n === 0 && (n = 86400);\n    for (var i = this._getWorkHours(t), a = 0; a < i.length; a++) {\n      var r = i[a];\n      if (e >= r.start && n <= r.end) return 60;\n      if (e < r.end && n > r.start) return (Math.min(n, r.end) - Math.max(e, r.start)) / 60;\n    }\n    return 0;\n  },\n  _getMinutesPerDay: function (t) {\n    var e = this._getWorkHours(t),\n      n = 0;\n    return e.forEach(function (i) {\n      n += i.durationMinutes;\n    }), n;\n  },\n  getHoursPerDay: function (t) {\n    var e = this._getWorkHours(t),\n      n = 0;\n    return e.forEach(function (i) {\n      n += i.durationHours;\n    }), n;\n  },\n  _getWorkUnitsForRange: function (t, e, n, i) {\n    var a,\n      r = 0,\n      s = new Date(t),\n      o = new Date(e);\n    for (a = R(n == \"minute\" ? this._getMinutesPerDay : this.getHoursPerDay, this); s.valueOf() < o.valueOf();) if (o - s > 27648e5 && s.getDate() === 0) {\n      var l = this._largeUnitsCache.getMinutesPerMonth(s);\n      n == \"hour\" && (l /= 60), r += l, s = this.$gantt.date.add(s, 1, \"month\");\n    } else {\n      if (o - s > 13824e5) {\n        var c = this.$gantt.date.week_start(new Date(s));\n        if (s.valueOf() === c.valueOf()) {\n          l = this._largeUnitsCache.getMinutesPerWeek(s), n == \"hour\" && (l /= 60), r += l, s = this.$gantt.date.add(s, 7, \"day\");\n          continue;\n        }\n      }\n      r += a(s), s = this._nextDate(s, \"day\", 1);\n    }\n    return r / i;\n  },\n  _getMinutesBetweenSingleDay: function (t, e) {\n    for (var n = this._getIntervalTimestamp(t, e), i = this._getWorkHours(t), a = 0, r = 0; r < i.length; r++) {\n      var s = i[r];\n      if (n.end >= s.start && n.start <= s.end) {\n        var o = Math.max(s.start, n.start),\n          l = Math.min(s.end, n.end);\n        a += (l - o) / 60, n.start = l;\n      }\n    }\n    return Math.floor(a);\n  },\n  _getMinutesBetween: function (t, e, n, i) {\n    var a = new Date(t),\n      r = new Date(e);\n    i = i || 1;\n    var s = new Date(a),\n      o = this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)), 1, \"day\");\n    if (r.valueOf() <= o.valueOf()) return this._getMinutesBetweenSingleDay(t, e);\n    var l = this.$gantt.date.day_start(new Date(r)),\n      c = r,\n      d = this._getMinutesBetweenSingleDay(s, o),\n      u = this._getMinutesBetweenSingleDay(l, c);\n    return d + this._getWorkUnitsForRange(o, l, n, i) + u;\n  },\n  _getHoursBetween: function (t, e, n, i) {\n    var a = new Date(t),\n      r = new Date(e);\n    i = i || 1;\n    var s = new Date(a),\n      o = this.$gantt.date.add(this.$gantt.date.day_start(new Date(a)), 1, \"day\");\n    if (r.valueOf() <= o.valueOf()) return Math.round(this._getMinutesBetweenSingleDay(t, e) / 60);\n    var l = this.$gantt.date.day_start(new Date(r)),\n      c = r,\n      d = this._getMinutesBetweenSingleDay(s, o, n, i) / 60,\n      u = this._getMinutesBetweenSingleDay(l, c, n, i) / 60,\n      h = d + this._getWorkUnitsForRange(o, l, n, i) + u;\n    return Math.round(h);\n  },\n  getConfig: function () {\n    return this._worktime;\n  },\n  _setConfig: function (t) {\n    this._worktime = t, this._parseSettings(), this._clearCaches();\n  },\n  _parseSettings: function () {\n    var t = this.getConfig();\n    for (var e in t.parsed = {\n      dates: {},\n      hours: null,\n      haveCustomWeeks: !1,\n      customWeeks: {},\n      customWeeksRangeStart: null,\n      customWeeksRangeEnd: null,\n      customWeeksBoundaries: []\n    }, t.parsed.hours = this._parseHours(t.hours), t.dates) t.parsed.dates[e] = this._parseHours(t.dates[e]);\n    if (t.customWeeks) {\n      var n = null,\n        i = null;\n      for (var e in t.customWeeks) {\n        var a = t.customWeeks[e];\n        if (a.from && a.to) {\n          var r = a.from,\n            s = a.to;\n          (!n || n > r.valueOf()) && (n = r.valueOf()), (!i || i < s.valueOf()) && (i = s.valueOf()), t.parsed.customWeeksBoundaries.push({\n            from: r.valueOf(),\n            fromReadable: new Date(r),\n            to: s.valueOf(),\n            toReadable: new Date(s),\n            name: e\n          }), t.parsed.haveCustomWeeks = !0;\n          var o = t.parsed.customWeeks[e] = {\n            from: a.from,\n            to: a.to,\n            hours: this._parseHours(a.hours),\n            dates: {}\n          };\n          if (a.days && !a.dates) {\n            for (a.dates = a.dates || {}, e = 0; e < a.days.length; e++) a.dates[e] = a.days[e], a.days[e] instanceof Array || (a.dates[e] = !!a.days[e]);\n            delete a.days;\n          }\n          for (var l in a.dates) o.dates[l] = this._parseHours(a.dates[l]);\n        }\n      }\n      t.parsed.customWeeksRangeStart = n, t.parsed.customWeeksRangeEnd = i;\n    }\n  },\n  _tryChangeCalendarSettings: function (t) {\n    var e = JSON.stringify(this.getConfig());\n    return t(), !!this.hasWorkTime() || (this._setConfig(JSON.parse(e)), this._clearCaches(), !1);\n  },\n  _arraysEqual: function (t, e) {\n    if (t === e) return !0;\n    if (!t || !e || t.length != e.length) return !1;\n    for (var n = 0; n < t.length; ++n) if (t[n] !== e[n]) return !1;\n    return !0;\n  },\n  _compareSettings: function (t, e) {\n    if (!this._arraysEqual(t.hours, e.hours)) return !1;\n    var n = Object.keys(t.dates),\n      i = Object.keys(e.dates);\n    if (n.sort(), i.sort(), !this._arraysEqual(n, i)) return !1;\n    for (var a = 0; a < n.length; a++) {\n      var r = n[a],\n        s = t.dates[r],\n        o = t.dates[r];\n      if (s !== o && !(Array.isArray(s) && Array.isArray(o) && this._arraysEqual(s, o))) return !1;\n    }\n    return !0;\n  },\n  equals: function (t) {\n    if (!(t instanceof ye)) return !1;\n    var e = this.getConfig(),\n      n = t.getConfig();\n    if (!this._compareSettings(e, n)) return !1;\n    if (e.parsed.haveCustomWeeks && n.parsed.haveCustomWeeks) {\n      if (e.parsed.customWeeksBoundaries.length != n.parsed.customWeeksBoundaries.length) return !1;\n      for (var i in e.parsed.customWeeks) {\n        var a = e.parsed.customWeeks[i],\n          r = n.parsed.customWeeks[i];\n        if (!r || !this._compareSettings(a, r)) return !1;\n      }\n    } else if (e.parse.haveCustomWeeks !== n.parsed.haveCustomWeeks) return !1;\n    return !0;\n  },\n  getWorkHours: function () {\n    var t = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n    return this._getWorkHours(t.date, !1);\n  },\n  _getWorkHours: function (t, e) {\n    var n = this.getConfig();\n    if (e !== !1 && (n = n.parsed), !t) return n.hours;\n    var i = this._timestamp({\n      date: t\n    });\n    if (n.haveCustomWeeks && n.customWeeksRangeStart <= i && n.customWeeksRangeEnd > i) {\n      for (var a = 0; a < n.customWeeksBoundaries.length; a++) if (n.customWeeksBoundaries[a].from <= i && n.customWeeksBoundaries[a].to > i) {\n        n = n.customWeeks[n.customWeeksBoundaries[a].name];\n        break;\n      }\n    }\n    var r = !0;\n    return n.dates[i] !== void 0 ? r = n.dates[i] : n.dates[t.getDay()] !== void 0 && (r = n.dates[t.getDay()]), r === !0 ? n.hours : r || [];\n  },\n  _getIntervalTimestamp: function (t, e) {\n    var n = {\n      start: 0,\n      end: 0\n    };\n    n.start = 60 * t.getHours() * 60 + 60 * t.getMinutes() + t.getSeconds();\n    var i = e.getHours();\n    return !i && !e.getMinutes() && !e.getSeconds() && t.valueOf() < e.valueOf() && (i = 24), n.end = 60 * i * 60 + 60 * e.getMinutes() + e.getSeconds(), n;\n  },\n  _parseHours: function (t) {\n    if (Array.isArray(t)) {\n      var e = [];\n      t.forEach(function (o) {\n        typeof o == \"number\" ? e.push(60 * o * 60) : typeof o == \"string\" && o.split(\"-\").map(function (l) {\n          return l.trim();\n        }).forEach(function (l) {\n          var c = l.split(\":\").map(function (u) {\n              return u.trim();\n            }),\n            d = parseInt(60 * c[0] * 60);\n          c[1] && (d += parseInt(60 * c[1])), c[2] && (d += parseInt(c[2])), e.push(d);\n        });\n      });\n      for (var n = [], i = 0; i < e.length; i += 2) {\n        var a = e[i],\n          r = e[i + 1],\n          s = r - a;\n        n.push({\n          start: a,\n          end: r,\n          startHour: Math.floor(a / 3600),\n          startMinute: Math.floor(a / 60),\n          endHour: Math.ceil(r / 3600),\n          endMinute: Math.ceil(r / 60),\n          durationSeconds: s,\n          durationMinutes: s / 60,\n          durationHours: s / 3600\n        });\n      }\n      return n;\n    }\n    return t;\n  },\n  setWorkTime: function (t) {\n    return this._tryChangeCalendarSettings(R(function () {\n      var e = t.hours === void 0 || t.hours,\n        n = this._timestamp(t),\n        i = this.getConfig();\n      if (n !== null ? i.dates[n] = e : t.customWeeks || (i.hours = e), t.customWeeks) {\n        if (i.customWeeks || (i.customWeeks = {}), typeof t.customWeeks == \"string\") n !== null ? i.customWeeks[t.customWeeks].dates[n] = e : t.customWeeks || (i.customWeeks[t.customWeeks].hours = e);else if (typeof t.customWeeks == \"object\" && t.customWeeks.constructor === Object) for (var a in t.customWeeks) i.customWeeks[a] = t.customWeeks[a];\n      }\n      this._parseSettings(), this._clearCaches();\n    }, this));\n  },\n  unsetWorkTime: function (t) {\n    return this._tryChangeCalendarSettings(R(function () {\n      if (t) {\n        var e = this._timestamp(t);\n        e !== null && delete this.getConfig().dates[e];\n      } else this.reset_calendar();\n      this._parseSettings(), this._clearCaches();\n    }, this));\n  },\n  _isWorkTime: function (t, e) {\n    var n,\n      i = -1;\n    return n = String(t.valueOf()), (i = this._workingUnitsCache.getItem(e, n, t)) == -1 && (i = this._checkIfWorkingUnit(t, e), this._workingUnitsCache.setItem(e, n, i, t)), i;\n  },\n  isWorkTime: function () {\n    var t = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n    return this._isWorkTime(t.date, t.unit);\n  },\n  calculateDuration: function () {\n    var t = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n    if (!t.unit) return !1;\n    var e = this;\n    return this._dateDurationCache.getDuration(t.start_date, t.end_date, t.unit, t.step, function () {\n      return e._calculateDuration(t.start_date, t.end_date, t.unit, t.step);\n    });\n  },\n  _calculateDuration: function (t, e, n, i) {\n    var a = 0,\n      r = 1;\n    if (t.valueOf() > e.valueOf()) {\n      var s = e;\n      e = t, t = s, r = -1;\n    }\n    return a = n == \"hour\" && i == 1 ? this._getHoursBetween(t, e, n, i) : n == \"minute\" && i == 1 ? this._getMinutesBetween(t, e, n, i) : this._getWorkUnitsBetweenGeneric(t, e, n, i), r * Math.round(a);\n  },\n  hasDuration: function () {\n    var t = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments),\n      e = t.start_date,\n      n = t.end_date,\n      i = t.unit,\n      a = t.step;\n    if (!i) return !1;\n    var r = new Date(e),\n      s = new Date(n);\n    for (a = a || 1; r.valueOf() < s.valueOf();) {\n      if (this._isWorkTime(r, i)) return !0;\n      r = this._nextDate(r, i, a);\n    }\n    return !1;\n  },\n  calculateEndDate: function () {\n    var t = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments),\n      e = t.start_date,\n      n = t.duration,\n      i = t.unit,\n      a = t.step;\n    if (!i) return !1;\n    var r = t.duration >= 0 ? 1 : -1;\n    n = Math.abs(1 * n);\n    var s = this;\n    return this._dateDurationCache.getEndDate(e, n, i, a * r, function () {\n      return s._calculateEndDate(e, n, i, a * r);\n    });\n  },\n  _calculateEndDate: function (t, e, n, i) {\n    return !!n && (i == 1 && n == \"minute\" ? this._calculateMinuteEndDate(t, e, i) : i == -1 && n == \"minute\" ? this._subtractMinuteDate(t, e, i) : i == 1 && n == \"hour\" ? this._calculateHourEndDate(t, e, i) : this._addInterval(t, e, n, i, null).end);\n  },\n  _addInterval: function (t, e, n, i, a) {\n    for (var r = 0, s = t, o = !1; r < e && (!a || !a(s));) {\n      var l = this._nextDate(s, n, i);\n      n == \"day\" && (o = o || !s.getHours() && l.getHours()) && (l.setHours(0), l.getHours() || (o = !1));\n      var c = new Date(l.valueOf() + 1);\n      i > 0 && (c = new Date(l.valueOf() - 1)), this._isWorkTime(c, n) && !o && r++, s = l;\n    }\n    return {\n      end: s,\n      start: t,\n      added: r\n    };\n  },\n  _addHoursUntilDayEnd: function (t, e) {\n    for (var n = this.$gantt.date.add(this.$gantt.date.day_start(new Date(t)), 1, \"day\"), i = 0, a = e, r = this._getIntervalTimestamp(t, n), s = this._getWorkHours(t), o = 0; o < s.length && i < e; o++) {\n      var l = s[o];\n      if (r.end >= l.start && r.start <= l.end) {\n        var c = Math.max(l.start, r.start),\n          d = Math.min(l.end, r.end),\n          u = (d - c) / 3600;\n        u > a && (u = a, d = c + 60 * a * 60);\n        var h = Math.round((d - c) / 3600);\n        i += h, a -= h, r.start = d;\n      }\n    }\n    var _ = n;\n    return i === e && (_ = new Date(t.getFullYear(), t.getMonth(), t.getDate(), 0, 0, r.start)), {\n      added: i,\n      end: _\n    };\n  },\n  _calculateHourEndDate: function (t, e, n) {\n    var i = new Date(t),\n      a = 0;\n    n = n || 1, e = Math.abs(1 * e);\n    var r = this._addHoursUntilDayEnd(i, e);\n    if (a = r.added, i = r.end, c = e - a) {\n      for (var s = i; a < e;) {\n        var o = this._nextDate(s, \"day\", n);\n        o.setHours(0), o.setMinutes(0), o.setSeconds(0);\n        var l = 0;\n        if (a + (l = n > 0 ? this.getHoursPerDay(new Date(o.valueOf() - 1)) : this.getHoursPerDay(new Date(o.valueOf() + 1))) >= e) break;\n        a += l, s = o;\n      }\n      i = s;\n    }\n    if (a < e) {\n      var c = e - a;\n      i = (r = this._addHoursUntilDayEnd(i, c)).end;\n    }\n    return i;\n  },\n  _addMinutesUntilHourEnd: function (t, e) {\n    if (t.getMinutes() === 0) return {\n      added: 0,\n      end: new Date(t)\n    };\n    for (var n = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(t)), 1, \"hour\"), i = 0, a = e, r = this._getIntervalTimestamp(t, n), s = this._getWorkHours(t), o = 0; o < s.length && i < e; o++) {\n      var l = s[o];\n      if (r.end >= l.start && r.start <= l.end) {\n        var c = Math.max(l.start, r.start),\n          d = Math.min(l.end, r.end),\n          u = (d - c) / 60;\n        u > a && (u = a, d = c + 60 * a);\n        var h = Math.round((d - c) / 60);\n        a -= h, i += h, r.start = d;\n      }\n    }\n    var _ = n;\n    return i === e && (_ = new Date(t.getFullYear(), t.getMonth(), t.getDate(), 0, 0, r.start)), {\n      added: i,\n      end: _\n    };\n  },\n  _subtractMinutesUntilHourStart: function (t, e) {\n    for (var n = this.$gantt.date.hour_start(new Date(t)), i = 0, a = e, r = 60 * n.getHours() * 60 + 60 * n.getMinutes() + n.getSeconds(), s = 60 * t.getHours() * 60 + 60 * t.getMinutes() + t.getSeconds(), o = this._getWorkHours(t), l = o.length - 1; l >= 0 && i < e; l--) {\n      var c = o[l];\n      if (s > c.start && r <= c.end) {\n        var d = Math.min(s, c.end),\n          u = Math.max(r, c.start),\n          h = (d - u) / 60;\n        h > a && (h = a, u = d - 60 * a);\n        var _ = Math.abs(Math.round((d - u) / 60));\n        a -= _, i += _, s = u;\n      }\n    }\n    var p = n;\n    return i === e && (p = new Date(t.getFullYear(), t.getMonth(), t.getDate(), 0, 0, s)), {\n      added: i,\n      end: p\n    };\n  },\n  _subtractMinuteDate: function (t, e, n) {\n    var i = this.getClosestWorkTime({\n        date: t,\n        dir: \"past\",\n        unit: \"minute\"\n      }),\n      a = 0;\n    n = n || -1, e = Math.abs(1 * e), e = Math.round(e);\n    const r = this._isMinutePrecision(i);\n    let s = this._subtractMinutesUntilHourStart(i, e);\n    a += s.added, i = s.end;\n    for (var o = 0, l = [], c = 0; a < e;) {\n      var d = this.$gantt.date.day_start(new Date(i)),\n        u = !1;\n      i.valueOf() === d.valueOf() && (d = this.$gantt.date.add(d, -1, \"day\"), u = !0);\n      var h = new Date(d.getFullYear(), d.getMonth(), d.getDate(), 23, 59, 59, 999).valueOf();\n      h !== o && (l = this._getWorkHours(d), c = this._getMinutesPerDay(d), o = h);\n      var _ = e - a,\n        p = this._getTimeOfDayStamp(i, u);\n      if (l.length && c) {\n        if (l[l.length - 1].end <= p && _ > c) a += c, i = this.$gantt.date.add(i, -1, \"day\");else {\n          for (var y = !1, k = null, b = null, g = l.length - 1; g >= 0; g--) if (l[g].start < p - 1 && l[g].end >= p - 1) {\n            y = !0, k = l[g], b = l[g - 1];\n            break;\n          }\n          if (y) {\n            if (p === k.end && _ >= k.durationMinutes) a += k.durationMinutes, i = this.$gantt.date.add(i, -k.durationMinutes, \"minute\");else if (!r && _ <= p / 60 - k.startMinute) a += _, i = this.$gantt.date.add(i, -_, \"minute\");else if (r) _ <= p / 60 - k.startMinute ? (a += _, i = this.$gantt.date.add(i, -_, \"minute\")) : (a += p / 60 - k.startMinute, i = b ? new Date(i.getFullYear(), i.getMonth(), i.getDate(), 0, 0, b.end) : this.$gantt.date.day_start(i));else {\n              var m = this._getMinutesPerHour(i);\n              m <= _ ? (a += m, i = this._nextDate(i, \"hour\", n)) : (s = this._subtractMinutesUntilHourStart(i, _), a += s.added, i = s.end);\n            }\n          } else if (i.getHours() === 0 && i.getMinutes() === 0 && i.getSeconds() === 0) {\n            if ((f = this._getClosestWorkTimePast(i, \"hour\")).valueOf() === i.valueOf()) {\n              var f = this.$gantt.date.add(i, -1, \"day\"),\n                v = this._getWorkHours(f);\n              if (v.length) {\n                var x = v[v.length - 1];\n                f.setSeconds(x.durationSeconds);\n              }\n            }\n            i = f;\n          } else i = this._getClosestWorkTimePast(new Date(i - 1), \"hour\");\n        }\n      } else i = this.$gantt.date.add(i, -1, \"day\");\n    }\n    if (a < e) {\n      var $ = e - a;\n      s = this._subtractMinutesUntilHourStart(i, $), a += s.added, i = s.end;\n    }\n    return i;\n  },\n  _calculateMinuteEndDate: function (t, e, n) {\n    var i = new Date(t),\n      a = 0;\n    n = n || 1, e = Math.abs(1 * e), e = Math.round(e);\n    var r = this._addMinutesUntilHourEnd(i, e);\n    a += r.added, i = r.end;\n    for (var s = 0, o = [], l = 0, c = this._isMinutePrecision(i); a < e;) {\n      var d = this.$gantt.date.day_start(new Date(i)).valueOf();\n      d !== s && (o = this._getWorkHours(i), l = this._getMinutesPerDay(i), s = d);\n      var u = e - a,\n        h = this._getTimeOfDayStamp(i);\n      if (o.length && l) {\n        if (o[0].start >= h && u >= l) {\n          if (a += l, u == l) {\n            i = new Date(i.getFullYear(), i.getMonth(), i.getDate(), 0, 0, o[o.length - 1].end);\n            break;\n          }\n          i = this.$gantt.date.add(i, 1, \"day\"), i = this.$gantt.date.day_start(i);\n        } else {\n          for (var _ = !1, p = null, y = 0; y < o.length; y++) if (o[y].start <= h && o[y].end > h) {\n            _ = !0, p = o[y];\n            break;\n          }\n          if (_) {\n            if (h === p.start && u >= p.durationMinutes) a += p.durationMinutes, i = this.$gantt.date.add(i, p.durationMinutes, \"minute\");else if (u <= p.endMinute - h / 60) a += u, i = this.$gantt.date.add(i, u, \"minute\");else {\n              var k = this._getMinutesPerHour(i);\n              k <= u ? (a += k, i = c ? this.$gantt.date.add(i, k, \"minute\") : this._nextDate(i, \"hour\", n)) : (a += (r = this._addMinutesUntilHourEnd(i, u)).added, i = r.end);\n            }\n          } else i = this._getClosestWorkTimeFuture(i, \"hour\");\n        }\n      } else i = this.$gantt.date.add(this.$gantt.date.day_start(i), 1, \"day\");\n    }\n    if (a < e) {\n      var b = e - a;\n      a += (r = this._addMinutesUntilHourEnd(i, b)).added, i = r.end;\n    }\n    return i;\n  },\n  getClosestWorkTime: function () {\n    var t = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n    return this._getClosestWorkTime(t.date, t.unit, t.dir);\n  },\n  _getClosestWorkTime: function (t, e, n) {\n    var i = new Date(t);\n    if (this._isWorkTime(i, e)) return i;\n    if (i = this.$gantt.date[e + \"_start\"](i), n != \"any\" && n) i = n == \"past\" ? this._getClosestWorkTimePast(i, e) : this._getClosestWorkTimeFuture(i, e);else {\n      var a = this._getClosestWorkTimeFuture(i, e),\n        r = this._getClosestWorkTimePast(i, e);\n      i = Math.abs(a - t) <= Math.abs(t - r) ? a : r;\n    }\n    return i;\n  },\n  _getClosestWorkTimeFuture: function (t, e) {\n    return this._getClosestWorkTimeGeneric(t, e, 1);\n  },\n  _getClosestWorkTimePast: function (t, e) {\n    var n = this._getClosestWorkTimeGeneric(t, e, -1);\n    return this.$gantt.date.add(n, 1, e);\n  },\n  _findClosestTimeInDay: function (t, e, n) {\n    var i = new Date(t),\n      a = null,\n      r = !1;\n    this._getWorkHours(i).length || (i = this._getClosestWorkTime(i, \"day\", e < 0 ? \"past\" : \"future\"), e < 0 && (i = new Date(i.valueOf() - 1), r = !0), n = this._getWorkHours(i));\n    var s = this._getTimeOfDayStamp(i);\n    if (r && (s = this._getTimeOfDayStamp(new Date(i.valueOf() + 1), r)), e > 0) {\n      for (var o = 0; o < n.length; o++) if (n[o].start >= s) {\n        a = new Date(i.getFullYear(), i.getMonth(), i.getDate(), 0, 0, n[o].start);\n        break;\n      }\n    } else for (o = n.length - 1; o >= 0; o--) {\n      if (n[o].end <= s) {\n        a = new Date(i.getFullYear(), i.getMonth(), i.getDate(), 0, 0, n[o].end);\n        break;\n      }\n      if (n[o].end > s && n[o].start <= s) {\n        a = new Date(i.getFullYear(), i.getMonth(), i.getDate(), 0, 0, s);\n        break;\n      }\n    }\n    return a;\n  },\n  _getClosestWorkMinute: function (t, e, n) {\n    var i = new Date(t),\n      a = this._getWorkHours(i),\n      r = this._findClosestTimeInDay(i, n, a);\n    return r || (n > 0 ? (i = this.calculateEndDate(i, n, e), i = this.$gantt.date.day_start(i)) : (i = this.calculateEndDate(i, n, \"day\"), i = this.$gantt.date.day_start(i), i = this.$gantt.date.add(i, 1, \"day\"), i = new Date(i.valueOf() - 1)), a = this._getWorkHours(i), r = this._findClosestTimeInDay(i, n, a)), n < 0 && (r = this.$gantt.date.add(r, -1, e)), r;\n  },\n  _getClosestWorkTimeGeneric: function (t, e, n) {\n    if (e === \"hour\" || e === \"minute\") return this._getClosestWorkMinute(t, e, n);\n    for (var i = this._getUnitOrder(e), a = this.units[i - 1], r = t, s = 0; !this._isWorkTime(r, e) && (!a || this._isWorkTime(r, a) || (r = n > 0 ? this._getClosestWorkTimeFuture(r, a) : this._getClosestWorkTimePast(r, a), !this._isWorkTime(r, e)));) {\n      if (++s > 3e3) return this.$gantt.assert(!1, \"Invalid working time check\"), !1;\n      var o = r.getTimezoneOffset();\n      r = this.$gantt.date.add(r, n, e), r = this.$gantt._correct_dst_change(r, o, n, e), this.$gantt.date[e + \"_start\"] && (r = this.$gantt.date[e + \"_start\"](r));\n    }\n    return r;\n  },\n  hasWorkTime: function () {\n    var t = this.getConfig(),\n      e = t.dates;\n    for (var n in t.dates);\n    var i = this._checkWorkHours(t.hours),\n      a = !1;\n    return [0, 1, 2, 3, 4, 5, 6].forEach(function (r) {\n      if (!a) {\n        var s = e[r];\n        s === !0 ? a = i : Array.isArray(s) && (a = this._checkWorkHours(s));\n      }\n    }.bind(this)), a;\n  },\n  _checkWorkHours: function (t) {\n    if (t.length === 0) return !1;\n    for (var e = !1, n = 0; n < t.length; n += 2) t[n] !== t[n + 1] && (e = !0);\n    return e;\n  },\n  _isMinutePrecision: function (t) {\n    let e = !1;\n    return this._getWorkHours(t).forEach(function (n) {\n      (n.startMinute % 60 || n.endMinute % 60) && (e = !0);\n    }), e;\n  }\n};\nconst It = {\n    isLegacyResourceCalendarFormat: function (t) {\n      if (!t) return !1;\n      for (var e in t) if (t[e] && typeof t[e] == \"object\") return !0;\n      return !1;\n    },\n    getResourceProperty: function (t) {\n      var e = t.resource_calendars,\n        n = t.resource_property;\n      if (this.isLegacyResourceCalendarFormat(e)) for (var i in t) {\n        n = i;\n        break;\n      }\n      return n;\n    },\n    getCalendarIdFromLegacyConfig: function (t, e) {\n      if (e) for (var n in e) {\n        var i = e[n];\n        if (t[n]) {\n          var a = i[t[n]];\n          if (a) return a;\n        }\n      }\n      return null;\n    }\n  },\n  bi = (Wt = {}, {\n    getCalendarIdFromMultipleResources: function (t, e) {\n      var n = function (a) {\n        return a.map(function (r) {\n          return r && r.resource_id ? r.resource_id : r;\n        }).sort().join(\"-\");\n      }(t);\n      if (t.length) {\n        if (t.length === 1) return e.getResourceCalendar(n).id;\n        if (Wt[n]) return Wt[n].id;\n        var i = function (a, r) {\n          return r.mergeCalendars(a.map(function (s) {\n            var o = s && s.resource_id ? s.resource_id : s;\n            return r.getResourceCalendar(o);\n          }));\n        }(t, e);\n        return Wt[n] = i, e.addCalendar(i);\n      }\n      return null;\n    }\n  });\nvar Wt;\nfunction fn(t) {\n  this.$gantt = t, this._calendars = {}, this._legacyConfig = void 0, this.$gantt.attachEvent(\"onGanttReady\", function () {\n    this.$gantt.config.resource_calendars && (this._isLegacyConfig = It.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars));\n  }.bind(this)), this.$gantt.attachEvent(\"onBeforeGanttReady\", function () {\n    this.createDefaultCalendars();\n  }.bind(this)), this.$gantt.attachEvent(\"onBeforeGanttRender\", function () {\n    this.createDefaultCalendars();\n  }.bind(this));\n}\nfunction be(t, e) {\n  this.argumentsHelper = e, this.$gantt = t;\n}\nfunction pn(t) {\n  this.$gantt = t.$gantt, this.argumentsHelper = _n(this.$gantt), this.calendarManager = t, this.$disabledCalendar = new be(this.$gantt, this.argumentsHelper);\n}\nfn.prototype = {\n  _calendars: {},\n  _convertWorkTimeSettings: function (t) {\n    var e = t.days;\n    if (e && !t.dates) {\n      t.dates = t.dates || {};\n      for (var n = 0; n < e.length; n++) t.dates[n] = e[n], e[n] instanceof Array || (t.dates[n] = !!e[n]);\n    }\n    return delete t.days, t;\n  },\n  mergeCalendars: function () {\n    var t = [],\n      e = arguments;\n    if (Array.isArray(e[0])) t = e[0].slice();else for (var n = 0; n < arguments.length; n++) t.push(arguments[n]);\n    var i,\n      a = new gn();\n    return t.forEach(function (r) {\n      i = i ? this._createCalendarFromConfig(a.merge(i, r)) : r;\n    }.bind(this)), this.createCalendar(i);\n  },\n  _createCalendarFromConfig: function (t) {\n    var e = new ye(this.$gantt, _n(this.$gantt));\n    e.id = String(st());\n    var n = this._convertWorkTimeSettings(t);\n    if (n.customWeeks) for (var i in n.customWeeks) n.customWeeks[i] = this._convertWorkTimeSettings(n.customWeeks[i]);\n    return e._setConfig(n), e;\n  },\n  createCalendar: function (t) {\n    var e;\n    return t || (t = {}), P(e = t.getConfig ? q(t.getConfig()) : t.worktime ? q(t.worktime) : q(t), q(this.defaults.fulltime.worktime)), this._createCalendarFromConfig(e);\n  },\n  getCalendar: function (t) {\n    t = t || \"global\";\n    var e = this._calendars[t];\n    return e || (this.createDefaultCalendars(), e = this._calendars[t]), e;\n  },\n  getCalendars: function () {\n    var t = [];\n    for (var e in this._calendars) t.push(this.getCalendar(e));\n    return t;\n  },\n  _getOwnCalendar: function (t) {\n    var e = this.$gantt.config;\n    if (t[e.calendar_property]) return this.getCalendar(t[e.calendar_property]);\n    if (e.resource_calendars) {\n      var n;\n      if (n = this._legacyConfig === !1 ? e.resource_property : It.getResourceProperty(e), Array.isArray(t[n]) && t[n].length) e.dynamic_resource_calendars ? i = bi.getCalendarIdFromMultipleResources(t[n], this) : a = this.getResourceCalendar(t[n]);else if (this._legacyConfig === void 0 && (this._legacyConfig = It.isLegacyResourceCalendarFormat(e.resource_calendars)), this._legacyConfig) var i = It.getCalendarIdFromLegacyConfig(t, e.resource_calendars);else if (n && t[n] && e.resource_calendars[t[n]]) var a = this.getResourceCalendar(t[n]);\n      if (i && (a = this.getCalendar(i)), a) return a;\n    }\n    return null;\n  },\n  getResourceCalendar: function (t) {\n    if (t == null) return this.getCalendar();\n    var e = null;\n    e = typeof t == \"number\" || typeof t == \"string\" ? t : t.id || t.key;\n    var n = this.$gantt.config,\n      i = n.resource_calendars,\n      a = null;\n    if (Array.isArray(t) && t.length === 1 && (e = typeof t[0] == \"object\" ? t[0].resource_id : t[0]), i) {\n      if (this._legacyConfig === void 0 && (this._legacyConfig = It.isLegacyResourceCalendarFormat(n.resource_calendars)), this._legacyConfig) {\n        for (var r in i) if (i[r][e]) {\n          a = i[r][e];\n          break;\n        }\n      } else a = i[e];\n      if (a) return this.getCalendar(a);\n    }\n    return this.getCalendar();\n  },\n  getTaskCalendar: function (t) {\n    var e,\n      n = this.$gantt;\n    if (t == null) return this.getCalendar();\n    if (!(e = typeof t != \"number\" && typeof t != \"string\" || !n.isTaskExists(t) ? t : n.getTask(t))) return this.getCalendar();\n    var i = this._getOwnCalendar(e),\n      a = !!n.getState().group_mode;\n    if (!i && n.config.inherit_calendar && n.isTaskExists(e.parent)) {\n      for (var r = e; n.isTaskExists(r.parent) && (r = n.getTask(r.parent), !n.isSummaryTask(r) || !(i = this._getOwnCalendar(r))););\n      a && !i && t.$effective_calendar && (i = this.getCalendar(t.$effective_calendar));\n    }\n    return i || this.getCalendar();\n  },\n  addCalendar: function (t) {\n    if (!this.isCalendar(t)) {\n      var e = t.id;\n      (t = this.createCalendar(t)).id = e;\n    }\n    if (t._tryChangeCalendarSettings(function () {})) {\n      var n = this.$gantt.config;\n      return t.id = t.id || st(), this._calendars[t.id] = t, n.worktimes || (n.worktimes = {}), n.worktimes[t.id] = t.getConfig(), t.id;\n    }\n    return this.$gantt.callEvent(\"onCalendarError\", [{\n      message: \"Invalid calendar settings, no worktime available\"\n    }, t]), null;\n  },\n  deleteCalendar: function (t) {\n    var e = this.$gantt.config;\n    return !!t && !!this._calendars[t] && (delete this._calendars[t], e.worktimes && e.worktimes[t] && delete e.worktimes[t], !0);\n  },\n  restoreConfigCalendars: function (t) {\n    for (var e in t) if (!this._calendars[e]) {\n      var n = t[e],\n        i = this.createCalendar(n);\n      i.id = e, this.addCalendar(i);\n    }\n  },\n  defaults: {\n    global: {\n      id: \"global\",\n      worktime: {\n        hours: [8, 12, 13, 17],\n        days: [0, 1, 1, 1, 1, 1, 0]\n      }\n    },\n    fulltime: {\n      id: \"fulltime\",\n      worktime: {\n        hours: [0, 24],\n        days: [1, 1, 1, 1, 1, 1, 1]\n      }\n    }\n  },\n  createDefaultCalendars: function () {\n    var t = this.$gantt.config;\n    this.restoreConfigCalendars(this.defaults), this.restoreConfigCalendars(t.worktimes);\n  },\n  isCalendar: function (t) {\n    return [t.isWorkTime, t.setWorkTime, t.getWorkHours, t.unsetWorkTime, t.getClosestWorkTime, t.calculateDuration, t.hasDuration, t.calculateEndDate].every(function (e) {\n      return e instanceof Function;\n    });\n  }\n}, be.prototype = {\n  getWorkHours: function () {\n    return [0, 24];\n  },\n  setWorkTime: function () {\n    return !0;\n  },\n  unsetWorkTime: function () {\n    return !0;\n  },\n  isWorkTime: function () {\n    return !0;\n  },\n  getClosestWorkTime: function (t) {\n    return this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments).date;\n  },\n  calculateDuration: function () {\n    var t = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments),\n      e = t.start_date,\n      n = t.end_date,\n      i = t.unit,\n      a = t.step;\n    return this._calculateDuration(e, n, i, a);\n  },\n  _calculateDuration: function (t, e, n, i) {\n    var a = this.$gantt.date,\n      r = {\n        week: 6048e5,\n        day: 864e5,\n        hour: 36e5,\n        minute: 6e4\n      },\n      s = 0;\n    if (r[n]) s = Math.round((e - t) / (i * r[n]));else {\n      for (var o = new Date(t), l = new Date(e); o.valueOf() < l.valueOf();) s += 1, o = a.add(o, i, n);\n      o.valueOf() != e.valueOf() && (s += (l - o) / (a.add(o, i, n) - o));\n    }\n    return Math.round(s);\n  },\n  hasDuration: function () {\n    var t = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments),\n      e = t.start_date,\n      n = t.end_date;\n    return !!t.unit && (e = new Date(e), n = new Date(n), e.valueOf() < n.valueOf());\n  },\n  hasWorkTime: function () {\n    return !0;\n  },\n  equals: function (t) {\n    return t instanceof be;\n  },\n  calculateEndDate: function () {\n    var t = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments),\n      e = t.start_date,\n      n = t.duration,\n      i = t.unit,\n      a = t.step;\n    return this.$gantt.date.add(e, a * n, i);\n  }\n}, pn.prototype = {\n  _getCalendar: function (t) {\n    var e;\n    if (this.$gantt.config.work_time) {\n      var n = this.calendarManager;\n      t.task ? e = n.getTaskCalendar(t.task) : t.id ? e = n.getTaskCalendar(t) : t.calendar && (e = t.calendar), e || (e = n.getTaskCalendar());\n    } else e = this.$disabledCalendar;\n    return e;\n  },\n  getWorkHours: function (t) {\n    return t = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments), this._getCalendar(t).getWorkHours(t.date);\n  },\n  setWorkTime: function (t, e) {\n    return t = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments), e || (e = this.calendarManager.getCalendar()), e.setWorkTime(t);\n  },\n  unsetWorkTime: function (t, e) {\n    return t = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments), e || (e = this.calendarManager.getCalendar()), e.unsetWorkTime(t);\n  },\n  isWorkTime: function (t, e, n, i) {\n    var a = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n    return (i = this._getCalendar(a)).isWorkTime(a);\n  },\n  getClosestWorkTime: function (t) {\n    return t = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments), this._getCalendar(t).getClosestWorkTime(t);\n  },\n  calculateDuration: function () {\n    var t = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n    return this._getCalendar(t).calculateDuration(t);\n  },\n  hasDuration: function () {\n    var t = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\n    return this._getCalendar(t).hasDuration(t);\n  },\n  calculateEndDate: function (t) {\n    return t = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments), this._getCalendar(t).calculateEndDate(t);\n  }\n};\nconst xi = function (t, e) {\n  return {\n    getWorkHours: function (n) {\n      return e.getWorkHours(n);\n    },\n    setWorkTime: function (n) {\n      return e.setWorkTime(n);\n    },\n    unsetWorkTime: function (n) {\n      e.unsetWorkTime(n);\n    },\n    isWorkTime: function (n, i, a) {\n      return e.isWorkTime(n, i, a);\n    },\n    getClosestWorkTime: function (n) {\n      return e.getClosestWorkTime(n);\n    },\n    calculateDuration: function (n, i, a) {\n      return e.calculateDuration(n, i, a);\n    },\n    _hasDuration: function (n, i, a) {\n      return e.hasDuration(n, i, a);\n    },\n    calculateEndDate: function (n, i, a, r) {\n      return e.calculateEndDate(n, i, a, r);\n    },\n    mergeCalendars: R(t.mergeCalendars, t),\n    createCalendar: R(t.createCalendar, t),\n    addCalendar: R(t.addCalendar, t),\n    getCalendar: R(t.getCalendar, t),\n    getCalendars: R(t.getCalendars, t),\n    getResourceCalendar: R(t.getResourceCalendar, t),\n    getTaskCalendar: R(t.getTaskCalendar, t),\n    deleteCalendar: R(t.deleteCalendar, t)\n  };\n};\nfunction $i(t) {\n  t.isUnscheduledTask = function (s) {\n    return t.assert(s && s instanceof Object, \"Invalid argument <b>task</b>=\" + s + \" of gantt.isUnscheduledTask. Task object was expected\"), !!s.unscheduled || !s.start_date;\n  }, t._isAllowedUnscheduledTask = function (s) {\n    return !(!s.unscheduled || !t.config.show_unscheduled);\n  }, t._isTaskInTimelineLimits = function (s) {\n    var o = s.start_date ? s.start_date.valueOf() : null,\n      l = s.end_date ? s.end_date.valueOf() : null;\n    return !!(o && l && o <= this._max_date.valueOf() && l >= this._min_date.valueOf());\n  }, t.isTaskVisible = function (s) {\n    if (!this.isTaskExists(s)) return !1;\n    var o = this.getTask(s);\n    return !(!this._isAllowedUnscheduledTask(o) && !this._isTaskInTimelineLimits(o)) && this.getGlobalTaskIndex(s) >= 0;\n  }, t._getProjectEnd = function () {\n    if (t.config.project_end) return t.config.project_end;\n    var s = t.getTaskByTime();\n    return (s = s.sort(function (o, l) {\n      return +o.end_date > +l.end_date ? 1 : -1;\n    })).length ? s[s.length - 1].end_date : null;\n  }, t._getProjectStart = function () {\n    if (t.config.project_start) return t.config.project_start;\n    if (t.config.start_date) return t.config.start_date;\n    if (t.getState().min_date) return t.getState().min_date;\n    var s = t.getTaskByTime();\n    return (s = s.sort(function (o, l) {\n      return +o.start_date > +l.start_date ? 1 : -1;\n    })).length ? s[0].start_date : null;\n  };\n  var e = function (s, o) {\n    var l = !!(o && o != t.config.root_id && t.isTaskExists(o)) && t.getTask(o),\n      c = null;\n    if (l) {\n      if (t.config.schedule_from_end) c = t.calculateEndDate({\n        start_date: l.end_date,\n        duration: -t.config.duration_step,\n        task: s\n      });else {\n        if (!l.start_date) return e(l, t.getParent(l));\n        c = l.start_date;\n      }\n    } else if (t.config.schedule_from_end) c = t.calculateEndDate({\n      start_date: t._getProjectEnd(),\n      duration: -t.config.duration_step,\n      task: s\n    });else {\n      const d = t.getTaskByIndex(0),\n        u = t.config.start_date || t.getState().min_date;\n      c = d ? d.start_date ? d.start_date : d.end_date ? t.calculateEndDate({\n        start_date: d.end_date,\n        duration: -t.config.duration_step,\n        task: s\n      }) : u : u;\n    }\n    return t.assert(c, \"Invalid dates\"), new Date(c);\n  };\n  t._set_default_task_timing = function (s) {\n    s.start_date = s.start_date || e(s, t.getParent(s)), s.duration = s.duration || t.config.duration_step, s.end_date = s.end_date || t.calculateEndDate(s);\n  }, t.createTask = function (s, o, l) {\n    if (s = s || {}, t.defined(s.id) || (s.id = t.uid()), s.start_date || (s.start_date = e(s, o)), s.text === void 0 && (s.text = t.locale.labels.new_task), s.duration === void 0 && (s.duration = 1), this.isTaskExists(o)) {\n      this.setParent(s, o, !0);\n      var c = this.getTask(o);\n      c.$open = !0, this.config.details_on_create || this.callEvent(\"onAfterParentExpand\", [o, c]);\n    }\n    return this.callEvent(\"onTaskCreated\", [s]) ? (this.config.details_on_create ? (t.isTaskExists(s.id) ? t.getTask(s.id).$index != s.$index && (s.start_date && typeof s.start_date == \"string\" && (s.start_date = this.date.parseDate(s.start_date, \"parse_date\")), s.end_date && typeof s.end_date == \"string\" && (s.end_date = this.date.parseDate(s.end_date, \"parse_date\")), this.$data.tasksStore.updateItem(s.id, s)) : (s.$new = !0, this.silent(function () {\n      t.$data.tasksStore.addItem(s, l);\n    })), this.selectTask(s.id), this.refreshData(), this.showLightbox(s.id)) : this.addTask(s, o, l) && (this.showTask(s.id), this.selectTask(s.id)), s.id) : null;\n  }, t._update_flags = function (s, o) {\n    var l = t.$data.tasksStore;\n    s === void 0 ? (this._lightbox_id = null, l.silent(function () {\n      l.unselect();\n    }), this.getSelectedTasks && this._multiselect.reset(), this._tasks_dnd && this._tasks_dnd.drag && (this._tasks_dnd.drag.id = null)) : (this._lightbox_id == s && (this._lightbox_id = o), l.getSelectedId() == s && l.silent(function () {\n      l.unselect(s), l.select(o);\n    }), this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == s && (this._tasks_dnd.drag.id = o));\n  };\n  var n = function (s, o) {\n    var l = t.getTaskType(s.type),\n      c = {\n        type: l,\n        $no_start: !1,\n        $no_end: !1,\n        scheduled_summary: !1\n      };\n    return l === t.config.types.project && s.auto_scheduling === !1 && (c.scheduled_summary = !0), o || l != s.$rendered_type ? (l == t.config.types.project ? c.$no_end = c.$no_start = !0 : l != t.config.types.milestone && (c.$no_end = !(s.end_date || s.duration), c.$no_start = !s.start_date, t._isAllowedUnscheduledTask(s) && (c.$no_end = c.$no_start = !1)), c) : (c.$no_start = s.$no_start, c.$no_end = s.$no_end, c);\n  };\n  function i(s) {\n    s.$effective_calendar = t.getTaskCalendar(s).id, s.start_date = t.getClosestWorkTime({\n      dir: \"future\",\n      date: s.start_date,\n      unit: t.config.duration_unit,\n      task: s\n    }), s.end_date = t.calculateEndDate(s);\n  }\n  function a(s, o, l, c) {\n    const d = {\n        start: \"start_date\",\n        end: \"end_date\"\n      },\n      u = {\n        start: \"$auto_start_date\",\n        end: \"$auto_end_date\"\n      };\n    let h;\n    h = s.type === t.config.types.project && s.auto_scheduling === !1 ? u : d, o.$no_start && (s[h.start] = l ? new Date(l) : e(s, this.getParent(s))), o.$no_end && (s[h.end] = c ? new Date(c) : this.calculateEndDate({\n      start_date: s[h.start],\n      duration: this.config.duration_step,\n      task: s\n    })), (o.$no_start || o.$no_end) && this._init_task_timing(s);\n  }\n  function r(s) {\n    var o = null,\n      l = null,\n      c = s !== void 0 ? s : t.config.root_id,\n      d = [];\n    return t.eachTask(function (u) {\n      const h = t.getTaskType(u.type) == t.config.types.project && u.auto_scheduling === !1;\n      t.getTaskType(u.type) == t.config.types.project && !h || t.isUnscheduledTask(u) || (u.rollup && d.push(u.id), !u.start_date || u.$no_start && !h || o && !(o > u.start_date.valueOf()) || (o = u.start_date.valueOf()), !u.end_date || u.$no_end && !h || l && !(l < u.end_date.valueOf()) || (l = u.end_date.valueOf()));\n    }, c), {\n      start_date: o ? new Date(o) : null,\n      end_date: l ? new Date(l) : null,\n      rollup: d\n    };\n  }\n  t._init_task_timing = function (s) {\n    var o = n(s, !0),\n      l = s.$rendered_type != o.type,\n      c = o.type;\n    l && (s.$no_start = o.$no_start, s.$no_end = o.$no_end, s.$rendered_type = o.type), l && c != this.config.types.milestone && c == this.config.types.project && (this._set_default_task_timing(s), s.$calculate_duration = !1), c == this.config.types.milestone && (s.end_date = s.start_date), s.start_date && s.end_date && s.$calculate_duration !== !1 && (s.duration = this.calculateDuration(s)), s.$calculate_duration || (s.$calculate_duration = !0), s.end_date || (s.end_date = s.start_date), s.duration = s.duration || 0, this.config.min_duration === 0 && s.duration === 0 && (s.$no_end = !1, s.type === t.config.types.project && t.hasChild(s.id) && (s.$no_end = !0));\n    var d = this.getTaskCalendar(s);\n    s.$effective_calendar && s.$effective_calendar !== d.id && (i(s), this.config.inherit_calendar && this.isSummaryTask(s) && this.eachTask(function (u) {\n      i(u);\n    }, s.id)), s.$effective_calendar = d.id;\n  }, t.isSummaryTask = function (s) {\n    t.assert(s && s instanceof Object, \"Invalid argument <b>task</b>=\" + s + \" of gantt.isSummaryTask. Task object was expected\");\n    var o = n(s);\n    return !(!o.$no_end && !o.$no_start);\n  }, t.resetProjectDates = function (s) {\n    var o = n(s);\n    if (o.$no_end || o.$no_start) {\n      var l = r(s.id);\n      a.call(this, s, o, l.start_date, l.end_date), s.$rollup = l.rollup;\n    }\n  }, t.getSubtaskDuration = function (s) {\n    var o = 0,\n      l = s !== void 0 ? s : t.config.root_id;\n    return this.eachTask(function (c) {\n      this.getTaskType(c.type) == t.config.types.project || this.isUnscheduledTask(c) || (o += c.duration);\n    }, l), o;\n  }, t.getSubtaskDates = function (s) {\n    var o = r(s);\n    return {\n      start_date: o.start_date,\n      end_date: o.end_date\n    };\n  }, t._update_parents = function (s, o, l) {\n    if (s) {\n      var c = this.getTask(s);\n      c.rollup && (l = !0);\n      var d = this.getParent(c),\n        u = n(c),\n        h = !0;\n      if (l || c.start_date && c.end_date && (u.$no_start || u.$no_end)) {\n        const y = c.$auto_start_date ? \"$auto_start_date\" : \"start_date\",\n          k = c.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\n        var _ = c[y].valueOf(),\n          p = c[k].valueOf();\n        t.resetProjectDates(c), l || _ != c[y].valueOf() || p != c[k].valueOf() || (h = !1), h && !o && this.refreshTask(c.id, !0), u.scheduled_summary && (h = !0);\n      }\n      h && d && this.isTaskExists(d) && this._update_parents(d, o, l);\n    }\n  }, t.roundDate = function (s) {\n    var o = t.getScale();\n    Q(s) && (s = {\n      date: s,\n      unit: o ? o.unit : t.config.duration_unit,\n      step: o ? o.step : t.config.duration_step\n    });\n    var l,\n      c,\n      d,\n      u = s.date,\n      h = s.step,\n      _ = s.unit;\n    if (!o) return u;\n    if (_ == o.unit && h == o.step && +u >= +o.min_date && +u <= +o.max_date) d = Math.floor(t.columnIndexByDate(u)), o.trace_x[d] || (d -= 1, o.rtl && (d = 0)), c = new Date(o.trace_x[d]), l = t.date.add(c, h, _);else {\n      for (d = Math.floor(t.columnIndexByDate(u)), l = t.date[_ + \"_start\"](new Date(o.min_date)), o.trace_x[d] && (l = t.date[_ + \"_start\"](o.trace_x[d])); +l < +u;) {\n        var p = (l = t.date[_ + \"_start\"](t.date.add(l, h, _))).getTimezoneOffset();\n        l = t._correct_dst_change(l, p, l, _), t.date[_ + \"_start\"] && (l = t.date[_ + \"_start\"](l));\n      }\n      c = t.date.add(l, -1 * h, _);\n    }\n    return s.dir && s.dir == \"future\" ? l : s.dir && s.dir == \"past\" || Math.abs(u - c) < Math.abs(l - u) ? c : l;\n  }, t.correctTaskWorkTime = function (s) {\n    t.config.work_time && t.config.correct_work_time && (this.isWorkTime(s.start_date, void 0, s) ? this.isWorkTime(new Date(+s.end_date - 1), void 0, s) || (s.end_date = this.calculateEndDate(s)) : (s.start_date = this.getClosestWorkTime({\n      date: s.start_date,\n      dir: \"future\",\n      task: s\n    }), s.end_date = this.calculateEndDate(s)));\n  }, t.attachEvent(\"onBeforeTaskUpdate\", function (s, o) {\n    return t._init_task_timing(o), !0;\n  }), t.attachEvent(\"onBeforeTaskAdd\", function (s, o) {\n    return t._init_task_timing(o), !0;\n  }), t.attachEvent(\"onAfterTaskMove\", function (s, o, l) {\n    return t._init_task_timing(t.getTask(s)), !0;\n  });\n}\nfunction Oe(t, e) {\n  var n,\n    i = t.config.container_resize_timeout || 20;\n  let a = Be(t);\n  if (t.config.container_resize_method == \"timeout\") l();else try {\n    t.event(e, \"resize\", function () {\n      if (t.$scrollbarRepaint) t.$scrollbarRepaint = null;else {\n        let c = Be(t);\n        if (a.x == c.x && a.y == c.y) return;\n        a = c, r();\n      }\n    });\n  } catch {\n    l();\n  }\n  function r() {\n    clearTimeout(n), n = setTimeout(function () {\n      t.$destroyed || t.render();\n    }, i);\n  }\n  var s = t.$root.offsetHeight,\n    o = t.$root.offsetWidth;\n  function l() {\n    t.$root.offsetHeight == s && t.$root.offsetWidth == o || r(), s = t.$root.offsetHeight, o = t.$root.offsetWidth, setTimeout(l, i);\n  }\n}\nfunction Be(t) {\n  return {\n    x: t.$root.offsetWidth,\n    y: t.$root.offsetHeight\n  };\n}\nfunction wi(t) {\n  t.assert = /* @__PURE__ */function (r) {\n    return function (s, o) {\n      s || r.config.show_errors && r.callEvent(\"onError\", [o]) !== !1 && (r.message ? r.message({\n        type: \"error\",\n        text: o,\n        expire: -1\n      }) : console.log(o));\n    };\n  }(t);\n  var e = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\n  function n(r) {\n    if (!r || typeof r == \"string\" && document.getElementById(r) || function (s) {\n      try {\n        s.cloneNode(!1);\n      } catch {\n        return !1;\n      }\n      return !0;\n    }(r)) return !0;\n    throw t.assert(!1, e), new Error(e);\n  }\n  t.init = function (r, s, o) {\n    t.env.isNode ? r = null : n(r), s && o && (this.config.start_date = this._min_date = new Date(s), this.config.end_date = this._max_date = new Date(o)), this.date.init(), this.init = function (l) {\n      t.env.isNode ? l = null : n(l), this.$container && this.$container.parentNode && (this.$container.parentNode.removeChild(this.$container), this.$container = null), this.$layout && this.$layout.clear(), this._reinit(l);\n    }, this._reinit(r);\n  }, t._quickRefresh = function (r) {\n    for (var s = this._getDatastores.call(this), o = 0; o < s.length; o++) s[o]._quick_refresh = !0;\n    for (r(), o = 0; o < s.length; o++) s[o]._quick_refresh = !1;\n  };\n  var i = function () {\n      this._clearTaskLayers && this._clearTaskLayers(), this._clearLinkLayers && this._clearLinkLayers(), this.$layout && (this.$layout.destructor(), this.$layout = null, this.$ui.reset());\n    }.bind(t),\n    a = function () {\n      F(t) || (this.$root.innerHTML = \"\", this.$root.gantt = this, me(this), this.config.layout.id = \"main\", this.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout), this.$layout.attachEvent(\"onBeforeResize\", function () {\n        for (var r = t.$services.getService(\"datastores\"), s = 0; s < r.length; s++) t.getDatastore(r[s]).filter(), t.$data.tasksStore._skipTaskRecalculation ? t.$data.tasksStore._skipTaskRecalculation != \"lightbox\" && (t.$data.tasksStore._skipTaskRecalculation = !1) : t.getDatastore(r[s]).callEvent(\"onBeforeRefreshAll\", []);\n      }), this.$layout.attachEvent(\"onResize\", function () {\n        t._quickRefresh(function () {\n          t.refreshData();\n        });\n      }), this.callEvent(\"onGanttLayoutReady\", []), this.$layout.render(), this.$container = this.$layout.$container.firstChild, function (r) {\n        window.getComputedStyle(r.$root).getPropertyValue(\"position\") == \"static\" && (r.$root.style.position = \"relative\");\n        var s = document.createElement(\"iframe\");\n        s.className = \"gantt_container_resize_watcher\", s.tabIndex = -1, r.config.wai_aria_attributes && (s.setAttribute(\"role\", \"none\"), s.setAttribute(\"aria-hidden\", !0)), r.env.isSalesforce && (r.config.container_resize_method = \"timeout\"), r.$root.appendChild(s), s.contentWindow ? Oe(r, s.contentWindow) : (r.$root.removeChild(s), Oe(r, window));\n      }(this));\n    }.bind(t);\n  t.resetLayout = function () {\n    i(), a(), this.render();\n  }, t._reinit = function (r) {\n    this.callEvent(\"onBeforeGanttReady\", []), this._update_flags(), this.$services.getService(\"templateLoader\").initTemplates(this), i(), this.$root = null, r && (this.$root = we(r), a(), this.$mouseEvents.reset(this.$root), function (s) {\n      s.$container && !s.config.autosize && s.$root.offsetHeight < 50 && console.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\n    }(t)), this.callEvent(\"onTemplatesReady\", []), this.callEvent(\"onGanttReady\", []), this.render();\n  }, t.$click = {\n    buttons: {\n      edit: function (r) {\n        t.isReadonly(t.getTask(r)) || t.showLightbox(r);\n      },\n      delete: function (r) {\n        var s = t.getTask(r);\n        if (!t.isReadonly(s)) {\n          var o = t.locale.labels.confirm_deleting,\n            l = t.locale.labels.confirm_deleting_title;\n          t._delete_task_confirm({\n            task: s,\n            message: o,\n            title: l,\n            callback: function () {\n              t.isTaskExists(r) && (s.$new ? (t.$data.tasksStore._skipTaskRecalculation = \"lightbox\", t.silent(function () {\n                t.deleteTask(r, !0);\n              }), t.$data.tasksStore._skipTaskRecalculation = !1, t.refreshData()) : (t.$data.tasksStore._skipTaskRecalculation = !0, t.deleteTask(r))), t.hideLightbox();\n            }\n          });\n        }\n      }\n    }\n  }, t.render = function () {\n    var r;\n    if (this.callEvent(\"onBeforeGanttRender\", []), !F(t)) {\n      !this.config.sort && this._sort && (this._sort = void 0), this.$root && (this.config.rtl ? (this.$root.classList.add(\"gantt_rtl\"), this.$root.firstChild.classList.add(\"gantt_rtl\")) : (this.$root.classList.remove(\"gantt_rtl\"), this.$root.firstChild.classList.remove(\"gantt_rtl\")));\n      var s = this.getScrollState(),\n        o = s ? s.x : 0;\n      this._getHorizontalScrollbar() && (o = this._getHorizontalScrollbar().$config.codeScrollLeft || o || 0), r = null, o && (r = t.dateFromPos(o + this.config.task_scroll_offset));\n    }\n    if (me(this), F(t)) t.refreshData();else {\n      this.$layout.$config.autosize = this.config.autosize;\n      var l = this.config.preserve_scroll;\n      if (this.config.preserve_scroll = !1, this.$layout.resize(), this.config.preserve_scroll = l, this.config.preserve_scroll && s) {\n        if (o || s.y) {\n          var c = t.getScrollState();\n          if (+r != +t.dateFromPos(c.x) || c.y != s.y) {\n            o = null;\n            var d = null;\n            r && (o = Math.max(t.posFromDate(r) - t.config.task_scroll_offset, 0)), s.y && (d = s.y), t.scrollTo(o, d);\n          }\n        }\n        this.$layout.getScrollbarsInfo().forEach(u => {\n          const h = t.$ui.getView(u.id),\n            _ = t.utils.dom.isChildOf(h.$view, t.$container);\n          u.boundViews.forEach(p => {\n            const y = t.$ui.getView(p);\n            u.y && u.y != s.y && y && !_ && y.scrollTo(void 0, 0), u.x_pos && u.x_pos != s.x && y && _ && y.scrollTo(u.x_pos, void 0);\n          });\n        });\n      }\n    }\n    this.callEvent(\"onGanttRender\", []);\n  }, t.setSizes = t.render, t.getTaskRowNode = function (r) {\n    for (var s = this.$grid_data.childNodes, o = this.config.task_attribute, l = 0; l < s.length; l++) if (s[l].getAttribute && s[l].getAttribute(o) == r) return s[l];\n    return null;\n  }, t.changeLightboxType = function (r) {\n    if (this.getLightboxType() == r) return !0;\n    t._silent_redraw_lightbox(r);\n  }, t._get_link_type = function (r, s) {\n    var o = null;\n    return r && s ? o = t.config.links.start_to_start : !r && s ? o = t.config.links.finish_to_start : r || s ? r && !s && (o = t.config.links.start_to_finish) : o = t.config.links.finish_to_finish, o;\n  }, t.isLinkAllowed = function (r, s, o, l) {\n    var c = null;\n    if (!(c = typeof r == \"object\" ? r : {\n      source: r,\n      target: s,\n      type: this._get_link_type(o, l)\n    }) || !(c.source && c.target && c.type) || c.source == c.target) return !1;\n    var d = !0;\n    return this.checkEvent(\"onLinkValidation\") && (d = this.callEvent(\"onLinkValidation\", [c])), d;\n  }, t._correct_dst_change = function (r, s, o, l) {\n    var c = Vt(l) * o;\n    if (c > 3600 && c < 86400) {\n      var d = r.getTimezoneOffset() - s;\n      d && (r = t.date.add(r, d, \"minute\"));\n    }\n    return r;\n  }, t.isSplitTask = function (r) {\n    return t.assert(r && r instanceof Object, \"Invalid argument <b>task</b>=\" + r + \" of gantt.isSplitTask. Task object was expected\"), this.$data.tasksStore._isSplitItem(r);\n  }, t._is_icon_open_click = function (r) {\n    if (!r) return !1;\n    var s = r.target || r.srcElement;\n    if (!s || !s.className) return !1;\n    var o = X(s);\n    return o.indexOf(\"gantt_tree_icon\") !== -1 && (o.indexOf(\"gantt_close\") !== -1 || o.indexOf(\"gantt_open\") !== -1);\n  };\n}\nconst Si = {\n    date: {\n      month_full: [\" \", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \" \", \" \", \" \"],\n      month_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"  ,   \",\n      confirm_deleting: \"       \",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ti = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"   , ?\",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"\",\n      column_text: \"\",\n      column_start_date: \"\",\n      column_duration: \"\",\n      column_add: \"\",\n      link: \"\",\n      confirm_link_deleting: \" \",\n      link_start: \"()\",\n      link_end: \"()\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"ii\",\n      hours: \"i\",\n      days: \"\",\n      weeks: \"\",\n      months: \"\",\n      years: \"\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ei = {\n    date: {\n      month_full: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n      month_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n      day_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n      day_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n    },\n    labels: {\n      new_task: \"Nova tasca\",\n      icon_save: \"Guardar\",\n      icon_cancel: \"Cancellar\",\n      icon_details: \"Detalls\",\n      icon_edit: \"Editar\",\n      icon_delete: \"Esborrar\",\n      confirm_closing: \"\",\n      confirm_deleting: \"L'esdeveniment s'esborrar definitivament, continuar ?\",\n      section_description: \"Descripci\",\n      section_time: \"Periode de temps\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Cancellar\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ci = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \"\",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"!\",\n      confirm_deleting: \"?\",\n      section_description: \"\",\n      section_time: \"\",\n      section_type: \"\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"\",\n      column_text: \"\",\n      column_start_date: \"\",\n      column_duration: \"\",\n      column_add: \"\",\n      link: \"\",\n      confirm_link_deleting: \"\",\n      link_start: \" ()\",\n      link_end: \" ()\",\n      type_task: \"\",\n      type_project: \"\",\n      type_milestone: \"\",\n      minutes: \"\",\n      hours: \"\",\n      days: \"\",\n      weeks: \"\",\n      months: \"\",\n      years: \"\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Di = {\n    date: {\n      month_full: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\n      month_short: [\"Led\", \"n\", \"Be\", \"Dub\", \"Kv\", \"er\", \"ec\", \"Srp\", \"Z\", \"j\", \"List\", \"Pro\"],\n      day_full: [\"Nedle\", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"],\n      day_short: [\"Ne\", \"Po\", \"t\", \"St\", \"t\", \"P\", \"So\"]\n    },\n    labels: {\n      new_task: \"Nov prce\",\n      icon_save: \"Uloit\",\n      icon_cancel: \"Zpt\",\n      icon_details: \"Detail\",\n      icon_edit: \"Edituj\",\n      icon_delete: \"Smazat\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Udlost bude trvale smazna, opravdu?\",\n      section_description: \"Poznmky\",\n      section_time: \"Doba platnosti\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Zpt\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ai = {\n    date: {\n      month_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n      day_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n    },\n    labels: {\n      new_task: \"Ny opgave\",\n      icon_save: \"Gem\",\n      icon_cancel: \"Fortryd\",\n      icon_details: \"Detaljer\",\n      icon_edit: \"Tilret\",\n      icon_delete: \"Slet\",\n      confirm_closing: \"Dine rettelser vil g tabt.. Er dy sikker?\",\n      confirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n      section_description: \"Beskrivelse\",\n      section_time: \"Tidsperiode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Fortryd\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ii = {\n    date: {\n      month_full: [\" Januar\", \" Februar\", \" Mrz \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n      month_short: [\"Jan\", \"Feb\", \"Mr\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n      day_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n      day_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n    },\n    labels: {\n      new_task: \"Neue Aufgabe\",\n      icon_save: \"Speichern\",\n      icon_cancel: \"Abbrechen\",\n      icon_details: \"Details\",\n      icon_edit: \"ndern\",\n      icon_delete: \"Lschen\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Der Eintrag wird gelscht\",\n      section_description: \"Beschreibung\",\n      section_time: \"Zeitspanne\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"PSP\",\n      column_text: \"Task-Namen\",\n      column_start_date: \"Startzeit\",\n      column_duration: \"Dauer\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"werden gelscht\",\n      link_start: \"(starten)\",\n      link_end: \"(ende)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minuten\",\n      hours: \"Stunden\",\n      days: \"Tage\",\n      weeks: \"Wochen\",\n      months: \"Monate\",\n      years: \"Jahre\",\n      message_ok: \"OK\",\n      message_cancel: \"Abbrechen\",\n      section_constraint: \"Regel\",\n      constraint_type: \"Regel\",\n      constraint_date: \"Regel - Datum\",\n      asap: \"So bald wie mglich\",\n      alap: \"So spt wie mglich\",\n      snet: \"Beginn nicht vor\",\n      snlt: \"Beginn nicht spter als\",\n      fnet: \"Fertigstellung nicht vor\",\n      fnlt: \"Fertigstellung nicht spter als\",\n      mso: \"Muss beginnen am\",\n      mfo: \"Muss fertig sein am\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Mi = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"    .   ;\",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ni = {\n    date: {\n      month_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n      day_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n      day_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n    },\n    labels: {\n      new_task: \"New task\",\n      icon_save: \"Save\",\n      icon_cancel: \"Cancel\",\n      icon_details: \"Details\",\n      icon_edit: \"Edit\",\n      icon_delete: \"Delete\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Task will be deleted permanently, are you sure?\",\n      section_description: \"Description\",\n      section_time: \"Time period\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Cancel\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Li = {\n    date: {\n      month_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n      month_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n      day_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jueves\", \"Viernes\", \"Sbado\"],\n      day_short: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"]\n    },\n    labels: {\n      new_task: \"Nueva tarea\",\n      icon_save: \"Guardar\",\n      icon_cancel: \"Cancelar\",\n      icon_details: \"Detalles\",\n      icon_edit: \"Editar\",\n      icon_delete: \"Eliminar\",\n      confirm_closing: \"\",\n      confirm_deleting: \"El evento se borrar definitivamente, continuar?\",\n      section_description: \"Descripcin\",\n      section_time: \"Perodo\",\n      section_type: \"Tipo\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"EDT\",\n      column_text: \"Tarea\",\n      column_start_date: \"Inicio\",\n      column_duration: \"Duracin\",\n      column_add: \"\",\n      link: \"Enlace\",\n      confirm_link_deleting: \"ser borrada\",\n      link_start: \" (inicio)\",\n      link_end: \" (fin)\",\n      type_task: \"Tarea\",\n      type_project: \"Proyecto\",\n      type_milestone: \"Hito\",\n      minutes: \"Minutos\",\n      hours: \"Horas\",\n      days: \"Das\",\n      weeks: \"Semanas\",\n      months: \"Meses\",\n      years: \"Aos\",\n      message_ok: \"OK\",\n      message_cancel: \"Cancelar\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Pi = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"       \",\n      confirm_deleting: \"         \",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"\",\n      column_start_date: \" \",\n      column_duration: \"\",\n      column_add: \"\",\n      link: \"\",\n      confirm_link_deleting: \"  \",\n      link_start: \" ()\",\n      link_end: \" ()\",\n      type_task: \"\",\n      type_project: \"\",\n      type_milestone: \"\",\n      minutes: \"\",\n      hours: \"\",\n      days: \"\",\n      weeks: \"\",\n      months: \"\",\n      years: \"\",\n      message_ok: \"\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ri = {\n    date: {\n      month_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n      month_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n      day_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n      day_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n    },\n    labels: {\n      new_task: \"Uusi tehtv\",\n      icon_save: \"Tallenna\",\n      icon_cancel: \"Peru\",\n      icon_details: \"Tiedot\",\n      icon_edit: \"Muokkaa\",\n      icon_delete: \"Poista\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n      section_description: \"Kuvaus\",\n      section_time: \"Aikajakso\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Peru\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Hi = {\n    date: {\n      month_full: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\n      month_short: [\"Jan\", \"Fv\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Ao\", \"Sep\", \"Oct\", \"Nov\", \"Dc\"],\n      day_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n      day_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n    },\n    labels: {\n      new_task: \"Nouvelle tche\",\n      icon_save: \"Enregistrer\",\n      icon_cancel: \"Annuler\",\n      icon_details: \"Dtails\",\n      icon_edit: \"Modifier\",\n      icon_delete: \"Effacer\",\n      confirm_closing: \"\",\n      confirm_deleting: \"L'vnement sera effac sans appel, tes-vous sr ?\",\n      section_description: \"Description\",\n      section_time: \"Priode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"OTP\",\n      column_text: \"Nom de la tche\",\n      column_start_date: \"Date initiale\",\n      column_duration: \"Dure\",\n      column_add: \"\",\n      link: \"Le lien\",\n      confirm_link_deleting: \"sera supprim\",\n      link_start: \"(dbut)\",\n      link_end: \"(fin)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Heures\",\n      days: \"Jours\",\n      weeks: \"Semaines\",\n      months: \"Mois\",\n      years: \"Annes\",\n      message_ok: \"OK\",\n      message_cancel: \"Annuler\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Oi = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"  .?\",\n      section_description: \"\",\n      section_time: \"\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Bi = {\n    date: {\n      month_full: [\"Sijeanj\", \"Veljaa\", \"Oujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\n      month_short: [\"Sij\", \"Velj\", \"Ou\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\n      day_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"etvrtak\", \"Petak\", \"Subota\"],\n      day_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"et\", \"Pet\", \"Sub\"]\n    },\n    labels: {\n      new_task: \"Novi Zadatak\",\n      icon_save: \"Spremi\",\n      icon_cancel: \"Odustani\",\n      icon_details: \"Detalji\",\n      icon_edit: \"Izmjeni\",\n      icon_delete: \"Obrii\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Zadatak e biti trajno izbrisan, jeste li sigurni?\",\n      section_description: \"Opis\",\n      section_time: \"Vremenski Period\",\n      section_type: \"Tip\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Naziv Zadatka\",\n      column_start_date: \"Poetno Vrijeme\",\n      column_duration: \"Trajanje\",\n      column_add: \"\",\n      link: \"Poveznica\",\n      confirm_link_deleting: \"e biti izbrisan\",\n      link_start: \" (poetak)\",\n      link_end: \" (kraj)\",\n      type_task: \"Zadatak\",\n      type_project: \"Projekt\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minute\",\n      hours: \"Sati\",\n      days: \"Dani\",\n      weeks: \"Tjedni\",\n      months: \"Mjeseci\",\n      years: \"Godine\",\n      message_ok: \"OK\",\n      message_cancel: \"Odustani\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  zi = {\n    date: {\n      month_full: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mr\", \"pr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"szombat\"],\n      day_short: [\"Va\", \"H\", \"Ke\", \"Sze\", \"Cs\", \"P\", \"Szo\"]\n    },\n    labels: {\n      new_task: \"j feladat\",\n      icon_save: \"Ments\",\n      icon_cancel: \"Mgse\",\n      icon_details: \"Rszletek\",\n      icon_edit: \"Szerkeszts\",\n      icon_delete: \"Trls\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Az esemny trlve lesz, biztosan folytatja?\",\n      section_description: \"Lers\",\n      section_time: \"Idszak\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Mgse\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Wi = {\n    date: {\n      month_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n      day_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n      day_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n    },\n    labels: {\n      new_task: \"Tugas baru\",\n      icon_save: \"Simpan\",\n      icon_cancel: \"Batal\",\n      icon_details: \"Detail\",\n      icon_edit: \"Edit\",\n      icon_delete: \"Hapus\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Acara akan dihapus\",\n      section_description: \"Keterangan\",\n      section_time: \"Periode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Batal\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  ji = {\n    date: {\n      month_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n      month_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n      day_full: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Gioved\", \"Venerd\", \"Sabato\"],\n      day_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n    },\n    labels: {\n      new_task: \"Nuovo compito\",\n      icon_save: \"Salva\",\n      icon_cancel: \"Chiudi\",\n      icon_details: \"Dettagli\",\n      icon_edit: \"Modifica\",\n      icon_delete: \"Elimina\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\n      section_description: \"Descrizione\",\n      section_time: \"Periodo di tempo\",\n      section_type: \"Tipo\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Nome Attivit\",\n      column_start_date: \"Inizio\",\n      column_duration: \"Durata\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"sar eliminato\",\n      link_start: \" (inizio)\",\n      link_end: \" (fine)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minuti\",\n      hours: \"Ore\",\n      days: \"Giorni\",\n      weeks: \"Settimane\",\n      months: \"Mesi\",\n      years: \"Anni\",\n      message_ok: \"OK\",\n      message_cancel: \"Chiudi\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Fi = {\n    date: {\n      month_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      month_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \"\",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"\",\n      section_description: \"\",\n      section_time: \"\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Vi = {\n    date: {\n      month_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      month_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \" \",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \" ?\",\n      section_description: \"\",\n      section_time: \"\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"\",\n      column_start_date: \"\",\n      column_duration: \"\",\n      column_add: \"\",\n      link: \"\",\n      confirm_link_deleting: \" ?\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"\",\n      type_project: \"\",\n      type_milestone: \"\",\n      minutes: \"\",\n      hours: \"\",\n      days: \"\",\n      weeks: \"\",\n      months: \"\",\n      years: \"\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  };\nclass Ui {\n  constructor(e) {\n    this.addLocale = (n, i) => {\n      this._locales[n] = i;\n    }, this.getLocale = n => this._locales[n], this._locales = {};\n    for (const n in e) this._locales[n] = e[n];\n  }\n}\nconst qi = {\n    date: {\n      month_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n      day_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n      day_short: [\"Sn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n    },\n    labels: {\n      new_task: \"Ny oppgave\",\n      icon_save: \"Lagre\",\n      icon_cancel: \"Avbryt\",\n      icon_details: \"Detaljer\",\n      icon_edit: \"Rediger\",\n      icon_delete: \"Slett\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n      section_description: \"Beskrivelse\",\n      section_time: \"Tidsperiode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Avbryt\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Gi = {\n    date: {\n      month_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n      day_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n    },\n    labels: {\n      new_task: \"Nieuwe taak\",\n      icon_save: \"Opslaan\",\n      icon_cancel: \"Annuleren\",\n      icon_details: \"Details\",\n      icon_edit: \"Bewerken\",\n      icon_delete: \"Verwijderen\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n      section_description: \"Beschrijving\",\n      section_time: \"Tijd periode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Taak omschrijving\",\n      column_start_date: \"Startdatum\",\n      column_duration: \"Duur\",\n      column_add: \"\",\n      link: \"Koppeling\",\n      confirm_link_deleting: \"zal worden verwijderd\",\n      link_start: \" (start)\",\n      link_end: \" (eind)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"minuten\",\n      hours: \"uren\",\n      days: \"dagen\",\n      weeks: \"weken\",\n      months: \"maanden\",\n      years: \"jaren\",\n      message_ok: \"OK\",\n      message_cancel: \"Annuleren\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Yi = {\n    date: {\n      month_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n      day_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n      day_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n    },\n    labels: {\n      new_task: \"Ny oppgave\",\n      icon_save: \"Lagre\",\n      icon_cancel: \"Avbryt\",\n      icon_details: \"Detaljer\",\n      icon_edit: \"Endre\",\n      icon_delete: \"Slett\",\n      confirm_closing: \"Endringer blir ikke lagret, er du sikker?\",\n      confirm_deleting: \"Oppfringen vil bli slettet, er du sikker?\",\n      section_description: \"Beskrivelse\",\n      section_time: \"Tidsperiode\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Avbryt\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ji = {\n    date: {\n      month_full: [\"Stycze\", \"Luty\", \"Marzec\", \"Kwiecie\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpie\", \"Wrzesie\", \"Padziernik\", \"Listopad\", \"Grudzie\"],\n      month_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Pa\", \"Lis\", \"Gru\"],\n      day_full: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"],\n      day_short: [\"Nie\", \"Pon\", \"Wto\", \"ro\", \"Czw\", \"Pi\", \"Sob\"]\n    },\n    labels: {\n      new_task: \"Nowe zadanie\",\n      icon_save: \"Zapisz\",\n      icon_cancel: \"Anuluj\",\n      icon_details: \"Szczegy\",\n      icon_edit: \"Edytuj\",\n      icon_delete: \"Usu\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Zdarzenie zostanie usunite na zawsze, kontynuowa?\",\n      section_description: \"Opis\",\n      section_time: \"Okres czasu\",\n      section_type: \"Typ\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Nazwa zadania\",\n      column_start_date: \"Pocztek\",\n      column_duration: \"Czas trwania\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"zostanie usunity\",\n      link_start: \" (pocztek)\",\n      link_end: \" (koniec)\",\n      type_task: \"Zadanie\",\n      type_project: \"Projekt\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minuty\",\n      hours: \"Godziny\",\n      days: \"Dni\",\n      weeks: \"Tydzie\",\n      months: \"Miesice\",\n      years: \"Lata\",\n      message_ok: \"OK\",\n      message_cancel: \"Anuluj\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Ki = {\n    date: {\n      month_full: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n      month_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n      day_full: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"],\n      day_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n    },\n    labels: {\n      new_task: \"Nova tarefa\",\n      icon_save: \"Salvar\",\n      icon_cancel: \"Cancelar\",\n      icon_details: \"Detalhes\",\n      icon_edit: \"Editar\",\n      icon_delete: \"Excluir\",\n      confirm_closing: \"\",\n      confirm_deleting: \"As tarefas sero excluidas permanentemente, confirme?\",\n      section_description: \"Descrio\",\n      section_time: \"Perodo\",\n      section_type: \"Tipo\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"EAP\",\n      column_text: \"Nome tarefa\",\n      column_start_date: \"Data incio\",\n      column_duration: \"Durao\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"Ser excludo!\",\n      link_start: \" (incio)\",\n      link_end: \" (fim)\",\n      type_task: \"Task\",\n      type_project: \"Projeto\",\n      type_milestone: \"Marco\",\n      minutes: \"Minutos\",\n      hours: \"Horas\",\n      days: \"Dias\",\n      weeks: \"Semanas\",\n      months: \"Meses\",\n      years: \"Anos\",\n      message_ok: \"OK\",\n      message_cancel: \"Cancelar\",\n      section_constraint: \"Restrio\",\n      constraint_type: \"Tipo Restrio\",\n      constraint_date: \"Data restrio\",\n      asap: \"Mais breve possvel\",\n      alap: \"Mais tarde possvel\",\n      snet: \"No comear antes de\",\n      snlt: \"No comear depois de\",\n      fnet: \"No terminar antes de\",\n      fnlt: \"No terminar depois de\",\n      mso: \"Precisa comear em\",\n      mfo: \"Precisa terminar em\",\n      resources_filter_placeholder: \"Tipo de filtros\",\n      resources_filter_label: \"Ocultar vazios\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Xi = {\n    date: {\n      month_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n      month_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n      day_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n      day_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n    },\n    labels: {\n      new_task: \"Sarcina noua\",\n      icon_save: \"Salveaza\",\n      icon_cancel: \"Anuleaza\",\n      icon_details: \"Detalii\",\n      icon_edit: \"Editeaza\",\n      icon_delete: \"Sterge\",\n      confirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",\n      confirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\n      section_description: \"Descriere\",\n      section_time: \"Interval\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Anuleaza\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Zi = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"O\", \"\", \"\"],\n      month_short: [\"\", \"\", \"Ma\", \"A\", \"Ma\", \"\", \"\", \"A\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"   , ?\",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"\",\n      column_text: \"\",\n      column_start_date: \"\",\n      column_duration: \"\",\n      column_add: \"\",\n      link: \"\",\n      confirm_link_deleting: \" \",\n      link_start: \" ()\",\n      link_end: \" ()\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"\",\n      hours: \"\",\n      days: \"\",\n      weeks: \"\",\n      months: \"\",\n      years: \"\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"    \",\n      resources_filter_label: \"  \",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  Qi = {\n    date: {\n      month_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"],\n      day_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"et\", \"Pet\", \"Sob\"]\n    },\n    labels: {\n      new_task: \"Nova naloga\",\n      icon_save: \"Shrani\",\n      icon_cancel: \"Preklii\",\n      icon_details: \"Podrobnosti\",\n      icon_edit: \"Uredi\",\n      icon_delete: \"Izbrii\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Dogodek bo izbrisan. elite nadaljevati?\",\n      section_description: \"Opis\",\n      section_time: \"asovni okvir\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Preklii\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  ta = {\n    date: {\n      month_full: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"],\n      day_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"t\", \"Pi\", \"So\"]\n    },\n    labels: {\n      new_task: \"Nov loha\",\n      icon_save: \"Uloi\",\n      icon_cancel: \"Sp\",\n      icon_details: \"Detail\",\n      icon_edit: \"Edituj\",\n      icon_delete: \"Zmaza\",\n      confirm_closing: \"Vae zmeny nebud uloen. Skutone?\",\n      confirm_deleting: \"Udalos bude natrvalo vymazan. Skutone?\",\n      section_description: \"Poznmky\",\n      section_time: \"Doba platnosti\",\n      section_type: \"Type\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"Sp\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  ea = {\n    date: {\n      month_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n      month_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n      day_full: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n      day_short: [\"Sn\", \"Mn\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n    },\n    labels: {\n      new_task: \"Ny uppgift\",\n      icon_save: \"Spara\",\n      icon_cancel: \"Avbryt\",\n      icon_details: \"Detajer\",\n      icon_edit: \"ndra\",\n      icon_delete: \"Ta bort\",\n      confirm_closing: \"\",\n      confirm_deleting: \"r du sker p att du vill ta bort hndelsen permanent?\",\n      section_description: \"Beskrivning\",\n      section_time: \"Tid\",\n      section_type: \"Typ\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Uppgiftsnamn\",\n      column_start_date: \"Starttid\",\n      column_duration: \"Varaktighet\",\n      column_add: \"\",\n      link: \"Lnk\",\n      confirm_link_deleting: \"kommer tas bort\",\n      link_start: \" (start)\",\n      link_end: \" (slut)\",\n      type_task: \"Uppgift\",\n      type_project: \"Projekt\",\n      type_milestone: \"Milstolpe\",\n      minutes: \"Minuter\",\n      hours: \"Timmar\",\n      days: \"Dagar\",\n      weeks: \"Veckor\",\n      months: \"Mnader\",\n      years: \"r\",\n      message_ok: \"OK\",\n      message_cancel: \"Avbryt\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  na = {\n    date: {\n      month_full: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\n      month_short: [\"Oca\", \"ub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Au\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n      day_full: [\"Pazar\", \"Pazartesi\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"],\n      day_short: [\"Paz\", \"Pzt\", \"Sal\", \"ar\", \"Per\", \"Cum\", \"Cmt\"]\n    },\n    labels: {\n      new_task: \"Yeni grev\",\n      icon_save: \"Kaydet\",\n      icon_cancel: \"ptal\",\n      icon_details: \"Detaylar\",\n      icon_edit: \"Dzenle\",\n      icon_delete: \"Sil\",\n      confirm_closing: \"\",\n      confirm_deleting: \"Grev silinecek, emin misiniz?\",\n      section_description: \"Aklama\",\n      section_time: \"Zaman Aral\",\n      section_type: \"Tip\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Grev Ad\",\n      column_start_date: \"Balang\",\n      column_duration: \"Sre\",\n      column_add: \"\",\n      link: \"Balant\",\n      confirm_link_deleting: \"silinecek\",\n      link_start: \" (balang)\",\n      link_end: \" (biti)\",\n      type_task: \"Grev\",\n      type_project: \"Proje\",\n      type_milestone: \"Kilometreta\",\n      minutes: \"Dakika\",\n      hours: \"Saat\",\n      days: \"Gn\",\n      weeks: \"Hafta\",\n      months: \"Ay\",\n      years: \"Yl\",\n      message_ok: \"OK\",\n      message_cancel: \"ptal\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  },\n  ia = {\n    date: {\n      month_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      month_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n      day_full: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"],\n      day_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n    },\n    labels: {\n      new_task: \" \",\n      icon_save: \"\",\n      icon_cancel: \"\",\n      icon_details: \"\",\n      icon_edit: \"\",\n      icon_delete: \"\",\n      confirm_closing: \"\",\n      confirm_deleting: \"  .  ?\",\n      section_description: \"\",\n      section_time: \" \",\n      section_type: \"\",\n      section_deadline: \"Deadline\",\n      section_baselines: \"Baselines\",\n      column_wbs: \"WBS\",\n      column_text: \"Task name\",\n      column_start_date: \"Start time\",\n      column_duration: \"Duration\",\n      column_add: \"\",\n      link: \"Link\",\n      confirm_link_deleting: \"will be deleted\",\n      link_start: \" (start)\",\n      link_end: \" (end)\",\n      type_task: \"Task\",\n      type_project: \"Project\",\n      type_milestone: \"Milestone\",\n      minutes: \"Minutes\",\n      hours: \"Hours\",\n      days: \"Days\",\n      weeks: \"Week\",\n      months: \"Months\",\n      years: \"Years\",\n      message_ok: \"OK\",\n      message_cancel: \"\",\n      section_constraint: \"Constraint\",\n      constraint_type: \"Constraint type\",\n      constraint_date: \"Constraint date\",\n      asap: \"As Soon As Possible\",\n      alap: \"As Late As Possible\",\n      snet: \"Start No Earlier Than\",\n      snlt: \"Start No Later Than\",\n      fnet: \"Finish No Earlier Than\",\n      fnlt: \"Finish No Later Than\",\n      mso: \"Must Start On\",\n      mfo: \"Must Finish On\",\n      resources_filter_placeholder: \"type to filter\",\n      resources_filter_label: \"hide empty\",\n      empty_state_text_link: \"Click here\",\n      empty_state_text_description: \"to create your first task\",\n      baselines_section_placeholder: \"Start adding a new baseline\",\n      baselines_add_button: \"Add Baseline\",\n      baselines_remove_button: \"Remove\",\n      baselines_remove_all_button: \"Remove All\",\n      deadline_enable_button: \"Set\",\n      deadline_disable_button: \"Remove\"\n    }\n  };\nfunction aa() {\n  this.constants = Un, this.version = \"9.0.15\", this.license = \"gpl\", this.templates = {}, this.ext = {}, this.keys = {\n    edit_save: this.constants.KEY_CODES.ENTER,\n    edit_cancel: this.constants.KEY_CODES.ESC\n  };\n}\nfunction ra(t) {\n  var e = new aa(),\n    n = new qn(t),\n    i = {};\n  e.plugins = function (l) {\n    for (var c in l) if (l[c] && !i[c]) {\n      var d = n.getExtension(c);\n      d && (d(e), i[c] = !0);\n    }\n    return i;\n  }, e.$services = /* @__PURE__ */function () {\n    var l = {};\n    return {\n      services: {},\n      setService: function (c, d) {\n        l[c] = d;\n      },\n      getService: function (c) {\n        return l[c] ? l[c]() : null;\n      },\n      dropService: function (c) {\n        l[c] && delete l[c];\n      },\n      destructor: function () {\n        for (var c in l) if (l[c]) {\n          var d = l[c];\n          d && d.destructor && d.destructor();\n        }\n        l = null;\n      }\n    };\n  }(), e.config = {\n    layout: {\n      css: \"gantt_container\",\n      rows: [{\n        cols: [{\n          view: \"grid\",\n          scrollX: \"scrollHor\",\n          scrollY: \"scrollVer\"\n        }, {\n          resizer: !0,\n          width: 1\n        }, {\n          view: \"timeline\",\n          scrollX: \"scrollHor\",\n          scrollY: \"scrollVer\"\n        }, {\n          view: \"scrollbar\",\n          id: \"scrollVer\"\n        }]\n      }, {\n        view: \"scrollbar\",\n        id: \"scrollHor\",\n        height: 20\n      }]\n    },\n    links: {\n      finish_to_start: \"0\",\n      start_to_start: \"1\",\n      finish_to_finish: \"2\",\n      start_to_finish: \"3\"\n    },\n    types: {\n      task: \"task\",\n      project: \"project\",\n      milestone: \"milestone\"\n    },\n    auto_types: !1,\n    duration_unit: \"day\",\n    work_time: !1,\n    correct_work_time: !1,\n    skip_off_time: !1,\n    cascade_delete: !0,\n    autosize: !1,\n    autosize_min_width: 0,\n    autoscroll: !0,\n    autoscroll_speed: 30,\n    deepcopy_on_parse: !1,\n    show_links: !0,\n    show_task_cells: !0,\n    static_background: !1,\n    static_background_cells: !0,\n    branch_loading: !1,\n    branch_loading_property: \"$has_child\",\n    show_loading: !1,\n    show_chart: !0,\n    show_grid: !0,\n    min_duration: 36e5,\n    date_format: \"%d-%m-%Y %H:%i\",\n    xml_date: void 0,\n    start_on_monday: !0,\n    server_utc: !1,\n    show_progress: !0,\n    fit_tasks: !1,\n    select_task: !0,\n    scroll_on_click: !0,\n    smart_rendering: !0,\n    preserve_scroll: !0,\n    readonly: !1,\n    container_resize_timeout: 20,\n    deadlines: !0,\n    date_grid: \"%Y-%m-%d\",\n    drag_links: !0,\n    drag_progress: !0,\n    drag_resize: !0,\n    drag_project: !1,\n    drag_move: !0,\n    drag_mode: {\n      resize: \"resize\",\n      progress: \"progress\",\n      move: \"move\",\n      ignore: \"ignore\"\n    },\n    round_dnd_dates: !0,\n    link_wrapper_width: 20,\n    link_arrow_size: 12,\n    root_id: 0,\n    autofit: !1,\n    columns: [{\n      name: \"text\",\n      tree: !0,\n      width: \"*\",\n      resize: !0\n    }, {\n      name: \"start_date\",\n      align: \"center\",\n      resize: !0\n    }, {\n      name: \"duration\",\n      align: \"center\"\n    }, {\n      name: \"add\",\n      width: 44\n    }],\n    scale_offset_minimal: !0,\n    inherit_scale_class: !1,\n    scales: [{\n      unit: \"day\",\n      step: 1,\n      date: \"%d %M\"\n    }],\n    time_step: 60,\n    duration_step: 1,\n    task_date: \"%d %F %Y\",\n    time_picker: \"%H:%i\",\n    task_attribute: \"data-task-id\",\n    link_attribute: \"data-link-id\",\n    layer_attribute: \"data-layer\",\n    buttons_left: [\"gantt_save_btn\", \"gantt_cancel_btn\"],\n    _migrate_buttons: {\n      dhx_save_btn: \"gantt_save_btn\",\n      dhx_cancel_btn: \"gantt_cancel_btn\",\n      dhx_delete_btn: \"gantt_delete_btn\"\n    },\n    buttons_right: [\"gantt_delete_btn\"],\n    lightbox: {\n      sections: [{\n        name: \"description\",\n        height: 70,\n        map_to: \"text\",\n        type: \"textarea\",\n        focus: !0\n      }, {\n        name: \"time\",\n        type: \"duration\",\n        map_to: \"auto\"\n      }],\n      project_sections: [{\n        name: \"description\",\n        height: 70,\n        map_to: \"text\",\n        type: \"textarea\",\n        focus: !0\n      }, {\n        name: \"type\",\n        type: \"typeselect\",\n        map_to: \"type\"\n      }, {\n        name: \"time\",\n        type: \"duration\",\n        readonly: !0,\n        map_to: \"auto\"\n      }],\n      milestone_sections: [{\n        name: \"description\",\n        height: 70,\n        map_to: \"text\",\n        type: \"textarea\",\n        focus: !0\n      }, {\n        name: \"type\",\n        type: \"typeselect\",\n        map_to: \"type\"\n      }, {\n        name: \"time\",\n        type: \"duration\",\n        single_date: !0,\n        map_to: \"auto\"\n      }]\n    },\n    drag_lightbox: !0,\n    sort: !1,\n    details_on_create: !0,\n    details_on_dblclick: !0,\n    initial_scroll: !0,\n    task_scroll_offset: 100,\n    order_branch: !1,\n    order_branch_free: !1,\n    task_height: void 0,\n    bar_height: \"full\",\n    bar_height_padding: 9,\n    min_column_width: 70,\n    min_grid_column_width: 70,\n    grid_resizer_column_attribute: \"data-column-index\",\n    keep_grid_width: !1,\n    grid_resize: !1,\n    grid_elastic_columns: !1,\n    show_tasks_outside_timescale: !1,\n    show_unscheduled: !0,\n    resize_rows: !1,\n    task_grid_row_resizer_attribute: \"data-row-index\",\n    min_task_grid_row_height: 30,\n    row_height: 36,\n    readonly_property: \"readonly\",\n    editable_property: \"editable\",\n    calendar_property: \"calendar_id\",\n    resource_calendars: {},\n    dynamic_resource_calendars: !1,\n    inherit_calendar: !1,\n    type_renderers: {},\n    open_tree_initially: !1,\n    optimize_render: !0,\n    prevent_default_scroll: !1,\n    show_errors: !0,\n    wai_aria_attributes: !0,\n    smart_scales: !0,\n    rtl: !1,\n    placeholder_task: !1,\n    horizontal_scroll_key: \"shiftKey\",\n    drag_timeline: {\n      useKey: void 0,\n      ignore: \".gantt_task_line, .gantt_task_link\",\n      render: !1\n    },\n    drag_multiple: !0,\n    csp: \"auto\"\n  }, e.ajax = /* @__PURE__ */function (l) {\n    return {\n      cache: !0,\n      method: \"get\",\n      parse: function (c) {\n        return typeof c != \"string\" ? c : (c = c.replace(/^[\\s]+/, \"\"), typeof DOMParser > \"u\" || mt.isIE ? Z.ActiveXObject !== void 0 && ((d = new Z.ActiveXObject(\"Microsoft.XMLDOM\")).async = \"false\", d.loadXML(c)) : d = new DOMParser().parseFromString(c, \"text/xml\"), d);\n        var d;\n      },\n      xmltop: function (c, d, u) {\n        if (d.status === void 0 || d.status < 400) {\n          var h = d.responseXML ? d.responseXML || d : this.parse(d.responseText || d);\n          if (h && h.documentElement !== null && !h.getElementsByTagName(\"parsererror\").length) return h.getElementsByTagName(c)[0];\n        }\n        return u !== -1 && l.callEvent(\"onLoadXMLError\", [\"Incorrect XML\", arguments[1], u]), document.createElement(\"DIV\");\n      },\n      xpath: function (c, d) {\n        if (d.nodeName || (d = d.responseXML || d), mt.isIE) return d.selectNodes(c) || [];\n        for (var u, h = [], _ = (d.ownerDocument || d).evaluate(c, d, null, XPathResult.ANY_TYPE, null); u = _.iterateNext();) h.push(u);\n        return h;\n      },\n      query: function (c) {\n        return this._call(c.method || \"GET\", c.url, c.data || \"\", c.async || !0, c.callback, c.headers);\n      },\n      get: function (c, d, u) {\n        var h = xt(\"GET\", arguments);\n        return this.query(h);\n      },\n      getSync: function (c, d) {\n        var u = xt(\"GET\", arguments);\n        return u.async = !1, this.query(u);\n      },\n      put: function (c, d, u, h) {\n        var _ = xt(\"PUT\", arguments);\n        return this.query(_);\n      },\n      del: function (c, d, u) {\n        var h = xt(\"DELETE\", arguments);\n        return this.query(h);\n      },\n      post: function (c, d, u, h) {\n        arguments.length == 1 ? d = \"\" : arguments.length == 2 && typeof d == \"function\" && (u = d, d = \"\");\n        var _ = xt(\"POST\", arguments);\n        return this.query(_);\n      },\n      postSync: function (c, d, u) {\n        d = d === null ? \"\" : String(d);\n        var h = xt(\"POST\", arguments);\n        return h.async = !1, this.query(h);\n      },\n      _call: function (c, d, u, h, _, p) {\n        return new l.Promise(function (y, k) {\n          var b = typeof XMLHttpRequest !== void 0 ? new XMLHttpRequest() : new Z.ActiveXObject(\"Microsoft.XMLHTTP\"),\n            g = navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null;\n          h && (b.onreadystatechange = function () {\n            if (b.readyState == 4 || g && b.readyState == 3) {\n              if ((b.status < 200 || b.status > 299 || b.responseText === \"\") && !l.callEvent(\"onAjaxError\", [b])) return;\n              setTimeout(function () {\n                typeof _ == \"function\" && _.apply(Z, [{\n                  xmlDoc: b,\n                  filePath: d\n                }]), y(b), typeof _ == \"function\" && (_ = null, b = null);\n              }, 0);\n            }\n          });\n          var m = !this || !this.cache;\n          if (c == \"GET\" && m && (d += (d.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"dhxr\" + (/* @__PURE__ */new Date()).getTime() + \"=1\"), b.open(c, d, h), p) for (var f in p) b.setRequestHeader(f, p[f]);else c.toUpperCase() == \"POST\" || c == \"PUT\" || c == \"DELETE\" ? b.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\") : c == \"GET\" && (u = null);\n          if (b.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\"), b.send(u), !h) return {\n            xmlDoc: b,\n            filePath: d\n          };\n        });\n      },\n      urlSeparator: function (c) {\n        return c.indexOf(\"?\") != -1 ? \"&\" : \"?\";\n      }\n    };\n  }(e), e.date = Gn(e), e.RemoteEvents = Jn;\n  var a = function (l) {\n    function c(u) {\n      return {\n        target: u.target || u.srcElement,\n        pageX: u.pageX,\n        pageY: u.pageY,\n        clientX: u.clientX,\n        clientY: u.clientY,\n        metaKey: u.metaKey,\n        shiftKey: u.shiftKey,\n        ctrlKey: u.ctrlKey,\n        altKey: u.altKey\n      };\n    }\n    function d(u, h) {\n      this._obj = u, this._settings = h || {}, ot(this);\n      var _ = this.getInputMethods();\n      this._drag_start_timer = null, l.attachEvent(\"onGanttScroll\", R(function (k, b) {\n        this.clearDragTimer();\n      }, this));\n      for (var p = {\n          passive: !1\n        }, y = 0; y < _.length; y++) R(function (k) {\n        l.event(u, k.down, R(function (g) {\n          k.accessor(g) && (g.button !== void 0 && g.button !== 0 || (h.preventDefault && h.selector && dt(g.target, h.selector) && g.preventDefault(), l.config.touch && g.timeStamp && g.timeStamp - 0 < 300 || (this._settings.original_target = c(g), this._settings.original_element_sizes = {\n            ...rt(g, nn(u)),\n            width: g.target.offsetWidth,\n            height: g.target.offsetHeight\n          }, l.config.touch ? (this.clearDragTimer(), this._drag_start_timer = setTimeout(R(function () {\n            l.getState().lightbox || this.dragStart(u, g, k);\n          }, this), l.config.touch_drag)) : this.dragStart(u, g, k))));\n        }, this), p);\n        var b = document.body;\n        l.event(b, k.up, R(function (g) {\n          k.accessor(g) && this.clearDragTimer();\n        }, this), p);\n      }, this)(_[y]);\n    }\n    return d.prototype = {\n      traceDragEvents: function (u, h) {\n        var _ = R(function (m) {\n          return this.dragMove(u, m, h.accessor);\n        }, this);\n        R(function (m) {\n          return this.dragScroll(u, m);\n        }, this);\n        var p = R(function (m) {\n            if (!this.config.started || !W(this.config.updates_per_second) || dn(this, this.config.updates_per_second)) {\n              var f = _(m);\n              if (f) try {\n                m && m.preventDefault && m.cancelable && m.preventDefault();\n              } catch {}\n              return f;\n            }\n          }, this),\n          y = vt(l.$root),\n          k = this.config.mousemoveContainer || vt(l.$root),\n          b = {\n            passive: !1\n          },\n          g = R(function (m) {\n            return l.eventRemove(k, h.move, p), l.eventRemove(y, h.up, g, b), this.dragEnd(u);\n          }, this);\n        l.event(k, h.move, p, b), l.event(y, h.up, g, b);\n      },\n      checkPositionChange: function (u) {\n        var h = u.x - this.config.pos.x,\n          _ = u.y - this.config.pos.y;\n        return Math.sqrt(Math.pow(Math.abs(h), 2) + Math.pow(Math.abs(_), 2)) > this.config.sensitivity;\n      },\n      initDnDMarker: function () {\n        var u = this.config.marker = document.createElement(\"div\");\n        u.className = \"gantt_drag_marker\", u.innerHTML = \"\", document.body.appendChild(u);\n      },\n      backupEventTarget: function (u, h) {\n        if (l.config.touch) {\n          var _ = h(u),\n            p = _.target || _.srcElement,\n            y = p.cloneNode(!0);\n          this.config.original_target = c(_), this.config.original_target.target = y, this.config.backup_element = p, p.parentNode.appendChild(y), p.style.display = \"none\", (this.config.mousemoveContainer || document.body).appendChild(p);\n        }\n      },\n      getInputMethods: function () {\n        var u = [];\n        if (u.push({\n          move: \"mousemove\",\n          down: \"mousedown\",\n          up: \"mouseup\",\n          accessor: function (_) {\n            return _;\n          }\n        }), l.config.touch) {\n          var h = !0;\n          try {\n            document.createEvent(\"TouchEvent\");\n          } catch {\n            h = !1;\n          }\n          h ? u.push({\n            move: \"touchmove\",\n            down: \"touchstart\",\n            up: \"touchend\",\n            accessor: function (_) {\n              return _.touches && _.touches.length > 1 ? null : _.touches[0] ? {\n                target: document.elementFromPoint(_.touches[0].clientX, _.touches[0].clientY),\n                pageX: _.touches[0].pageX,\n                pageY: _.touches[0].pageY,\n                clientX: _.touches[0].clientX,\n                clientY: _.touches[0].clientY\n              } : _;\n            }\n          }) : Z.navigator.pointerEnabled ? u.push({\n            move: \"pointermove\",\n            down: \"pointerdown\",\n            up: \"pointerup\",\n            accessor: function (_) {\n              return _.pointerType == \"mouse\" ? null : _;\n            }\n          }) : Z.navigator.msPointerEnabled && u.push({\n            move: \"MSPointerMove\",\n            down: \"MSPointerDown\",\n            up: \"MSPointerUp\",\n            accessor: function (_) {\n              return _.pointerType == _.MSPOINTER_TYPE_MOUSE ? null : _;\n            }\n          });\n        }\n        return u;\n      },\n      clearDragTimer: function () {\n        this._drag_start_timer && (clearTimeout(this._drag_start_timer), this._drag_start_timer = null);\n      },\n      dragStart: function (u, h, _) {\n        this.config && this.config.started || (this.config = {\n          obj: u,\n          marker: null,\n          started: !1,\n          pos: this.getPosition(h),\n          sensitivity: 4\n        }, this._settings && P(this.config, this._settings, !0), this.traceDragEvents(u, _), l._prevent_touch_scroll = !0, h.target.closest(\".gantt_row\") && !l.config.order_branch && (l._prevent_touch_scroll = !1), document.body.classList.add(\"gantt_noselect\"), l.config.touch && this.dragMove(u, h, _.accessor));\n      },\n      dragMove: function (u, h, _) {\n        var p = _(h);\n        if (!p) return !1;\n        if (!this.config.marker && !this.config.started) {\n          var y = this.getPosition(p);\n          if (l.config.touch || this.checkPositionChange(y)) {\n            if (this.config.started = !0, this.config.ignore = !1, l._touch_drag = !0, this.callEvent(\"onBeforeDragStart\", [u, this.config.original_target]) === !1) return this.config.ignore = !0, !1;\n            this.backupEventTarget(h, _), this.initDnDMarker(), l._touch_feedback(), this.callEvent(\"onAfterDragStart\", [u, this.config.original_target]);\n          } else this.config.ignore = !0;\n        }\n        return this.config.ignore ? !1 : h.targetTouches && !p.target ? void 0 : (p.pos = this.getPosition(p), this.config.marker.style.left = p.pos.x + \"px\", this.config.marker.style.top = p.pos.y + \"px\", this.callEvent(\"onDragMove\", [u, p]), !0);\n      },\n      dragEnd: function (u) {\n        var h = this.config.backup_element;\n        h && h.parentNode && h.parentNode.removeChild(h), l._prevent_touch_scroll = !1, this.config.marker && (this.config.marker.parentNode.removeChild(this.config.marker), this.config.marker = null, this.callEvent(\"onDragEnd\", [])), this.config.started = !1, l._touch_drag = !1, document.body.classList.remove(\"gantt_noselect\");\n      },\n      getPosition: function (u) {\n        var h = 0,\n          _ = 0;\n        return u.pageX || u.pageY ? (h = u.pageX, _ = u.pageY) : (u.clientX || u.clientY) && (h = u.clientX + document.body.scrollLeft + document.documentElement.scrollLeft, _ = u.clientY + document.body.scrollTop + document.documentElement.scrollTop), {\n          x: h,\n          y: _\n        };\n      }\n    }, d;\n  }(e);\n  e.$services.setService(\"dnd\", function () {\n    return a;\n  });\n  var r = /* @__PURE__ */function (l) {\n    var c = {};\n    function d(u, h, _) {\n      _ = _ || u;\n      var p = l.config,\n        y = l.templates;\n      l.config[u] && c[_] != p[u] && (h && y[_] || (y[_] = l.date.date_to_str(p[u]), c[_] = p[u]));\n    }\n    return {\n      initTemplates: function () {\n        var u = l.date,\n          h = u.date_to_str,\n          _ = l.config,\n          p = h(_.xml_date || _.date_format, _.server_utc),\n          y = u.str_to_date(_.xml_date || _.date_format, _.server_utc);\n        d(\"date_scale\", !0, void 0, l.config, l.templates), d(\"date_grid\", !0, \"grid_date_format\", l.config, l.templates), d(\"task_date\", !0, void 0, l.config, l.templates), l.mixin(l.templates, {\n          xml_format: void 0,\n          format_date: p,\n          xml_date: void 0,\n          parse_date: y,\n          progress_text: function (k, b, g) {\n            return \"\";\n          },\n          grid_header_class: function (k, b) {\n            return \"\";\n          },\n          task_text: function (k, b, g) {\n            return g.text;\n          },\n          task_class: function (k, b, g) {\n            return \"\";\n          },\n          task_end_date: function (k) {\n            return l.templates.task_date(k);\n          },\n          grid_row_class: function (k, b, g) {\n            return \"\";\n          },\n          task_row_class: function (k, b, g) {\n            return \"\";\n          },\n          timeline_cell_class: function (k, b) {\n            return \"\";\n          },\n          timeline_cell_content: function (k, b) {\n            return \"\";\n          },\n          scale_cell_class: function (k) {\n            return \"\";\n          },\n          scale_row_class: function (k) {\n            return \"\";\n          },\n          grid_indent: function (k) {\n            return \"<div class='gantt_tree_indent'></div>\";\n          },\n          grid_folder: function (k) {\n            return \"<div class='gantt_tree_icon gantt_folder_\" + (k.$open ? \"open\" : \"closed\") + \"'></div>\";\n          },\n          grid_file: function (k) {\n            return \"<div class='gantt_tree_icon gantt_file'></div>\";\n          },\n          grid_open: function (k) {\n            return \"<div class='gantt_tree_icon gantt_\" + (k.$open ? \"close\" : \"open\") + \"'></div>\";\n          },\n          grid_blank: function (k) {\n            return \"<div class='gantt_tree_icon gantt_blank'></div>\";\n          },\n          date_grid: function (k, b, g) {\n            return b && l.isUnscheduledTask(b) && l.config.show_unscheduled ? l.templates.task_unscheduled_time(b) : l.templates.grid_date_format(k, g);\n          },\n          task_time: function (k, b, g) {\n            return l.isUnscheduledTask(g) && l.config.show_unscheduled ? l.templates.task_unscheduled_time(g) : l.templates.task_date(k) + \" - \" + l.templates.task_end_date(b);\n          },\n          task_unscheduled_time: function (k) {\n            return \"\";\n          },\n          time_picker: h(_.time_picker),\n          link_class: function (k) {\n            return \"\";\n          },\n          link_description: function (k) {\n            var b = l.getTask(k.source),\n              g = l.getTask(k.target);\n            return \"<b>\" + b.text + \"</b> &ndash;  <b>\" + g.text + \"</b>\";\n          },\n          drag_link: function (k, b, g, m) {\n            k = l.getTask(k);\n            var f = l.locale.labels,\n              v = \"<b>\" + k.text + \"</b> \" + (b ? f.link_start : f.link_end) + \"<br/>\";\n            return g && (v += \"<b> \" + (g = l.getTask(g)).text + \"</b> \" + (m ? f.link_start : f.link_end) + \"<br/>\"), v;\n          },\n          drag_link_class: function (k, b, g, m) {\n            var f = \"\";\n            return k && g && (f = \" \" + (l.isLinkAllowed(k, g, b, m) ? \"gantt_link_allow\" : \"gantt_link_deny\")), \"gantt_link_tooltip\" + f;\n          },\n          tooltip_date_format: u.date_to_str(\"%Y-%m-%d\"),\n          tooltip_text: function (k, b, g) {\n            return `<div>Task: ${g.text}</div>\n\t\t\t\t<div>Start date: ${l.templates.tooltip_date_format(k)}</div>\n\t\t\t\t<div>End date: ${l.templates.tooltip_date_format(b)}</div>`;\n          },\n          baseline_text: function (k, b, g) {\n            return \"\";\n          }\n        });\n      },\n      initTemplate: d\n    };\n  }(e);\n  e.$services.setService(\"templateLoader\", function () {\n    return r;\n  }), ot(e);\n  var s = new Kn();\n  s.registerProvider(\"global\", function () {\n    var l = {\n      min_date: e._min_date,\n      max_date: e._max_date,\n      selected_task: null\n    };\n    return e.$data && e.$data.tasksStore && (l.selected_task = e.$data.tasksStore.getSelectedId()), l;\n  }), e.getState = s.getState, e.$services.setService(\"state\", function () {\n    return s;\n  }), P(e, Bn), e.Promise = Xn, e.env = mt, function (l) {\n    var c = Qn.create();\n    P(l, c);\n    var d,\n      u = l.createDatastore({\n        name: \"task\",\n        type: \"treeDatastore\",\n        rootId: function () {\n          return l.config.root_id;\n        },\n        initItem: R(function (m) {\n          this.defined(m.id) || (m.id = this.uid()), m.start_date && (m.start_date = l.date.parseDate(m.start_date, \"parse_date\")), m.end_date && (m.end_date = l.date.parseDate(m.end_date, \"parse_date\"));\n          var f = null;\n          (m.duration || m.duration === 0) && (m.duration = f = 1 * m.duration), f && (m.start_date && !m.end_date ? m.end_date = this.calculateEndDate(m) : !m.start_date && m.end_date && (m.start_date = this.calculateEndDate({\n            start_date: m.end_date,\n            duration: -m.duration,\n            task: m\n          }))), l.config.deadlines !== !1 && m.deadline && (m.deadline = l.date.parseDate(m.deadline, \"parse_date\")), m.progress = Number(m.progress) || 0, this._isAllowedUnscheduledTask(m) && this._set_default_task_timing(m), this._init_task_timing(m), m.start_date && m.end_date && this.correctTaskWorkTime(m), m.$source = [], m.$target = [];\n          var v = this.$data.tasksStore.getItem(m.id);\n          return v && !W(m.open) && (m.$open = v.$open), m.parent === void 0 && (m.parent = this.config.root_id), m.open && (m.$open = !0), m;\n        }, l),\n        getConfig: function () {\n          return l.config;\n        }\n      }),\n      h = l.createDatastore({\n        name: \"link\",\n        initItem: R(function (m) {\n          return this.defined(m.id) || (m.id = this.uid()), m;\n        }, l)\n      });\n    function _(m) {\n      var f = l.isTaskVisible(m);\n      if (!f && l.isTaskExists(m)) {\n        var v = l.getParent(m);\n        l.isTaskExists(v) && l.isTaskVisible(v) && (v = l.getTask(v), l.isSplitTask(v) && (f = !0));\n      }\n      return f;\n    }\n    function p(m) {\n      if (l.isTaskExists(m.source)) {\n        var f = l.getTask(m.source);\n        f.$source = f.$source || [], y(m.id, f.$source) && f.$source.push(m.id);\n      }\n      if (l.isTaskExists(m.target)) {\n        var v = l.getTask(m.target);\n        v.$target = v.$target || [], y(m.id, v.$target) && v.$target.push(m.id);\n      }\n    }\n    function y(m, f) {\n      return f.indexOf(String(m)) === -1 && f.indexOf(Number(m)) === -1;\n    }\n    function k(m) {\n      if (l.isTaskExists(m.source)) {\n        for (var f = l.getTask(m.source), v = 0; v < f.$source.length; v++) if (f.$source[v] == m.id) {\n          f.$source.splice(v, 1);\n          break;\n        }\n      }\n      if (l.isTaskExists(m.target)) {\n        var x = l.getTask(m.target);\n        for (v = 0; v < x.$target.length; v++) if (x.$target[v] == m.id) {\n          x.$target.splice(v, 1);\n          break;\n        }\n      }\n    }\n    function b() {\n      for (var m = null, f = l.$data.tasksStore.getItems(), v = 0, x = f.length; v < x; v++) (m = f[v]).$source = [], m.$target = [];\n      var $ = l.$data.linksStore.getItems();\n      for (v = 0, x = $.length; v < x; v++) p($[v]);\n    }\n    function g(m) {\n      var f = m.source,\n        v = m.target;\n      for (var x in m.events) (function ($, w) {\n        f.attachEvent($, function () {\n          return v.callEvent(w, Array.prototype.slice.call(arguments));\n        }, w);\n      })(x, m.events[x]);\n    }\n    l.attachEvent(\"onDestroy\", function () {\n      u.destructor(), h.destructor();\n    }), l.attachEvent(\"onLinkValidation\", function (m) {\n      if (l.isLinkExists(m.id) || m.id === \"predecessor_generated\") return !0;\n      for (var f = l.getTask(m.source).$source, v = 0; v < f.length; v++) {\n        var x = l.getLink(f[v]),\n          $ = m.source == x.source,\n          w = m.target == x.target,\n          S = m.type == x.type;\n        if ($ && w && S) return !1;\n      }\n      return !0;\n    }), u.attachEvent(\"onBeforeRefreshAll\", function () {\n      if (!u._skipTaskRecalculation) for (var m = u.getVisibleItems(), f = 0; f < m.length; f++) {\n        var v = m[f];\n        v.$index = f, v.$local_index = l.getTaskIndex(v.id), l.resetProjectDates(v);\n      }\n    }), u.attachEvent(\"onFilterItem\", function (m, f) {\n      if (l.config.show_tasks_outside_timescale) return !0;\n      var v = null,\n        x = null;\n      if (l.config.start_date && l.config.end_date) {\n        if (l._isAllowedUnscheduledTask(f)) return !0;\n        if (v = l.config.start_date.valueOf(), x = l.config.end_date.valueOf(), +f.start_date > x || +f.end_date < +v) return !1;\n      }\n      return !0;\n    }), u.attachEvent(\"onIdChange\", function (m, f) {\n      l._update_flags(m, f);\n      var v = l.getTask(f);\n      u.isSilent() || (v.$split_subtask || v.rollup) && l.eachParent(function (x) {\n        l.refreshTask(x.id);\n      }, f);\n    }), u.attachEvent(\"onAfterUpdate\", function (m) {\n      if (l._update_parents(m), l.getState(\"batchUpdate\").batch_update) return !0;\n      var f = u.getItem(m);\n      f.$source || (f.$source = []);\n      for (var v = 0; v < f.$source.length; v++) h.refresh(f.$source[v]);\n      for (f.$target || (f.$target = []), v = 0; v < f.$target.length; v++) h.refresh(f.$target[v]);\n    }), u.attachEvent(\"onBeforeItemMove\", function (m, f, v) {\n      return !Rt(m, l, u) || (console.log(\"The placeholder task cannot be moved to another position.\"), !1);\n    }), u.attachEvent(\"onAfterItemMove\", function (m, f, v) {\n      var x = l.getTask(m);\n      this.getNextSibling(m) !== null ? x.$drop_target = this.getNextSibling(m) : this.getPrevSibling(m) !== null ? x.$drop_target = \"next:\" + this.getPrevSibling(m) : x.$drop_target = \"next:null\";\n    }), u.attachEvent(\"onStoreUpdated\", function (m, f, v) {\n      if (v == \"delete\" && l._update_flags(m, null), !l.$services.getService(\"state\").getState(\"batchUpdate\").batch_update) {\n        if (l.config.fit_tasks && v !== \"paint\") {\n          var x = l.getState();\n          me(l);\n          var $ = l.getState();\n          if (+x.min_date != +$.min_date || +x.max_date != +$.max_date) return l.render(), l.callEvent(\"onScaleAdjusted\", []), !0;\n        }\n        v == \"add\" || v == \"move\" || v == \"delete\" ? l.$layout && (this.$config.name != \"task\" || v != \"add\" && v != \"delete\" || this._skipTaskRecalculation != \"lightbox\" && (this._skipTaskRecalculation = !0), l.$layout.resize()) : m || h.refresh();\n      }\n    }), h.attachEvent(\"onAfterAdd\", function (m, f) {\n      p(f);\n    }), h.attachEvent(\"onAfterUpdate\", function (m, f) {\n      b();\n    }), h.attachEvent(\"onAfterDelete\", function (m, f) {\n      k(f);\n    }), h.attachEvent(\"onAfterSilentDelete\", function (m, f) {\n      k(f);\n    }), h.attachEvent(\"onBeforeIdChange\", function (m, f) {\n      k(l.mixin({\n        id: m\n      }, l.$data.linksStore.getItem(f))), p(l.$data.linksStore.getItem(f));\n    }), h.attachEvent(\"onFilterItem\", function (m, f) {\n      if (!l.config.show_links) return !1;\n      var v = _(f.source),\n        x = _(f.target);\n      return !(!v || !x || l._isAllowedUnscheduledTask(l.getTask(f.source)) || l._isAllowedUnscheduledTask(l.getTask(f.target))) && l.callEvent(\"onBeforeLinkDisplay\", [m, f]);\n    }), d = {}, l.attachEvent(\"onBeforeTaskDelete\", function (m, f) {\n      return d[m] = ve.getSubtreeLinks(l, m), !0;\n    }), l.attachEvent(\"onAfterTaskDelete\", function (m, f) {\n      d[m] && l.$data.linksStore.silent(function () {\n        for (var v in d[m]) l.isLinkExists(v) && l.$data.linksStore.removeItem(v), k(d[m][v]);\n        d[m] = null;\n      });\n    }), l.attachEvent(\"onAfterLinkDelete\", function (m, f) {\n      l.isTaskExists(f.source) && l.refreshTask(f.source), l.isTaskExists(f.target) && l.refreshTask(f.target);\n    }), l.attachEvent(\"onParse\", b), g({\n      source: h,\n      target: l,\n      events: {\n        onItemLoading: \"onLinkLoading\",\n        onBeforeAdd: \"onBeforeLinkAdd\",\n        onAfterAdd: \"onAfterLinkAdd\",\n        onBeforeUpdate: \"onBeforeLinkUpdate\",\n        onAfterUpdate: \"onAfterLinkUpdate\",\n        onBeforeDelete: \"onBeforeLinkDelete\",\n        onAfterDelete: \"onAfterLinkDelete\",\n        onIdChange: \"onLinkIdChange\"\n      }\n    }), g({\n      source: u,\n      target: l,\n      events: {\n        onItemLoading: \"onTaskLoading\",\n        onBeforeAdd: \"onBeforeTaskAdd\",\n        onAfterAdd: \"onAfterTaskAdd\",\n        onBeforeUpdate: \"onBeforeTaskUpdate\",\n        onAfterUpdate: \"onAfterTaskUpdate\",\n        onBeforeDelete: \"onBeforeTaskDelete\",\n        onAfterDelete: \"onAfterTaskDelete\",\n        onIdChange: \"onTaskIdChange\",\n        onBeforeItemMove: \"onBeforeTaskMove\",\n        onAfterItemMove: \"onAfterTaskMove\",\n        onFilterItem: \"onBeforeTaskDisplay\",\n        onItemOpen: \"onTaskOpened\",\n        onItemClose: \"onTaskClosed\",\n        onBeforeSelect: \"onBeforeTaskSelected\",\n        onAfterSelect: \"onTaskSelected\",\n        onAfterUnselect: \"onTaskUnselected\"\n      }\n    }), l.$data = {\n      tasksStore: u,\n      linksStore: h\n    };\n  }(e), e.dataProcessor = ni, e.createDataProcessor = ii, function (l) {\n    l.ext || (l.ext = {});\n    for (var c = [ri, si, li, di, ci, ui, hi, _i, gi], d = 0; d < c.length; d++) c[d] && c[d](l);\n  }(e), function (l) {\n    l.getGridColumn = function (c) {\n      for (var d = l.config.columns, u = 0; u < d.length; u++) if (d[u].name == c) return d[u];\n      return null;\n    }, l.getGridColumns = function () {\n      return l.config.columns.slice();\n    };\n  }(e), function (l) {\n    l.isReadonly = function (c) {\n      return typeof c != \"number\" && typeof c != \"string\" || !l.isTaskExists(c) || (c = l.getTask(c)), (!c || !c[this.config.editable_property]) && (c && c[this.config.readonly_property] || this.config.readonly);\n    };\n  }(e), fi(e), function (l) {\n    var c = new fn(l),\n      d = new pn(c);\n    P(l, xi(c, d));\n  }(e), $i(e), function (l) {\n    l.getTaskType = function (c) {\n      return \"task\";\n    };\n  }(e), function (l) {\n    function c() {\n      return l._cached_functions.update_if_changed(l), l._cached_functions.active || l._cached_functions.activate(), !0;\n    }\n    l._cached_functions = {\n      cache: {},\n      mode: !1,\n      critical_path_mode: !1,\n      wrap_methods: function (u, h) {\n        if (h._prefetch_originals) for (var _ in h._prefetch_originals) h[_] = h._prefetch_originals[_];\n        for (h._prefetch_originals = {}, _ = 0; _ < u.length; _++) this.prefetch(u[_], h);\n      },\n      prefetch: function (u, h) {\n        var _ = h[u];\n        if (_) {\n          var p = this;\n          h._prefetch_originals[u] = _, h[u] = function () {\n            for (var y = new Array(arguments.length), k = 0, b = arguments.length; k < b; k++) y[k] = arguments[k];\n            if (p.active) {\n              var g = p.get_arguments_hash(Array.prototype.slice.call(y));\n              p.cache[u] || (p.cache[u] = {});\n              var m = p.cache[u];\n              if (p.has_cached_value(m, g)) return p.get_cached_value(m, g);\n              var f = _.apply(this, y);\n              return p.cache_value(m, g, f), f;\n            }\n            return _.apply(this, y);\n          };\n        }\n        return _;\n      },\n      cache_value: function (u, h, _) {\n        this.is_date(_) && (_ = new Date(_)), u[h] = _;\n      },\n      has_cached_value: function (u, h) {\n        return u.hasOwnProperty(h);\n      },\n      get_cached_value: function (u, h) {\n        var _ = u[h];\n        return this.is_date(_) && (_ = new Date(_)), _;\n      },\n      is_date: function (u) {\n        return u && u.getUTCDate;\n      },\n      get_arguments_hash: function (u) {\n        for (var h = [], _ = 0; _ < u.length; _++) h.push(this.stringify_argument(u[_]));\n        return \"(\" + h.join(\";\") + \")\";\n      },\n      stringify_argument: function (u) {\n        return (u.id ? u.id : this.is_date(u) ? u.valueOf() : u) + \"\";\n      },\n      activate: function () {\n        this.clear(), this.active = !0;\n      },\n      deactivate: function () {\n        this.clear(), this.active = !1;\n      },\n      clear: function () {\n        this.cache = {};\n      },\n      setup: function (u) {\n        var h = [],\n          _ = [\"_isProjectEnd\", \"_getProjectEnd\", \"_getSlack\"];\n        this.mode == \"auto\" ? u.config.highlight_critical_path && (h = _) : this.mode === !0 && (h = _), this.wrap_methods(h, u);\n      },\n      update_if_changed: function (u) {\n        (this.critical_path_mode != u.config.highlight_critical_path || this.mode !== u.config.optimize_render) && (this.critical_path_mode = u.config.highlight_critical_path, this.mode = u.config.optimize_render, this.setup(u));\n      }\n    }, l.attachEvent(\"onBeforeGanttRender\", c), l.attachEvent(\"onBeforeDataRender\", c), l.attachEvent(\"onBeforeSmartRender\", function () {\n      c();\n    }), l.attachEvent(\"onBeforeParse\", c), l.attachEvent(\"onDataRender\", function () {\n      l._cached_functions.deactivate();\n    });\n    var d = null;\n    l.attachEvent(\"onSmartRender\", function () {\n      d && clearTimeout(d), d = setTimeout(function () {\n        l._cached_functions.deactivate();\n      }, 1e3);\n    }), l.attachEvent(\"onBeforeGanttReady\", function () {\n      return l._cached_functions.update_if_changed(l), !0;\n    });\n  }(e), wi(e), function (l) {\n    l.destructor = function () {\n      for (var c in this.clearAll(), this.callEvent(\"onDestroy\", []), this._getDatastores().forEach(function (d) {\n        d.destructor();\n      }), this.$root && delete this.$root.gantt, this._eventRemoveAll && this._eventRemoveAll(), this.$layout && this.$layout.destructor(), this.resetLightbox && this.resetLightbox(), this.ext.inlineEditors && this.ext.inlineEditors.destructor && this.ext.inlineEditors.destructor(), this._dp && this._dp.destructor && this._dp.destructor(), this.$services.destructor(), this.detachAllEvents(), this) c.indexOf(\"$\") === 0 && delete this[c];\n      this.$destroyed = !0;\n    };\n  }(e);\n  var o = new Ui({\n    en: Ni,\n    ar: Si,\n    be: Ti,\n    ca: Ei,\n    cn: Ci,\n    cs: Di,\n    da: Ai,\n    de: Ii,\n    el: Mi,\n    es: Li,\n    fa: Pi,\n    fi: Ri,\n    fr: Hi,\n    he: Oi,\n    hr: Bi,\n    hu: zi,\n    id: Wi,\n    it: ji,\n    jp: Fi,\n    kr: Vi,\n    nb: qi,\n    nl: Gi,\n    no: Yi,\n    pl: Ji,\n    pt: Ki,\n    ro: Xi,\n    ru: Zi,\n    si: Qi,\n    sk: ta,\n    sv: ea,\n    tr: na,\n    ua: ia\n  });\n  return e.i18n = {\n    addLocale: o.addLocale,\n    setLocale: function (l) {\n      if (typeof l == \"string\") {\n        var c = o.getLocale(l);\n        c || (c = o.getLocale(\"en\")), e.locale = c;\n      } else if (l) if (e.locale) for (var d in l) l[d] && typeof l[d] == \"object\" ? (e.locale[d] || (e.locale[d] = {}), e.mixin(e.locale[d], l[d], !0)) : e.locale[d] = l[d];else e.locale = l;\n      const u = e.locale.labels;\n      u.gantt_save_btn = u.gantt_save_btn || u.icon_save, u.gantt_cancel_btn = u.gantt_cancel_btn || u.icon_cancel, u.gantt_delete_btn = u.gantt_delete_btn || u.icon_delete;\n    },\n    getLocale: o.getLocale\n  }, e.i18n.setLocale(\"en\"), e;\n}\nfunction sa(t) {\n  var e = \"data-dhxbox\",\n    n = null;\n  function i(g, m) {\n    var f = g.callback;\n    y.hide(g.box), n = g.box = null, f && f(m);\n  }\n  function a(g) {\n    if (n) {\n      var m = g.which || g.keyCode,\n        f = !1;\n      if (k.keyboard) {\n        if (m == 13 || m == 32) {\n          var v = g.target || g.srcElement;\n          X(v).indexOf(\"gantt_popup_button\") > -1 && v.click ? v.click() : (i(n, !0), f = !0);\n        }\n        m == 27 && (i(n, !1), f = !0);\n      }\n      return f ? (g.preventDefault && g.preventDefault(), !(g.cancelBubble = !0)) : void 0;\n    }\n  }\n  var r = vt(t.$root) || document;\n  function s(g) {\n    s.cover || (s.cover = document.createElement(\"div\"), s.cover.onkeydown = a, s.cover.className = \"dhx_modal_cover\", document.body.appendChild(s.cover)), s.cover.style.display = g ? \"inline-block\" : \"none\";\n  }\n  function o(g, m, f) {\n    return \"<div \" + t._waiAria.messageButtonAttrString(g) + \" class='gantt_popup_button \" + (\"gantt_\" + m.toLowerCase().replace(/ /g, \"_\") + \"_button\") + \"' data-result='\" + f + \"' result='\" + f + \"' ><div>\" + g + \"</div></div>\";\n  }\n  function l() {\n    for (var g = [].slice.apply(arguments, [0]), m = 0; m < g.length; m++) if (g[m]) return g[m];\n  }\n  function c(g, m, f) {\n    var v = g.tagName ? g : function (w, S, T) {\n      var E = document.createElement(\"div\"),\n        C = st();\n      t._waiAria.messageModalAttr(E, C), E.className = \" gantt_modal_box gantt-\" + w.type, E.setAttribute(e, 1);\n      var D = \"\";\n      if (w.width && (E.style.width = w.width), w.height && (E.style.height = w.height), w.title && (D += '<div class=\"gantt_popup_title\">' + w.title + \"</div>\"), D += '<div class=\"gantt_popup_text\" id=\"' + C + '\"><span>' + (w.content ? \"\" : w.text) + '</span></div><div  class=\"gantt_popup_controls\">', S && (D += o(l(w.ok, t.locale.labels.message_ok, \"OK\"), \"ok\", !0)), T && (D += o(l(w.cancel, t.locale.labels.message_cancel, \"Cancel\"), \"cancel\", !1)), w.buttons) for (var M = 0; M < w.buttons.length; M++) {\n        var I = w.buttons[M];\n        D += typeof I == \"object\" ? o(I.label, I.css || \"gantt_\" + I.label.toLowerCase() + \"_button\", I.value || M) : o(I, I, M);\n      }\n      if (D += \"</div>\", E.innerHTML = D, w.content) {\n        var A = w.content;\n        typeof A == \"string\" && (A = document.getElementById(A)), A.style.display == \"none\" && (A.style.display = \"\"), E.childNodes[w.title ? 1 : 0].appendChild(A);\n      }\n      return E.onclick = function (N) {\n        var L = N.target || N.srcElement;\n        if (L.className || (L = L.parentNode), dt(L, \".gantt_popup_button\")) {\n          var O = L.getAttribute(\"data-result\");\n          i(w, O = O == \"true\" || O != \"false\" && O);\n        }\n      }, w.box = E, (S || T) && (n = w), E;\n    }(g, m, f);\n    g.hidden || s(!0), document.body.appendChild(v);\n    var x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - v.offsetWidth) / 2)),\n      $ = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - v.offsetHeight) / 2));\n    return g.position == \"top\" ? v.style.top = \"-3px\" : v.style.top = $ + \"px\", v.style.left = x + \"px\", v.onkeydown = a, y.focus(v), g.hidden && y.hide(v), t.callEvent(\"onMessagePopup\", [v]), v;\n  }\n  function d(g) {\n    return c(g, !0, !1);\n  }\n  function u(g) {\n    return c(g, !0, !0);\n  }\n  function h(g) {\n    return c(g);\n  }\n  function _(g, m, f) {\n    return typeof g != \"object\" && (typeof m == \"function\" && (f = m, m = \"\"), g = {\n      text: g,\n      type: m,\n      callback: f\n    }), g;\n  }\n  function p(g, m, f, v) {\n    return typeof g != \"object\" && (g = {\n      text: g,\n      type: m,\n      expire: f,\n      id: v\n    }), g.id = g.id || st(), g.expire = g.expire || k.expire, g;\n  }\n  t.event(r, \"keydown\", a, !0);\n  var y = function () {\n    var g = _.apply(this, arguments);\n    return g.type = g.type || \"alert\", h(g);\n  };\n  y.hide = function (g) {\n    for (; g && g.getAttribute && !g.getAttribute(e);) g = g.parentNode;\n    g && (g.parentNode.removeChild(g), s(!1), t.callEvent(\"onAfterMessagePopup\", [g]));\n  }, y.focus = function (g) {\n    setTimeout(function () {\n      var m = Lt(g);\n      m.length && m[0].focus && m[0].focus();\n    }, 1);\n  };\n  var k = function (g, m, f, v) {\n    switch ((g = p.apply(this, arguments)).type = g.type || \"info\", g.type.split(\"-\")[0]) {\n      case \"alert\":\n        return d(g);\n      case \"confirm\":\n        return u(g);\n      case \"modalbox\":\n        return h(g);\n      default:\n        return function (x) {\n          k.area || (k.area = document.createElement(\"div\"), k.area.className = \"gantt_message_area\", k.area.style[k.position] = \"5px\"), Y(k.area, document.body) || document.body.appendChild(k.area), k.hide(x.id);\n          var $ = document.createElement(\"div\");\n          return $.innerHTML = \"<div>\" + x.text + \"</div>\", $.className = \"gantt-info gantt-\" + x.type, $.onclick = function () {\n            k.hide(x.id), x = null;\n          }, t._waiAria.messageInfoAttr($), k.position == \"bottom\" && k.area.firstChild ? k.area.insertBefore($, k.area.firstChild) : k.area.appendChild($), x.expire > 0 && (k.timers[x.id] = window.setTimeout(function () {\n            k && k.hide(x.id);\n          }, x.expire)), k.pull[x.id] = $, $ = null, x.id;\n        }(g);\n    }\n  };\n  k.seed = (/* @__PURE__ */new Date()).valueOf(), k.uid = st, k.expire = 4e3, k.keyboard = !0, k.position = \"top\", k.pull = {}, k.timers = {}, k.hideAll = function () {\n    for (var g in k.pull) k.hide(g);\n  }, k.hide = function (g) {\n    var m = k.pull[g];\n    m && m.parentNode && (window.setTimeout(function () {\n      m.parentNode.removeChild(m), m = null;\n    }, 2e3), m.className += \" hidden\", k.timers[g] && window.clearTimeout(k.timers[g]), delete k.pull[g]);\n  };\n  var b = [];\n  return t.attachEvent(\"onMessagePopup\", function (g) {\n    b.push(g);\n  }), t.attachEvent(\"onAfterMessagePopup\", function (g) {\n    for (var m = 0; m < b.length; m++) b[m] === g && (b.splice(m, 1), m--);\n  }), t.attachEvent(\"onDestroy\", function () {\n    s.cover && s.cover.parentNode && s.cover.parentNode.removeChild(s.cover);\n    for (var g = 0; g < b.length; g++) b[g].parentNode && b[g].parentNode.removeChild(b[g]);\n    b = null, k.area && k.area.parentNode && k.area.parentNode.removeChild(k.area), k = null;\n  }), {\n    alert: function () {\n      var g = _.apply(this, arguments);\n      return g.type = g.type || \"confirm\", d(g);\n    },\n    confirm: function () {\n      var g = _.apply(this, arguments);\n      return g.type = g.type || \"alert\", u(g);\n    },\n    message: k,\n    modalbox: y\n  };\n}\nfunction ze(t, e) {\n  var n = this.$config[t];\n  return n ? (n.$extendedConfig || (n.$extendedConfig = !0, Object.setPrototypeOf(n, e)), n) : e;\n}\nfunction oa(t, e) {\n  var n, i, a;\n  P(t, (n = e, {\n    $getConfig: function () {\n      return i || (i = n ? n.$getConfig() : this.$gantt.config), this.$config.config ? ze.call(this, \"config\", i) : i;\n    },\n    $getTemplates: function () {\n      return a || (a = n ? n.$getTemplates() : this.$gantt.templates), this.$config.templates ? ze.call(this, \"templates\", a) : a;\n    }\n  }));\n}\nconst la = function (t) {\n  var e = {},\n    n = {};\n  function i(a, r, s, o) {\n    var l = e[a];\n    if (!l || !l.create) return !1;\n    a != \"resizer\" || s.mode || (o.$config.cols ? s.mode = \"x\" : s.mode = \"y\"), a != \"viewcell\" || s.view != \"scrollbar\" || s.scroll || (o.$config.cols ? s.scroll = \"y\" : s.scroll = \"x\"), (s = q(s)).id || n[s.view] || (s.id = s.view), s.id && !s.css && (s.css = s.id + \"_cell\");\n    var c = new l.create(r, s, this, t);\n    return l.configure && l.configure(c), oa(c, o), c.$id || (c.$id = s.id || t.uid()), c.$parent || typeof r != \"object\" || (c.$parent = r), c.$config || (c.$config = s), n[c.$id] && (c.$id = t.uid()), n[c.$id] = c, c;\n  }\n  return {\n    initUI: function (a, r) {\n      var s = \"cell\";\n      return a.view ? s = \"viewcell\" : a.resizer ? s = \"resizer\" : a.rows || a.cols ? s = \"layout\" : a.views && (s = \"multiview\"), i.call(this, s, null, a, r);\n    },\n    reset: function () {\n      n = {};\n    },\n    registerView: function (a, r, s) {\n      e[a] = {\n        create: r,\n        configure: s\n      };\n    },\n    createView: i,\n    getView: function (a) {\n      return n[a];\n    }\n  };\n};\nvar da = /* @__PURE__ */function (t) {\n  return function (e) {\n    var n = {\n      click: {},\n      doubleclick: {},\n      contextMenu: {}\n    };\n    function i(h, _, p, y) {\n      n[h][_] || (n[h][_] = []), n[h][_].push({\n        handler: p,\n        root: y\n      });\n    }\n    function a(h) {\n      h = h || window.event;\n      var _ = e.locate(h),\n        p = s(h, n.click),\n        y = !0;\n      if (_ !== null ? y = !e.checkEvent(\"onTaskClick\") || e.callEvent(\"onTaskClick\", [_, h]) : e.callEvent(\"onEmptyClick\", [h]), y) {\n        if (!o(p, h, _)) return;\n        switch (h.target.nodeName) {\n          case \"SELECT\":\n          case \"INPUT\":\n            return;\n        }\n        _ && e.getTask(_) && !e._multiselect && e.config.select_task && e.selectTask(_);\n      }\n    }\n    function r(h) {\n      var _ = (h = h || window.event).target || h.srcElement,\n        p = e.locate(_),\n        y = e.locate(_, e.config.link_attribute),\n        k = !e.checkEvent(\"onContextMenu\") || e.callEvent(\"onContextMenu\", [p, y, h]);\n      return k || (h.preventDefault ? h.preventDefault() : h.returnValue = !1), k;\n    }\n    function s(h, _) {\n      for (var p = h.target || h.srcElement, y = []; p;) {\n        var k = t.getClassName(p);\n        if (k) {\n          k = k.split(\" \");\n          for (var b = 0; b < k.length; b++) if (k[b] && _[k[b]]) for (var g = _[k[b]], m = 0; m < g.length; m++) g[m].root && !t.isChildOf(p, g[m].root) || y.push(g[m].handler);\n        }\n        p = p.parentNode;\n      }\n      return y;\n    }\n    function o(h, _, p) {\n      for (var y = !0, k = 0; k < h.length; k++) {\n        var b = h[k].call(e, _, p, _.target || _.srcElement);\n        y = y && !(b !== void 0 && b !== !0);\n      }\n      return y;\n    }\n    function l(h) {\n      h = h || window.event;\n      var _ = e.locate(h),\n        p = s(h, n.doubleclick),\n        y = !e.checkEvent(\"onTaskDblClick\") || _ === null || e.callEvent(\"onTaskDblClick\", [_, h]);\n      if (y) {\n        if (!o(p, h, _)) return;\n        _ !== null && e.getTask(_) && y && e.config.details_on_dblclick && !e.isReadonly(_) && e.showLightbox(_);\n      }\n    }\n    function c(h) {\n      if (e.checkEvent(\"onMouseMove\")) {\n        var _ = e.locate(h);\n        e._last_move_event = h, e.callEvent(\"onMouseMove\", [_, h]);\n      }\n    }\n    var d = e._createDomEventScope();\n    function u(h) {\n      d.detachAll(), h && (d.attach(h, \"click\", a), d.attach(h, \"dblclick\", l), d.attach(h, \"mousemove\", c), d.attach(h, \"contextmenu\", r));\n    }\n    return {\n      reset: u,\n      global: function (h, _, p) {\n        i(h, _, p, null);\n      },\n      delegate: i,\n      detach: function (h, _, p, y) {\n        if (n[h] && n[h][_]) {\n          for (var k = n[h], b = k[_], g = 0; g < b.length; g++) b[g].root == y && (b.splice(g, 1), g--);\n          b.length || delete k[_];\n        }\n      },\n      callHandler: function (h, _, p, y) {\n        var k = n[h][_];\n        if (k) for (var b = 0; b < k.length; b++) (p || k[b].root) && k[b].root !== p || k[b].handler.apply(this, y);\n      },\n      onDoubleClick: l,\n      onMouseMove: c,\n      onContextMenu: r,\n      onClick: a,\n      destructor: function () {\n        u(), n = null, d = null;\n      }\n    };\n  };\n}(rn);\nconst ca = {\n  init: da\n};\nfunction We(t, e, n) {\n  return !!e && !(e.left > t.x_end || e.left + e.width < t.x) && !(e.top > t.y_end || e.top + e.height < t.y);\n}\nfunction Nt(t) {\n  return t.config.smart_rendering && t._smart_render;\n}\nfunction Kt(t, e, n) {\n  return {\n    top: e.getItemTop(t.id),\n    height: e.getItemHeight(t.id),\n    left: 0,\n    right: 1 / 0\n  };\n}\nfunction ft(t, e, n, i, a) {\n  var r = e.getItemIndexByTopPosition(a.y) || 0,\n    s = e.getItemIndexByTopPosition(a.y_end) || i.count(),\n    o = Math.max(0, r - 1),\n    l = Math.min(i.count(), s + 1);\n  const c = [];\n  if (t.config.keyboard_navigation && t.getSelectedId()) {\n    let d = t.getTask(t.getSelectedId());\n    d.$expanded_branch && !d.$split_subtask && c.push(t.getSelectedId());\n  }\n  if (t.$ui.getView(\"grid\") && t.ext.inlineEditors && t.ext.inlineEditors.getState().id) {\n    let d = t.ext.inlineEditors.getState().id;\n    i.exists(d) && c.push(d);\n  }\n  return {\n    start: o,\n    end: l,\n    ids: c\n  };\n}\nvar ua = function (t) {\n  var e = /* @__PURE__ */function (n) {\n    var i = {},\n      a = {};\n    function r(o) {\n      var l = null;\n      return typeof o.view == \"string\" ? l = n.$ui.getView(o.view) : o.view && (l = o.view), l;\n    }\n    function s(o, l, c) {\n      if (a[o]) return a[o];\n      l.renderer || n.assert(!1, \"Invalid renderer call\");\n      var d = null,\n        u = null,\n        h = null,\n        _ = null,\n        p = null;\n      typeof l.renderer == \"function\" ? (d = l.renderer, h = Kt) : (d = l.renderer.render, u = l.renderer.update, _ = l.renderer.onrender, l.renderer.isInViewPort ? p = l.renderer.isInViewPort : h = l.renderer.getRectangle, h || h === null || (h = Kt));\n      var y = l.filter;\n      return c && c.setAttribute(n.config.layer_attribute, !0), a[o] = {\n        render_item: function (k, b, g, m, f) {\n          if (b = b || c, !y || y(k)) {\n            var v = m || r(l),\n              x = f || (v ? v.$getConfig() : null),\n              $ = g;\n            !$ && x && x.smart_rendering && ($ = v.getViewPort());\n            var w = null;\n            !Nt(n) && (h || p) && $ ? (p ? p(k, $, v, x, n) : We($, h(k, v, x, n))) && (w = d.call(n, k, v, x, $)) : w = d.call(n, k, v, x, $), this.append(k, w, b);\n            var S = b.nodeType == 11;\n            _ && !S && w && _.call(n, k, w, v);\n          } else this.remove_item(k.id);\n        },\n        clear: function (k) {\n          this.rendered = i[o] = {}, l.append || this.clear_container(k);\n        },\n        clear_container: function (k) {\n          (k = k || c) && (k.innerHTML = \"\");\n        },\n        get_visible_range: function (k) {\n          var b,\n            g,\n            m = r(l),\n            f = m ? m.$getConfig() : null;\n          return f && f.smart_rendering && (b = m.getViewPort()), m && b && (typeof l.renderer == \"function\" ? g = ft(n, m, 0, k, b) : l.renderer && l.renderer.getVisibleRange && (g = l.renderer.getVisibleRange(n, m, f, k, b))), g || (g = {\n            start: 0,\n            end: k.count()\n          }), g;\n        },\n        prepare_data: function (k) {\n          if (l.renderer && l.renderer.prepareData) return l.renderer.prepareData(k, n, l);\n        },\n        render_items: function (k, b) {\n          b = b || c;\n          var g = document.createDocumentFragment();\n          this.clear(b);\n          var m = null,\n            f = r(l),\n            v = f ? f.$getConfig() : null;\n          v && v.smart_rendering && (m = f.getViewPort());\n          for (var x = 0, $ = k.length; x < $; x++) this.render_item(k[x], g, m, f, v);\n          b.appendChild(g, b);\n          var w = {};\n          k.forEach(function (E) {\n            w[E.id] = E;\n          });\n          var S = {};\n          if (_) {\n            var T = {};\n            for (var x in this.rendered) S[x] || (T[x] = this.rendered[x], _.call(n, w[x], this.rendered[x], f));\n          }\n        },\n        update_items: function (k, b) {\n          var g = r(l),\n            m = g ? g.$getConfig() : null;\n          if (g && g.$getConfig().smart_rendering && !Nt(n) && this.rendered && (h || p)) {\n            b = b || c;\n            var f = document.createDocumentFragment(),\n              v = null;\n            g && (v = g.getViewPort());\n            var x = {};\n            k.forEach(function (I) {\n              x[I.id] = I;\n            });\n            var $ = {},\n              w = {};\n            for (var S in this.rendered) w[S] = !0, $[S] = !0;\n            for (var T = {}, E = (S = 0, k.length); S < E; S++) {\n              var C = k[S],\n                D = this.rendered[C.id];\n              w[C.id] = !1, D && D.parentNode ? (p ? p(C, v, g, m, n) : We(v, h(C, g, m, n))) ? (u && u.call(n, C, D, g, m, v), this.restore(C, f)) : w[C.id] = !0 : (T[k[S].id] = !0, this.render_item(k[S], f, v, g, m));\n            }\n            for (var S in w) w[S] && this.hide(S);\n            if (f.childNodes.length && b.appendChild(f, b), _) {\n              var M = {};\n              for (var S in this.rendered) $[S] && !T[S] || (M[S] = this.rendered[S], _.call(n, x[S], this.rendered[S], g));\n            }\n          }\n        },\n        append: function (k, b, g) {\n          this.rendered && (b ? (this.rendered[k.id] && this.rendered[k.id].parentNode ? this.replace_item(k.id, b) : g.appendChild(b), this.rendered[k.id] = b) : this.rendered[k.id] && this.remove_item(k.id));\n        },\n        replace_item: function (k, b) {\n          var g = this.rendered[k];\n          g && g.parentNode && g.parentNode.replaceChild(b, g), this.rendered[k] = b;\n        },\n        remove_item: function (k) {\n          this.hide(k), delete this.rendered[k];\n        },\n        hide: function (k) {\n          var b = this.rendered[k];\n          b && b.parentNode && b.parentNode.removeChild(b), delete this.rendered[k];\n        },\n        restore: function (k, b) {\n          var g = this.rendered[k.id];\n          g ? g.parentNode || this.append(k, g, b || c) : this.render_item(k, b || c);\n        },\n        change_id: function (k, b) {\n          this.rendered[b] = this.rendered[k], delete this.rendered[k];\n        },\n        rendered: i[o],\n        node: c,\n        destructor: function () {\n          this.clear(), delete a[o], delete i[o];\n        }\n      }, a[o];\n    }\n    return {\n      getRenderer: s,\n      clearRenderers: function () {\n        for (var o in a) s(o).destructor();\n      }\n    };\n  }(t);\n  return {\n    createGroup: function (n, i, a, r) {\n      var s = {\n        tempCollection: [],\n        renderers: {},\n        container: n,\n        filters: [],\n        getLayers: function () {\n          this._add();\n          var o = [];\n          for (var l in this.renderers) o.push(this.renderers[l]);\n          return o;\n        },\n        getLayer: function (o) {\n          return this.renderers[o];\n        },\n        _add: function (o) {\n          o && (o.id = o.id || st(), this.tempCollection.push(o));\n          const l = this.container(),\n            c = this.tempCollection;\n          for (let d = 0; d < c.length; d++) {\n            if (o = c[d], !(this.container() || o && o.container && o.container.isConnected)) continue;\n            let u = o.container,\n              h = o.id,\n              _ = o.topmost;\n            if (!u.parentNode) if (_) l.appendChild(u);else {\n              let p = i ? i() : l.firstChild;\n              p && p.parentNode == l ? l.insertBefore(u, p) : l.appendChild(u);\n            }\n            this.renderers[h] = e.getRenderer(h, o, u), r && r(o, t), this.tempCollection.splice(d, 1), d--;\n          }\n        },\n        addLayer: function (o) {\n          if (o) {\n            typeof o == \"function\" && (o = {\n              renderer: o\n            }), o.filter === void 0 ? o.filter = je(a || []) : o.filter instanceof Array && (o.filter.push(a), o.filter = je(o.filter)), o.container || (o.container = document.createElement(\"div\"));\n            var l = this;\n            o.requestUpdate = function () {\n              t.config.smart_rendering && !Nt(t) && l.renderers[o.id] && l.onUpdateRequest(l.renderers[o.id]);\n            };\n          }\n          return this._add(o), o ? o.id : void 0;\n        },\n        onUpdateRequest: function (o) {},\n        eachLayer: function (o) {\n          for (var l in this.renderers) o(this.renderers[l]);\n        },\n        removeLayer: function (o) {\n          this.renderers[o] && (this.renderers[o].destructor(), delete this.renderers[o]);\n        },\n        clear: function () {\n          for (var o in this.renderers) this.renderers[o].destructor();\n          this.renderers = {};\n        }\n      };\n      return t.attachEvent(\"onDestroy\", function () {\n        s.clear(), s = null;\n      }), s;\n    }\n  };\n};\nfunction je(t) {\n  return t instanceof Array || (t = Array.prototype.slice.call(arguments, 0)), function (e) {\n    for (var n = !0, i = 0, a = t.length; i < a; i++) {\n      var r = t[i];\n      r && (n = n && r(e.id, e) !== !1);\n    }\n    return n;\n  };\n}\nfunction Fe(t, e, n) {\n  if (!t.start_date || !t.end_date) return null;\n  var i = e.posFromDate(t.start_date),\n    a = e.posFromDate(t.end_date),\n    r = Math.min(i, a) - 200,\n    s = Math.max(i, a) + 200;\n  return {\n    top: e.getItemTop(t.id),\n    height: e.getItemHeight(t.id),\n    left: r,\n    width: s - r\n  };\n}\nfunction mn() {\n  var t = [],\n    e = !1;\n  function n() {\n    t = [], e = !1;\n  }\n  function i(r, s, o) {\n    s.$getConfig(), r.getVisibleItems().forEach(function (l) {\n      var c = function (d, u, h, _) {\n        if (!_.isTaskExists(d.source) || !_.isTaskExists(d.target)) return null;\n        var p = Fe(_.getTask(d.source), u),\n          y = Fe(_.getTask(d.target), u);\n        if (!p || !y) return null;\n        var k = 100,\n          b = Math.min(p.left, y.left) - k,\n          g = Math.max(p.left + p.width, y.left + y.width) + k,\n          m = Math.min(p.top, y.top) - k,\n          f = Math.max(p.top + p.height, y.top + y.height) + k;\n        return {\n          top: m,\n          height: f - m,\n          bottom: f,\n          left: b,\n          width: g - b,\n          right: g\n        };\n      }(l, s, 0, o);\n      c && t.push({\n        id: l.id,\n        rec: c\n      });\n    }), t.sort(function (l, c) {\n      return l.rec.right < c.rec.right ? -1 : 1;\n    }), e = !0;\n  }\n  var a = !1;\n  return function (r, s, o, l, c) {\n    (function (p) {\n      a || (a = !0, p.attachEvent(\"onPreFilter\", n), p.attachEvent(\"onStoreUpdated\", n), p.attachEvent(\"onClearAll\", n), p.attachEvent(\"onBeforeStoreUpdate\", n));\n    })(l), e || i(l, s, r);\n    for (var d = [], u = 0; u < t.length; u++) {\n      var h = t[u],\n        _ = h.rec;\n      _.right < c.x || _.left < c.x_end && _.right > c.x && _.top < c.y_end && _.bottom > c.y && d.push(h.id);\n    }\n    return {\n      ids: d\n    };\n  };\n}\nfunction vn(t, e, n, i, a) {\n  var r = n.$gantt.getTask(t.source),\n    s = n.$gantt.getTask(t.target),\n    o = n.getItemTop(r.id),\n    l = n.getItemHeight(r.id),\n    c = n.getItemTop(s.id),\n    d = n.getItemHeight(s.id);\n  if (e.y > o + l && e.y > c + d || e.y_end < c && e.y_end < o) return !1;\n  var u = n.posFromDate(r.start_date),\n    h = n.posFromDate(r.end_date),\n    _ = n.posFromDate(s.start_date),\n    p = n.posFromDate(s.end_date);\n  if (u > h) {\n    var y = h;\n    h = u, u = y;\n  }\n  return _ > p && (y = p, p = _, _ = y), u += -100, h += 100, _ += -100, p += 100, !(e.x > h && e.x > p) && !(e.x_end < u && e.x_end < _);\n}\nfunction ha(t, e) {\n  if (t.view) {\n    var n = t.view;\n    typeof n == \"string\" && (n = e.$ui.getView(n)), n && n.attachEvent && n.attachEvent(\"onScroll\", function () {\n      e.$services.getService(\"state\").getState(\"batchUpdate\").batch_update || n.$config.$skipSmartRenderOnScroll || t.requestUpdate && t.requestUpdate();\n    });\n  }\n}\nvar Ht = function () {\n  function t(e, n, i, a) {\n    e && (this.$container = we(e), this.$parent = e), this.$config = P(n, {\n      headerHeight: 33\n    }), this.$gantt = a, this.$domEvents = a._createDomEventScope(), this.$id = n.id || \"c\" + st(), this.$name = \"cell\", this.$factory = i, this.$externalComponent = null, ot(this);\n  }\n  return t.prototype.destructor = function () {\n    this.$parent = this.$container = this.$view = null, this.$gantt.$services.getService(\"mouseEvents\").detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler), this.$domEvents.detachAll(), this.callEvent(\"onDestroy\", []), this.detachAllEvents();\n  }, t.prototype.cell = function (e) {\n    return null;\n  }, t.prototype.scrollTo = function (e, n) {\n    var i = this.$view;\n    this.$config.html && (i = this.$view.firstChild), 1 * e == e && (i.scrollLeft = e), 1 * n == n && (i.scrollTop = n);\n  }, t.prototype.clear = function () {\n    this.getNode().innerHTML = \"\", this.getNode().className = \"gantt_layout_content\", this.getNode().style.padding = \"0\";\n  }, t.prototype.resize = function (e) {\n    if (this.$parent) return this.$parent.resize(e);\n    e === !1 && (this.$preResize = !0);\n    var n = this.$container,\n      i = n.offsetWidth,\n      a = n.offsetHeight,\n      r = this.getSize();\n    n === document.body && (i = document.body.offsetWidth, a = document.body.offsetHeight), i < r.minWidth && (i = r.minWidth), i > r.maxWidth && (i = r.maxWidth), a < r.minHeight && (a = r.minHeight), a > r.maxHeight && (a = r.maxHeight), this.setSize(i, a), this.$preResize, this.$preResize = !1;\n  }, t.prototype.hide = function () {\n    this._hide(!0), this.resize();\n  }, t.prototype.show = function (e) {\n    this._hide(!1), e && this.$parent && this.$parent.show(), this.resize();\n  }, t.prototype._hide = function (e) {\n    if (e === !0 && this.$view.parentNode) this.$view.parentNode.removeChild(this.$view);else if (e === !1 && !this.$view.parentNode) {\n      var n = this.$parent.cellIndex(this.$id);\n      this.$parent.moveView(this, n);\n    }\n    this.$config.hidden = e;\n  }, t.prototype.$toHTML = function (e, n) {\n    e === void 0 && (e = \"\"), n = [n || \"\", this.$config.css || \"\"].join(\" \");\n    var i = this.$config,\n      a = \"\";\n    if (i.raw) e = typeof i.raw == \"string\" ? i.raw : \"\";else {\n      if (!e) {\n        let r = null;\n        r = typeof i.html == \"function\" ? i.html() : i.html, this.$gantt.config.external_render && this.$gantt.config.external_render.isElement(r) && (this.$externalComponent = r, r = null), e = \"<div class='gantt_layout_content' \" + (n ? \" class='\" + n + \"' \" : \"\") + \" >\" + (r || \"\") + \"</div>\";\n      }\n      i.header && (a = \"<div class='gantt_layout_header'>\" + (i.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\") + \"<div class='gantt_layout_header_content'>\" + i.header + \"</div></div>\");\n    }\n    return \"<div class='gantt_layout_cell \" + n + \"' data-cell-id='\" + this.$id + \"'>\" + a + e + \"</div>\";\n  }, t.prototype.$fill = function (e, n) {\n    this.$view = e, this.$parent = n, this.init();\n  }, t.prototype.getNode = function () {\n    return this.$view.querySelector(\"gantt_layout_cell\") || this.$view;\n  }, t.prototype.init = function () {\n    var e = this;\n    this._headerClickHandler = function (n) {\n      nt(n, \"data-cell-id\") == e.$id && e.toggle();\n    }, this.$gantt.$services.getService(\"mouseEvents\").delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler), this.callEvent(\"onReady\", []);\n  }, t.prototype.toggle = function () {\n    this.$config.collapsed = !this.$config.collapsed, this.resize();\n  }, t.prototype.getSize = function () {\n    var e = {\n      height: this.$config.height || 0,\n      width: this.$config.width || 0,\n      gravity: this.$config.gravity || 1,\n      minHeight: this.$config.minHeight || 0,\n      minWidth: this.$config.minWidth || 0,\n      maxHeight: this.$config.maxHeight || 1e11,\n      maxWidth: this.$config.maxWidth || 1e11\n    };\n    if (this.$config.collapsed) {\n      var n = this.$config.mode === \"x\";\n      e[n ? \"width\" : \"height\"] = e[n ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\n    }\n    return e;\n  }, t.prototype.getContentSize = function () {\n    var e = this.$lastSize.contentX;\n    e !== 1 * e && (e = this.$lastSize.width);\n    var n = this.$lastSize.contentY;\n    return n !== 1 * n && (n = this.$lastSize.height), {\n      width: e,\n      height: n\n    };\n  }, t.prototype._getBorderSizes = function () {\n    var e = {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0,\n      horizontal: 0,\n      vertical: 0\n    };\n    return this._currentBorders && (this._currentBorders[this._borders.left] && (e.left = 1, e.horizontal++), this._currentBorders[this._borders.right] && (e.right = 1, e.horizontal++), this._currentBorders[this._borders.top] && (e.top = 1, e.vertical++), this._currentBorders[this._borders.bottom] && (e.bottom = 1, e.vertical++)), e;\n  }, t.prototype.setSize = function (e, n) {\n    this.$view.style.width = e + \"px\", this.$view.style.height = n + \"px\";\n    var i = this._getBorderSizes(),\n      a = n - i.vertical,\n      r = e - i.horizontal;\n    this.$lastSize = {\n      x: e,\n      y: n,\n      contentX: r,\n      contentY: a\n    }, this.$config.header ? this._sizeHeader() : this._sizeContent();\n  }, t.prototype._borders = {\n    left: \"gantt_layout_cell_border_left\",\n    right: \"gantt_layout_cell_border_right\",\n    top: \"gantt_layout_cell_border_top\",\n    bottom: \"gantt_layout_cell_border_bottom\"\n  }, t.prototype._setBorders = function (e, n) {\n    n || (n = this);\n    var i = n.$view;\n    for (var a in this._borders) Gt(i, this._borders[a]);\n    typeof e == \"string\" && (e = [e]);\n    var r = {};\n    for (a = 0; a < e.length; a++) wt(i, e[a]), r[e[a]] = !0;\n    n._currentBorders = r;\n  }, t.prototype._sizeContent = function () {\n    var e = this.$view.childNodes[0];\n    e && e.className == \"gantt_layout_content\" && (e.style.height = this.$lastSize.contentY + \"px\");\n  }, t.prototype._sizeHeader = function () {\n    var e = this.$lastSize;\n    e.contentY -= this.$config.headerHeight;\n    var n = this.$view.childNodes[0],\n      i = this.$view.childNodes[1],\n      a = this.$config.mode === \"x\";\n    if (this.$config.collapsed) {\n      if (i.style.display = \"none\", a) {\n        n.className = \"gantt_layout_header collapsed_x\", n.style.width = e.y + \"px\";\n        var r = Math.floor(e.y / 2 - e.x / 2);\n        n.style.transform = \"rotate(90deg) translate(\" + r + \"px, \" + r + \"px)\", i.style.display = \"none\";\n      } else n.className = \"gantt_layout_header collapsed_y\";\n    } else n.className = a ? \"gantt_layout_header\" : \"gantt_layout_header vertical\", n.style.width = \"auto\", n.style.transform = \"\", i.style.display = \"\", i.style.height = e.contentY + \"px\";\n    n.style.height = this.$config.headerHeight + \"px\";\n  }, t;\n}();\nfunction z(t, e) {\n  for (var n in e) e.hasOwnProperty(n) && (t[n] = e[n]);\n  function i() {\n    this.constructor = t;\n  }\n  t.prototype = e === null ? Object.create(e) : (i.prototype = e.prototype, new i());\n}\nvar kn = function (t) {\n    function e(n, i, a) {\n      var r = t.apply(this, arguments) || this;\n      return n && (r.$root = !0), r._parseConfig(i), r.$name = \"layout\", r;\n    }\n    return z(e, t), e.prototype.destructor = function () {\n      this.$container && this.$view && Qe(this.$view);\n      for (var n = 0; n < this.$cells.length; n++) this.$cells[n].destructor();\n      this.$cells = [], t.prototype.destructor.call(this);\n    }, e.prototype._resizeScrollbars = function (n, i) {\n      var a = !1,\n        r = [],\n        s = [];\n      const o = [];\n      function l(p) {\n        p.$parent.show(), a = !0, r.push(p);\n      }\n      function c(p) {\n        p.$parent.hide(), a = !0, s.push(p);\n      }\n      for (var d, u = 0; u < i.length; u++) n[(d = i[u]).$config.scroll] ? c(d) : d.shouldHide() ? o.push(d) : d.shouldShow() ? l(d) : d.isVisible() ? r.push(d) : s.push(d);\n      var h = {};\n      for (u = 0; u < r.length; u++) r[u].$config.group && (h[r[u].$config.group] = !0);\n      for (o.forEach(function (p) {\n        p.$config.group && h[p.$config.group] || c(p);\n      }), u = 0; u < s.length; u++) if ((d = s[u]).$config.group && h[d.$config.group]) {\n        l(d);\n        for (var _ = 0; _ < r.length; _++) if (r[_] == d) {\n          this.$gantt.$scrollbarRepaint = !0;\n          break;\n        }\n      }\n      return a;\n    }, e.prototype.getScrollbarsInfo = function () {\n      const n = this.getCellsByType(\"scroller\"),\n        i = [];\n      return n.forEach(a => {\n        let r = {};\n        const {\n          visible: s,\n          direction: o,\n          size: l,\n          scrollSize: c,\n          position: d\n        } = a.getScrollState();\n        let u = a._getLinkedViews().map(h => h.$config.id);\n        r.id = a.$id, r.visible = s, r.boundViews = u, o === \"x\" ? (r.x = l, r.x_inner = c, r.x_pos = d || 0) : (r.y = l, r.y_inner = c, r.y_pos = d || 0), i.push(r);\n      }), i;\n    }, e.prototype._syncCellSizes = function (n, i) {\n      if (n) {\n        var a = {};\n        return this._eachChild(function (r) {\n          r.$config.group && r.$name != \"scrollbar\" && r.$name != \"resizer\" && (a[r.$config.group] || (a[r.$config.group] = []), a[r.$config.group].push(r));\n        }), a[n] && this._syncGroupSize(a[n], i), a[n];\n      }\n    }, e.prototype._syncGroupSize = function (n, i) {\n      if (n.length) for (var a = n[0].$parent._xLayout ? \"width\" : \"height\", r = n[0].$parent.getNextSibling(n[0].$id) ? 1 : -1, s = i.value, o = i.isGravity, l = 0; l < n.length; l++) {\n        var c = n[l].getSize(),\n          d = r > 0 ? n[l].$parent.getNextSibling(n[l].$id) : n[l].$parent.getPrevSibling(n[l].$id);\n        d.$name == \"resizer\" && (d = r > 0 ? d.$parent.getNextSibling(d.$id) : d.$parent.getPrevSibling(d.$id));\n        var u = d.getSize();\n        if (o) n[l].$config.gravity = s;else if (d[a]) {\n          var h = c.gravity + u.gravity,\n            _ = c[a] + u[a],\n            p = h / _;\n          n[l].$config.gravity = p * s, d.$config[a] = _ - s, d.$config.gravity = h - p * s;\n        } else n[l].$config[a] = s;\n        var y = this.$gantt.$ui.getView(\"grid\");\n        !y || n[l].$content !== y || y.$config.scrollable || o || (this.$gantt.config.grid_width = s);\n      }\n    }, e.prototype.resize = function (n) {\n      var i = !1;\n      if (this.$root && !this._resizeInProgress && (this.callEvent(\"onBeforeResize\", []), i = !0, this._resizeInProgress = !0), t.prototype.resize.call(this, !0), t.prototype.resize.call(this, !1), i) {\n        var a = [];\n        a = (a = (a = a.concat(this.getCellsByType(\"viewCell\"))).concat(this.getCellsByType(\"viewLayout\"))).concat(this.getCellsByType(\"hostCell\"));\n        for (var r = this.getCellsByType(\"scroller\"), s = 0; s < a.length; s++) a[s].$config.hidden || a[s].setContentSize();\n        var o = this._getAutosizeMode(this.$config.autosize),\n          l = this._resizeScrollbars(o, r);\n        if (this.$config.autosize && (this.autosize(this.$config.autosize), a.forEach(function (c) {\n          const d = c.$parent,\n            u = d.getContentSize(o);\n          o.x && (d.$config.$originalWidthStored || (d.$config.$originalWidthStored = !0, d.$config.$originalWidth = d.$config.width), d.$config.width = u.width), o.y && (d.$config.$originalHeightStored || (d.$config.$originalHeightStored = !0, d.$config.$originalHeight = d.$config.height), d.$config.height = u.height);\n        }), l = !0), l) for (this.resize(), s = 0; s < a.length; s++) a[s].$config.hidden || a[s].setContentSize();\n        this.callEvent(\"onResize\", []);\n      }\n      i && (this._resizeInProgress = !1);\n    }, e.prototype._eachChild = function (n, i) {\n      if (n(i = i || this), i.$cells) for (var a = 0; a < i.$cells.length; a++) this._eachChild(n, i.$cells[a]);\n    }, e.prototype.isChild = function (n) {\n      var i = !1;\n      return this._eachChild(function (a) {\n        a !== n && a.$content !== n || (i = !0);\n      }), i;\n    }, e.prototype.getCellsByType = function (n) {\n      var i = [];\n      if (n === this.$name && i.push(this), this.$content && this.$content.$name == n && i.push(this.$content), this.$cells) for (var a = 0; a < this.$cells.length; a++) {\n        var r = e.prototype.getCellsByType.call(this.$cells[a], n);\n        r.length && i.push.apply(i, r);\n      }\n      return i;\n    }, e.prototype.getNextSibling = function (n) {\n      var i = this.cellIndex(n);\n      return i >= 0 && this.$cells[i + 1] ? this.$cells[i + 1] : null;\n    }, e.prototype.getPrevSibling = function (n) {\n      var i = this.cellIndex(n);\n      return i >= 0 && this.$cells[i - 1] ? this.$cells[i - 1] : null;\n    }, e.prototype.cell = function (n) {\n      for (var i = 0; i < this.$cells.length; i++) {\n        var a = this.$cells[i];\n        if (a.$id === n) return a;\n        var r = a.cell(n);\n        if (r) return r;\n      }\n    }, e.prototype.cellIndex = function (n) {\n      for (var i = 0; i < this.$cells.length; i++) if (this.$cells[i].$id === n) return i;\n      return -1;\n    }, e.prototype.moveView = function (n, i) {\n      if (this.$cells[i] !== n) return window.alert(\"Not implemented\");\n      i += this.$config.header ? 1 : 0;\n      var a = this.$view;\n      i >= a.childNodes.length ? a.appendChild(n.$view) : a.insertBefore(n.$view, a.childNodes[i]);\n    }, e.prototype._parseConfig = function (n) {\n      this.$cells = [], this._xLayout = !n.rows;\n      for (var i = n.rows || n.cols || n.views, a = 0; a < i.length; a++) {\n        var r = i[a];\n        r.mode = this._xLayout ? \"x\" : \"y\";\n        var s = this.$factory.initUI(r, this);\n        s ? (s.$parent = this, this.$cells.push(s)) : (i.splice(a, 1), a--);\n      }\n    }, e.prototype.getCells = function () {\n      return this.$cells;\n    }, e.prototype.render = function () {\n      var n = Ze(this.$container, this.$toHTML());\n      this.$fill(n, null);\n      const i = this.$gantt;\n      this._eachChild(a => {\n        a.$externalComponent && (i.config.external_render.renderElement(a.$externalComponent, a.$view.querySelector(\".gantt_layout_content\")), a.$externalComponent = null);\n      }), this.callEvent(\"onReady\", []), this.resize(), this.render = this.resize;\n    }, e.prototype.$fill = function (n, i) {\n      this.$view = n, this.$parent = i;\n      for (var a = tn(n, \"gantt_layout_cell\"), r = a.length - 1; r >= 0; r--) {\n        var s = this.$cells[r];\n        s.$fill(a[r], this), s.$config.hidden && s.$view.parentNode.removeChild(s.$view);\n      }\n    }, e.prototype.$toHTML = function () {\n      for (var n = this._xLayout ? \"x\" : \"y\", i = [], a = 0; a < this.$cells.length; a++) i.push(this.$cells[a].$toHTML());\n      return t.prototype.$toHTML.call(this, i.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + n);\n    }, e.prototype.getContentSize = function (n) {\n      for (var i, a, r, s = 0, o = 0, l = 0; l < this.$cells.length; l++) (a = this.$cells[l]).$config.hidden || (i = a.getContentSize(n), a.$config.view === \"scrollbar\" && n[a.$config.scroll] && (i.height = 0, i.width = 0), a.$config.resizer && (this._xLayout ? i.height = 0 : i.width = 0), r = a._getBorderSizes(), this._xLayout ? (s += i.width + r.horizontal, o = Math.max(o, i.height + r.vertical)) : (s = Math.max(s, i.width + r.horizontal), o += i.height + r.vertical));\n      return {\n        width: s += (r = this._getBorderSizes()).horizontal,\n        height: o += r.vertical\n      };\n    }, e.prototype._cleanElSize = function (n) {\n      return 1 * (n || \"\").toString().replace(\"px\", \"\") || 0;\n    }, e.prototype._getBoxStyles = function (n) {\n      var i = null,\n        a = [\"width\", \"height\", \"paddingTop\", \"paddingBottom\", \"paddingLeft\", \"paddingRight\", \"borderLeftWidth\", \"borderRightWidth\", \"borderTopWidth\", \"borderBottomWidth\"],\n        r = {\n          boxSizing: (i = window.getComputedStyle ? window.getComputedStyle(n, null) : {\n            width: n.clientWidth,\n            height: n.clientHeight\n          }).boxSizing == \"border-box\"\n        };\n      i.MozBoxSizing && (r.boxSizing = i.MozBoxSizing == \"border-box\");\n      for (var s = 0; s < a.length; s++) r[a[s]] = i[a[s]] ? this._cleanElSize(i[a[s]]) : 0;\n      var o = {\n        horPaddings: r.paddingLeft + r.paddingRight + r.borderLeftWidth + r.borderRightWidth,\n        vertPaddings: r.paddingTop + r.paddingBottom + r.borderTopWidth + r.borderBottomWidth,\n        borderBox: r.boxSizing,\n        innerWidth: r.width,\n        innerHeight: r.height,\n        outerWidth: r.width,\n        outerHeight: r.height\n      };\n      return o.borderBox ? (o.innerWidth -= o.horPaddings, o.innerHeight -= o.vertPaddings) : (o.outerWidth += o.horPaddings, o.outerHeight += o.vertPaddings), o;\n    }, e.prototype._getAutosizeMode = function (n) {\n      var i = {\n        x: !1,\n        y: !1\n      };\n      return n === \"xy\" ? i.x = i.y = !0 : n === \"y\" || n === !0 ? i.y = !0 : n === \"x\" && (i.x = !0), i;\n    }, e.prototype.autosize = function (n) {\n      var i = this._getAutosizeMode(n),\n        a = this._getBoxStyles(this.$container),\n        r = this.getContentSize(n),\n        s = this.$container;\n      i.x && (a.borderBox && (r.width += a.horPaddings), s.style.width = r.width + \"px\"), i.y && (a.borderBox && (r.height += a.vertPaddings), s.style.height = r.height + \"px\");\n    }, e.prototype.getSize = function () {\n      this._sizes = [];\n      for (var n = 0, i = 0, a = 1e11, r = 0, s = 1e11, o = 0, l = 0; l < this.$cells.length; l++) {\n        var c = this._sizes[l] = this.$cells[l].getSize();\n        this.$cells[l].$config.hidden || (this._xLayout ? (!c.width && c.minWidth ? n += c.minWidth : n += c.width, a += c.maxWidth, i += c.minWidth, r = Math.max(r, c.height), s = Math.min(s, c.maxHeight), o = Math.max(o, c.minHeight)) : (!c.height && c.minHeight ? r += c.minHeight : r += c.height, s += c.maxHeight, o += c.minHeight, n = Math.max(n, c.width), a = Math.min(a, c.maxWidth), i = Math.max(i, c.minWidth)));\n      }\n      var d = t.prototype.getSize.call(this);\n      return d.maxWidth >= 1e5 && (d.maxWidth = a), d.maxHeight >= 1e5 && (d.maxHeight = s), d.minWidth = d.minWidth != d.minWidth ? 0 : d.minWidth, d.minHeight = d.minHeight != d.minHeight ? 0 : d.minHeight, this._xLayout ? (d.minWidth += this.$config.margin * this.$cells.length || 0, d.minWidth += 2 * this.$config.padding || 0, d.minHeight += 2 * this.$config.padding || 0) : (d.minHeight += this.$config.margin * this.$cells.length || 0, d.minHeight += 2 * this.$config.padding || 0), d;\n    }, e.prototype._calcFreeSpace = function (n, i, a) {\n      var r = a ? i.minWidth : i.minHeight,\n        s = i.maxWidth,\n        o = n;\n      return o ? (o > s && (o = s), o < r && (o = r), this._free -= o) : ((o = Math.floor(this._free / this._gravity * i.gravity)) > s && (o = s, this._free -= o, this._gravity -= i.gravity), o < r && (o = r, this._free -= o, this._gravity -= i.gravity)), o;\n    }, e.prototype._calcSize = function (n, i, a) {\n      var r = n,\n        s = a ? i.minWidth : i.minHeight,\n        o = a ? i.maxWidth : i.maxHeight;\n      return r || (r = Math.floor(this._free / this._gravity * i.gravity)), r > o && (r = o), r < s && (r = s), r;\n    }, e.prototype._configureBorders = function () {\n      this.$root && this._setBorders([this._borders.left, this._borders.top, this._borders.right, this._borders.bottom], this);\n      for (var n = this._xLayout ? this._borders.right : this._borders.bottom, i = this.$cells, a = i.length - 1, r = a; r >= 0; r--) if (!i[r].$config.hidden) {\n        a = r;\n        break;\n      }\n      for (r = 0; r < i.length; r++) if (!i[r].$config.hidden) {\n        var s = r >= a,\n          o = \"\";\n        !s && i[r + 1] && i[r + 1].$config.view == \"scrollbar\" && (this._xLayout ? s = !0 : o = \"gantt_layout_cell_border_transparent\"), this._setBorders(s ? [] : [n, o], i[r]);\n      }\n    }, e.prototype._updateCellVisibility = function () {\n      for (var n = this._visibleCells || {}, i = !this._visibleCells, a = {}, r = null, s = [], o = 0; o < this._sizes.length; o++) (r = this.$cells[o]).$config.hide_empty && s.push(r), !i && r.$config.hidden && n[r.$id] ? r._hide(!0) : r.$config.hidden || n[r.$id] || r._hide(!1), r.$config.hidden || (a[r.$id] = !0);\n      for (this._visibleCells = a, o = 0; o < s.length; o++) {\n        var l = (r = s[o]).$cells,\n          c = !0;\n        l.forEach(function (d) {\n          d.$config.hidden || d.$config.resizer || (c = !1);\n        }), r.$config.hidden = c;\n      }\n    }, e.prototype.setSize = function (n, i) {\n      this._configureBorders(), t.prototype.setSize.call(this, n, i), i = this.$lastSize.contentY, n = this.$lastSize.contentX;\n      var a,\n        r,\n        s = this.$config.padding || 0;\n      this.$view.style.padding = s + \"px\", this._gravity = 0, this._free = this._xLayout ? n : i, this._free -= 2 * s, this._updateCellVisibility();\n      for (var o = 0; o < this._sizes.length; o++) if (!(a = this.$cells[o]).$config.hidden) {\n        var l = this.$config.margin || 0;\n        a.$name != \"resizer\" || l || (l = -1);\n        var c = a.$view,\n          d = this._xLayout ? \"marginRight\" : \"marginBottom\";\n        o !== this.$cells.length - 1 && (c.style[d] = l + \"px\", this._free -= l), r = this._sizes[o], this._xLayout ? r.width || (this._gravity += r.gravity) : r.height || (this._gravity += r.gravity);\n      }\n      for (o = 0; o < this._sizes.length; o++) if (!(a = this.$cells[o]).$config.hidden) {\n        var u = (r = this._sizes[o]).width,\n          h = r.height;\n        this._xLayout ? this._calcFreeSpace(u, r, !0) : this._calcFreeSpace(h, r, !1);\n      }\n      for (o = 0; o < this.$cells.length; o++) if (!(a = this.$cells[o]).$config.hidden) {\n        r = this._sizes[o];\n        var _ = void 0,\n          p = void 0;\n        this._xLayout ? (_ = this._calcSize(r.width, r, !0), p = i - 2 * s) : (_ = n - 2 * s, p = this._calcSize(r.height, r, !1)), a.setSize(_, p);\n      }\n    }, e;\n  }(Ht),\n  _a = function (t) {\n    function e(n, i, a) {\n      for (var r = t.apply(this, arguments) || this, s = 0; s < r.$cells.length; s++) r.$cells[s].$config.hidden = s !== 0;\n      return r.$cell = r.$cells[0], r.$name = \"viewLayout\", r;\n    }\n    return z(e, t), e.prototype.cell = function (n) {\n      var i = t.prototype.cell.call(this, n);\n      return i.$view || this.$fill(null, this), i;\n    }, e.prototype.moveView = function (n) {\n      var i = this.$view;\n      this.$cell && (this.$cell.$config.hidden = !0, i.removeChild(this.$cell.$view)), this.$cell = n, i.appendChild(n.$view);\n    }, e.prototype.setSize = function (n, i) {\n      Ht.prototype.setSize.call(this, n, i);\n    }, e.prototype.setContentSize = function () {\n      var n = this.$lastSize;\n      this.$cell.setSize(n.contentX, n.contentY);\n    }, e.prototype.getSize = function () {\n      var n = t.prototype.getSize.call(this);\n      if (this.$cell) {\n        var i = this.$cell.getSize();\n        if (this.$config.byMaxSize) for (var a = 0; a < this.$cells.length; a++) {\n          var r = this.$cells[a].getSize();\n          for (var s in i) i[s] = Math.max(i[s], r[s]);\n        }\n        for (var o in n) n[o] = n[o] || i[o];\n        n.gravity = Math.max(n.gravity, i.gravity);\n      }\n      return n;\n    }, e;\n  }(kn),\n  ga = function (t) {\n    function e(n, i, a) {\n      var r = t.apply(this, arguments) || this;\n      if (i.view) {\n        i.id && (this.$id = st());\n        var s = q(i);\n        if (delete s.config, delete s.templates, this.$content = this.$factory.createView(i.view, this, s, this), !this.$content) return !1;\n      }\n      return r.$name = \"viewCell\", r;\n    }\n    return z(e, t), e.prototype.destructor = function () {\n      this.clear(), t.prototype.destructor.call(this);\n    }, e.prototype.clear = function () {\n      if (this.$initialized = !1, this.$content) {\n        var n = this.$content.unload || this.$content.destructor;\n        n && n.call(this.$content);\n      }\n      t.prototype.clear.call(this);\n    }, e.prototype.scrollTo = function (n, i) {\n      this.$content && this.$content.scrollTo ? this.$content.scrollTo(n, i) : t.prototype.scrollTo.call(this, n, i);\n    }, e.prototype._setContentSize = function (n, i) {\n      var a = this._getBorderSizes();\n      if (typeof n == \"number\") {\n        var r = n + a.horizontal;\n        this.$config.width = r;\n      }\n      if (typeof i == \"number\") {\n        var s = i + a.vertical;\n        this.$config.height = s;\n      }\n    }, e.prototype.setSize = function (n, i) {\n      if (t.prototype.setSize.call(this, n, i), !this.$preResize && this.$content && !this.$initialized) {\n        this.$initialized = !0;\n        var a = this.$view.childNodes[0],\n          r = this.$view.childNodes[1];\n        r || (r = a), this.$content.init(r);\n      }\n    }, e.prototype.setContentSize = function () {\n      !this.$preResize && this.$content && this.$initialized && this.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\n    }, e.prototype.getContentSize = function () {\n      var n = t.prototype.getContentSize.call(this);\n      if (this.$content && this.$initialized) {\n        var i = this.$content.getSize();\n        n.width = i.contentX === void 0 ? i.width : i.contentX, n.height = i.contentY === void 0 ? i.height : i.contentY;\n      }\n      var a = this._getBorderSizes();\n      return n.width += a.horizontal, n.height += a.vertical, n;\n    }, e;\n  }(Ht),\n  fa = function (t) {\n    var e = [\"altKey\", \"shiftKey\", \"metaKey\"];\n    function n(a, r, s, o) {\n      var l = t.apply(this, arguments) || this;\n      this.$config = P(r, {\n        scroll: \"x\"\n      }), l._scrollHorizontalHandler = R(l._scrollHorizontalHandler, l), l._scrollVerticalHandler = R(l._scrollVerticalHandler, l), l._outerScrollVerticalHandler = R(l._outerScrollVerticalHandler, l), l._outerScrollHorizontalHandler = R(l._outerScrollHorizontalHandler, l), l._mouseWheelHandler = R(l._mouseWheelHandler, l), this.$config.hidden = !0;\n      var c = o.config.scroll_size;\n      return o.env.isIE && (c += 1), this._isHorizontal() ? (l.$config.height = c, l.$parent.$config.height = c) : (l.$config.width = c, l.$parent.$config.width = c), this.$config.scrollPosition = 0, l.$name = \"scroller\", l;\n    }\n    function i(a, r) {\n      if (r.push(a), a.$cells) for (var s = 0; s < a.$cells.length; s++) i(a.$cells[s], r);\n    }\n    return z(n, t), n.prototype.init = function (a) {\n      a.innerHTML = this.$toHTML(), this.$view = a.firstChild, this.$view || this.init(), this._isVertical() ? this._initVertical() : this._initHorizontal(), this._initMouseWheel(), this._initLinkedViews();\n    }, n.prototype.$toHTML = function () {\n      return \"<div class='gantt_layout_cell \" + (this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\") + \"'><div style='\" + (this._isHorizontal() ? \"width:2000px\" : \"height:2000px\") + \"'></div></div>\";\n    }, n.prototype._getRootParent = function () {\n      for (var a = this.$parent; a && a.$parent;) a = a.$parent;\n      if (a) return a;\n    }, n.prototype._eachView = function () {\n      var a = [];\n      return i(this._getRootParent(), a), a;\n    }, n.prototype._getLinkedViews = function () {\n      for (var a = this._eachView(), r = [], s = 0; s < a.length; s++) a[s].$config && (this._isVertical() && a[s].$config.scrollY == this.$id || this._isHorizontal() && a[s].$config.scrollX == this.$id) && r.push(a[s]);\n      return r;\n    }, n.prototype._initHorizontal = function () {\n      this.$scroll_hor = this.$view, this.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\n    }, n.prototype._initLinkedViews = function () {\n      for (var a = this._getLinkedViews(), r = this._isVertical() ? \"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\", s = 0; s < a.length; s++) wt(a[s].$view || a[s].getNode(), r);\n    }, n.prototype._initVertical = function () {\n      this.$scroll_ver = this.$view, this.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\n    }, n.prototype._updateLinkedViews = function () {}, n.prototype._initMouseWheel = function () {\n      mt.isFF ? this.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {\n        passive: !1\n      }) : this.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {\n        passive: !1\n      });\n    }, n.prototype.scrollHorizontally = function (a) {\n      if (!this._scrolling) {\n        this._scrolling = !0, this.$scroll_hor.scrollLeft = a, this.$config.codeScrollLeft = a, a = this.$scroll_hor.scrollLeft;\n        for (var r = this._getLinkedViews(), s = 0; s < r.length; s++) r[s].scrollTo && r[s].scrollTo(a, void 0);\n        var o = this.$config.scrollPosition;\n        this.$config.scrollPosition = a, this.callEvent(\"onScroll\", [o, a, this.$config.scroll]), this._scrolling = !1;\n      }\n    }, n.prototype.scrollVertically = function (a) {\n      if (!this._scrolling) {\n        this._scrolling = !0, this.$scroll_ver.scrollTop = a, a = this.$scroll_ver.scrollTop;\n        for (var r = this._getLinkedViews(), s = 0; s < r.length; s++) r[s].scrollTo && r[s].scrollTo(void 0, a);\n        var o = this.$config.scrollPosition;\n        this.$config.scrollPosition = a, this.callEvent(\"onScroll\", [o, a, this.$config.scroll]), this._scrolling = !1;\n      }\n    }, n.prototype._isVertical = function () {\n      return this.$config.scroll == \"y\";\n    }, n.prototype._isHorizontal = function () {\n      return this.$config.scroll == \"x\";\n    }, n.prototype._scrollHorizontalHandler = function (a) {\n      if (!this._isVertical() && !this._scrolling) {\n        if (/* @__PURE__ */new Date() - (this._wheel_time || 0) < 100) return !0;\n        var r = this.$scroll_hor.scrollLeft;\n        this.scrollHorizontally(r), this._oldLeft = this.$scroll_hor.scrollLeft;\n      }\n    }, n.prototype._outerScrollHorizontalHandler = function (a) {\n      this._isVertical();\n    }, n.prototype.show = function () {\n      this.$parent.show();\n    }, n.prototype.hide = function () {\n      this.$parent.hide();\n    }, n.prototype._getScrollSize = function () {\n      for (var a, r = 0, s = 0, o = this._isHorizontal(), l = this._getLinkedViews(), c = o ? \"scrollWidth\" : \"scrollHeight\", d = o ? \"contentX\" : \"contentY\", u = o ? \"x\" : \"y\", h = this._getScrollOffset(), _ = 0; _ < l.length; _++) if ((a = l[_]) && a.$content && a.$content.getSize && !a.$config.hidden) {\n        var p,\n          y = a.$content.getSize();\n        if (p = y.hasOwnProperty(c) ? y[c] : y[d], h) y[d] > y[u] && y[d] > r && p > y[u] - h + 2 && (r = p + (o ? 0 : 2), s = y[u]);else {\n          var k = Math.max(y[d] - p, 0);\n          (p += k) > Math.max(y[u] - k, 0) && p > r && (r = p, s = y[u]);\n        }\n      }\n      return {\n        outerScroll: s,\n        innerScroll: r\n      };\n    }, n.prototype.scroll = function (a) {\n      this._isHorizontal() ? this.scrollHorizontally(a) : this.scrollVertically(a);\n    }, n.prototype.getScrollState = function () {\n      return {\n        visible: this.isVisible(),\n        direction: this.$config.scroll,\n        size: this.$config.outerSize,\n        scrollSize: this.$config.scrollSize || 0,\n        position: this.$config.scrollPosition || 0\n      };\n    }, n.prototype.setSize = function (a, r) {\n      t.prototype.setSize.apply(this, arguments);\n      var s = this._getScrollSize(),\n        o = (this._isVertical() ? r : a) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\n      s.innerScroll && o > s.outerScroll && (s.innerScroll += o - s.outerScroll), this.$config.scrollSize = s.innerScroll, this.$config.width = a, this.$config.height = r, this._setScrollSize(s.innerScroll);\n    }, n.prototype.isVisible = function () {\n      return !(!this.$parent || !this.$parent.$view.parentNode);\n    }, n.prototype.shouldShow = function () {\n      var a = this._getScrollSize();\n      return !(!a.innerScroll && this.$parent && this.$parent.$view.parentNode) && !(!a.innerScroll || this.$parent && this.$parent.$view.parentNode);\n    }, n.prototype.shouldHide = function () {\n      return !(this._getScrollSize().innerScroll || !this.$parent || !this.$parent.$view.parentNode);\n    }, n.prototype.toggleVisibility = function () {\n      this.shouldHide() ? this.hide() : this.shouldShow() && this.show();\n    }, n.prototype._getScaleOffset = function (a) {\n      var r = 0;\n      return !a || a.$config.view != \"timeline\" && a.$config.view != \"grid\" || (r = a.$content.$getConfig().scale_height), r;\n    }, n.prototype._getScrollOffset = function () {\n      var a = 0;\n      if (this._isVertical()) {\n        var r = this.$parent.$parent;\n        a = Math.max(this._getScaleOffset(r.getPrevSibling(this.$parent.$id)), this._getScaleOffset(r.getNextSibling(this.$parent.$id)));\n      } else for (var s = this._getLinkedViews(), o = 0; o < s.length; o++) {\n        var l = s[o].$parent.$cells,\n          c = l[l.length - 1];\n        if (c && c.$config.view == \"scrollbar\" && c.$config.hidden === !1) {\n          a = c.$config.width;\n          break;\n        }\n      }\n      return a || 0;\n    }, n.prototype._setScrollSize = function (a) {\n      var r = this._isHorizontal() ? \"width\" : \"height\",\n        s = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver,\n        o = this._getScrollOffset(),\n        l = s.firstChild;\n      o ? this._isVertical() ? (this.$config.outerSize = this.$config.height - o + 3, s.style.height = this.$config.outerSize + \"px\", s.style.top = o - 1 + \"px\", wt(s, this.$parent._borders.top), wt(s.parentNode, \"gantt_task_vscroll\")) : (this.$config.outerSize = this.$config.width - o + 1, s.style.width = this.$config.outerSize + \"px\") : (s.style.top = \"auto\", Gt(s, this.$parent._borders.top), Gt(s.parentNode, \"gantt_task_vscroll\"), this.$config.outerSize = this.$config.height), l.style[r] = a + \"px\";\n    }, n.prototype._scrollVerticalHandler = function (a) {\n      if (!this._scrollHorizontalHandler() && !this._scrolling) {\n        var r = this.$scroll_ver.scrollTop;\n        r != this._oldTop && (this.scrollVertically(r), this._oldTop = this.$scroll_ver.scrollTop);\n      }\n    }, n.prototype._outerScrollVerticalHandler = function (a) {\n      this._scrollHorizontalHandler();\n    }, n.prototype._checkWheelTarget = function (a) {\n      for (var r = this._getLinkedViews().concat(this), s = 0; s < r.length; s++) if (Y(a, r[s].$view)) return !0;\n      return !1;\n    }, n.prototype._mouseWheelHandler = function (a) {\n      var r = a.target || a.srcElement;\n      if (this._checkWheelTarget(r)) {\n        this._wheel_time = /* @__PURE__ */new Date();\n        var s = {},\n          o = {\n            x: 1,\n            y: 1\n          },\n          l = this.$gantt.config.wheel_scroll_sensitivity;\n        typeof l == \"number\" && l ? o = {\n          x: l,\n          y: l\n        } : {}.toString.apply(l) == \"[object Object]\" && (o = {\n          x: l.x,\n          y: l.y\n        });\n        var c = mt.isFF,\n          d = c ? a.deltaX : a.wheelDeltaX,\n          u = c ? a.deltaY : a.wheelDelta,\n          h = -20;\n        if (c) {\n          const v = parseInt(navigator.userAgent.split(\"Firefox/\")[1]);\n          h = v <= 87 ? a.deltaMode !== 0 ? -40 : -10 : v <= 90 ? -3 : v <= 96 ? -1.5 : -1;\n        }\n        var _ = c ? d * h * o.x : 2 * d * o.x,\n          p = c ? u * h * o.y : u * o.y,\n          y = this.$gantt.config.horizontal_scroll_key;\n        if (y !== !1 && e.indexOf(y) >= 0 && (!a[y] || a.deltaX || a.wheelDeltaX || (_ = 2 * p, p = 0)), _ && Math.abs(_) > Math.abs(p)) {\n          if (this._isVertical()) return;\n          if (s.x || !this.$scroll_hor || !this.$scroll_hor.offsetWidth) return !0;\n          var k = _ / -40,\n            b = this._oldLeft,\n            g = b + 30 * k;\n          if (this.scrollHorizontally(g), this.$scroll_hor.scrollLeft = g, b == this.$scroll_hor.scrollLeft) return !0;\n          this._oldLeft = this.$scroll_hor.scrollLeft;\n        } else {\n          if (this._isHorizontal()) return;\n          if (s.y || !this.$scroll_ver || !this.$scroll_ver.offsetHeight) return !0;\n          k = p / -40, p === void 0 && (k = a.detail);\n          var m = this._oldTop,\n            f = this.$scroll_ver.scrollTop + 30 * k;\n          if (this.scrollVertically(f), this.$scroll_ver.scrollTop = f, m == this.$scroll_ver.scrollTop) return !0;\n          this._oldTop = this.$scroll_ver.scrollTop;\n        }\n        return a.preventDefault && a.preventDefault(), a.cancelBubble = !0, !1;\n      }\n    }, n;\n  }(Ht);\nfunction yn(t) {\n  var e = {},\n    n = {},\n    i = null,\n    a = -1,\n    r = null,\n    s = /* @__PURE__ */function (o) {\n      var l = -1,\n        c = -1;\n      return {\n        resetCache: function () {\n          l = -1, c = -1;\n        },\n        _getRowHeight: function () {\n          return l === -1 && (l = o.$getConfig().row_height), l;\n        },\n        _refreshState: function () {\n          this.resetCache(), c = !0;\n          var d = o.$config.rowStore;\n          if (d) for (var u = this._getRowHeight(), h = 0; h < d.fullOrder.length; h++) {\n            var _ = d.getItem(d.fullOrder[h]);\n            if (_ && _.row_height && _.row_height !== u) {\n              c = !1;\n              break;\n            }\n          }\n        },\n        canUseSimpleCalculation: function () {\n          return c === -1 && this._refreshState(), c;\n        },\n        getRowTop: function (d) {\n          return o.$config.rowStore ? d * this._getRowHeight() : 0;\n        },\n        getItemHeight: function (d) {\n          return this._getRowHeight();\n        },\n        getTotalHeight: function () {\n          return o.$config.rowStore ? o.$config.rowStore.countVisible() * this._getRowHeight() : 0;\n        },\n        getItemIndexByTopPosition: function (d) {\n          return o.$config.rowStore ? Math.floor(d / this._getRowHeight()) : 0;\n        }\n      };\n    }(t);\n  return {\n    _resetTopPositionHeight: function () {\n      e = {}, n = {}, s.resetCache();\n    },\n    _resetHeight: function () {\n      var o = this.$config.rowStore,\n        l = this.getCacheStateTotalHeight(o);\n      r ? this.shouldClearHeightCache(r, l) && (r = l, i = null) : r = l, a = -1, s.resetCache();\n    },\n    getRowTop: function (o) {\n      if (s.canUseSimpleCalculation()) return s.getRowTop(o);\n      var l = this.$config.rowStore;\n      if (!l) return 0;\n      if (n[o] !== void 0) return n[o];\n      for (var c = l.getIndexRange(), d = 0, u = 0, h = 0; h < c.length; h++) n[h] = d, d += this.getItemHeight(c[h].id), h < o && (u = d);\n      return u;\n    },\n    getItemTop: function (o) {\n      if (this.$config.rowStore) {\n        if (e[o] !== void 0) return e[o];\n        var l = this.$config.rowStore;\n        if (!l) return 0;\n        var c = l.getIndexById(o);\n        if (c === -1 && l.getParent && l.exists(o)) {\n          var d = l.getParent(o);\n          if (l.exists(d)) {\n            var u = l.getItem(d);\n            if (this.$gantt.isSplitTask(u)) return this.getItemTop(d);\n          }\n        }\n        return e[o] = this.getRowTop(c), e[o];\n      }\n      return 0;\n    },\n    getItemHeight: function (o) {\n      if (s.canUseSimpleCalculation()) return s.getItemHeight(o);\n      if (!i && this.$config.rowStore && this._fillHeightCache(this.$config.rowStore), i[o] !== void 0) return i[o];\n      var l = this.$getConfig().row_height;\n      if (this.$config.rowStore) {\n        var c = this.$config.rowStore;\n        if (!c) return l;\n        var d = c.getItem(o);\n        return i[o] = d && d.row_height || l;\n      }\n      return l;\n    },\n    _fillHeightCache: function (o) {\n      if (o) {\n        i = {};\n        var l = this.$getConfig().row_height;\n        o.eachItem(function (c) {\n          return i[c.id] = c && c.row_height || l;\n        });\n      }\n    },\n    getCacheStateTotalHeight: function (o) {\n      var l = this.$getConfig().row_height,\n        c = {},\n        d = [],\n        u = 0;\n      return o && o.eachItem(function (h) {\n        d.push(h), c[h.id] = h.row_height, u += h.row_height || l;\n      }), {\n        globalHeight: l,\n        items: d,\n        count: d.length,\n        sumHeight: u\n      };\n    },\n    shouldClearHeightCache: function (o, l) {\n      if (o.count != l.count || o.globalHeight != l.globalHeight || o.sumHeight != l.sumHeight) return !0;\n      for (var c in o.items) {\n        var d = l.items[c];\n        if (d !== void 0 && d != o.items[c]) return !0;\n      }\n      return !1;\n    },\n    getTotalHeight: function () {\n      if (s.canUseSimpleCalculation()) return s.getTotalHeight();\n      if (a != -1) return a;\n      if (this.$config.rowStore) {\n        var o = this.$config.rowStore;\n        this._fillHeightCache(o);\n        var l = this.getItemHeight.bind(this),\n          c = o.getVisibleItems(),\n          d = 0;\n        return c.forEach(function (u) {\n          d += l(u.id);\n        }), a = d, d;\n      }\n      return 0;\n    },\n    getItemIndexByTopPosition: function (o) {\n      if (this.$config.rowStore) {\n        if (s.canUseSimpleCalculation()) return s.getItemIndexByTopPosition(o);\n        for (var l = this.$config.rowStore, c = 0; c < l.countVisible(); c++) {\n          var d = this.getRowTop(c),\n            u = this.getRowTop(c + 1);\n          if (!u) {\n            var h = l.getIdByIndex(c);\n            u = d + this.getItemHeight(h);\n          }\n          if (o >= d && o < u) return c;\n        }\n        return l.countVisible() + 2;\n      }\n      return 0;\n    }\n  };\n}\nconst pa = function () {\n  return {\n    render: function () {},\n    destroy: function () {}\n  };\n};\nvar Ut = function (t, e, n, i) {\n  this.$config = P({}, e || {}), this.$scaleHelper = new pe(i), this.$gantt = i, this._posFromDateCache = {}, this._timelineDragScroll = null, P(this, yn(this)), ot(this);\n};\nUt.prototype = {\n  init: function (t) {\n    t.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\", this.$task = t.childNodes[0], this.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\", this.$task_scale = this.$task.childNodes[0], this.$task_data = this.$task.childNodes[1], this.$task_data.innerHTML = \"<div class='gantt_task_bg'></div><div class='gantt_task_baselines'></div><div class='gantt_links_area'></div><div class='gantt_bars_area'></div><div class='gantt_task_constraints'></div><div class='gantt_task_deadlines'></div>\", this.$task_bg = this.$task_data.childNodes[0], this.$task_baselines = this.$task_data.childNodes[1], this.$task_links = this.$task_data.childNodes[2], this.$task_bars = this.$task_data.childNodes[3], this.$task_constraints = this.$task_data.childNodes[4], this.$task_deadlines = this.$task_data.childNodes[5], this._tasks = {\n      col_width: 0,\n      width: [],\n      full_width: 0,\n      trace_x: [],\n      rendered: {}\n    };\n    var e = this.$getConfig(),\n      n = e[this.$config.bind + \"_attribute\"],\n      i = e[this.$config.bindLinks + \"_attribute\"];\n    !n && this.$config.bind && (n = \"data-\" + this.$config.bind + \"-id\"), !i && this.$config.bindLinks && (i = \"data-\" + this.$config.bindLinks + \"-id\"), this.$config.item_attribute = n || null, this.$config.link_attribute = i || null;\n    var a = this._createLayerConfig();\n    this.$config.layers || (this.$config.layers = a.tasks), this.$config.linkLayers || (this.$config.linkLayers = a.links), this._attachLayers(this.$gantt), this.callEvent(\"onReady\", []), this.$gantt.ext.dragTimeline && (this._timelineDragScroll = this.$gantt.ext.dragTimeline.create(), this._timelineDragScroll.attach(this));\n  },\n  setSize: function (t, e) {\n    var n = this.$getConfig();\n    if (1 * t === t && (this.$config.width = t), 1 * e === e) {\n      this.$config.height = e;\n      var i = Math.max(this.$config.height - n.scale_height);\n      this.$task_data.style.height = i + \"px\";\n    }\n    this.refresh(), this.$task_bg.style.backgroundImage = \"\", n.smart_rendering && this.$config.rowStore ? this.$task_bg.style.height = this.getTotalHeight() + \"px\" : this.$task_bg.style.height = \"\";\n    for (var a = this._tasks, r = this.$task_data.childNodes, s = 0, o = r.length; s < o; s++) {\n      var l = r[s];\n      l.hasAttribute(\"data-layer\") && l.style && (l.style.width = a.full_width + \"px\");\n    }\n  },\n  isVisible: function () {\n    return this.$parent && this.$parent.$config ? !this.$parent.$config.hidden : this.$task.offsetWidth;\n  },\n  getSize: function () {\n    var t = this.$getConfig(),\n      e = this.$config.rowStore ? this.getTotalHeight() : 0,\n      n = this.isVisible() ? this._tasks.full_width : 0;\n    return {\n      x: this.isVisible() ? this.$config.width : 0,\n      y: this.isVisible() ? this.$config.height : 0,\n      contentX: this.isVisible() ? n : 0,\n      contentY: this.isVisible() ? t.scale_height + e : 0,\n      scrollHeight: this.isVisible() ? e : 0,\n      scrollWidth: this.isVisible() ? n : 0\n    };\n  },\n  scrollTo: function (t, e) {\n    if (this.isVisible()) {\n      var n = !1;\n      this.$config.scrollTop = this.$config.scrollTop || 0, this.$config.scrollLeft = this.$config.scrollLeft || 0, 1 * e === e && (this.$config.scrollTop = e, this.$task_data.scrollTop = this.$config.scrollTop, n = !0), 1 * t === t && (this.$task.scrollLeft = t, this.$config.scrollLeft = this.$task.scrollLeft, this._refreshScales(), n = !0), n && this.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n    }\n  },\n  _refreshScales: function () {\n    if (this.isVisible() && this.$getConfig().smart_scales) {\n      var t = this.getViewPort(),\n        e = this._scales;\n      this.$task_scale.innerHTML = this._getScaleChunkHtml(e, t.x, t.x_end);\n    }\n  },\n  getViewPort: function () {\n    var t = this.$config.scrollLeft || 0,\n      e = this.$config.scrollTop || 0,\n      n = this.$config.height || 0,\n      i = this.$config.width || 0;\n    return {\n      y: e,\n      y_end: e + n,\n      x: t,\n      x_end: t + i,\n      height: n,\n      width: i\n    };\n  },\n  _createLayerConfig: function () {\n    var t = this,\n      e = function () {\n        return t.isVisible();\n      };\n    this.$gantt;\n    var n = [{\n      expose: !0,\n      renderer: this.$gantt.$ui.layers.taskBar(),\n      container: this.$task_bars,\n      filter: [e, function (i, a) {\n        return !a.hide_bar;\n      }]\n    }];\n    return n.push({\n      renderer: this.$gantt.$ui.layers.taskBg(),\n      container: this.$task_bg,\n      filter: [e]\n    }), {\n      tasks: n,\n      links: [{\n        expose: !0,\n        renderer: this.$gantt.$ui.layers.link(),\n        container: this.$task_links,\n        filter: [e]\n      }]\n    };\n  },\n  _attachLayers: function (t) {\n    this._taskLayers = [], this._linkLayers = [];\n    var e = this,\n      n = this.$gantt.$services.getService(\"layers\");\n    if (this.$config.bind) {\n      this._bindStore();\n      var i = n.getDataRender(this.$config.bind);\n      i || (i = n.createDataRender({\n        name: this.$config.bind,\n        defaultContainer: function () {\n          return e.$task_data;\n        }\n      })), i.container = function () {\n        return e.$task_data;\n      };\n      for (var a = this.$config.layers, r = 0; a && r < a.length; r++) {\n        typeof (c = a[r]) == \"string\" && (c = this.$gantt.$ui.layers[c]()), (typeof c == \"function\" || c && c.render && c.update) && (c = {\n          renderer: c\n        }), c.view = this;\n        var s = i.addLayer(c);\n        this._taskLayers.push(s), c.expose && (this._taskRenderer = i.getLayer(s));\n      }\n      this._initStaticBackgroundRender();\n    }\n    if (this.$config.bindLinks) {\n      e.$config.linkStore = e.$gantt.getDatastore(e.$config.bindLinks);\n      var o = n.getDataRender(this.$config.bindLinks);\n      o || (o = n.createDataRender({\n        name: this.$config.bindLinks,\n        defaultContainer: function () {\n          return e.$task_data;\n        }\n      }));\n      var l = this.$config.linkLayers;\n      for (r = 0; l && r < l.length; r++) {\n        var c;\n        typeof c == \"string\" && (c = this.$gantt.$ui.layers[c]()), (c = l[r]).view = this;\n        var d = o.addLayer(c);\n        this._taskLayers.push(d), l[r].expose && (this._linkRenderer = o.getLayer(d));\n      }\n    }\n  },\n  _initStaticBackgroundRender: function () {\n    var t = this,\n      e = pa(),\n      n = t.$config.rowStore;\n    n && (this._staticBgHandler = n.attachEvent(\"onStoreUpdated\", function (i, a, r) {\n      if (i === null && t.isVisible()) {\n        var s = t.$getConfig();\n        if (s.static_background || s.timeline_placeholder) {\n          var o = t.$gantt.getDatastore(t.$config.bind),\n            l = t.$task_bg_static;\n          if (l || ((l = document.createElement(\"div\")).className = \"gantt_task_bg\", t.$task_bg_static = l, t.$task_bg.nextSibling ? t.$task_data.insertBefore(l, t.$task_bg.nextSibling) : t.$task_data.appendChild(l)), o) {\n            var c = t.getTotalHeight();\n            s.timeline_placeholder && (c = s.timeline_placeholder.height || t.$task_data.offsetHeight || 99999), e.render(l, s, t.getScale(), c, t.getItemHeight(a ? a.id : null));\n          }\n        } else s.static_background && t.$task_bg_static && t.$task_bg_static.parentNode && t.$task_bg_static.parentNode.removeChild(t.$task_bg_static);\n      }\n    }), this.attachEvent(\"onDestroy\", function () {}), this._initStaticBackgroundRender = function () {});\n  },\n  _clearLayers: function (t) {\n    var e = this.$gantt.$services.getService(\"layers\"),\n      n = e.getDataRender(this.$config.bind),\n      i = e.getDataRender(this.$config.bindLinks);\n    if (this._taskLayers) for (var a = 0; a < this._taskLayers.length; a++) n.removeLayer(this._taskLayers[a]);\n    if (this._linkLayers) for (a = 0; a < this._linkLayers.length; a++) i.removeLayer(this._linkLayers[a]);\n    this._linkLayers = [], this._taskLayers = [];\n  },\n  _render_tasks_scales: function () {\n    var t = this.$getConfig(),\n      e = \"\",\n      n = 0,\n      i = 0,\n      a = this.$gantt.getState();\n    if (this.isVisible()) {\n      var r = this.$scaleHelper,\n        s = this._getScales();\n      i = t.scale_height;\n      var o = this.$config.width;\n      t.autosize != \"x\" && t.autosize != \"xy\" || (o = Math.max(t.autosize_min_width, 0));\n      var l = r.prepareConfigs(s, t.min_column_width, o, i - 1, a.min_date, a.max_date, t.rtl),\n        c = this._tasks = l[l.length - 1];\n      this._scales = l, this._posFromDateCache = {}, e = this._getScaleChunkHtml(l, 0, this.$config.width), n = c.full_width + \"px\", i += \"px\";\n    }\n    this.$task_scale.style.height = i, this.$task_data.style.width = this.$task_scale.style.width = n, this.$task_scale.innerHTML = e;\n  },\n  _getScaleChunkHtml: function (t, e, n) {\n    for (var i = [], a = this.$gantt.templates.scale_row_class, r = 0; r < t.length; r++) {\n      var s = \"gantt_scale_line\",\n        o = a(t[r]);\n      o && (s += \" \" + o), i.push('<div class=\"' + s + '\" style=\"height:' + t[r].height + \"px;position:relative;line-height:\" + t[r].height + 'px\">' + this._prepareScaleHtml(t[r], e, n, r) + \"</div>\");\n    }\n    return i.join(\"\");\n  },\n  _prepareScaleHtml: function (t, e, n, i) {\n    var a = this.$getConfig(),\n      r = this.$gantt.templates,\n      s = [],\n      o = null,\n      l = null,\n      c = t.format || t.template || t.date;\n    typeof c == \"string\" && (c = this.$gantt.date.date_to_str(c));\n    var d = 0,\n      u = t.count;\n    !a.smart_scales || isNaN(e) || isNaN(n) || (d = At(t.left, e), u = At(t.left, n) + 1), l = t.css || function () {}, !t.css && a.inherit_scale_class && (l = r.scale_cell_class);\n    for (var h = d; h < u && t.trace_x[h]; h++) {\n      o = new Date(t.trace_x[h]);\n      var _ = c.call(this, o),\n        p = t.width[h];\n      t.height;\n      var y = t.left[h],\n        k = \"\",\n        b = \"\",\n        g = \"\";\n      if (p) {\n        k = \"width:\" + p + \"px;\" + (a.smart_scales ? \"position:absolute;left:\" + y + \"px\" : \"\");\n        const f = this.getViewPort(),\n          v = (a.scales[i] || {}).sticky;\n        let x = \"\";\n        const $ = 70;\n        if (v !== !1 && p > $ || v === !0) {\n          if (y < f.x && y + p / 2 - $ / 2 < f.x) x = ` style='position:absolute;left: ${f.x - y + 10}px;' `;else if (y + p / 2 + $ / 2 > f.x_end && p > $) {\n            let w = f.x_end - y - 10,\n              S = \"-100%\";\n            w < $ && (w = $, S = `-${w}px`), x = ` style='position:absolute;left: ${w}px;transform: translate(${S},0);' `;\n          }\n        }\n        g = \"gantt_scale_cell\" + (h == t.count - 1 ? \" gantt_last_cell\" : \"\"), (b = l.call(this, o)) && (g += \" \" + b);\n        var m = `<div class='${g}' ${this.$gantt._waiAria.getTimelineCellAttr(_)} style='${k}'><span ${x}>${_}</span></div>`;\n        s.push(m);\n      }\n    }\n    return s.join(\"\");\n  },\n  dateFromPos: function (t) {\n    var e = this._tasks;\n    if (t < 0 || t > e.full_width || !e.full_width) return null;\n    var n = At(this._tasks.left, t),\n      i = this._tasks.left[n],\n      a = e.width[n] || e.col_width,\n      r = 0;\n    a && (r = (t - i) / a, e.rtl && (r = 1 - r));\n    var s = 0;\n    return r && (s = this._getColumnDuration(e, e.trace_x[n])), new Date(e.trace_x[n].valueOf() + Math.round(r * s));\n  },\n  posFromDate: function (t) {\n    if (!this.isVisible() || !t) return 0;\n    var e = String(t.valueOf());\n    if (this._posFromDateCache[e] !== void 0) return this._posFromDateCache[e];\n    var n = this.columnIndexByDate(t);\n    this.$gantt.assert(n >= 0, \"Invalid day index\");\n    var i = Math.floor(n),\n      a = n % 1,\n      r = this._tasks.left[Math.min(i, this._tasks.width.length - 1)];\n    i == this._tasks.width.length && (r += this._tasks.width[this._tasks.width.length - 1]), a && (i < this._tasks.width.length ? r += this._tasks.width[i] * (a % 1) : r += 1);\n    var s = Math.round(r);\n    return this._posFromDateCache[e] = s, Math.round(s);\n  },\n  _getNextVisibleColumn: function (t, e, n) {\n    for (var i = +e[t], a = t; n[i];) i = +e[++a];\n    return a;\n  },\n  _getPrevVisibleColumn: function (t, e, n) {\n    for (var i = +e[t], a = t; n[i];) i = +e[--a];\n    return a;\n  },\n  _getClosestVisibleColumn: function (t, e, n) {\n    var i = this._getNextVisibleColumn(t, e, n);\n    return e[i] || (i = this._getPrevVisibleColumn(t, e, n)), i;\n  },\n  columnIndexByDate: function (t) {\n    var e = new Date(t).valueOf(),\n      n = this._tasks.trace_x_ascending,\n      i = this._tasks.ignore_x,\n      a = this.$gantt.getState();\n    if (e <= a.min_date) return this._tasks.rtl ? n.length : 0;\n    if (e >= a.max_date) return this._tasks.rtl ? 0 : n.length;\n    var r = At(n, e),\n      s = this._getClosestVisibleColumn(r, n, i),\n      o = n[s],\n      l = this._tasks.trace_index_transition;\n    if (!o) return l ? l[0] : 0;\n    var c = (t - n[s]) / this._getColumnDuration(this._tasks, n[s]);\n    return l ? l[s] + (1 - c) : s + c;\n  },\n  getItemPosition: function (t, e, n) {\n    var i, a, r;\n    let s = e || t.start_date || t.$auto_start_date,\n      o = n || t.end_date || t.$auto_end_date;\n    return this._tasks.rtl ? (a = this.posFromDate(s), i = this.posFromDate(o)) : (i = this.posFromDate(s), a = this.posFromDate(o)), r = Math.max(a - i, 0), {\n      left: i,\n      top: this.getItemTop(t.id),\n      height: this.getBarHeight(t.id),\n      width: r,\n      rowHeight: this.getItemHeight(t.id)\n    };\n  },\n  getBarHeight: function (t, e) {\n    var n = this.$getConfig(),\n      i = this.$config.rowStore.getItem(t),\n      a = i.task_height || i.bar_height || n.bar_height || n.task_height,\n      r = this.getItemHeight(t);\n    return a == \"full\" && (a = r - (n.bar_height_padding || 3)), a = Math.min(a, r), e && (a = Math.round(a / Math.sqrt(2))), Math.max(a, 0);\n  },\n  getScale: function () {\n    return this._tasks;\n  },\n  _getScales: function () {\n    var t = this.$getConfig(),\n      e = this.$scaleHelper,\n      n = [e.primaryScale(t)].concat(e.getSubScales(t));\n    return e.sortScales(n), n;\n  },\n  _getColumnDuration: function (t, e) {\n    return this.$gantt.date.add(e, t.step, t.unit) - e;\n  },\n  _bindStore: function () {\n    if (this.$config.bind) {\n      var t = this.$gantt.getDatastore(this.$config.bind);\n      if (this.$config.rowStore = t, t && !t._timelineCacheAttached) {\n        var e = this;\n        t._timelineCacheAttached = t.attachEvent(\"onBeforeFilter\", function () {\n          e._resetTopPositionHeight();\n        });\n      }\n    }\n  },\n  _unbindStore: function () {\n    if (this.$config.bind) {\n      var t = this.$gantt.getDatastore(this.$config.bind);\n      t && t._timelineCacheAttached && (t.detachEvent(t._timelineCacheAttached), t._timelineCacheAttached = !1);\n    }\n  },\n  refresh: function () {\n    this._bindStore(), this.$config.bindLinks && (this.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks)), this._resetTopPositionHeight(), this._resetHeight(), this._initStaticBackgroundRender(), this._render_tasks_scales();\n  },\n  destructor: function () {\n    var t = this.$gantt;\n    this._clearLayers(t), this._unbindStore(), this.$task = null, this.$task_scale = null, this.$task_data = null, this.$task_bg = null, this.$task_links = null, this.$task_bars = null, this.$gantt = null, this.$config.rowStore && (this.$config.rowStore.detachEvent(this._staticBgHandler), this.$config.rowStore = null), this.$config.linkStore && (this.$config.linkStore = null), this._timelineDragScroll && (this._timelineDragScroll.destructor(), this._timelineDragScroll = null), this.callEvent(\"onDestroy\", []), this.detachAllEvents();\n  }\n};\nclass ma {\n  constructor(e) {\n    this._scrollOrder = 0;\n    const {\n      gantt: n,\n      grid: i,\n      dnd: a,\n      getCurrentX: r\n    } = e;\n    this.$gantt = n, this.$grid = i, this._dnd = a, this.getCurrentX = r, this._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX), this.attachEvents();\n  }\n  attachEvents() {\n    this.isScrollable() && (this._dnd.attachEvent(\"onDragMove\", (e, n) => {\n      const i = this.$grid.$grid.getBoundingClientRect(),\n        a = i.right,\n        r = i.left,\n        s = this.getCurrentX(n.clientX);\n      return s >= a - 20 && (this.autoscrollRight(), this.autoscrollStart()), s <= r + 20 && (this.autoscrollLeft(), this.autoscrollStart()), s < a - 20 && s > r + 20 && this.autoscrollStop(), !0;\n    }), this._dnd.attachEvent(\"onDragEnd\", () => {\n      this.autoscrollStop();\n    }));\n  }\n  autoscrollStart() {\n    if (this._scrollOrder === 0) return;\n    const e = 10 * this._scrollOrder,\n      n = this._scrollView.getScrollState();\n    this._scrollView.scrollTo(n.position + e), setTimeout(() => {\n      this.autoscrollStart();\n    }, 50);\n  }\n  autoscrollRight() {\n    this._scrollOrder = 1;\n  }\n  autoscrollLeft() {\n    this._scrollOrder = -1;\n  }\n  autoscrollStop() {\n    this._scrollOrder = 0;\n  }\n  getCorrection() {\n    return this.isScrollable() ? this._scrollView.getScrollState().position : 0;\n  }\n  isScrollable() {\n    return !!this.$grid.$config.scrollable;\n  }\n}\nconst Ve = \"data-column-id\";\nclass va {\n  constructor(e, n) {\n    this._targetMarker = null, this.calculateCurrentPosition = i => {\n      const a = this.$grid.$grid.getBoundingClientRect(),\n        r = a.right,\n        s = a.left;\n      let o = i;\n      return o > r && (o = r), o < s && (o = s), o;\n    }, this.$gantt = e, this.$grid = n;\n  }\n  init() {\n    const e = this.$gantt.$services.getService(\"dnd\");\n    this._dnd = new e(this.$grid.$grid_scale, {\n      updates_per_second: 60\n    }), this._scrollableGrid = new ma({\n      gantt: this.$gantt,\n      grid: this.$grid,\n      dnd: this._dnd,\n      getCurrentX: this.calculateCurrentPosition\n    }), this.attachEvents();\n  }\n  attachEvents() {\n    this._dnd.attachEvent(\"onBeforeDragStart\", (e, n) => {\n      if (this._draggedCell = this.$gantt.utils.dom.closest(n.target, \".gantt_grid_head_cell\"), !this._draggedCell) return;\n      const i = this.$grid.$getConfig().columns,\n        a = this._draggedCell.getAttribute(Ve);\n      let r, s;\n      return i.map(function (o, l) {\n        o.name === a && (r = o, s = l);\n      }), this.$grid.callEvent(\"onBeforeColumnDragStart\", [{\n        draggedColumn: r,\n        draggedIndex: s\n      }]) !== !1 && !(!this._draggedCell || !r) && (this._gridConfig = this.$grid.$getConfig(), this._originAutoscroll = this.$gantt.config.autoscroll, this.$gantt.config.autoscroll = !1, !0);\n    }), this._dnd.attachEvent(\"onAfterDragStart\", (e, n) => {\n      this._draggedCell && (this._dnd.config.column = this._draggedCell.getAttribute(Ve), this._dnd.config.marker.innerHTML = this._draggedCell.outerHTML, this._dnd.config.marker.classList.add(\"gantt_column_drag_marker\"), this._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\", this._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\", this._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\"));\n    }), this._dnd.attachEvent(\"onDragMove\", (e, n) => {\n      if (!this._draggedCell) return;\n      this._dragX = n.clientX;\n      const i = this.calculateCurrentPosition(n.clientX),\n        a = this.findColumnsIndexes();\n      return this.setMarkerPosition(i), this.drawTargetMarker(a), !0;\n    }), this._dnd.attachEvent(\"onDragEnd\", () => {\n      if (!this._draggedCell) return;\n      const e = this.findColumnsIndexes(),\n        n = e.targetIndex,\n        i = e.draggedIndex,\n        a = this.$grid.$getConfig().columns,\n        r = a[i],\n        s = a[n];\n      if (this.$grid.callEvent(\"onColumnDragMove\", [{\n        draggedColumn: r,\n        targetColumn: s,\n        draggedIndex: i,\n        targetIndex: n\n      }]) === !1) return this.cleanTargetMarker(), void this.$gantt.render();\n      this.$gantt.config.autoscroll = this._originAutoscroll, this._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\"), this.cleanTargetMarker(), this.reorderColumns();\n    });\n  }\n  reorderColumns() {\n    const {\n        targetIndex: e,\n        draggedIndex: n\n      } = this.findColumnsIndexes(),\n      i = this.$grid.$getConfig().columns,\n      a = i[n],\n      r = i[e];\n    this.$grid.callEvent(\"onBeforeColumnReorder\", [{\n      draggedColumn: a,\n      targetColumn: r,\n      draggedIndex: n,\n      targetIndex: e\n    }]) !== !1 && e !== n && (i.splice(n, 1), i.splice(e, 0, a), this.$gantt.render(), this.$grid.callEvent(\"onAfterColumnReorder\", [{\n      draggedColumn: a,\n      targetColumn: r,\n      draggedIndex: n,\n      targetIndex: e\n    }]));\n  }\n  findColumnsIndexes() {\n    const e = this._dnd.config.column,\n      n = this.$grid.$getConfig().columns;\n    let i, a, r, s;\n    const o = {\n      startX: 0,\n      endX: 0\n    };\n    let l,\n      c = 0,\n      d = n.length - 1,\n      u = (p, y) => p <= y,\n      h = p => ++p;\n    this.$gantt.config.rtl && (c = n.length - 1, d = 0, u = (p, y) => p >= y, h = p => --p);\n    const _ = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\n    for (let p = c; u(p, d) && (i === void 0 || a === void 0); p = h(p)) n[p].hide || (o.startX = o.endX, o.endX += n[p].width, _ >= o.startX && (_ <= o.endX || !u(h(p), d)) && (i = p, r = o.startX, s = o.endX, l = (_ - o.startX) / (o.endX - o.startX)), e === n[p].name && (a = p));\n    return {\n      targetIndex: i,\n      draggedIndex: a,\n      xBefore: r,\n      xAfter: s,\n      columnRelativePos: l\n    };\n  }\n  setMarkerPosition(e, n = 10) {\n    const {\n        marker: i\n      } = this._dnd.config,\n      a = this._dnd._obj.getBoundingClientRect();\n    i.style.top = `${a.y + n}px`, i.style.left = `${e}px`;\n  }\n  drawTargetMarker({\n    targetIndex: e,\n    draggedIndex: n,\n    xBefore: i,\n    xAfter: a,\n    columnRelativePos: r\n  }) {\n    let s;\n    this._targetMarker || (this._targetMarker = document.createElement(\"div\"), wt(this._targetMarker, \"gantt_grid_target_marker\"), this._targetMarker.style.display = \"none\", this._targetMarker.style.height = `${this._gridConfig.scale_height}px`), this._targetMarker.parentNode || this.$grid.$grid_scale.appendChild(this._targetMarker), s = e > n ? a : e < n ? i : r > 0.5 ? a : i, this._targetMarker.style.left = `${s}px`, this._targetMarker.style.display = \"block\";\n  }\n  cleanTargetMarker() {\n    this._targetMarker && this._targetMarker.parentNode && this.$grid.$grid_scale.removeChild(this._targetMarker), this._targetMarker = null;\n  }\n}\nfunction Te(t) {\n  var e = [];\n  return {\n    delegate: function (n, i, a, r) {\n      e.push([n, i, a, r]), t.$services.getService(\"mouseEvents\").delegate(n, i, a, r);\n    },\n    destructor: function () {\n      for (var n = t.$services.getService(\"mouseEvents\"), i = 0; i < e.length; i++) {\n        var a = e[i];\n        n.detach(a[0], a[1], a[2], a[3]);\n      }\n      e = [];\n    }\n  };\n}\nvar xe = function (t, e, n, i) {\n  this.$config = P({}, e || {}), this.$gantt = i, this.$parent = t, ot(this), this.$state = {}, P(this, yn(this));\n};\nxe.prototype = {\n  init: function (t) {\n    var e = this.$gantt,\n      n = e._waiAria.gridAttrString(),\n      i = e._waiAria.gridDataAttrString(),\n      a = this.$getConfig(),\n      r = a.reorder_grid_columns || !1;\n    this.$config.reorder_grid_columns !== void 0 && (r = this.$config.reorder_grid_columns), t.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + n + \"></div>\", this.$grid = t.childNodes[0], this.$grid.innerHTML = \"<div class='gantt_grid_scale' \" + e._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + i + \"></div>\", this.$grid_scale = this.$grid.childNodes[0], this.$grid_data = this.$grid.childNodes[1];\n    var s = a[this.$config.bind + \"_attribute\"];\n    if (!s && this.$config.bind && (s = \"data-\" + this.$config.bind + \"-id\"), this.$config.item_attribute = s || null, !this.$config.layers) {\n      var o = this._createLayerConfig();\n      this.$config.layers = o;\n    }\n    var l = {\n      init: function () {},\n      doOnRender: function () {}\n    };\n    this._renderHeaderResizers = l.doOnRender, this._mouseDelegates = Te(e);\n    var c = function (d, u) {\n      var h = {\n        row_before_start: d.bind(function (_, p, y) {\n          var k = u.$getConfig(),\n            b = u.$config.rowStore;\n          if (!nt(y, k.task_grid_row_resizer_attribute)) return !1;\n          var g = this.locate(y, k.task_grid_row_resizer_attribute),\n            m = b.getItem(g);\n          return u.callEvent(\"onBeforeRowResize\", [m]) !== !1 && void 0;\n        }, d),\n        row_after_start: d.bind(function (_, p, y) {\n          var k = u.$getConfig(),\n            b = this.locate(y, k.task_grid_row_resizer_attribute);\n          _.config.marker.innerHTML = \"\", _.config.marker.className += \" gantt_row_grid_resize_area\", _.config.marker.style.width = u.$grid.offsetWidth + \"px\", _.config.drag_id = b;\n        }, d),\n        row_drag_move: d.bind(function (_, p, y) {\n          var k = u.$config.rowStore,\n            b = u.$getConfig(),\n            g = _.config,\n            m = g.drag_id,\n            f = u.getItemHeight(m),\n            v = u.getItemTop(m) - p.scrollTop,\n            x = V(u.$grid_data),\n            $ = parseInt(g.marker.style.top, 10),\n            w = v + x.y,\n            S = 0,\n            T = b.min_task_grid_row_height;\n          return (S = $ - w) < T && (S = T), g.marker.style.left = x.x + \"px\", g.marker.style.top = w - 1 + \"px\", g.marker.style.height = Math.abs(S) + 1 + \"px\", g.marker_height = S, u.callEvent(\"onRowResize\", [m, k.getItem(m), S + f]), !0;\n        }, d),\n        row_drag_end: d.bind(function (_, p, y) {\n          var k = u.$config.rowStore,\n            b = _.config,\n            g = b.drag_id,\n            m = k.getItem(g),\n            f = u.getItemHeight(g),\n            v = b.marker_height;\n          u.callEvent(\"onBeforeRowResizeEnd\", [g, m, v]) !== !1 && m.row_height != v && (m.row_height = v, k.updateItem(g), u.callEvent(\"onAfterRowResize\", [g, m, f, v]), this.render());\n        }, d)\n      };\n      return {\n        init: function () {\n          var _ = d.$services.getService(\"dnd\"),\n            p = u.$getConfig(),\n            y = new _(u.$grid_data, {\n              updates_per_second: 60\n            });\n          d.defined(p.dnd_sensitivity) && (y.config.sensitivity = p.dnd_sensitivity), y.attachEvent(\"onBeforeDragStart\", function (k, b) {\n            return h.row_before_start(y, k, b);\n          }), y.attachEvent(\"onAfterDragStart\", function (k, b) {\n            return h.row_after_start(y, k, b);\n          }), y.attachEvent(\"onDragMove\", function (k, b) {\n            return h.row_drag_move(y, k, b);\n          }), y.attachEvent(\"onDragEnd\", function (k, b) {\n            return h.row_drag_end(y, k, b);\n          });\n        }\n      };\n    }(e, this);\n    c.init(), this._addLayers(this.$gantt), this._initEvents(), r && (this._columnDND = new va(e, this), this._columnDND.init()), this.callEvent(\"onReady\", []);\n  },\n  _validateColumnWidth: function (t, e) {\n    var n = t[e];\n    if (n && n != \"*\") {\n      var i = this.$gantt,\n        a = 1 * n;\n      isNaN(a) ? i.assert(!1, \"Wrong \" + e + \" value of column \" + t.name) : t[e] = a;\n    }\n  },\n  setSize: function (t, e) {\n    this.$config.width = this.$state.width = t, this.$config.height = this.$state.height = e;\n    for (var n, i = this.getGridColumns(), a = 0, r = (c = this.$getConfig()).grid_elastic_columns, s = 0, o = i.length; s < o; s++) this._validateColumnWidth(i[s], \"min_width\"), this._validateColumnWidth(i[s], \"max_width\"), this._validateColumnWidth(i[s], \"width\"), a += 1 * i[s].width;\n    if (!isNaN(a) && this.$config.scrollable || (a = n = this._setColumnsWidth(t + 1)), this.$config.scrollable && r && !isNaN(a)) {\n      let u = \"width\";\n      r == \"min_width\" && (u = \"min_width\");\n      let h = 0;\n      i.forEach(function (_) {\n        h += _[u] || c.min_grid_column_width;\n      });\n      var l = Math.max(h, t);\n      a = this._setColumnsWidth(l), n = t;\n    }\n    this.$config.scrollable ? (this.$grid_scale.style.width = a + \"px\", this.$grid_data.style.width = a + \"px\") : (this.$grid_scale.style.width = \"inherit\", this.$grid_data.style.width = \"inherit\"), this.$config.width -= 1;\n    var c = this.$getConfig();\n    n !== t && (n !== void 0 ? (c.grid_width = n, this.$config.width = n - 1) : isNaN(a) || (this._setColumnsWidth(a), c.grid_width = a, this.$config.width = a - 1));\n    var d = Math.max(this.$state.height - c.scale_height, 0);\n    this.$grid_data.style.height = d + \"px\", this.refresh();\n  },\n  getSize: function () {\n    var t = this.$getConfig(),\n      e = this.$config.rowStore ? this.getTotalHeight() : 0,\n      n = this._getGridWidth();\n    return {\n      x: this.$state.width,\n      y: this.$state.height,\n      contentX: this.isVisible() ? n : 0,\n      contentY: this.isVisible() ? t.scale_height + e : 0,\n      scrollHeight: this.isVisible() ? e : 0,\n      scrollWidth: this.isVisible() ? n : 0\n    };\n  },\n  _bindStore: function () {\n    if (this.$config.bind) {\n      var t = this.$gantt.getDatastore(this.$config.bind);\n      if (this.$config.rowStore = t, t && !t._gridCacheAttached) {\n        var e = this;\n        t._gridCacheAttached = t.attachEvent(\"onBeforeFilter\", function () {\n          e._resetTopPositionHeight();\n        });\n      }\n    }\n  },\n  _unbindStore: function () {\n    if (this.$config.bind) {\n      var t = this.$gantt.getDatastore(this.$config.bind);\n      t && t._gridCacheAttached && (t.detachEvent(t._gridCacheAttached), t._gridCacheAttached = !1);\n    }\n  },\n  refresh: function () {\n    this._bindStore(), this._resetTopPositionHeight(), this._resetHeight(), this._initSmartRenderingPlaceholder(), this._calculateGridWidth(), this._renderGridHeader();\n  },\n  getViewPort: function () {\n    var t = this.$config.scrollLeft || 0,\n      e = this.$config.scrollTop || 0,\n      n = this.$config.height || 0,\n      i = this.$config.width || 0;\n    return {\n      y: e,\n      y_end: e + n,\n      x: t,\n      x_end: t + i,\n      height: n,\n      width: i\n    };\n  },\n  scrollTo: function (t, e) {\n    if (this.isVisible()) {\n      var n = !1;\n      this.$config.scrollTop = this.$config.scrollTop || 0, this.$config.scrollLeft = this.$config.scrollLeft || 0, 1 * t == t && (this.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = t, n = !0), 1 * e == e && (this.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = e, n = !0), n && this.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n    }\n  },\n  getColumnIndex: function (t, e) {\n    for (var n = this.$getConfig().columns, i = 0, a = 0; a < n.length; a++) if (e && n[a].hide && i++, n[a].name == t) return a - i;\n    return null;\n  },\n  getColumn: function (t) {\n    var e = this.getColumnIndex(t);\n    return e === null ? null : this.$getConfig().columns[e];\n  },\n  getGridColumns: function () {\n    return this.$getConfig().columns.slice();\n  },\n  isVisible: function () {\n    return this.$parent && this.$parent.$config ? !this.$parent.$config.hidden : this.$grid.offsetWidth;\n  },\n  _createLayerConfig: function () {\n    var t = this.$gantt,\n      e = this;\n    return [{\n      renderer: t.$ui.layers.gridLine(),\n      container: this.$grid_data,\n      filter: [function () {\n        return e.isVisible();\n      }]\n    }, {\n      renderer: t.$ui.layers.gridTaskRowResizer(),\n      container: this.$grid_data,\n      append: !0,\n      filter: [function () {\n        return t.config.resize_rows;\n      }]\n    }];\n  },\n  _addLayers: function (t) {\n    if (this.$config.bind) {\n      this._taskLayers = [];\n      var e = this,\n        n = this.$gantt.$services.getService(\"layers\"),\n        i = n.getDataRender(this.$config.bind);\n      i || (i = n.createDataRender({\n        name: this.$config.bind,\n        defaultContainer: function () {\n          return e.$grid_data;\n        }\n      }));\n      for (var a = this.$config.layers, r = 0; a && r < a.length; r++) {\n        var s = a[r];\n        s.view = this;\n        var o = i.addLayer(s);\n        this._taskLayers.push(o);\n      }\n      this._bindStore(), this._initSmartRenderingPlaceholder();\n    }\n  },\n  _refreshPlaceholderOnStoreUpdate: function (t) {\n    var e = this.$getConfig(),\n      n = this.$config.rowStore;\n    if (n && t === null && this.isVisible() && e.smart_rendering) {\n      var i;\n      if (this.$config.scrollY) {\n        var a = this.$gantt.$ui.getView(this.$config.scrollY);\n        a && (i = a.getScrollState().scrollSize);\n      }\n      if (i || (i = n ? this.getTotalHeight() : 0), i) {\n        this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode && this.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\n        var r = this.$rowsPlaceholder = document.createElement(\"div\");\n        r.style.visibility = \"hidden\", r.style.height = i + \"px\", r.style.width = \"1px\", this.$grid_data.appendChild(r);\n      }\n    }\n  },\n  _initSmartRenderingPlaceholder: function () {\n    var t = this.$config.rowStore;\n    t && (this._initSmartRenderingPlaceholder = function () {}, this._staticBgHandler = t.attachEvent(\"onStoreUpdated\", R(this._refreshPlaceholderOnStoreUpdate, this)));\n  },\n  _initEvents: function () {\n    var t = this.$gantt;\n    this._mouseDelegates.delegate(\"click\", \"gantt_close\", t.bind(function (e, n, i) {\n      var a = this.$config.rowStore;\n      if (!a) return !0;\n      var r = nt(e, this.$config.item_attribute);\n      return r && a.close(r.getAttribute(this.$config.item_attribute)), !1;\n    }, this), this.$grid), this._mouseDelegates.delegate(\"click\", \"gantt_open\", t.bind(function (e, n, i) {\n      var a = this.$config.rowStore;\n      if (!a) return !0;\n      var r = nt(e, this.$config.item_attribute);\n      return r && a.open(r.getAttribute(this.$config.item_attribute)), !1;\n    }, this), this.$grid);\n  },\n  _clearLayers: function (t) {\n    var e = this.$gantt.$services.getService(\"layers\").getDataRender(this.$config.bind);\n    if (this._taskLayers) for (var n = 0; n < this._taskLayers.length; n++) e.removeLayer(this._taskLayers[n]);\n    this._taskLayers = [];\n  },\n  _getColumnWidth: function (t, e, n) {\n    var i = t.min_width || e.min_grid_column_width,\n      a = Math.max(n, i || 10);\n    return t.max_width && (a = Math.min(a, t.max_width)), a;\n  },\n  _checkGridColumnMinWidthLimits: function (t, e) {\n    for (var n = 0, i = t.length; n < i; n++) {\n      var a = 1 * t[n].width;\n      !t[n].min_width && a < e.min_grid_column_width && (t[n].min_width = a);\n    }\n  },\n  _getGridWidthLimits: function () {\n    for (var t = this.$getConfig(), e = this.getGridColumns(), n = 0, i = 0, a = 0; a < e.length; a++) n += e[a].min_width ? e[a].min_width : t.min_grid_column_width, i !== void 0 && (i = e[a].max_width ? i + e[a].max_width : void 0);\n    return this._checkGridColumnMinWidthLimits(e, t), [n, i];\n  },\n  _setColumnsWidth: function (t, e) {\n    var n = this.$getConfig(),\n      i = this.getGridColumns(),\n      a = 0,\n      r = t;\n    e = window.isNaN(e) ? -1 : e;\n    for (var s = 0, o = i.length; s < o; s++) a += 1 * i[s].width;\n    if (window.isNaN(a)) for (this._calculateGridWidth(), a = 0, s = 0, o = i.length; s < o; s++) a += 1 * i[s].width;\n    var l = r - a,\n      c = 0;\n    for (s = 0; s < e + 1; s++) c += i[s].width;\n    for (a -= c, s = e + 1; s < i.length; s++) {\n      var d = i[s],\n        u = Math.round(l * (d.width / a));\n      l < 0 ? d.min_width && d.width + u < d.min_width ? u = d.min_width - d.width : !d.min_width && n.min_grid_column_width && d.width + u < n.min_grid_column_width && (u = n.min_grid_column_width - d.width) : d.max_width && d.width + u > d.max_width && (u = d.max_width - d.width), a -= d.width, d.width += u, l -= u;\n    }\n    for (var h = l > 0 ? 1 : -1; l > 0 && h === 1 || l < 0 && h === -1;) {\n      var _ = l;\n      for (s = e + 1; s < i.length; s++) {\n        var p;\n        if ((p = i[s].width + h) == this._getColumnWidth(i[s], n, p) && (l -= h, i[s].width = p), !l) break;\n      }\n      if (_ == l) break;\n    }\n    return l && e > -1 && (p = i[e].width + l) == this._getColumnWidth(i[e], n, p) && (i[e].width = p), this._getColsTotalWidth();\n  },\n  _getColsTotalWidth: function () {\n    for (var t = this.getGridColumns(), e = 0, n = 0; n < t.length; n++) {\n      var i = parseFloat(t[n].width);\n      if (window.isNaN(i)) return !1;\n      e += i;\n    }\n    return e;\n  },\n  _calculateGridWidth: function () {\n    for (var t = this.$getConfig(), e = this.getGridColumns(), n = 0, i = [], a = [], r = 0; r < e.length; r++) {\n      var s = parseFloat(e[r].width);\n      window.isNaN(s) && (s = t.min_grid_column_width || 10, i.push(r)), a[r] = s, n += s;\n    }\n    var o = this._getGridWidth() + 1;\n    if (t.autofit || i.length) {\n      var l = o - n;\n      if (t.autofit && !t.grid_elastic_columns) for (r = 0; r < a.length; r++) {\n        var c = Math.round(l / (a.length - r));\n        a[r] += c, (d = this._getColumnWidth(e[r], t, a[r])) != a[r] && (c = d - a[r], a[r] = d), l -= c;\n      } else if (i.length) for (r = 0; r < i.length; r++) {\n        c = Math.round(l / (i.length - r));\n        var d,\n          u = i[r];\n        a[u] += c, (d = this._getColumnWidth(e[u], t, a[u])) != a[u] && (c = d - a[u], a[u] = d), l -= c;\n      }\n      for (r = 0; r < a.length; r++) e[r].width = a[r];\n    } else {\n      var h = o != n;\n      this.$config.width = n - 1, t.grid_width = n, h && this.$parent._setContentSize(this.$config.width, null);\n    }\n  },\n  _renderGridHeader: function () {\n    var t = this.$gantt,\n      e = this.$getConfig(),\n      n = this.$gantt.locale,\n      i = this.$gantt.templates,\n      a = this.getGridColumns();\n    e.rtl && (a = a.reverse());\n    var r = [],\n      s = 0,\n      o = n.labels,\n      l = e.scale_height - 1;\n    const c = {};\n    for (var d = 0; d < a.length; d++) {\n      var u = d == a.length - 1,\n        h = a[d];\n      h.name || (h.name = t.uid() + \"\");\n      var _ = 1 * h.width,\n        p = this._getGridWidth();\n      u && p > s + _ && (h.width = _ = p - s), s += _;\n      var y = t._sort && h.name == t._sort.name ? `<div data-column-id=\"${h.name}\" class=\"gantt_sort gantt_${t._sort.direction}\"></div>` : \"\",\n        k = [\"gantt_grid_head_cell\", \"gantt_grid_head_\" + h.name, u ? \"gantt_last_cell\" : \"\", i.grid_header_class(h.name, h)].join(\" \"),\n        b = \"width:\" + (_ - (u ? 1 : 0)) + \"px;\",\n        g = h.label || o[\"column_\" + h.name] || o[h.name];\n      typeof g == \"function\" && (g = g.call(t, h.name, h)), g = g || \"\";\n      let f = !1;\n      t.config.external_render && t.config.external_render.isElement(g) && (f = !0, c[h.name] = g);\n      var m = \"<div class='\" + k + \"' style='\" + b + \"' \" + t._waiAria.gridScaleCellAttrString(h, g) + \" data-column-id='\" + h.name + \"' column_id='\" + h.name + \"' data-column-name='\" + h.name + \"' data-column-index='\" + d + \"'>\" + (f ? \"<div data-component-container></div>\" : g) + y + \"</div>\";\n      r.push(m);\n    }\n    this.$grid_scale.style.height = e.scale_height + \"px\", this.$grid_scale.style.lineHeight = l + \"px\", this.$grid_scale.innerHTML = r.join(\"\");\n    for (let f in c) t.config.external_render.renderElement(c[f], this.$grid_scale.querySelector(\"[data-column-id='\" + f + \"'] [data-component-container]\"));\n    this._renderHeaderResizers && this._renderHeaderResizers();\n  },\n  _getGridWidth: function () {\n    return this.$config.width;\n  },\n  destructor: function () {\n    this._clearLayers(this.$gantt), this._mouseDelegates && (this._mouseDelegates.destructor(), this._mouseDelegates = null), this._unbindStore(), this.$grid = null, this.$grid_scale = null, this.$grid_data = null, this.$gantt = null, this.$config.rowStore && (this.$config.rowStore.detachEvent(this._staticBgHandler), this.$config.rowStore = null), this.callEvent(\"onDestroy\", []), this.detachAllEvents();\n  }\n};\nconst ka = {\n    init: function (t, e) {\n      var n = e.$gantt;\n      n.attachEvent(\"onTaskClick\", function (i, a) {\n        if (n._is_icon_open_click(a)) return !0;\n        var r = t.getState(),\n          s = t.locateCell(a.target);\n        return !s || !t.getEditorConfig(s.columnName) || (t.isVisible() && r.id == s.id && r.columnName == s.columnName || t.startEdit(s.id, s.columnName), !1);\n      }), n.attachEvent(\"onEmptyClick\", function () {\n        return t.isVisible() && t.isChanged() ? t.save() : t.hide(), !0;\n      }), n.attachEvent(\"onTaskDblClick\", function (i, a) {\n        var r = t.getState(),\n          s = t.locateCell(a.target);\n        return !s || !t.isVisible() || s.columnName != r.columnName;\n      });\n    },\n    onShow: function (t, e, n) {\n      var i = n.$gantt;\n      i.ext && i.ext.keyboardNavigation && i.ext.keyboardNavigation.attachEvent(\"onKeyDown\", function (a, r) {\n        var s = i.constants.KEY_CODES,\n          o = !1;\n        return r.keyCode === s.SPACE && t.isVisible() && (o = !0), !o;\n      }), e.onkeydown = function (a) {\n        a = a || window.event;\n        var r = i.constants.KEY_CODES;\n        if (!(a.defaultPrevented || a.shiftKey && a.keyCode != r.TAB)) {\n          var s = !0;\n          switch (a.keyCode) {\n            case i.keys.edit_save:\n              t.save();\n              break;\n            case i.keys.edit_cancel:\n              t.hide();\n              break;\n            case r.UP:\n            case r.DOWN:\n              t.isVisible() && (t.hide(), s = !1);\n              break;\n            case r.TAB:\n              a.shiftKey ? t.editPrevCell(!0) : t.editNextCell(!0);\n              break;\n            default:\n              s = !1;\n          }\n          s && a.preventDefault();\n        }\n      };\n    },\n    onHide: function () {},\n    destroy: function () {}\n  },\n  ya = {\n    init: function (t, e) {\n      var n = t,\n        i = e.$gantt,\n        a = null,\n        r = i.ext.keyboardNavigation;\n      r.attachEvent(\"onBeforeFocus\", function (s) {\n        var o = t.locateCell(s);\n        if (clearTimeout(a), o) {\n          var l = o.columnName,\n            c = o.id,\n            d = n.getState();\n          if (n.isVisible() && d.id == c && d.columnName === l) return !1;\n        }\n        return !0;\n      }), r.attachEvent(\"onFocus\", function (s) {\n        var o = t.locateCell(s),\n          l = t.getState();\n        return clearTimeout(a), !o || o.id == l.id && o.columnName == l.columnName || n.isVisible() && n.save(), !0;\n      }), t.attachEvent(\"onHide\", function () {\n        clearTimeout(a);\n      }), r.attachEvent(\"onBlur\", function () {\n        return a = setTimeout(function () {\n          n.save();\n        }), !0;\n      }), i.attachEvent(\"onTaskDblClick\", function (s, o) {\n        var l = t.getState(),\n          c = t.locateCell(o.target);\n        return !c || !t.isVisible() || c.columnName != l.columnName;\n      }), i.attachEvent(\"onTaskClick\", function (s, o) {\n        if (i._is_icon_open_click(o)) return !0;\n        var l = t.getState(),\n          c = t.locateCell(o.target);\n        return !c || !t.getEditorConfig(c.columnName) || (t.isVisible() && l.id == c.id && l.columnName == c.columnName || t.startEdit(c.id, c.columnName), !1);\n      }), i.attachEvent(\"onEmptyClick\", function () {\n        return n.save(), !0;\n      }), r.attachEvent(\"onKeyDown\", function (s, o) {\n        var l = t.locateCell(o.target),\n          c = !!l && t.getEditorConfig(l.columnName),\n          d = t.getState(),\n          u = i.constants.KEY_CODES,\n          h = o.keyCode,\n          _ = !1;\n        switch (h) {\n          case u.ENTER:\n            t.isVisible() ? (t.save(), o.preventDefault(), _ = !0) : c && !(o.ctrlKey || o.metaKey || o.shiftKey) && (n.startEdit(l.id, l.columnName), o.preventDefault(), _ = !0);\n            break;\n          case u.ESC:\n            t.isVisible() && (t.hide(), o.preventDefault(), _ = !0);\n            break;\n          case u.UP:\n          case u.DOWN:\n            break;\n          case u.LEFT:\n          case u.RIGHT:\n            (c && t.isVisible() || d.editorType === \"date\") && (_ = !0);\n            break;\n          case u.SPACE:\n            t.isVisible() && (_ = !0), c && !t.isVisible() && (n.startEdit(l.id, l.columnName), o.preventDefault(), _ = !0);\n            break;\n          case u.DELETE:\n            c && !t.isVisible() ? (n.startEdit(l.id, l.columnName), _ = !0) : c && t.isVisible() && (_ = !0);\n            break;\n          case u.TAB:\n            if (t.isVisible()) {\n              o.shiftKey ? t.editPrevCell(!0) : t.editNextCell(!0);\n              var p = t.getState();\n              p.id && r.focus({\n                type: \"taskCell\",\n                id: p.id,\n                column: p.columnName\n              }), o.preventDefault(), _ = !0;\n            }\n            break;\n          default:\n            if (t.isVisible()) _ = !0;else if (h >= 48 && h <= 57 || h > 95 && h < 112 || h >= 64 && h <= 91 || h > 185 && h < 193 || h > 218 && h < 223) {\n              var y = s.modifiers,\n                k = y.alt || y.ctrl || y.meta || y.shift;\n              y.alt || k && r.getCommandHandler(s, \"taskCell\") || c && !t.isVisible() && (n.startEdit(l.id, l.columnName), _ = !0);\n            }\n        }\n        return !_;\n      });\n    },\n    onShow: function (t, e, n) {},\n    onHide: function (t, e, n) {\n      const i = n.$gantt;\n      i && i.focus();\n    },\n    destroy: function () {}\n  };\nfunction St(t) {\n  var e = function () {};\n  return e.prototype = {\n    show: function (n, i, a, r) {},\n    hide: function () {},\n    set_value: function (n, i, a, r) {\n      this.get_input(r).value = n;\n    },\n    get_value: function (n, i, a) {\n      return this.get_input(a).value || \"\";\n    },\n    is_changed: function (n, i, a, r) {\n      var s = this.get_value(i, a, r);\n      return s && n && s.valueOf && n.valueOf ? s.valueOf() != n.valueOf() : s != n;\n    },\n    is_valid: function (n, i, a, r) {\n      return !0;\n    },\n    save: function (n, i, a) {},\n    get_input: function (n) {\n      return n.querySelector(\"input\");\n    },\n    focus: function (n) {\n      var i = this.get_input(n);\n      i && (i.focus && i.focus(), i.select && i.select());\n    }\n  }, e;\n}\nfunction ba(t) {\n  var e = St();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  return z(n, e), P(n.prototype, {\n    show: function (i, a, r, s) {\n      var o = `<div role='cell'><input type='text' name='${a.name}' title='${a.name}'></div>`;\n      s.innerHTML = o;\n    }\n  }, !0), n;\n}\nfunction xa(t) {\n  var e = St();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  return z(n, e), P(n.prototype, {\n    show: function (i, a, r, s) {\n      var o = r.min || 0,\n        l = r.max || 100,\n        c = `<div role='cell'><input type='number' min='${o}' max='${l}' name='${a.name}' title='${a.name}'></div>`;\n      s.innerHTML = c, s.oninput = function (d) {\n        +d.target.value < o && (d.target.value = o), +d.target.value > l && (d.target.value = l);\n      };\n    },\n    get_value: function (i, a, r) {\n      return this.get_input(r).value || \"\";\n    },\n    is_valid: function (i, a, r, s) {\n      return !isNaN(parseInt(i, 10));\n    }\n  }, !0), n;\n}\nfunction $a(t) {\n  var e = St();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  return z(n, e), P(n.prototype, {\n    show: function (i, a, r, s) {\n      for (var o = `<div role='cell'><select name='${a.name}' title='${a.name}'>`, l = [], c = r.options || [], d = 0; d < c.length; d++) l.push(\"<option value='\" + r.options[d].key + \"'>\" + c[d].label + \"</option>\");\n      o += l.join(\"\") + \"</select></div>\", s.innerHTML = o;\n    },\n    get_input: function (i) {\n      return i.querySelector(\"select\");\n    }\n  }, !0), n;\n}\nfunction wa(t) {\n  var e = St(),\n    n = \"%Y-%m-%d\",\n    i = null,\n    a = null;\n  function r() {\n    return e.apply(this, arguments) || this;\n  }\n  return z(r, e), P(r.prototype, {\n    show: function (s, o, l, c) {\n      i || (i = t.date.date_to_str(n)), a || (a = t.date.str_to_date(n));\n      var d = null,\n        u = null;\n      d = typeof l.min == \"function\" ? l.min(s, o) : l.min, u = typeof l.max == \"function\" ? l.max(s, o) : l.max;\n      var h = `<div style='width:140px' role='cell'><input type='date' ${d ? \" min='\" + i(d) + \"' \" : \"\"} ${u ? \" max='\" + i(u) + \"' \" : \"\"} name='${o.name}' title='${o.name}'></div>`;\n      c.innerHTML = h, c.oninput = function (_) {\n        _.target.value && (d || u) && (+t.date.str_to_date(\"%Y-%m-%d\")(_.target.value) < +d && (_.target.value = t.date.date_to_str(\"%Y-%m-%d\")(d)), +t.date.str_to_date(\"%Y-%m-%d\")(_.target.value) > +u && (_.target.value = t.date.date_to_str(\"%Y-%m-%d\")(u)));\n      };\n    },\n    set_value: function (s, o, l, c) {\n      s && s.getFullYear ? this.get_input(c).value = i(s) : this.get_input(c).value = s;\n    },\n    is_valid: function (s, o, l, c) {\n      return !(!s || isNaN(s.getTime()));\n    },\n    get_value: function (s, o, l) {\n      var c;\n      try {\n        c = a(this.get_input(l).value || \"\");\n      } catch {\n        c = null;\n      }\n      return c;\n    }\n  }, !0), r;\n}\nfunction Sa(t) {\n  var e = St();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  function i(l) {\n    return l.formatter || t.ext.formatters.linkFormatter();\n  }\n  function a(l, c) {\n    for (var d = (l || \"\").split(c.delimiter || \",\"), u = 0; u < d.length; u++) {\n      var h = d[u].trim();\n      h ? d[u] = h : (d.splice(u, 1), u--);\n    }\n    return d.sort(), d;\n  }\n  function r(l, c, d) {\n    for (var u = l.$target, h = [], _ = 0; _ < u.length; _++) {\n      var p = d.getLink(u[_]);\n      h.push(i(c).format(p));\n    }\n    return h.join((c.delimiter || \",\") + \" \");\n  }\n  function s(l) {\n    return l.source + \"_\" + l.target + \"_\" + l.type + \"_\" + (l.lag || 0);\n  }\n  function o(l, c, d) {\n    var u = function (k, b, g) {\n        var m = [];\n        return [...new Set(b)].forEach(function (f) {\n          var v = i(g).parse(f);\n          v && (v.target = k, v.id = \"predecessor_generated\", t.isLinkAllowed(v) && (v.id = void 0, m.push(v)));\n        }), m;\n      }(l.id, c, d),\n      h = {};\n    l.$target.forEach(function (k) {\n      var b = t.getLink(k);\n      h[s(b)] = b.id;\n    });\n    var _ = [];\n    u.forEach(function (k) {\n      var b = s(k);\n      h[b] ? delete h[b] : _.push(k);\n    });\n    var p = [];\n    for (var y in h) p.push(h[y]);\n    return {\n      add: _,\n      remove: p\n    };\n  }\n  return z(n, e), P(n.prototype, {\n    show: function (l, c, d, u) {\n      var h = `<div role='cell'><input type='text' name='${c.name}' title='${c.name}'></div>`;\n      u.innerHTML = h;\n    },\n    hide: function () {},\n    set_value: function (l, c, d, u) {\n      this.get_input(u).value = r(l, d.editor, t);\n    },\n    get_value: function (l, c, d) {\n      return a(this.get_input(d).value || \"\", c.editor);\n    },\n    save: function (l, c, d) {\n      var u = o(t.getTask(l), this.get_value(l, c, d), c.editor);\n      (u.add.length || u.remove.length) && t.batchUpdate(function () {\n        u.add.forEach(function (h) {\n          t.addLink(h);\n        }), u.remove.forEach(function (h) {\n          t.deleteLink(h);\n        }), t.autoSchedule && t.autoSchedule();\n      });\n    },\n    is_changed: function (l, c, d, u) {\n      var h = this.get_value(c, d, u),\n        _ = a(r(l, d.editor, t), d.editor);\n      return h.join() !== _.join();\n    }\n  }, !0), n;\n}\nfunction Ta(t) {\n  var e = St();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  function i(a) {\n    return a.formatter || t.ext.formatters.durationFormatter();\n  }\n  return z(n, e), P(n.prototype, {\n    show: function (a, r, s, o) {\n      var l = `<div role='cell'><input type='text' name='${r.name}' title='${r.name}'></div>`;\n      o.innerHTML = l;\n    },\n    set_value: function (a, r, s, o) {\n      this.get_input(o).value = i(s.editor).format(a);\n    },\n    get_value: function (a, r, s) {\n      return i(r.editor).parse(this.get_input(s).value || \"\");\n    }\n  }, !0), n;\n}\nfunction Ea(t) {\n  return function (n, i, a) {\n    a == \"keepDates\" ? function (r, s) {\n      s == \"duration\" ? r.end_date = t.calculateEndDate(r) : s != \"end_date\" && s != \"start_date\" || (r.duration = t.calculateDuration(r));\n    }(n, i) : a == \"keepDuration\" ? function (r, s) {\n      s == \"end_date\" ? r.start_date = e(r) : s != \"start_date\" && s != \"duration\" || (r.end_date = t.calculateEndDate(r));\n    }(n, i) : function (r, s) {\n      t.config.schedule_from_end ? s == \"end_date\" || s == \"duration\" ? r.start_date = e(r) : s == \"start_date\" && (r.duration = t.calculateDuration(r)) : s == \"start_date\" || s == \"duration\" ? r.end_date = t.calculateEndDate(r) : s == \"end_date\" && (r.duration = t.calculateDuration(r));\n    }(n, i);\n  };\n  function e(n) {\n    return t.calculateEndDate({\n      start_date: n.end_date,\n      duration: -n.duration,\n      task: n\n    });\n  }\n}\nfunction Ca(t) {\n  t.config.editor_types = {\n    text: new (ba())(),\n    number: new (xa())(),\n    select: new ($a())(),\n    date: new (wa(t))(),\n    predecessor: new (Sa(t))(),\n    duration: new (Ta(t))()\n  };\n}\nfunction Da(t) {\n  var e = /* @__PURE__ */function (a) {\n      var r = null;\n      return {\n        setMapping: function (s) {\n          r = s;\n        },\n        getMapping: function () {\n          return r || (a.config.keyboard_navigation_cells && a.ext.keyboardNavigation ? ya : ka);\n        }\n      };\n    }(t),\n    n = {};\n  ot(n);\n  var i = {\n    init: Ca,\n    createEditors: function (a) {\n      function r(u, h) {\n        var _ = a.$getConfig(),\n          p = function (b, g) {\n            for (var m = a.$getConfig(), f = a.getItemTop(b), v = a.getItemHeight(b), x = a.getGridColumns(), $ = 0, w = 0, S = 0, T = 0; T < x.length; T++) {\n              if (x[T].name == g) {\n                S = x[T].width;\n                break;\n              }\n              m.rtl ? w += x[T].width : $ += x[T].width;\n            }\n            return m.rtl ? {\n              top: f,\n              right: w,\n              height: v,\n              width: S\n            } : {\n              top: f,\n              left: $,\n              height: v,\n              width: S\n            };\n          }(u, h),\n          y = document.createElement(\"div\");\n        y.className = \"gantt_grid_editor_placeholder\", y.setAttribute(a.$config.item_attribute, u), y.setAttribute(a.$config.bind + \"_id\", u), y.setAttribute(\"data-column-name\", h);\n        var k = function (b, g) {\n          for (var m = b.getGridColumns(), f = 0; f < m.length; f++) if (m[f].name == g) return f;\n          return 0;\n        }(a, h);\n        return y.setAttribute(\"data-column-index\", k), t._waiAria.inlineEditorAttr(y), _.rtl ? y.style.cssText = [\"top:\" + p.top + \"px\", \"right:\" + p.right + \"px\", \"width:\" + p.width + \"px\", \"height:\" + p.height + \"px\"].join(\";\") : y.style.cssText = [\"top:\" + p.top + \"px\", \"left:\" + p.left + \"px\", \"width:\" + p.width + \"px\", \"height:\" + p.height + \"px\"].join(\";\"), y;\n      }\n      var s = Ea(t),\n        o = [],\n        l = [],\n        c = null,\n        d = {\n          _itemId: null,\n          _columnName: null,\n          _editor: null,\n          _editorType: null,\n          _placeholder: null,\n          locateCell: function (u) {\n            if (!Y(u, a.$grid)) return null;\n            var h = nt(u, a.$config.item_attribute),\n              _ = nt(u, \"data-column-name\");\n            if (h && _) {\n              var p = _.getAttribute(\"data-column-name\");\n              return {\n                id: h.getAttribute(a.$config.item_attribute),\n                columnName: p\n              };\n            }\n            return null;\n          },\n          getEditorConfig: function (u) {\n            return a.getColumn(u).editor;\n          },\n          init: function () {\n            var u = e.getMapping();\n            u.init && u.init(this, a), c = a.$gantt.getDatastore(a.$config.bind);\n            var h = this;\n            o.push(c.attachEvent(\"onIdChange\", function (_, p) {\n              h._itemId == _ && (h._itemId = p);\n            })), o.push(c.attachEvent(\"onStoreUpdated\", function () {\n              a.$gantt.getState(\"batchUpdate\").batch_update || h.isVisible() && !c.isVisible(h._itemId) && h.hide();\n            })), l.push(t.attachEvent(\"onDataRender\", function () {\n              h._editor && h._placeholder && !Y(h._placeholder, t.$root) && a.$grid_data.appendChild(h._placeholder);\n            })), this.init = function () {};\n          },\n          getState: function () {\n            return {\n              editor: this._editor,\n              editorType: this._editorType,\n              placeholder: this._placeholder,\n              id: this._itemId,\n              columnName: this._columnName\n            };\n          },\n          startEdit: function (u, h) {\n            if (this.isVisible() && this.save(), !c.exists(u)) return;\n            var _ = {\n              id: u,\n              columnName: h\n            };\n            if (t.isReadonly(c.getItem(u))) return void this.callEvent(\"onEditPrevent\", [_]);\n            if (this.callEvent(\"onBeforeEditStart\", [_]) === !1) return void this.callEvent(\"onEditPrevent\", [_]);\n            const p = this.show(_.id, _.columnName);\n            p && p.then ? p.then(function () {\n              this.setValue(), this.callEvent(\"onEditStart\", [_]);\n            }.bind(this)) : (this.setValue(), this.callEvent(\"onEditStart\", [_]));\n          },\n          isVisible: function () {\n            return !(!this._editor || !Y(this._placeholder, t.$root));\n          },\n          show: function (u, h) {\n            this.isVisible() && this.save();\n            var _ = {\n                id: u,\n                columnName: h\n              },\n              p = a.getColumn(_.columnName),\n              y = this.getEditorConfig(p.name);\n            if (!y) return;\n            var k = a.$getConfig().editor_types[y.type],\n              b = r(_.id, _.columnName);\n            a.$grid_data.appendChild(b);\n            const g = function () {\n                this._editor = k, this._placeholder = b, this._itemId = _.id, this._columnName = _.columnName, this._editorType = y.type;\n                var f = e.getMapping();\n                f.onShow && f.onShow(this, b, a), b._onReMount = function () {\n                  this.setValue();\n                }.bind(this);\n              }.bind(this),\n              m = k.show(_.id, p, y, b);\n            if (m && m.then) return m.then(() => {\n              g();\n            });\n            g();\n          },\n          setValue: function () {\n            var u = this.getState(),\n              h = u.id,\n              _ = u.columnName,\n              p = a.getColumn(_),\n              y = c.getItem(h),\n              k = this.getEditorConfig(_);\n            if (k) {\n              var b = y[k.map_to];\n              k.map_to == \"auto\" && (b = c.getItem(h)), this._editor.set_value(b, h, p, this._placeholder), this.focus();\n            }\n          },\n          focus: function () {\n            this._editor.focus(this._placeholder);\n          },\n          getValue: function () {\n            var u = a.getColumn(this._columnName);\n            return this._editor.get_value(this._itemId, u, this._placeholder);\n          },\n          _getItemValue: function () {\n            var u = this.getEditorConfig(this._columnName);\n            if (u) {\n              var h = t.getTask(this._itemId)[u.map_to];\n              return u.map_to == \"auto\" && (h = c.getItem(this._itemId)), h;\n            }\n          },\n          isChanged: function () {\n            var u = a.getColumn(this._columnName),\n              h = this._getItemValue();\n            return this._editor.is_changed(h, this._itemId, u, this._placeholder);\n          },\n          hide: function () {\n            if (this._itemId) {\n              var u = this._itemId,\n                h = this._columnName,\n                _ = e.getMapping();\n              _.onHide && _.onHide(this, this._placeholder, a), this._itemId = null, this._columnName = null, this._editorType = null, this._placeholder && (this._editor && this._editor.hide && this._editor.hide(this._placeholder), this._editor = null, this._placeholder.parentNode && this._placeholder.parentNode.removeChild(this._placeholder), this._placeholder = null, this.callEvent(\"onEditEnd\", [{\n                id: u,\n                columnName: h\n              }]));\n            }\n          },\n          save: function () {\n            if (this.isVisible() && c.exists(this._itemId) && this.isChanged()) {\n              var u = this._itemId,\n                h = this._columnName;\n              if (c.exists(u)) {\n                var _ = c.getItem(u),\n                  p = this.getEditorConfig(h),\n                  y = {\n                    id: u,\n                    columnName: h,\n                    newValue: this.getValue(),\n                    oldValue: this._getItemValue()\n                  };\n                if (this.callEvent(\"onBeforeSave\", [y]) !== !1 && (!this._editor.is_valid || this._editor.is_valid(y.newValue, y.id, a.getColumn(h), this._placeholder))) {\n                  var k = p.map_to,\n                    b = y.newValue;\n                  k != \"auto\" ? (_[k] = b, s(_, k, t.config.inline_editors_date_processing), c.updateItem(u)) : this._editor.save(u, a.getColumn(h), this._placeholder), this.callEvent(\"onSave\", [y]);\n                }\n                this.hide();\n              }\n            } else this.hide();\n          },\n          _findEditableCell: function (u, h) {\n            var _ = u,\n              p = a.getGridColumns()[_],\n              y = p ? p.name : null;\n            if (y) {\n              for (; y && !this.getEditorConfig(y);) y = this._findEditableCell(u + h, h);\n              return y;\n            }\n            return null;\n          },\n          getNextCell: function (u) {\n            return this._findEditableCell(a.getColumnIndex(this._columnName, !0) + u, u);\n          },\n          getFirstCell: function () {\n            return this._findEditableCell(0, 1);\n          },\n          getLastCell: function () {\n            return this._findEditableCell(a.getGridColumns().length - 1, -1);\n          },\n          editNextCell: function (u) {\n            var h = this.getNextCell(1);\n            if (h) {\n              var _ = this.getNextCell(1);\n              _ && this.getEditorConfig(_) && this.startEdit(this._itemId, _);\n            } else if (u && this.moveRow(1)) {\n              var p = this.moveRow(1);\n              (h = this.getFirstCell()) && this.getEditorConfig(h) && this.startEdit(p, h);\n            }\n          },\n          editPrevCell: function (u) {\n            var h = this.getNextCell(-1);\n            if (h) {\n              var _ = this.getNextCell(-1);\n              _ && this.getEditorConfig(_) && this.startEdit(this._itemId, _);\n            } else if (u && this.moveRow(-1)) {\n              var p = this.moveRow(-1);\n              (h = this.getLastCell()) && this.getEditorConfig(h) && this.startEdit(p, h);\n            }\n          },\n          moveRow: function (u) {\n            for (var h = u > 0 ? t.getNext : t.getPrev, _ = (h = t.bind(h, t))(this._itemId); t.isTaskExists(_) && t.isReadonly(t.getTask(_));) _ = h(_);\n            return _;\n          },\n          editNextRow: function (u) {\n            var h = this.getState().id;\n            if (t.isTaskExists(h)) {\n              var _ = null;\n              _ = u ? this.moveRow(1) : t.getNext(h), t.isTaskExists(_) && this.startEdit(_, this._columnName);\n            }\n          },\n          editPrevRow: function (u) {\n            var h = this.getState().id;\n            if (t.isTaskExists(h)) {\n              var _ = null;\n              _ = u ? this.moveRow(-1) : t.getPrev(h), t.isTaskExists(_) && this.startEdit(_, this._columnName);\n            }\n          },\n          detachStore: function () {\n            o.forEach(function (u) {\n              c.detachEvent(u);\n            }), l.forEach(function (u) {\n              t.detachEvent(u);\n            }), o = [], l = [], c = null, this.hide();\n          },\n          destructor: function () {\n            this.detachStore(), this.detachAllEvents();\n          }\n        };\n      return P(d, e), P(d, n), d;\n    }\n  };\n  return P(i, e), P(i, n), i;\n}\nfunction $e(t, e, n, i, a) {\n  if (!t.start_date || !t.end_date) return null;\n  var r = n.getItemTop(t.id),\n    s = n.getItemHeight(t.id);\n  if (r > e.y_end || r + s < e.y) return !1;\n  var o = n.posFromDate(t.start_date),\n    l = n.posFromDate(t.end_date),\n    c = Math.min(o, l) - 200,\n    d = Math.max(o, l) + 200;\n  return !(c > e.x_end || d < e.x);\n}\nfunction bn(t) {\n  function e(r, s, o) {\n    if (t._isAllowedUnscheduledTask(r) || !t._isTaskInTimelineLimits(r)) return;\n    var l = s.getItemPosition(r),\n      c = o,\n      d = s.$getTemplates(),\n      u = t.getTaskType(r.type),\n      h = s.getBarHeight(r.id, u == c.types.milestone),\n      _ = 0;\n    u == c.types.milestone && (_ = (h - l.height) / 2);\n    var p = Math.floor((s.getItemHeight(r.id) - h) / 2);\n    const y = t.config.baselines && r.baselines && r.baselines.length,\n      k = t.config.baselines && (t.config.baselines.render_mode == \"separateRow\" || t.config.baselines.render_mode == \"individualRow\");\n    if (y && k && r.bar_height !== \"full\" && r.bar_height < r.row_height) if (u === c.types.milestone) {\n      let T = s.getBarHeight(r.id, !0),\n        E = Math.sqrt(2 * T * T);\n      p = Math.floor((E - h) / 2) + 2;\n    } else p = 2;\n    u == c.types.milestone && (l.left -= Math.round(h / 2), l.width = h);\n    var b = document.createElement(\"div\"),\n      g = Math.round(l.width);\n    s.$config.item_attribute && (b.setAttribute(s.$config.item_attribute, r.id), b.setAttribute(s.$config.bind + \"_id\", r.id)), c.show_progress && u != c.types.milestone && function (T, E, C, D, M) {\n      var I = 1 * T.progress || 0;\n      C = Math.max(C, 0);\n      var A = document.createElement(\"div\"),\n        N = Math.round(C * I);\n      N = Math.min(C, N), A.style.width = N + \"px\", A.className = \"gantt_task_progress\", A.innerHTML = M.progress_text(T.start_date, T.end_date, T), D.rtl && (A.style.position = \"absolute\", A.style.right = \"0px\");\n      var L = document.createElement(\"div\");\n      L.className = \"gantt_task_progress_wrapper\", L.appendChild(A), E.appendChild(L);\n      const O = !t.isReadonly(T),\n        G = t.ext.dragTimeline && t.ext.dragTimeline._isDragInProgress();\n      if (t.config.drag_progress && (O || G)) {\n        var j = document.createElement(\"div\"),\n          H = N;\n        D.rtl && (H = C - N), j.style.left = H + \"px\", j.className = \"gantt_task_progress_drag\", j.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\n</svg>`, A.appendChild(j), E.appendChild(j);\n      }\n    }(r, b, g, c, d);\n    var m = function (T, E, C) {\n      var D = document.createElement(\"div\");\n      return t.getTaskType(T.type) != t.config.types.milestone ? D.innerHTML = C.task_text(T.start_date, T.end_date, T) : t.getTaskType(T.type) == t.config.types.milestone && E && (D.style.height = D.style.width = E + \"px\"), D.className = \"gantt_task_content\", D;\n    }(r, g, d);\n    b.appendChild(m);\n    var f = function (T, E, C, D) {\n      var M = D.$getConfig(),\n        I = [T];\n      E && I.push(E);\n      var A = t.getState(),\n        N = t.getTask(C);\n      if (t.getTaskType(N.type) == M.types.milestone ? I.push(\"gantt_milestone\") : t.getTaskType(N.type) == M.types.project && I.push(\"gantt_project\"), I.push(\"gantt_bar_\" + t.getTaskType(N.type)), t.isSummaryTask(N) && I.push(\"gantt_dependent_task\"), t.isSplitTask(N) && (M.open_split_tasks && !N.$open || !M.open_split_tasks) && I.push(\"gantt_split_parent\"), M.select_task && t.isSelectedTask(C) && I.push(\"gantt_selected\"), C == A.drag_id && (I.push(\"gantt_drag_\" + A.drag_mode), A.touch_drag && I.push(\"gantt_touch_\" + A.drag_mode)), A.link_source_id == C && (I.push(\"gantt_link_source\"), A.link_from_start ? I.push(\"gantt_link_from_start\") : I.push(\"gantt_link_from_end\")), A.link_target_id == C && I.push(\"gantt_link_target\"), M.highlight_critical_path && t.isCriticalTask && t.isCriticalTask(N) && I.push(\"gantt_critical_task\"), A.link_landing_area && A.link_target_id && A.link_source_id && A.link_target_id != A.link_source_id && (A.link_target_id == C || A.link_source_id == C)) {\n        var L = A.link_source_id,\n          O = A.link_from_start,\n          G = A.link_to_start,\n          j = \"\";\n        j = t.isLinkAllowed(L, C, O, G) ? G ? \"link_start_allow\" : \"link_finish_allow\" : G ? \"link_start_deny\" : \"link_finish_deny\", I.push(j);\n      }\n      return I.join(\" \");\n    }(\"gantt_task_line\", d.task_class(r.start_date, r.end_date, r), r.id, s);\n    (r.color || r.progressColor || r.textColor) && (f += \" gantt_task_inline_color\"), l.width < 20 && (f += \" gantt_thin_task\"), b.className = f;\n    var v = [\"left:\" + l.left + \"px\", \"top:\" + (p + l.top) + \"px\", \"height:\" + h + \"px\", \"line-height:\" + Math.max(h < 30 ? h - 2 : h, 0) + \"px\", \"width:\" + g + \"px\"];\n    b.style.cssText = v.join(\";\"), r.color && b.style.setProperty(\"--dhx-gantt-task-background\", r.color), r.textColor && b.style.setProperty(\"--dhx-gantt-task-color\", r.textColor), r.progressColor && b.style.setProperty(\"--dhx-gantt-task-progress-color\", r.progressColor);\n    var x = function (T, E, C, D) {\n      var M = \"gantt_left \" + i(!E.rtl, T),\n        I = null;\n      return D && (I = {\n        type: \"marginRight\",\n        value: D\n      }), n(T, C.leftside_text, M, I);\n    }(r, c, d, _);\n    x && b.appendChild(x), x = function (T, E, C, D) {\n      var M = \"gantt_right \" + i(!!E.rtl, T),\n        I = null;\n      return D && (I = {\n        type: \"marginLeft\",\n        value: D\n      }), n(T, C.rightside_text, M, I);\n    }(r, c, d, _), x && b.appendChild(x), t._waiAria.setTaskBarAttr(r, b);\n    var $ = t.getState();\n    const w = !t.isReadonly(r),\n      S = t.ext.dragTimeline && t.ext.dragTimeline._isDragInProgress();\n    return (w || S) && (c.drag_resize && !t.isSummaryTask(r) && u != c.types.milestone && a(b, \"gantt_task_drag\", r, function (T) {\n      var E = document.createElement(\"div\");\n      return E.className = T, E;\n    }, c), c.drag_links && c.show_links && a(b, \"gantt_link_control\", r, function (T) {\n      var E = document.createElement(\"div\");\n      E.className = T, E.style.cssText = [\"height:\" + h + \"px\", \"line-height:\" + h + \"px\"].join(\";\");\n      var C = document.createElement(\"div\");\n      C.className = \"gantt_link_point\";\n      var D = !1;\n      return $.link_source_id && c.touch && (D = !0), C.style.display = D ? \"block\" : \"\", E.appendChild(C), E;\n    }, c, _)), b;\n  }\n  function n(r, s, o, l) {\n    if (!s) return null;\n    var c = s(r.start_date, r.end_date, r);\n    if (!c) return null;\n    var d = document.createElement(\"div\");\n    return d.className = \"gantt_side_content \" + o, d.innerHTML = c, l && (d.style[l.type] = Math.abs(l.value) + \"px\"), d;\n  }\n  function i(r, s) {\n    var o = r ? {\n      $source: [t.config.links.start_to_start],\n      $target: [t.config.links.start_to_start, t.config.links.finish_to_start]\n    } : {\n      $source: [t.config.links.finish_to_start, t.config.links.finish_to_finish],\n      $target: [t.config.links.finish_to_finish]\n    };\n    for (var l in o) for (var c = s[l], d = 0; d < c.length; d++) for (var u = t.getLink(c[d]), h = 0; h < o[l].length; h++) if (u.type == o[l][h]) return \"gantt_link_crossing\";\n    return \"\";\n  }\n  function a(r, s, o, l, c, d) {\n    var u,\n      h = t.getState();\n    +o.start_date >= +h.min_date && ((u = l([s, c.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"].join(\" \"))).setAttribute(\"data-bind-property\", \"start_date\"), d && (u.style.marginLeft = d + \"px\"), r.appendChild(u)), +o.end_date <= +h.max_date && ((u = l([s, c.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"].join(\" \"))).setAttribute(\"data-bind-property\", \"end_date\"), d && (u.style.marginRight = d + \"px\"), r.appendChild(u));\n  }\n  return function (r, s, o) {\n    var l = (o = s.$getConfig()).type_renderers[t.getTaskType(r.type)],\n      c = e;\n    return l ? l.call(t, r, function (d) {\n      return c.call(t, d, s, o);\n    }, s) : c.call(t, r, s, o);\n  };\n}\nfunction Ue(t) {\n  return {\n    render: bn(t),\n    update: null,\n    isInViewPort: $e,\n    getVisibleRange: ft\n  };\n}\nfunction Ct() {\n  return console.error(\"You are trying to use a Pro feature that is not available in the GPL version.\"), {\n    render: function () {},\n    isInViewPort: function () {},\n    getVisibleRange: function () {}\n  };\n}\nfunction qe(t, e, n) {\n  return {\n    top: e.getItemTop(t.id),\n    height: e.getItemHeight(t.id),\n    left: 0,\n    right: 1 / 0\n  };\n}\nfunction jt(t, e) {\n  var n = 0,\n    i = t.left.length - 1;\n  if (e) for (var a = 0; a < t.left.length; a++) {\n    var r = t.left[a];\n    if (r < e.x && (n = a), r > e.x_end) {\n      i = a;\n      break;\n    }\n  }\n  return {\n    start: n,\n    end: i\n  };\n}\nfunction oe(t, e, n, i) {\n  var a = e.width[t];\n  if (a <= 0) return !1;\n  if (!i.config.smart_rendering || Nt(i)) return !0;\n  var r = e.left[t] - a,\n    s = e.left[t] + a;\n  return r <= n.x_end && s >= n.x;\n}\nfunction Aa(t, e) {\n  var n = e.config.timeline_placeholder;\n  if (t = t || [], n && t.filter(l => l.id === \"timeline_placeholder_task\").length === 0) {\n    var i = e.getState(),\n      a = null,\n      r = i.min_date,\n      s = i.max_date;\n    t.length && (a = t[t.length - 1].id);\n    var o = {\n      start_date: r,\n      end_date: s,\n      row_height: n.height || 0,\n      id: \"timeline_placeholder_task\",\n      unscheduled: !0,\n      lastTaskId: a,\n      calendar_id: n.calendar || \"global\",\n      $source: [],\n      $target: []\n    };\n    t.push(o);\n  }\n}\nfunction Ia(t) {\n  var e = {\n      current_pos: null,\n      dirs: {\n        left: \"left\",\n        right: \"right\",\n        up: \"up\",\n        down: \"down\"\n      },\n      path: [],\n      clear: function () {\n        this.current_pos = null, this.path = [];\n      },\n      point: function (a) {\n        this.current_pos = t.copy(a);\n      },\n      get_lines: function (a) {\n        this.clear(), this.point(a[0]);\n        for (var r = 1; r < a.length; r++) this.line_to(a[r]);\n        return this.get_path();\n      },\n      line_to: function (a) {\n        var r = t.copy(a),\n          s = this.current_pos,\n          o = this._get_line(s, r);\n        this.path.push(o), this.current_pos = r;\n      },\n      get_path: function () {\n        return this.path;\n      },\n      get_wrapper_sizes: function (a, r, s) {\n        var o,\n          l = r.$getConfig().link_wrapper_width,\n          c = a.y - l / 2;\n        switch (a.direction) {\n          case this.dirs.left:\n            o = {\n              top: c,\n              height: l,\n              lineHeight: l,\n              left: a.x - a.size - l / 2,\n              width: a.size + l\n            };\n            break;\n          case this.dirs.right:\n            o = {\n              top: c,\n              lineHeight: l,\n              height: l,\n              left: a.x - l / 2,\n              width: a.size + l\n            };\n            break;\n          case this.dirs.up:\n            o = {\n              top: c - a.size,\n              lineHeight: a.size + l,\n              height: a.size + l,\n              left: a.x - l / 2,\n              width: l\n            };\n            break;\n          case this.dirs.down:\n            o = {\n              top: c,\n              lineHeight: a.size + l,\n              height: a.size + l,\n              left: a.x - l / 2,\n              width: l\n            };\n        }\n        return o;\n      },\n      get_line_sizes: function (a, r) {\n        var s,\n          o = r.$getConfig(),\n          l = o.link_line_width,\n          c = o.link_wrapper_width,\n          d = a.size + l;\n        switch (a.direction) {\n          case this.dirs.left:\n          case this.dirs.right:\n            s = {\n              height: l,\n              width: d,\n              marginTop: (c - l) / 2,\n              marginLeft: (c - l) / 2\n            };\n            break;\n          case this.dirs.up:\n          case this.dirs.down:\n            s = {\n              height: d,\n              width: l,\n              marginTop: (c - l) / 2,\n              marginLeft: (c - l) / 2\n            };\n        }\n        return s;\n      },\n      render_line: function (a, r, s, o) {\n        var l = this.get_wrapper_sizes(a, s, o),\n          c = document.createElement(\"div\");\n        c.style.cssText = [\"top:\" + l.top + \"px\", \"left:\" + l.left + \"px\", \"height:\" + l.height + \"px\", \"width:\" + l.width + \"px\"].join(\";\"), c.className = \"gantt_line_wrapper\";\n        var d = this.get_line_sizes(a, s),\n          u = document.createElement(\"div\");\n        return u.style.cssText = [\"height:\" + d.height + \"px\", \"width:\" + d.width + \"px\", \"margin-top:\" + d.marginTop + \"px\", \"margin-left:\" + d.marginLeft + \"px\"].join(\";\"), u.className = \"gantt_link_line_\" + a.direction, c.appendChild(u), c;\n      },\n      render_corner: function (a, r) {\n        const s = a.radius,\n          o = r.$getConfig(),\n          l = o.link_line_width || 2,\n          c = document.createElement(\"div\");\n        let d, u;\n        return c.classList.add(\"gantt_link_corner\"), c.classList.add(`gantt_link_corner_${a.direction.from}_${a.direction.to}`), c.style.width = `${s}px`, c.style.height = `${s}px`, a.direction.from === \"right\" && a.direction.to === \"down\" ? (d = \"Right\", u = \"Top\", c.style.left = a.x - o.link_line_width / 2 + \"px\", c.style.top = `${a.y}px`) : a.direction.from === \"down\" && a.direction.to === \"right\" ? (d = \"Left\", u = \"Bottom\", c.style.left = a.x - o.link_line_width / 2 + \"px\", c.style.top = `${a.y}px`) : a.direction.from === \"right\" && a.direction.to === \"up\" ? (d = \"Right\", u = \"Bottom\", c.style.left = a.x - o.link_line_width / 2 + \"px\", c.style.top = a.y - s + \"px\") : a.direction.from === \"up\" && a.direction.to === \"right\" ? (d = \"Left\", u = \"Top\", c.style.left = a.x - o.link_line_width / 2 + \"px\", c.style.top = a.y - s + \"px\") : a.direction.from === \"left\" && a.direction.to === \"down\" ? (d = \"Left\", u = \"Top\", c.style.left = a.x - s - o.link_line_width / 2 + \"px\", c.style.top = `${a.y}px`) : a.direction.from === \"down\" && a.direction.to === \"left\" ? (d = \"Right\", u = \"Bottom\", c.style.left = a.x - s - o.link_line_width / 2 + \"px\", c.style.top = `${a.y}px`) : a.direction.from === \"left\" && a.direction.to === \"up\" ? (d = \"Left\", u = \"Bottom\", c.style.left = a.x - s - o.link_line_width / 2 + \"px\", c.style.top = a.y - s + \"px\") : a.direction.from === \"up\" && a.direction.to === \"left\" && (d = \"Right\", u = \"Top\", c.style.left = a.x - s - o.link_line_width / 2 + \"px\", c.style.top = a.y - s + \"px\"), c.style[`border${u}Width`] = `${l}px`, c.style[`border${d}Width`] = `${l}px`, c.style[`border${d}Style`] = \"solid\", c.style[`border${u}Style`] = \"solid\", c.style[`border${u}${d}Radius`] = `${s}px`, c;\n      },\n      render_arrow(a, r) {\n        var s = document.createElement(\"div\"),\n          o = a.y,\n          l = a.x,\n          c = r.link_arrow_size;\n        s.style.setProperty(\"--dhx-gantt-icon-size\", `${c}px`);\n        var d = \"gantt_link_arrow gantt_link_arrow_\" + a.direction;\n        return s.style.top = o + \"px\", s.style.left = l + \"px\", s.className = d, s;\n      },\n      _get_line: function (a, r) {\n        var s = this.get_direction(a, r),\n          o = {\n            x: a.x,\n            y: a.y,\n            direction: this.get_direction(a, r)\n          };\n        return s == this.dirs.left || s == this.dirs.right ? o.size = Math.abs(a.x - r.x) : o.size = Math.abs(a.y - r.y), o;\n      },\n      get_direction: function (a, r) {\n        return r.x < a.x ? this.dirs.left : r.x > a.x ? this.dirs.right : r.y > a.y ? this.dirs.down : this.dirs.up;\n      }\n    },\n    n = {\n      path: [],\n      clear: function () {\n        this.path = [];\n      },\n      current: function () {\n        return this.path[this.path.length - 1];\n      },\n      point: function (a) {\n        return a ? (this.path.push(t.copy(a)), a) : this.current();\n      },\n      point_to: function (a, r, s) {\n        s = s ? {\n          x: s.x,\n          y: s.y\n        } : t.copy(this.point());\n        var o = e.dirs;\n        switch (a) {\n          case o.left:\n            s.x -= r;\n            break;\n          case o.right:\n            s.x += r;\n            break;\n          case o.up:\n            s.y -= r;\n            break;\n          case o.down:\n            s.y += r;\n        }\n        return this.point(s);\n      },\n      get_points: function (a, r, s, o) {\n        var l = this.get_endpoint(a, r, s, o),\n          c = t.config,\n          d = l.e_y - l.y,\n          u = l.e_x - l.x,\n          h = e.dirs,\n          _ = r.getItemHeight(a.source);\n        this.clear(), this.point({\n          x: l.x,\n          y: l.y\n        });\n        var p = 2 * c.link_arrow_size,\n          y = this.get_line_type(a, r.$getConfig()),\n          k = l.e_x > l.x;\n        if (y.from_start && y.to_start) this.point_to(h.left, p), k ? (this.point_to(h.down, d), this.point_to(h.right, u)) : (this.point_to(h.right, u), this.point_to(h.down, d)), this.point_to(h.right, p);else if (!y.from_start && y.to_start) {\n          if (d !== 0 && (k = l.e_x > l.x + 2 * p), this.point_to(h.right, p), k) u -= p, this.point_to(h.down, d), this.point_to(h.right, u);else {\n            u -= 2 * p;\n            var b = d > 0 ? 1 : -1;\n            this.point_to(h.down, b * (_ / 2)), this.point_to(h.right, u), this.point_to(h.down, b * (Math.abs(d) - _ / 2)), this.point_to(h.right, p);\n          }\n        } else y.from_start || y.to_start ? y.from_start && !y.to_start && (d !== 0 && (k = l.e_x > l.x - 2 * p), this.point_to(h.left, p), k ? (u += 2 * p, b = d > 0 ? 1 : -1, this.point_to(h.down, b * (_ / 2)), this.point_to(h.right, u), this.point_to(h.down, b * (Math.abs(d) - _ / 2)), this.point_to(h.left, p)) : (u += p, this.point_to(h.down, d), this.point_to(h.right, u))) : (this.point_to(h.right, p), k ? (this.point_to(h.right, u), this.point_to(h.down, d)) : (this.point_to(h.down, d), this.point_to(h.right, u)), this.point_to(h.left, p));\n        return this.path;\n      },\n      get_line_type: function (a, r) {\n        var s = r.links,\n          o = !1,\n          l = !1;\n        return a.type == s.start_to_start ? o = l = !0 : a.type == s.finish_to_finish ? o = l = !1 : a.type == s.finish_to_start ? (o = !1, l = !0) : a.type == s.start_to_finish ? (o = !0, l = !1) : t.assert(!1, \"Invalid link type\"), r.rtl && (o = !o, l = !l), {\n          from_start: o,\n          to_start: l\n        };\n      },\n      get_endpoint: function (a, r, s, o) {\n        var l = r.$getConfig(),\n          c = this.get_line_type(a, l),\n          d = c.from_start,\n          u = c.to_start,\n          h = i(s, r, l),\n          _ = i(o, r, l);\n        return {\n          x: d ? h.left : h.left + h.width,\n          e_x: u ? _.left : _.left + _.width,\n          y: h.top + h.rowHeight / 2 - 1,\n          e_y: _.top + _.rowHeight / 2 - 1\n        };\n      }\n    };\n  function i(a, r, s) {\n    var o = r.getItemPosition(a);\n    let l = function (p, y, k, b) {\n        let g = b || y.$task_data.scrollHeight,\n          m = !1,\n          f = !1;\n        return p.eachParent(function (v) {\n          if ($t(v)) {\n            f = !0;\n            const x = y.getItemPosition(v).rowHeight;\n            x < g && (g = x, m = !0);\n          }\n        }, k.id), {\n          maxHeight: g,\n          shrinkHeight: m,\n          splitChild: f\n        };\n      }(t, r, a),\n      c = l.maxHeight,\n      d = l.splitChild;\n    const u = t.config.baselines && (t.config.baselines.render_mode == \"separateRow\" || t.config.baselines.render_mode == \"individualRow\") && a.baselines && a.baselines.length;\n    let h;\n    l.shrinkHeight && (o.rowHeight = c);\n    let _ = t.getTaskType(a.type) == s.types.milestone;\n    if (_) {\n      let p = r.getBarHeight(a.id, !0);\n      h = Math.sqrt(2 * p * p), l.shrinkHeight && c < p && (p = c, h = c), o.left -= h / 2, o.width = h;\n    }\n    if (d) {\n      if (c >= o.height) {\n        const p = function (y, k) {\n          let b = !1;\n          return y.eachTask(function (g) {\n            b || (b = hn(y, g));\n          }, k), b;\n        }(t, a.parent);\n        u || p ? _ ? (o.rowHeight = o.height + 4, o.left += (o.width - o.rowHeight + 4) / 2, o.width = o.rowHeight - 3) : o.rowHeight = o.height + 6 : _ && (o.left += (h - o.height) / 2);\n      } else o.rowHeight = c + 2, _ && (o.left += (o.width - o.rowHeight + 4) / 2, o.width = o.rowHeight - 3);\n    } else u && (o.rowHeight = o.height + 4);\n    return o;\n  }\n  return {\n    render: function (a, r, s) {\n      var o = t.getTask(a.source);\n      if (o.hide_bar) return;\n      var l = t.getTask(a.target);\n      if (l.hide_bar) return;\n      var c = n.get_endpoint(a, r, o, l),\n        d = c.e_y - c.y;\n      if (!(c.e_x - c.x) && !d) return null;\n      var u = n.get_points(a, r, o, l);\n      const h = function (k, b) {\n          const g = b.link_radius || 4,\n            m = b.link_arrow_size || 6,\n            f = [];\n          for (let x = 0; x < k.length; x++) {\n            const $ = k[x],\n              w = k[x + 1];\n            if (!w || b.link_radius <= 1) f.push({\n              type: \"line\",\n              data: $\n            });else if ($.direction !== w.direction) {\n              if ($.size < g || w.size < g) {\n                f.push({\n                  type: \"line\",\n                  data: $\n                });\n                continue;\n              }\n              $.size -= g, f.push({\n                type: \"line\",\n                data: $\n              });\n              let S = $.x,\n                T = $.y - b.link_line_width / 2;\n              switch ($.direction) {\n                case \"right\":\n                  S += $.size;\n                  break;\n                case \"left\":\n                  S -= $.size;\n                  break;\n                case \"down\":\n                  T += $.size;\n                  break;\n                case \"up\":\n                  T -= $.size;\n              }\n              const E = {\n                x: S,\n                y: T,\n                direction: {\n                  from: $.direction,\n                  to: w.direction\n                },\n                radius: g\n              };\n              switch (f.push({\n                type: \"corner\",\n                data: E\n              }), w.direction) {\n                case \"right\":\n                  w.x += g, w.size -= g;\n                  break;\n                case \"left\":\n                  w.x -= g, w.size -= g;\n                  break;\n                case \"down\":\n                  w.y += g, w.size -= g;\n                  break;\n                case \"up\":\n                  w.y -= g, w.size -= g;\n              }\n            } else f.push({\n              type: \"line\",\n              data: $\n            });\n          }\n          const v = k[k.length - 1];\n          if (v.direction === \"right\" || v.direction === \"left\") {\n            v.size -= 3 * m / 4;\n            let x = v.direction === \"right\" ? v.x + v.size : v.x - v.size - m / 2,\n              $ = v.y - b.link_line_width / 2 - m / 2 + 1;\n            v.direction === \"left\" ? ($ -= 1, x -= 2) : x -= 1;\n            const w = {\n              x,\n              y: $,\n              size: m,\n              direction: v.direction\n            };\n            f.push({\n              type: \"line\",\n              data: v\n            }), f.push({\n              type: \"arrow\",\n              data: w\n            });\n          } else f.push({\n            type: \"line\",\n            data: v\n          });\n          return f;\n        }(e.get_lines(u, r).filter(k => k.size > 0), s),\n        _ = function (k, b, g, m) {\n          const f = document.createElement(\"div\");\n          return k.forEach(v => {\n            let x;\n            v.type === \"line\" ? x = e.render_line(v.data, null, b, g.source) : v.type === \"corner\" ? x = e.render_corner(v.data, b) : v.type === \"arrow\" && (x = e.render_arrow(v.data, m)), f.appendChild(x);\n          }), f;\n        }(h, r, a, s);\n      var p = \"gantt_task_link\";\n      a.color && (p += \" gantt_link_inline_color\");\n      var y = t.templates.link_class ? t.templates.link_class(a) : \"\";\n      return y && (p += \" \" + y), s.highlight_critical_path && t.isCriticalLink && t.isCriticalLink(a) && (p += \" gantt_critical_link\"), _.className = p, r.$config.link_attribute && (_.setAttribute(r.$config.link_attribute, a.id), _.setAttribute(\"link_id\", a.id)), a.color && _.style.setProperty(\"--dhx-gantt-link-background\", a.color), t._waiAria.linkAttr(a, _), _;\n    },\n    update: null,\n    isInViewPort: vn,\n    getVisibleRange: mn()\n  };\n}\nfunction Ma(t, e, n, i, a) {\n  if (a.$ui.getView(\"grid\") && (a.config.keyboard_navigation && a.getSelectedId() || a.ext.inlineEditors && a.ext.inlineEditors.getState().id)) return !!t.$expanded_branch;\n  var r = n.getItemTop(t.id),\n    s = n.getItemHeight(t.id);\n  return !(r > e.y_end || r + s < e.y);\n}\nfunction Na(t) {\n  let e = {};\n  return t.$data.tasksStore.attachEvent(\"onStoreUpdated\", function () {\n    e = {};\n  }), function (n, i, a, r) {\n    const s = n.id + \"_\" + i + \"_\" + a.unit + \"_\" + a.step;\n    let o;\n    return o = e[s] ? e[s] : e[s] = function (l, c, d, u) {\n      let h,\n        _ = !1,\n        p = {};\n      t.config.process_resource_assignments && c === t.config.resource_property ? (h = l.$role == \"task\" ? t.getResourceAssignments(l.$resource_id, l.$task_id) : t.getResourceAssignments(l.id), _ = !0) : h = l.$role == \"task\" ? [] : t.getTaskBy(c, l.id), p = function (w, S, T) {\n        const E = S.unit,\n          C = S.step,\n          D = {},\n          M = {};\n        for (let I = 0; I < w.length; I++) {\n          const A = w[I];\n          let N = A;\n          if (T && (N = t.getTask(A.task_id)), N.unscheduled) continue;\n          let L = A.start_date || N.start_date,\n            O = A.end_date || N.end_date;\n          T && (A.start_date && (L = new Date(Math.max(A.start_date.valueOf(), N.start_date.valueOf()))), A.end_date && (O = new Date(Math.min(A.end_date.valueOf(), N.end_date.valueOf()))), A.mode && A.mode == \"fixedDates\" && (L = A.start_date, O = A.end_date));\n          let G = At(S.trace_x, L.valueOf()),\n            j = new Date(S.trace_x[G] || t.date[E + \"_start\"](new Date(L))),\n            H = new Date(Math.min(L.valueOf(), j.valueOf())),\n            tt = t.config.work_time ? t.getTaskCalendar(N) : t;\n          for (M[tt.id] = {}; H < O;) {\n            const J = M[tt.id],\n              B = H.valueOf();\n            H = t.date.add(H, C, E), J[B] !== !1 && (D[B] || (D[B] = {\n              tasks: [],\n              assignments: []\n            }), D[B].tasks.push(N), T && D[B].assignments.push(A));\n          }\n        }\n        return D;\n      }(h, d, _);\n      const y = d.unit,\n        k = d.step,\n        b = [];\n      let g, m, f, v, x;\n      const $ = u.$getConfig();\n      for (let w = 0; w < d.trace_x.length; w++) g = new Date(d.trace_x[w]), m = t.date.add(g, k, y), x = p[g.valueOf()] || {}, f = x.tasks || [], v = x.assignments || [], f.length || $.resource_render_empty_cells ? b.push({\n        start_date: g,\n        end_date: m,\n        tasks: f,\n        assignments: v\n      }) : b.push(null);\n      return b;\n    }(n, i, a, r), o;\n  };\n}\nconst La = {\n    init: function (t, e) {\n      var n = t.$services.getService(\"dnd\");\n      if (e.$config.bind && t.getDatastore(e.$config.bind)) {\n        var i = new n(e.$grid_data, {\n          updates_per_second: 60\n        });\n        t.defined(e.$getConfig().dnd_sensitivity) && (i.config.sensitivity = e.$getConfig().dnd_sensitivity), i.attachEvent(\"onBeforeDragStart\", t.bind(function (o, l) {\n          var c = a(l);\n          if (!c || (t.hideQuickInfo && t.hideQuickInfo(), dt(l.target, \".gantt_grid_editor_placeholder\"))) return !1;\n          var d = c.getAttribute(e.$config.item_attribute);\n          if (s(d)) return !1;\n          var u = r().getItem(d);\n          return !t.isReadonly(u) && (i.config.initial_open_state = u.$open, !!t.callEvent(\"onRowDragStart\", [d, l.target || l.srcElement, l]) && void 0);\n        }, t)), i.attachEvent(\"onAfterDragStart\", t.bind(function (o, l) {\n          var c = a(l);\n          i.config.marker.innerHTML = c.outerHTML;\n          var d = i.config.marker.firstChild;\n          d && (d.style.position = \"static\"), i.config.id = c.getAttribute(e.$config.item_attribute);\n          var u = r(),\n            h = u.getItem(i.config.id);\n          i.config.index = u.getBranchIndex(i.config.id), i.config.parent = h.parent, h.$open = !1, h.$transparent = !0, this.refreshData();\n        }, t)), i.lastTaskOfLevel = function (o) {\n          for (var l = null, c = r().getItems(), d = 0, u = c.length; d < u; d++) c[d].$level == o && (l = c[d]);\n          return l ? l.id : null;\n        }, i._getGridPos = t.bind(function (o) {\n          var l = V(e.$grid_data),\n            c = l.x + e.$grid.scrollLeft,\n            d = o.pos.y - 10,\n            u = e.getItemHeight(i.config.id);\n          d < l.y && (d = l.y);\n          var h = e.getTotalHeight();\n          d > l.y + h - u && (d = l.y + h - u);\n          const _ = l.y + l.height;\n          return d > _ - u && (d = _ - u), l.x = c, l.y = d, l;\n        }, t), i._getTargetY = t.bind(function (o) {\n          var l = V(e.$grid_data),\n            c = e.$state.scrollTop || 0,\n            d = t.$grid_data.getBoundingClientRect().height + c,\n            u = o.pageY - l.y + c;\n          return u > d ? u = d : u < c && (u = c), u;\n        }, t), i._getTaskByY = t.bind(function (o, l) {\n          var c = r();\n          o = o || 0;\n          var d = e.getItemIndexByTopPosition(o);\n          return (d = l < d ? d - 1 : d) > c.countVisible() - 1 ? null : c.getIdByIndex(d);\n        }, t), i.attachEvent(\"onDragMove\", t.bind(function (o, l) {\n          var c = t.$grid_data.getBoundingClientRect(),\n            d = c.height + c.y + (e.$state.scrollTop || 0) + window.scrollY,\n            u = i.config,\n            h = i._getGridPos(l);\n          t._waiAria.reorderMarkerAttr(u.marker);\n          var _ = e.$getConfig(),\n            p = r();\n          h.y < d ? u.marker.style.top = h.y + \"px\" : u.marker.style.top = d + \"px\", u.marker.style.left = h.x + 10 + \"px\";\n          const y = V(t.$root);\n          h.width > y.width && (u.marker.style.width = y.width - 10 - 2 + \"px\", u.marker.style.overflow = \"hidden\");\n          var k = p.getItem(i.config.id),\n            b = i._getTargetY(l),\n            g = i._getTaskByY(b, p.getIndexById(k.id));\n          function m(D, M) {\n            return !p.isChildOf(f.id, M.id) && (D.$level == M.$level || _.order_branch_free);\n          }\n          if (p.exists(g) || (g = i.lastTaskOfLevel(_.order_branch_free ? k.$level : 0)) == i.config.id && (g = null), p.exists(g)) {\n            var f = p.getItem(g),\n              v = e.getItemTop(f.id),\n              x = e.getItemHeight(f.id);\n            if (v + x / 2 < b) {\n              var $ = p.getIndexById(f.id),\n                w = p.getNext(f.id),\n                S = p.getItem(w);\n              if (s(w)) {\n                var T = p.getPrev(S.id);\n                S = p.getItem(T);\n              }\n              if (S) {\n                if (S.id == k.id) return _.order_branch_free && p.isChildOf(k.id, f.id) && p.getChildren(f.id).length == 1 ? void p.move(k.id, p.getBranchIndex(f.id) + 1, p.getParent(f.id)) : void 0;\n                f = S;\n              } else if (w = p.getIdByIndex($), S = p.getItem(w), s(w) && (T = p.getPrev(S.id), S = p.getItem(T)), m(S, k) && S.id != k.id) return void p.move(k.id, -1, p.getParent(S.id));\n            } else if (_.order_branch_free && f.id != k.id && m(f, k) && !s(f.id)) {\n              if (!p.hasChild(f.id)) return f.$open = !0, void p.move(k.id, -1, f.id);\n              if (p.getIndexById(f.id) || x / 3 < b) return;\n            }\n            $ = p.getIndexById(f.id), T = p.getIdByIndex($ - 1);\n            for (var E = p.getItem(T), C = 1; (!E || E.id == f.id) && $ - C >= 0;) T = p.getIdByIndex($ - C), E = p.getItem(T), C++;\n            if (k.id == f.id || s(f.id)) return;\n            m(f, k) && k.id != f.id ? p.move(k.id, 0, 0, f.id) : f.$level != k.$level - 1 || p.getChildren(f.id).length ? E && m(E, k) && k.id != E.id && p.move(k.id, -1, p.getParent(E.id)) : p.move(k.id, 0, f.id);\n          }\n          return !0;\n        }, t)), i.attachEvent(\"onDragEnd\", t.bind(function () {\n          var o = r(),\n            l = o.getItem(i.config.id);\n          l.$transparent = !1, l.$open = i.config.initial_open_state, this.callEvent(\"onBeforeRowDragEnd\", [i.config.id, i.config.parent, i.config.index]) === !1 ? (o.move(i.config.id, i.config.index, i.config.parent), l.$drop_target = null) : this.callEvent(\"onRowDragEnd\", [i.config.id, l.$drop_target]), t.render(), this.refreshData();\n        }, t));\n      }\n      function a(o) {\n        return nt(o, e.$config.item_attribute);\n      }\n      function r() {\n        return t.getDatastore(e.$config.bind);\n      }\n      function s(o) {\n        return Rt(o, t, r());\n      }\n    }\n  },\n  K = {\n    createDropTargetObject: function (t) {\n      var e = {\n        targetParent: null,\n        targetIndex: 0,\n        targetId: null,\n        child: !1,\n        nextSibling: !1,\n        prevSibling: !1\n      };\n      return t && P(e, t, !0), e;\n    },\n    nextSiblingTarget: function (t, e, n) {\n      var i = this.createDropTargetObject();\n      return i.targetId = e, i.nextSibling = !0, i.targetParent = n.getParent(i.targetId), i.targetIndex = n.getBranchIndex(i.targetId), (n.getParent(t) != i.targetParent || i.targetIndex < n.getBranchIndex(t)) && (i.targetIndex += 1), i;\n    },\n    prevSiblingTarget: function (t, e, n) {\n      var i = this.createDropTargetObject();\n      return i.targetId = e, i.prevSibling = !0, i.targetParent = n.getParent(i.targetId), i.targetIndex = n.getBranchIndex(i.targetId), n.getParent(t) == i.targetParent && i.targetIndex > n.getBranchIndex(t) && (i.targetIndex -= 1), i;\n    },\n    firstChildTarget: function (t, e, n) {\n      var i = this.createDropTargetObject();\n      return i.targetId = e, i.targetParent = i.targetId, i.targetIndex = 0, i.child = !0, i;\n    },\n    lastChildTarget: function (t, e, n) {\n      var i = n.getChildren(e),\n        a = this.createDropTargetObject();\n      return a.targetId = i[i.length - 1], a.targetParent = e, a.targetIndex = i.length, a.nextSibling = !0, a;\n    }\n  };\nfunction xn(t, e, n, i, a) {\n  for (var r = e; i.exists(r);) {\n    var s = i.calculateItemLevel(i.getItem(r));\n    if ((s === n || s === n - 1) && i.getBranchIndex(r) > -1) break;\n    r = a ? i.getPrev(r) : i.getNext(r);\n  }\n  return i.exists(r) ? i.calculateItemLevel(i.getItem(r)) === n ? a ? K.nextSiblingTarget(t, r, i) : K.prevSiblingTarget(t, r, i) : K.firstChildTarget(t, r, i) : null;\n}\nfunction le(t, e, n, i) {\n  return xn(t, e, n, i, !0);\n}\nfunction Ge(t, e, n, i) {\n  return xn(t, e, n, i, !1);\n}\nfunction Ye(t, e, n, i, a, r) {\n  var s;\n  if (e !== a.$getRootId()) {\n    var o = a.getItem(e),\n      l = a.calculateItemLevel(o);\n    if (l === r) {\n      var c = a.getPrevSibling(e);\n      n < 0.5 && !c ? s = K.prevSiblingTarget(t, e, a) : (n < 0.5 && (e = c), s = K.nextSiblingTarget(t, e, a));\n    } else if (l > r) a.eachParent(function (p) {\n      a.calculateItemLevel(p) === r && (e = p.id);\n    }, o), s = le(t, e, r, a);else {\n      var d = le(t, e, r, a),\n        u = Ge(t, e, r, a);\n      s = n < 0.5 ? d : u;\n    }\n  } else {\n    var h = a.$getRootId(),\n      _ = a.getChildren(h);\n    s = K.createDropTargetObject(), s = _.length && i >= 0 ? le(t, function (p) {\n      for (var y = p.getNext(); p.exists(y);) {\n        var k = p.getNext(y);\n        if (!p.exists(k)) return y;\n        y = k;\n      }\n      return null;\n    }(a), r, a) : Ge(t, h, r, a);\n  }\n  return s;\n}\nfunction Je(t, e) {\n  var n = V(e.$grid_data);\n  return t.x += n.x + e.$grid.scrollLeft, t.y += n.y - e.$grid_data.scrollTop, t;\n}\nfunction de(t, e, n = 0) {\n  const i = V(t.$root);\n  return e > i.width && (e = i.width - n - 2), e;\n}\nconst Ke = {\n    removeLineHighlight: function (t) {\n      t.markerLine && t.markerLine.parentNode && t.markerLine.parentNode.removeChild(t.markerLine), t.markerLine = null;\n    },\n    highlightPosition: function (t, e, n) {\n      var i = function (r, s) {\n        var o = V(s.$grid_data),\n          l = rt(r, s.$grid_data),\n          c = o.x + s.$grid.scrollLeft,\n          d = l.y - 10,\n          u = s.getItemHeight(r.targetId);\n        d < o.y && (d = o.y);\n        var h = s.getTotalHeight();\n        return d > o.y + h - u && (d = o.y + h - u), o.x = c, o.y = d, o.width = de(s.$gantt, o.width, 9), o;\n      }(t, n);\n      e.marker.style.left = i.x + 9 + \"px\", e.marker.style.width = i.width + \"px\", e.marker.style.overflow = \"hidden\";\n      var a = e.markerLine;\n      a || ((a = document.createElement(\"div\")).className = \"gantt_drag_marker gantt_grid_dnd_marker\", a.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\", a.style.pointerEvents = \"none\"), t.child ? function (r, s, o) {\n        var l = r.targetParent,\n          c = Je({\n            x: 0,\n            y: o.getItemTop(l)\n          }, o),\n          d = o.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n        let u = de(o.$gantt, o.$grid_data.offsetWidth);\n        s.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\", s.style.width = u + \"px\", s.style.top = c.y + \"px\", s.style.left = c.x + \"px\", s.style.height = o.getItemHeight(l) + \"px\", c.y > d && (s.style.top = d + \"px\");\n      }(t, a, n) : function (r, s, o) {\n        var l = function (u, h) {\n            var _ = h.$config.rowStore,\n              p = {\n                x: 0,\n                y: 0\n              },\n              y = h.$grid_data.querySelector(\".gantt_tree_indent\"),\n              k = 15,\n              b = 0;\n            y && (k = y.offsetWidth);\n            var g = 40;\n            if (u.targetId !== _.$getRootId()) {\n              var m = h.getItemTop(u.targetId),\n                f = h.getItemHeight(u.targetId);\n              if (b = _.exists(u.targetId) ? _.calculateItemLevel(_.getItem(u.targetId)) : 0, u.prevSibling) p.y = m;else if (u.nextSibling) {\n                var v = 0;\n                _.eachItem(function (x) {\n                  _.getIndexById(x.id) !== -1 && v++;\n                }, u.targetId), p.y = m + f + v * f;\n              } else p.y = m + f, b += 1;\n            }\n            return p.x = g + b * k, p.width = de(h.$gantt, Math.max(h.$grid_data.offsetWidth - p.x, 0), p.x), Je(p, h);\n          }(r, o),\n          c = o.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n        s.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\", s.style.left = l.x + \"px\", s.style.height = \"4px\";\n        var d = l.y - 2;\n        s.style.top = d + \"px\", s.style.width = l.width + \"px\", d > c && (s.style.top = c + \"px\");\n      }(t, a, n), e.markerLine || (document.body.appendChild(a), e.markerLine = a);\n    }\n  },\n  Pa = {\n    init: function (t, e) {\n      var n = t.$services.getService(\"dnd\");\n      if (e.$config.bind && t.getDatastore(e.$config.bind)) {\n        var i = new n(e.$grid_data, {\n          updates_per_second: 60\n        });\n        t.defined(e.$getConfig().dnd_sensitivity) && (i.config.sensitivity = e.$getConfig().dnd_sensitivity), i.attachEvent(\"onBeforeDragStart\", t.bind(function (o, l) {\n          var c = a(l);\n          if (!c || (t.hideQuickInfo && t.hideQuickInfo(), dt(l.target, \".gantt_grid_editor_placeholder\"))) return !1;\n          var d = c.getAttribute(e.$config.item_attribute),\n            u = e.$config.rowStore.getItem(d);\n          return !t.isReadonly(u) && !r(d) && (i.config.initial_open_state = u.$open, !!t.callEvent(\"onRowDragStart\", [d, l.target || l.srcElement, l]) && void 0);\n        }, t)), i.attachEvent(\"onAfterDragStart\", t.bind(function (o, l) {\n          var c = a(l);\n          i.config.marker.innerHTML = c.outerHTML;\n          var d = i.config.marker.firstChild;\n          d && (i.config.marker.style.opacity = 0.4, d.style.position = \"static\", d.style.pointerEvents = \"none\"), i.config.id = c.getAttribute(e.$config.item_attribute);\n          var u = e.$config.rowStore,\n            h = u.getItem(i.config.id);\n          i.config.level = u.calculateItemLevel(h), i.config.drop_target = K.createDropTargetObject({\n            targetParent: u.getParent(h.id),\n            targetIndex: u.getBranchIndex(h.id),\n            targetId: h.id,\n            nextSibling: !0\n          }), h.$open = !1, h.$transparent = !0, this.refreshData();\n        }, t)), i.attachEvent(\"onDragMove\", t.bind(function (o, l) {\n          var c = s(l);\n          return c && t.callEvent(\"onBeforeRowDragMove\", [i.config.id, c.targetParent, c.targetIndex]) !== !1 || (c = K.createDropTargetObject(i.config.drop_target)), Ke.highlightPosition(c, i.config, e), i.config.drop_target = c, t._waiAria.reorderMarkerAttr(i.config.marker), this.callEvent(\"onRowDragMove\", [i.config.id, c.targetParent, c.targetIndex]), !0;\n        }, t)), i.attachEvent(\"onDragEnd\", t.bind(function () {\n          var o = e.$config.rowStore,\n            l = o.getItem(i.config.id);\n          Ke.removeLineHighlight(i.config), l.$transparent = !1, l.$open = i.config.initial_open_state;\n          var c = i.config.drop_target;\n          this.callEvent(\"onBeforeRowDragEnd\", [i.config.id, c.targetParent, c.targetIndex]) === !1 ? l.$drop_target = null : (o.move(i.config.id, c.targetIndex, c.targetParent), t.render(), this.callEvent(\"onRowDragEnd\", [i.config.id, c.targetParent, c.targetIndex])), o.refresh(l.id);\n        }, t));\n      }\n      function a(o) {\n        return nt(o, e.$config.item_attribute);\n      }\n      function r(o) {\n        return Rt(o, t, t.getDatastore(e.$config.bind));\n      }\n      function s(o) {\n        var l,\n          c = function (p) {\n            var y = rt(p, e.$grid_data).y,\n              k = e.$config.rowStore;\n            document.doctype || (y += window.scrollY), y = y || 0;\n            var b = e.$state.scrollTop || 0,\n              g = t.$grid_data.getBoundingClientRect().height + b + window.scrollY,\n              m = b,\n              f = e.getItemIndexByTopPosition(e.$state.scrollTop);\n            if (k.exists(f) || (f = k.countVisible() - 1), f < 0) return k.$getRootId();\n            var v = k.getIdByIndex(f),\n              x = e.$state.scrollTop / e.getItemHeight(v),\n              $ = x - Math.floor(x);\n            $ > 0.1 && $ < 0.9 && (g -= e.getItemHeight(v) * $, m += e.getItemHeight(v) * (1 - $));\n            const w = V(e.$grid_data),\n              S = w.y + w.height,\n              T = i.config.marker.offsetHeight;\n            y + T + window.scrollY >= g && (i.config.marker.style.top = S - T + \"px\"), y >= g ? y = g : y <= m && (y = m, i.config.marker.style.top = w.y + \"px\");\n            var E = e.getItemIndexByTopPosition(y);\n            if (E > k.countVisible() - 1 || E < 0) return k.$getRootId();\n            var C = k.getIdByIndex(E);\n            return r(C) ? k.getPrevSibling(C) : k.getIdByIndex(E);\n          }(o),\n          d = null,\n          u = e.$config.rowStore,\n          h = !e.$getConfig().order_branch_free,\n          _ = rt(o, e.$grid_data).y;\n        return document.doctype || (_ += window.scrollY), c !== u.$getRootId() && (d = (_ - e.getItemTop(c)) / e.getItemHeight(c)), h ? (l = Ye(i.config.id, c, d, _, u, i.config.level)) && l.targetParent && r(l.targetParent) && (c = u.getPrevSibling(l.targetParent), l = Ye(i.config.id, c, d, _, u, i.config.level)) : l = function (p, y, k, b, g) {\n          var m;\n          if (y !== g.$getRootId()) m = k < 0.25 ? K.prevSiblingTarget(p, y, g) : !(k > 0.6) || g.hasChild(y) && g.getItem(y).$open ? K.firstChildTarget(p, y, g) : K.nextSiblingTarget(p, y, g);else {\n            var f = g.$getRootId();\n            m = g.hasChild(f) && b >= 0 ? K.lastChildTarget(p, f, g) : K.firstChildTarget(p, f, g);\n          }\n          return m;\n        }(i.config.id, c, d, _, u), l;\n      }\n    }\n  };\nvar Ra = function (t) {\n  return {\n    onCreated: function (e) {\n      e.$config = P(e.$config, {\n        bind: \"task\"\n      }), e.$config.id == \"grid\" && (this.extendGantt(e), t.ext.inlineEditors = t.ext._inlineEditors.createEditors(e), t.ext.inlineEditors.init()), this._mouseDelegates = Te(t);\n    },\n    onInitialized: function (e) {\n      var n = e.$getConfig();\n      n.order_branch && (n.order_branch == \"marker\" ? Pa.init(e.$gantt, e) : La.init(e.$gantt, e)), this.initEvents(e, t), e.$config.id == \"grid\" && this.extendDom(e);\n    },\n    onDestroyed: function (e) {\n      e.$config.id == \"grid\" && t.ext.inlineEditors.detachStore(), this.clearEvents(e, t);\n    },\n    initEvents: function (e, n) {\n      this._mouseDelegates.delegate(\"click\", \"gantt_row\", n.bind(function (i, a, r) {\n        const s = e.$getConfig();\n        if (a !== null) {\n          const o = this.getTask(a);\n          if (s.scroll_on_click) {\n            const l = !n._is_icon_open_click(i),\n              c = n.$ui.getView(\"timeline\");\n            l && c && this.showDate(o.start_date);\n          }\n          n.callEvent(\"onTaskRowClick\", [a, r]);\n        }\n      }, n), e.$grid), this._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", n.bind(function (i, a, r) {\n        var s = r.getAttribute(\"data-column-id\");\n        if (n.callEvent(\"onGridHeaderClick\", [s, i])) {\n          var o = e.$getConfig();\n          if (s != \"add\") {\n            if (o.sort && s) {\n              for (var l, c = s, d = 0; d < o.columns.length; d++) if (o.columns[d].name == s) {\n                l = o.columns[d];\n                break;\n              }\n              if (l && l.sort !== void 0 && l.sort !== !0 && !(c = l.sort)) return;\n              var u = this._sort && this._sort.direction && this._sort.name == s ? this._sort.direction : \"desc\";\n              u = u == \"desc\" ? \"asc\" : \"desc\", this._sort = {\n                name: s,\n                direction: u\n              }, this.sort(c, u == \"desc\");\n            }\n          } else n.$services.getService(\"mouseEvents\").callHandler(\"click\", \"gantt_add\", e.$grid, [i, o.root_id]);\n        }\n      }, n), e.$grid), this._mouseDelegates.delegate(\"click\", \"gantt_add\", n.bind(function (i, a, r) {\n        if (!e.$getConfig().readonly) return this.createTask({}, a || n.config.root_id), !1;\n      }, n), e.$grid);\n    },\n    clearEvents: function (e, n) {\n      this._mouseDelegates.destructor(), this._mouseDelegates = null;\n    },\n    extendDom: function (e) {\n      t.$grid = e.$grid, t.$grid_scale = e.$grid_scale, t.$grid_data = e.$grid_data;\n    },\n    extendGantt: function (e) {\n      t.getGridColumns = t.bind(e.getGridColumns, e), e.attachEvent(\"onColumnResizeStart\", function () {\n        return t.callEvent(\"onColumnResizeStart\", arguments);\n      }), e.attachEvent(\"onColumnResize\", function () {\n        return t.callEvent(\"onColumnResize\", arguments);\n      }), e.attachEvent(\"onColumnResizeEnd\", function () {\n        return t.callEvent(\"onColumnResizeEnd\", arguments);\n      }), e.attachEvent(\"onColumnResizeComplete\", function (n, i) {\n        t.config.grid_width = i;\n      }), e.attachEvent(\"onBeforeRowResize\", function () {\n        return t.callEvent(\"onBeforeRowResize\", arguments);\n      }), e.attachEvent(\"onRowResize\", function () {\n        return t.callEvent(\"onRowResize\", arguments);\n      }), e.attachEvent(\"onBeforeRowResizeEnd\", function () {\n        return t.callEvent(\"onBeforeRowResizeEnd\", arguments);\n      }), e.attachEvent(\"onAfterRowResize\", function () {\n        return t.callEvent(\"onAfterRowResize\", arguments);\n      });\n    }\n  };\n};\nconst Ha = {\n  createTaskDND: function () {\n    var t;\n    return {\n      extend: function (e) {\n        e.roundTaskDates = function (n) {\n          t.round_task_dates(n);\n        };\n      },\n      init: function (e, n) {\n        return t = function (i, a) {\n          var r = a.$services;\n          return {\n            drag: null,\n            dragMultiple: {},\n            _events: {\n              before_start: {},\n              before_finish: {},\n              after_finish: {}\n            },\n            _handlers: {},\n            init: function () {\n              this._domEvents = a._createDomEventScope(), this.clear_drag_state();\n              var s = a.config.drag_mode;\n              this.set_actions(), r.getService(\"state\").registerProvider(\"tasksDnd\", R(function () {\n                return {\n                  drag_id: this.drag ? this.drag.id : void 0,\n                  drag_mode: this.drag ? this.drag.mode : void 0,\n                  drag_from_start: this.drag ? this.drag.left : void 0\n                };\n              }, this));\n              var o = {\n                before_start: \"onBeforeTaskDrag\",\n                before_finish: \"onBeforeTaskChanged\",\n                after_finish: \"onAfterTaskDrag\"\n              };\n              for (var l in this._events) for (var c in s) this._events[l][c] = o[l];\n              this._handlers[s.move] = this._move, this._handlers[s.resize] = this._resize, this._handlers[s.progress] = this._resize_progress;\n            },\n            set_actions: function () {\n              var s = i.$task_data;\n              this._domEvents.attach(s, \"mousemove\", a.bind(function (o) {\n                this.on_mouse_move(o);\n              }, this)), this._domEvents.attach(s, \"mousedown\", a.bind(function (o) {\n                this.on_mouse_down(o);\n              }, this)), this._domEvents.attach(document.body, \"mouseup\", a.bind(function (o) {\n                this.on_mouse_up(o);\n              }, this));\n            },\n            clear_drag_state: function () {\n              this.drag = {\n                id: null,\n                mode: null,\n                pos: null,\n                start_x: null,\n                start_y: null,\n                obj: null,\n                left: null\n              }, this.dragMultiple = {};\n            },\n            _resize: function (s, o, l) {\n              var c = i.$getConfig(),\n                d = this._drag_task_coords(s, l);\n              l.left ? (s.start_date = a.dateFromPos(d.start + o), s.start_date || (s.start_date = new Date(a.getState().min_date))) : (s.end_date = a.dateFromPos(d.end + o), s.end_date || (s.end_date = new Date(a.getState().max_date)));\n              var u = this._calculateMinDuration(c.min_duration, c.duration_unit);\n              s.end_date - s.start_date < c.min_duration && (l.left ? s.start_date = a.calculateEndDate(s.end_date, -u, c.duration_unit, s) : s.end_date = a.calculateEndDate(s.start_date, u, c.duration_unit, s)), a._init_task_timing(s);\n            },\n            _calculateMinDuration: function (s, o) {\n              return Math.ceil(s / {\n                minute: 6e4,\n                hour: 36e5,\n                day: 864e5,\n                week: 6048e5,\n                month: 24192e5,\n                year: 31356e6\n              }[o]);\n            },\n            _resize_progress: function (s, o, l) {\n              var c = this._drag_task_coords(s, l),\n                d = i.$getConfig().rtl ? c.start - l.pos.x : l.pos.x - c.start,\n                u = Math.max(0, d);\n              s.progress = Math.min(1, u / Math.abs(c.end - c.start));\n            },\n            _find_max_shift: function (s, o) {\n              var l;\n              for (var c in s) {\n                var d = s[c],\n                  u = a.getTask(d.id);\n                if (!u.unscheduled) {\n                  var h = this._drag_task_coords(u, d),\n                    _ = a.posFromDate(new Date(a.getState().min_date)),\n                    p = a.posFromDate(new Date(a.getState().max_date));\n                  if (h.end + o > p) {\n                    var y = p - h.end;\n                    (y < l || l === void 0) && (l = y);\n                  } else if (h.start + o < _) {\n                    var k = _ - h.start;\n                    (k > l || l === void 0) && (l = k);\n                  }\n                }\n              }\n              return l;\n            },\n            _move: function (s, o, l, c) {\n              var d = this._drag_task_coords(s, l),\n                u = null,\n                h = null;\n              c ? (u = new Date(+l.obj.start_date + c), h = new Date(+l.obj.end_date + c)) : (u = a.dateFromPos(d.start + o), h = a.dateFromPos(d.end + o)), u ? h ? (s.start_date = u, s.end_date = h) : (s.end_date = new Date(a.getState().max_date), s.start_date = a.dateFromPos(a.posFromDate(s.end_date) - (d.end - d.start))) : (s.start_date = new Date(a.getState().min_date), s.end_date = a.dateFromPos(a.posFromDate(s.start_date) + (d.end - d.start)));\n            },\n            _drag_task_coords: function (s, o) {\n              return {\n                start: o.obj_s_x = o.obj_s_x || a.posFromDate(s.start_date),\n                end: o.obj_e_x = o.obj_e_x || a.posFromDate(s.end_date)\n              };\n            },\n            _mouse_position_change: function (s, o) {\n              var l = s.x - o.x,\n                c = s.y - o.y;\n              return Math.sqrt(l * l + c * c);\n            },\n            _is_number: function (s) {\n              return !isNaN(parseFloat(s)) && isFinite(s);\n            },\n            on_mouse_move: function (s) {\n              if (this.drag.start_drag) {\n                var o = rt(s, a.$task_data),\n                  l = this.drag.start_drag.start_x,\n                  c = this.drag.start_drag.start_y;\n                (Date.now() - this.drag.timestamp > 50 || this._is_number(l) && this._is_number(c) && this._mouse_position_change({\n                  x: l,\n                  y: c\n                }, o) > 20) && this._start_dnd(s);\n              }\n              if (this.drag.mode) {\n                if (!dn(this, 40)) return;\n                this._update_on_move(s);\n              }\n            },\n            _update_item_on_move: function (s, o, l, c, d, u) {\n              var h = a.getTask(o),\n                _ = a.mixin({}, h),\n                p = a.mixin({}, h);\n              this._handlers[l].apply(this, [p, s, c, u]), a.mixin(h, p, !0), a.callEvent(\"onTaskDrag\", [h.id, l, p, _, d]), a.mixin(h, p, !0), a.refreshTask(o);\n            },\n            _update_on_move: function (s) {\n              var o = this.drag,\n                l = i.$getConfig();\n              if (o.mode) {\n                var c = rt(s, i.$task_data);\n                if (o.pos && o.pos.x == c.x) return;\n                o.pos = c;\n                var d = a.dateFromPos(c.x);\n                if (!d || isNaN(d.getTime())) return;\n                var u = c.x - o.start_x,\n                  h = a.getTask(o.id);\n                if (this._handlers[o.mode]) {\n                  if (o.mode === l.drag_mode.move) {\n                    var _ = {};\n                    this._isMultiselect() && a.getSelectedTasks().indexOf(o.id) >= 0 && (_ = this.dragMultiple);\n                    var p = !1;\n                    if (a.isSummaryTask(h) && a.config.drag_project) {\n                      var y = {};\n                      y[o.id] = q(o), p = !0, _ = P(y, this.dragMultiple);\n                    }\n                    var k = this._find_max_shift(_, u);\n                    let m;\n                    if (k !== void 0 && (u = k), this._update_item_on_move(u, o.id, o.mode, o, s), k === void 0) {\n                      const f = a.posFromDate(o.obj.start_date),\n                        v = a.posFromDate(o.obj.end_date);\n                      if (o.handle_offset === void 0) {\n                        const $ = v - f,\n                          w = o.start_x - f;\n                        o.handle_offset = w / $;\n                      }\n                      let x = f + Math.abs(v - f) * o.handle_offset;\n                      m = d - a.dateFromPos(x);\n                    }\n                    for (var b in _) {\n                      var g = _[b];\n                      p && g.id != o.id && (a._bulk_dnd = !0), this._update_item_on_move(u, g.id, g.mode, g, s, m);\n                    }\n                    a._bulk_dnd = !1;\n                  } else this._update_item_on_move(u, o.id, o.mode, o, s);\n                  a._update_parents(o.id);\n                }\n              }\n            },\n            on_mouse_down: function (s, o) {\n              if (s.button != 2 || s.button === void 0) {\n                var l = i.$getConfig(),\n                  c = a.locate(s),\n                  d = null;\n                if (a.isTaskExists(c) && (d = a.getTask(c)), !a.isReadonly(d) && !this.drag.mode) {\n                  this.clear_drag_state();\n                  var u = X(o = o || s.target || s.srcElement),\n                    h = this._get_drag_mode(u, o);\n                  if (!u || !h) return o.parentNode ? this.on_mouse_down(s, o.parentNode) : void 0;\n                  if (h) {\n                    if (h.mode && h.mode != l.drag_mode.ignore && l[\"drag_\" + h.mode]) {\n                      if (c = a.locate(o), d = a.copy(a.getTask(c) || {}), a.isReadonly(d)) return this.clear_drag_state(), !1;\n                      if (a.isSummaryTask(d) && d.auto_scheduling !== !1 && !l.drag_project && h.mode != l.drag_mode.progress) return void this.clear_drag_state();\n                      h.id = c;\n                      var _ = rt(s, a.$task_data);\n                      h.start_x = _.x, h.start_y = _.y, h.obj = d, this.drag.start_drag = h, this.drag.timestamp = Date.now();\n                    } else this.clear_drag_state();\n                  } else if (a.checkEvent(\"onMouseDown\") && a.callEvent(\"onMouseDown\", [u.split(\" \")[0]]) && o.parentNode) return this.on_mouse_down(s, o.parentNode);\n                }\n              }\n            },\n            _fix_dnd_scale_time: function (s, o) {\n              var l = i.$getConfig(),\n                c = a.getScale().unit,\n                d = a.getScale().step;\n              function u(h) {\n                if (a.config.correct_work_time) {\n                  var _ = i.$getConfig();\n                  a.isWorkTime(h.start_date, void 0, h) || (h.start_date = a.calculateEndDate({\n                    start_date: h.start_date,\n                    duration: -1,\n                    unit: _.duration_unit,\n                    task: h\n                  }));\n                }\n              }\n              l.round_dnd_dates || (c = \"minute\", d = l.time_step), o.mode == l.drag_mode.resize ? o.left ? (s.start_date = a.roundDate({\n                date: s.start_date,\n                unit: c,\n                step: d\n              }), u(s)) : (s.end_date = a.roundDate({\n                date: s.end_date,\n                unit: c,\n                step: d\n              }), function (h) {\n                if (a.config.correct_work_time) {\n                  var _ = i.$getConfig();\n                  a.isWorkTime(new Date(h.end_date - 1), void 0, h) || (h.end_date = a.calculateEndDate({\n                    start_date: h.end_date,\n                    duration: 1,\n                    unit: _.duration_unit,\n                    task: h\n                  }));\n                }\n              }(s)) : o.mode == l.drag_mode.move && (s.start_date = a.roundDate({\n                date: s.start_date,\n                unit: c,\n                step: d\n              }), u(s), s.end_date = a.calculateEndDate(s));\n            },\n            _fix_working_times: function (s, o) {\n              var l = i.$getConfig();\n              (o = o || {\n                mode: l.drag_mode.move\n              }).mode == l.drag_mode.resize ? o.left ? s.start_date = a.getClosestWorkTime({\n                date: s.start_date,\n                dir: \"future\",\n                task: s\n              }) : s.end_date = a.getClosestWorkTime({\n                date: s.end_date,\n                dir: \"past\",\n                task: s\n              }) : o.mode == l.drag_mode.move && a.correctTaskWorkTime(s);\n            },\n            _finalize_mouse_up: function (s, o, l, c) {\n              var d = a.getTask(s);\n              if (o.work_time && o.correct_work_time && this._fix_working_times(d, l), this._fix_dnd_scale_time(d, l), this._fireEvent(\"before_finish\", l.mode, [s, l.mode, a.copy(l.obj), c])) {\n                var u = s;\n                a._init_task_timing(d), this.clear_drag_state(), a.updateTask(d.id), this._fireEvent(\"after_finish\", l.mode, [u, l.mode, c]);\n              } else if (this.clear_drag_state(), s == l.id && (l.obj._dhx_changed = !1, a.mixin(d, l.obj, !0)), a.refreshTask(d.id), d.$level > 100) {\n                let h = !1;\n                a.eachParent(function (_) {\n                  if (!h && _.type === a.config.types.project) {\n                    const p = {\n                      start_date: _.start_date,\n                      end_date: _.end_date\n                    };\n                    a.resetProjectDates(_), +p.start_date == +_.start_date && +p.end_date == +_.end_date || (h = !0);\n                  }\n                }, d.id), h && a.refreshData();\n              } else a.eachParent(function (h) {\n                if (h.type === a.config.types.project) {\n                  const _ = {\n                    start_date: h.start_date,\n                    end_date: h.end_date\n                  };\n                  a.resetProjectDates(h), +_.start_date == +h.start_date && +_.end_date == +h.end_date || a.refreshTask(h.id);\n                }\n              }, d.id);\n            },\n            on_mouse_up: function (s) {\n              var o = this.drag;\n              if (o.mode && o.id) {\n                var l = i.$getConfig(),\n                  c = a.getTask(o.id),\n                  d = this.dragMultiple,\n                  u = !1,\n                  h = 0;\n                o.mode === l.drag_mode.move && (a.isSummaryTask(c) && l.drag_project || this._isMultiselect()) && (u = !0, h = Object.keys(d).length);\n                var _ = function () {\n                  if (u) for (var p in d) d[p].id != o.id && this._finalize_mouse_up(d[p].id, l, d[p], s);\n                  this._finalize_mouse_up(o.id, l, o, s);\n                };\n                u && h > 10 ? a.batchUpdate(function () {\n                  _.call(this);\n                }.bind(this)) : _.call(this);\n              }\n              this.clear_drag_state();\n            },\n            _get_drag_mode: function (s, o) {\n              var l = i.$getConfig().drag_mode,\n                c = {\n                  mode: null,\n                  left: null\n                };\n              switch ((s || \"\").split(\" \")[0]) {\n                case \"gantt_task_line\":\n                case \"gantt_task_content\":\n                  c.mode = l.move;\n                  break;\n                case \"gantt_task_drag\":\n                  c.mode = l.resize;\n                  var d = o.getAttribute(\"data-bind-property\");\n                  c.left = d == \"start_date\";\n                  break;\n                case \"gantt_task_progress_drag\":\n                  c.mode = l.progress;\n                  break;\n                case \"gantt_link_control\":\n                case \"gantt_link_point\":\n                  c.mode = l.ignore;\n                  break;\n                default:\n                  c = null;\n              }\n              return c;\n            },\n            _start_dnd: function (s) {\n              var o = this.drag = this.drag.start_drag;\n              delete o.start_drag;\n              var l = i.$getConfig(),\n                c = o.id;\n              if (l[\"drag_\" + o.mode] && a.callEvent(\"onBeforeDrag\", [c, o.mode, s]) && this._fireEvent(\"before_start\", o.mode, [c, o.mode, s])) {\n                delete o.start_drag;\n                var d = a.getTask(c);\n                if (a.isReadonly(d)) return void this.clear_drag_state();\n                if (this._isMultiselect()) {\n                  var u = a.getSelectedTasks();\n                  u.indexOf(o.id) >= 0 && kt(u, a.bind(function (h) {\n                    var _ = a.getTask(h);\n                    a.isSummaryTask(_) && a.config.drag_project && o.mode == l.drag_mode.move && this._addSubtasksToDragMultiple(_.id), this.dragMultiple[h] = a.mixin({\n                      id: _.id,\n                      obj: a.copy(_)\n                    }, this.drag);\n                  }, this));\n                }\n                a.isSummaryTask(d) && a.config.drag_project && o.mode == l.drag_mode.move && this._addSubtasksToDragMultiple(d.id), a.callEvent(\"onTaskDragStart\", []);\n              } else this.clear_drag_state();\n            },\n            _fireEvent: function (s, o, l) {\n              a.assert(this._events[s], \"Invalid stage:{\" + s + \"}\");\n              var c = this._events[s][o];\n              return a.assert(c, \"Unknown after drop mode:{\" + o + \"}\"), a.assert(l, \"Invalid event arguments\"), !a.checkEvent(c) || a.callEvent(c, l);\n            },\n            round_task_dates: function (s) {\n              var o = this.drag,\n                l = i.$getConfig();\n              o || (o = {\n                mode: l.drag_mode.move\n              }), this._fix_dnd_scale_time(s, o);\n            },\n            destructor: function () {\n              this._domEvents.detachAll();\n            },\n            _isMultiselect: function () {\n              return a.config.drag_multiple && !!(a.getSelectedTasks && a.getSelectedTasks().length > 0);\n            },\n            _addSubtasksToDragMultiple: function (s) {\n              a.eachTask(function (o) {\n                this.dragMultiple[o.id] = a.mixin({\n                  id: o.id,\n                  obj: a.copy(o)\n                }, this.drag);\n              }, s, this);\n            }\n          };\n        }(e, n), e._tasks_dnd = t, t.init(n);\n      },\n      destructor: function () {\n        t && (t.destructor(), t = null);\n      }\n    };\n  }\n};\nvar Oa = function (t, e) {\n  var n, i, a, r, s;\n  function o() {\n    return {\n      link_source_id: r,\n      link_target_id: i,\n      link_from_start: s,\n      link_to_start: a,\n      link_landing_area: n\n    };\n  }\n  var l = e.$services,\n    c = l.getService(\"state\"),\n    d = l.getService(\"dnd\");\n  c.registerProvider(\"linksDnD\", o);\n  var u = \"gantt_link_point\",\n    h = \"gantt_link_control\",\n    _ = new d(t.$task_bars, {\n      sensitivity: 0,\n      updates_per_second: 60,\n      mousemoveContainer: e.$root,\n      selector: \".\" + u,\n      preventDefault: !0\n    });\n  function p(m, f) {\n    var v,\n      x = _.getPosition(m),\n      $ = function (M) {\n        var I = 0,\n          A = 0;\n        return M && (I = M.offsetWidth || 0, A = M.offsetHeight || 0), {\n          width: I,\n          height: A\n        };\n      }(f),\n      w = {\n        right: (v = e.$root).offsetWidth,\n        bottom: v.offsetHeight\n      },\n      S = e.config.tooltip_offset_x || 10,\n      T = e.config.tooltip_offset_y || 10,\n      E = e.config.scroll_size || 18,\n      C = e.$container.getBoundingClientRect().y + window.scrollY,\n      D = {\n        y: x.y + T,\n        x: x.x + S,\n        bottom: x.y + $.height + T + E,\n        right: x.x + $.width + S + E\n      };\n    return D.bottom > w.bottom + C && (D.y = w.bottom + C - $.height - T), D.right > w.right && (D.x = w.right - $.width - S), D;\n  }\n  function y(m) {\n    var f = o();\n    f.link_source_id && f.link_target_id && e.isLinkAllowed(f.link_source_id, f.link_target_id, f.link_from_start, f.link_to_start);\n    var v = \"<div class='\" + e.templates.drag_link_class(f.link_source_id, f.link_from_start, f.link_target_id, f.link_to_start) + \"'>\" + e.templates.drag_link(f.link_source_id, f.link_from_start, f.link_target_id, f.link_to_start) + \"</div>\";\n    m.innerHTML = v;\n  }\n  function k() {\n    r = s = i = null, a = !0;\n  }\n  function b(m, f, v, x) {\n    var $ = function () {\n        return _._direction && _._direction.parentNode || (_._direction = document.createElement(\"div\"), t.$task_links.appendChild(_._direction)), _._direction;\n      }(),\n      w = o(),\n      S = [\"gantt_link_direction\"];\n    e.templates.link_direction_class && S.push(e.templates.link_direction_class(w.link_source_id, w.link_from_start, w.link_target_id, w.link_to_start));\n    var T = Math.sqrt(Math.pow(v - m, 2) + Math.pow(x - f, 2));\n    if (T = Math.max(0, T - 3)) {\n      $.className = S.join(\" \");\n      var E = (x - f) / (v - m),\n        C = Math.atan(E);\n      g(m, v, f, x) == 2 ? C += Math.PI : g(m, v, f, x) == 3 && (C -= Math.PI);\n      var D = Math.sin(C),\n        M = Math.cos(C),\n        I = Math.round(f),\n        A = Math.round(m),\n        N = [\"-webkit-transform: rotate(\" + C + \"rad)\", \"-moz-transform: rotate(\" + C + \"rad)\", \"-ms-transform: rotate(\" + C + \"rad)\", \"-o-transform: rotate(\" + C + \"rad)\", \"transform: rotate(\" + C + \"rad)\", \"width:\" + Math.round(T) + \"px\"];\n      if (window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1) {\n        N.push('-ms-filter: \"' + function (G, j) {\n          return \"progid:DXImageTransform.Microsoft.Matrix(M11 = \" + j + \",M12 = -\" + G + \",M21 = \" + G + \",M22 = \" + j + \",SizingMethod = 'auto expand')\";\n        }(D, M) + '\"');\n        var L = Math.abs(Math.round(m - v)),\n          O = Math.abs(Math.round(x - f));\n        switch (g(m, v, f, x)) {\n          case 1:\n            I -= O;\n            break;\n          case 2:\n            A -= L, I -= O;\n            break;\n          case 3:\n            A -= L;\n        }\n      }\n      N.push(\"top:\" + I + \"px\"), N.push(\"left:\" + A + \"px\"), $.style.cssText = N.join(\";\");\n    }\n  }\n  function g(m, f, v, x) {\n    return f >= m ? x <= v ? 1 : 4 : x <= v ? 2 : 3;\n  }\n  _.attachEvent(\"onBeforeDragStart\", e.bind(function (m, f) {\n    var v = f.target || f.srcElement;\n    if (k(), e.getState(\"tasksDnd\").drag_id) return !1;\n    if (pt(v, u)) {\n      pt(v, \"task_start_date\") && (s = !0);\n      var x = e.locate(f);\n      r = x;\n      var $ = e.getTask(x);\n      return e.isReadonly($) ? (k(), !1) : (this._dir_start = {\n        x: _.config.original_element_sizes.x + _.config.original_element_sizes.width / 2,\n        y: _.config.original_element_sizes.y + _.config.original_element_sizes.height / 2\n      }, !0);\n    }\n    return !1;\n  }, this)), _.attachEvent(\"onAfterDragStart\", e.bind(function (m, f) {\n    e.config.touch && e.refreshData(), y(_.config.marker);\n  }, this)), _.attachEvent(\"onDragMove\", e.bind(function (m, f) {\n    var v = _.config,\n      x = p(f, v.marker);\n    (function (M, I) {\n      M.style.left = I.x + \"px\", M.style.top = I.y + \"px\";\n    })(v.marker, x);\n    var $ = !!pt(f, h),\n      w = i,\n      S = n,\n      T = a,\n      E = e.locate(f),\n      C = !0;\n    if (Y(yt(f), e.$root) || ($ = !1, E = null), $ && (C = !pt(f, \"task_end_date\"), $ = !!E), i = E, n = $, a = C, $) {\n      const M = pt(f, h).querySelector(`.${u}`);\n      if (M) {\n        const I = en(M, t.$task_bg);\n        this._dir_end = {\n          x: I.x + M.offsetWidth / 2,\n          y: I.y + M.offsetHeight / 2\n        };\n      }\n    } else this._dir_end = rt(f, t.$task_data), e.env.isEdge && (this._dir_end.y += window.scrollY);\n    var D = !(S == $ && w == E && T == C);\n    return D && (w && e.refreshTask(w, !1), E && e.refreshTask(E, !1)), D && y(v.marker), b(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y), !0;\n  }, this)), _.attachEvent(\"onDragEnd\", e.bind(function () {\n    var m = o();\n    if (m.link_source_id && m.link_target_id && m.link_source_id != m.link_target_id) {\n      var f = e._get_link_type(m.link_from_start, m.link_to_start),\n        v = {\n          source: m.link_source_id,\n          target: m.link_target_id,\n          type: f\n        };\n      v.type && e.isLinkAllowed(v) && e.callEvent(\"onLinkCreated\", [v]) && e.addLink(v);\n    }\n    k(), e.config.touch ? e.refreshData() : (m.link_source_id && e.refreshTask(m.link_source_id, !1), m.link_target_id && e.refreshTask(m.link_target_id, !1)), _._direction && (_._direction.parentNode && _._direction.parentNode.removeChild(_._direction), _._direction = null);\n  }, this)), e.attachEvent(\"onGanttRender\", e.bind(function () {\n    _._direction && b(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n  }, this));\n};\nconst Ba = function () {\n  return {\n    init: Oa\n  };\n};\nvar za = function (t) {\n    var e = t.$services;\n    return {\n      onCreated: function (n) {\n        var i = n.$config;\n        i.bind = W(i.bind) ? i.bind : \"task\", i.bindLinks = W(i.bindLinks) ? i.bindLinks : \"link\", n._linksDnD = Ba(), n._tasksDnD = Ha.createTaskDND(), n._tasksDnD.extend(n), this._mouseDelegates = Te(t);\n      },\n      onInitialized: function (n) {\n        this._attachDomEvents(t), this._attachStateProvider(t, n), n._tasksDnD.init(n, t), n._linksDnD.init(n, t), n.$config.id == \"timeline\" && this.extendDom(n);\n      },\n      onDestroyed: function (n) {\n        this._clearDomEvents(t), this._clearStateProvider(t), n._tasksDnD && n._tasksDnD.destructor();\n      },\n      extendDom: function (n) {\n        t.$task = n.$task, t.$task_scale = n.$task_scale, t.$task_data = n.$task_data, t.$task_bg = n.$task_bg, t.$task_links = n.$task_links, t.$task_bars = n.$task_bars;\n      },\n      _clearDomEvents: function () {\n        this._mouseDelegates.destructor(), this._mouseDelegates = null;\n      },\n      _attachDomEvents: function (n) {\n        function i(a, r) {\n          if (a && this.callEvent(\"onLinkDblClick\", [a, r])) {\n            var s = this.getLink(a);\n            if (this.isReadonly(s)) return;\n            var o = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(a)) + \" \" + this.locale.labels.confirm_link_deleting;\n            window.setTimeout(function () {\n              n._delete_link_confirm({\n                link: s,\n                message: o,\n                title: \"\",\n                callback: function () {\n                  n.deleteLink(a);\n                }\n              });\n            }, this.config.touch ? 300 : 1);\n          }\n        }\n        this._mouseDelegates.delegate(\"click\", \"gantt_task_link\", n.bind(function (a, r) {\n          var s = this.locate(a, this.config.link_attribute);\n          s && this.callEvent(\"onLinkClick\", [s, a]);\n        }, n), this.$task), this._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", n.bind(function (a, r) {\n          var s = rt(a, n.$task_data),\n            o = n.dateFromPos(s.x),\n            l = Math.floor(n.columnIndexByDate(o)),\n            c = n.getScale().trace_x[l];\n          n.callEvent(\"onScaleClick\", [a, c]);\n        }, n), this.$task), this._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", n.bind(function (a, r, s) {\n          r = this.locate(a, n.config.link_attribute), i.call(this, r, a);\n        }, n), this.$task), this._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", n.bind(function (a, r, s) {\n          r = this.locate(a);\n          var o = this.getTask(r),\n            l = null;\n          return s.parentNode && X(s.parentNode) && (l = X(s.parentNode).indexOf(\"_left\") > -1 ? o.$target[0] : o.$source[0]), l && i.call(this, l, a), !1;\n        }, n), this.$task);\n      },\n      _attachStateProvider: function (n, i) {\n        var a = i;\n        e.getService(\"state\").registerProvider(\"tasksTimeline\", function () {\n          return {\n            scale_unit: a._tasks ? a._tasks.unit : void 0,\n            scale_step: a._tasks ? a._tasks.step : void 0\n          };\n        });\n      },\n      _clearStateProvider: function () {\n        e.getService(\"state\").unregisterProvider(\"tasksTimeline\");\n      }\n    };\n  },\n  Wa = function (t) {\n    return {\n      getVerticalScrollbar: function () {\n        return t.$ui.getView(\"scrollVer\");\n      },\n      getHorizontalScrollbar: function () {\n        return t.$ui.getView(\"scrollHor\");\n      },\n      _legacyGridResizerClass: function (e) {\n        for (var n = e.getCellsByType(\"resizer\"), i = 0; i < n.length; i++) {\n          var a = n[i],\n            r = !1,\n            s = a.$parent.getPrevSibling(a.$id);\n          if (s && s.$config && s.$config.id === \"grid\") r = !0;else {\n            var o = a.$parent.getNextSibling(a.$id);\n            o && o.$config && o.$config.id === \"grid\" && (r = !0);\n          }\n          r && (a.$config.css = (a.$config.css ? a.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\");\n        }\n      },\n      onCreated: function (e) {\n        var n = !0;\n        this._legacyGridResizerClass(e), e.attachEvent(\"onBeforeResize\", function () {\n          var i = t.$ui.getView(\"timeline\");\n          i && (i.$config.hidden = i.$parent.$config.hidden = !t.config.show_chart);\n          var a = t.$ui.getView(\"grid\");\n          if (a) {\n            var r = a._getColsTotalWidth(),\n              s = !t.config.show_grid || !t.config.grid_width || r === 0;\n            if (n && !s && r !== !1 && (t.config.grid_width = r), a.$config.hidden = a.$parent.$config.hidden = s, !a.$config.hidden) {\n              var o = a._getGridWidthLimits();\n              if (o[0] && t.config.grid_width < o[0] && (t.config.grid_width = o[0]), o[1] && t.config.grid_width > o[1] && (t.config.grid_width = o[1]), i && t.config.show_chart) {\n                if (a.$config.width = t.config.grid_width - 1, !a.$config.scrollable && a.$config.scrollY && t.$root.offsetWidth) {\n                  var l = a.$gantt.$layout.$container.offsetWidth,\n                    c = t.$ui.getView(a.$config.scrollY).$config.width,\n                    d = l - (a.$config.width + c) - 4;\n                  d < 0 && (a.$config.width += d, t.config.grid_width += d);\n                }\n                if (n) a.$parent.$config.width = t.config.grid_width, a.$parent.$config.group && t.$layout._syncCellSizes(a.$parent.$config.group, {\n                  value: a.$parent.$config.width,\n                  isGravity: !1\n                });else if (i && !Y(i.$task, e.$view)) {\n                  if (!a.$config.original_grid_width) {\n                    var u = t.skins[t.skin];\n                    u && u.config && u.config.grid_width ? a.$config.original_grid_width = u.config.grid_width : a.$config.original_grid_width = 0;\n                  }\n                  t.config.grid_width = a.$config.original_grid_width, a.$parent.$config.width = t.config.grid_width;\n                } else a.$parent._setContentSize(a.$config.width, null), t.$layout._syncCellSizes(a.$parent.$config.group, {\n                  value: t.config.grid_width,\n                  isGravity: !1\n                });\n              } else i && Y(i.$task, e.$view) && (a.$config.original_grid_width = t.config.grid_width), n || (a.$parent.$config.width = 0);\n            }\n            n = !1;\n          }\n        }), this._initScrollStateEvents(e);\n      },\n      _initScrollStateEvents: function (e) {\n        t._getVerticalScrollbar = this.getVerticalScrollbar, t._getHorizontalScrollbar = this.getHorizontalScrollbar;\n        var n = this.getVerticalScrollbar(),\n          i = this.getHorizontalScrollbar();\n        n && n.attachEvent(\"onScroll\", function (a, r, s) {\n          var o = t.getScrollState();\n          t.callEvent(\"onGanttScroll\", [o.x, a, o.x, r]);\n        }), i && i.attachEvent(\"onScroll\", function (a, r, s) {\n          var o = t.getScrollState();\n          t.callEvent(\"onGanttScroll\", [a, o.y, r, o.y]);\n          var l = t.$ui.getView(\"grid\");\n          l && l.$grid_data && !l.$config.scrollable && (l.$grid_data.style.left = l.$grid.scrollLeft + \"px\", l.$grid_data.scrollLeft = l.$grid.scrollLeft);\n        }), e.attachEvent(\"onResize\", function () {\n          n && !t.$scroll_ver && (t.$scroll_ver = n.$scroll_ver), i && !t.$scroll_hor && (t.$scroll_hor = i.$scroll_hor);\n        });\n      },\n      _findGridResizer: function (e, n) {\n        for (var i, a = e.getCellsByType(\"resizer\"), r = !0, s = 0; s < a.length; s++) {\n          var o = a[s];\n          o._getSiblings();\n          var l = o._behind,\n            c = o._front;\n          if (l && l.$content === n || l.isChild && l.isChild(n)) {\n            i = o, r = !0;\n            break;\n          }\n          if (c && c.$content === n || c.isChild && c.isChild(n)) {\n            i = o, r = !1;\n            break;\n          }\n        }\n        return {\n          resizer: i,\n          gridFirst: r\n        };\n      },\n      onInitialized: function (e) {\n        var n = t.$ui.getView(\"grid\"),\n          i = this._findGridResizer(e, n);\n        if (i.resizer) {\n          var a,\n            r = i.gridFirst,\n            s = i.resizer;\n          if (s.$config.mode !== \"x\") return;\n          s.attachEvent(\"onResizeStart\", function (o, l) {\n            var c = t.$ui.getView(\"grid\"),\n              d = c ? c.$parent : null;\n            if (d) {\n              var u = c._getGridWidthLimits();\n              c.$config.scrollable || (d.$config.minWidth = u[0]), d.$config.maxWidth = u[1];\n            }\n            return a = r ? o : l, t.callEvent(\"onGridResizeStart\", [a]);\n          }), s.attachEvent(\"onResize\", function (o, l) {\n            var c = r ? o : l;\n            return t.callEvent(\"onGridResize\", [a, c]);\n          }), s.attachEvent(\"onResizeEnd\", function (o, l, c, d) {\n            var u = r ? o : l,\n              h = r ? c : d,\n              _ = t.$ui.getView(\"grid\"),\n              p = _ ? _.$parent : null;\n            p && (p.$config.minWidth = void 0);\n            var y = t.callEvent(\"onGridResizeEnd\", [u, h]);\n            return y && h !== 0 && (t.config.grid_width = h), y;\n          });\n        }\n      },\n      onDestroyed: function (e) {}\n    };\n  };\nconst ja = {\n  init: function (t) {\n    function e(r, s) {\n      var o = s(t);\n      o.onCreated && o.onCreated(r), r.attachEvent(\"onReady\", function () {\n        o.onInitialized && o.onInitialized(r);\n      }), r.attachEvent(\"onDestroy\", function () {\n        o.onDestroyed && o.onDestroyed(r);\n      });\n    }\n    var n = la(t);\n    n.registerView(\"cell\", Ht), n.registerView(\"resizer\", null), n.registerView(\"scrollbar\", fa), n.registerView(\"layout\", kn, function (r) {\n      (r.$config ? r.$config.id : null) === \"main\" && e(r, Wa);\n    }), n.registerView(\"viewcell\", ga), n.registerView(\"multiview\", _a), n.registerView(\"timeline\", Ut, function (r) {\n      (r.$config ? r.$config.id : null) !== \"timeline\" && r.$config.bind != \"task\" || e(r, za);\n    }), n.registerView(\"grid\", xe, function (r) {\n      (r.$config ? r.$config.id : null) !== \"grid\" && r.$config.bind != \"task\" || e(r, Ra);\n    }), n.registerView(\"resourceGrid\", xe), n.registerView(\"resourceTimeline\", Ut), n.registerView(\"resourceHistogram\", Ut);\n    var i = function (r) {\n        var s = ua(r);\n        return {\n          getDataRender: function (o) {\n            return r.$services.getService(\"layer:\" + o) || null;\n          },\n          createDataRender: function (o) {\n            var l = o.name,\n              c = o.defaultContainer,\n              d = o.defaultContainerSibling,\n              u = s.createGroup(c, d, function (h, _) {\n                if (!u.filters) return !0;\n                for (var p = 0; p < u.filters.length; p++) if (u.filters[p](h, _) === !1) return !1;\n              }, ha);\n            return r.$services.setService(\"layer:\" + l, function () {\n              return u;\n            }), r.attachEvent(\"onGanttReady\", function () {\n              u.addLayer();\n            }), u;\n          },\n          init: function () {\n            var o = this.createDataRender({\n                name: \"task\",\n                defaultContainer: function () {\n                  return r.$task_data ? r.$task_data : r.$ui.getView(\"timeline\") ? r.$ui.getView(\"timeline\").$task_data : void 0;\n                },\n                defaultContainerSibling: function () {\n                  return r.$task_links ? r.$task_links : r.$ui.getView(\"timeline\") ? r.$ui.getView(\"timeline\").$task_links : void 0;\n                },\n                filter: function (c) {}\n              }, r),\n              l = this.createDataRender({\n                name: \"link\",\n                defaultContainer: function () {\n                  return r.$task_data ? r.$task_data : r.$ui.getView(\"timeline\") ? r.$ui.getView(\"timeline\").$task_data : void 0;\n                }\n              }, r);\n            return {\n              addTaskLayer: function (c) {\n                const d = ft;\n                return typeof c == \"function\" ? c = {\n                  renderer: {\n                    render: c,\n                    getVisibleRange: d\n                  }\n                } : c.renderer && !c.renderer.getVisibleRange && (c.renderer.getVisibleRange = d), c.view = \"timeline\", o.addLayer(c);\n              },\n              _getTaskLayers: function () {\n                return o.getLayers();\n              },\n              removeTaskLayer: function (c) {\n                o.removeLayer(c);\n              },\n              _clearTaskLayers: function () {\n                o.clear();\n              },\n              addLinkLayer: function (c) {\n                const d = mn();\n                return typeof c == \"function\" ? c = {\n                  renderer: {\n                    render: c,\n                    getVisibleRange: d\n                  }\n                } : c.renderer && !c.renderer.getVisibleRange && (c.renderer.getVisibleRange = d), c.view = \"timeline\", c && c.renderer && (c.renderer.getRectangle || c.renderer.isInViewPort || (c.renderer.isInViewPort = vn)), l.addLayer(c);\n              },\n              _getLinkLayers: function () {\n                return l.getLayers();\n              },\n              removeLinkLayer: function (c) {\n                l.removeLayer(c);\n              },\n              _clearLinkLayers: function () {\n                l.clear();\n              }\n            };\n          }\n        };\n      }(t),\n      a = Da(t);\n    return t.ext.inlineEditors = a, t.ext._inlineEditors = a, a.init(t), {\n      factory: n,\n      mouseEvents: ca.init(t),\n      layersApi: i.init(),\n      render: {\n        gridLine: function () {\n          return /* @__PURE__ */function (r) {\n            return {\n              render: function (s, o, l, c) {\n                for (var d = o.getGridColumns(), u = o.$getTemplates(), h = o.$config.rowStore, _ = [], p = 0; p < d.length; p++) {\n                  var y,\n                    k,\n                    b,\n                    g = p == d.length - 1,\n                    m = d[p];\n                  m.name == \"add\" ? (k = \"<div \" + (S = r._waiAria.gridAddButtonAttrString(m)) + \" class='gantt_add'></div>\", b = \"\") : (Q(k = m.template ? m.template(s) : s[m.name]) && (k = u.date_grid(k, s, m.name)), k == null && (k = \"\"), b = k, k = \"<div class='gantt_tree_content'>\" + k + \"</div>\");\n                  var f = \"gantt_cell\" + (g ? \" gantt_last_cell\" : \"\"),\n                    v = [];\n                  if (m.tree) {\n                    f += \" gantt_cell_tree\";\n                    for (var x = 0; x < s.$level; x++) v.push(u.grid_indent(s));\n                    !h.hasChild(s.id) || r.isSplitTask(s) && !r.config.open_split_tasks ? (v.push(u.grid_blank(s)), v.push(u.grid_file(s))) : (v.push(u.grid_open(s)), v.push(u.grid_folder(s)));\n                  }\n                  var $ = \"width:\" + (m.width - (g ? 1 : 0)) + \"px;\";\n                  if (this.defined(m.align)) {\n                    var w = {\n                      right: \"flex-end\",\n                      left: \"flex-start\",\n                      center: \"center\"\n                    }[m.align];\n                    $ += \"text-align:\" + m.align + \";justify-content:\" + w + \";\";\n                  }\n                  var S = r._waiAria.gridCellAttrString(m, b, s);\n                  v.push(k), y = \"<div class='\" + f + \"' data-column-index='\" + p + \"' data-column-name='\" + m.name + \"' style='\" + $ + \"' \" + S + \">\" + v.join(\"\") + \"</div>\", _.push(y);\n                }\n                switch (f = \"\", h.$config.name) {\n                  case \"task\":\n                    f = r.getGlobalTaskIndex(s.id) % 2 == 0 ? \"\" : \" odd\";\n                    break;\n                  case \"resource\":\n                    f = h.visibleOrder.indexOf(s.id) % 2 == 0 ? \"\" : \" odd\";\n                }\n                if (f += s.$transparent ? \" gantt_transparent\" : \"\", f += s.$dataprocessor_class ? \" \" + s.$dataprocessor_class : \"\", u.grid_row_class) {\n                  var T = u.grid_row_class.call(r, s.start_date, s.end_date, s);\n                  T && (f += \" \" + T);\n                }\n                h.isSelected(s.id) && (f += \" gantt_selected\");\n                var E = document.createElement(\"div\");\n                E.className = \"gantt_row\" + f + \" gantt_row_\" + r.getTaskType(s.type);\n                var C = o.getItemHeight(s.id);\n                return E.style.height = C + \"px\", E.style.lineHeight = C + \"px\", l.smart_rendering && (E.style.position = \"absolute\", E.style.left = \"0px\", E.style.top = o.getItemTop(s.id) + \"px\"), o.$config.item_attribute && (E.setAttribute(o.$config.item_attribute, s.id), E.setAttribute(o.$config.bind + \"_id\", s.id)), r._waiAria.taskRowAttr(s, E), E.innerHTML = _.join(\"\"), E;\n              },\n              update: null,\n              getRectangle: Kt,\n              isInViewPort: Ma,\n              getVisibleRange: ft,\n              onrender: function (s, o, l) {\n                for (var c = l.getGridColumns(), d = 0; d < c.length; d++) {\n                  var u = c[d];\n                  if (u.onrender) {\n                    var h = o.querySelector(`[data-column-name=\"${u.name}\"]`);\n                    if (h) {\n                      var _ = u.onrender(s, h);\n                      if (_ && typeof _ == \"string\") h.innerHTML = _;else if (_ && typeof _ == \"object\" && r.config.external_render) {\n                        var p = r.config.external_render;\n                        p.isElement(_) && p.renderElement(_, h);\n                      }\n                    }\n                  }\n                }\n              }\n            };\n          }(t);\n        },\n        taskBg: function () {\n          return /* @__PURE__ */function (r) {\n            var s = {},\n              o = {};\n            function l(_, p) {\n              return !(!s[_.id][p] || !s[_.id][p].parentNode);\n            }\n            function c(_, p) {\n              s[_] && s[_][p] && s[_][p].parentNode && s[_][p].parentNode.removeChild(s[_][p]);\n            }\n            function d(_) {\n              var p,\n                y = _.$getTemplates();\n              return y.task_cell_class !== void 0 ? (p = y.task_cell_class, (console.warn || console.log)(\"gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.\")) : p = y.timeline_cell_class, p;\n            }\n            function u(_) {\n              return _.$getTemplates().timeline_cell_content;\n            }\n            function h(_, p, y, k, b, g, m, f) {\n              var v = _.width[p],\n                x = \"\";\n              if (oe(p, _, k, r)) {\n                var $ = g(y, _.trace_x[p]),\n                  w = \"\";\n                if (m && (w = m(y, _.trace_x[p])), f.static_background) {\n                  var S = !(!$ && !w);\n                  if (!f.static_background_cells || !S) return null;\n                }\n                if (s[y.id][p]) return o[y.id][p] = p, s[y.id][p];\n                var T = document.createElement(\"div\");\n                return T.style.width = v + \"px\", x = \"gantt_task_cell\" + (p == b - 1 ? \" gantt_last_cell\" : \"\"), $ && (x += \" \" + $), T.className = x, w && (T.innerHTML = w), T.style.position = \"absolute\", T.style.left = _.left[p] + \"px\", s[y.id][p] = T, o[y.id][p] = p, T;\n              }\n              return null;\n            }\n            return {\n              render: function (_, p, y, k) {\n                var b = p.$getTemplates(),\n                  g = p.getScale(),\n                  m = g.count;\n                if (y.static_background && !y.static_background_cells) return null;\n                var f,\n                  v = document.createElement(\"div\"),\n                  x = d(p),\n                  $ = u(p);\n                if (f = k && y.smart_rendering && !Nt(r) ? jt(g, k.x) : {\n                  start: 0,\n                  end: m - 1\n                }, y.show_task_cells) {\n                  s[_.id] = {}, o[_.id] = {};\n                  for (var w = f.start; w <= f.end; w++) {\n                    var S = h(g, w, _, k, m, x, $, y);\n                    S && v.appendChild(S);\n                  }\n                }\n                const T = p.$config.rowStore,\n                  E = T.getIndexById(_.id) % 2 != 0;\n                var C = b.task_row_class(_.start_date, _.end_date, _),\n                  D = \"gantt_task_row\" + (E ? \" odd\" : \"\") + (C ? \" \" + C : \"\");\n                if (T.isSelected(_.id) && (D += \" gantt_selected\"), v.className = D, y.smart_rendering ? (v.style.position = \"absolute\", v.style.top = p.getItemTop(_.id) + \"px\", v.style.width = \"100%\") : v.style.position = \"relative\", v.style.height = p.getItemHeight(_.id) + \"px\", _.id == \"timeline_placeholder_task\") {\n                  var M = 0;\n                  _.lastTaskId && (M = p.getItemTop(_.lastTaskId) + p.getItemHeight(_.lastTaskId));\n                  var I = (_.row_height || p.$task_data.offsetHeight) - M;\n                  I < 0 && (I = 0), y.smart_rendering && (v.style.top = M + \"px\"), v.style.height = I + \"px\";\n                }\n                return p.$config.item_attribute && (v.setAttribute(p.$config.item_attribute, _.id), v.setAttribute(p.$config.bind + \"_id\", _.id)), v;\n              },\n              update: function (_, p, y, k, b) {\n                var g = y.getScale(),\n                  m = g.count,\n                  f = d(y),\n                  v = u(y);\n                if (k.show_task_cells) {\n                  s[_.id] || (s[_.id] = {}), o[_.id] || (o[_.id] = {});\n                  var x = jt(g, b);\n                  for (var $ in o[_.id]) {\n                    var w = o[_.id][$];\n                    (Number(w) < x.start || Number(w) > x.end) && c(_.id, w);\n                  }\n                  o[_.id] = {};\n                  for (var S = x.start; S <= x.end; S++) {\n                    var T = h(g, S, _, b, m, f, v, k);\n                    !T && l(_, S) ? c(_.id, S) : T && !T.parentNode && p.appendChild(T);\n                  }\n                }\n              },\n              getRectangle: qe,\n              getVisibleRange: ft,\n              prepareData: Aa\n            };\n          }(t);\n        },\n        taskBar: function () {\n          return Ue(t);\n        },\n        timedProjectBar: function () {\n          return Ue(t);\n        },\n        taskRollupBar: function () {\n          return function (r) {\n            const s = bn(r),\n              o = {};\n            function l(u, h, _, p, y) {\n              let k = !0;\n              return p.smart_rendering && (k = $e(u, h, _)), k;\n            }\n            function c(u, h, _, p) {\n              const y = r.copy(r.getTask(h.id));\n              if (y.$rendered_at = u.id, r.callEvent(\"onBeforeRollupTaskDisplay\", [y.id, y, u.id]) === !1) return;\n              const k = s(y, _);\n              if (!k) return;\n              const b = _.getBarHeight(u.id, h.type == r.config.types.milestone),\n                g = Math.floor((_.getItemHeight(u.id) - b) / 2);\n              return k.style.top = p.top + g + \"px\", k.classList.add(\"gantt_rollup_child\"), k.setAttribute(\"data-rollup-parent-id\", u.id), k;\n            }\n            function d(u, h) {\n              return u + \"_\" + h;\n            }\n            return {\n              render: function (u, h, _, p) {\n                if (u.rollup !== !1 && u.$rollup && u.$rollup.length) {\n                  const y = document.createElement(\"div\"),\n                    k = r.getTaskPosition(u);\n                  return p && (p.y = 0, p.y_end = r.$task_bg.scrollHeight), u.$rollup.forEach(function (b) {\n                    if (!r.isTaskExists(b)) return;\n                    const g = r.getTask(b);\n                    if (!l(g, p, h, _)) return;\n                    const m = c(u, g, h, k);\n                    m ? (o[d(g.id, u.id)] = m, y.appendChild(m)) : o[d(g.id, u.id)] = !1;\n                  }), y;\n                }\n                return !1;\n              },\n              update: function (u, h, _, p, y) {\n                const k = document.createElement(\"div\"),\n                  b = r.getTaskPosition(u);\n                y.y = 0, y.y_end = r.$task_bg.scrollHeight, u.$rollup.forEach(function (g) {\n                  const m = r.getTask(g),\n                    f = d(m.id, u.id);\n                  let v = l(m, y, _, p);\n                  if (v !== !!o[f]) if (v) {\n                    const x = c(u, m, _, b);\n                    o[f] = x || !1;\n                  } else o[f] = !1;\n                  o[f] && k.appendChild(o[f]), h.innerHTML = \"\", h.appendChild(k);\n                });\n              },\n              isInViewPort: $e,\n              getVisibleRange: ft\n            };\n          }(t);\n        },\n        taskSplitBar: function () {\n          return Ct();\n        },\n        taskConstraints: function () {\n          return Ct();\n        },\n        taskDeadline: function () {\n          return Ct();\n        },\n        taskBaselines: function () {\n          return Ct();\n        },\n        link: function () {\n          return Ia(t);\n        },\n        resourceRow: function () {\n          return function (r) {\n            var s = Na(r),\n              o = {};\n            function l(d, u, h, _, p) {\n              var y = h.resource_cell_class(u.start_date, u.end_date, d, u.tasks, u.assignments),\n                k = h.resource_cell_value(u.start_date, u.end_date, d, u.tasks, u.assignments),\n                b = p.getItemHeight(d.id) - 1;\n              if (y || k) {\n                var g = p.getItemPosition(d, u.start_date, u.end_date),\n                  m = document.createElement(\"div\");\n                return m.setAttribute(p.$config.item_attribute, d.id), m.className = [\"gantt_resource_marker\", y].join(\" \"), m.style.cssText = [\"left:\" + g.left + \"px\", \"width:\" + g.width + \"px\", \"height:\" + b + \"px\", \"line-height:\" + b + \"px\", \"top:\" + g.top + \"px\"].join(\";\"), k && (m.innerHTML = k), m;\n              }\n              return null;\n            }\n            function c(d, u) {\n              o[d] && o[d][u] && o[d][u].parentNode && o[d][u].parentNode.removeChild(o[d][u]);\n            }\n            return {\n              render: function (d, u, h, _) {\n                var p = u.$getTemplates(),\n                  y = u.getScale(),\n                  k = s(d, h.resource_property, u.getScale(), u),\n                  b = !!_,\n                  g = [];\n                o[d.id] = {};\n                for (var m = jt(y, _), f = m.start; f <= m.end; f++) {\n                  var v = k[f];\n                  if (v && (!b || oe(f, y, _, r))) {\n                    var x = l(d, v, p, 0, u);\n                    x && (g.push(x), o[d.id][f] = x);\n                  }\n                }\n                var $ = null;\n                if (g.length) {\n                  $ = document.createElement(\"div\");\n                  for (var w = 0; w < g.length; w++) $.appendChild(g[w]);\n                }\n                return $;\n              },\n              update: function (d, u, h, _, p) {\n                var y = h.$getTemplates(),\n                  k = h.getScale(),\n                  b = s(d, _.resource_property, h.getScale(), h),\n                  g = jt(k, p),\n                  m = {};\n                if (o && o[d.id]) for (var f in o[d.id]) m[f] = f;\n                for (var v = g.start; v <= g.end; v++) {\n                  var x = b[v];\n                  if (m[v] = !1, x) if (oe(v, k, p, r)) {\n                    if (o[d.id] && o[d.id][v]) o[d.id] && o[d.id][v] && !o[d.id][v].parentNode && u.appendChild(o[d.id][v]);else {\n                      var $ = l(d, x, y, 0, h);\n                      $ && (u.appendChild($), o[d.id][v] = $);\n                    }\n                  } else c(d.id, v);\n                }\n                for (var f in m) m[f] !== !1 && c(d.id, f);\n              },\n              getRectangle: qe,\n              getVisibleRange: ft\n            };\n          }(t);\n        },\n        resourceHistogram: function () {\n          return Ct();\n        },\n        gridTaskRowResizer: function () {\n          return /* @__PURE__ */function (r) {\n            return {\n              render: function (s, o, l) {\n                var c = o.$getConfig(),\n                  d = document.createElement(\"div\");\n                return d.className = \"gantt_task_grid_row_resize_wrap\", d.style.top = o.getItemTop(s.id) + o.getItemHeight(s.id) + \"px\", d.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\", d.setAttribute(c.task_grid_row_resizer_attribute, s.id), r._waiAria.rowResizerAttr(d), d;\n              },\n              update: null,\n              getRectangle: Kt,\n              getVisibleRange: ft\n            };\n          }(t);\n        }\n      },\n      layersService: {\n        getDataRender: function (r) {\n          return i.getDataRender(r, t);\n        },\n        createDataRender: function (r) {\n          return i.createDataRender(r, t);\n        }\n      }\n    };\n  }\n};\nfunction ce(t, e) {\n  const n = getComputedStyle(e.$root).getPropertyValue(\"--dhx-gantt-theme\");\n  let i,\n    a = !!n;\n  if (a) i = n;else {\n    var r = e.skin;\n    if (i = r, !r || t) for (var s = document.getElementsByTagName(\"link\"), o = 0; o < s.length; o++) {\n      var l = s[o].href.match(\"dhtmlxgantt_([a-z_]+).css\");\n      if (l && (e.skins[l[1]] || !r)) {\n        i = l[1];\n        break;\n      }\n    }\n  }\n  e._theme_info = {\n    theme: i,\n    cssVarTheme: a\n  }, e.skin = i || \"terrace\";\n  var c = e.skins[e.skin] || e.skins.terrace;\n  (function (h, _, p) {\n    for (var y in _) (h[y] === void 0 || p) && (h[y] = _[y]);\n  })(e.config, c.config, t), a || (e.config.link_radius = 1);\n  var d = e.getGridColumns();\n  for (d[1] && !e.defined(d[1].width) && (d[1].width = c._second_column_width), d[2] && !e.defined(d[2].width) && (d[2].width = c._third_column_width), o = 0; o < d.length; o++) {\n    var u = d[o];\n    u.name == \"add\" && (u.width || (u.width = 44), e.defined(u.min_width) && e.defined(u.max_width) || (u.min_width = u.min_width || u.width, u.max_width = u.max_width || u.width), u.min_width && (u.min_width = +u.min_width), u.max_width && (u.max_width = +u.max_width), u.width && (u.width = +u.width, u.width = u.min_width && u.min_width > u.width ? u.min_width : u.width, u.width = u.max_width && u.max_width < u.width ? u.max_width : u.width));\n  }\n  c.config.task_height && (e.config.task_height = c.config.task_height || \"full\"), c.config.bar_height && (e.config.bar_height = c.config.bar_height || \"full\"), c._lightbox_template && (e._lightbox_template = c._lightbox_template), c._redefine_lightbox_buttons && (e.config.buttons_right = c._redefine_lightbox_buttons.buttons_right, e.config.buttons_left = c._redefine_lightbox_buttons.buttons_left), e.resetLightbox();\n}\nfunction Fa(t) {\n  var e = null,\n    n = !1,\n    i = null,\n    a = {\n      started: !1\n    },\n    r = {};\n  function s(_) {\n    return _ && Y(_, t.$root) && _.offsetHeight;\n  }\n  function o() {\n    var _ = !!document.querySelector(\".gantt_drag_marker\"),\n      p = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\") || !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\"),\n      y = !!document.querySelector(\".gantt_link_direction\"),\n      k = t.getState(),\n      b = k.autoscroll;\n    return n = _ && !p && !y, !(!k.drag_mode && !_ || p) || b;\n  }\n  function l(_) {\n    if (i && (clearTimeout(i), i = null), _) {\n      var p = t.config.autoscroll_speed;\n      p && p < 10 && (p = 10), i = setTimeout(function () {\n        e = setInterval(u, p || 50);\n      }, t.config.autoscroll_delay || 10);\n    }\n  }\n  function c(_) {\n    _ ? (l(!0), a.started || (a.x = r.x, a.y = r.y, a.started = !0)) : (e && (clearInterval(e), e = null), l(!1), a.started = !1);\n  }\n  function d(_) {\n    var p = o();\n    if (!e && !i || p || c(!1), !t.config.autoscroll || !p) return !1;\n    r = {\n      x: _.clientX,\n      y: _.clientY\n    }, _.type == \"touchmove\" && (r.x = _.targetTouches[0].clientX, r.y = _.targetTouches[0].clientY), !e && p && c(!0);\n  }\n  function u() {\n    if (!o()) return c(!1), !1;\n    var _ = s(t.$task) ? t.$task : s(t.$grid) ? t.$grid : t.$root;\n    if (_) {\n      var p = !1;\n      [\".gantt_drag_marker.gantt_grid_resize_area\", \".gantt_drag_marker .gantt_row.gantt_row_task\", \".gantt_drag_marker.gantt_grid_dnd_marker\"].forEach(function (C) {\n        p = p || !!document.querySelector(C);\n      }), p && (_ = t.$grid);\n      var y = V(_),\n        k = r.x - y.x,\n        b = r.y - y.y + window.scrollY,\n        g = n ? 0 : h(k, y.width, a.x - y.x),\n        m = h(b, y.height, a.y - y.y + window.scrollY),\n        f = t.getScrollState(),\n        v = f.y,\n        x = f.inner_height,\n        $ = f.height,\n        w = f.x,\n        S = f.inner_width,\n        T = f.width;\n      (m && !x || m < 0 && !v || m > 0 && v + x >= $ + 2) && (m = 0), (g && !S || g < 0 && !w || g > 0 && w + S >= T) && (g = 0);\n      var E = t.config.autoscroll_step;\n      E && E < 2 && (E = 2), m *= E || 30, ((g *= E || 30) || m) && function (C, D) {\n        var M = t.getScrollState(),\n          I = null,\n          A = null;\n        C && (I = M.x + C, I = Math.min(M.width, I), I = Math.max(0, I)), D && (A = M.y + D, A = Math.min(M.height, A), A = Math.max(0, A)), t.scrollTo(I, A);\n      }(g, m);\n    }\n  }\n  function h(_, p, y) {\n    return _ - 50 < 0 && _ < y ? -1 : _ > p - 50 && _ > y ? 1 : 0;\n  }\n  t.attachEvent(\"onGanttReady\", function () {\n    if (!F(t)) {\n      var _ = vt(t.$root) || document.body;\n      t.eventRemove(_, \"mousemove\", d), t.event(_, \"mousemove\", d), t.eventRemove(_, \"touchmove\", d), t.event(_, \"touchmove\", d), t.eventRemove(_, \"pointermove\", d), t.event(_, \"pointermove\", d);\n    }\n  }), t.attachEvent(\"onDestroy\", function () {\n    c(!1);\n  });\n}\nvar ue, he;\ntypeof window < \"u\" && window.jQuery && (ue = window.jQuery, he = [], ue.fn.dhx_gantt = function (t) {\n  if (typeof (t = t || {}) != \"string\") {\n    var e = [];\n    return this.each(function () {\n      if (this && this.getAttribute) if (this.gantt || window.gantt.$root == this) e.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);else {\n        var n = window.gantt.$container && window.Gantt ? window.Gantt.getGanttInstance() : window.gantt;\n        for (var i in t) i != \"data\" && (n.config[i] = t[i]);\n        n.init(this), t.data && n.parse(t.data), e.push(n);\n      }\n    }), e.length === 1 ? e[0] : e;\n  }\n  if (he[t]) return he[t].apply(this, []);\n  ue.error(\"Method \" + t + \" does not exist on jQuery.dhx_gantt\");\n});\ntypeof window < \"u\" && window.dhtmlx && (window.dhtmlx.attaches || (window.dhtmlx.attaches = {}), window.dhtmlx.attaches.attachGantt = function (t, e, n) {\n  var i = document.createElement(\"DIV\");\n  n = n || window.gantt, i.id = \"gantt_\" + n.uid(), i.style.width = \"100%\", i.style.height = \"100%\", i.cmp = \"grid\", document.body.appendChild(i), this.attachObject(i.id), this.dataType = \"gantt\", this.dataObj = n;\n  var a = this.vs[this.av];\n  return a.grid = n, n.init(i.id, t, e), i.firstChild.style.border = \"none\", a.gridId = i.id, a.gridObj = i, this.vs[this._viewRestore()].grid;\n}), typeof window < \"u\" && window.dhtmlXCellObject !== void 0 && (window.dhtmlXCellObject.prototype.attachGantt = function (t, e, n) {\n  n = n || window.gantt;\n  var i = document.createElement(\"DIV\");\n  return i.id = \"gantt_\" + n.uid(), i.style.width = \"100%\", i.style.height = \"100%\", i.cmp = \"grid\", document.body.appendChild(i), this.attachObject(i.id), this.dataType = \"gantt\", this.dataObj = n, n.init(i.id, t, e), i.firstChild.style.border = \"none\", i = null, this.callEvent(\"_onContentAttach\", []), this.dataObj;\n});\nconst Va = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"],\n  Ua = [[{\n    unit: \"month\",\n    date: \"%M\",\n    step: 1\n  }, {\n    unit: \"day\",\n    date: \"%d\",\n    step: 1\n  }], [{\n    unit: \"day\",\n    date: \"%d %M\",\n    step: 1\n  }], [{\n    unit: \"day\",\n    date: \"%d %M\",\n    step: 1\n  }, {\n    unit: \"hour\",\n    date: \"%H:00\",\n    step: 8\n  }], [{\n    unit: \"day\",\n    date: \"%d %M\",\n    step: 1\n  }, {\n    unit: \"hour\",\n    date: \"%H:00\",\n    step: 1\n  }]];\nclass qa {\n  constructor(e) {\n    this.zoomIn = () => {\n      const n = this.getCurrentLevel() - 1;\n      n < 0 || this.setLevel(n);\n    }, this.zoomOut = () => {\n      const n = this.getCurrentLevel() + 1;\n      n > this._levels.length - 1 || this.setLevel(n);\n    }, this.getCurrentLevel = () => this._activeLevelIndex, this.getLevels = () => this._levels, this.setLevel = n => {\n      const i = this._getZoomIndexByName(n);\n      i === -1 && this.$gantt.assert(i !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + n + \" is not an expected value.\"), this._setLevel(i, 0);\n    }, this._getZoomIndexByName = n => {\n      let i = -1;\n      if (typeof n == \"string\") {\n        if (!isNaN(Number(n)) && this._levels[Number(n)]) i = Number(n);else for (let a = 0; a < this._levels.length; a++) if (this._levels[a].name === n) {\n          i = a;\n          break;\n        }\n      } else i = n;\n      return i;\n    }, this._getVisibleDate = () => {\n      if (!this.$gantt.$task) return null;\n      const n = this.$gantt.getScrollState().x,\n        i = this.$gantt.$task.offsetWidth;\n      this._visibleDate = this.$gantt.dateFromPos(n + i / 2);\n    }, this._setLevel = (n, i) => {\n      this._activeLevelIndex = n;\n      const a = this.$gantt,\n        r = a.copy(this._levels[this._activeLevelIndex]),\n        s = a.copy(r);\n      if (delete s.name, a.mixin(a.config, s, !0), [\"resourceTimeline\", \"resourceHistogram\"].forEach(function (o) {\n        const l = a.$ui.getView(o);\n        if (l) {\n          const c = l.$getConfig();\n          c.fixed_scales || a.mixin(c, s, !0);\n        }\n      }), a.$root && a.$task) {\n        if (i) {\n          const o = this.$gantt.dateFromPos(i + this.$gantt.getScrollState().x);\n          this.$gantt.render();\n          const l = this.$gantt.posFromDate(o);\n          this.$gantt.scrollTo(l - i);\n        } else {\n          const o = this.$gantt.$task.offsetWidth;\n          this._visibleDate || this._getVisibleDate();\n          const l = this._visibleDate;\n          this.$gantt.render();\n          const c = this.$gantt.posFromDate(l);\n          this.$gantt.scrollTo(c - o / 2);\n        }\n        this.callEvent(\"onAfterZoom\", [this._activeLevelIndex, r]);\n      }\n    }, this._attachWheelEvent = n => {\n      const i = mt.isFF ? \"wheel\" : \"mousewheel\";\n      let a;\n      a = typeof n.element == \"function\" ? n.element() : n.element, a && this._domEvents.attach(a, i, this.$gantt.bind(function (r) {\n        if (this._useKey && (Va.indexOf(this._useKey) < 0 || !r[this._useKey])) return !1;\n        if (typeof this._handler == \"function\") return this._handler.apply(this, [r]), !0;\n      }, this), {\n        passive: !1\n      });\n    }, this._defaultHandler = n => {\n      const i = this.$gantt.$task.getBoundingClientRect().x,\n        a = n.clientX - i;\n      let r = !1;\n      (this.$gantt.env.isFF ? -40 * n.deltaY : n.wheelDelta) > 0 && (r = !0), n.preventDefault(), n.stopPropagation(), this._setScaleSettings(r, a);\n    }, this._setScaleDates = () => {\n      this._initialStartDate && this._initialEndDate && (this.$gantt.config.start_date = this._initialStartDate, this.$gantt.config.end_date = this._initialEndDate);\n    }, this.$gantt = e, this._domEvents = this.$gantt._createDomEventScope();\n  }\n  init(e) {\n    this.$gantt.env.isNode || (this._initialStartDate = e.startDate, this._initialEndDate = e.endDate, this._activeLevelIndex = e.activeLevelIndex ? e.activeLevelIndex : 0, this._levels = this._mapScales(e.levels || Ua), this._handler = e.handler || this._defaultHandler, this._minColumnWidth = e.minColumnWidth || 60, this._maxColumnWidth = e.maxColumnWidth || 240, this._widthStep = e.widthStep || 3 / 8 * e.minColumnWidth, this._useKey = e.useKey, this._initialized || (ot(this), this.$gantt.attachEvent(\"onGanttScroll\", () => {\n      this._getVisibleDate();\n    })), this._domEvents.detachAll(), e.trigger === \"wheel\" && (this.$gantt.$root ? this._attachWheelEvent(e) : this.$gantt.attachEvent(\"onGanttLayoutReady\", () => {\n      this.$gantt.attachEvent(\"onGanttRender\", () => {\n        this._attachWheelEvent(e);\n      }, {\n        once: !0\n      });\n    })), this._initialized = !0, this.setLevel(this._activeLevelIndex));\n  }\n  _mapScales(e) {\n    return e.map(n => Array.isArray(n) ? {\n      scales: n\n    } : n);\n  }\n  _setScaleSettings(e, n) {\n    e ? this._stepUp(n) : this._stepDown(n);\n  }\n  _stepUp(e) {\n    if (this._activeLevelIndex >= this._levels.length - 1) return;\n    let n = this._activeLevelIndex;\n    if (this._setScaleDates(), this._widthStep) {\n      let i = this.$gantt.config.min_column_width + this._widthStep;\n      i > this._maxColumnWidth && (i = this._minColumnWidth, n++), this.$gantt.config.min_column_width = i;\n    } else n++;\n    this._setLevel(n, e);\n  }\n  _stepDown(e) {\n    if (this._activeLevelIndex < 1) return;\n    let n = this._activeLevelIndex;\n    if (this._setScaleDates(), this._widthStep) {\n      let i = this.$gantt.config.min_column_width - this._widthStep;\n      i < this._minColumnWidth && (i = this._maxColumnWidth, n--), this.$gantt.config.min_column_width = i;\n    } else n--;\n    this._setLevel(n, e);\n  }\n}\nfunction Ga(t) {\n  function e() {\n    if (t.config.touch != \"force\" && (t.config.touch = t.config.touch && (navigator.userAgent.indexOf(\"Mobile\") != -1 || navigator.userAgent.indexOf(\"iPad\") != -1 || navigator.userAgent.indexOf(\"Android\") != -1 || navigator.userAgent.indexOf(\"Touch\") != -1) || navigator.platform === \"MacIntel\" && navigator.maxTouchPoints > 1), t.config.touch) {\n      var r = !0;\n      try {\n        document.createEvent(\"TouchEvent\");\n      } catch {\n        r = !1;\n      }\n      r ? t._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (s) {\n        return s.touches && s.touches.length > 1 ? null : s.touches[0] ? {\n          target: s.target,\n          pageX: s.touches[0].pageX,\n          pageY: s.touches[0].pageY,\n          clientX: s.touches[0].clientX,\n          clientY: s.touches[0].clientY\n        } : s;\n      }, function (s) {\n        return s.defaultPrevented;\n      }) : window.navigator.pointerEnabled ? t._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (s) {\n        return s.pointerType == \"mouse\" ? null : s;\n      }, function (s) {\n        return !s || s.pointerType == \"mouse\";\n      }) : window.navigator.msPointerEnabled && t._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function (s) {\n        return s.pointerType == s.MSPOINTER_TYPE_MOUSE ? null : s;\n      }, function (s) {\n        return !s || s.pointerType == s.MSPOINTER_TYPE_MOUSE;\n      });\n    }\n  }\n  function n(r) {\n    var s = r.$config.scrollX ? t.$ui.getView(r.$config.scrollX) : null,\n      o = r.$config.scrollY ? t.$ui.getView(r.$config.scrollY) : null,\n      l = {\n        x: null,\n        y: null\n      };\n    return s && s.getScrollState().visible && (l.x = s.$view.scrollLeft), o && o.getScrollState().visible && (l.y = o.$view.scrollTop), l;\n  }\n  function i() {\n    var r;\n    return t.$ui.getView(\"timeline\") && (r = t.$ui.getView(\"timeline\")._tasks_dnd), r;\n  }\n  t.config.touch_drag = 75, t.config.touch = !0, t.config.touch_feedback = !0, t.config.touch_feedback_duration = 1, t._prevent_touch_scroll = !1, t._touch_feedback = function () {\n    t.config.touch_feedback && navigator.vibrate && navigator.vibrate(t.config.touch_feedback_duration);\n  }, t.attachEvent(\"onGanttReady\", function () {\n    t.$container && e();\n  }), t.attachEvent(\"onGanttLayoutReady\", function () {\n    t.$container && t.attachEvent(\"onGanttRender\", e, {\n      once: !0\n    });\n  });\n  var a = [];\n  t._touch_events = function (r, s, o) {\n    var l,\n      c = 0,\n      d = !1,\n      u = !1,\n      h = null,\n      _ = null,\n      p = null,\n      y = [],\n      k = null;\n    let b = {};\n    for (var g = 0; g < a.length; g++) t.eventRemove(a[g][0], a[g][1], a[g][2]);\n    (a = []).push([t.$container, r[0], function (f) {\n      var v = i();\n      if (!o(f) && d) {\n        _ && clearTimeout(_);\n        var x = s(f);\n        if (v && (v.drag.id || v.drag.start_drag)) return v.on_mouse_move(x), f.preventDefault && f.preventDefault(), f.cancelBubble = !0, !1;\n        if (!t._prevent_touch_scroll) {\n          if (x && h) {\n            var $ = h.pageX - x.pageX,\n              w = h.pageY - x.pageY;\n            if (!u && (Math.abs($) > 5 || Math.abs(w) > 5) && (u = !0, c = 0, l = k ? n(k) : t.getScrollState()), u) {\n              var S,\n                T = l.x + $,\n                E = l.y + w;\n              if (k ? (function (C, D, M) {\n                var I = C.$config.scrollX ? t.$ui.getView(C.$config.scrollX) : null,\n                  A = C.$config.scrollY ? t.$ui.getView(C.$config.scrollY) : null;\n                I && I.scrollTo(D, null), A && A.scrollTo(null, M);\n              }(k, T, E), S = n(k)) : (t.scrollTo(T, E), S = t.getScrollState()), l.x != S.x && w > 2 * $ || l.y != S.y && $ > 2 * w) return m(f);\n            }\n          }\n          return m(f);\n        }\n        return !0;\n      }\n    }]);\n    try {\n      document.addEventListener(\"touchmove\", function (f) {\n        t._touch_drag && m(f);\n      }, {\n        passive: !1\n      });\n    } catch {\n      console.warn(\"Cannot prevent touch event for the page drag\");\n    }\n    for (a.push([this.$container, \"contextmenu\", function (f) {\n      if (d) return m(f);\n    }]), a.push([this.$container, r[1], function (f) {\n      if (b = f.touches.length, document && document.body && document.body.classList.add(\"gantt_touch_active\"), !o(f)) if (f.touches && f.touches.length > 1) d = !1;else {\n        h = s(f), k = function (x) {\n          for (var $ = t.$layout.getCellsByType(\"viewCell\"), w = 0; w < $.length; w++) {\n            var S = $[w].$view.getBoundingClientRect();\n            if (x.clientX >= S.left && x.clientX <= S.right && x.clientY <= S.bottom && x.clientY >= S.top) return $[w];\n          }\n        }(h), t._locate_css(h, \"gantt_hor_scroll\") || t._locate_css(h, \"gantt_ver_scroll\") || (d = !0);\n        var v = i();\n        _ = setTimeout(function () {\n          var x = t.locate(h);\n          v && x && !t._locate_css(h, \"gantt_link_control\") && !t._locate_css(h, \"gantt_grid_data\") && (v.on_mouse_down(h), v.drag && v.drag.start_drag && (function ($) {\n            const w = t._getTaskLayers();\n            let S = t.getTask($);\n            if (S) {\n              let T = t.isTaskVisible($);\n              if (T) {\n                p = $;\n                for (let E = 0; E < w.length; E++) if (S = w[E].rendered[$], S && S.getAttribute(t.config.task_attribute) && S.getAttribute(t.config.task_attribute) == $) {\n                  const C = S.cloneNode(!0);\n                  y.push(S), w[E].rendered[$] = C, S.style.display = \"none\", C.className += \" gantt_drag_move \", S.parentNode.appendChild(C);\n                }\n              } else if (S.$split_subtask) {\n                let E = S.$rendered_parent;\n                if (T = t.isTaskVisible(E), !T) return;\n                p = $;\n                for (let C = 0; C < w.length; C++) {\n                  const D = w[C].rendered[E];\n                  let M;\n                  if (D && D.childNodes && (M = D.querySelector(`[${t.config.task_attribute}=\"${S.id}\"]`)), M) {\n                    const I = M.cloneNode(!0);\n                    M.parentNode.appendChild(I), t.$task_bars.appendChild(M), M.style.display = \"none\", y.push(M), M = null;\n                  }\n                }\n              }\n            }\n          }(x), v._start_dnd(h), t._touch_drag = !0, t.refreshTask(x), t._touch_feedback())), _ = null;\n        }, t.config.touch_drag);\n      }\n    }]), a.push([this.$container, r[2], function (f) {\n      if (document && document.body && document.body.classList.remove(\"gantt_touch_active\"), !o(f)) {\n        _ && clearTimeout(_), t._touch_drag = !1, d = !1;\n        var v = s(f),\n          x = i();\n        if (x && x.on_mouse_up(v), p && t.isTaskExists(p) && (t.refreshTask(p), y.length && (y.forEach(function (w) {\n          w.parentNode && w.parentNode.removeChild(w);\n        }), t._touch_feedback())), d = u = !1, y = [], p = null, h && c) {\n          var $ = /* @__PURE__ */new Date();\n          $ - c < 500 && b <= 1 ? (t.$services.getService(\"mouseEvents\").onDoubleClick(h), m(f)) : c = $;\n        } else c = /* @__PURE__ */new Date();\n      }\n    }]), g = 0; g < a.length; g++) t.event(a[g][0], a[g][1], a[g][2]);\n    function m(f) {\n      return f && f.preventDefault && f.cancelable && f.preventDefault(), f.cancelBubble = !0, !1;\n    }\n  };\n}\nfunction Ft() {\n  console.log(\"Method is not implemented.\");\n}\nfunction Mt() {}\nfunction ht(t) {\n  return Mt;\n}\nMt.prototype.render = Ft, Mt.prototype.set_value = Ft, Mt.prototype.get_value = Ft, Mt.prototype.focus = Ft;\nvar $n = {\n  getHtmlSelect: function (t, e, n) {\n    var i = \"\",\n      a = this;\n    return kt(t = t || [], function (r) {\n      var s = [{\n        key: \"value\",\n        value: r.key\n      }];\n      n == r.key && (s[s.length] = {\n        key: \"selected\",\n        value: \"selected\"\n      }), r.attributes && (s = s.concat(r.attributes)), i += a.getHtmlOption({\n        innerHTML: r.label\n      }, s);\n    }), Dt(\"select\", {\n      innerHTML: i\n    }, e);\n  },\n  getHtmlOption: function (t, e) {\n    return Dt(\"option\", t, e);\n  },\n  getHtmlButton: function (t, e) {\n    return Dt(\"button\", t, e);\n  },\n  getHtmlDiv: function (t, e) {\n    return Dt(\"div\", t, e);\n  },\n  getHtmlLabel: function (t, e) {\n    return Dt(\"label\", t, e);\n  },\n  getHtmlInput: function (t) {\n    return \"<input\" + wn(t || []) + \">\";\n  }\n};\nfunction Dt(t, e, n) {\n  return e = e || [], \"<\" + t + wn(n || []) + \">\" + (e.innerHTML || \"\") + \"</\" + t + \">\";\n}\nfunction wn(t) {\n  var e = \"\";\n  return kt(t, function (n) {\n    e += \" \" + n.key + \"='\" + n.value + \"'\";\n  }), e;\n}\nfunction qt(t) {\n  const e = ht();\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  return z(n, e), n.prototype.render = function (i) {\n    const a = i.height ? `height:${i.height}px;` : \"\";\n    let r = `<div class='gantt_cal_ltext gantt_section_${i.name}' ${a ? `style='${a}'` : \"\"}>`;\n    return r += $n.getHtmlSelect(i.options, [{\n      key: \"style\",\n      value: \"width:100%;\"\n    }, {\n      key: \"title\",\n      value: i.name\n    }]), r += \"</div>\", r;\n  }, n.prototype.set_value = function (i, a, r, s) {\n    var o = i.firstChild;\n    !o._dhx_onchange && s.onchange && (o.onchange = s.onchange, o._dhx_onchange = !0), a === void 0 && (a = (o.options[0] || {}).value), o.value = a || \"\";\n  }, n.prototype.get_value = function (i) {\n    return i.firstChild.value;\n  }, n.prototype.focus = function (i) {\n    var a = i.firstChild;\n    t._focus(a, !0);\n  }, n;\n}\nfunction Ya(t) {\n  var e = qt(t);\n  function n() {\n    return e.apply(this, arguments) || this;\n  }\n  function i(a, r) {\n    var s = [],\n      o = [];\n    r && (s = t.getTaskByTime(), a.allow_root && s.unshift({\n      id: t.config.root_id,\n      text: a.root_label || \"\"\n    }), s = function (u, h, _) {\n      var p = h.filter || function () {\n        return !0;\n      };\n      u = u.slice(0);\n      for (var y = 0; y < u.length; y++) {\n        var k = u[y];\n        (k.id == _ || t.isChildOf(k.id, _) || p(k.id, k) === !1) && (u.splice(y, 1), y--);\n      }\n      return u;\n    }(s, a, r), a.sort && s.sort(a.sort));\n    for (var l = a.template || t.templates.task_text, c = 0; c < s.length; c++) {\n      var d = l.apply(t, [s[c].start_date, s[c].end_date, s[c]]);\n      d === void 0 && (d = \"\"), o.push({\n        key: s[c].id,\n        label: d\n      });\n    }\n    return a.options = o, a.map_to = a.map_to || \"parent\", t.form_blocks.select.render.apply(this, arguments);\n  }\n  return z(n, e), n.prototype.render = function (a) {\n    return i(a, !1);\n  }, n.prototype.set_value = function (a, r, s, o) {\n    r === 0 && (r = \"0\"), !s.id && t.getState().lightbox && (s.id = t.getLightboxValues().id);\n    var l = document.createElement(\"div\");\n    l.innerHTML = i(o, s.id);\n    var c = l.removeChild(l.firstChild);\n    return a.onselect = null, a.parentNode.replaceChild(c, a), t.form_blocks.select.set_value.apply(t, [c, r, s, o]);\n  }, n;\n}\nfunction Ja(t) {\n  var e = function () {\n      const g = ht();\n      function m() {\n        return g.apply(this, arguments) || this;\n      }\n      return z(m, g), m.prototype.render = function (f) {\n        let v = f.height ? `${f.height}px` : \"\";\n        return `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${f.name}' ${v ? `style='height:${v};'` : \"\"}></div>`;\n      }, m.prototype.set_value = function (f, v) {\n        f.innerHTML = v || \"\";\n      }, m.prototype.get_value = function (f) {\n        return f.innerHTML || \"\";\n      }, m.prototype.focus = function () {}, m;\n    }(),\n    n = function (g) {\n      const m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      return z(f, m), f.prototype.render = function (v) {\n        const x = (v.height || \"130\") + \"px\",\n          $ = v.placeholder ? `placeholder='${v.placeholder}'` : \"\";\n        return `<div class='gantt_cal_ltext gantt_section_${v.name}' style='height:${x};' ${$}><textarea></textarea></div>`;\n      }, f.prototype.set_value = function (v, x) {\n        g.form_blocks.textarea._get_input(v).value = x || \"\";\n      }, f.prototype.get_value = function (v) {\n        return g.form_blocks.textarea._get_input(v).value;\n      }, f.prototype.focus = function (v) {\n        var x = g.form_blocks.textarea._get_input(v);\n        g._focus(x, !0);\n      }, f.prototype._get_input = function (v) {\n        return v.querySelector(\"textarea\");\n      }, f;\n    }(t),\n    i = function (g) {\n      const m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      return z(f, m), f.prototype.render = function (v) {\n        var x = g.form_blocks.getTimePicker.call(this, v);\n        let $ = \"gantt_section_time\";\n        v.name !== \"time\" && ($ += \" gantt_section_\" + v.name);\n        var w = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + $ + \"'>\";\n        return w += x, v.single_date ? (x = g.form_blocks.getTimePicker.call(this, v, !0), w += \"<span></span>\") : w += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\", (w += x) + \"</div>\";\n      }, f.prototype.set_value = function (v, x, $, w) {\n        var S = w,\n          T = v.getElementsByTagName(\"select\"),\n          E = w._time_format_order;\n        if (S.auto_end_date) for (var C = function () {\n            I = new Date(T[E[2]].value, T[E[1]].value, T[E[0]].value, 0, 0), A = g.calculateEndDate({\n              start_date: I,\n              duration: 1,\n              task: $\n            }), g.form_blocks._fill_lightbox_select(T, E.size, A, E, S);\n          }, D = 0; D < 4; D++) T[D].onchange = C;\n        var M = g._resolve_default_mapping(w);\n        typeof M == \"string\" && (M = {\n          start_date: M\n        });\n        var I = $[M.start_date] || /* @__PURE__ */new Date(),\n          A = $[M.end_date] || g.calculateEndDate({\n            start_date: I,\n            duration: 1,\n            task: $\n          });\n        g.form_blocks._fill_lightbox_select(T, 0, I, E, S), g.form_blocks._fill_lightbox_select(T, E.size, A, E, S);\n      }, f.prototype.get_value = function (v, x, $) {\n        var w,\n          S = v.getElementsByTagName(\"select\"),\n          T = $._time_format_order;\n        return w = g.form_blocks.getTimePickerValue(S, $), typeof g._resolve_default_mapping($) == \"string\" ? w : {\n          start_date: w,\n          end_date: function (E, C, D) {\n            var M = g.form_blocks.getTimePickerValue(E, $, C.size);\n            return M <= D && ($.autofix_end !== !1 || $.single_date) ? g.date.add(D, g._get_timepicker_step(), \"minute\") : M;\n          }(S, T, w)\n        };\n      }, f.prototype.focus = function (v) {\n        g._focus(v.getElementsByTagName(\"select\")[0]);\n      }, f;\n    }(t),\n    a = qt(t),\n    r = function (g) {\n      var m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      return z(f, m), f.prototype.render = function (v) {\n        const x = v.height ? `height:${v.height}px;` : \"\";\n        let $ = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${v.name}' ${x ? `style='${x}'` : \"\"}>`;\n        if (v.options && v.options.length) for (var w = 0; w < v.options.length; w++) $ += \"<label><input type='checkbox' value='\" + v.options[w].key + \"' name='\" + v.name + \"'>\" + v.options[w].label + \"</label>\";else v.single_value = !0, $ += \"<label><input type='checkbox' name='\" + v.name + \"'></label>\";\n        return $ += \"</div>\", $;\n      }, f.prototype.set_value = function (v, x, $, w) {\n        var S = Array.prototype.slice.call(v.querySelectorAll(\"input[type=checkbox]\"));\n        !v._dhx_onchange && w.onchange && (v.onchange = w.onchange, v._dhx_onchange = !0), w.single_value ? S[0].checked = !!x : kt(S, function (T) {\n          T.checked = !!x && x.indexOf(T.value) >= 0;\n        });\n      }, f.prototype.get_value = function (v, x, $) {\n        return $.single_value ? v.querySelector(\"input[type=checkbox]\").checked : function (w, S) {\n          if (w.map) return w.map(S);\n          for (var T = w.slice(), E = [], C = 0; C < T.length; C++) E.push(S(T[C], C));\n          return E;\n        }(Array.prototype.slice.call(v.querySelectorAll(\"input[type=checkbox]:checked\")), function (w) {\n          return w.value;\n        });\n      }, f.prototype.focus = function (v) {\n        g._focus(v.querySelector(\"input[type=checkbox]\"));\n      }, f;\n    }(t),\n    s = function (g) {\n      const m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      return z(f, m), f.prototype.render = function (v) {\n        const x = v.height ? `${v.height}px` : \"\";\n        let $ = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${v.name}' ${x ? `style='height:${x};'` : \"\"}>`;\n        if (v.options && v.options.length) for (var w = 0; w < v.options.length; w++) $ += \"<label><input type='radio' value='\" + v.options[w].key + \"' name='\" + v.name + \"'>\" + v.options[w].label + \"</label>\";\n        return $ += \"</div>\", $;\n      }, f.prototype.set_value = function (v, x, $, w) {\n        var S;\n        w.options && w.options.length && (S = v.querySelector(\"input[type=radio][value='\" + x + \"']\") || v.querySelector(\"input[type=radio][value='\" + w.default_value + \"']\")) && (!v._dhx_onchange && w.onchange && (v.onchange = w.onchange, v._dhx_onchange = !0), S.checked = !0);\n      }, f.prototype.get_value = function (v, x) {\n        var $ = v.querySelector(\"input[type=radio]:checked\");\n        return $ ? $.value : \"\";\n      }, f.prototype.focus = function (v) {\n        g._focus(v.querySelector(\"input[type=radio]\"));\n      }, f;\n    }(t),\n    o = function (g) {\n      var m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      function v(w) {\n        return w.formatter || new Pt();\n      }\n      function x(w, S) {\n        var T = w.getElementsByTagName(\"select\"),\n          E = S._time_format_order,\n          C = 0,\n          D = 0;\n        if (g.defined(E[3])) {\n          var M = T[E[3]],\n            I = parseInt(M.value, 10);\n          isNaN(I) && M.hasAttribute(\"data-value\") && (I = parseInt(M.getAttribute(\"data-value\"), 10)), C = Math.floor(I / 60), D = I % 60;\n        }\n        return new Date(T[E[2]].value, T[E[1]].value, T[E[0]].value, C, D);\n      }\n      function $(w, S) {\n        var T = w.getElementsByTagName(\"input\")[1];\n        return (T = v(S).parse(T.value)) && !window.isNaN(T) || (T = 1), T < 0 && (T *= -1), T;\n      }\n      return z(f, m), f.prototype.render = function (w) {\n        var S = \"<div class='gantt_time_selects'>\" + g.form_blocks.getTimePicker.call(this, w) + \"</div>\",\n          T = \" \" + g.locale.labels[g.config.duration_unit + \"s\"] + \" \",\n          E = w.single_date ? \" style='display:none'\" : \"\",\n          C = w.readonly ? \" disabled='disabled'\" : \"\",\n          D = g._waiAria.lightboxDurationInputAttrString(w),\n          M = \"gantt_duration_value\";\n        w.formatter && (T = \"\", M += \" gantt_duration_value_formatted\");\n        var I = \"<div class='gantt_duration' \" + E + \"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value=''\" + C + \"><input type='text' value='5days' class='\" + M + \"'\" + C + \" \" + D + \"><input type='button' class='gantt_duration_inc' value='+'\" + C + \"></div><div class='gantt_duration_end_date'>\" + T + \"<span></span></div></div></div>\";\n        let A = \"gantt_section_time gantt_section_duration\";\n        return w.name !== \"time\" && (A += \" gantt_section_\" + w.name), \"<div style='padding-top:0px;font-size:inherit;' class='\" + A + \"'>\" + S + \" \" + I + \"</div>\";\n      }, f.prototype.set_value = function (w, S, T, E) {\n        var C,\n          D,\n          M,\n          I,\n          A = w.getElementsByTagName(\"select\"),\n          N = w.getElementsByTagName(\"input\"),\n          L = N[1],\n          O = [N[0], N[2]],\n          G = w.getElementsByTagName(\"span\")[0],\n          j = E._time_format_order;\n        function H() {\n          var J = x.call(g, w, E),\n            B = $.call(g, w, E),\n            _t = g.calculateEndDate({\n              start_date: J,\n              duration: B,\n              task: T\n            }),\n            Tt = g.templates.task_end_date || g.templates.task_date;\n          G.innerHTML = Tt(_t);\n        }\n        function tt(J) {\n          var B = L.value;\n          B = v(E).parse(B), window.isNaN(B) && (B = 0), (B += J) < 1 && (B = 1), L.value = v(E).format(B), H();\n        }\n        O[0].onclick = g.bind(function () {\n          tt(-1 * g.config.duration_step);\n        }, this), O[1].onclick = g.bind(function () {\n          tt(1 * g.config.duration_step);\n        }, this), A[0].onchange = H, A[1].onchange = H, A[2].onchange = H, A[3] && (A[3].onchange = H), L.onkeydown = g.bind(function (J) {\n          var B;\n          return (B = (J = J || window.event).charCode || J.keyCode || J.which) == g.constants.KEY_CODES.DOWN ? (tt(-1 * g.config.duration_step), !1) : B == g.constants.KEY_CODES.UP ? (tt(1 * g.config.duration_step), !1) : void window.setTimeout(H, 1);\n        }, this), L.onchange = g.bind(H, this), typeof (C = g._resolve_default_mapping(E)) == \"string\" && (C = {\n          start_date: C\n        }), D = T[C.start_date] || /* @__PURE__ */new Date(), M = T[C.end_date] || g.calculateEndDate({\n          start_date: D,\n          duration: 1,\n          task: T\n        }), I = Math.round(T[C.duration]) || g.calculateDuration({\n          start_date: D,\n          end_date: M,\n          task: T\n        }), I = v(E).format(I), g.form_blocks._fill_lightbox_select(A, 0, D, j, E), L.value = I, H();\n      }, f.prototype.get_value = function (w, S, T) {\n        var E = x(w, T),\n          C = $(w, T),\n          D = g.calculateEndDate({\n            start_date: E,\n            duration: C,\n            task: S\n          });\n        return typeof g._resolve_default_mapping(T) == \"string\" ? E : {\n          start_date: E,\n          end_date: D,\n          duration: C\n        };\n      }, f.prototype.focus = function (w) {\n        g._focus(w.getElementsByTagName(\"select\")[0]);\n      }, f;\n    }(t),\n    l = Ya(t),\n    c = qt(t),\n    d = function (g) {\n      var m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      function v($) {\n        return !$ || $ === g.config.constraint_types.ASAP || $ === g.config.constraint_types.ALAP;\n      }\n      function x($, w) {\n        for (var S = v(w), T = 0; T < $.length; T++) $[T].disabled = S;\n      }\n      return z(f, m), f.prototype.render = function ($) {\n        const w = $.height ? `height:${$.height}px;` : \"\";\n        let S = `<div class='gantt_cal_ltext gantt_section_${$.name}' ${w ? `style='${w}'` : \"\"}>`;\n        var T = [];\n        for (var E in g.config.constraint_types) T.push({\n          key: g.config.constraint_types[E],\n          label: g.locale.labels[g.config.constraint_types[E]]\n        });\n        return $.options = $.options || T, S += \"<span data-constraint-type-select>\" + $n.getHtmlSelect($.options, [{\n          key: \"data-type\",\n          value: \"constraint-type\"\n        }]) + \"</span>\", S += \"<label data-constraint-time-select>\" + (g.locale.labels.constraint_date || \"Constraint date\") + \": \" + g.form_blocks.getTimePicker.call(this, $) + \"</label>\", S += \"</div>\", S;\n      }, f.prototype.set_value = function ($, w, S, T) {\n        var E = $.querySelector(\"[data-constraint-type-select] select\"),\n          C = $.querySelectorAll(\"[data-constraint-time-select] select\"),\n          D = T._time_format_order,\n          M = g._resolve_default_mapping(T);\n        E._eventsInitialized || (E.addEventListener(\"change\", function (N) {\n          x(C, N.target.value);\n        }), E._eventsInitialized = !0);\n        var I = S[M.constraint_date] || /* @__PURE__ */new Date();\n        g.form_blocks._fill_lightbox_select(C, 0, I, D, T);\n        var A = S[M.constraint_type] || g.getConstraintType(S);\n        E.value = A, x(C, A);\n      }, f.prototype.get_value = function ($, w, S) {\n        var T = $.querySelector(\"[data-constraint-type-select] select\"),\n          E = $.querySelectorAll(\"[data-constraint-time-select] select\"),\n          C = T.value,\n          D = null;\n        return v(C) || (D = g.form_blocks.getTimePickerValue(E, S)), {\n          constraint_type: C,\n          constraint_date: D\n        };\n      }, f.prototype.focus = function ($) {\n        g._focus($.querySelector(\"select\"));\n      }, f;\n    }(t),\n    u = function (g) {\n      const m = qt(g);\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      return z(f, m), f.prototype.render = function (v) {\n        var x = g.config.types,\n          $ = g.locale.labels,\n          w = [],\n          S = v.filter || function (C, D) {\n            return !x.placeholder || D !== x.placeholder;\n          };\n        for (var T in x) !S(T, x[T]) == 0 && w.push({\n          key: x[T],\n          label: $[\"type_\" + T]\n        });\n        v.options = w;\n        var E = v.onchange;\n        return v.onchange = function () {\n          g._lightbox_current_type = this.value, g.changeLightboxType(this.value), typeof E == \"function\" && E.apply(this, arguments);\n        }, m.prototype.render.apply(this, arguments);\n      }, f;\n    }(t),\n    h = function (g) {\n      var m = ht();\n      function f() {\n        return m.apply(this, arguments) || this;\n      }\n      function v(S) {\n        return S.formatter || new Pt();\n      }\n      function x(S, T, E, C) {\n        const D = \"<div class='gantt_time_selects'>\" + g.form_blocks.getTimePicker.call(g, C) + \"</div>\";\n        let M = \" \" + g.locale.labels[g.config.duration_unit + \"s\"] + \" \";\n        const I = C.single_date ? \" style='display:none'\" : \"\",\n          A = C.readonly ? \" disabled='disabled'\" : \"\",\n          N = g._waiAria.lightboxDurationInputAttrString(C),\n          L = g.locale.labels.baselines_remove_button;\n        let O = \"gantt_duration_value\";\n        C.formatter && (M = \"\", O += \" gantt_duration_value_formatted\");\n        const G = \"<div class='gantt_duration' \" + I + \"><div class='gantt_duration_inputs'><input type='button' class='gantt_duration_dec' value=''\" + A + \"><input type='text' value='5days' class='\" + O + \"'\" + A + \" \" + N + \"><input type='button' class='gantt_duration_inc' value='+'\" + A + \"></div><div class='gantt_duration_end_date'>\" + M + \"<span></span></div></div></div>\",\n          j = `<div><div class='baseline_delete_button gantt_custom_button'>${L}</div></div>`,\n          H = document.createElement(\"div\");\n        H.className = \"gantt_section_time gantt_section_duration\", H.setAttribute(\"data-baseline-id\", T.id), H.innerHTML = D + G + j + \"<br>\", S.appendChild(H);\n        var tt,\n          J,\n          B,\n          _t = H.getElementsByTagName(\"select\"),\n          Tt = H.getElementsByTagName(\"input\"),\n          Et = Tt[1],\n          Ee = [Tt[0], Tt[2]],\n          Sn = H.getElementsByTagName(\"span\")[0],\n          Tn = C._time_format_order;\n        function gt() {\n          var ct = $.call(g, H, C),\n            U = w.call(g, H, C),\n            En = g.calculateEndDate({\n              start_date: ct,\n              duration: U,\n              task: E\n            }),\n            Cn = g.templates.task_end_date || g.templates.task_date;\n          Sn.innerHTML = Cn(En);\n        }\n        function Ot(ct) {\n          var U = Et.value;\n          U = v(C).parse(U), window.isNaN(U) && (U = 0), (U += ct) < 1 && (U = 1), Et.value = v(C).format(U), gt();\n        }\n        H.querySelector(\".baseline_delete_button\").onclick = function (ct) {\n          const U = H.parentNode;\n          H.innerHTML = \"\", H.remove(), U.innerHTML === \"\" && (U.innerHTML = g.locale.labels.baselines_section_placeholder);\n        }, Ee[0].onclick = g.bind(function () {\n          Ot(-1 * g.config.duration_step);\n        }, g), Ee[1].onclick = g.bind(function () {\n          Ot(1 * g.config.duration_step);\n        }, g), _t[0].onchange = gt, _t[1].onchange = gt, _t[2].onchange = gt, _t[3] && (_t[3].onchange = gt), Et.onkeydown = g.bind(function (ct) {\n          var U;\n          return (U = (ct = ct || window.event).charCode || ct.keyCode || ct.which) == g.constants.KEY_CODES.DOWN ? (Ot(-1 * g.config.duration_step), !1) : U == g.constants.KEY_CODES.UP ? (Ot(1 * g.config.duration_step), !1) : void window.setTimeout(gt, 1);\n        }, g), Et.onchange = g.bind(gt, g), g._resolve_default_mapping(C), tt = T.start_date || /* @__PURE__ */new Date(), J = T.end_date || g.calculateEndDate({\n          start_date: tt,\n          duration: 1,\n          task: E\n        }), B = g.calculateDuration({\n          start_date: tt,\n          end_date: J,\n          task: E\n        }), B = v(C).format(B), g.form_blocks._fill_lightbox_select(_t, 0, tt, Tn, C), Et.value = B, gt();\n      }\n      function $(S, T) {\n        var E = S.getElementsByTagName(\"select\"),\n          C = T._time_format_order,\n          D = 0,\n          M = 0;\n        if (g.defined(C[3])) {\n          var I = E[C[3]],\n            A = parseInt(I.value, 10);\n          isNaN(A) && I.hasAttribute(\"data-value\") && (A = parseInt(I.getAttribute(\"data-value\"), 10)), D = Math.floor(A / 60), M = A % 60;\n        }\n        return new Date(E[C[2]].value, E[C[1]].value, E[C[0]].value, D, M);\n      }\n      function w(S, T) {\n        var E = S.getElementsByTagName(\"input\")[1];\n        return (E = v(T).parse(E.value)) && !window.isNaN(E) || (E = 1), E < 0 && (E *= -1), E;\n      }\n      return z(f, m), f.prototype.render = function (S) {\n        return `<div style='height: ${S.height || 100}px; padding-top:0px; font-size:inherit;' class='gantt_section_baselines'></div>`;\n      }, f.prototype.set_value = function (S, T, E, C) {\n        E.baselines ? (S.innerHTML = \"\", E.baselines.forEach(D => {\n          x(S, D, E, C);\n        })) : S.innerHTML = g.locale.labels.baselines_section_placeholder;\n      }, f.prototype.get_value = function (S, T, E) {\n        const C = [];\n        return S.querySelectorAll(\"[data-baseline-id]\").forEach(D => {\n          const M = D.dataset.baselineId;\n          let I,\n            A = g.getDatastore(\"baselines\").getItem(M);\n          I = A ? g.copy(A) : {\n            id: g.uid(),\n            task_id: T.id,\n            text: \"Baseline 1\"\n          }, I.start_date = $(D, E), I.duration = w(D, E), I.end_date = g.calculateEndDate({\n            start_date: I.start_date,\n            duration: I.duration,\n            task: T\n          }), C.push(I);\n        }), C;\n      }, f.prototype.button_click = function (S, T, E, C) {\n        if (g.callEvent(\"onSectionButton\", [g._lightbox_id, E]) !== !1 && (T.closest(\".gantt_custom_button.gantt_remove_baselines\") && (C.innerHTML = g.locale.labels.baselines_section_placeholder), T.closest(\".gantt_custom_button.gantt_add_baselines\"))) {\n          C.innerHTML == g.locale.labels.baselines_section_placeholder && (C.innerHTML = \"\");\n          const D = g.getTask(g._lightbox_id);\n          x(C, {\n            id: g.uid(),\n            task_id: D.id,\n            start_date: D.start_date,\n            end_date: D.end_date\n          }, D, g._get_typed_lightbox_config()[S]);\n        }\n      }, f.prototype.focus = function (S) {\n        g._focus(S.getElementsByTagName(\"select\")[0]);\n      }, f;\n    }(t);\n  t._lightbox_methods = {}, t._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\", t._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>`, t._lightbox_root = t.$root, t.$services.getService(\"state\").registerProvider(\"lightbox\", function () {\n    return {\n      lightbox: t._lightbox_id\n    };\n  }), t.showLightbox = function (g) {\n    var m = this.getTask(g);\n    if (this.callEvent(\"onBeforeLightbox\", [g])) {\n      var f = this.getLightbox(this.getTaskType(m.type));\n      this.showCover(f), this._fill_lightbox(g, f), this._setLbPosition(f), this._waiAria.lightboxVisibleAttr(f), this.callEvent(\"onLightbox\", [g]);\n    } else t.isTaskExists(g) && t.getTask(g).$new && this.$data.tasksStore._updateOrder();\n  }, t._get_timepicker_step = function () {\n    if (this.config.round_dnd_dates) {\n      var g;\n      if (function (f) {\n        var v = f.$ui.getView(\"timeline\");\n        return !(!v || !v.isVisible());\n      }(this)) {\n        var m = t.getScale();\n        g = Vt(m.unit) * m.step / 60;\n      }\n      return (!g || g >= 1440) && (g = this.config.time_step), g;\n    }\n    return this.config.time_step;\n  }, t.getLabel = function (g, m) {\n    for (var f = this._get_typed_lightbox_config(), v = 0; v < f.length; v++) if (f[v].map_to == g) {\n      for (var x = f[v].options, $ = 0; $ < x.length; $++) if (x[$].key == m) return x[$].label;\n    }\n    return \"\";\n  }, t.updateCollection = function (g, m) {\n    m = m.slice(0);\n    var f = t.serverList(g);\n    if (!f) return !1;\n    f.splice(0, f.length), f.push.apply(f, m || []), t.resetLightbox();\n  }, t.getLightboxType = function () {\n    return this.getTaskType(this._lightbox_type);\n  }, t.getLightbox = function (g) {\n    var m,\n      f,\n      v,\n      x,\n      $,\n      w = \"\";\n    if (t.config.csp === !0 || t.env.isSalesforce ? t._lightbox_root = t.$root : t._lightbox_root = document.body, g === void 0 && (g = this.getLightboxType()), !this._lightbox || this.getLightboxType() != this.getTaskType(g)) {\n      this._lightbox_type = this.getTaskType(g), m = document.createElement(\"div\"), w = \"gantt_cal_light\", f = this._is_lightbox_timepicker(), t.config.wide_form && (w += \" gantt_cal_light_wide\"), f && (w += \" gantt_cal_light_full\"), m.className = w, m.style.visibility = \"hidden\", v = this._lightbox_template, v += \"<div class='gantt_cal_lcontrols'>\", v += y(this.config.buttons_left), v += \"<div class='gantt_cal_lcontrols_push_right'></div>\", v += y(this.config.buttons_right), v += \"</div>\", m.innerHTML = v, t._waiAria.lightboxAttr(m), t.config.drag_lightbox && (m.firstChild.onmousedown = t._ready_to_dnd, m.firstChild.ontouchstart = function (T) {\n        t._ready_to_dnd(T.touches[0]);\n      }, m.firstChild.onselectstart = function () {\n        return !1;\n      }, m.firstChild.style.cursor = \"pointer\", t._init_dnd_events()), this._lightbox && this.resetLightbox(), _(), this._cover.insertBefore(m, this._cover.firstChild), this._lightbox = m, x = this._get_typed_lightbox_config(g), v = this._render_sections(x);\n      var S = ($ = m.querySelector(\"div.gantt_cal_larea\")).style.overflow;\n      $.style.overflow = \"hidden\", $.innerHTML = v, function (T) {\n        var E, C, D, M, I, A;\n        for (A = 0; A < T.length; A++) E = T[A], D = t._lightbox_root.querySelector(\"#\" + E.id), E.id && D && (C = D.querySelector(\"label\"), (M = D.nextSibling) && (I = M.querySelector(\"input, select, textarea\")) && (I.id = I.id || \"input_\" + t.uid(), E.inputId = I.id, C.setAttribute(\"for\", E.inputId)));\n      }(x), $.style.overflow = S, this._init_lightbox_events(this), m.style.display = \"none\", m.style.visibility = \"visible\";\n    }\n    return this._lightbox;\n  }, t._render_sections = function (g) {\n    for (var m = \"\", f = 0; f < g.length; f++) {\n      var v = this.form_blocks[g[f].type];\n      if (v) {\n        g[f].id = \"area_\" + this.uid();\n        var x = g[f].hidden ? \" style='display:none'\" : \"\",\n          $ = \"\";\n        g[f].button && ($ = \"<div class='gantt_custom_button' data-index='\" + f + \"'><div class='gantt_custom_button_\" + g[f].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + g[f].button] + \"</div></div>\"), g[f].type == \"baselines\" && ($ = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + f + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div><div class='gantt_custom_button gantt_add_baselines' data-index='\" + f + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\"), this.config.wide_form && (m += \"<div class='gantt_wrap_section' \" + x + \">\"), m += \"<div id='\" + g[f].id + \"' class='gantt_cal_lsection'><label>\" + $ + (g[f].label || this.locale.labels[\"section_\" + g[f].name] || g[f].name) + \"</label></div>\" + v.render.call(this, g[f]), m += \"</div>\";\n      }\n    }\n    return m;\n  }, t._center_lightbox = function (g) {\n    t._setLbPosition(g);\n  }, t._setLbPosition = function (g) {\n    if (!g) return;\n    const m = t._lightbox_root || t.$root;\n    g.style.top = Math.max(m.offsetHeight / 2 - g.offsetHeight / 2, 0) + \"px\", g.style.left = Math.max(m.offsetWidth / 2 - g.offsetWidth / 2, 0) + \"px\";\n  }, t.showCover = function (g) {\n    g && (g.style.display = \"block\", this._setLbPosition(g)), _(), this._cover.style.display = \"\";\n  };\n  const _ = function () {\n    t._cover || (t._cover = document.createElement(\"div\"), t._cover.className = \"gantt_cal_cover\", t._cover.style.display = \"none\", t.event(t._cover, \"mousemove\", t._move_while_dnd), t.event(t._cover, \"mouseup\", t._finish_dnd), (t._lightbox_root || t.$root).appendChild(t._cover));\n  };\n  function p(g) {\n    for (var m in this.config.types) if (this.config.types[m] == g) return m;\n    return \"task\";\n  }\n  function y(g, m) {\n    var f,\n      v,\n      x = \"\";\n    for (v = 0; v < g.length; v++) f = t.config._migrate_buttons[g[v]] ? t.config._migrate_buttons[g[v]] : g[v], x += \"<div \" + t._waiAria.lightboxButtonAttrString(f) + \" class='gantt_btn_set gantt_left_btn_set \" + f + \"_set'><div dhx_button='1' data-dhx-button='1' class='\" + f + \"'></div><div>\" + t.locale.labels[f] + \"</div></div>\";\n    return x;\n  }\n  function k(g) {\n    var m, f;\n    return g.time_format ? g.time_format : (f = [\"%d\", \"%m\", \"%Y\"], Vt((m = t.getScale()) ? m.unit : t.config.duration_unit) < Vt(\"day\") && f.push(\"%H:%i\"), f);\n  }\n  function b(g, m, f) {\n    var v,\n      x,\n      $,\n      w,\n      S,\n      T,\n      E = \"\";\n    switch (f.timeFormat[m]) {\n      case \"%Y\":\n        for (g._time_format_order[2] = m, g._time_format_order.size++, g.year_range && (isNaN(g.year_range) ? g.year_range.push && ($ = g.year_range[0], w = g.year_range[1]) : v = g.year_range), v = v || 10, x = x || Math.floor(v / 2), $ = $ || f.date.getFullYear() - x, w = w || t.getState().max_date.getFullYear() + x, S = $; S <= w; S++) E += \"<option value='\" + S + \"'>\" + S + \"</option>\";\n        break;\n      case \"%m\":\n        for (g._time_format_order[1] = m, g._time_format_order.size++, S = 0; S < 12; S++) E += \"<option value='\" + S + \"'>\" + t.locale.date.month_full[S] + \"</option>\";\n        break;\n      case \"%d\":\n        for (g._time_format_order[0] = m, g._time_format_order.size++, S = 1; S < 32; S++) E += \"<option value='\" + S + \"'>\" + S + \"</option>\";\n        break;\n      case \"%H:%i\":\n        for (g._time_format_order[3] = m, g._time_format_order.size++, S = f.first, T = f.date.getDate(), g._time_values = []; S < f.last;) E += \"<option value='\" + S + \"'>\" + t.templates.time_picker(f.date) + \"</option>\", g._time_values.push(S), f.date.setTime(f.date.valueOf() + 60 * t._get_timepicker_step() * 1e3), S = 24 * (f.date.getDate() != T ? 1 : 0) * 60 + 60 * f.date.getHours() + f.date.getMinutes();\n    }\n    return E;\n  }\n  t._init_lightbox_events = function () {\n    t.lightbox_events = {}, t.lightbox_events.gantt_save_btn = function () {\n      t._save_lightbox();\n    }, t.lightbox_events.gantt_delete_btn = function () {\n      t._lightbox_current_type = null, t.callEvent(\"onLightboxDelete\", [t._lightbox_id]) && (t.isTaskExists(t._lightbox_id) ? t.$click.buttons.delete(t._lightbox_id) : t.hideLightbox());\n    }, t.lightbox_events.gantt_cancel_btn = function () {\n      t._cancel_lightbox();\n    }, t.lightbox_events.default = function (g, m) {\n      if (m.getAttribute(\"data-dhx-button\")) t.callEvent(\"onLightboxButton\", [m.className, m, g]);else {\n        var f,\n          v,\n          x = X(m);\n        if (x.indexOf(\"gantt_custom_button\") != -1) if (x.indexOf(\"gantt_custom_button_\") != -1) for (f = m.parentNode.getAttribute(\"data-index\"), v = m; v && X(v).indexOf(\"gantt_cal_lsection\") == -1;) v = v.parentNode;else f = m.getAttribute(\"data-index\"), v = m.closest(\".gantt_cal_lsection\"), m = m.firstChild;\n        var $ = t._get_typed_lightbox_config();\n        f && (f *= 1, t.form_blocks[$[1 * f].type].button_click(f, m, v, v.nextSibling));\n      }\n    }, this.event(t.getLightbox(), \"click\", function (g) {\n      g.target.closest(\".gantt_cal_ltitle_close_btn\") && t._cancel_lightbox();\n      var m = yt(g),\n        f = X(m);\n      return f || (f = X(m = m.previousSibling)), m && f && f.indexOf(\"gantt_btn_set\") === 0 && (f = X(m = m.firstChild)), !(!m || !f) && (t.defined(t.lightbox_events[m.className]) ? t.lightbox_events[m.className] : t.lightbox_events.default)(g, m);\n    }), t.getLightbox().onkeydown = function (g) {\n      var m = g || window.event,\n        f = g.target || g.srcElement,\n        v = X(f).indexOf(\"gantt_btn_set\") > -1;\n      switch ((g || m).keyCode) {\n        case t.constants.KEY_CODES.SPACE:\n          if ((g || m).shiftKey) return;\n          v && f.click && f.click();\n          break;\n        case t.keys.edit_save:\n          if ((g || m).shiftKey) return;\n          v && f.click ? f.click() : t._save_lightbox();\n          break;\n        case t.keys.edit_cancel:\n          t._cancel_lightbox();\n      }\n    };\n  }, t._cancel_lightbox = function () {\n    var g = this.getLightboxValues();\n    t._lightbox_current_type = null, this.callEvent(\"onLightboxCancel\", [this._lightbox_id, g.$new]), t.isTaskExists(g.id) && g.$new && (this.silent(function () {\n      t.$data.tasksStore.removeItem(g.id), t._update_flags(g.id, null);\n    }), this.refreshData()), this.hideLightbox();\n  }, t._save_lightbox = function () {\n    var g = this.getLightboxValues();\n    t._lightbox_current_type = null, this.callEvent(\"onLightboxSave\", [this._lightbox_id, g, !!g.$new]) && (t.$data.tasksStore._skipTaskRecalculation = \"lightbox\", g.$new ? (delete g.$new, this.addTask(g, g.parent, this.getTaskIndex(g.id))) : this.isTaskExists(g.id) && (this.mixin(this.getTask(g.id), g, !0), this.refreshTask(g.id), this.updateTask(g.id)), t.$data.tasksStore._skipTaskRecalculation = !1, this.refreshData(), this.hideLightbox());\n  }, t._resolve_default_mapping = function (g) {\n    var m = g.map_to;\n    return {\n      time: !0,\n      time_optional: !0,\n      duration: !0,\n      duration_optional: !0\n    }[g.type] ? g.map_to == \"auto\" ? m = {\n      start_date: \"start_date\",\n      end_date: \"end_date\",\n      duration: \"duration\"\n    } : typeof g.map_to == \"string\" && (m = {\n      start_date: g.map_to\n    }) : g.type === \"constraint\" && (g.map_to && typeof g.map_to != \"string\" || (m = {\n      constraint_type: \"constraint_type\",\n      constraint_date: \"constraint_date\"\n    })), m;\n  }, t.getLightboxValues = function () {\n    let g = {};\n    t.isTaskExists(this._lightbox_id) && (g = this.mixin({}, this.getTask(this._lightbox_id)));\n    const m = [...this._get_typed_lightbox_config()].sort((f, v) => f.name === \"time\" ? 1 : v.name === \"time\" ? -1 : 0);\n    for (let f = 0; f < m.length; f++) {\n      let v = t._lightbox_root.querySelector(\"#\" + m[f].id);\n      v = v && v.nextSibling;\n      let x = this.form_blocks[m[f].type];\n      if (!x) continue;\n      let $ = x.get_value.call(this, v, g, m[f]),\n        w = t._resolve_default_mapping(m[f]);\n      if (typeof w == \"string\" && w != \"auto\") g[w] = $;else if (typeof w == \"object\") for (let S in w) w[S] && (g[w[S]] = $[S]);\n    }\n    return t._lightbox_current_type && (g.type = t._lightbox_current_type), g;\n  }, t.hideLightbox = function () {\n    var g = this.getLightbox();\n    g && (g.style.display = \"none\"), this._waiAria.lightboxHiddenAttr(g), this._lightbox_id = null, this.hideCover(g), this.resetLightbox(), this.callEvent(\"onAfterLightbox\", []);\n  }, t.hideCover = function (g) {\n    g && (g.style.display = \"none\"), this._cover && this._cover.parentNode.removeChild(this._cover), this._cover = null;\n  }, t.resetLightbox = function () {\n    t._lightbox && !t._custom_lightbox && t._lightbox.remove(), t._lightbox = null;\n  }, t._set_lightbox_values = function (g, m) {\n    var f = g,\n      v = m.getElementsByTagName(\"span\"),\n      x = [];\n    t.templates.lightbox_header ? (x.push(\"\"), x.push(t.templates.lightbox_header(f.start_date, f.end_date, f)), v[1].innerHTML = \"\", v[2].innerHTML = t.templates.lightbox_header(f.start_date, f.end_date, f)) : (x.push(this.templates.task_time(f.start_date, f.end_date, f)), x.push(String(this.templates.task_text(f.start_date, f.end_date, f) || \"\").substr(0, 70)), v[1].innerHTML = this.templates.task_time(f.start_date, f.end_date, f), v[2].innerHTML = String(this.templates.task_text(f.start_date, f.end_date, f) || \"\").substr(0, 70)), v[1].innerHTML = x[0], v[2].innerHTML = x[1], t._waiAria.lightboxHeader(m, x.join(\" \"));\n    for (var $ = this._get_typed_lightbox_config(this.getLightboxType()), w = 0; w < $.length; w++) {\n      var S = $[w];\n      if (this.form_blocks[S.type]) {\n        var T = t._lightbox_root.querySelector(\"#\" + S.id).nextSibling,\n          E = this.form_blocks[S.type],\n          C = t._resolve_default_mapping($[w]),\n          D = this.defined(f[C]) ? f[C] : S.default_value;\n        E.set_value.call(t, T, D, f, S), S.focus && E.focus.call(t, T);\n      }\n    }\n    t.isTaskExists(g.id) && (t._lightbox_id = g.id);\n  }, t._fill_lightbox = function (g, m) {\n    var f = this.getTask(g);\n    this._set_lightbox_values(f, m);\n  }, t.getLightboxSection = function (g) {\n    for (var m = this._get_typed_lightbox_config(), f = 0; f < m.length && m[f].name != g; f++);\n    var v = m[f];\n    if (!v) return null;\n    this._lightbox || this.getLightbox();\n    var x = t._lightbox_root.querySelector(\"#\" + v.id),\n      $ = x.nextSibling,\n      w = {\n        section: v,\n        header: x,\n        node: $,\n        getValue: function (T) {\n          return t.form_blocks[v.type].get_value.call(t, $, T || {}, v);\n        },\n        setValue: function (T, E) {\n          return t.form_blocks[v.type].set_value.call(t, $, T, E || {}, v);\n        }\n      },\n      S = this._lightbox_methods[\"get_\" + v.type + \"_control\"];\n    return S ? S(w) : w;\n  }, t._lightbox_methods.get_template_control = function (g) {\n    return g.control = g.node, g;\n  }, t._lightbox_methods.get_select_control = function (g) {\n    return g.control = g.node.getElementsByTagName(\"select\")[0], g;\n  }, t._lightbox_methods.get_textarea_control = function (g) {\n    return g.control = g.node.getElementsByTagName(\"textarea\")[0], g;\n  }, t._lightbox_methods.get_time_control = function (g) {\n    return g.control = g.node.getElementsByTagName(\"select\"), g;\n  }, t._init_dnd_events = function () {\n    var g = t._lightbox_root;\n    this.event(g, \"mousemove\", t._move_while_dnd), this.event(g, \"mouseup\", t._finish_dnd), this.event(g, \"touchmove\", function (m) {\n      t._move_while_dnd(m.touches[0]);\n    }), this.event(g, \"touchend\", function (m) {\n      t._finish_dnd(m.touches[0]);\n    });\n  }, t._move_while_dnd = function (g) {\n    if (t._dnd_start_lb) {\n      document.gantt_unselectable || (t._lightbox_root.className += \" gantt_unselectable\", document.gantt_unselectable = !0);\n      var m = t.getLightbox(),\n        f = [g.pageX, g.pageY];\n      m.style.top = t._lb_start[1] + f[1] - t._dnd_start_lb[1] + \"px\", m.style.left = t._lb_start[0] + f[0] - t._dnd_start_lb[0] + \"px\";\n    }\n  }, t._ready_to_dnd = function (g) {\n    var m = t.getLightbox();\n    t._lb_start = [m.offsetLeft, m.offsetTop], t._dnd_start_lb = [g.pageX, g.pageY];\n  }, t._finish_dnd = function () {\n    t._lb_start && (t._lb_start = t._dnd_start_lb = !1, t._lightbox_root.className = t._lightbox_root.className.replace(\" gantt_unselectable\", \"\"), document.gantt_unselectable = !1);\n  }, t._focus = function (g, m) {\n    if (g && g.focus && !t.config.touch) try {\n      m && g.select && g.select(), g.focus();\n    } catch {}\n  }, t.form_blocks = {\n    getTimePicker: function (g, m) {\n      var f,\n        v,\n        x,\n        $ = \"\",\n        w = this.config,\n        S = {\n          first: 0,\n          last: 1440,\n          date: this.date.date_part(new Date(t._min_date.valueOf())),\n          timeFormat: k(g)\n        };\n      for (g._time_format_order = {\n        size: 0\n      }, t.config.limit_time_select && (S.first = 60 * w.first_hour, S.last = 60 * w.last_hour + 1, S.date.setHours(w.first_hour)), f = 0; f < S.timeFormat.length; f++) f > 0 && ($ += \" \"), (v = b(g, f, S)) && (x = t._waiAria.lightboxSelectAttrString(S.timeFormat[f]), $ += \"<select \" + (g.readonly ? \"disabled='disabled'\" : \"\") + (m ? \" style='display:none' \" : \"\") + x + \">\" + v + \"</select>\");\n      return $;\n    },\n    getTimePickerValue: function (g, m, f) {\n      var v,\n        x = m._time_format_order,\n        $ = 0,\n        w = 0,\n        S = f || 0;\n      return t.defined(x[3]) && (v = parseInt(g[x[3] + S].value, 10), $ = Math.floor(v / 60), w = v % 60), new Date(g[x[2] + S].value, g[x[1] + S].value, g[x[0] + S].value, $, w);\n    },\n    _fill_lightbox_select: function (g, m, f, v) {\n      if (g[m + v[0]].value = f.getDate(), g[m + v[1]].value = f.getMonth(), g[m + v[2]].value = f.getFullYear(), t.defined(v[3])) {\n        var x = 60 * f.getHours() + f.getMinutes();\n        x = Math.round(x / t._get_timepicker_step()) * t._get_timepicker_step();\n        var $ = g[m + v[3]];\n        $.value = x, $.setAttribute(\"data-value\", x);\n      }\n    },\n    template: new e(),\n    textarea: new n(),\n    select: new a(),\n    time: new i(),\n    duration: new o(),\n    parent: new l(),\n    radio: new s(),\n    checkbox: new r(),\n    resources: new c(),\n    constraint: new d(),\n    baselines: new h(),\n    typeselect: new u()\n  }, t._is_lightbox_timepicker = function () {\n    for (var g = this._get_typed_lightbox_config(), m = 0; m < g.length; m++) if (g[m].name == \"time\" && g[m].type == \"time\") return !0;\n    return !1;\n  }, t._delete_task_confirm = function ({\n    task: g,\n    message: m,\n    title: f,\n    callback: v,\n    ok: x\n  }) {\n    t._simple_confirm(m, f, v, x);\n  }, t._delete_link_confirm = function ({\n    link: g,\n    message: m,\n    title: f,\n    callback: v,\n    ok: x\n  }) {\n    t._simple_confirm(m, f, v, x);\n  }, t._simple_confirm = function (g, m, f, v) {\n    if (!g) return f();\n    var x = {\n      text: g\n    };\n    m && (x.title = m), v && (x.ok = v), f && (x.callback = function ($) {\n      $ && f();\n    }), t.confirm(x);\n  }, t._get_typed_lightbox_config = function (g) {\n    g === void 0 && (g = this.getLightboxType());\n    var m = p.call(this, g);\n    return t.config.lightbox[m + \"_sections\"] ? t.config.lightbox[m + \"_sections\"] : t.config.lightbox.sections;\n  }, t._silent_redraw_lightbox = function (g) {\n    var m = this.getLightboxType();\n    if (this.getState().lightbox) {\n      var f = this.getState().lightbox,\n        v = this.getLightboxValues(),\n        x = this.copy(this.getTask(f));\n      this.resetLightbox();\n      var $ = this.mixin(x, v, !0),\n        w = this.getLightbox(g || void 0);\n      this._set_lightbox_values($, w), this.showCover(w);\n    } else this.resetLightbox(), this.getLightbox(g || void 0);\n    this.callEvent(\"onLightboxChange\", [m, this.getLightboxType()]);\n  };\n}\nfunction Ka(t) {\n  if (!mt.isNode) {\n    t.utils = {\n      arrayFind: Ln,\n      dom: rn\n    };\n    var e = Se();\n    t.event = e.attach, t.eventRemove = e.detach, t._eventRemoveAll = e.detachAll, t._createDomEventScope = e.extend, P(t, sa(t));\n    var n = ja.init(t);\n    t.$ui = n.factory, t.$ui.layers = n.render, t.$mouseEvents = n.mouseEvents, t.$services.setService(\"mouseEvents\", function () {\n      return t.$mouseEvents;\n    }), t.mixin(t, n.layersApi), function (i) {\n      delete i.addTaskLayer, delete i.addLinkLayer;\n    }(t), t.$services.setService(\"layers\", function () {\n      return n.layersService;\n    }), t.mixin(t, /* @__PURE__ */function () {\n      function i(u) {\n        return u.$ui.getView(\"timeline\");\n      }\n      function a(u) {\n        return u.$ui.getView(\"grid\");\n      }\n      function r(u) {\n        var h = i(u);\n        if (h && !h.$config.hidden) return h;\n        var _ = a(u);\n        return _ && !_.$config.hidden ? _ : null;\n      }\n      function s(u) {\n        var h = null,\n          _ = !1;\n        return [\".gantt_drag_marker.gantt_grid_resize_area\", \".gantt_drag_marker .gantt_row.gantt_row_task\", \".gantt_drag_marker.gantt_grid_dnd_marker\"].forEach(function (p) {\n          _ = _ || !!document.querySelector(p);\n        }), (h = _ ? a(u) : r(u)) ? l(u, h, \"scrollY\") : null;\n      }\n      function o(u) {\n        var h = r(u);\n        return h && h.id != \"grid\" ? l(u, h, \"scrollX\") : null;\n      }\n      function l(u, h, _) {\n        var p = h.$config[_];\n        return u.$ui.getView(p);\n      }\n      var c = \"DEFAULT_VALUE\";\n      function d(u, h, _, p) {\n        var y = u(this);\n        return y && y.isVisible() ? y[h].apply(y, _) : p ? p() : c;\n      }\n      return {\n        getColumnIndex: function (u) {\n          var h = d.call(this, a, \"getColumnIndex\", [u]);\n          return h === c ? 0 : h;\n        },\n        dateFromPos: function (u) {\n          var h = d.call(this, i, \"dateFromPos\", Array.prototype.slice.call(arguments));\n          return h === c ? this.getState().min_date : h;\n        },\n        posFromDate: function (u) {\n          var h = d.call(this, i, \"posFromDate\", [u]);\n          return h === c ? 0 : h;\n        },\n        getRowTop: function (u) {\n          var h = this,\n            _ = d.call(h, i, \"getRowTop\", [u], function () {\n              return d.call(h, a, \"getRowTop\", [u]);\n            });\n          return _ === c ? 0 : _;\n        },\n        getTaskTop: function (u) {\n          var h = this,\n            _ = d.call(h, i, \"getItemTop\", [u], function () {\n              return d.call(h, a, \"getItemTop\", [u]);\n            });\n          return _ === c ? 0 : _;\n        },\n        getTaskPosition: function (u, h, _) {\n          var p = d.call(this, i, \"getItemPosition\", [u, h, _]);\n          return p === c ? {\n            left: 0,\n            top: this.getTaskTop(u.id),\n            height: this.getTaskBarHeight(u.id),\n            width: 0\n          } : p;\n        },\n        getTaskBarHeight: function (u, h) {\n          var _ = this,\n            p = d.call(_, i, \"getBarHeight\", [u, h], function () {\n              return d.call(_, a, \"getItemHeight\", [u]);\n            });\n          return p === c ? 0 : p;\n        },\n        getTaskHeight: function (u) {\n          var h = this,\n            _ = d.call(h, i, \"getItemHeight\", [u], function () {\n              return d.call(h, a, \"getItemHeight\", [u]);\n            });\n          return _ === c ? 0 : _;\n        },\n        columnIndexByDate: function (u) {\n          var h = d.call(this, i, \"columnIndexByDate\", [u]);\n          return h === c ? 0 : h;\n        },\n        roundTaskDates: function () {\n          d.call(this, i, \"roundTaskDates\", []);\n        },\n        getScale: function () {\n          var u = d.call(this, i, \"getScale\", []);\n          return u === c ? null : u;\n        },\n        getTaskNode: function (u) {\n          var h = i(this);\n          if (h && h.isVisible()) {\n            var _ = h._taskRenderer.rendered[u];\n            if (!_) {\n              var p = h.$config.item_attribute;\n              _ = h.$task_bars.querySelector(\"[\" + p + \"='\" + u + \"']\");\n            }\n            return _ || null;\n          }\n          return null;\n        },\n        getLinkNode: function (u) {\n          var h = i(this);\n          return h.isVisible() ? h._linkRenderer.rendered[u] : null;\n        },\n        scrollTo: function (u, h) {\n          var _ = s(this),\n            p = o(this),\n            y = {\n              position: 0\n            },\n            k = {\n              position: 0\n            };\n          _ && (k = _.getScrollState()), p && (y = p.getScrollState());\n          var b = p && 1 * u == u,\n            g = _ && 1 * h == h;\n          if (b && g) for (var m = _._getLinkedViews(), f = p._getLinkedViews(), v = [], x = 0; x < m.length; x++) for (var $ = 0; $ < f.length; $++) m[x].$config.id && f[$].$config.id && m[x].$config.id === f[$].$config.id && v.push(m[x].$config.id);\n          b && (v && v.forEach(function (T) {\n            this.$ui.getView(T).$config.$skipSmartRenderOnScroll = !0;\n          }.bind(this)), p.scroll(u), v && v.forEach(function (T) {\n            this.$ui.getView(T).$config.$skipSmartRenderOnScroll = !1;\n          }.bind(this))), g && _.scroll(h);\n          var w = {\n              position: 0\n            },\n            S = {\n              position: 0\n            };\n          _ && (w = _.getScrollState()), p && (S = p.getScrollState()), this.callEvent(\"onGanttScroll\", [y.position, k.position, S.position, w.position]);\n        },\n        showDate: function (u) {\n          var h = this.posFromDate(u),\n            _ = Math.max(h - this.config.task_scroll_offset, 0);\n          this.scrollTo(_);\n        },\n        showTask: function (u) {\n          var h = this.getTaskPosition(this.getTask(u)),\n            _ = h.left;\n          this.config.rtl && (_ = h.left + h.width);\n          var p,\n            y = Math.max(_ - this.config.task_scroll_offset, 0),\n            k = this._scroll_state().y;\n          p = k ? h.top - (k - this.getTaskBarHeight(u)) / 2 : h.top, this.scrollTo(y, p);\n          var b = a(this),\n            g = i(this);\n          b && g && b.$config.scrollY != g.$config.scrollY && l(this, b, \"scrollY\").scrollTo(null, p);\n        },\n        _scroll_state: function () {\n          var u = {\n              x: !1,\n              y: !1,\n              x_pos: 0,\n              y_pos: 0,\n              scroll_size: this.config.scroll_size + 1,\n              x_inner: 0,\n              y_inner: 0\n            },\n            h = s(this),\n            _ = o(this);\n          if (_) {\n            var p = _.getScrollState();\n            p.visible && (u.x = p.size, u.x_inner = p.scrollSize), u.x_pos = p.position || 0;\n          }\n          if (h) {\n            var y = h.getScrollState();\n            y.visible && (u.y = y.size, u.y_inner = y.scrollSize), u.y_pos = y.position || 0;\n          }\n          return u;\n        },\n        getScrollState: function () {\n          var u = this._scroll_state();\n          return {\n            x: u.x_pos,\n            y: u.y_pos,\n            inner_width: u.x,\n            inner_height: u.y,\n            width: u.x_inner,\n            height: u.y_inner\n          };\n        },\n        getLayoutView: function (u) {\n          return this.$ui.getView(u);\n        },\n        scrollLayoutCell: function (u, h, _) {\n          const p = this.$ui.getView(u);\n          if (!p) return !1;\n          if (h !== null) {\n            const y = this.$ui.getView(p.$config.scrollX);\n            y && y.scrollTo(h, null);\n          }\n          if (_ !== null) {\n            const y = this.$ui.getView(p.$config.scrollY);\n            y && y.scrollTo(null, _);\n          }\n        }\n      };\n    }()), function (i) {\n      i.resetSkin || (i.resetSkin = function () {\n        this.skin = \"\", ce(!0, this);\n      }, i.skins = {}, i.attachEvent(\"onGanttLayoutReady\", function () {\n        ce(!1, this), r();\n      })), i._addThemeClass = function () {\n        document.documentElement.setAttribute(\"data-gantt-theme\", i.skin);\n      }, i.setSkin = function (s) {\n        const o = this.skin !== s;\n        this.skin = s, i._addThemeClass(), r(), i.$root && (ce(!o, i), this.render());\n      };\n      let a = null;\n      function r() {\n        const s = i.$root;\n        a && clearInterval(a), s && (a = setInterval(() => {\n          const o = getComputedStyle(s).getPropertyValue(\"--dhx-gantt-theme\");\n          o && o !== i.skin && i.setSkin(o);\n        }, 100));\n      }\n      i.attachEvent(\"onDestroy\", function () {\n        clearInterval(a);\n      });\n    }(t), function (i) {\n      i.skins.skyblue = {\n        config: {\n          grid_width: 370,\n          row_height: 27,\n          bar_height_padding: 4,\n          scale_height: 27,\n          link_line_width: 1,\n          link_arrow_size: 8,\n          link_radius: 2,\n          lightbox_additional_height: 75\n        },\n        _second_column_width: 95,\n        _third_column_width: 80\n      };\n    }(t), function (i) {\n      i.skins.dark = {\n        config: {\n          grid_width: 390,\n          row_height: 36,\n          scale_height: 36,\n          link_line_width: 2,\n          link_arrow_size: 12,\n          bar_height_padding: 9,\n          lightbox_additional_height: 75\n        },\n        _second_column_width: 100,\n        _third_column_width: 70\n      };\n    }(t), function (i) {\n      i.skins.meadow = {\n        config: {\n          grid_width: 380,\n          row_height: 27,\n          scale_height: 30,\n          link_line_width: 2,\n          link_arrow_size: 10,\n          bar_height_padding: 4,\n          lightbox_additional_height: 72\n        },\n        _second_column_width: 95,\n        _third_column_width: 80\n      };\n    }(t), function (i) {\n      i.skins.terrace = {\n        config: {\n          grid_width: 390,\n          row_height: 36,\n          scale_height: 36,\n          link_line_width: 2,\n          link_arrow_size: 12,\n          bar_height_padding: 9,\n          lightbox_additional_height: 75\n        },\n        _second_column_width: 100,\n        _third_column_width: 70\n      };\n    }(t), function (i) {\n      i.skins.broadway = {\n        config: {\n          grid_width: 390,\n          row_height: 35,\n          scale_height: 35,\n          link_line_width: 1,\n          link_arrow_size: 9,\n          bar_height_padding: 4,\n          lightbox_additional_height: 86\n        },\n        _second_column_width: 100,\n        _third_column_width: 80,\n        _lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\n        _config_buttons_left: {},\n        _config_buttons_right: {\n          gantt_delete_btn: \"icon_delete\",\n          gantt_save_btn: \"icon_save\"\n        }\n      };\n    }(t), function (i) {\n      i.skins.material = {\n        config: {\n          grid_width: 411,\n          row_height: 34,\n          scale_height: 36,\n          link_line_width: 2,\n          link_arrow_size: 12,\n          bar_height_padding: 9,\n          lightbox_additional_height: 80\n        },\n        _second_column_width: 110,\n        _third_column_width: 75,\n        _redefine_lightbox_buttons: {\n          buttons_left: [\"dhx_delete_btn\"],\n          buttons_right: [\"dhx_cancel_btn\", \"dhx_save_btn\"]\n        }\n      }, i.attachEvent(\"onAfterTaskDrag\", function (a) {\n        var r = i.getTaskNode(a);\n        r && (r.className += \" gantt_drag_animation\", setTimeout(function () {\n          var s = r.className.indexOf(\" gantt_drag_animation\");\n          s > -1 && (r.className = r.className.slice(0, s));\n        }, 200));\n      });\n    }(t), function (i) {\n      i.skins.contrast_black = {\n        config: {\n          grid_width: 390,\n          row_height: 35,\n          scale_height: 35,\n          link_line_width: 2,\n          link_arrow_size: 12,\n          lightbox_additional_height: 75\n        },\n        _second_column_width: 100,\n        _third_column_width: 80\n      };\n    }(t), function (i) {\n      i.skins.contrast_white = {\n        config: {\n          grid_width: 390,\n          row_height: 35,\n          scale_height: 35,\n          link_line_width: 2,\n          link_arrow_size: 12,\n          lightbox_additional_height: 75\n        },\n        _second_column_width: 100,\n        _third_column_width: 80\n      };\n    }(t), function (i) {\n      i.ext || (i.ext = {});\n      for (var a = [Fa, null, null], r = 0; r < a.length; r++) a[r] && a[r](i);\n      i.ext.zoom = new qa(i);\n    }(t), Ga(t), Ja(t), function (i) {\n      i._extend_to_optional = function (a) {\n        var r = a,\n          s = {\n            render: r.render,\n            focus: r.focus,\n            set_value: function (o, l, c, d) {\n              var u = i._resolve_default_mapping(d);\n              if (!c[u.start_date] || u.start_date == \"start_date\" && this._isAllowedUnscheduledTask(c)) {\n                s.disable(o, d);\n                var h = {};\n                for (var _ in u) h[u[_]] = c[_];\n                return r.set_value.call(i, o, l, h, d);\n              }\n              return s.enable(o, d), r.set_value.call(i, o, l, c, d);\n            },\n            get_value: function (o, l, c) {\n              return c.disabled ? {\n                start_date: null\n              } : r.get_value.call(i, o, l, c);\n            },\n            update_block: function (o, l) {\n              if (i.callEvent(\"onSectionToggle\", [i._lightbox_id, l]), o.style.display = l.disabled ? \"none\" : \"\", l.button) {\n                var c = o.previousSibling.querySelector(\".gantt_custom_button_label\"),\n                  d = i.locale.labels,\n                  u = l.disabled ? d[l.name + \"_enable_button\"] : d[l.name + \"_disable_button\"];\n                c.innerHTML = u;\n              }\n            },\n            disable: function (o, l) {\n              l.disabled = !0, s.update_block(o, l);\n            },\n            enable: function (o, l) {\n              l.disabled = !1, s.update_block(o, l);\n            },\n            button_click: function (o, l, c, d) {\n              if (i.callEvent(\"onSectionButton\", [i._lightbox_id, c]) !== !1) {\n                var u = i._get_typed_lightbox_config()[o];\n                u.disabled ? s.enable(d, u) : s.disable(d, u);\n              }\n            }\n          };\n        return s;\n      }, i.form_blocks.duration_optional = i._extend_to_optional(i.form_blocks.duration), i.form_blocks.time_optional = i._extend_to_optional(i.form_blocks.time);\n    }(t), function (i) {\n      var a = new RegExp(`<(?:.|\n)*?>`, \"gm\"),\n        r = new RegExp(\" +\", \"gm\");\n      function s(d) {\n        return (d + \"\").replace(a, \" \").replace(r, \" \");\n      }\n      var o = new RegExp(\"'\", \"gm\");\n      function l(d) {\n        return (d + \"\").replace(o, \"&#39;\");\n      }\n      for (var c in i._waiAria = {\n        getAttributeString: function (d) {\n          var u = [\" \"];\n          for (var h in d) {\n            var _ = l(s(d[h]));\n            u.push(h + \"='\" + _ + \"'\");\n          }\n          return u.push(\" \"), u.join(\" \");\n        },\n        getTimelineCellAttr: function (d) {\n          return i._waiAria.getAttributeString({\n            \"aria-label\": d\n          });\n        },\n        _taskCommonAttr: function (d, u) {\n          d.start_date && d.end_date && (u.setAttribute(\"aria-label\", s(i.templates.tooltip_text(d.start_date, d.end_date, d))), d.$dataprocessor_class && u.setAttribute(\"aria-busy\", !0));\n        },\n        setTaskBarAttr: function (d, u) {\n          this._taskCommonAttr(d, u), u.setAttribute(\"role\", \"img\"), !i.isReadonly(d) && i.config.drag_move && (d.id != i.getState(\"tasksDnd\").drag_id ? u.setAttribute(\"aria-grabbed\", !1) : u.setAttribute(\"aria-grabbed\", !0));\n        },\n        taskRowAttr: function (d, u) {\n          this._taskCommonAttr(d, u), !i.isReadonly(d) && i.config.order_branch && u.setAttribute(\"aria-grabbed\", !1), u.setAttribute(\"role\", \"row\"), u.setAttribute(\"aria-selected\", i.isSelectedTask(d.id) ? \"true\" : \"false\"), u.setAttribute(\"aria-level\", d.$level + 1 || 1), i.hasChild(d.id) && u.setAttribute(\"aria-expanded\", d.$open ? \"true\" : \"false\");\n        },\n        linkAttr: function (d, u) {\n          var h = i.config.links,\n            _ = d.type == h.finish_to_start || d.type == h.start_to_start,\n            p = d.type == h.start_to_start || d.type == h.start_to_finish,\n            y = i.locale.labels.link + \" \" + i.templates.drag_link(d.source, p, d.target, _);\n          u.setAttribute(\"role\", \"img\"), u.setAttribute(\"aria-label\", s(y));\n        },\n        gridSeparatorAttr: function (d) {\n          d.setAttribute(\"role\", \"columnheader\");\n        },\n        rowResizerAttr: function (d) {\n          d.setAttribute(\"role\", \"row\");\n        },\n        lightboxHiddenAttr: function (d) {\n          d.setAttribute(\"aria-hidden\", \"true\");\n        },\n        lightboxVisibleAttr: function (d) {\n          d.setAttribute(\"aria-hidden\", \"false\");\n        },\n        lightboxAttr: function (d) {\n          d.setAttribute(\"role\", \"dialog\"), d.setAttribute(\"aria-hidden\", \"true\"), d.firstChild.setAttribute(\"role\", \"heading\"), d.firstChild.setAttribute(\"aria-level\", \"1\");\n        },\n        lightboxButtonAttrString: function (d) {\n          return this.getAttributeString({\n            role: \"button\",\n            \"aria-label\": i.locale.labels[d],\n            tabindex: \"0\"\n          });\n        },\n        lightboxHeader: function (d, u) {\n          d.setAttribute(\"aria-label\", u);\n        },\n        lightboxSelectAttrString: function (d) {\n          var u = \"\";\n          switch (d) {\n            case \"%Y\":\n              u = i.locale.labels.years;\n              break;\n            case \"%m\":\n              u = i.locale.labels.months;\n              break;\n            case \"%d\":\n              u = i.locale.labels.days;\n              break;\n            case \"%H:%i\":\n              u = i.locale.labels.hours + i.locale.labels.minutes;\n          }\n          return i._waiAria.getAttributeString({\n            \"aria-label\": u\n          });\n        },\n        lightboxDurationInputAttrString: function (d) {\n          return this.getAttributeString({\n            \"aria-label\": i.locale.labels.column_duration,\n            \"aria-valuemin\": \"0\",\n            role: \"spinbutton\"\n          });\n        },\n        inlineEditorAttr: function (d) {\n          d.setAttribute(\"role\", \"row\");\n        },\n        gridAttrString: function () {\n          return [\" role='treegrid'\", i.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\n        },\n        gridScaleRowAttrString: function () {\n          return \"role='row'\";\n        },\n        gridScaleCellAttrString: function (d, u) {\n          var h = \"\";\n          if (d.name == \"add\") h = this.getAttributeString({\n            role: \"columnheader\",\n            \"aria-label\": i.locale.labels.new_task\n          });else {\n            var _ = {\n              role: \"columnheader\",\n              \"aria-label\": i.config.external_render && i.config.external_render.isElement(u) ? \"\" : u\n            };\n            i._sort && i._sort.name == d.name && (i._sort.direction == \"asc\" ? _[\"aria-sort\"] = \"ascending\" : _[\"aria-sort\"] = \"descending\"), h = this.getAttributeString(_);\n          }\n          return h;\n        },\n        gridDataAttrString: function () {\n          return \"role='rowgroup'\";\n        },\n        reorderMarkerAttr: function (d) {\n          d.setAttribute(\"role\", \"grid\"), d.firstChild.removeAttribute(\"aria-level\"), d.firstChild.setAttribute(\"aria-grabbed\", \"true\");\n        },\n        gridCellAttrString: function (d, u, h) {\n          var _ = {\n            role: \"gridcell\",\n            \"aria-label\": u\n          };\n          return d.editor && !i.isReadonly(h) || (_[\"aria-readonly\"] = !0), this.getAttributeString(_);\n        },\n        gridAddButtonAttrString: function (d) {\n          return this.getAttributeString({\n            role: \"button\",\n            \"aria-label\": i.locale.labels.new_task\n          });\n        },\n        messageButtonAttrString: function (d) {\n          return \"tabindex='0' role='button' aria-label='\" + d + \"'\";\n        },\n        messageInfoAttr: function (d) {\n          d.setAttribute(\"role\", \"alert\");\n        },\n        messageModalAttr: function (d, u) {\n          d.setAttribute(\"role\", \"dialog\"), u && d.setAttribute(\"aria-labelledby\", u);\n        },\n        quickInfoAttr: function (d) {\n          d.setAttribute(\"role\", \"dialog\");\n        },\n        quickInfoHeaderAttrString: function () {\n          return \" role='heading' aria-level='1' \";\n        },\n        quickInfoHeader: function (d, u) {\n          d.setAttribute(\"aria-label\", u);\n        },\n        quickInfoButtonAttrString: function (d) {\n          return i._waiAria.getAttributeString({\n            role: \"button\",\n            \"aria-label\": d,\n            tabindex: \"0\"\n          });\n        },\n        tooltipAttr: function (d) {\n          d.setAttribute(\"role\", \"tooltip\");\n        },\n        tooltipVisibleAttr: function (d) {\n          d.setAttribute(\"aria-hidden\", \"false\");\n        },\n        tooltipHiddenAttr: function (d) {\n          d.setAttribute(\"aria-hidden\", \"true\");\n        }\n      }, i._waiAria) i._waiAria[c] = /* @__PURE__ */function (d) {\n        return function () {\n          return i.config.wai_aria_attributes ? d.apply(this, arguments) : \"\";\n        };\n      }(i._waiAria[c]);\n    }(t), t.locate = function (i) {\n      var a = yt(i);\n      if (dt(a, \".gantt_task_row\")) return null;\n      var r = arguments[1] || this.config.task_attribute,\n        s = nt(a, r);\n      return s ? s.getAttribute(r) : null;\n    }, t._locate_css = function (i, a, r) {\n      return pt(i, a, r);\n    }, t._locateHTML = function (i, a) {\n      return nt(i, a || this.config.task_attribute);\n    };\n  }\n  t.attachEvent(\"onParse\", function () {\n    F(t) || t.attachEvent(\"onGanttRender\", function () {\n      if (t.config.initial_scroll) {\n        var i = t.getTaskByIndex(0),\n          a = i ? i.id : t.config.root_id;\n        t.isTaskExists(a) && t.$task && t.utils.dom.isChildOf(t.$task, t.$container) && t.showTask(a);\n      }\n    }, {\n      once: !0\n    });\n  }), t.attachEvent(\"onBeforeGanttReady\", function () {\n    this.config.scroll_size || (this.config.scroll_size = Xe() || 15), F(t) || (this._eventRemoveAll(), this.$mouseEvents.reset(), this.resetLightbox());\n  }), t.attachEvent(\"onGanttReady\", function () {\n    !F(t) && t.config.rtl && t.$layout.getCellsByType(\"viewCell\").forEach(function (i) {\n      var a = i.$config.scrollX;\n      if (a) {\n        var r = t.$ui.getView(a);\n        r && r.scrollTo(r.$config.scrollSize, 0);\n      }\n    });\n  }), t.attachEvent(\"onGanttReady\", function () {\n    if (!F(t)) {\n      var i = t.plugins(),\n        a = {\n          auto_scheduling: t.autoSchedule,\n          click_drag: t.ext.clickDrag,\n          critical_path: t.isCriticalTask,\n          drag_timeline: t.ext.dragTimeline,\n          export_api: t.exportToPDF,\n          fullscreen: t.ext.fullscreen,\n          grouping: t.groupBy,\n          keyboard_navigation: t.ext.keyboardNavigation,\n          marker: t.addMarker,\n          multiselect: t.eachSelectedTask,\n          overlay: t.ext.overlay,\n          quick_info: t.templates.quick_info_content,\n          tooltip: t.ext.tooltips,\n          undo: t.undo\n        };\n      for (let r in a) a[r] && !i[r] && console.warn(`You connected the '${r}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\n    }\n  });\n}\nconst Xa = Z.gantt = function (t) {\n  var e = ra(t);\n  return e.env.isNode || (Ka(e), function (n) {\n    n.load = function (i, a, r) {\n      this._load_url = i, this.assert(arguments.length, \"Invalid load arguments\");\n      var s = \"json\",\n        o = null;\n      return arguments.length >= 3 ? (s = a, o = r) : typeof arguments[1] == \"string\" ? s = arguments[1] : typeof arguments[1] == \"function\" && (o = arguments[1]), this._load_type = s, this.callEvent(\"onLoadStart\", [i, s]), this.ajax.get(i, n.bind(function (l) {\n        this.on_load(l, s), this.callEvent(\"onLoadEnd\", [i, s]), typeof o == \"function\" && o.call(this);\n      }, this));\n    };\n  }(e)), e;\n}(Vn);\nexport { Xa as default, Xa as gantt };","map":{"version":3,"names":["V","t","e","n","i","a","getBoundingClientRect","r","s","document","body","o","documentElement","parentNode","l","window","pageYOffset","scrollTop","c","pageXOffset","scrollLeft","d","clientTop","u","clientLeft","top","left","offsetWidth","right","offsetHeight","bottom","parseInt","offsetTop","offsetLeft","offsetParent","y","Math","round","x","width","height","Dn","getComputedStyle","display","visibility","currentStyle","An","isNaN","getAttribute","In","area","nodeName","loLowerCase","Mn","input","select","textarea","button","object","toLowerCase","hasAttribute","Lt","querySelectorAll","join","Array","prototype","slice","call","length","$position","sort","tabIndex","splice","Xe","createElement","style","cssText","appendChild","clientWidth","removeChild","max","X","className","baseVal","indexOf","_e","wt","Gt","split","RegExp","replace","we","getElementById","querySelector","Bt","Ze","innerHTML","firstChild","Qe","tn","childNodes","push","yt","tagName","event","target","srcElement","shadowRoot","composedPath","nt","host","String","trim","apply","pt","charAt","rt","clientX","clientY","touches","en","Y","dt","closest","matches","msMatchesSelector","webkitMatchesSelector","contains","parentElement","nodeType","console","error","nn","an","head","createShadowRoot","attachShadow","ge","activeElement","getSelection","focusNode","vt","ShadowRoot","hasClass","classList","test","hasShadowParent","insertNode","isChildOf","isShadowDomSupported","locateAttribute","locateClassName","removeClassName","removeNode","toNode","Symbol","toStringTag","value","Z","global","Nn","constructor","_mouseDown","_touchStarts","_touchActive","_longTapTimer","_gantt","_domEvents","_createDomEventScope","attach","getViewPort","_originPosition","_restoreOriginPosition","position","$services","getService","registerProvider","autoscroll","startDragAndDrop","setStart","copy","setPosition","setEnd","p","$root","changedTouches","h","_","setTimeout","config","touch_drag","clearTimeout","utils","dom","preventDefault","getFilterTargets","_getCoordinates","dragEnd","ext","clickDrag","k","drag_timeline","useKey","b","abs","relative","render","detach","detachAll","unregisterProvider","destructor","absolute","sn","EventHost","_silent_mode","listeners","_silentStart","_silentEnd","ot","attachEvent","eventStorage","arguments","addEvent","id","once","handler","removeEvent","clear","thisObject","bind","attachAll","callEvent","ev_listen_all","concat","checkEvent","detachEvent","detachAllEvents","Ce","second","minute","hour","day","week","month","quarter","year","Vt","kt","forEach","Ln","find","zt","includes","fe","isArray","pop","Q","getFullYear","getMonth","getDate","bt","getTime","De","result","$cancelTimeout","$pending","$execute","at","Ae","At","floor","Pn","_el","defaultRender","min","_singleRow","_getTaskPositionByTop","_startPoint","_view","_viewPort","viewPort","add","callback","_callback","_endPoint","draw","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","requestAnimationFrame","getElement","_startDate","dateFromPos","_endDate","_positionPoint","getState","max_date","valueOf","getTaskByTime","_getTasksByTop","getInBounds","index","getTaskByIndex","getItemIndexByTopPosition","getItemHeight","getItemTop","getTotalHeight","row_height","getTaskCount","te","Yt","_calculateDirectionVector","_trace","magnitude","sqrt","angleDegrees","atan2","PI","_applyDndReadyStyles","_timeline","$task","_clearDndReadyStyles","remove","_getScrollPosition","$ui","getView","$config","scrollX","getScrollState","scrollY","_countNewScrollPosition","_scrollState","_setScrollPosition","scrollLayoutCell","$id","_stopDrag","_originalReadonly","readonly","_originAutoscroll","_startDrag","create","_isDragInProgress","ignore","enabled","click_drag","Rn","$destroyed","focus","eventRemove","currentTarget","$keyboardNavigation","trapFocus","getLightbox","getActiveElement","isModal","Hn","show","_showForTask","_showAtCoordinates","hide","_quickInfoBox","_quickInfoBoxId","_quickInfoTask","quick_info_detached","getNode","setContainer","_container","setContent","taskId","header","title","date","content","buttons","quickinfo_buttons","_createQuickInfoElement","_waiAria","quickInfoHeader","quickInfoButtonAttrString","locale","labels","_qiButtonClickHandler","_qiKeyPressHandler","_qi_button_click","which","_appendAtCoordinates","show_quick_info","_getContainer","_get_event_counter_part","xViewport","yViewport","_init_quick_info","_prepare_quick_info_classname","_fill_quick_data","_show_quick_info","getTaskNode","getTaskRowNode","dx","dy","quickInfoAttr","quickInfoHeaderAttrString","parent","getTask","_quickInfoReadonly","isReadonly","getTaskType","templates","quick_info_class","start_date","end_date","icon_delete","icon_edit","quick_info_title","quick_info_date","quick_info_content","$click","$task_data","$grid_data","$grid","$layout","ee","On","toString","q","Date","Object","$$typeof","hasOwnProperty","P","W","st","R","on","addEventListener","ln","removeEventListener","Se","element","capture","extend","zn","_tooltipNode","tooltipAttr","setViewport","_root","_isLikeMouseEvent","_calculateTooltipPosition","tooltipVisibleAttr","tooltipHiddenAttr","_getViewPort","_getViewPortSize","tooltip_offset_x","tooltip_offset_y","Wn","_listeners","tooltip","_initDelayedFunctions","hideTooltip","delayHide","selector","doOnMouseEnter","onmouseenter","onmousemove","onmouseleave","node","tooltipFor","createEventObject","createEvent","html","delayShow","tooltip_timeout","tooltip_hide_timeout","Ie","onBeforeUndo","onBeforeRedo","Me","jn","_batchAction","_batchMode","_ignore","_ignoreMoveEvents","_initialTasks","_initialLinks","_nestedTasks","_nestedLinks","_undo","_attachEvents","store","undo_types","task","_storeTask","link","_storeLink","isMoveEventsIgnored","toggleIgnoreMoveEvents","startIgnore","stopIgnore","startBatchAction","_timeout","stopBatchAction","action","logAction","onTaskAdded","_storeTaskCommand","command","type","onTaskUpdated","update","onTaskMoved","$local_index","getTaskIndex","_storeEntityCommand","getInitialTask","move","entity","onTaskDeleted","_storeLinkCommand","onLinkAdded","onLinkUpdated","onLinkDeleted","setNestedTasks","_getLinks","setInitialTask","setInitialLink","$index","getGlobalTaskIndex","setInitialTaskObject","clearInitialTasks","getLink","getInitialLink","clearInitialLinks","saveInitialAll","eachTask","getLinks","clearUndoStack","clearRedoStack","getDatastore","drag_id","isSummaryTask","drag_project","plugins","multiselect","getSelectedTasks","inlineEditors","_storeCommand","updateConfigs","undoEnabled","commands","isTaskExists","$source","$target","Fn","maxSteps","redoEnabled","invert","oldValue","inverseCommands","assert","_undoStack","_redoStack","getUndoStack","setUndoStack","getRedoStack","setRedoStack","undo_steps","undo_actions","undo","redo","_pop","_reorderCommands","_applyAction","_push","shift","any","get","isExists","batchUpdate","startsWith","Vn","$container","dragTimeline","fullscreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","zIndex","modified","getFullscreenElement","originalPositioning","warning","log","expand","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","msRequestFullscreen","mozRequestFullScreen","requestFullscreen","collapse","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullscreen","toggle","keyboard_navigation","keyboard_navigation_cells","_compose","shortcuts","createCommand","modifiers","alt","ctrl","meta","keyCode","parse","getExpressions","getWords","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","shiftKey","altKey","ctrlKey","metaKey","fromCharCode","getHashFromEvent","getHash","junctionChar","combinationChar","backspace","tab","enter","esc","space","up","down","home","end","pageup","pagedown","delete","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","findHandler","doAction","facade","returnValue","unbind","bindAll","initKeys","keys","getFocusableNodes","GanttNode","blur","isEnabled","scrollHorizontal","getScale","step","unit","scrollTo","posFromDate","scrollVertical","alt+left","alt+right","alt+up","alt+down","ctrl+z","ctrl+r","KeyNavNode","isValid","fallback","moveTo","dispatcher","setActiveNode","compareTo","setAttribute","$eventAttached","HeaderCell","show_grid","getVisibleTaskCount","getGridColumns","TaskRow","fromDomElement","previousSibling","$grid_scale","getChildren","root_id","TaskCell","enter, space","click","ctrl+enter","createTask","globalIndex","splitItem","$split_subtask","parentId","getParent","locate","isTaskVisible","task_attribute","replaceAll","getTaskPosition","getTaskHeight","inner_width","inner_height","show_chart","scroll_on_click","task_scroll_offset","scrollable","getPrev","getNext","shift+down","hasChild","$open","open","shift+up","close","shift+right","getPrevSibling","moveTask","updateTask","shift+left","isSelectedTask","unselectTask","selectTask","ctrl+left","ctrl+right","showLightbox","columnIndex","show_tasks_outside_timescale","isActive","activeNode","globalNode","enable","getActiveNode","disable","getDefaultNode","setDefaultNode","focusGlobalNode","blurNode","keyDownHandler","defaultPrevented","awaitsFocus","delay","clearDelay","isTaskFocused","focusHandler","$preventDefault","reFocusActiveNode","localName","g","m","f","v","getNodePosition","$","w","S","T","getRelativeEventPosition","E","columns","C","removeAttribute","$data","tasksStore","_smart_render","_redrawTasks","types","placeholder","placeholder_task","focusOnCreate","setInterval","gantt","headerCell","taskRow","taskCell","name","clearInterval","mixin","addShortcut","getShortcutHandler","getCommandHandler","removeShortcut","column","keyboardNavigation","quick_info","quickInfo","text","substr","details","task_time","hidingFunction","showQuickInfo","hideQuickInfo","tooltips","touch","touch_tooltip","tooltip_text","link_source_id","source","saveState","getInitialState","marker","show_markers","min_date","marker_class","css","getRowTop","timeline_placeholder","scrollHeight","external_render","isElement","renderElement","$marker_area","_markers","createDatastore","initItem","uid","renderMarkers","createDataRender","defaultContainer","addLayer","getMarker","getItem","addMarker","addItem","deleteMarker","exists","removeItem","updateMarker","refresh","_getMarkers","getItems","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","getSelected","setFirstSelected","getFirstSelected","updateState","select_task","reset","setLastSelected","silent","unselect","getLastSelected","getSelectedId","afterSelect","isSelected","forSelected","isSameLevel","calculateTaskLevel","_quickRefresh","refreshTask","doSelection","_is_icon_open_click","locateCell","inline_editors_multiselect_open","getEditorConfig","columnName","isVisible","startEdit","toggleTaskSelection","eachSelectedTask","getLastSelectedTask","$level","export_api","_apiUrl","_preparePDFConfigRaw","start","str_to_date","date_format","data","_serializeHtml","_prepareConfigPDF","_serializeAll","_fixColumns","_pdfExportRouter","raw","version","_sendToExport","exportToPDF","exportToPNG","exportToICal","_serializePlain","exportToExcel","smart_rendering","visual","_eachTaskTimed","_no_progress_colors","_serializeTimeline","_serializeGrid","rawDates","scales","_serializeScales","exportToJSON","worktime","_getWorktimeSettings","importFromExcel","File","FormData","append","_sendImportAjaxExcel","importFromMSProject","_sendImportAjaxMSP","importFromPrimaveraP6","exportToMSProject","skip_circular_links","xml_format","format_date","xml_date","date_to_str","_customProjectProperties","_customTaskProperties","_clearRecLinks","_exportConfig","$custom_data","custom","exportToPrimaveraP6","label","_xdr","ajax","post","_markColumns","template","$template","server","JSON","stringify","sheet","XMLHttpRequest","onreadystatechange","readyState","status","onload","responseText","setRequestHeader","send","_ajaxToExport","encodeURIComponent","xmlDoc","_serializableGanttConfig","map","editor","editor_types","skin","_createHiddenForm","submit","_hidden_export_form","_copyObjectBase","constraint_date","deadline","_color_box","_color_hash","_getStyles","_getColor","_getMinutesWorktimeSettings","startMinute","endMinute","hours","minutes","dates","work_time","_working_time_helper","get_calendar","worktimes","parsed","_pull","_originalCopyObject","json","_copyObject","_copyObjectPlain","task_text","match","_copyObjectTable","_copyObjectColumns","_day_index_by_date","columnIndexByDate","$start","$end","$type","$rendered_type","$text","$left","leftside_text","$right","rightside_text","_copyObjectColors","$color","color","date_grid","_copyObjectAll","smart_scales","_exportSerialize","links","_getRaw","_scale_helpers","_get_scales","min_column_width","_get_resize_options","autosize_min_width","scale_height","prepareConfigs","autosize","_getScales","rtl","$scaleHelper","cellColors","timeline_cell_class","task_cell_class","trace_x","styles","col_width","format","date_scale","scaleCell_class","exportMode","tree","serialize","_setLevel","_lvl","_clearLevel","_makeLinksSameLevel","_clearCircDependencies","_clearLinksSameLevel","$_source","_onCircDependencyFind","_target","_source","$_target","project","tasks","getSubtaskDates","start_end","auto_scheduling","manual","durationUnit","projectProperties","taskProperties","Un","KEY_CODES","UP","DOWN","LEFT","RIGHT","SPACE","ENTER","DELETE","ESC","TAB","qn","addExtension","_extensions","getExtension","ut","mt","isIE","navigator","userAgent","isOpera","isChrome","isSafari","isFF","isIPad","search","isEdge","isNode","isSalesforce","Sfdc","$A","Aura","Ne","xt","method","Error","url","async","headers","Le","Function","to_fixed","getISOWeek","getWeek","Pe","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","getDay","day_full","month_short","month_full","getUTCHours","getHours","getUTCMinutes","getMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","month_short_hash","month_full_hash","UTC","Gn","csp","init","date_part","setHours","hour_start","setTime","time_part","getTimezoneOffset","week_start","start_on_monday","month_start","setDate","quarter_start","setMonth","year_start","day_start","setMinutes","minute_start","setSeconds","getMilliseconds","setMilliseconds","_add_days","setYear","add_quarter","_getWeekNumber","convert_to_utc","parseDate","defined","parse_date","Yn","token","_url","_token","_mode","_seed","_queue","api","_events","Accept","fetch","credentials","then","load","key","websocket","_wrapper","connect","_socket","onclose","location","protocol","WebSocket","onmessage","fire","onError","_send","_resubscribe","Promise","_uid","args","resolve","reject","onCall","filter","catch","onResponse","Jn","remoteEvents","_ready","_remote","ready","dn","_on_timeout","ceil","Kn","internal","Xn","et","$create","$removeAt","$remove","$find","$insertAt","$each","$map","$filter","Rt","it","DataStore","pull","$initItem","visibleOrder","fullOrder","_skip_refresh","_filterRule","_searchVisibleOrder","_indexRangeCache","_getItemsCache","_attachDataChange","_parseInner","copyOnParse","isSilent","_updateOrder","updateItem","_removeItemInner","_addItemInner","getVisibleItems","getIndexRange","_changeIdInner","changeId","_moveInner","getIdByIndex","clearAll","arraysEqual","_quick_refresh","_mark_recompute","count","countVisible","eachItem","_ganttConfig","getIndexById","_getNullIfUndefined","getFirst","getLast","cn","TreeDataStore","_branches","lt","$parentProperty","parentProperty","rootId","$getRootId","$openInitially","openInitially","_eachItemMainRangeCache","getConfig","_isSplitItem","open_split_tasks","$expanded_branch","F","_buildTree","setParent","_add_branch","calculateItemLevel","getBranchIndex","_move_branch","$rendered_parent","_replace_branch_child","_traverseBranches","getSiblings","getNextSibling","eachParent","_setParentInner","_eachItemCached","_eachItemIterate","reverse","criteria","_skipTaskRecalculation","Zn","datastoreRender","itemRepainter","getLayers","render_item","get_visible_range","ids","prepare_data","render_items","update_items","batch_update","getDataRender","onUpdateRequest","change_id","ne","Qn","open_tree_initially","deepcopy_on_parse","dropService","setService","_getDatastores","refreshData","preserve_scroll","refreshLink","_bulk_dnd","isSplitTask","linksStore","_update_flags","userdata","_clear_data","_skipResourceRepaint","addTask","lightbox","deleteTask","changeTaskId","getLinkCount","isLinkExists","addLink","updateLink","deleteLink","changeLinkId","pe","getSum","setSumWidth","adjustSize","full_width","splitSize","sortScales","_isLegacyMode","scale_unit","subscales","_prepareScaleObject","primaryScale","initTemplate","scale_cell_class","getSubScales","env","warn","initScaleConfig","processIgnores","initColSizes","limitVisibleRange","unshift","alineScaleColumns","reverseScale","setPosSettings","trace_indexes","trace_index_transition","_ignore_time_config","skip_off_time","isWorkTime","ignore_x","display_count","eachColumn","trace_x_ascending","iterateScales","_correct_dst_change","ti","scale_offset_minimal","duration_unit","deadlines","ie","constraint_type","constraint_types","ASAP","ALAP","baselines","calculateEndDate","duration","_min_date","_max_date","me","fit_tasks","Re","He","ve","getSubtreeLinks","getSubtreeTasks","ei","$gantt","$dp","_dataProcessorHandlers","clientSideDelete","setGanttMode","setUpdated","_sendTaskOrder","cascade_delete","deleteAfterConfirmation","updateMode","setUpdateMode","storeItem","sendAllData","_tSend","_waitMode","_dp","_tMode","_serverProcessor","_ganttMode","substring","serverProcessor","urlSeparator","xml","_xmlNodeToJSON","isExist","assignmentsStore","handleResourceCRUD","handleResourceAssignmentCRUD","handleBaselineCRUD","updatedRows","getUserData","_in_progress","resources","dataprocessor_assignments","resource_assignment_store","task_id","dataprocessor_resources","resource_store","dataprocessor_baselines","datastore","Xt","_storage","getStoredItem","Jt","un","action_param","autoUpdate","_headers","_payload","_postDelim","_routerParametersFormat","_invalid","messages","updated","inserted","deleted","invalid","invalid_cell","enableUTFencoding","setTransactionMode","mode","payload","_serializeAsJson","_router","router","escape","_utf","getSyncState","dnd","findRow","set_invalid","setUserData","is_invalid","markRow","sendData","_methods","getActionByState","checkBeforeUpdate","editStop","modes","_beforeSendData","_getRowData","_serializeAsJSON","serialize_one","security_key","_forEachUpdatedRow","_sendData","_getAllData","defineAction","_uActions","afterUpdateCallback","afterUpdate","getGanttMode","filePath","sid","tid","finalizeUpdate","xmltop","cleanUpdate","xpath","_initialized","_dp_init","_setDefaultTransactionMode","order","delete_confirmation","_change_id","resourcesStore","baselineStore","_row_style","$dataprocessor_class","_delete_task","$drop_target","setDp","setOnAfterUpdate","setOnBeforeUpdateHandler","setAutoUpdate","_user","_needUpdate","_updateBusy","afterAutoUpdate","fullSync","loadUpdate","getUpdates","_getXmlNodeValue","_applyPayload","_cleanupArgumentsBeforeSend","_cleanupItemBeforeSend","query","nodeValue","_prepareDate","_prepareArray","_prepareObject","_prepareDataItem","ni","DataProcessor","ii","ai","resetProjectDates","ri","si","_needRecalc","_isRecalcNeeded","_isGroupSort","group_mode","_getWBSCode","_calcWBS","$virtual","$wbs","_setWBSCode","getWBSCode","getByWBSCode","_getPrevNonPlaceholderSibling","_increaseWBS","getTaskByWBSCode","oi","random","resource_id","resource_property","getTaskBy","getResourceAssignments","li","renderEditableLabel","$task_id","$resource_id","renderSummaryLabel","reduce","Number","editableResourceCellTemplate","$role","editableResourceCellClass","capacity","getSummaryResourceAssignments","initEditableDiagram","resource_render_empty_cells","cancelAnimationFrame","contentEditable","getCellsByType","view","$content","innerText","calculateDuration","updateTaskAssignments","editable_resource_diagram","fetchTasks","lightbox_resources","initItems","$resourcesStore","lightboxOptionsFnc","updateCollection","histogram_cell_class","histogram_cell_label","histogram_cell_allocated","histogram_cell_capacity","defaultResourceCellClass","defaultResourceCellTemplate","resource_cell_value","resource_cell_class","di","process_resource_assignments","D","M","getTaskAssignments","inBoth","inTaskNotInStore","inStoreNotInTask","A","I","N","L","O","unscheduled","getTaskResources","ci","new_task","_silencedPlaceholder","ui","auto_types","$needsUpdate","Zt","canParse","Pt","Qt","_linkReg","exec","_findSource","finish_to_start","lag","ke","hi","formatters","durationFormatter","linkFormatter","_i","show_empty_state","emptyStateElement","isGanttEmpty","renderContent","empty_state_text_link","empty_state_text_description","clickEvents","attachAddTaskEvent","detachAddTaskEvents","getContainer","marginTop","hn","hasBaselinesBelow","render_mode","$t","isSplitParent","gi","bar_height","adjustTaskHeightForBaselines","getLayoutView","getBarHeight","getTaskBaselines","fi","on_load","responseURL","_process_loading","collections","_load_collections","assignments","serverList","$ignore","dhx_security","serializeTask","serializeLink","_copyLink","attributes","_getCollections","_getXML","getXMLTopNode","progress","oldxml","startdate","est","enddate","predecessortasks","message","ae","calendar","re","dir","se","pi","_n","calendarArgumentsHelper","getWorkHoursArguments","setWorkTimeArguments","unsetWorkTimeArguments","isWorkTimeArguments","getClosestWorkTimeArguments","_getStartEndConfig","duration_step","getDurationArguments","hasDurationArguments","calculateEndDateArguments","gn","_getIntervals","_toHoursArray","_intersectHourRanges","_mergeAdjacentIntervals","_mergeHoursConfig","merge","customWeeks","processCalendar","mi","_cache","has","setItem","set","Map","vi","ki","getMinutesPerWeek","_weekCache","_calendar","getHoursPerDay","getMinutesPerMonth","_monthCache","yi","_getCacheObject","durations","endDates","_endDateCacheKey","_durationCacheKey","getEndDate","getDuration","ye","argumentsHelper","_workingUnitsCache","_largeUnitsCache","_dateDurationCache","_worktime","_cached_timestamps","_cached_timestamps_count","units","_clearCaches","_getUnitOrder","_resetTimestampCache","_timestamp","_checkIfWorkingUnit","hasDuration","_is_work_day","_getWorkHours","_is_work_hour","startHour","endHour","_getTimeOfDayStamp","_is_work_minute","_nextDate","_getWorkUnitsBetweenGeneric","_isWorkTime","_getClosestWorkTimeFuture","_getMinutesPerHour","_getMinutesPerDay","durationMinutes","durationHours","_getWorkUnitsForRange","_getMinutesBetweenSingleDay","_getIntervalTimestamp","_getMinutesBetween","_getHoursBetween","_setConfig","_parseSettings","haveCustomWeeks","customWeeksRangeStart","customWeeksRangeEnd","customWeeksBoundaries","_parseHours","from","to","fromReadable","toReadable","days","_tryChangeCalendarSettings","hasWorkTime","_arraysEqual","_compareSettings","equals","getWorkHours","durationSeconds","setWorkTime","unsetWorkTime","reset_calendar","_calculateDuration","_calculateEndDate","_calculateMinuteEndDate","_subtractMinuteDate","_calculateHourEndDate","_addInterval","added","_addHoursUntilDayEnd","_addMinutesUntilHourEnd","_subtractMinutesUntilHourStart","getClosestWorkTime","_isMinutePrecision","_getClosestWorkTimePast","_getClosestWorkTime","_getClosestWorkTimeGeneric","_findClosestTimeInDay","_getClosestWorkMinute","_checkWorkHours","It","isLegacyResourceCalendarFormat","getResourceProperty","resource_calendars","getCalendarIdFromLegacyConfig","bi","Wt","getCalendarIdFromMultipleResources","getResourceCalendar","mergeCalendars","addCalendar","fn","_calendars","_legacyConfig","_isLegacyConfig","createDefaultCalendars","be","pn","calendarManager","$disabledCalendar","_convertWorkTimeSettings","_createCalendarFromConfig","createCalendar","defaults","fulltime","getCalendar","getCalendars","_getOwnCalendar","calendar_property","dynamic_resource_calendars","getTaskCalendar","inherit_calendar","$effective_calendar","isCalendar","deleteCalendar","restoreConfigCalendars","every","_getCalendar","xi","worktimeFacadeFactory","_hasDuration","$i","isUnscheduledTask","_isAllowedUnscheduledTask","show_unscheduled","_isTaskInTimelineLimits","_getProjectEnd","project_end","_getProjectStart","project_start","getDefaultTaskDate","schedule_from_end","_set_default_task_timing","details_on_create","$new","showTask","_lightbox_id","_tasks_dnd","drag","getTaskTimingMode","$no_start","$no_end","scheduled_summary","milestone","_init_task_timing","rollup","$calculate_duration","min_duration","$rollup","getSubtaskDuration","_update_parents","$auto_start_date","$auto_end_date","roundDate","correctTaskWorkTime","correct_work_time","Oe","container_resize_timeout","Be","container_resize_method","$scrollbarRepaint","wi","show_errors","expire","cloneNode","_reinit","_clearTaskLayers","_clearLinkLayers","layout","createView","getPropertyValue","wai_aria_attributes","contentWindow","resetLayout","initTemplates","$mouseEvents","edit","confirm_deleting","confirm_deleting_title","_delete_task_confirm","hideLightbox","_sort","_getHorizontalScrollbar","codeScrollLeft","resize","getScrollbarsInfo","$view","boundViews","x_pos","setSizes","changeLightboxType","getLightboxType","_silent_redraw_lightbox","_get_link_type","start_to_start","start_to_finish","finish_to_finish","isLinkAllowed","Si","icon_save","icon_cancel","icon_details","confirm_closing","section_description","section_time","section_type","section_deadline","section_baselines","column_wbs","column_text","column_start_date","column_duration","column_add","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","weeks","months","years","message_ok","message_cancel","section_constraint","asap","alap","snet","snlt","fnet","fnlt","mso","mfo","resources_filter_placeholder","resources_filter_label","baselines_section_placeholder","baselines_add_button","baselines_remove_button","baselines_remove_all_button","deadline_enable_button","deadline_disable_button","Ti","Ei","Ci","Di","Ai","Ii","Mi","Ni","Li","Pi","Ri","Hi","Oi","Bi","zi","Wi","ji","Fi","Vi","Ui","addLocale","_locales","getLocale","qi","Gi","Yi","Ji","Ki","Xi","Zi","Qi","ta","ea","na","ia","aa","constants","license","edit_save","edit_cancel","ra","services","rows","cols","resizer","autoscroll_speed","show_links","show_task_cells","static_background","static_background_cells","branch_loading","branch_loading_property","show_loading","server_utc","show_progress","drag_links","drag_progress","drag_resize","drag_move","drag_mode","round_dnd_dates","link_wrapper_width","link_arrow_size","autofit","align","inherit_scale_class","time_step","task_date","time_picker","link_attribute","layer_attribute","buttons_left","_migrate_buttons","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","buttons_right","sections","map_to","project_sections","milestone_sections","single_date","drag_lightbox","details_on_dblclick","initial_scroll","order_branch","order_branch_free","task_height","bar_height_padding","min_grid_column_width","grid_resizer_column_attribute","keep_grid_width","grid_resize","grid_elastic_columns","resize_rows","task_grid_row_resizer_attribute","min_task_grid_row_height","readonly_property","editable_property","type_renderers","optimize_render","prevent_default_scroll","horizontal_scroll_key","drag_multiple","cache","DOMParser","ActiveXObject","loadXML","parseFromString","responseXML","getElementsByTagName","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","getSync","put","del","postSync","toUpperCase","RemoteEvents","pageX","pageY","_obj","_settings","getInputMethods","_drag_start_timer","clearDragTimer","passive","accessor","timeStamp","original_target","original_element_sizes","dragStart","traceDragEvents","dragMove","dragScroll","started","updates_per_second","cancelable","mousemoveContainer","checkPositionChange","pos","pow","sensitivity","initDnDMarker","backupEventTarget","backup_element","elementFromPoint","pointerEnabled","pointerType","msPointerEnabled","MSPOINTER_TYPE_MOUSE","obj","getPosition","_prevent_touch_scroll","_touch_drag","_touch_feedback","targetTouches","progress_text","grid_header_class","task_class","task_end_date","grid_row_class","task_row_class","timeline_cell_content","scale_row_class","grid_indent","grid_folder","grid_file","grid_open","grid_blank","task_unscheduled_time","grid_date_format","link_class","link_description","drag_link","drag_link_class","tooltip_date_format","baseline_text","selected_task","Bn","events","onItemLoading","onBeforeAdd","onAfterAdd","onBeforeUpdate","onAfterUpdate","onBeforeDelete","onAfterDelete","onIdChange","onBeforeItemMove","onAfterItemMove","onFilterItem","onItemOpen","onItemClose","onBeforeSelect","onAfterSelect","onAfterUnselect","dataProcessor","createDataProcessor","getGridColumn","_cached_functions","update_if_changed","active","activate","critical_path_mode","wrap_methods","_prefetch_originals","prefetch","get_arguments_hash","has_cached_value","get_cached_value","cache_value","is_date","stringify_argument","deactivate","setup","highlight_critical_path","_eventRemoveAll","resetLightbox","ar","ca","cs","da","de","el","es","fa","fr","he","hr","hu","jp","kr","nb","nl","no","pl","ro","ru","sk","sv","tr","ua","i18n","setLocale","gantt_save_btn","gantt_cancel_btn","gantt_delete_btn","sa","box","keyboard","cancelBubble","cover","onkeydown","messageButtonAttrString","messageModalAttr","ok","cancel","onclick","hidden","innerWidth","innerHeight","modalBox","messageBox","messageInfoAttr","insertBefore","timers","seed","hideAll","alert","confirm","modalbox","ze","$extendedConfig","setPrototypeOf","oa","$getConfig","$getTemplates","la","uiFactory$1","scroll","configure","$parent","initUI","views","registerView","doubleclick","contextMenu","root","getClassName","_last_move_event","delegate","callHandler","onDoubleClick","onMouseMove","onContextMenu","onClick","rn","We","x_end","y_end","Nt","Kt","ft","layerFactory","renderer","onrender","isInViewPort","getRectangle","remove_item","rendered","clear_container","getVisibleRange","prepareData","createDocumentFragment","restore","replace_item","replaceChild","getRenderer","clearRenderers","createGroup","tempCollection","renderers","container","filters","_add","getLayer","isConnected","topmost","je","requestUpdate","eachLayer","removeLayer","Fe","mn","rec","vn","ha","$skipSmartRenderOnScroll","Ht","headerHeight","$domEvents","$name","$factory","$externalComponent","_headerClickHandler","cell","$preResize","getSize","minWidth","maxWidth","minHeight","maxHeight","setSize","_hide","cellIndex","moveView","$toHTML","canCollapse","$fill","collapsed","gravity","getContentSize","$lastSize","contentX","contentY","_getBorderSizes","horizontal","vertical","_currentBorders","_borders","_sizeHeader","_sizeContent","_setBorders","transform","z","kn","_parseConfig","$cells","_resizeScrollbars","shouldHide","shouldShow","group","visible","direction","size","scrollSize","_getLinkedViews","x_inner","y_inner","y_pos","_syncCellSizes","_eachChild","_syncGroupSize","_xLayout","isGravity","grid_width","_resizeInProgress","setContentSize","_getAutosizeMode","$originalWidthStored","$originalWidth","$originalHeightStored","$originalHeight","isChild","getCells","_cleanElSize","_getBoxStyles","boxSizing","clientHeight","MozBoxSizing","horPaddings","borderLeftWidth","borderRightWidth","vertPaddings","borderTopWidth","borderBottomWidth","borderBox","outerWidth","outerHeight","_sizes","margin","_calcFreeSpace","_free","_gravity","_calcSize","_configureBorders","_updateCellVisibility","_visibleCells","hide_empty","_a","$cell","byMaxSize","ga","$initialized","unload","_setContentSize","_scrollHorizontalHandler","_scrollVerticalHandler","_outerScrollVerticalHandler","_outerScrollHorizontalHandler","_mouseWheelHandler","scroll_size","_isHorizontal","scrollPosition","_isVertical","_initVertical","_initHorizontal","_initMouseWheel","_initLinkedViews","_getRootParent","_eachView","$scroll_hor","$scroll_ver","_updateLinkedViews","scrollHorizontally","_scrolling","scrollVertically","_wheel_time","_oldLeft","_getScrollSize","_getScrollOffset","outerScroll","innerScroll","outerSize","_setScrollSize","toggleVisibility","_getScaleOffset","_oldTop","_checkWheelTarget","wheel_scroll_sensitivity","deltaX","wheelDeltaX","deltaY","wheelDelta","deltaMode","detail","yn","resetCache","_getRowHeight","_refreshState","rowStore","canUseSimpleCalculation","_resetTopPositionHeight","_resetHeight","getCacheStateTotalHeight","shouldClearHeightCache","_fillHeightCache","globalHeight","items","sumHeight","pa","canvasRender","destroy","Ut","Timeline","_posFromDateCache","_timelineDragScroll","$task_scale","$task_bg","$task_baselines","$task_links","$task_bars","$task_constraints","$task_deadlines","_tasks","bindLinks","item_attribute","_createLayerConfig","layers","linkLayers","_attachLayers","backgroundImage","scrollWidth","_refreshScales","_scales","_getScaleChunkHtml","taskFilter","expose","taskBar","hide_bar","taskBg","_taskLayers","_linkLayers","_bindStore","_taskRenderer","_initStaticBackgroundRender","linkStore","_linkRenderer","_staticBgHandler","$task_bg_static","nextSibling","_clearLayers","_render_tasks_scales","_prepareScaleHtml","sticky","getTimelineCellAttr","_getColumnDuration","_getNextVisibleColumn","_getPrevVisibleColumn","_getClosestVisibleColumn","getItemPosition","rowHeight","_timelineCacheAttached","_unbindStore","ma","_scrollOrder","grid","getCurrentX","_dnd","_scrollView","attachEvents","isScrollable","autoscrollRight","autoscrollStart","autoscrollLeft","autoscrollStop","getCorrection","Ve","va","_targetMarker","calculateCurrentPosition","_scrollableGrid","_draggedCell","draggedColumn","draggedIndex","_gridConfig","outerHTML","lineHeight","_dragX","findColumnsIndexes","setMarkerPosition","drawTargetMarker","targetIndex","targetColumn","cleanTargetMarker","reorderColumns","startX","endX","compare","xBefore","xAfter","columnRelativePos","Te","xe","Grid","$state","gridAttrString","gridDataAttrString","reorder_grid_columns","gridScaleRowAttrString","doOnRender","_renderHeaderResizers","_mouseDelegates","row_before_start","row_after_start","row_drag_move","marker_height","row_drag_end","dnd_sensitivity","_addLayers","_initEvents","_columnDND","_validateColumnWidth","_setColumnsWidth","_getGridWidth","_gridCacheAttached","_initSmartRenderingPlaceholder","_calculateGridWidth","_renderGridHeader","getColumnIndex","getColumn","gridLine","gridTaskRowResizer","_refreshPlaceholderOnStoreUpdate","$rowsPlaceholder","_getColumnWidth","min_width","max_width","_checkGridColumnMinWidthLimits","_getGridWidthLimits","_getColsTotalWidth","parseFloat","gridScaleCellAttrString","ka","isChanged","save","onShow","editPrevCell","editNextCell","onHide","ya","editorType","St","BaseEditor","set_value","get_input","get_value","is_changed","is_valid","ba","xa","oninput","$a","options","wa","Sa","formatter","delimiter","Set","autoSchedule","Ta","Ea","Ca","number","predecessor","Da","setMapping","getMapping","createEditors","inlineEditorAttr","_itemId","_columnName","_editor","_editorType","_placeholder","setValue","_onReMount","getValue","_getItemValue","newValue","inline_editors_date_processing","_findEditableCell","getNextCell","getFirstCell","getLastCell","moveRow","editNextRow","editPrevRow","detachStore","$e","bn","G","j","H","link_from_start","link_target_id","isCriticalTask","link_landing_area","link_to_start","progressColor","textColor","setProperty","setTaskBarAttr","marginLeft","marginRight","Ue","Ct","qe","jt","oe","Aa","lastTaskId","calendar_id","Ia","current_pos","dirs","path","point","get_lines","line_to","get_path","_get_line","get_wrapper_sizes","get_line_sizes","link_line_width","render_line","render_corner","radius","render_arrow","get_direction","current","point_to","get_points","get_endpoint","e_y","e_x","get_line_type","from_start","to_start","shrinkHeight","splitChild","link_radius","isCriticalLink","linkAttr","Ma","Na","tt","J","B","La","initial_open_state","$transparent","lastTaskOfLevel","_getGridPos","_getTargetY","_getTaskByY","reorderMarkerAttr","K","createDropTargetObject","targetParent","targetId","child","prevSibling","nextSiblingTarget","prevSiblingTarget","firstChildTarget","lastChildTarget","xn","le","Ge","Ye","Je","Ke","removeLineHighlight","markerLine","highlightPosition","pointerEvents","Pa","opacity","level","drop_target","doctype","Ra","initializer","onCreated","extendGantt","_inlineEditors","onInitialized","initEvents","extendDom","onDestroyed","clearEvents","showDate","Ha","createTaskDND","roundTaskDates","round_task_dates","dragMultiple","before_start","before_finish","after_finish","clear_drag_state","set_actions","drag_from_start","_move","_resize","_resize_progress","on_mouse_move","on_mouse_down","on_mouse_up","start_x","start_y","_drag_task_coords","_calculateMinDuration","_find_max_shift","obj_s_x","obj_e_x","_mouse_position_change","_is_number","isFinite","start_drag","now","timestamp","_start_dnd","_update_on_move","_update_item_on_move","_isMultiselect","handle_offset","_get_drag_mode","_fix_dnd_scale_time","_fix_working_times","_finalize_mouse_up","_fireEvent","_dhx_changed","doFinalize","_addSubtasksToDragMultiple","Oa","initLinksDND","_direction","link_direction_class","atan","sin","cos","_dir_start","_dir_end","Ba","linkDnD","za","_linksDnD","_tasksDnD","_attachDomEvents","_attachStateProvider","_clearDomEvents","_clearStateProvider","_delete_link_confirm","scale_step","Wa","getVerticalScrollbar","getHorizontalScrollbar","_legacyGridResizerClass","original_grid_width","skins","_initScrollStateEvents","_getVerticalScrollbar","_findGridResizer","_getSiblings","_behind","_front","gridFirst","ja","defaultContainerSibling","addTaskLayer","_getTaskLayers","removeTaskLayer","addLinkLayer","_getLinkLayers","removeLinkLayer","factory","mouseEvents","layersApi","gridAddButtonAttrString","center","gridCellAttrString","taskRowAttr","timedProjectBar","taskRollupBar","$rendered_at","taskSplitBar","taskConstraints","taskDeadline","taskBaselines","resourceRow","resourceHistogram","rowResizerAttr","layersService","ce","href","_theme_info","theme","cssVarTheme","terrace","_second_column_width","_third_column_width","_lightbox_template","_redefine_lightbox_buttons","Fa","autoscroll_delay","autoscroll_step","ue","jQuery","dhx_gantt","each","Gantt","getGanttInstance","dhtmlx","attaches","attachGantt","cmp","attachObject","dataType","dataObj","vs","av","border","gridId","gridObj","_viewRestore","dhtmlXCellObject","Va","Ua","qa","zoomIn","getCurrentLevel","setLevel","zoomOut","_levels","_activeLevelIndex","getLevels","_getZoomIndexByName","_getVisibleDate","_visibleDate","fixed_scales","_attachWheelEvent","_useKey","_handler","_defaultHandler","stopPropagation","_setScaleSettings","_setScaleDates","_initialStartDate","_initialEndDate","startDate","endDate","activeLevelIndex","_mapScales","levels","_minColumnWidth","minColumnWidth","_maxColumnWidth","maxColumnWidth","_widthStep","widthStep","trigger","_stepUp","_stepDown","Ga","platform","maxTouchPoints","_touch_events","touch_feedback","touch_feedback_duration","vibrate","_locate_css","Ft","Mt","ht","$n","getHtmlSelect","getHtmlOption","Dt","getHtmlButton","getHtmlDiv","getHtmlLabel","getHtmlInput","wn","qt","_dhx_onchange","onchange","_focus","Ya","allow_root","root_label","form_blocks","getLightboxValues","onselect","Ja","_get_input","getTimePicker","_time_format_order","auto_end_date","_update_lightbox_select","_fill_lightbox_select","_resolve_default_mapping","getTimePickerValue","autofix_end","_get_timepicker_step","single_value","checked","default_value","lightboxDurationInputAttrString","_t","Tt","charCode","disabled","_eventsInitialized","getConstraintType","_lightbox_current_type","Et","Ee","Sn","Tn","gt","ct","U","En","Cn","Ot","dataset","baselineId","button_click","_get_typed_lightbox_config","_lightbox_methods","_lightbox_root","showCover","_fill_lightbox","_setLbPosition","lightboxVisibleAttr","getLabel","_lightbox_type","_lightbox","_is_lightbox_timepicker","wide_form","lightboxAttr","onmousedown","_ready_to_dnd","ontouchstart","onselectstart","cursor","_init_dnd_events","_cover","_render_sections","inputId","_init_lightbox_events","_center_lightbox","show_cover","_move_while_dnd","_finish_dnd","lightboxButtonAttrString","time_format","timeFormat","year_range","first","_time_values","last","lightbox_events","_save_lightbox","_cancel_lightbox","default","time","time_optional","duration_optional","lightboxHiddenAttr","hideCover","_custom_lightbox","_set_lightbox_values","lightbox_header","lightboxHeader","getLightboxSection","section","get_template_control","control","get_select_control","get_textarea_control","get_time_control","_dnd_start_lb","gantt_unselectable","_lb_start","limit_time_select","first_hour","last_hour","lightboxSelectAttrString","radio","checkbox","constraint","typeselect","_simple_confirm","Ka","arrayFind","getTaskTop","getTaskBarHeight","getLinkNode","_scroll_state","resetSkin","_addThemeClass","setSkin","skyblue","lightbox_additional_height","dark","meadow","broadway","_config_buttons_left","_config_buttons_right","material","contrast_black","contrast_white","zoom","_extend_to_optional","update_block","getAttributeString","_taskCommonAttr","gridSeparatorAttr","role","tabindex","_locateHTML","critical_path","grouping","groupBy","overlay","Xa","_load_url","_load_type"],"sources":["C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\utils\\dom_helpers.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\global.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\click_drag\\eventsManager.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\eventable.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\helpers.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\click_drag\\selectedRegion.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\drag_timeline\\eventsManager.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\modals.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\quick_info\\quickInfo.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\utils.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\utils\\dom_event_scope.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\tooltip\\tooltip.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\tooltip\\tooltipManager.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\undo\\monitor.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\undo\\undo.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\extensions_gpl.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\click_drag\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\drag_timeline\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\fullscreen\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\common\\keyboard_shortcuts.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\common\\eventhandler.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\common\\trap_modal_focus.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\elements\\gantt_node.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\elements\\nav_node.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\elements\\header_cell.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\elements\\task_row.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\elements\\task_cell.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\keyboard_navigation\\core.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\quick_info\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\tooltip\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\undo\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\marker.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\multiselect.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\export_api\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\constants\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\ext\\extension_manager.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\env.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\serialize.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\ajax.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\date_parsers\\fast_version.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\date_parsers\\csp_compliant_version.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\date.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\node_modules\\remote-client\\dist\\remote.es6.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\remote\\remote_events.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\timeout.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\state.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\promise.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\facades\\datastore_tasks.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\power_array.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\placeholder_task.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\datastore.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\treedatastore.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\is_headless.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\datastore_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\facades\\datastore.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\select.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\facades\\datastore_links.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\scales.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\gantt_data_range.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\task_tree_helpers.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\dataprocessor\\data_processor_events.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\dataprocessor\\simple_storage.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\dataprocessor\\data_processor.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\dataprocessor\\extend_gantt.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\dataprocessor\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\batch_update.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\wbs.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\resources.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\resource_assignments.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\new_task_placeholder.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\auto_task_types.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\duration_formatter_numeric.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\link_formatter_simple.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\formatters.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\empty_state_screen.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\baseline_helper.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\baselines.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\loading\\parsing.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\calendar_arguments_helper.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_calendar_merger.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_unit_cache\\workunit_map_cache.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_unit_cache\\workunit_object_cache.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_unit_cache\\larger_units_helper.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_unit_cache\\date_duration_cache.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\calendar_strategy.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\work_unit_cache\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\legacy_resource_config.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\calendar_manager.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\dynamic_resource_calendars.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\strategy\\no_work_time.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\time_calculator.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\facades\\worktime_calendars.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\data.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\resize_listener.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\gantt_core.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\assert.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_ar.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_be.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_ca.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_cn.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_cs.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_da.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_de.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_el.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_en.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_es.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_fa.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_fi.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_fr.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_he.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_hr.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_hu.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_id.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_it.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_jp.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_kr.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_manager.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_nb.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_nl.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_no.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_pl.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_pt.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_ro.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_ru.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_si.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_sk.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_sv.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_tr.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\locale_ua.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\factory\\make_instance_common.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\services.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\config.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\dnd.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\common\\templates.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\datastore\\datastore_hooks.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\plugins\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\grid_column_api.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\tasks.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\worktime\\work_time.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\data_task_types.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\cached_functions.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\destructor.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\locale\\index.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\message.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\configurable.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\ui_factory.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\mouse.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\is_in_viewport.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\is_legacy_smart_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_grid_row_rectangle.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_visible_bars_range.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\render_factory.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\layer_engine.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_bar_rectangle.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\factory\\get_visible_link_range.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_link_rectangle.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\is_link_in_viewport.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\gantt_layers.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\cell.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\utils\\extends.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\layout.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\view_layout.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\view_cell.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\scrollbar_cell.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\row_position_mixin.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\row_position_fixed_height.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\tasks_canvas_render.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\timeline.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\timeline_layers_gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\column_grid_dnd\\scrollable_grid.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\column_grid_dnd\\column_grid_dnd.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\mouse_event_container.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\grid.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\grid_resize.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\task_grid_row_resize.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\keyboard_mappings\\default.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\keyboard_mappings\\keyboard_navigation.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\base.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\text.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\number.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\select.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\date.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\predecessor.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\editors\\duration.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\linked_properties.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\controller.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\editors\\keyboard_mappings.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\is_bar_in_viewport.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_bar_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_bar_smart_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\dummy_layer.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_bg_row_rectangle.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\get_visible_cells_range.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\is_column_visible.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\prerender\\task_bg_placeholder.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\link_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\viewport\\is_grid_row_in_viewport.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\resource_timetable_builder.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd_marker_helpers\\drop_target.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd_marker_helpers\\locked_level.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd_marker_helpers\\highlight.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd_marker.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\tasks_grid_dnd_marker_helpers\\multi_level.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\grid\\main_grid_initializer.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\tasks_dnd.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\links_dnd.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\timeline\\main_timeline_initializer.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\main_layout_initializer.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\layout\\resizer_cell.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_grid_line_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_bg_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_rollup_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\resource_matrix_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\render\\task_grid_row_resize_render.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\skin.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\autoscroll.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\jquery_hooks.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\dhtmlx_hooks.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\timeline_zoom.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\touch.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\base_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\utils\\html_helpers.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\select_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\parent_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\template_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\textarea_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\time_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\checkbox_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\radio_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\duration_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\constraint_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\typeselect_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\controls\\baseline_control.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui_core.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\data_task_layers.gpl.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\facades\\layout.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\skyblue.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\dark.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\meadow.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\terrace.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\broadway.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\material.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\contrast_black.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\css\\skins\\contrast_white.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\plugins\\index.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\lightbox\\lightbox_optional_time.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\ui\\wai_aria.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\dhtmlxgantt.gpl.ts","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\factory\\make_instance_web.js","C:\\Users\\vmoun\\OneDrive\\Desktop\\newtieckettool\\node_modules\\dhtmlx-gantt\\sources\\core\\loading\\ajax_loading.js"],"sourcesContent":["//returns position of html element on the page\r\nfunction getNodePosition(elem) {\r\n\tvar top=0, left=0, right=0, bottom=0;\r\n\tif (elem.getBoundingClientRect) { //HTML5 method\r\n\t\tvar box = elem.getBoundingClientRect();\r\n\t\tvar body = document.body;\r\n\t\tvar docElem = (document.documentElement ||\r\n\t\t\tdocument.body.parentNode ||\r\n\t\t\tdocument.body);\r\n\r\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\r\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\r\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\r\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\r\n\t\ttop  = box.top +  scrollTop - clientTop;\r\n\t\tleft = box.left + scrollLeft - clientLeft;\r\n\r\n\t\tright = document.body.offsetWidth - box.right;\r\n\t\tbottom = document.body.offsetHeight - box.bottom;\r\n\t} else { //fallback to naive approach\r\n\t\twhile(elem) {\r\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\r\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\r\n\t\t\telem = elem.offsetParent;\r\n\t\t}\r\n\r\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\r\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\r\n\t}\r\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\r\n}\r\n\r\nfunction isVisible(node){\r\n\tvar display = false,\r\n\t\tvisibility = false;\r\n\tif(window.getComputedStyle){\r\n\t\tvar style = window.getComputedStyle(node, null);\r\n\t\tdisplay = style[\"display\"];\r\n\t\tvisibility = style[\"visibility\"];\r\n\t}else if(node.currentStyle){\r\n\t\tdisplay = node.currentStyle[\"display\"];\r\n\t\tvisibility = node.currentStyle[\"visibility\"];\r\n\t}\r\n\treturn (display != \"none\" && visibility != \"hidden\");\r\n}\r\n\r\nfunction hasNonNegativeTabIndex(node){\r\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\r\n}\r\n\r\nfunction hasHref(node){\r\n\tvar canHaveHref = {\"a\": true, \"area\": true};\r\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\r\n\t\treturn !!node.getAttribute(\"href\");\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nfunction isEnabled(node){\r\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\r\n\tif(canDisable[node.nodeName.toLowerCase()]){\r\n\t\treturn !node.hasAttribute(\"disabled\");\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\nfunction getFocusableNodes(root){\r\n\tvar nodes = root.querySelectorAll([\r\n\t\t\"a[href]\",\r\n\t\t\"area[href]\",\r\n\t\t\"input\",\r\n\t\t\"select\",\r\n\t\t\"textarea\",\r\n\t\t\"button\",\r\n\t\t\"iframe\",\r\n\t\t\"object\",\r\n\t\t\"embed\",\r\n\t\t\"[tabindex]\",\r\n\t\t\"[contenteditable]\"\r\n\t].join(\", \"));\r\n\r\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\r\n\t\r\n\tfor(var i = 0; i < nodesArray.length; i++){\r\n\t\tnodesArray[i].$position = i;\r\n\t\t// we remember original nodes order, \r\n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \r\n\t\t// since some browsers do unstable sort\r\n\t}\r\n\t\r\n\t// use tabindex to sort focusable nodes\r\n\tnodesArray.sort(function(a, b) {\r\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\t\r\n\t\tif (a.tabIndex === b.tabIndex){\r\n\t\t\t// ensure we do stable sort\r\n\t\t\treturn a.$position - b.$position;\r\n\t\t}\r\n\t\tif (a.tabIndex < b.tabIndex) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\treturn 1;\r\n\t});\r\n\t\r\n\tfor(var i = 0; i < nodesArray.length; i++){\r\n\t\tvar node = nodesArray[i];\r\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\r\n\t\tif(!isValid){\r\n\t\t\tnodesArray.splice(i, 1);\r\n\t\t\ti--;\r\n\t\t}\r\n\t}\r\n\treturn nodesArray;\r\n}\r\n\r\nfunction getScrollSize(){\r\n\tvar div = document.createElement(\"div\");\r\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\r\n\r\n\tdocument.body.appendChild(div);\r\n\tvar width = div.offsetWidth-div.clientWidth;\r\n\tdocument.body.removeChild(div);\r\n\r\n\treturn Math.max(width, 15);\r\n}\r\n\r\nfunction getClassName(node){\r\n\tif(!node) return \"\";\r\n\r\n\tvar className = node.className || \"\";\r\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\r\n\t\tclassName = className.baseVal;\r\n\r\n\tif(!className.indexOf)\r\n\t\tclassName = \"\";\r\n\r\n\treturn _trimString(className);\r\n}\r\n\r\nfunction addClassName(node, className){\r\n\tif (className && node.className.indexOf(className) === -1) {\r\n\t\tnode.className += \" \" + className;\r\n\t}\r\n}\r\n\r\nfunction removeClassName(node, name) {\r\n\tname = name.split(\" \");\r\n\tfor (var i = 0; i < name.length; i++) {\r\n\t\tvar regEx = new RegExp(\"\\\\s?\\\\b\" + name[i] + \"\\\\b(?![-_.])\", \"\");\r\n\t\tnode.className = node.className.replace(regEx, \"\");\r\n\t}\r\n}\r\n\r\nfunction hasClass(element, className){\r\n\tif ('classList' in element) {\r\n\t\treturn element.classList.contains(className);\r\n\t} else { \r\n\t\treturn new RegExp(\"\\\\b\" + className + \"\\\\b\").test(element.className);\r\n\t}\r\n}\r\n\r\nfunction toNode(node) {\r\n\tif (typeof node === \"string\") {\r\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\r\n\t}\r\n\treturn node || document.body;\r\n}\r\n\r\nvar _slave;\r\nfunction insertNode(node, newone) {\r\n\tif(!_slave){\r\n\t\t_slave = document.createElement(\"div\");\r\n\t}\r\n\t_slave.innerHTML = newone;\r\n\tvar child = _slave.firstChild;\r\n\tnode.appendChild(child);\r\n\treturn child;\r\n}\r\n\r\nfunction removeNode(node) {\r\n\tif (node && node.parentNode) {\r\n\t\tnode.parentNode.removeChild(node);\r\n\t}\r\n}\r\n\r\nfunction getChildNodes(node, css) {\r\n\tvar ch = node.childNodes;\r\n\tvar len = ch.length;\r\n\tvar out = [];\r\n\tfor (var i = 0; i < len; i++) {\r\n\t\tvar obj = ch[i];\r\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\r\n\t\t\tout.push(obj);\r\n\t\t}\r\n\t}\r\n\treturn out;\r\n}\r\n\r\nfunction getTargetNode(e) {\r\n\tvar trg;\r\n\tif (e.tagName)\r\n\t\ttrg = e;\r\n\telse {\r\n\t\te = e || window.event;\r\n\t\ttrg = e.target || e.srcElement;\r\n\t\tif (trg.shadowRoot && e.composedPath) {\r\n\t\t\ttrg = e.composedPath()[0];\r\n\t\t}\r\n\t}\r\n\treturn trg;\r\n}\r\n\r\nfunction locateAttribute(e, attribute) {\r\n\tif(!attribute) return;\r\n\r\n\tvar trg = getTargetNode(e);\r\n\r\n\twhile (trg){\r\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\r\n\t\t\tvar test = trg.getAttribute(attribute);\r\n\t\t\tif (test) return trg;\r\n\t\t}\r\n\t\t// GS-2941. With the `host`, Gantt will continue iteration outside the ShadowDOM\r\n\t\ttrg = trg.parentNode || trg.host;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction _trimString(str){\r\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\r\n\treturn func.apply(str);\r\n}\r\n\r\nfunction locateClassName(e, classname, strict){\r\n\tvar trg = getTargetNode(e);\r\n\tvar css = \"\";\r\n\r\n\tif(strict === undefined)\r\n\t\tstrict = true;\r\n\r\n\twhile (trg){\r\n\t\tcss = getClassName(trg);\r\n\t\tif(css){\r\n\t\t\tvar ind = css.indexOf(classname);\r\n\t\t\tif (ind >= 0){\r\n\t\t\t\tif (!strict)\r\n\t\t\t\t\treturn trg;\r\n\r\n\t\t\t\t//check that we have exact match\r\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\r\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\r\n\r\n\t\t\t\tif (left && right)\r\n\t\t\t\t\treturn trg;\r\n\t\t\t}\r\n\t\t}\r\n\t\ttrg=trg.parentNode;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n/*\r\nevent position relatively to DOM element\r\n */\r\nfunction getRelativeEventPosition(ev, node){\r\n\tconst d = document.documentElement;\r\n\tconst box = getNodePosition(node);\r\n\t//GS-2809: condition to check event(mouse or touch)\r\n\tconst { clientX, clientY } = ev.touches?.[0] ?? ev;\r\n\treturn {\r\n\t\tx: clientX + d.scrollLeft - d.clientLeft - box.x + node.scrollLeft,\r\n\t\ty: clientY + d.scrollTop - d.clientTop - box.y + node.scrollTop\r\n\t};\r\n}\r\n\r\nfunction getRelativeNodePosition(child, parent){\r\n\tconst childPos = getNodePosition(child);\r\n\tconst parentPos = getNodePosition(parent);\r\n\treturn {\r\n\t\tx: childPos.x - parentPos.x,\r\n\t\ty: childPos.y - parentPos.y\r\n\t};\r\n}\r\n\r\nfunction isChildOf(child, parent){\r\n\tif(!child || !parent){\r\n\t\treturn false;\r\n\t}\r\n\r\n\twhile(child && child != parent) {\r\n\t\tchild = child.parentNode;\r\n\t}\r\n\r\n\treturn child === parent;\r\n}\r\n\r\nfunction closest(element, selector){\r\n\tif(element.closest){\r\n\t\treturn element.closest(selector);\r\n\t}else if(element.matches || element.msMatchesSelector || element.webkitMatchesSelector){\r\n\t\tvar el = element;\r\n\t\tif (!document.documentElement.contains(el)) return null;\r\n\t\tdo {\r\n\t\t\tvar method = el.matches || el.msMatchesSelector || el.webkitMatchesSelector;\r\n\r\n\t\t\tif (method.call(el, selector)) return el;\r\n\t\t\tel = el.parentElement || el.parentNode;\r\n\t\t} while (el !== null && el.nodeType === 1); \r\n\t\treturn null;\r\n\t}else{\r\n\t\t// eslint-disable-next-line no-console\r\n\t\tconsole.error(\"Your browser is not supported\");\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nfunction getClosestSizedElement(element) {\r\n\twhile (element) {\r\n\t\tif (element.offsetWidth > 0 && element.offsetHeight > 0) {\r\n\t\t\treturn element;\r\n\t\t}\r\n\t\telement = element.parentElement;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction isShadowDomSupported() {\r\n\treturn document.head.createShadowRoot || document.head.attachShadow;\r\n}\r\n\r\n/**\r\n * Returns element that has the browser focus, or null if no element has focus.\r\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\r\n * @returns HTMLElement\r\n */\r\nfunction getActiveElement(){\r\n\tvar activeElement = document.activeElement;\r\n\tif (activeElement.shadowRoot) {\r\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\r\n\t}\r\n\tif (activeElement === document.body && document.getSelection) {\r\n\t\tactiveElement = document.getSelection().focusNode || document.body;\r\n\t}\r\n\r\n\treturn activeElement;\r\n}\r\n\r\n/**\r\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\r\n * @param {HTMLElement} element \r\n * @returns HTMLElement\r\n */\r\nfunction getRootNode(element) {\r\n\tif (!element) {\r\n\t\treturn document.body;\r\n\t}\r\n\tif (!isShadowDomSupported()) {\r\n\t\treturn document.body;\r\n\t}\r\n\twhile (element.parentNode && (element = element.parentNode)) {\r\n\t\tif (element instanceof ShadowRoot) {\r\n\t\t\treturn element.host;\r\n\t\t}\r\n\t}\r\n\treturn document.body;\r\n}\r\n\r\nfunction hasShadowParent(element) {\r\n\treturn !!getRootNode(element);\r\n}\r\n\r\nexport {\r\n\tgetNodePosition,\r\n\tgetFocusableNodes,\r\n\tgetScrollSize,\r\n\tgetClassName,\r\n\taddClassName,\r\n\tremoveClassName,\r\n\tinsertNode,\r\n\tremoveNode,\r\n\tgetChildNodes,\r\n\ttoNode,\r\n\tlocateClassName,\r\n\tlocateAttribute,\r\n\tgetTargetNode,\r\n\tgetRelativeEventPosition,\r\n\tisChildOf,\r\n\thasClass,\r\n\tclosest,\r\n\tgetRootNode,\r\n\thasShadowParent,\r\n\tisShadowDomSupported,\r\n\tgetActiveElement,\r\n\tgetRelativeNodePosition,\r\n\tgetClosestSizedElement\r\n};","\r\n/* eslint-disable no-restricted-globals */\r\nvar globalScope;\r\nif(typeof window !== \"undefined\"){\r\n\tglobalScope = window;\r\n}else{\r\n\tglobalScope = global;\r\n}\r\n/* eslint-enable no-restricted-globals */\r\n\r\nexport default globalScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\r\nimport global from \"../../utils/global\";\r\nimport { SelectedRegion } from \"./selectedRegion\";\r\n\r\nexport class EventsManager {\r\n\tprivate _mouseDown: boolean = false;\r\n\tprivate _touchStarts: boolean = false;\r\n\tprivate _touchActive: boolean = false;\r\n\tprivate _longTapTimer: any = false;\r\n\tprivate _domEvents: any;\r\n\tprivate _originPosition: string;\r\n\tprivate _gantt: any;\r\n\tprivate _restoreOriginPosition: () => void;\r\n\tconstructor(gantt: any) {\r\n\t\tthis._gantt = gantt;\r\n\t\tthis._domEvents = gantt._createDomEventScope();\r\n\t}\r\n\r\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\", ignore?: any): void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst _target = selectedRegion.getViewPort();\r\n\t\tthis._originPosition = global.getComputedStyle(_target).display;\r\n\t\tthis._restoreOriginPosition = () => {\r\n\t\t\t_target.style.position = this._originPosition;\r\n\t\t};\r\n\t\tif (this._originPosition === \"static\") {\r\n\t\t\t_target.style.position = \"relative\";\r\n\t\t}\r\n\t\tconst state = gantt.$services.getService(\"state\");\r\n\t\tstate.registerProvider(\"clickDrag\", () => {\r\n\t\t\tconst result = { autoscroll: false };\r\n\t\t\treturn result;\r\n\t\t});\r\n\r\n\r\n\t\tlet scheduledDndCoordinates:any = null;\r\n\t\tconst startDragAndDrop = () => {\r\n\t\t\tif (!scheduledDndCoordinates) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._mouseDown = true;\r\n\t\t\tselectedRegion.setStart(gantt.copy(scheduledDndCoordinates));\r\n\t\t\tselectedRegion.setPosition(gantt.copy(scheduledDndCoordinates));\r\n\t\t\tselectedRegion.setEnd(gantt.copy(scheduledDndCoordinates));\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t};\r\n\r\n\t\t// mouse events\r\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\r\n\t\t\tstartDrag(event);\r\n\t\t});\r\n\t\tconst eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\r\n\t\tthis._domEvents.attach(eventElement, \"mouseup\", (event) => {\r\n\t\t\tstopDrag(event);\r\n\t\t});\r\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\r\n\t\t\tdragMove(event);\r\n\t\t});\r\n\r\n\t\t// touch events\r\n\t\tthis._domEvents.attach(_target, \"touchstart\", (event) => {\r\n\t\t\tthis._touchStarts = true;\r\n\t\t\tthis._longTapTimer = setTimeout(()=> {\r\n\t\t\t\tif (this._touchStarts){\r\n\t\t\t\t\tstartDrag(getTouchEvent (event));\r\n\t\t\t\t\tthis._touchStarts = false;\r\n\t\t\t\t\tthis._touchActive = true;\r\n\t\t\t\t}\r\n\t\t\t}, this._gantt.config.touch_drag);\r\n\t\t});\r\n\r\n\t\tthis._domEvents.attach(eventElement, \"touchend\", (event) => {\r\n\t\t\tthis._touchStarts = false;\r\n\t\t\tthis._touchActive = false;\r\n\t\t\tclearTimeout(this._longTapTimer);\r\n\t\t\tstopDrag(getTouchEvent (event));\r\n\t\t});\r\n\t\tthis._domEvents.attach(_target, \"touchmove\", (event) => {\r\n\t\t\tif (this._touchActive){\r\n\t\t\t\tlet filterTargets = getFilterTargets();\r\n\t\t\t\tif (filterTargets && gantt.utils.dom.closest(event.target, filterTargets)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdragMove(getTouchEvent (event));\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t} else {\r\n\t\t\t\tthis._touchStarts = false;\r\n\t\t\t\tclearTimeout(this._longTapTimer);\t\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfunction getTouchEvent (event){\r\n\t\t\tconst touchEvent = event.changedTouches && event.changedTouches[0] || event;\r\n\t\t\treturn touchEvent;\r\n\t\t}\r\n\r\n\t\tconst getFilterTargets = () => {\r\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\r\n\t\t\tif (ignore !== undefined) {\r\n\t\t\t\tif (ignore instanceof Array) {\r\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilterTargets = ignore;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn filterTargets;\r\n\t\t};\r\n\r\n\t\tconst startDrag: any = (event) => {\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t\tlet filterTargets = getFilterTargets();\r\n\t\t\tif (filterTargets) {\r\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\r\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\r\n\t\t\t\treturn result;\r\n\t\t\t});\r\n\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t};\r\n\r\n\t\tconst stopDrag: any = (event) => {\r\n\t\t\tscheduledDndCoordinates = null;\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\tif (this._mouseDown === true) {\r\n\t\t\t\tthis._mouseDown = false;\r\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tselectedRegion.dragEnd(coordinates);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst dragMove: any = (event) => {\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\t// GS-854. If we don't have useKey for the click_drag extension,\r\n\t\t\t// check the drag_timeline to not simultaneously use both extensions\r\n\t\t\tconst dragTimeline = this._gantt.ext.clickDrag;\r\n\t\t\tconst dragTimelineUseKey = (this._gantt.config.drag_timeline || {}).useKey;\r\n\t\t\tif (dragTimeline && dragTimelineUseKey) {\r\n\t\t\t\tif (!useKey && event[dragTimelineUseKey]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet coordinates:any = null;\r\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\r\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\r\n\t\t\t\t\t// add small threshold not to start dnd on simple click\r\n\t\t\t\t\tstartDragAndDrop();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this._mouseDown === true) {\r\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\r\n\t\t\t\tselectedRegion.setEnd(coordinates);\r\n\t\t\t\tselectedRegion.render();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tdetach(): void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._domEvents.detachAll();\r\n\t\tif(this._restoreOriginPosition){\r\n\t\t\tthis._restoreOriginPosition();\r\n\t\t}\r\n\r\n\t\tconst state = gantt.$services.getService(\"state\");\r\n\t\tstate.unregisterProvider(\"clickDrag\");\r\n\t}\r\n\r\n\tdestructor(): void {\r\n\t\tthis.detach();\r\n\t}\r\n\r\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\r\n\t\tconst viewPort = selectedRegion.getViewPort();\r\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\r\n\t\tconst { clientX, clientY } = event;\r\n\t\tconst result = {\r\n\t\t\tabsolute: {\r\n\t\t\t\tleft: clientX,\r\n\t\t\t\ttop: clientY\r\n\t\t\t},\r\n\t\t\trelative: {\r\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\r\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn result;\r\n\t}\r\n}","var EventHost = function(){\r\n\tthis._silent_mode = false;\r\n\tthis.listeners = {};\r\n};\r\n\r\nEventHost.prototype = {\r\n\t_silentStart: function() {\r\n\t\tthis._silent_mode = true;\r\n\t},\r\n\t_silentEnd: function() {\r\n\t\tthis._silent_mode = false;\r\n\t}\r\n};\r\n\r\nvar\tcreateEventStorage = function(obj) {\r\n\tvar handlers = {};\r\n\tvar index = 0;\r\n\tvar eventStorage = function(){\r\n\t\tvar combinedResult = true;\r\n\t\tfor(var i in handlers){\r\n\t\t\tvar handlerResult = handlers[i].apply(obj, arguments);\r\n\t\t\tcombinedResult=combinedResult && handlerResult;\r\n\t\t}\r\n\t\treturn combinedResult;\r\n\t};\r\n\teventStorage.addEvent=function(handler, settings){\r\n\t\tif (typeof (handler) == \"function\"){\r\n\t\t\tvar handlerId;\r\n\t\t\tif(settings && settings.id){\r\n\t\t\t\thandlerId = settings.id;\r\n\t\t\t}else{\r\n\t\t\t\thandlerId = index;\r\n\t\t\t\tindex++;\r\n\t\t\t}\r\n\r\n\t\t\tif(settings && settings.once){\r\n\t\t\t\tvar originalHandler = handler;\r\n\t\t\t\thandler = function(){\r\n\t\t\t\t\toriginalHandler();\r\n\t\t\t\t\teventStorage.removeEvent(handlerId);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\thandlers[handlerId] = handler;\r\n\t\t\treturn handlerId;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\teventStorage.removeEvent=function(id){\r\n\t\tdelete handlers[id];\r\n\t};\r\n\r\n\teventStorage.clear = function(){\r\n\t\thandlers = {};\r\n\t};\r\n\r\n\treturn eventStorage;\r\n};\r\n\r\nfunction makeEventable(obj){\r\n\r\n\tvar eventHost = new EventHost();\r\n\tobj.attachEvent=function(eventName, handler, settings){\r\n\t\teventName = 'ev_'+eventName.toLowerCase();\r\n\t\tif (!eventHost.listeners[eventName]){\r\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\r\n\t\t}\r\n\r\n\t\tif(settings && settings.thisObject){\r\n\t\t\thandler = handler.bind(settings.thisObject);\r\n\t\t}\r\n\r\n\t\tvar innerId = eventHost.listeners[eventName].addEvent(handler, settings);\r\n\r\n\t\tvar handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\r\n\t\tif(settings && settings.id){\r\n\t\t\thandlerId = settings.id;\r\n\t\t}\r\n\t\treturn handlerId;\r\n\t};\r\n\r\n\tobj.attachAll = function(callback){\r\n\t\tthis.attachEvent('listen_all', callback);\r\n\t};\r\n\r\n\tobj.callEvent=function(name, eventArguments){\r\n\t\tif (eventHost._silent_mode) return true;\r\n\r\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\r\n\r\n\t\tvar listeners = eventHost.listeners;\r\n\t\tif (listeners['ev_listen_all']){\r\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\r\n\t\t}\r\n\r\n\t\tif (listeners[handlerName])\r\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\r\n\t\treturn true;\r\n\t};\r\n\r\n\tobj.checkEvent=function(name){\r\n\t\tvar listeners = eventHost.listeners;\r\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\r\n\t};\r\n\r\n\tobj.detachEvent=function(id){\r\n\t\tif (id){\r\n\t\t\tvar listeners = eventHost.listeners;\r\n\t\t\tfor(var i in listeners){\r\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\r\n\t\t\t}\r\n\r\n\t\t\tvar list = id.split(':');//get EventName and ID\r\n\t\t\tvar listeners = eventHost.listeners;\r\n\t\t\tif(list.length === 2){\r\n\t\t\t\tvar eventName = list[0];\r\n\t\t\t\tvar eventId = list[1];\r\n\t\t\t\tif(listeners[eventName]){\r\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tobj.detachAllEvents = function(){\r\n\t\tfor (var name in eventHost.listeners) {\r\n\t\t\teventHost.listeners[name].clear();\r\n\t\t}\r\n\t};\r\n\r\n}\r\n\r\nexport default makeEventable;","var units = {\r\n\t\"second\": 1,\r\n\t\"minute\": 60,\r\n\t\"hour\": 60 * 60,\r\n\t\"day\": 60 * 60 * 24,\r\n\t\"week\": 60 * 60 * 24 * 7,\r\n\t\"month\": 60 * 60 * 24 * 30,\r\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\r\n\t\"year\": 60 * 60 * 24 * 365\r\n};\r\nfunction getSecondsInUnit(unit){\r\n\treturn units[unit] || units.hour;\r\n}\r\n\r\nfunction forEach(arr, callback) {\r\n\tif (arr.forEach) {\r\n\t\tarr.forEach(callback);\r\n\t} else {\r\n\t\tvar workArray = arr.slice();\r\n\t\tfor (var i = 0; i < workArray.length; i++) {\r\n\t\t\tcallback(workArray[i], i);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction arrayMap(arr, callback) {\r\n\tif (arr.map) {\r\n\t\treturn arr.map(callback);\r\n\t} else {\r\n\t\tvar workArray = arr.slice();\r\n\t\tvar resArray = [];\r\n\r\n\t\tfor (var i = 0; i < workArray.length; i++) {\r\n\t\t\tresArray.push(callback(workArray[i], i));\r\n\t\t}\r\n\t\treturn resArray;\r\n\t}\r\n}\r\n\r\n\r\nfunction arrayFind(arr, callback) {\r\n\tif (arr.find) {\r\n\t\treturn arr.find(callback);\r\n\t} else {\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tif (callback(arr[i], i)) {\r\n\t\t\t\treturn arr[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction arrayIncludes(arr, item) {\r\n\tif(arr.includes){\r\n\t\treturn arr.includes(item);\r\n\t}else{\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tif (arr[i] === item) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\n// iframe-safe array type check instead of using instanceof\r\nfunction isArray(obj){\r\n\tif(Array.isArray){\r\n\t\treturn Array.isArray(obj);\r\n\t}else{\r\n\t\t// close enough\r\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\r\n\t}\r\n}\r\n\r\n// non-primitive string object, e.g. new String(\"abc\")\r\nfunction isStringObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\r\n}\r\n\r\n// non-primitive number object, e.g. new Number(5)\r\nfunction isNumberObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\r\n}\r\n\r\n// non-primitive number object, e.g. new Boolean(true)\r\nfunction isBooleanObject(obj){\r\n\treturn obj && typeof obj === \"object\"\r\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\r\n}\r\n\r\nfunction isDate(obj) {\r\n\tif (obj && typeof obj === \"object\") {\r\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\r\n\t} else {\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction isValidDate(obj){\r\n\treturn isDate(obj) && !isNaN(obj.getTime());\r\n}\r\n\r\nfunction arrayFilter(arr, callback) {\r\n\tvar result = [];\r\n\r\n\tif (arr.filter) {\r\n\t\treturn arr.filter(callback);\r\n\t} else {\r\n\t\tfor (var i = 0; i < arr.length; i++) {\r\n\t\t\tif (callback(arr[i], i)) {\r\n\t\t\t\tresult[result.length] = arr[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nfunction hashToArray(hash) {\r\n\tvar result = [];\r\n\r\n\tfor (var key in hash) {\r\n\t\tif (hash.hasOwnProperty(key)) {\r\n\t\t\tresult.push(hash[key]);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction arraySome(arr, callback) {\r\n\tif (arr.length === 0) return false;\r\n\r\n\tfor (var i = 0; i < arr.length; i++) {\r\n\t\tif (callback(arr[i], i, arr)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction arrayDifference(arr, callback) {\r\n\treturn arrayFilter(arr, function(item, i) {\r\n\t\treturn !callback(item, i);\r\n\t});\r\n}\r\n\r\nfunction throttle (callback, timeout) {\r\n\tvar wait = false;\r\n\r\n\treturn function () {\r\n\t\tif (!wait) {\r\n\t\t\tcallback.apply(null, arguments);\r\n\t\t\twait = true;\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\twait = false;\r\n\t\t\t}, timeout);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction delay (callback, timeout){\r\n\tvar timer;\r\n\r\n\tvar result = function() {\r\n\t\tresult.$cancelTimeout();\r\n\t\tresult.$pending = true;\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\ttimer = setTimeout(function(){\r\n\t\t\tcallback.apply(this, args);\r\n\t\t\tresult.$pending = false;\r\n\t\t}, timeout);\r\n\t};\r\n\r\n\tresult.$pending = false;\r\n\tresult.$cancelTimeout = function(){\r\n\t\tclearTimeout(timer);\r\n\t\tresult.$pending = false;\r\n\t};\r\n\tresult.$execute = function(){\r\n\t\tvar args = Array.prototype.slice.call(arguments);\r\n\t\tcallback.apply(this, args);\r\n\t\tresult.$cancelTimeout();\r\n\t};\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction sortArrayOfHash(arr, field, desc) {\r\n\tvar compare = function(a, b) {\r\n\t\treturn a < b;\r\n\t};\r\n\r\n\tarr.sort(function(a, b) {\r\n\t\tif (a[field] === b[field]) return 0;\r\n\r\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\r\n\t});\r\n}\r\n\r\nfunction objectKeys(obj) {\r\n\tif (Object.keys) {\r\n\t\treturn Object.keys(obj);\r\n\t}\r\n\tvar result = [];\r\n\tvar key;\r\n\tfor (key in obj) {\r\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n\t\t\tresult.push(key);\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction isEventable(obj) {\r\n\treturn obj.attachEvent && obj.detachEvent;\r\n}\r\n\r\n//GS-1090: A task should be able to have the id = 0\r\nfunction replaceValidZeroId(id, rootId) {\r\n\tif (checkZeroId(id) && !checkZeroId(rootId)){\r\n\t\tid = \"0\";\r\n\t}\r\n\treturn id;\r\n}\r\n\r\nfunction checkZeroId(id) {\r\n\tif (id === 0){\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction findBinary(array, target) {\r\n\t// modified binary search, target value not exactly match array elements, looking for closest one\r\n\r\n\tvar low = 0, high = array.length - 1, i, item, prev;\r\n\twhile (low <= high) {\r\n\r\n\t\ti = Math.floor((low + high) / 2);\r\n\t\titem = +array[i];\r\n\t\tprev = +array[i - 1];\r\n\t\tif (item < target) {\r\n\t\t\tlow = i + 1;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (item > target) {\r\n\t\t\tif (!(!isNaN(prev) && prev < target)) {\r\n\t\t\t\thigh = i - 1;\r\n\t\t\t\tcontinue;\r\n\t\t\t} else {\r\n\t\t\t\t// if target is between 'i' and 'i-1' return 'i - 1'\r\n\t\t\t\treturn i - 1;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\twhile (+array[i] == +array[i + 1]) i++;\r\n\r\n\t\treturn i;\r\n\t}\r\n\treturn array.length - 1;\r\n}\r\n\r\nexport {\r\n\tgetSecondsInUnit,\r\n\tforEach,\r\n\tarrayMap,\r\n\tarrayIncludes,\r\n\tarrayFind,\r\n\tarrayFilter,\r\n\tarrayDifference,\r\n\tarraySome,\r\n\thashToArray,\r\n\tsortArrayOfHash,\r\n\tthrottle,\r\n\tisArray,\r\n\tisDate,\r\n\tisValidDate,\r\n\tisStringObject,\r\n\tisNumberObject,\r\n\tisBooleanObject,\r\n\tdelay,\r\n\tobjectKeys,\r\n\tisEventable,\r\n\treplaceValidZeroId,\r\n\tcheckZeroId,\r\n\tfindBinary\r\n};","import eventable from \"../../utils/eventable\";\r\nimport { isEventable } from \"../../utils/helpers\";\r\n\r\nexport interface ISelectedRegionConfig {\r\n\tclassName?: string;\r\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\r\n\tviewPort?: HTMLElement;\r\n\tuseRequestAnimationFrame: boolean;\r\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\r\n\tsingleRow: boolean;\r\n}\r\n\r\ninterface ICoordinates {\r\n\tleft: number;\r\n\ttop: number;\r\n}\r\n\r\nexport interface IPoint {\r\n\tabsolute: ICoordinates;\r\n\trelative: ICoordinates;\r\n}\r\n\r\nexport class SelectedRegion {\r\n\trender: () => void;\r\n\tprivate _viewPort: HTMLElement & eventable;\r\n\tprivate _el: HTMLElement = document.createElement(\"div\");\r\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\r\n\tprivate _startPoint: IPoint;\r\n\tprivate _endPoint: IPoint;\r\n\tprivate _positionPoint: IPoint;\r\n\tprivate _useRequestAnimationFrame: boolean;\r\n\tprivate _startDate: Date;\r\n\tprivate _endDate: Date;\r\n\tprivate _singleRow: boolean;\r\n\tprivate _gantt: any;\r\n\tprivate _view: any;\r\n\r\n\tconstructor(config: ISelectedRegionConfig, gantt: any, view: any) {\r\n\t\tthis._gantt = gantt;\r\n\t\tthis._view = view;\r\n\t\tthis._viewPort = config.viewPort;\r\n\t\tthis._el.classList.add(config.className);\r\n\t\tif (typeof config.callback === \"function\") {\r\n\t\t\tthis._callback = config.callback;\r\n\t\t}\r\n\r\n\t\tthis.render = () => {\r\n\t\t\tlet node;\r\n\t\t\tif(config.render){\r\n\t\t\t\tnode = config.render(this._startPoint, this._endPoint);\r\n\t\t\t}else{\r\n\t\t\t\tnode = this.defaultRender(this._startPoint, this._endPoint);\r\n\t\t\t}\r\n\r\n\t\t\tif(node !== this._el){\r\n\t\t\t\tif(this._el && this._el.parentNode){\r\n\t\t\t\t\tthis._el.parentNode.removeChild(this._el);\r\n\t\t\t\t}\r\n\t\t\t\tthis._el = node;\r\n\t\t\t}\r\n\r\n\t\t\tif (config.className !== \"\") {\r\n\t\t\t\tthis._el.classList.add(config.className);\r\n\t\t\t}\r\n\t\t\tthis.draw();\r\n\t\t};\r\n\r\n\t\tif (!isEventable(this._viewPort)) {\r\n\t\t\teventable(this._viewPort);\r\n\t\t}\r\n\t\tthis._singleRow = config.singleRow;\r\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\r\n\t}\r\n\r\n\tdefaultRender = (start: IPoint, end: IPoint) => {\r\n\t\tif(!this._el){\r\n\t\t\tthis._el = document.createElement(\"div\");\r\n\t\t}\r\n\t\tconst node = this._el;\r\n\t\t// const gantt = this._gantt;\r\n\r\n\t\tconst top = Math.min(start.relative.top, end.relative.top);\r\n\t\tconst bottom = Math.max(start.relative.top, end.relative.top);\r\n\t\tconst left = Math.min(start.relative.left, end.relative.left);\r\n\t\tconst right = Math.max(start.relative.left, end.relative.left);\r\n\r\n\t\tif (this._singleRow) {\r\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\r\n\t\t\tnode.style.height = pos.height + \"px\";\r\n\t\t\tnode.style.top = pos.top + \"px\";\r\n\t\t} else {\r\n\t\t\tnode.style.height = Math.abs(bottom - top) + \"px\";\r\n\t\t\tnode.style.top = top + \"px\";\r\n\t\t}\r\n\t\tnode.style.width = Math.abs(right - left) + \"px\";\r\n\t\tnode.style.left = left + \"px\";\r\n\t\treturn node;\r\n\t};\r\n\r\n\tdraw() {\r\n\t\tif (this._useRequestAnimationFrame) {\r\n\t\t\treturn requestAnimationFrame(() => {\r\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis._viewPort.appendChild(this.getElement());\r\n\t\t}\r\n\t}\r\n\r\n\tclear() {\r\n\t\tif (this._useRequestAnimationFrame) {\r\n\t\t\treturn requestAnimationFrame(() => {\r\n\t\t\t\tif (!this._el.parentNode) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis._viewPort.removeChild(this._el);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif (!this._el.parentNode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._viewPort.removeChild(this._el);\r\n\t\t}\r\n\t}\r\n\r\n\tgetElement() {\r\n\t\treturn this._el;\r\n\t}\r\n\r\n\tgetViewPort() {\r\n\t\treturn this._viewPort;\r\n\t}\r\n\r\n\tsetStart(startPoint: IPoint) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._startPoint = startPoint;\r\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\r\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\r\n\t}\r\n\r\n\tsetEnd(endPoint: IPoint) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._endPoint = endPoint;\r\n\t\tif (this._singleRow) {\r\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\r\n\t\t\tthis._endPoint.relative.top = pos.top;\r\n\t\t}\r\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\r\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\r\n\t\t\tthis._positionPoint = {\r\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\r\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\r\n\t\t\tthis._positionPoint = {\r\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\r\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\r\n\t\t\t};\r\n\t\t}\r\n\r\n\r\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\r\n\t}\r\n\r\n\tsetPosition(positionPoint: IPoint) {\r\n\t\tthis._positionPoint = positionPoint;\r\n\t}\r\n\r\n\tdragEnd(endPoint: IPoint) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tif(endPoint.relative.left < 0){\r\n\t\t\tendPoint.relative.left = 0;\r\n\t\t}\r\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\r\n\t\tthis.setEnd(endPoint);\r\n\t\t// GS-1422. The endDate can be null if we drag the mouse outside the Gantt container\r\n\t\tthis._endDate = this._endDate || gantt.getState().max_date;\r\n\r\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\r\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\r\n\t\t}\r\n\t\tthis.clear();\r\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\r\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\r\n\r\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\r\n\t\tif (this._callback) {\r\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\r\n\t\t}\r\n\t}\r\n\r\n\tgetInBounds() {\r\n\t\treturn this._singleRow;\r\n\t}\r\n\r\n\tprivate _getTasksByTop(start: number, end:number) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tlet startValue = start;\r\n\t\tlet endValue = end;\r\n\t\tif (start > end) {\r\n\t\t\tstartValue = end;\r\n\t\t\tendValue = start;\r\n\t\t}\r\n\t\tconst startIndex = this._getTaskPositionByTop(startValue).index;\r\n\t\tconst endIndex = this._getTaskPositionByTop(endValue).index;\r\n\t\tconst result = [];\r\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\r\n\t\t\tconst task = gantt.getTaskByIndex(i);\r\n\t\t\tif (task) {\r\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate _getTaskPositionByTop(top: number){\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst view = this._view;\r\n\t\tconst index = view.getItemIndexByTopPosition(top);\r\n\t\tconst task = gantt.getTaskByIndex(index);\r\n\t\tif(task){\r\n\t\t\tconst height = view.getItemHeight(task.id);\r\n\t\t\tconst itemTop = view.getItemTop(task.id);\r\n\t\t\treturn {\r\n\t\t\t\ttop: itemTop || 0,\r\n\t\t\t\theight: height || 0,\r\n\t\t\t\tindex\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tconst dataHeight = view.getTotalHeight();\r\n\t\t\treturn {\r\n\t\t\t\ttop: top > dataHeight ? dataHeight : 0,\r\n\t\t\t\theight: gantt.config.row_height,\r\n\t\t\t\tindex: top > dataHeight ? gantt.getTaskCount() : 0\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n}","interface IPoint {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\nlet _dragInProgress: boolean = false;\r\n\r\nexport class EventsManager {\r\n\tstatic create(gantt: any) {\r\n\t\treturn new EventsManager(gantt);\r\n\t}\r\n\tstatic _isDragInProgress() {\r\n\t\treturn _dragInProgress;\r\n\t}\r\n\tprivate _mouseDown: boolean = false;\r\n\tprivate _startPoint: IPoint;\r\n\tprivate _scrollState: IPoint;\r\n\tprivate _originAutoscroll: boolean;\r\n\tprivate _domEvents: any;\r\n\tprivate _timeline: any;\r\n\tprivate _gantt: any;\r\n\tprivate _trace: IPoint[];\r\n\tprivate _originalReadonly: boolean;\r\n\r\n\tconstructor(gantt: any) {\r\n\t\tthis._gantt = gantt;\r\n\t\tthis._domEvents = gantt._createDomEventScope();\r\n\t\tthis._trace = [];\r\n\t}\r\n\r\n\tdestructor() {\r\n\t\tthis._domEvents.detachAll();\r\n\t}\r\n\r\n\tattach(timeline: any): void {\r\n\t\tthis._timeline = timeline;\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._domEvents.attach(timeline.$task, \"mousedown\", (event) => {\r\n\t\t\tif (!gantt.config.drag_timeline) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst { useKey,ignore, enabled } = gantt.config.drag_timeline;\r\n\t\t\tif(enabled === false) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\r\n\t\t\tif(ignore !== undefined) {\r\n\t\t\t\tif(ignore instanceof Array){\r\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilterTargets = ignore;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (filterTargets) {\r\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\r\n\t\t\tthis._startDrag(event);\r\n\t\t});\r\n\r\n\t\tthis._domEvents.attach(document, \"keydown\", (event) => {\r\n\t\t\tif (!gantt.config.drag_timeline) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\r\n\t\t\tif (useKey && event[useKey] === true) {\r\n\t\t\t\tthis._applyDndReadyStyles();\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis._domEvents.attach(document, \"keyup\", (event) => {\r\n\t\t\tif (!gantt.config.drag_timeline) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\r\n\t\t\tif (useKey && event[useKey] === false) {\r\n\t\t\t\tthis._clearDndReadyStyles();\r\n\t\t\t\tthis._stopDrag(event);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._domEvents.attach(document, \"mouseup\", (event) => {\r\n\t\t\tthis._stopDrag(event);\r\n\t\t});\r\n\t\tthis._domEvents.attach(gantt.$root, \"mouseup\", (event) => {\r\n\t\t\tthis._stopDrag(event);\r\n\t\t});\r\n\t\tthis._domEvents.attach(document, \"mouseleave\", (event) => {\r\n\t\t\tthis._stopDrag(event);\r\n\t\t});\r\n\t\tthis._domEvents.attach(gantt.$root, \"mouseleave\", (event) => {\r\n\t\t\tthis._stopDrag(event);\r\n\t\t});\r\n\r\n\t\tthis._domEvents.attach(gantt.$root, \"mousemove\", (event) => {\r\n\t\t\tif (!gantt.config.drag_timeline) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\r\n\t\t\tif (useKey && event[useKey] !== true) { return; }\r\n\t\t\t// GS-854. If we don't have useKey for the drag_timeline extension,\r\n\t\t\t// check the click_drag to not simultaneously use both extensions\r\n\t\t\tconst clickDrag = this._gantt.ext.clickDrag;\r\n\t\t\tconst clickDragUseKey = (this._gantt.config.click_drag || {}).useKey;\r\n\t\t\tif (clickDrag && clickDragUseKey) {\r\n\t\t\t\tif (!useKey && event[clickDragUseKey]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this._mouseDown === true) {\r\n\t\t\t\tthis._trace.push({ x: event.clientX, y: event.clientY });\r\n\t\t\t\tconst scrollPosition: IPoint = this._countNewScrollPosition({ x: event.clientX, y: event.clientY });\r\n\t\t\t\tthis._setScrollPosition(timeline, scrollPosition);\r\n\t\t\t\tthis._scrollState = scrollPosition;\r\n\t\t\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _calculateDirectionVector = () => {\r\n\t\tconst traceSteps = 10;\r\n\t\tif(this._trace.length >= traceSteps) {\r\n\t\t\tconst dots = this._trace.slice(this._trace.length - traceSteps);\r\n\r\n\t\t\tconst vectors = [];\r\n\t\t\tfor(let i = 1; i < dots.length; i++) {\r\n\t\t\t\tvectors.push({\r\n\t\t\t\t\tx: dots[i].x - dots[i - 1].x,\r\n\t\t\t\t\ty: dots[i].y - dots[i - 1].y\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconst resultVector = {x:0, y:0};\r\n\r\n\t\t\tvectors.forEach((vector) => {\r\n\t\t\t\tresultVector.x += vector.x;\r\n\t\t\t\tresultVector.y += vector.y;\r\n\t\t\t});\r\n\r\n\t\t\tconst magnitude = Math.sqrt(resultVector.x*resultVector.x + resultVector.y*resultVector.y);\r\n\t\t\tconst angleDegrees = Math.atan2(Math.abs(resultVector.y), Math.abs(resultVector.x)) * 180 / Math.PI;\r\n\r\n\t\t\treturn {\r\n\t\t\t\tmagnitude,\r\n\t\t\t\tangleDegrees\r\n\t\t\t};\r\n\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\r\n\tprivate _applyDndReadyStyles = (): void => {\r\n\t\tthis._timeline.$task.classList.add(\"gantt_timeline_move_available\");\r\n\t};\r\n\r\n\tprivate _clearDndReadyStyles = (): void => {\r\n\t\tthis._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\r\n\t};\r\n\r\n\tprivate _getScrollPosition = (timeline: any): IPoint => {\r\n\t\tconst gantt = this._gantt;\r\n\t\treturn {\r\n\t\t\tx: gantt.$ui.getView(timeline.$config.scrollX).getScrollState().position,\r\n\t\t\ty: gantt.$ui.getView(timeline.$config.scrollY).getScrollState().position\r\n\t\t};\r\n\t};\r\n\tprivate _countNewScrollPosition = (coords: IPoint): IPoint => {\r\n\t\tconst vector = this._calculateDirectionVector();\r\n\t\tlet shiftX = this._startPoint.x - coords.x;\r\n\t\tlet shiftY = this._startPoint.y - coords.y;\r\n\t\tif(vector){\r\n\t\t\tif(vector.angleDegrees < 15){\r\n\t\t\t\tshiftY = 0;\r\n\t\t\t} else if(vector.angleDegrees > 75){\r\n\t\t\t\tshiftX = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst result = {\r\n\t\t\tx: this._scrollState.x + shiftX,\r\n\t\t\ty: this._scrollState.y + shiftY\r\n\t\t};\r\n\t\treturn result;\r\n\t};\r\n\tprivate _setScrollPosition = (timeline: any, coords: IPoint): void => {\r\n\t\tconst gantt = this._gantt;\r\n\t\trequestAnimationFrame(() => {\r\n\t\t\tgantt.scrollLayoutCell(timeline.$id, coords.x, coords.y);\r\n\t\t});\r\n\t};\r\n\tprivate _stopDrag = (event: Event): void => {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._trace = [];\r\n\t\tgantt.$root.classList.remove(\"gantt_noselect\");\r\n\r\n\t\t// We need to set the readonly mode because with the key modifiers, \r\n\t\t// users may expect to start dragging the timeline on the task and link coordinates\r\n\t\tif(this._originalReadonly !== undefined && this._mouseDown){\r\n\t\t\tgantt.config.readonly = this._originalReadonly;\r\n\t\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\r\n\t\t\t\tgantt.render();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(this._originAutoscroll !== undefined){\r\n\t\t\tgantt.config.autoscroll = this._originAutoscroll;\r\n\t\t}\r\n\r\n\t\tif(gantt.config.drag_timeline){\r\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\r\n\t\t\tif (useKey && event[useKey] !== true) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._mouseDown = false;\r\n\t\t_dragInProgress = false;\r\n\t};\r\n\r\n\tprivate _startDrag = (event: any) : void => {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis._originAutoscroll = gantt.config.autoscroll;\r\n\t\tgantt.config.autoscroll = false;\r\n\t\t_dragInProgress = true;\r\n\r\n\t\tgantt.$root.classList.add(\"gantt_noselect\");\r\n\t\tthis._originalReadonly = gantt.config.readonly;\r\n\t\tgantt.config.readonly = true;\r\n\r\n\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\r\n\t\t\tgantt.render();\r\n\t\t}\r\n\r\n\t\tthis._trace = [];\r\n\t\tthis._mouseDown = true;\r\n\t\tconst { x, y } = this._getScrollPosition(this._timeline);\r\n\t\tthis._scrollState = { x, y };\r\n\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\r\n\t\tthis._trace.push(this._startPoint);\r\n\t};\r\n}","export default function(gantt) {\r\n\r\n\t(function () {\r\n\t\tvar modalsStack = [];\r\n\r\n\t\tfunction isModal() {\r\n\t\t\treturn !!modalsStack.length;\r\n\t\t}\r\n\r\n\t\tfunction afterPopup(box) {\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tif (!isModal()){\r\n\t\t\t\t\tif(!gantt.$destroyed){\r\n\t\t\t\t\t\tgantt.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t}\r\n\r\n\t\tfunction startModal(box) {\r\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\r\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\r\n\t\t\tmodalsStack.push(box);\r\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\r\n\t\t}\r\n\r\n\t\tfunction endModal() {\r\n\t\t\tvar box = modalsStack.pop();\r\n\t\t\tif (box) {\r\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\r\n\t\t\t}\r\n\t\t\tafterPopup(box);\r\n\r\n\t\t}\r\n\r\n\r\n\t\tfunction isTopModal(box) {\r\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\r\n\t\t}\r\n\r\n\t\tfunction trapFocus(event) {\r\n\t\t\tvar target = event.currentTarget;\r\n\t\t\tif (!isTopModal(target)) return;\r\n\r\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\r\n\t\t}\r\n\r\n\t\tfunction traceLightbox() {\r\n\t\t\tstartModal(gantt.getLightbox());\r\n\t\t}\r\n\r\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\r\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\r\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\r\n\t\t\tendModal();\r\n\t\t\ttraceLightbox();\r\n\t\t});\r\n\r\n\r\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\r\n\t\t\tafterPopup();\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\r\n\t\t\tsaveFocus();\r\n\t\t\tstartModal(box);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\r\n\t\t\tendModal();\r\n\t\t\trestoreFocus();\r\n\t\t});\r\n\r\n\t\tvar focusElement = null;\r\n\r\n\t\tfunction saveFocus() {\r\n\t\t\tfocusElement = gantt.utils.dom.getActiveElement();\r\n\t\t}\r\n\r\n\t\tfunction restoreFocus() {\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tif (focusElement && focusElement.focus) {\r\n\t\t\t\t\tfocusElement.focus();\r\n\t\t\t\t\tfocusElement = null;\r\n\t\t\t\t}\r\n\t\t\t}, 1);\r\n\t\t}\r\n\r\n\t\tgantt.$keyboardNavigation.isModal = isModal;\r\n\r\n\r\n\t})();\r\n\r\n};","\r\ninterface IQuickInfoContainer{\r\n\tparent: HTMLElement;\r\n\txViewport: HTMLElement;\r\n\tyViewport: HTMLElement;\r\n}\r\n\r\nexport class QuickInfo {\r\n\tprivate _quickInfoTask: TaskID;\r\n\tprivate _quickInfoBoxId: number | string;\r\n\tprivate _quickInfoBox: HTMLElement;\r\n\tprivate _quickInfoReadonly: boolean | null;\r\n\tprivate _container: HTMLElement;\r\n\tprivate _gantt: any;\r\n\r\n\tconstructor(gantt: any) {\r\n\t\tthis._gantt = gantt;\r\n\t}\r\n\r\n\t// show at coordinates:\r\n\t// show(x: number, y: number)\r\n\t// show for a task:\r\n\t// show(id: TaskID)\r\n\tshow : {\r\n\t\t(x: number, y: number) : void;\r\n\t\t(id: TaskID) : void;\r\n\t} = (id: TaskID | number, y? : number) : void => {\r\n\t\tif (y === undefined) {\r\n\t\t\tthis._showForTask(id);\r\n\t\t} else {\r\n\t\t\tthis._showAtCoordinates(id as number, y);\r\n\t\t}\r\n\t};\r\n\r\n\thide = (forced?: boolean) : any => {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst qi = this._quickInfoBox;\r\n\t\tthis._quickInfoBoxId = 0;\r\n\t\tconst taskId = this._quickInfoTask;\r\n\t\tthis._quickInfoTask = null;\r\n\r\n\t\tif (qi && qi.parentNode){\r\n\r\n\t\t\tif (gantt.config.quick_info_detached) {\r\n\t\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\r\n\t\t\t\treturn qi.parentNode.removeChild(qi);\r\n\t\t\t}\r\n\r\n\t\t\tqi.className += \" gantt_qi_hidden\";\r\n\t\t\tif (qi.style.right === \"auto\"){\r\n\t\t\t\tqi.style.left = \"-350px\";\r\n\t\t\t} else {\r\n\t\t\t\tqi.style.right = \"-350px\";\r\n\t\t\t}\r\n\r\n\t\t\tif (forced) {\r\n\t\t\t\tqi.style.left = qi.style.right = \"\";\r\n\t\t\t\tqi.parentNode.removeChild(qi);\r\n\t\t\t}\r\n\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\r\n\t\t}\r\n\t};\r\n\r\n\tgetNode = (): HTMLElement => {\r\n\t\tif(this._quickInfoBox) {\r\n\t\t\treturn this._quickInfoBox;\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\r\n\tsetContainer = (container: string|HTMLElement): void => {\r\n\t\tif(container){\r\n\t\t\tthis._container = typeof container === \"string\" ? document.getElementById(container) : container;\r\n\t\t}\r\n\t};\r\n\r\n\tsetContent = (content?: IQuickInfoContent) => {\r\n\t\tconst gantt = this._gantt;\r\n\r\n\t\tconst defaultContent = {\r\n\t\t\ttaskId: null,\r\n\t\t\theader: {\r\n\t\t\t\ttitle: \"\",\r\n\t\t\t\tdate: \"\"\r\n\t\t\t},\r\n\t\t\tcontent: \"\",\r\n\t\t\tbuttons: gantt.config.quickinfo_buttons\r\n\t\t};\r\n\r\n\t\tif(!content){\r\n\t\t\tcontent = defaultContent;\r\n\t\t}\r\n\r\n\t\tif(!content.taskId){\r\n\t\t\tcontent.taskId = defaultContent.taskId;\r\n\t\t}\r\n\r\n\t\tif(!content.header){\r\n\t\t\tcontent.header = defaultContent.header;\r\n\t\t}\r\n\r\n\t\tif(!content.header.title){\r\n\t\t\tcontent.header.title = defaultContent.header.title;\r\n\t\t}\r\n\t\tif(!content.header.date){\r\n\t\t\tcontent.header.date = defaultContent.header.date;\r\n\t\t}\r\n\t\tif(!content.content){\r\n\t\t\tcontent.content = defaultContent.content;\r\n\t\t}\r\n\t\tif(!content.buttons){\r\n\t\t\tcontent.buttons = defaultContent.buttons;\r\n\t\t}\r\n\r\n\r\n\t\tlet qi = this.getNode();\r\n\t\tif(!qi){\r\n\t\t\tqi = this._createQuickInfoElement();\r\n\t\t}\r\n\r\n\t\tif(content.taskId){\r\n\t\t\tthis._quickInfoBoxId = content.taskId;\r\n\t\t}\r\n\r\n\t\tconst titleBox = qi.querySelector(\".gantt_cal_qi_title\") as HTMLElement;\r\n\t\tconst titleContent = titleBox.querySelector(\".gantt_cal_qi_tcontent\");\r\n\t\tconst titleDate = titleBox.querySelector(\".gantt_cal_qi_tdate\");\r\n\t\tconst main = qi.querySelector(\".gantt_cal_qi_content\");\r\n\t\tconst controls = qi.querySelector(\".gantt_cal_qi_controls\") as HTMLElement;\r\n\r\n\t\tgantt._waiAria.quickInfoHeader(qi, [content.header.title, content.header.date].join(\" \"));\r\n\r\n\t\ttitleContent.innerHTML = content.header.title;\r\n\t\ttitleDate.innerHTML = content.header.date;\r\n\r\n\t\tif(!content.header.title && !content.header.date){\r\n\t\t\ttitleBox.style.display = \"none\";\r\n\t\t}else{\r\n\t\t\ttitleBox.style.display = \"\";\r\n\t\t}\r\n\t\tmain.innerHTML = content.content;\r\n\r\n\t\tconst buttons = content.buttons;\r\n\t\tif(!buttons.length){\r\n\t\t\tcontrols.style.display = \"none\";\r\n\t\t}else{\r\n\t\t\tcontrols.style.display = \"\";\r\n\t\t}\r\n\t\tlet html = \"\";\r\n\t\tfor (let i = 0; i < buttons.length; i++){\r\n\r\n\t\t\tconst ariaAttr = gantt._waiAria.quickInfoButtonAttrString(gantt.locale.labels[buttons[i]]);\r\n\r\n\t\t\thtml += `<div class=\"gantt_qi_big_icon ${buttons[i]} dhx_gantt_${buttons[i]}\" title=\"${gantt.locale.labels[buttons[i]]}\" ${ariaAttr}>\r\n            <div class='dhx_menu_icon dhx_gantt_icon ${buttons[i]} gantt_menu_icon dhx_gantt_${buttons[i]}'></div>\r\n            <div>${gantt.locale.labels[buttons[i]]}</div>\r\n         </div>`;\r\n\t\t}\r\n\t\tcontrols.innerHTML = html;\r\n\r\n\t\tgantt.eventRemove(qi, \"click\", this._qiButtonClickHandler);\r\n\t\tgantt.eventRemove(qi, \"keypress\", this._qiKeyPressHandler);\r\n\r\n\t\tgantt.event(qi, \"click\", this._qiButtonClickHandler);\r\n\t\tgantt.event(qi, \"keypress\", this._qiKeyPressHandler);\r\n\t};\r\n\r\n\tprivate _qiButtonClickHandler = (ev) => {\r\n\t\tthis._qi_button_click(ev.target);\r\n\t};\r\n\r\n\tprivate _qiKeyPressHandler = (e) => {\r\n\r\n\t\tconst code = e.which;\r\n\t\tif (code === 13 || code === 32){\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis._qi_button_click(e.target);\r\n\t\t\t},1);\r\n\t\t}\r\n\t};\r\n\r\n\tprivate _showAtCoordinates(x: number, y: number) : void {\r\n\t\tthis.hide(true);\r\n\t\tthis._quickInfoBoxId = 0;\r\n\t\tthis._quickInfoTask = null;\r\n\t\tif(!this._quickInfoBox){\r\n\t\t\tthis._createQuickInfoElement();\r\n\t\t\tthis.setContent();\r\n\t\t}\r\n\r\n\t\tthis._appendAtCoordinates(x, y);\r\n\t\tthis._gantt.callEvent(\"onQuickInfo\", [null]);\r\n\t}\r\n\r\n\tprivate _showForTask(id: TaskID) : void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tif ((\r\n\t\t\tid === this._quickInfoBoxId &&\r\n\t\t\tgantt.utils.dom.isChildOf(this._quickInfoBox, document.body)\r\n\t\t) || !gantt.config.show_quick_info) {\r\n\t\t\t// not show if the quick info is already displayed for this task, or if it shouldn't be displayed\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.hide(true);\r\n\t\tconst offset = 6; // offset TASK <> QI-BOX in 'px'\r\n\t\tconst container = this._getContainer();\r\n\t\tconst pos = this._get_event_counter_part(id, offset, container.xViewport, container.yViewport);\r\n\r\n\t\tif (pos){\r\n\t\t\tthis._quickInfoBox = this._init_quick_info(id);\r\n\t\t\tthis._quickInfoTask = id;\r\n\t\t\tthis._quickInfoBox.className = this._prepare_quick_info_classname(id);\r\n\r\n\t\t\tthis._fill_quick_data(id);\r\n\t\t\tthis._show_quick_info(pos, offset);\r\n\t\t\tgantt.callEvent(\"onQuickInfo\", [id]);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _get_event_counter_part(id: TaskID, offset: number, xViewport: HTMLElement, yViewport: HTMLElement) : any {\r\n\t\tconst gantt = this._gantt;\r\n\t\tlet domEv = gantt.getTaskNode(id);\r\n\t\tif (!domEv) {\r\n\t\t\tdomEv = gantt.getTaskRowNode(id);\r\n\t\t\tif (!domEv) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet left = 0;\r\n\t\tconst top = offset + domEv.offsetTop + domEv.offsetHeight;\r\n\r\n\t\tlet node = domEv;\r\n\r\n\t\tif (gantt.utils.dom.isChildOf(node, xViewport)) {\r\n\t\t\twhile (node && node !== xViewport){\r\n\t\t\t\tleft += node.offsetLeft;\r\n\t\t\t\tnode = node.offsetParent;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst scroll = gantt.getScrollState();\r\n\r\n\t\tif(node){\r\n\t\t\tconst dx = (left + domEv.offsetWidth/2) - scroll.x > (xViewport.offsetWidth/2) ? 1 : 0;\r\n\t\t\tconst dy = (top + domEv.offsetHeight/2) - scroll.y > (yViewport.offsetHeight/2) ? 1 : 0;\r\n\r\n\t\t\treturn { left, top, dx, dy, width:domEv.offsetWidth, height:domEv.offsetHeight };\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate _createQuickInfoElement() : HTMLElement {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst qi = document.createElement(\"div\");\r\n\t\tqi.className += \"gantt_cal_quick_info\";\r\n\t\tgantt._waiAria.quickInfoAttr(qi);\r\n\r\n\t\t// title\r\n\t\tconst ariaAttr = gantt._waiAria.quickInfoHeaderAttrString();\r\n\t\tvar html = `\r\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\r\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\r\n\t\t</div>\r\n\t\t<div class=\"gantt_cal_qi_title\" ${ariaAttr}>\r\n\t\t\t\t\r\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\r\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\r\n\r\n\t\t//buttons\r\n\t\thtml += \"<div class=\\\"gantt_cal_qi_controls\\\">\";\r\n\r\n\t\thtml += \"</div>\";\r\n\r\n\t\tqi.innerHTML = html;\r\n\r\n\r\n\t\tif (gantt.config.quick_info_detached) {\r\n\t\t\tconst container = this._getContainer();\r\n\t\t\tgantt.event(container.parent, \"scroll\", () => { this.hide(); });\r\n\t\t}\r\n\r\n\t\tthis._quickInfoBox = qi;\r\n\t\treturn qi;\r\n\t}\r\n\r\n\tprivate _init_quick_info(id: TaskID) : HTMLElement {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst task = gantt.getTask(id);\r\n\t\t\r\n\r\n\t\tif(typeof this._quickInfoReadonly === \"boolean\"){\r\n\t\t\tif(gantt.isReadonly(task) !== this._quickInfoReadonly){\r\n\t\t\t\tthis.hide(true);\r\n\t\t\t\tthis._quickInfoBox = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._quickInfoReadonly = gantt.isReadonly(task);\r\n\r\n\t\tif (!this._quickInfoBox){\r\n\t\t\tthis._quickInfoBox = this._createQuickInfoElement();\r\n\t\t}\r\n\r\n\t\treturn this._quickInfoBox;\r\n\t}\r\n\r\n\tprivate _prepare_quick_info_classname(id: TaskID) : string {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst task = gantt.getTask(id);\r\n\t\tconst taskType = gantt.getTaskType(task);\r\n\r\n\t\tlet css = `gantt_cal_quick_info gantt_${taskType}`;\r\n\t\tconst template = gantt.templates.quick_info_class(task.start_date, task.end_date, task);\r\n\r\n\t\tif(template){\r\n\t\t\tcss += \" \" + template;\r\n\t\t}\r\n\t\treturn css;\r\n\t}\r\n\r\n\tprivate _fill_quick_data(id: TaskID) : void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst ev = gantt.getTask(id);\r\n\r\n\t\tthis._quickInfoBoxId = id;\r\n\r\n\t\tlet allowedButtons = [];\r\n\t\tif (this._quickInfoReadonly){\r\n\t\t\tconst buttons = gantt.config.quickinfo_buttons;\r\n\t\t\tconst isEditor = {icon_delete: true, icon_edit: true};\r\n\t\t\tfor (let i = 0; i < buttons.length; i++){\r\n\t\t\t\tif(this._quickInfoReadonly && isEditor[buttons[i]]){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tallowedButtons.push(buttons[i]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tallowedButtons = gantt.config.quickinfo_buttons;\r\n\t\t}\r\n\r\n\t\tthis.setContent({\r\n\t\t\theader: {\r\n\t\t\t\ttitle: gantt.templates.quick_info_title(ev.start_date, ev.end_date, ev),\r\n\t\t\t\tdate: gantt.templates.quick_info_date(ev.start_date, ev.end_date, ev)\r\n\t\t\t},\r\n\t\t\tcontent: gantt.templates.quick_info_content(ev.start_date, ev.end_date, ev),\r\n\t\t\tbuttons: allowedButtons\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _appendAtCoordinates(x: number, y: number): void {\r\n\t\tconst qi = this._quickInfoBox;\r\n\t\tconst container = this._getContainer();\r\n\t\tif (!qi.parentNode ||\r\n\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\r\n\t\t\tcontainer.parent.appendChild(qi);\r\n\t\t}\r\n\r\n\t\tqi.style.left = x + \"px\";\r\n\t\tqi.style.top = y + \"px\";\r\n\t}\r\n\r\n\tprivate _show_quick_info(pos: any, offset: number) : void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst qi = this._quickInfoBox;\r\n\t\tif (gantt.config.quick_info_detached) {\r\n\t\t\tconst container = this._getContainer();\r\n\t\t\tif (!qi.parentNode ||\r\n\t\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\r\n\t\t\t\tcontainer.parent.appendChild(qi);\r\n\t\t\t}\r\n\t\t\tconst width = qi.offsetWidth;\r\n\t\t\tconst popupHeight = qi.offsetHeight;\r\n\r\n\t\t\tconst scrolls = gantt.getScrollState();\r\n\t\t\tconst xViewport = container.xViewport;\r\n\t\t\tconst yViewport = container.yViewport;\r\n\t\t\tconst screenWidth = xViewport.offsetWidth + scrolls.x - width;\r\n\r\n\t\t\tconst relativePopupTop = pos.top - scrolls.y;\r\n\t\t\tconst relativePopupBottom = relativePopupTop + popupHeight;\r\n\r\n\t\t\tlet top = pos.top;\r\n\t\t\tif(relativePopupBottom > yViewport.offsetHeight / 2){\r\n\t\t\t\ttop = pos.top - (popupHeight + pos.height + 2*offset);\r\n\t\t\t\tif(top < scrolls.y && relativePopupBottom <= yViewport.offsetHeight){\r\n\t\t\t\t\ttop = pos.top;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (top < scrolls.y) {\r\n\t\t\t\ttop = scrolls.y;\r\n\t\t\t}\r\n\r\n\t\t\tconst x = Math.min(Math.max(scrolls.x, pos.left - pos.dx*(width - pos.width)), screenWidth);\r\n\t\t\tconst y = top;\r\n\r\n\t\t\tthis._appendAtCoordinates(x, y);\r\n\t\t} else {\r\n\t\t\tqi.style.top = 20 + \"px\";\r\n\t\t\tif (pos.dx === 1){\r\n\t\t\t\tqi.style.right = \"auto\";\r\n\t\t\t\tqi.style.left = \"-300px\";\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tqi.style.left = \"10px\";\r\n\t\t\t\t},1);\r\n\t\t\t} else {\r\n\t\t\t\tqi.style.left = \"auto\";\r\n\t\t\t\tqi.style.right = \"-300px\";\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tqi.style.right = \"10px\";\r\n\t\t\t\t},1);\r\n\t\t\t}\r\n\t\t\tqi.className += \" gantt_qi_\"+(pos.dx === 1 ? \"left\" : \"right\");\r\n\t\t\tgantt.$root.appendChild(qi);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _qi_button_click(node: any) : void {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst box = this._quickInfoBox;\r\n\t\tif (!node || node === box){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(node.closest(\".gantt_cal_qi_close_btn\")){\r\n\t\t\tthis.hide();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst mask = node.className;\r\n\t\tif (mask.indexOf(\"_icon\") !== -1){\r\n\t\t\tconst id = this._quickInfoBoxId;\r\n\t\t\tgantt.$click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\r\n\t\t} else {\r\n\t\t\tthis._qi_button_click(node.parentNode);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getContainer(): IQuickInfoContainer{\r\n\t\tconst gantt = this._gantt;\r\n\t\tlet container = this._container ? this._container : gantt.$task_data;\r\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\r\n\t\t\treturn {\r\n\t\t\t\tparent: container,\r\n\t\t\t\txViewport: gantt.$task,\r\n\t\t\t\tyViewport: gantt.$task_data\r\n\t\t\t};\r\n\t\t}\r\n\t\tcontainer = this._container ? this._container : gantt.$grid_data;\r\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\r\n\t\t\treturn {\r\n\t\t\t\tparent: container,\r\n\t\t\t\txViewport: gantt.$grid,\r\n\t\t\t\tyViewport: gantt.$grid_data\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tparent: this._container ? this._container : gantt.$layout,\r\n\t\t\txViewport: gantt.$layout,\r\n\t\t\tyViewport: gantt.$layout\r\n\t\t};\r\n\t}\r\n}\r\n","import * as helpers from \"./helpers\";\r\n\r\nvar plainObjectConstructor = ({}).constructor.toString();\r\nfunction isCustomType(object){\r\n\tvar constructorString = object.constructor.toString();\r\n\r\n\treturn constructorString !== plainObjectConstructor;\r\n}\r\n\r\nfunction isExternalType(object){\r\n\t// react elements are not plain objects, but they are not custom types either\r\n\t// can't deep copy them\r\n\treturn object.$$typeof && object.$$typeof.toString().includes(\"react.\");\r\n}\r\n\r\nfunction copy(object) {\r\n\tvar i, result; // iterator, types array, result\r\n\r\n\tif (object && typeof object == \"object\") {\r\n\r\n\t\tswitch (true){\r\n\t\t\tcase (helpers.isDate(object)):\r\n\t\t\t\tresult = new Date(object);\r\n\t\t\t\tbreak;\r\n\t\t\tcase (helpers.isArray(object)):\r\n\t\t\t\tresult = new Array(object.length);\r\n\t\t\t\tfor(i = 0; i < object.length; i++){\r\n\t\t\t\t\tresult[i] = copy(object[i]);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t/*\t\tcase (helpers.isStringObject(object)):\r\n\t\t\t\tresult = new String(object);\r\n\t\t\t\tbreak;\r\n\t\t\tcase (helpers.isNumberObject(object)):\r\n\t\t\t\tresult = new Number(object);\r\n\t\t\t\tbreak;\r\n\t\t\tcase (helpers.isBooleanObject(object)):\r\n\t\t\t\tresult = new Boolean(object);\r\n\t\t\t\tbreak;*/\r\n\t\t\tdefault:\r\n\t\t\t\tif(isCustomType(object)){\r\n\t\t\t\t\tresult = Object.create(object);\r\n\t\t\t\t}else if (isExternalType(object)){\r\n\t\t\t\t\tresult = object;\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = {};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (i in object) {\r\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\r\n\t\t\t\t\t\tresult[i] = copy(object[i]);\r\n\t\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\treturn result || object;\r\n}\r\n\r\nfunction mixin (target, source, force){\r\n\tfor (var f in source)\r\n\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\r\n\treturn target;\r\n}\r\n\r\nfunction defined(obj) {\r\n\treturn typeof(obj) != \"undefined\";\r\n}\r\n\r\nvar seed;\r\nfunction uid() {\r\n\tif (!seed)\r\n\t\tseed = (new Date()).valueOf();\r\n\r\n\tseed++;\r\n\treturn seed;\r\n}\r\n\r\n//creates function with specified \"this\" pointer\r\nfunction bind(functor, object){\r\n\tif(functor.bind)\r\n\t\treturn functor.bind(object);\r\n\telse\r\n\t\treturn function(){ return functor.apply(object,arguments); };\r\n}\r\n\r\nfunction event(el, event, handler, capture){\r\n\tif (el.addEventListener)\r\n\t\tel.addEventListener(event, handler, capture === undefined ? false : capture);\r\n\r\n\telse if (el.attachEvent)\r\n\t\tel.attachEvent(\"on\"+event, handler);\r\n}\r\n\r\nfunction eventRemove(el, event, handler, capture){\r\n\tif (el.removeEventListener)\r\n\t\tel.removeEventListener(event, handler, capture === undefined ? false : capture);\r\n\r\n\telse if (el.detachEvent)\r\n\t\tel.detachEvent(\"on\"+event, handler);\r\n}\r\n\r\nexport {\r\n\tcopy,\r\n\tdefined,\r\n\tmixin,\r\n\tuid,\r\n\tbind,\r\n\tevent,\r\n\teventRemove\r\n};","import * as utils from \"../../../utils/utils\";\r\n\r\nfunction createScope(addEvent, removeEvent) {\r\n\taddEvent = addEvent || utils.event;\r\n\tremoveEvent = removeEvent || utils.eventRemove;\r\n\r\n\tvar handlers = [];\r\n\r\n\tvar eventScope = {\r\n\t\tattach: function(el, event, callback, capture){\r\n\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\r\n\t\t\taddEvent(el, event, callback, capture);\r\n\t\t},\r\n\t\tdetach: function(el, event, callback, capture){\r\n\t\t\tremoveEvent(el, event, callback, capture);\r\n\t\t\tfor(var i = 0; i < handlers.length; i++){\r\n\t\t\t\tvar handler = handlers[i];\r\n\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\r\n\t\t\t\t\thandlers.splice(i, 1);\r\n\t\t\t\t\ti--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdetachAll: function () {\r\n\t\t\tvar staticArray = handlers.slice();\r\n\t\t\t// original handlers array can be spliced on every iteration\r\n\t\t\tfor (var i = 0; i < staticArray.length; i++){\r\n\t\t\t\tvar handler = staticArray[i];\r\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\r\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\r\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\r\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\r\n\t\t\t}\r\n\t\t\thandlers.splice(0, handlers.length);\r\n\t\t},\r\n\t\textend: function(){\r\n\t\t\treturn createScope(this.event, this.eventRemove);\r\n\t\t}\r\n\t};\r\n\r\n\treturn eventScope;\r\n}\r\n\r\nexport default createScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\r\n\r\n/* eslint-disable no-restricted-globals */\r\n\r\ninterface IViewPosition{\r\n\ttop: number;\r\n\tleft: number;\r\n}\r\n\r\ninterface IViewBox extends IViewPosition{\r\n\twidth: number;\r\n\theight: number;\r\n\tbottom: number;\r\n\tright: number;\r\n}\r\n\r\nexport class Tooltip {\r\n\tprivate _root: HTMLElement;\r\n\tprivate _tooltipNode: HTMLElement;\r\n\tprivate _gantt: any;\r\n\r\n\tconstructor(gantt: any){\r\n\t\tthis._gantt = gantt;\r\n\t}\r\n\r\n\tgetNode() : HTMLElement {\r\n\t\tconst gantt = this._gantt;\r\n\t\tif (!this._tooltipNode){\r\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\r\n\t\t\tthis._tooltipNode.className = \"gantt_tooltip\";\r\n\t\t\tgantt._waiAria.tooltipAttr(this._tooltipNode);\r\n\t\t}\r\n\t\treturn this._tooltipNode;\r\n\t}\r\n\r\n\tsetViewport(node: HTMLElement):Tooltip{\r\n\t\tthis._root = node;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tshow(left: number, top: number): Tooltip;\r\n\tshow(event: MouseEvent): Tooltip;\r\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst container = document.body;\r\n\t\tconst node = this.getNode();\r\n\r\n\t\tif(!domHelpers.isChildOf(node, container)){\r\n\t\t\tthis.hide();\r\n\t\t\t// GS-2463. Don't put the node beyond the body coordinates\r\n\t\t\t// as it may trigger the resize event\r\n\t\t\tnode.style.top = node.style.top || \"0px\";\r\n\t\t\tnode.style.left = node.style.left || \"0px\";\r\n\t\t\tcontainer.appendChild(node);\r\n\t\t}\r\n\r\n\t\tif (this._isLikeMouseEvent(left)) {\r\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\r\n\t\t\ttop = position.top;\r\n\t\t\tleft = position.left;\r\n\t\t}\r\n\r\n\t\tnode.style.top = top + \"px\";\r\n\t\tnode.style.left = left + \"px\";\r\n\r\n\t\tgantt._waiAria.tooltipVisibleAttr(node);\r\n\t\treturn this;\r\n\t}\r\n\thide() : Tooltip{\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst node = this.getNode();\r\n\t\tif(node && node.parentNode){\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t}\r\n\t\tgantt._waiAria.tooltipHiddenAttr(node);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tsetContent(html: string) : Tooltip{\r\n\t\tconst node = this.getNode();\r\n\t\tnode.innerHTML = html;\r\n\t\treturn this;\r\n\t}\r\n\r\n\t// it is for salesforce, because it proxies event to it own events\r\n\tprivate _isLikeMouseEvent(event: any): boolean {\r\n\t\tif (!event || typeof event !== \"object\") {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn \"clientX\" in event && \"clientY\" in event;\r\n\t}\r\n\r\n\tprivate _getViewPort() : HTMLElement {\r\n\t\treturn this._root || document.body;\r\n\t}\r\n\r\n\r\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\r\n\t\tconst gantt = this._gantt;\r\n\t\t// top/left coordinates inside the viewport by mouse position\r\n\t\tconst viewport =  this._getViewPortSize();\r\n\t\tconst tooltipNode = this.getNode();\r\n\t\tconst tooltip: IViewBox = {\r\n\t\t\ttop:0,\r\n\t\t\tleft: 0,\r\n\t\t\twidth: tooltipNode.offsetWidth,\r\n\t\t\theight: tooltipNode.offsetHeight,\r\n\t\t\tbottom: 0,\r\n\t\t\tright: 0\r\n\t\t};\r\n\r\n\t\tconst offsetX = gantt.config.tooltip_offset_x;\r\n\t\tconst offsetY = gantt.config.tooltip_offset_y;\r\n\r\n\t\tconst container = document.body;\r\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\r\n\t\tconst containerPos = domHelpers.getNodePosition(container);\r\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\r\n\r\n\t\ttooltip.top = mouse.y;\r\n\t\ttooltip.left = mouse.x;\r\n\t\ttooltip.top += offsetY;\r\n\t\ttooltip.left += offsetX;\r\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\r\n\t\ttooltip.right = tooltip.left + tooltip.width;\r\n\r\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\r\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\r\n\t\tif(tooltip.top < viewport.top - scrollTop){\r\n\t\t\ttooltip.top = viewport.top;\r\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\r\n\t\t}else if(tooltip.bottom > viewport.bottom){\r\n\t\t\ttooltip.bottom = viewport.bottom;\r\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\r\n\t\t}\r\n\r\n\t\tif(tooltip.left < viewport.left){\r\n\t\t\ttooltip.left = viewport.left;\r\n\t\t\ttooltip.right = viewport.left + tooltip.width;\r\n\t\t}else if(tooltip.right > viewport.right){\r\n\t\t\ttooltip.right = viewport.right;\r\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\r\n\t\t}\r\n\r\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\r\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\r\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\r\n\t\t}\r\n\r\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\r\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\r\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\r\n\t\t}\r\n\r\n\t\t// GS-2827: when tooltip width too long\r\n\t\tif(tooltip.left < 0){\r\n\t\t\ttooltip.left = 0;\r\n\t\t}\r\n\t\tif(tooltip.right < 0){\r\n\t\t\ttooltip.right = 0;\r\n\t\t}\r\n\r\n\t\treturn tooltip;\r\n\t}\r\n\r\n\tprivate _getViewPortSize() : IViewBox {\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst container = this._getViewPort();\r\n\t\tlet viewport = container;\r\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\r\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\r\n\t\tlet pos;\r\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of gantt\r\n\t\tif(container === gantt.$task_data){\r\n\t\t\tviewport = gantt.$task;\r\n\t\t\tscrollTop = 0;\r\n\t\t\tscrollLeft = 0;\r\n\t\t\tpos = domHelpers.getNodePosition(gantt.$task);\r\n\t\t}else{\r\n\t\t\tpos = domHelpers.getNodePosition(viewport);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tleft:pos.x + scrollLeft,\r\n\t\t\ttop: pos.y + scrollTop,\r\n\t\t\twidth: pos.width,\r\n\t\t\theight: pos.height,\r\n\t\t\tbottom: pos.y + pos.height + scrollTop,\r\n\t\t\tright: pos.x + pos.width + scrollLeft\r\n\t\t};\r\n\t}\r\n}\r\n","import domEventsScope from \"../../core/ui/utils/dom_event_scope\";\r\nimport * as domHelpers from \"../../core/ui/utils/dom_helpers\";\r\nimport * as helpers from \"../../utils/helpers\";\r\nimport { Tooltip } from \"./tooltip\";\r\n\r\ninterface ITrackerTarget {\r\n\tselector: string;\r\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\r\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\r\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\r\n\tglobal: boolean;\r\n}\r\n\r\ninterface ITooltipConfig {\r\n\tselector: string;\r\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\r\n\tglobal: boolean;\r\n}\r\n\r\nexport class TooltipManager{\r\n\ttooltip: Tooltip;\r\n\tprotected _domEvents: any;\r\n\tprivate _listeners: object = {};\r\n\tprivate _gantt: any;\r\n\tprivate delayShow: any;\r\n\tprivate delayHide: any;\r\n\r\n\tconstructor(gantt: any) {\r\n\t\tthis.tooltip = new Tooltip(gantt);\r\n\t\tthis._gantt = gantt;\r\n\t\tthis._domEvents = domEventsScope();\r\n\t\tthis._initDelayedFunctions();\r\n\t}\r\n\r\n\tdestructor(): void{\r\n\t\tthis.tooltip.hide();\r\n\t\tthis._domEvents.detachAll();\r\n\t}\r\n\thideTooltip(): void{\r\n\t\tthis.delayHide();\r\n\t}\r\n\tattach(config: ITrackerTarget): void {\r\n\t\tlet root = document.body;\r\n\t\tconst gantt = this._gantt;\r\n\t\tif(!config.global){\r\n\t\t\troot = gantt.$root;\r\n\t\t}\r\n\r\n\t\tlet watchableTarget = null;\r\n\t\tconst handler = (event) => {\r\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\r\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\r\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst doOnMouseEnter = () => {\r\n\t\t\t\twatchableTarget = targetNode;\r\n\t\t\t\tconfig.onmouseenter(event, targetNode);\r\n\t\t\t};\r\n\r\n\t\t\tif(watchableTarget){\r\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\r\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\r\n\t\t\t\t\twatchableTarget = null;\r\n\r\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\r\n\t\t\t\t\t\tdoOnMouseEnter();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(targetNode){\r\n\t\t\t\t\tdoOnMouseEnter();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.detach(config.selector);\r\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\r\n\t\tthis._listeners[config.selector] = {\r\n\t\t\tnode: root,\r\n\t\t\thandler\r\n\t\t};\r\n\t}\r\n\r\n\tdetach(selector: string): void {\r\n\t\tconst listener = this._listeners[selector];\r\n\t\tif(listener){\r\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\r\n\t\t}\r\n\t}\r\n\r\n\ttooltipFor(config: ITooltipConfig): void {\r\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\r\n\t\t\tlet clone = event;\r\n\t\t\t// making events survive timeout in ie\r\n\t\t\t// tslint:disable-next-line no-string-literal\r\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\r\n\t\t\t\t// tslint:disable-next-line no-string-literal\r\n\t\t\t\tclone = document[\"createEventObject\"](event);\r\n\t\t\t}\r\n\t\t\treturn clone;\r\n\t\t};\r\n\t\tthis._initDelayedFunctions();\r\n\t\tthis.attach({\r\n\t\t\tselector: config.selector,\r\n\t\t\tglobal: config.global,\r\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\r\n\t\t\t\tconst html = config.html(event, node);\r\n\t\t\t\tif(html){\r\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\r\n\t\t\t\tconst html = config.html(event, node);\r\n\t\t\t\tif(html){\r\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\r\n\t\t\t\t\tthis.delayHide();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonmouseleave:() => {\r\n\t\t\t\tthis.delayShow.$cancelTimeout();\r\n\t\t\t\tthis.delayHide();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _initDelayedFunctions(){\r\n\t\tconst gantt = this._gantt;\r\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\r\n\t\tif(this.delayShow){\r\n\t\t\tthis.delayShow.$cancelTimeout();\r\n\t\t}\r\n\t\tif(this.delayHide){\r\n\t\t\tthis.delayHide.$cancelTimeout();\r\n\t\t}\r\n\t\tthis.tooltip.hide();\r\n\r\n\t\tthis.delayShow = helpers.delay((event: MouseEvent, html: string) => {\r\n\t\t\tif(gantt.callEvent(\"onBeforeTooltip\", [event]) === false) {\r\n\t\t\t\tthis.tooltip.hide();\r\n\t\t\t} else {\r\n\t\t\t\tthis.tooltip.setContent(html);\r\n\t\t\t\tthis.tooltip.show(event);\r\n\t\t\t}\r\n\t\t}, gantt.config.tooltip_timeout || 1);\r\n\r\n\t\tthis.delayHide = helpers.delay(() => {\r\n\t\t\tthis.delayShow.$cancelTimeout();\r\n\t\t\tthis.tooltip.hide();\r\n\t\t}, gantt.config.tooltip_hide_timeout || 1);\r\n\t}\r\n\r\n}","import { IInlineEditState, IMonitor, IUndo, IUndoCommand, TActionType, TEntityType, TUndoValue } from \"./types\";\r\n\r\nconst noTrack = {\r\n\tonBeforeUndo: \"onAfterUndo\",\r\n\tonBeforeRedo: \"onAfterRedo\"\r\n};\r\n\r\nconst batchActions = [\r\n\t\"onTaskDragStart\",\r\n\t\"onAfterTaskUpdate\",\r\n\t\"onAfterParentExpand\",\r\n\t\"onAfterTaskDelete\",\r\n\t\"onBeforeBatchUpdate\"\r\n];\r\n\r\nexport class Monitor implements IMonitor {\r\n\tprivate _batchAction = null;\r\n\tprivate _batchMode = false;\r\n\tprivate _ignore = false;\r\n\tprivate _ignoreMoveEvents = false;\r\n\tprivate _initialTasks = {};\r\n\tprivate _initialLinks = {};\r\n\tprivate _nestedTasks =  {};\r\n\tprivate _nestedLinks = {};\r\n\tprivate _timeout;\r\n\tprivate _gantt: any;\r\n\tprivate _undo: IUndo;\r\n\r\n\tconstructor(undo: IUndo, gantt: any) {\r\n\t\tthis._undo = undo;\r\n\t\tthis._gantt = gantt;\r\n\t\tthis._attachEvents();\r\n\t}\r\n\r\n\tstore(id: TaskID | LinkID, type: TEntityType, overwrite: boolean = false) {\r\n\t\tif (type === this._gantt.config.undo_types.task) {\r\n\t\t\treturn this._storeTask(id, overwrite);\r\n\t\t}\r\n\t\tif (type === this._gantt.config.undo_types.link) {\r\n\t\t\treturn this._storeLink(id, overwrite);\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tisMoveEventsIgnored() {\r\n\t\treturn this._ignoreMoveEvents;\r\n\t}\r\n\ttoggleIgnoreMoveEvents(newValue?: boolean) {\r\n\t\tthis._ignoreMoveEvents = newValue || false;\r\n\t}\r\n\tstartIgnore() {\r\n\t\tthis._ignore = true;\r\n\t}\r\n\tstopIgnore() {\r\n\t\tthis._ignore = false;\r\n\t}\r\n\tstartBatchAction() {\r\n\t\t// try catching updates made from event handlers using timeout\r\n\t\tif (!this._timeout){\r\n\t\t\tthis._timeout = setTimeout(() => {\r\n\t\t\t\tthis.stopBatchAction();\r\n\t\t\t\tthis._timeout = null;\r\n\t\t\t}, 10);\r\n\t\t}\r\n\r\n\r\n\t\tif (this._ignore || this._batchMode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._batchMode = true;\r\n\t\tthis._batchAction = this._undo.action.create();\r\n\t}\r\n\tstopBatchAction() {\r\n\t\tif (this._ignore) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst undo = this._undo;\r\n\t\tif (this._batchAction) {\r\n\t\t\tundo.logAction(this._batchAction);\r\n\t\t}\r\n\t\tthis._batchMode = false;\r\n\t\tthis._batchAction = null;\r\n\t}\r\n\tonTaskAdded(task: ITask) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.add);\r\n\t\t}\r\n\t}\r\n\tonTaskUpdated(task: ITask) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.update);\r\n\t\t}\r\n\t}\r\n\tonTaskMoved(task: ITask) {\r\n\t\tif (!this._ignore) {\r\n\t\t\t(task as any).$local_index = this._gantt.getTaskIndex(task.id);\r\n\t\t\tthis._storeEntityCommand(\r\n\t\t\t\ttask,\r\n\t\t\t\tthis.getInitialTask(task.id),\r\n\t\t\t\tthis._undo.command.type.move,\r\n\t\t\t\tthis._undo.command.entity.task\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\tonTaskDeleted(task: ITask) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.remove);\r\n\t\t\tif (this._nestedTasks[task.id]) {\r\n\t\t\t\tconst children = this._nestedTasks[task.id];\r\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\r\n\t\t\t\t\tthis._storeTaskCommand(children[i], this._undo.command.type.remove);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this._nestedLinks[task.id]) {\r\n\t\t\t\tconst childrenLinks = this._nestedLinks[task.id];\r\n\t\t\t\tfor (let i = 0; i < childrenLinks.length; i++) {\r\n\t\t\t\t\tthis._storeLinkCommand(childrenLinks[i], this._undo.command.type.remove);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tonLinkAdded(link: ILink) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.add);\r\n\t\t}\r\n\t}\r\n\tonLinkUpdated(link: ILink) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.update);\r\n\t\t}\r\n\t}\r\n\tonLinkDeleted(link: ILink) {\r\n\t\tif (!this._ignore) {\r\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.remove);\r\n\t\t}\r\n\t}\r\n\tsetNestedTasks(id: TaskID, taskIds: TaskID[]) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tlet task = null;\r\n\t\tconst tasks = [];\r\n\t\tlet\tlinkIds = this._getLinks(gantt.getTask(id));\r\n\r\n\t\tfor (let i = 0; i < taskIds.length; i++) {\r\n\t\t\ttask = this.setInitialTask(taskIds[i]);\r\n\t\t\tlinkIds = linkIds.concat(this._getLinks(task));\r\n\t\t\ttasks.push(task);\r\n\t\t}\r\n\r\n\t\tconst uniqueLinks = {};\r\n\t\tfor (let i = 0; i < linkIds.length; i++) {\r\n\t\t\tuniqueLinks[linkIds[i]] = true;\r\n\t\t}\r\n\t\tconst links = [];\r\n\t\tfor (const i in uniqueLinks) {\r\n\t\t\tlinks.push(this.setInitialLink(i));\r\n\t\t}\r\n\t\tthis._nestedTasks[id] = tasks;\r\n\t\tthis._nestedLinks[id] = links;\r\n\t}\r\n\tsetInitialTask(id: TaskID, overwrite?: boolean) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tif (overwrite || (!this._initialTasks[id] || !this._batchMode)) {\r\n\t\t\tconst task = gantt.copy(gantt.getTask(id));\r\n\t\t\ttask.$index = gantt.getGlobalTaskIndex(id);\r\n\t\t\ttask.$local_index = gantt.getTaskIndex(id);\r\n\t\t\tthis.setInitialTaskObject(id, task);\r\n\t\t}\r\n\t\treturn this._initialTasks[id];\r\n\t}\r\n\tgetInitialTask(id: TaskID) {\r\n\t\treturn this._initialTasks[id];\r\n\t}\r\n\tclearInitialTasks() {\r\n\t\tthis._initialTasks = {};\r\n\t}\r\n\tsetInitialTaskObject(id: TaskID, object: ITask) {\r\n\t\tthis._initialTasks[id] = object;\r\n\t}\r\n\tsetInitialLink(id: LinkID, overwrite?: boolean) {\r\n\t\tif (!this._initialLinks[id] || !this._batchMode) {\r\n\t\t\tthis._initialLinks[id] = this._gantt.copy(this._gantt.getLink(id));\r\n\t\t}\r\n\t\treturn this._initialLinks[id];\r\n\t}\r\n\tgetInitialLink(id: LinkID) {\r\n\t\treturn this._initialLinks[id];\r\n\t}\r\n\tclearInitialLinks() {\r\n\t\tthis._initialLinks = {};\r\n\t}\r\n\tprivate _attachEvents() {\r\n\t\tlet deleteCacheCooldown = null;\r\n\t\tconst gantt = this._gantt;\r\n\r\n\t\tconst saveInitialAll = () => {\r\n\t\t\tif (!deleteCacheCooldown) {\r\n\t\t\t\tdeleteCacheCooldown = setTimeout(() => {\r\n\t\t\t\t\tdeleteCacheCooldown = null;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.clearInitialTasks();\r\n\t\t\t\tgantt.eachTask((task: ITask) => {\r\n\t\t\t\t\tthis.setInitialTask(task.id);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.clearInitialLinks();\r\n\t\t\t\tgantt.getLinks().forEach((link: ILink) => {\r\n\t\t\t\t\tthis.setInitialLink(link.id);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t\tconst getMoveObjectByTaskId = (id: TaskID) => {\r\n\t\t\treturn gantt.copy(gantt.getTask(id));\r\n\t\t};\r\n\r\n\t\tfor (const i in noTrack) {\r\n\t\t\tgantt.attachEvent(i, () => {\r\n\t\t\t\tthis.startIgnore();\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(noTrack[i], () => {\r\n\t\t\t\tthis.stopIgnore();\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (let i  = 0; i < batchActions.length; i++) {\r\n\t\t\tgantt.attachEvent(batchActions[i], () => {\r\n\t\t\t\tthis.startBatchAction();\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tgantt.attachEvent(\"onParse\", () => {\r\n\t\t\tthis._undo.clearUndoStack();\r\n\t\t\tthis._undo.clearRedoStack();\r\n\t\t\tsaveInitialAll();\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", (id: TaskID, task: ITask) => {\r\n\t\t\tthis.setInitialTask(id, true);\r\n\t\t\tthis.onTaskAdded(task);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", (id: TaskID, task: ITask) => {\r\n\t\t\tthis.onTaskUpdated(task);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterParentExpand\", (id: TaskID, task: ITask) => {\r\n\t\t\tthis.onTaskUpdated(task);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", (id: TaskID, task: ITask) => {\r\n\t\t\tthis.onTaskDeleted(task);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", (id: LinkID, link: ILink) => {\r\n\t\t\tthis.setInitialLink(id, true);\r\n\t\t\tthis.onLinkAdded(link);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", (id: LinkID, link: ILink) => {\r\n\t\t\tthis.onLinkUpdated(link);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", (id: LinkID, link: ILink) => {\r\n\t\t\tthis.onLinkDeleted(link);\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onRowDragEnd\", (id: TaskID, target: TaskID) => {\r\n\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\r\n\t\t\tthis.toggleIgnoreMoveEvents();\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", (id: TaskID) => {\r\n\t\t\tthis.store(id, gantt.config.undo_types.task);\r\n\t\t\tconst nested = [];\r\n\r\n\t\t\t// remember task indexes in case their being deleted in a loop, so they could be restored in the correct order\r\n\t\t\tsaveInitialAll();\r\n\r\n\t\t\tgantt.eachTask((task: ITask) => {\r\n\t\t\t\tnested.push(task.id);\r\n\t\t\t}, id);\r\n\t\t\tthis.setNestedTasks(id, nested);\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\tconst datastore = gantt.getDatastore(\"task\");\r\n\r\n\t\tdatastore.attachEvent(\"onBeforeItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\r\n\t\t\tif (!this.isMoveEventsIgnored()) {\r\n\t\t\t\tsaveInitialAll();\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tdatastore.attachEvent(\"onAfterItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\r\n\t\t\tif (!this.isMoveEventsIgnored()) {\r\n\t\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onRowDragStart\", (id: TaskID, target: TaskID, e: Event) => {\r\n\t\t\tthis.toggleIgnoreMoveEvents(true);\r\n\t\t\tsaveInitialAll();\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tlet dragId = null;\r\n\t\tlet projectDrag = false;\r\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", (taskId: TaskID) => {\r\n\t\t\tdragId = gantt.getState().drag_id;\r\n\t\t\tif (dragId === taskId){\r\n\t\t\t\tconst task = gantt.getTask(taskId);\r\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project){\r\n\t\t\t\t\tprojectDrag = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// GS-99. Store the initial task dates before multiple drag\r\n\t\t\tif (gantt.plugins().multiselect){\r\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\r\n\t\t\t\tif (selectedIds.length > 1){\r\n\t\t\t\t\tselectedIds.forEach((id)=>{\r\n\t\t\t\t\t\tthis.store(id, gantt.config.undo_types.task, true);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn this.store(taskId, gantt.config.undo_types.task);\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", (taskId: TaskID) => {\r\n\t\t\t// if we drag multiple tasks and other tasks move to another date after that,\r\n\t\t\t// auto-scheduling/correct work time should occur in anoher command.\r\n\t\t\t// otherwise, when we undo the changes, the task constraint is not restored correctly\r\n\t\t\tconst multipleDrag = projectDrag || (gantt.plugins().multiselect && gantt.getSelectedTasks().length > 1);\r\n\t\t\tif (multipleDrag && dragId === taskId){\r\n\t\t\t\tprojectDrag = false;\r\n\t\t\t\tdragId = null;\r\n\t\t\t\tthis.stopBatchAction();\r\n\t\t\t}\r\n\t\t\t// GS-99. When dragging multiple tasks, we need to store the initial tasks\r\n\t\t\tthis.store(taskId, gantt.config.undo_types.task, true);\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onLightbox\", (taskId: TaskID) => this.store(taskId, gantt.config.undo_types.task));\r\n\r\n\t\tgantt.attachEvent(\"onBeforeTaskAutoSchedule\", (task: ITask) => {\r\n\t\t\tthis.store(task.id, gantt.config.undo_types.task, true);\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tif (gantt.ext.inlineEditors) {\r\n\t\t\t// remove the onGanttLayoutReady wrapper when GS-1288 is merged\r\n\t\t\tlet onBeforeEditStartId = null;\r\n\t\t\tlet onEditStart = null;\r\n\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", () => {\r\n\t\t\t\tif (onBeforeEditStartId) {\r\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onBeforeEditStartId);\r\n\t\t\t\t}\r\n\t\t\t\tif (onEditStart) {\r\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onEditStart);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tonEditStart = gantt.ext.inlineEditors.attachEvent(\"onEditStart\", (state: IInlineEditState) => {\r\n\t\t\t\t\tthis.store(state.id, gantt.config.undo_types.task);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// GS-99. If another inline editor is opened and we open a new inline editor,\r\n\t\t\t\t// we shouldn't use the batchAction\r\n\t\t\t\tonBeforeEditStartId = gantt.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", (state: IInlineEditState) => {\r\n\t\t\t\t\tthis.stopBatchAction();\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _storeCommand(command: IUndoCommand) {\r\n\t\tconst undo = this._undo;\r\n\t\tundo.updateConfigs();\r\n\r\n\t\tif (!undo.undoEnabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this._batchMode) {\r\n\t\t\tthis._batchAction.commands.push(command);\r\n\t\t} else {\r\n\t\t\tconst action = undo.action.create([command]);\r\n\t\t\tundo.logAction(action);\r\n\t\t}\r\n\t}\r\n\tprivate _storeEntityCommand(obj: TUndoValue, old: TUndoValue, actionType: TActionType, entityType: TEntityType) {\r\n\t\tconst undo = this._undo;\r\n\t\tconst command = undo.command.create(obj, old, actionType, entityType);\r\n\t\tthis._storeCommand(command);\r\n\t}\r\n\tprivate _storeTaskCommand(obj: ITask, type: TActionType) {\r\n\t\tif(this._gantt.isTaskExists(obj.id)){\r\n\t\t\t(obj as any).$local_index = this._gantt.getTaskIndex(obj.id);\r\n\t\t}\r\n\r\n\t\tthis._storeEntityCommand(obj, this.getInitialTask(obj.id), type, this._undo.command.entity.task);\r\n\t}\r\n\tprivate _storeLinkCommand(obj: ILink, type: TActionType) {\r\n\t\tthis._storeEntityCommand(obj, this.getInitialLink(obj.id), type, this._undo.command.entity.link);\r\n\t}\r\n\tprivate _getLinks(task: ITask) {\r\n\t\treturn task.$source.concat(task.$target);\r\n\t}\r\n\tprivate _storeTask(taskId: TaskID, overwrite: boolean = false) {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis.setInitialTask(taskId, overwrite);\r\n\t\tgantt.eachTask((child: ITask) => {\r\n\t\t\tthis.setInitialTask(child.id);\r\n\t\t}, taskId);\r\n\t\treturn true;\r\n\t}\r\n\tprivate _storeLink(linkId: LinkID, overwrite: boolean = false) {\r\n\t\tthis.setInitialLink(linkId, overwrite);\r\n\t\treturn true;\r\n\t}\r\n}","import { IUndo, IUndoCommand, IUndoCommands, IUndoPropAction, IUndoPropCommand, TActionType, TEntityType, TUndoStack, TUndoValue } from \"./types\";\r\n\r\nconst MAX_UNDO_STEPS = 100;\r\n\r\nexport class Undo implements IUndo {\r\n\r\n\tmaxSteps = MAX_UNDO_STEPS;\r\n\tundoEnabled = true;\r\n\tredoEnabled = true;\r\n\taction: IUndoPropAction = {\r\n\t\tcreate: (commands?: IUndoCommand[]): IUndoCommands => {\r\n\t\t\treturn { commands: (commands ? commands.slice() : []) };\r\n\t\t},\r\n\t\tinvert: (action: IUndoCommands): IUndoCommands => {\r\n\t\t\tconst gantt = this._gantt;\r\n\t\t\tconst revert = gantt.copy(action);\r\n\t\t\tconst commands = this.command;\r\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\r\n\t\t\t\tconst command = revert.commands[i] = commands.invert(revert.commands[i]);\r\n\t\t\t\tif (command.type === commands.type.update || command.type === commands.type.move) {\r\n\t\t\t\t\t[command.value, command.oldValue] = [command.oldValue, command.value];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn revert as IUndoCommands;\r\n\t\t}\r\n\t};\r\n\tcommand: IUndoPropCommand = {\r\n\t\t// entities that require different processing for undoing-redoing changes (gantt.config.undo_types)\r\n\t\tentity: null,\r\n\r\n\t\t// types of traced actions (gantt.config.undo_actions)\r\n\t\ttype: null,\r\n\r\n\t\tcreate: (value: TUndoValue, oldValue: TUndoValue, type: TActionType, entity: TEntityType): IUndoCommand => {\r\n\t\t\tconst gantt = this._gantt;\r\n\t\t\treturn {\r\n\t\t\t\tentity,\r\n\t\t\t\ttype,\r\n\t\t\t\tvalue: gantt.copy(value),\r\n\t\t\t\toldValue: gantt.copy(oldValue || value)\r\n\t\t\t};\r\n\t\t},\r\n\t\tinvert: (command: IUndoCommand): IUndoCommand => {\r\n\t\t\tconst gantt = this._gantt;\r\n\t\t\tconst revert = gantt.copy(command);\r\n\t\t\trevert.type = this.command.inverseCommands(command.type);\r\n\t\t\treturn revert;\r\n\t\t},\r\n\t\tinverseCommands: (command: TActionType): TActionType => {\r\n\t\t\tconst gantt = this._gantt;\r\n\t\t\tconst types = this.command.type;\r\n\t\t\tswitch (command) {\r\n\t\t\t\tcase types.update:\r\n\t\t\t\t\treturn types.update;\r\n\t\t\t\tcase types.remove:\r\n\t\t\t\t\treturn types.add;\r\n\t\t\t\tcase types.add:\r\n\t\t\t\t\treturn types.remove;\r\n\t\t\t\tcase types.move:\r\n\t\t\t\t\treturn types.move;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tgantt.assert(false, \"Invalid command \"+ command);\r\n\t\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tprivate _undoStack = [];\r\n\tprivate _redoStack = [];\r\n\tprivate _gantt: any;\r\n\r\n\tconstructor(gantt: any){\r\n\t\tthis._gantt = gantt;\r\n\t}\r\n\tgetUndoStack() {\r\n\t\treturn this._undoStack;\r\n\t}\r\n\tsetUndoStack(stack: []) {\r\n\t\tthis._undoStack = stack;\r\n\t}\r\n\r\n\tgetRedoStack() {\r\n\t\treturn this._redoStack;\r\n\t}\r\n\tsetRedoStack(stack: []) {\r\n\t\tthis._redoStack = stack;\r\n\t}\r\n\r\n\tclearUndoStack() {\r\n\t\tthis._undoStack = [];\r\n\t}\r\n\r\n\tclearRedoStack() {\r\n\t\tthis._redoStack = [];\r\n\t}\r\n\r\n\tupdateConfigs() {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis.maxSteps = gantt.config.undo_steps || MAX_UNDO_STEPS;\r\n\t\tthis.command.entity = gantt.config.undo_types;\r\n\t\tthis.command.type = gantt.config.undo_actions;\r\n\t\tthis.undoEnabled = !!gantt.config.undo;\r\n\t\tthis.redoEnabled = !!gantt.config.redo; // GS-873, Redo should work even when the `gantt.config.undo` is disabled.\r\n\t}\r\n\r\n\tundo() {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis.updateConfigs();\r\n\t\tif (!this.undoEnabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst action = this._pop(this._undoStack);\r\n\t\tif (action) {\r\n\t\t\tthis._reorderCommands(action);\r\n\t\t}\r\n\t\tif (gantt.callEvent(\"onBeforeUndo\", [action]) !== false) {\r\n\t\t\tif (action) {\r\n\t\t\t\tthis._applyAction(this.action.invert(action));\r\n\t\t\t\tthis._push(this._redoStack, gantt.copy(action));\r\n\t\t\t\tgantt.callEvent(\"onAfterUndo\", [action]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgantt.callEvent(\"onAfterUndo\", [null]);\r\n\t}\r\n\r\n\tredo() {\r\n\t\tconst gantt = this._gantt;\r\n\t\tthis.updateConfigs();\r\n\t\tif (!this.redoEnabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst action = this._pop(this._redoStack);\r\n\t\tif (action) {\r\n\t\t\tthis._reorderCommands(action);\r\n\t\t}\r\n\r\n\t\tif (gantt.callEvent(\"onBeforeRedo\", [action]) !== false) {\r\n\t\t\tif (action) {\r\n\t\t\t\tthis._applyAction(action);\r\n\t\t\t\tthis._push(this._undoStack, gantt.copy(action));\r\n\t\t\t\tgantt.callEvent(\"onAfterRedo\", [action]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgantt.callEvent(\"onAfterRedo\", [null]);\r\n\t}\r\n\r\n\t// storeUndo:\r\n\tlogAction(action: IUndoCommands) {\r\n\t\tthis._push(this._undoStack, action);\r\n\t\tthis._redoStack = [];\r\n\t}\r\n\r\n\tprivate _push(stack: TUndoStack, action: IUndoCommands): IUndoCommands {\r\n\t\tconst gantt = this._gantt;\r\n\t\tif (!action.commands.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst event = stack === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\r\n\t\tif (gantt.callEvent(event, [action]) === false){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// commands can be removed from event handler\r\n\t\tif (!action.commands.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tstack.push(action);\r\n\t\twhile (stack.length > this.maxSteps) {\r\n\t\t\tstack.shift();\r\n\t\t}\r\n\t\treturn action;\r\n\t}\r\n\r\n\tprivate _pop(stack: TUndoStack): IUndoCommands {\r\n\t\treturn stack.pop();\r\n\t}\r\n\r\n\tprivate _reorderCommands(action) {\r\n\t\t// firstly process tasks and only then links\r\n\t\t// in order to ensure links are added not earlier than their tasks\r\n\t\t// firstly to 'move' actions and only then updates\r\n\t\tconst weights = { any: 0, link:1, task:2 };\r\n\t\tconst actionWeights = { move: 1, any:0 };\r\n\t\taction.commands.sort(function(a, b) {\r\n\t\t\tif (a.entity === \"task\" && b.entity === \"task\") {\r\n\t\t\t\tif (a.type !== b.type) {\r\n\t\t\t\t\treturn (actionWeights[b.type] || 0) - (actionWeights[a.type] || 0);\r\n\t\t\t\t} else if (a.type === \"move\" && a.oldValue && b.oldValue && b.oldValue.parent === a.oldValue.parent) {\r\n\t\t\t\t\treturn a.oldValue.$index - b.oldValue.$index;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst weightA = weights[a.entity] || weights.any;\r\n\t\t\t\tconst weightB = weights[b.entity] || weights.any;\r\n\t\t\t\treturn weightB - weightA;\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _applyAction(action: IUndoCommands) {\r\n\t\tlet command = null;\r\n\t\tconst entities = this.command.entity;\r\n\t\tconst actions = this.command.type;\r\n\t\tconst gantt = this._gantt;\r\n\t\tconst methods = {};\r\n\t\tmethods[entities.task] = {\r\n\t\t\tadd: \"addTask\",\r\n\t\t\tget: \"getTask\",\r\n\t\t\tupdate: \"updateTask\",\r\n\t\t\tremove: \"deleteTask\",\r\n\t\t\tmove: \"moveTask\",\r\n\t\t\tisExists: \"isTaskExists\"\r\n\t\t};\r\n\t\tmethods[entities.link] = {\r\n\t\t\tadd: \"addLink\",\r\n\t\t\tget: \"getLink\",\r\n\t\t\tupdate: \"updateLink\",\r\n\t\t\tremove: \"deleteLink\",\r\n\t\t\tisExists: \"isLinkExists\"\r\n\t\t};\r\n\r\n\t\tgantt.batchUpdate(function() {\r\n\t\t\t// it is logical to undo actions from the last one to the first one\r\n\t\t\t// but we have to do it from the first one because the order\r\n\t\t\t// of tasks ($index and $local_index) depends on the existing tasks\r\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\r\n\t\t\t\tcommand = action.commands[i];\r\n\t\t\t\tconst method = methods[command.entity][command.type];\r\n\t\t\t\tconst getMethod = methods[command.entity].get;\r\n\t\t\t\tconst check = methods[command.entity].isExists;\r\n\r\n\t\t\t\tif (command.type === actions.add) {\r\n\t\t\t\t\tgantt[method](command.oldValue, command.oldValue.parent, command.oldValue.$local_index);\r\n\t\t\t\t} else if (command.type === actions.remove) {\r\n\t\t\t\t\tif (gantt[check](command.value.id)) {\r\n\t\t\t\t\t\tgantt[method](command.value.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (command.type === actions.update) {\r\n\t\t\t\t\tconst item = gantt[getMethod](command.value.id);\r\n\t\t\t\t\tfor(const prop in command.value){\r\n\t\t\t\t\t\tconst internalProperty = prop.startsWith(\"$\") || prop.startsWith(\"_\");\r\n\t\t\t\t\t\tconst whitelist = [\"$open\"];\r\n\t\t\t\t\t\tlet copyProperty = !internalProperty;\r\n\t\t\t\t\t\tif (whitelist.indexOf(prop) > -1){\r\n\t\t\t\t\t\t\tcopyProperty = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(copyProperty){\r\n\t\t\t\t\t\t\titem[prop] = command.value[prop];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgantt[method](command.value.id);\r\n\t\t\t\t} else if (command.type === actions.move) {\r\n\t\t\t\t\tgantt[method](command.value.id, command.value.$local_index, command.value.parent);\r\n\t\t\t\t\t// GS-680: We should send the changes to the server after we undo vertical reorder\r\n\t\t\t\t\tgantt.callEvent(\"onRowDragEnd\", [command.value.id]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","\r\nimport click_drag from \"./click_drag\";\r\nimport drag_timeline from \"./drag_timeline\";\r\nimport export_api from \"./export_api\";\r\nimport fullscreen from \"./fullscreen\";\r\nimport keyboard_navigation from \"./keyboard_navigation\";\r\nimport marker from \"./marker\";\r\nimport multiselect from \"./multiselect\";\r\nimport quick_info from \"./quick_info\";\r\nimport tooltip from \"./tooltip\";\r\nimport undo from \"./undo\";\r\n\r\nexport default {\r\n\tclick_drag,\r\n\tdrag_timeline,\r\n\tfullscreen,\r\n\tkeyboard_navigation,\r\n\tquick_info,\r\n\ttooltip,\r\n\tundo,\r\n\tmarker,\r\n\tmultiselect,\r\n\texport_api\r\n};","import { EventsManager } from \"./eventsManager\";\r\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\r\n\r\nexport default function(gantt: any){\r\n\tif (!gantt.ext) {\r\n\t\tgantt.ext = {};\r\n\t}\r\n\r\n\tconst defaultConfig: ISelectedRegionConfig = {\r\n\t\tclassName: \"gantt_click_drag_rect\",\r\n\t\tuseRequestAnimationFrame: true,\r\n\t\tcallback: undefined,\r\n\t\tsingleRow: false\r\n\t};\r\n\r\n\tfunction setClickDrag(){\r\n\t\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\r\n\t\tif (gantt.ext.clickDrag){\r\n\t\t\tgantt.ext.clickDrag.destructor();\r\n\t\t}\r\n\t\tgantt.ext.clickDrag = new EventsManager(gantt);\r\n\t\tconst clickDrag = gantt.config.click_drag;\r\n\t\tconfig.render = clickDrag.render || defaultConfig.render;\r\n\t\tconfig.className = clickDrag.className || defaultConfig.className;\r\n\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\r\n\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\r\n\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\r\n\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\r\n\r\n\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\r\n\t\tconst timeline = gantt.$ui.getView(\"timeline\");\r\n\t\tconst selectedRegion = new SelectedRegion(config, gantt, timeline);\r\n\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey, clickDrag.ignore);\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onGanttReady\", () => {\r\n\t\tif (gantt.config.click_drag){\r\n\t\t\tsetClickDrag();\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\r\n\t\tif (gantt.$container && gantt.config.click_drag){\r\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\r\n\t\t\t\tsetClickDrag();\r\n\t\t\t}, {once:true});\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onDestroy\", () => {\r\n\t\tif (gantt.ext.clickDrag){\r\n\t\t\tgantt.ext.clickDrag.destructor();\r\n\t\t}\r\n\t});\r\n\r\n}","import { EventsManager } from \"./eventsManager\";\r\nexport default function(gantt: any){\r\n\tif (!gantt.ext){\r\n\t\tgantt.ext = {};\r\n\t}\r\n\r\n\tgantt.ext.dragTimeline = {\r\n\t\tcreate: () => EventsManager.create(gantt),\r\n\t\t_isDragInProgress: () => EventsManager._isDragInProgress\r\n\t};\r\n\r\n\tgantt.config.drag_timeline = {\r\n\t\tenabled: true,\r\n\t\trender: false\r\n\t};\r\n}","export default function(gantt: any){\r\n\r\ninterface IBody extends HTMLElement {\r\n\tmsRequestFullscreen?: () => void;\r\n\tmozRequestFullScreen?: () => void;\r\n\twebkitRequestFullscreen?: (ALLOW_KEYBOARD_INPUT: any) => void;\r\n}\r\n\r\n\r\ninterface IConsole extends Console {\r\n\twarning?: (str: string) => void;\r\n}\r\n\r\ninterface IDocument extends Document {\r\n\tfullscreenElement: Element;\r\n\tmozFullScreenElement?: Element;\r\n\twebkitFullscreenElement?: Element;\r\n\tmsFullscreenElement?: Element;\r\n\twebkitFullscreenEnabled?: boolean;\r\n\tmozFullScreenEnabled?: boolean;\r\n\tmsFullscreenEnabled?: boolean;\r\n\tmsExitFullscreen?: () => void;\r\n\tmozCancelFullScreen?: () => void;\r\n\twebkitExitFullscreen?: () => void;\r\n}\r\n\r\ninterface IElement extends Element {\r\n\tALLOW_KEYBOARD_INPUT?: boolean;\r\n}\r\n\r\ninterface IElementSizes extends ISizes {\r\n\tmodified: boolean;\r\n}\r\n\r\ninterface ISizes {\r\n\twidth: null | string;\r\n\theight: null | string;\r\n\ttop: null | string;\r\n\tleft: null | string;\r\n\tposition: null | string;\r\n\tzIndex: null | number;\r\n}\r\n\r\nfunction isExpanded() {\r\n\tconst element = ((document as IDocument).fullscreenElement ||\r\n\t\t(document as IDocument).mozFullScreenElement ||\r\n\t\t(document as IDocument).webkitFullscreenElement ||\r\n\t\t(document as IDocument).msFullscreenElement);\r\n\treturn !!(element && element === document.body);\r\n}\r\n\r\nfunction isFullscreenAvailable() {\r\n\ttry {\r\n\t\treturn (document as IDocument).fullscreenEnabled ||\r\n\t\t\t(document as IDocument).webkitFullscreenEnabled ||\r\n\t\t\t(document as IDocument).mozFullScreenEnabled ||\r\n\t\t\t(document as IDocument).msFullscreenEnabled;\r\n\t} catch (e) {\r\n\t\t// eslint-disable-next-line no-console\r\n\t\tconsole.error(\"Fullscreen is not available:\", e); \r\n\t}\r\n}\r\n\r\nconst state = gantt.$services.getService(\"state\");\r\nstate.registerProvider(\"fullscreen\", () => {\r\n\tif (isFullscreenAvailable()){\r\n\t\treturn { fullscreen: isExpanded() };\r\n\t} else {\r\n\t\treturn undefined;\r\n\t}\r\n});\r\n\r\nlet backupBodyPadding = {\r\n\toverflow: null,\r\n\tpadding: null,\r\n\tpaddingTop: null,\r\n\tpaddingRight: null,\r\n\tpaddingBottom: null,\r\n\tpaddingLeft: null\r\n};\r\n\r\nconst backupElementSizes: IElementSizes = {\r\n\twidth: null,\r\n\theight: null,\r\n\ttop: null,\r\n\tleft: null,\r\n\tposition: null,\r\n\tzIndex: null,\r\n\tmodified: false\r\n};\r\n\r\nlet backupPositioning = null;\r\nfunction resetParentPositioning(root){\r\n\tlet parent = root.parentNode;\r\n\tconst positions = [];\r\n\twhile(parent && parent.style){\r\n\t\tpositions.push({\r\n\t\t\telement: parent,\r\n\t\t\toriginalPositioning: parent.style.position\r\n\t\t});\r\n\t\tparent.style.position = \"static\";\r\n\t\tparent = parent.parentNode;\r\n\t}\r\n\treturn positions;\r\n}\r\n\r\nfunction restoreParentPositioning(positions: any[]){\r\n\tpositions.forEach(record => {\r\n\t\trecord.element.style.position = record.originalPositioning;\r\n\t});\r\n}\r\n\r\n// expand gantt root element to fullscreen automatically\r\nfunction setFullScreenSizes() {\r\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\r\n\tconst body = document.body;\r\n\tupdateSizes(root.style, backupElementSizes);\r\n\tbackupBodyPadding = {\r\n\t\toverflow: body.style.overflow,\r\n\t\tpadding: body.style.padding ? body.style.padding : null,\r\n\t\tpaddingTop: body.style.paddingTop ? body.style.paddingTop : null,\r\n\t\tpaddingRight: body.style.paddingRight ? body.style.paddingRight : null,\r\n\t\tpaddingBottom: body.style.paddingBottom ? body.style.paddingBottom : null,\r\n\t\tpaddingLeft: body.style.paddingLeft ? body.style.paddingLeft : null\r\n\t};\r\n\r\n\tif (body.style.padding) {\r\n\t\tbody.style.padding = \"0\";\r\n\t}\r\n\tif (body.style.paddingTop) {\r\n\t\tbody.style.paddingTop = \"0\";\r\n\t}\r\n\tif (body.style.paddingRight) {\r\n\t\tbody.style.paddingRight = \"0\";\r\n\t}\r\n\tif (body.style.paddingBottom) {\r\n\t\tbody.style.paddingBottom = \"0\";\r\n\t}\r\n\tif (body.style.paddingLeft) {\r\n\t\tbody.style.paddingLeft = \"0\";\r\n\t}\r\n\r\n\tbody.style.overflow = \"hidden\";\r\n\r\n\troot.style.width = \"100vw\";\r\n\troot.style.height = \"100vh\";\r\n\troot.style.top = \"0px\";\r\n\troot.style.left = \"0px\";\r\n\troot.style.position = \"absolute\";\r\n\troot.style.zIndex = 1;\r\n\tbackupElementSizes.modified = true;\r\n\tbackupPositioning = resetParentPositioning(root);\r\n}\r\n\r\nfunction restoreSizes() {\r\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\r\n\tconst body = document.body;\r\n\tif (backupElementSizes.modified) {\r\n\t\tif (backupBodyPadding.padding) {\r\n\t\t\tbody.style.padding = backupBodyPadding.padding;\r\n\t\t}\r\n\t\tif (backupBodyPadding.paddingTop) {\r\n\t\t\tbody.style.paddingTop = backupBodyPadding.paddingTop;\r\n\t\t}\r\n\t\tif (backupBodyPadding.paddingRight) {\r\n\t\t\tbody.style.paddingRight = backupBodyPadding.paddingRight;\r\n\t\t}\r\n\t\tif (backupBodyPadding.paddingBottom) {\r\n\t\t\tbody.style.paddingBottom = backupBodyPadding.paddingBottom;\r\n\t\t}\r\n\t\tif (backupBodyPadding.paddingLeft) {\r\n\t\t\tbody.style.paddingLeft = backupBodyPadding.paddingLeft;\r\n\t\t}\r\n\r\n\t\tbody.style.overflow = backupBodyPadding.overflow;\r\n\t\tbackupBodyPadding = {\r\n\t\t\toverflow: null,\r\n\t\t\tpadding: null,\r\n\t\t\tpaddingTop: null,\r\n\t\t\tpaddingRight: null,\r\n\t\t\tpaddingBottom: null,\r\n\t\t\tpaddingLeft: null\r\n\t\t};\r\n\t\tupdateSizes(backupElementSizes, root.style);\r\n\t\tbackupElementSizes.modified = false;\r\n\t}\r\n\trestoreParentPositioning(backupPositioning);\r\n\tbackupPositioning = null;\r\n}\r\n\r\nfunction updateSizes(source: ISizes, target: ISizes) {\r\n\ttarget.width = source.width;\r\n\ttarget.height = source.height;\r\n\ttarget.top = source.top;\r\n\ttarget.left = source.left;\r\n\ttarget.position = source.position;\r\n\ttarget.zIndex = source.zIndex;\r\n}\r\n\r\nfunction addDOMEvents() {\r\n\tgantt.event(document, \"webkitfullscreenchange\", onFullScreenChange);\r\n\tgantt.event(document, \"mozfullscreenchange\", onFullScreenChange);\r\n\tgantt.event(document, \"MSFullscreenChange\", onFullScreenChange);\r\n\t// For IE on Win 10\r\n\tgantt.event(document, \"fullscreenChange\", onFullScreenChange);\r\n\tgantt.event(document, \"fullscreenchange\", onFullScreenChange);\r\n}\r\n\r\nlet expandGantt = false;\r\nfunction onFullScreenChange() {\r\n\tif (!gantt.$container) {\r\n\t\t// do nothing if gantt is not yet initialized\r\n\t\treturn;\r\n\t}\r\n\tlet event: \"onExpand\" | \"onCollapse\";\r\n\tconst isBodyExpanded = isExpanded();\r\n\r\n\tif (isBodyExpanded) {\r\n\t\tif (expandGantt) {\r\n\t\t\tevent = \"onExpand\";\r\n\t\t\tsetFullScreenSizes();\r\n\t\t}\r\n\t} else if (expandGantt) {\r\n\t\texpandGantt = false;\r\n\t\tevent = \"onCollapse\";\r\n\t\trestoreSizes();\r\n\t}\r\n\tsetTimeout(() => {\r\n\t\tgantt.render();\r\n\t});\r\n\tsetTimeout(() => {\r\n\t\tgantt.callEvent(event, [gantt.ext.fullscreen.getFullscreenElement()]);\r\n\t});\r\n}\r\n\r\nfunction cantFullscreen() {\r\n\tif (!gantt.$container) { // check is gantt initialized or not\r\n\t\treturn true;\r\n\t}\r\n\tif (!gantt.ext.fullscreen.getFullscreenElement()) {\r\n\t\treturn true;\r\n\t}\r\n\tif (!isFullscreenAvailable()) {\r\n\t\t// eslint-disable-next-line no-console\r\n\t\tconst method = (console as IConsole).warning || console.log;\r\n\t\tmethod(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\");\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\ngantt.ext.fullscreen = {\r\n\texpand(): void {\r\n\t\tif (cantFullscreen()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (isExpanded()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!gantt.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\texpandGantt = true;\r\n\r\n\t\t// we switch body to fullscreen and then expand fullscreen element to viewport\r\n\t\t// we do it to correct display common elements: lightboxes, tooltip etc.\r\n\t\tconst element = document.body as IBody;\r\n\t\tconst requestArguments = element.webkitRequestFullscreen ?\r\n\t\t\t[(Element as unknown as IElement).ALLOW_KEYBOARD_INPUT] : [];\r\n\r\n\t\tconst requestFullscreen = element.msRequestFullscreen ||\r\n\t\t\telement.mozRequestFullScreen ||\r\n\t\t\telement.webkitRequestFullscreen ||\r\n\t\t\telement.requestFullscreen;\r\n\r\n\t\tif (requestFullscreen) {\r\n\t\t\trequestFullscreen.apply(element, requestArguments);\r\n\t\t}\r\n\t},\r\n\tcollapse(): void {\r\n\t\tif (cantFullscreen()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!isExpanded()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!gantt.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst requestExitFullscreen = (document as IDocument).msExitFullscreen ||\r\n\t\t\t(document as IDocument).mozCancelFullScreen ||\r\n\t\t\t(document as IDocument).webkitExitFullscreen ||\r\n\t\t\t(document as IDocument).exitFullscreen;\r\n\r\n\t\tif (requestExitFullscreen) {\r\n\t\t\trequestExitFullscreen.apply(document);\r\n\t\t}\r\n\t},\r\n\ttoggle(): void {\r\n\t\tif (cantFullscreen()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!isExpanded()) {\r\n\t\t\tthis.expand();\r\n\t\t} else {\r\n\t\t\tthis.collapse();\r\n\t\t}\r\n\r\n\t},\r\n\tgetFullscreenElement(): HTMLElement {\r\n\t\treturn gantt.$root;\r\n\t}\r\n};\r\n\r\ngantt.expand = function() {\r\n\tgantt.ext.fullscreen.expand();\r\n};\r\n\r\ngantt.collapse = function(){\r\n\tgantt.ext.fullscreen.collapse();\r\n};\r\n\r\ngantt.attachEvent(\"onGanttReady\", addDOMEvents);\r\n\r\n}","import eventable from \"../utils/eventable\";\r\nimport * as domHelpers from \"../core/ui/utils/dom_helpers\";\r\n\r\nimport keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\r\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\r\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\r\nimport gantt_node from \"./keyboard_navigation/elements/gantt_node\";\r\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\r\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\r\nimport task_row from \"./keyboard_navigation/elements/task_row\";\r\nimport task_cell from \"./keyboard_navigation/elements/task_cell\";\r\nimport modals from \"./keyboard_navigation/modals\";\r\nimport core from \"./keyboard_navigation/core\";\r\n\r\n\r\n\r\nexport default function(gantt){\r\n\tfunction setupKeyNav(gantt){\r\n\t\tgantt.config.keyboard_navigation = true;\r\n\t\tgantt.config.keyboard_navigation_cells = false;\r\n\r\n\t\tgantt.$keyboardNavigation = {};\r\n\r\n\t\tgantt._compose = function(){\r\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\r\n\t\t\tvar res = {};\r\n\t\t\tfor(var i = 0; i < parts.length; i++){\r\n\t\t\t\tvar obj = parts[i];\r\n\t\t\t\tif(typeof obj == \"function\"){\r\n\t\t\t\t\tobj = new obj();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(var p in obj){\r\n\t\t\t\t\tres[p] = obj[p];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t};\r\n\r\n\t\tkeyboard_shortcuts(gantt);\r\n\t\teventhandler(gantt);\r\n\t\ttrap_modal_focus(gantt);\r\n\t\tgantt_node(gantt);\r\n\t\tnav_node(gantt);\r\n\t\theader_cell(gantt);\r\n\t\ttask_row(gantt);\r\n\t\ttask_cell(gantt);\r\n\t\tmodals(gantt);\r\n\t\tcore(gantt);\r\n\r\n\r\n\t\t(function(){\r\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\r\n\r\n\t\t\tdispatcher.isTaskFocused = function(id){\r\n\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\r\n\t\t\t\t\tif (node.taskId == id) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\r\n\t\t\tvar keyDownHandler = function(e){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\r\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return;\r\n\r\n\t\t\t\tif (isNoKeyboardNavigationElement(e) || isLightboxElement(e)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn dispatcher.keyDownHandler(e);\r\n\t\t\t};\r\n\r\n\t\t\tvar focusHandler = function(e){\r\n\t\t\t\tif(dispatcher.$preventDefault){\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tgantt.$container.blur();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t// do nothing if key-nav focus is already planned\r\n\t\t\t\t} else if (!dispatcher.awaitsFocus()) {\r\n\t\t\t\t\t// otherwise - re-focus key-nav element on gantt focus\r\n\t\t\t\t\tdispatcher.focusGlobalNode();\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tvar reFocusActiveNode = function(){\r\n\t\t\t\tif(!dispatcher.isEnabled())\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tconst outsideGantt = !domHelpers.isChildOf(document.activeElement, gantt.$container) && document.activeElement.localName != \"body\";\r\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\r\n\t\t\t\tif(!activeNode || outsideGantt)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar domElement = activeNode.getNode();\r\n\t\t\t\tvar top, left;\r\n\t\t\t\tif(domElement && domElement.parentNode){\r\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\r\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tactiveNode.focus(true);\r\n\r\n\t\t\t\tif(domElement && domElement.parentNode){\r\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\r\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\r\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\t\t\t\treFocusActiveNode();\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\r\n\t\t\t\t//GS-2230: in case if `getGanttInstance` created without container\r\n\t\t\t\tif(!gantt.$root) return;\r\n\t\t\t\tgantt.eventRemove(gantt.$root, \"keydown\", keyDownHandler);\r\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\r\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\r\n\r\n\t\t\t\tif(gantt.config.keyboard_navigation){\r\n\r\n\t\t\t\t\tgantt.event(gantt.$root, \"keydown\", keyDownHandler);\r\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\r\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\r\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\r\n\r\n\t\t\t\t}else{\r\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfunction getTaskNodeConstructor(){\r\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction isInlineEditorCell(e){\r\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\");\r\n\t\t\t}\r\n\t\t\t// GS-1445. Cancel keyboard navigation within custom elements\r\n\t\t\tfunction isNoKeyboardNavigationElement(e){\r\n\t\t\t\treturn !!domHelpers.closest(e.target, \".no_keyboard_navigation\");\r\n\t\t\t}\r\n\t\t\tfunction isLightboxElement(e){\r\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_cal_light\");\r\n\t\t\t}\r\n\r\n\t\t\tfunction mousedownHandler(e){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\r\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return true;\r\n\r\n\t\t\t\tif (isNoKeyboardNavigationElement(e)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar focusNode;\r\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\r\n\t\t\t\tif(locateTask){\r\n\t\t\t\t\t//var node = getTaskNodeConstructor();\r\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\r\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfocusNode = locateTask;\r\n\t\t\t\t\t// GS-1541 and GS-1542. If you click on the task row element (possible with custom styles)\r\n\t\t\t\t\t// or the task bar element, there is no information about the target grid cell,\r\n\t\t\t\t\t// so we need to set focus on the first visible cell\r\n\t\t\t\t\tconst visibleGrid = gantt.config.show_grid && gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\tif(visibleGrid && gantt.config.keyboard_navigation_cells){\r\n\t\t\t\t\t\tconst taskRow = e.target.classList.contains(\"gantt_row\");\r\n\t\t\t\t\t\tconst taskBar = e.target.closest(\".gantt_task_line\");\r\n\r\n\t\t\t\t\t\tconst gridLeft = gantt.utils.dom.getNodePosition(gantt.$grid).x;\r\n\t\t\t\t\t\tconst gridRight = gridLeft + gantt.$grid.offsetWidth;\r\n\t\t\t\t\t\tconst nodePosition = gantt.utils.dom.getNodePosition(document.activeElement).x;\r\n\t\t\t\t\t\tconst nodeHidden = nodePosition < gridLeft || gridRight < nodePosition;\r\n\r\n\t\t\t\t\t\tif (taskRow || (taskBar && nodeHidden)){\r\n\t\t\t\t\t\t\tlet scrollPosition = gantt.$grid.scrollLeft;\r\n\t\t\t\t\t\t\tconst rightPosition = scrollPosition + gantt.$grid.offsetWidth;\r\n\t\t\t\t\t\t\tlet positionX = 0;\r\n\t\t\t\t\t\t\tif (taskRow){\r\n\t\t\t\t\t\t\t\tscrollPosition = gantt.utils.dom.getRelativeEventPosition(e, gantt.$grid).x;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\r\n\t\t\t\t\t\t\t\tconst column = gantt.config.columns[i];\r\n\t\t\t\t\t\t\t\tif (column.hide){\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tpositionX += column.width;\r\n\t\t\t\t\t\t\t\tif (scrollPosition < positionX){\r\n\t\t\t\t\t\t\t\t\tif (rightPosition < positionX){\r\n\t\t\t\t\t\t\t\t\t\tpositionX -= column.width;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfocusNode.columnIndex = i;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (focusNode) {\r\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\r\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdispatcher.delay(function () {\r\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\r\n\t\t\t\t\tdispatcher.$preventDefault = true;\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\r\n\t\t\t\t// restore focus on repainted tasks\r\n\t\t\t\tgantt.detachEvent(onReady);\r\n\r\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\r\n\t\t\t\t\tif (gantt.config.keyboard_navigation && dispatcher.isEnabled()) {\r\n\t\t\t\t\t\tconst currentNode = dispatcher.getActiveNode();\r\n\t\t\t\t\t\tconst grid = gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\t\tif (!grid || !grid.$grid_data){\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst top = grid.getItemTop(id);\r\n\t\t\t\t\t\tconst gridDataTopScroll = grid.$grid_data.scrollTop;\r\n\t\t\t\t\t\tconst gridDataBottomScroll = gridDataTopScroll + grid.$grid_data.getBoundingClientRect().height;\r\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\r\n\t\t\t\t\t\t\t// GS-2539: Don't refocus the node if it is selected and outside the visible range in the grid\r\n\t\t\t\t\t\t\tif(gridDataTopScroll <= top && gridDataBottomScroll >= top){\r\n\t\t\t\t\t\t\t\treFocusActiveNode();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(gantt._smart_render){\r\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawTasks;\r\n\t\t\t\t\tgantt._smart_render._redrawTasks = function(renderers, items){\r\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\r\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\r\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\r\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\r\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\r\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\r\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\r\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\r\n\r\n\t\t\t\t\t\treturn res;\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\r\n\t\t\tlet createdTaskId = null;\r\n\t\t\tlet keepFocusOnNewTask = false;\r\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (task) {\r\n\t\t\t\tcreatedTaskId = task.id;\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\t\t\t\tif(dispatcher.isEnabled()){\r\n\r\n\t\t\t\t\t// GS-1394. After adding a new task, the focus shouldn't change to the placeholder task\r\n\t\t\t\t\tif (id == createdTaskId) {\r\n\t\t\t\t\t\tkeepFocusOnNewTask = true;\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tkeepFocusOnNewTask = false;\r\n\t\t\t\t\t\t\tcreatedTaskId = null;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (keepFocusOnNewTask && item.type == gantt.config.types.placeholder) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar columnIndex = 0;\r\n\t\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\r\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\r\n\r\n\t\t\t\t\tif (item.type == gantt.config.types.placeholder && gantt.config.placeholder_task.focusOnCreate === false) {\r\n\t\t\t\t\t\t// do not focus on the placeholder task\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\r\n\r\n\t\t\t\tvar node = dispatcher.activeNode;\r\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\r\n\t\t\t\t\tnode.taskId = newId;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t\tvar interval = setInterval(function(){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\r\n\t\t\t\tif(!dispatcher.isEnabled()){\r\n\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}, 500);\r\n\r\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\t\t\tclearInterval(interval);\r\n\t\t\t});\r\n\r\n\t\t\tfunction getScopeName(obj){\r\n\t\t\t\tif(obj instanceof gantt.$keyboardNavigation.GanttNode){\r\n\t\t\t\t\treturn \"gantt\";\r\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.HeaderCell){\r\n\t\t\t\t\treturn \"headerCell\";\r\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskRow){\r\n\t\t\t\t\treturn \"taskRow\";\r\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskCell){\r\n\t\t\t\t\treturn \"taskCell\";\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tfunction getScope(mode){\r\n\t\t\t\tvar scopes = {\r\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\r\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\r\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\r\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn scopes[mode] || scopes.gantt;\r\n\t\t\t}\r\n\r\n\t\t\tfunction findVisibleColumnIndex(columnName) {\r\n\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\tfor (var i = 0; i < columns.length; i++){\r\n\t\t\t\t\tif(columns[i].name == columnName){\r\n\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t\tvar keyNavFacade = {};\r\n\t\t\teventable(keyNavFacade);\r\n\t\t\tgantt.mixin(keyNavFacade, {\r\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\r\n\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\r\n\t\t\t\t\tif(commands.length){\r\n\t\t\t\t\t\treturn keyNavFacade.getCommandHandler(commands[0], scope);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tgetCommandHandler: function(command, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tif(command){\r\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(command);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tremoveShortcut: function(shortcut, scope){\r\n\t\t\t\t\tvar scopeObject = getScope(scope);\r\n\t\t\t\t\tif(scopeObject){\r\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfocus: function(config){\r\n\t\t\t\t\tvar type = config ? config.type : null;\r\n\t\t\t\t\tvar constructor = getScope(type);\r\n\t\t\t\t\tvar node;\r\n\t\t\t\t\tswitch (type){\r\n\t\t\t\t\t\tcase \"taskCell\":\r\n\t\t\t\t\t\t\tnode = new constructor(config.id, findVisibleColumnIndex(config.column));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"taskRow\":\r\n\t\t\t\t\t\t\tnode = new constructor(config.id);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"headerCell\":\r\n\t\t\t\t\t\t\tnode = new constructor(findVisibleColumnIndex(config.column));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdispatcher.delay(function(){\r\n\t\t\t\t\t\tif(node){\r\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\r\n\r\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\r\n\t\t\t\t\t\t\t}else{\r\n\r\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\r\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\r\n\t\t\t\tgetActiveNode: function(){\r\n\t\t\t\t\tif(dispatcher.isEnabled()){\r\n\t\t\t\t\t\tvar node = dispatcher.getActiveNode();\r\n\t\t\t\t\t\tvar scope = getScopeName(node);\r\n\t\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\t\tswitch (scope){\r\n\t\t\t\t\t\t\tcase \"taskCell\":\r\n\t\t\t\t\t\t\t\treturn {type:\"taskCell\", id:node.taskId, column:columns[node.columnIndex].name};\r\n\t\t\t\t\t\t\tcase \"taskRow\":\r\n\t\t\t\t\t\t\t\treturn {type:\"taskRow\", id:node.taskId};\r\n\t\t\t\t\t\t\tcase \"headerCell\":\r\n\t\t\t\t\t\t\t\treturn {type:\"headerCell\", column:columns[node.index].name};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\r\n\r\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\r\n\t\t\tgantt.focus = function(){\r\n\t\t\t\tkeyNavFacade.focus();\r\n\t\t\t};\r\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\r\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\r\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\r\n\t\t})();\r\n\r\n\r\n\t}\r\n\r\n\tsetupKeyNav(gantt);\r\n\r\n\r\n\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.shortcuts = {\r\n\t\tcreateCommand: function () {\r\n\t\t\treturn {\r\n\t\t\t\tmodifiers: {\r\n\t\t\t\t\t\"shift\": false,\r\n\t\t\t\t\t\"alt\": false,\r\n\t\t\t\t\t\"ctrl\": false,\r\n\t\t\t\t\t\"meta\": false\r\n\t\t\t\t},\r\n\t\t\t\tkeyCode: null\r\n\t\t\t};\r\n\t\t},\r\n\t\tparse: function (shortcut) {\r\n\t\t\tvar commands = [];\r\n\r\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\r\n\t\t\tfor (var i = 0; i < expr.length; i++) {\r\n\t\t\t\tvar words = this.getWords(expr[i]);\r\n\r\n\t\t\t\tvar command = this.createCommand();\r\n\r\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\r\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\r\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\r\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\r\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcommands.push(command);\r\n\t\t\t}\r\n\t\t\treturn commands;\r\n\t\t},\r\n\r\n\t\tgetCommandFromEvent: function (domEvent) {\r\n\t\t\tvar command = this.createCommand();\r\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\r\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\r\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\r\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\r\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\r\n\r\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\r\n\t\t\t\t// numpad keys 96-105 -> 48-57\r\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\r\n\t\t\t}\r\n\r\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\r\n\t\t\tif (printableKey) {\r\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\r\n\t\t\t}\r\n\t\t\treturn command;\r\n\t\t},\r\n\r\n\t\tgetHashFromEvent: function (domEvent) {\r\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\r\n\t\t},\r\n\r\n\t\tgetHash: function (command) {\r\n\t\t\tvar parts = [];\r\n\t\t\tfor (var i in command.modifiers) {\r\n\t\t\t\tif (command.modifiers[i]) {\r\n\t\t\t\t\tparts.push(i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tparts.push(command.keyCode);\r\n\r\n\t\t\treturn parts.join(this.junctionChar);\r\n\t\t},\r\n\r\n\t\tgetExpressions: function (shortcut) {\r\n\t\t\treturn shortcut.split(this.junctionChar);\r\n\t\t},\r\n\t\tgetWords: function (term) {\r\n\t\t\treturn term.split(this.combinationChar);\r\n\t\t},\r\n\t\ttrim: function (shortcut) {\r\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\r\n\t\t},\r\n\t\tjunctionChar: \",\",\r\n\t\tcombinationChar: \"+\",\r\n\t\tcommandKeys: {\r\n\t\t\t\"shift\": 16,\r\n\t\t\t\"alt\": 18,\r\n\t\t\t\"ctrl\": 17,\r\n\t\t\t\"meta\": true\r\n\t\t},\r\n\t\tspecialKeys: {\r\n\t\t\t\"backspace\": 8,\r\n\t\t\t\"tab\": 9,\r\n\t\t\t\"enter\": 13,\r\n\t\t\t\"esc\": 27,\r\n\t\t\t\"space\": 32,\r\n\t\t\t\"up\": 38,\r\n\t\t\t\"down\": 40,\r\n\t\t\t\"left\": 37,\r\n\t\t\t\"right\": 39,\r\n\t\t\t\"home\": 36,\r\n\t\t\t\"end\": 35,\r\n\t\t\t\"pageup\": 33,\r\n\t\t\t\"pagedown\": 34,\r\n\t\t\t\"delete\": 46,\r\n\t\t\t\"insert\": 45,\r\n\t\t\t\"plus\": 107,\r\n\t\t\t\"f1\": 112,\r\n\t\t\t\"f2\": 113,\r\n\t\t\t\"f3\": 114,\r\n\t\t\t\"f4\": 115,\r\n\t\t\t\"f5\": 116,\r\n\t\t\t\"f6\": 117,\r\n\t\t\t\"f7\": 118,\r\n\t\t\t\"f8\": 119,\r\n\t\t\t\"f9\": 120,\r\n\t\t\t\"f10\": 121,\r\n\t\t\t\"f11\": 122,\r\n\t\t\t\"f12\": 123\r\n\t\t}\r\n\t};\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.EventHandler = {\r\n\t\t_handlers: null,\r\n\t\tfindHandler: function (command) {\r\n\t\t\tif (!this._handlers) this._handlers = {};\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\t\t\tvar hash = shortcuts.getHash(command);\r\n\r\n\t\t\treturn this._handlers[hash];\r\n\t\t},\r\n\r\n\t\tdoAction: function (command, e) {\r\n\t\t\tvar handler = this.findHandler(command);\r\n\t\t\tif (handler) {\r\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\r\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\thandler.call(this, e);\r\n\r\n\t\t\t\tif (e.preventDefault) e.preventDefault();\r\n\t\t\t\telse e.returnValue = false;\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tbind: function (shortcut, handler) {\r\n\t\t\tif (!this._handlers) this._handlers = {};\r\n\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\r\n\t\t\tvar commands = shortcuts.parse(shortcut);\r\n\t\t\tfor (var i = 0; i < commands.length; i++) {\r\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\r\n\t\t\t}\r\n\t\t},\r\n\t\tunbind: function (shortcut) {\r\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\r\n\r\n\t\t\tvar commands = shortcuts.parse(shortcut);\r\n\t\t\tfor (var i = 0; i < commands.length; i++) {\r\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\r\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tbindAll: function (map) {\r\n\t\t\tfor (var i in map) {\r\n\t\t\t\tthis.bind(i, map[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinitKeys: function () {\r\n\t\t\tif (!this._handlers)\r\n\t\t\t\tthis._handlers = {};\r\n\t\t\tif (this.keys) {\r\n\t\t\t\tthis.bindAll(this.keys);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\r\n\r\nexport default function(gantt) {\r\n\r\n\t(function () {\r\n\t\t\r\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\r\n\r\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\r\n\t\t\tif (e.keyCode != 9) return false;\r\n\r\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\r\n\t\t\tvar currentFocus = domHelpers.getActiveElement();\r\n\t\t\tvar currentIndex = -1;\r\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\r\n\t\t\t\tif (focusable[i] == currentFocus) {\r\n\t\t\t\t\tcurrentIndex = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (e.shiftKey) {\r\n\t\t\t\t// back tab\r\n\t\t\t\tif (currentIndex <= 0) {\r\n\t\t\t\t\t// go to the last element if we focused on the first\r\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\r\n\t\t\t\t\tif (lastItem) {\r\n\t\t\t\t\t\tlastItem.focus();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// forward tab\r\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\r\n\t\t\t\t\t// forward tab from last element should go back to the first element\r\n\t\t\t\t\tvar firstItem = focusable[0];\r\n\t\t\t\t\tif (firstItem) {\r\n\t\t\t\t\t\tfirstItem.focus();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t};\r\n\t})();\r\n\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.GanttNode = function () {\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.EventHandler,\r\n\t\t{\r\n\r\n\t\t\tfocus: function () {\r\n\t\t\t\tgantt.focus();\r\n\t\t\t},\r\n\r\n\t\t\tblur: function () {\r\n\r\n\t\t\t},\r\n\r\n\t\t\tisEnabled: function () {\r\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\r\n\t\t\t},\r\n\r\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\r\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\r\n\t\t\t\tvar scale = gantt.getScale();\r\n\t\t\t\tvar step = dir < 0 ? -scale.step : scale.step;\r\n\t\t\t\tdate = gantt.date.add(date, step, scale.unit);\r\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\r\n\t\t\t},\r\n\r\n\t\t\tscrollVertical: function scrollVertical(dir) {\r\n\t\t\t\tvar top = gantt.getScrollState().y;\r\n\t\t\t\tvar step = gantt.config.row_height;\r\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"alt+left\": function (e) {\r\n\t\t\t\t\tthis.scrollHorizontal(-1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+right\": function (e) {\r\n\t\t\t\t\tthis.scrollHorizontal(1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+up\": function (e) {\r\n\t\t\t\t\tthis.scrollVertical(-1);\r\n\t\t\t\t},\r\n\t\t\t\t\"alt+down\": function (e) {\r\n\t\t\t\t\tthis.scrollVertical(1);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// undo\r\n\t\t\t\t\"ctrl+z\": function () {\r\n\t\t\t\t\tif (gantt.undo) gantt.undo();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// redo\r\n\t\t\t\t\"ctrl+r\": function () {\r\n\t\t\t\t\tif (gantt.redo) gantt.redo();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\r\n\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.EventHandler,\r\n\t\t{\r\n\t\t\tisValid: function () {\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\r\n\t\t\tmoveTo: function (element) {\r\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\r\n\t\t\t},\r\n\r\n\t\t\tcompareTo: function (b) {\r\n\t\t\t\t// good enough comparison of two random objects\r\n\t\t\t\tif (!b) return false;\r\n\t\t\t\tfor (var i in this) {\r\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\r\n\r\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\r\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\r\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\r\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\r\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t},\r\n\t\t\tfocus: function () {\r\n\t\t\t\tvar node = this.getNode();\r\n\t\t\t\tif(!node)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\r\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t\tif(!node.$eventAttached){\r\n\t\t\t\t\t\tnode.$eventAttached = true;\r\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//node.className += \" gantt_focused\";\r\n\t\t\t\t\tif (gantt.utils.dom.isChildOf(document.activeElement, node)){\r\n\t\t\t\t\t\tnode = document.activeElement;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (node.focus) node.focus();\r\n\r\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tblur: function () {\r\n\t\t\t\tvar node = this.getNode();\r\n\t\t\t\tif (node) {\r\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\r\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\r\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\r\n\r\nexport default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\r\n\t\tthis.index = index || 0;\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.KeyNavNode,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\r\n\t\t\tisValid: function () {\r\n\t\t\t\tif (!gantt.config.show_grid) {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\tif (!gantt.config.show_grid) {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\r\n\t\t\t\tvar index = this.index;\r\n\t\t\t\twhile (index >= 0) {\r\n\t\t\t\t\tif (visibleColumns[index])\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tindex--;\r\n\t\t\t\t}\r\n\t\t\t\tif (visibleColumns[index]) {\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\r\n\t\t\t\tif(cellElement){\r\n\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\r\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\r\n\t\t\t\t\t\tindex += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tconst scale = gantt.$grid_scale;\r\n\t\t\t\tif (!scale){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\tconst cells = scale.childNodes;\r\n\t\t\t\treturn cells[this.index];\r\n\t\t\t},\r\n\r\n\r\n\t\t\tkeys: {\r\n\r\n\t\t\t\t\"left\": function () {\r\n\t\t\t\t\tif (this.index > 0) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"right\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tif (this.index < columns.length - 1) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar taskRow;\r\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\t\t\tif (gantt.isTaskExists(rootLevel[0])) {\r\n\t\t\t\t\t\ttaskRow = rootLevel[0];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (taskRow) {\r\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"end\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\r\n\t\t\t\t},\r\n\t\t\t\t\"home\": function () {\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\r\n\t\t\t\t},\r\n\r\n\r\n\t\t\t\t// press header button\r\n\t\t\t\t\"enter, space\": function () {\r\n\t\t\t\t\tvar node = domHelpers.getActiveElement();\r\n\t\t\t\t\tnode.click();\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// add new task\r\n\t\t\t\t\"ctrl+enter\": function () {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt.createTask({}, this.taskId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\r\n\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\r\n\t\tif (!taskId) {\r\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\tif (rootLevel[0]) {\r\n\t\t\t\ttaskId = rootLevel[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.taskId = taskId;\r\n\t\tif (gantt.isTaskExists(this.taskId)) {\r\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\r\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\r\n\t\t\tthis.splitItem = !!gantt.getTask(this.taskId).$split_subtask;\r\n\t\t\tthis.parentId = gantt.getParent(this.taskId);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.KeyNavNode,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\t\t\tisValid: function () {\r\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\r\n\t\t\t\t\tif (!header.isValid()) return null;\r\n\t\t\t\t\telse return header;\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif(!this.splitItem){\r\n\t\t\t\t\t\tvar nextIndex = -1;\r\n\t\t\t\t\t\t// GS-1393. When Gantt tries to restore the focus, it should rely on the global index\r\n\t\t\t\t\t\tif (gantt.getTaskByIndex(this.globalIndex - 1)) {\r\n\t\t\t\t\t\t\tnextIndex = this.globalIndex - 1;\r\n\t\t\t\t\t\t} else if (gantt.getTaskByIndex(this.globalIndex + 1)) {\r\n\t\t\t\t\t\t\tnextIndex = this.globalIndex + 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar globalIndex = this.globalIndex;\r\n\t\t\t\t\t\t\twhile (globalIndex >= 0) {\r\n\t\t\t\t\t\t\t\tif (gantt.getTaskByIndex(globalIndex)) {\r\n\t\t\t\t\t\t\t\t\tnextIndex = globalIndex;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tglobalIndex--;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (nextIndex > -1) {\r\n\t\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(this.parentId);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar taskId = gantt.locate(el);\r\n\t\t\t\tif(gantt.isTaskExists(taskId)){\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\r\n\t\t\t\t\tif (gantt.config.show_grid) {\r\n\t\t\t\t\t\treturn gantt.$grid.querySelector(`.gantt_row[${gantt.config.task_attribute}=\"${String(this.taskId).replaceAll('\"', '\\\\\"')}\"]`);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tfocus: function (keptFocus) {\r\n\t\t\t\tif(!keptFocus) {\r\n\t\t\t\t\tconst pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\r\n\t\t\t\t\tconst height = gantt.getTaskHeight(this.taskId);\r\n\t\t\t\t\tconst scroll = gantt.getScrollState();\r\n\r\n\t\t\t\t\tlet viewWidth;\r\n\t\t\t\t\tif(gantt.$task){\r\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet viewHeight;\r\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\r\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst visibleTimeline = gantt.config.show_chart && gantt.$ui.getView(\"timeline\");\r\n\r\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\r\n\t\t\t\t\t\t// GS-2346: additional scrolling to be sure that the task will be in the required range\r\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - 20);\r\n\t\t\t\t\t} else if (gantt.config.scroll_on_click && visibleTimeline) {\r\n\t\t\t\t\t\t// horizontal scroll activated\r\n\t\t\t\t\t\tif (pos.left > (scroll.x + viewWidth)) { // scroll forward to the start of the task\r\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\r\n\t\t\t\t\t\t} else if (pos.left + pos.width < scroll.x) {  // scroll back to the end of the task\r\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left + pos.width - gantt.config.task_scroll_offset);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\r\n\r\n\t\t\t\t// GS-152 if there are scrollbars with custom names, change their scroll position\r\n\t\t\t\tscrollGrid();\r\n\r\n\t\t\t\tfunction scrollGrid() {\r\n\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\tif (!grid || !grid.$grid_data){\r\n\t\t\t\t\t\t// GS-1805. Don't try to focus the row that doesn't exist\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar scrollPositionX = parseInt(grid.$grid.scrollLeft);\r\n\t\t\t\t\tvar scrollPositionY = parseInt(grid.$grid_data.scrollTop);\r\n\r\n\t\t\t\t\tvar attachedScrollbarHorizontal = grid.$config.scrollX;\r\n\r\n\t\t\t\t\tif (attachedScrollbarHorizontal && grid.$config.scrollable) {\r\n\t\t\t\t\t\tvar scrollbarHorizontal = gantt.$ui.getView(attachedScrollbarHorizontal);\r\n\t\t\t\t\t\tif (scrollbarHorizontal) {\r\n\t\t\t\t\t\t\tscrollbarHorizontal.scrollTo(scrollPositionX, scrollPositionY);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar attachedScrollbarVertical = grid.$config.scrollY;\r\n\r\n\t\t\t\t\tif (attachedScrollbarVertical) {\r\n\t\t\t\t\t\tvar scrollbarVertical = gantt.$ui.getView(attachedScrollbarVertical);\r\n\t\t\t\t\t\tif (scrollbarVertical) {\r\n\t\t\t\t\t\t\tscrollbarVertical.scrollTo(scrollPositionX, scrollPositionY);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"pagedown\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"pageup\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"up\": function () {\r\n\t\t\t\t\tvar nextElement = null;\r\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\r\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.moveTo(nextElement);\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\r\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"shift+down\": function(){\r\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\r\n\t\t\t\t\t\tgantt.open(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+up\": function(){\r\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\r\n\t\t\t\t\t\tgantt.close(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+right\": function() {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\r\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\r\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\r\n\t\t\t\t\t\tparent.$open = true;\r\n\t\t\t\t\t\tvar result = gantt.moveTask(this.taskId, -1, prevId);\r\n\t\t\t\t\t\tif(result !== false)\r\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"shift+left\": function() {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\r\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\r\n\t\t\t\t\t\tvar result =  gantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\r\n\t\t\t\t\t\tif(result !== false)\r\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// select\r\n\t\t\t\t\"space\": function (e) {\r\n\t\t\t\t\tif (!gantt.isSelectedTask(this.taskId)) {\r\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// collapse\r\n\t\t\t\t\"ctrl+left\": function (e) {\r\n\t\t\t\t\tgantt.close(this.taskId);\r\n\t\t\t\t},\r\n\t\t\t\t// expand\r\n\t\t\t\t\"ctrl+right\": function (e) {\r\n\t\t\t\t\tgantt.open(this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// delete task\r\n\t\t\t\t\"delete\": function (e) {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// open lightbox\r\n\t\t\t\t\"enter\": function () {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt.showLightbox(this.taskId);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// add subtask\r\n\t\t\t\t\"ctrl+enter\": function () {\r\n\t\t\t\t\tif (gantt.isReadonly(this)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt.createTask({}, this.taskId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\r\n\r\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\r\nimport {replaceValidZeroId} from \"../../../utils/helpers\";\r\n\r\nexport default function(gantt) {\r\n\r\n\r\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\r\n\t\ttaskId = replaceValidZeroId(taskId, gantt.config.root_id);\r\n\t\tif (!taskId) {\r\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\r\n\t\t\tif (rootLevel[0]) {\r\n\t\t\t\ttaskId = rootLevel[0];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.taskId = taskId;\r\n\t\tthis.columnIndex = index || 0;\r\n\t\t// provided task may not exist, in this case node will be detectes as invalid\r\n\t\tif (gantt.isTaskExists(this.taskId)) {\r\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\r\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\r\n\t\tgantt.$keyboardNavigation.TaskRow,\r\n\t\t{\r\n\t\t\t_handlers: null,\r\n\t\t\tisValid: function () {\r\n\r\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\r\n\t\t\t},\r\n\t\t\tfallback: function () {\r\n\r\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\r\n\t\t\t\tvar result = node;\r\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\r\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\r\n\t\t\t\t\tvar index = this.columnIndex;\r\n\t\t\t\t\twhile (index >= 0) {\r\n\t\t\t\t\t\tif (visibleColumns[index])\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tindex--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (visibleColumns[index]) {\r\n\t\t\t\t\t\tresult = new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t},\r\n\r\n\t\t\tfromDomElement: function(el){\r\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar taskId = gantt.locate(el);\r\n\t\t\t\tif(gantt.isTaskExists(taskId)){\r\n\t\t\t\t\tvar index = 0;\r\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\r\n\r\n\t\t\t\t\tif(cellElement){\r\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tgetNode: function () {\r\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && (gantt.isTaskVisible(this.taskId) || gantt.config.show_tasks_outside_timescale)) {\r\n\t\t\t\t\tif (gantt.config.show_grid && gantt.$grid) {\r\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\r\n\t\t\t\t\t\tif(!row)\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\treturn row.querySelector(\"[data-column-index='\"+this.columnIndex+\"']\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tkeys: {\r\n\t\t\t\t\"up\": function () {\r\n\r\n\t\t\t\t\tvar nextElement = null;\r\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\r\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.moveTo(nextElement);\r\n\t\t\t\t},\r\n\t\t\t\t\"down\": function () {\r\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\r\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"left\": function () {\r\n\t\t\t\t\tif (this.columnIndex > 0) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"right\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\t\"end\": function () {\r\n\t\t\t\t\tvar columns = gantt.getGridColumns();\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\r\n\t\t\t\t},\r\n\t\t\t\t\"home\": function () {\r\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\r\n\t\t\t\t},\r\n\t\t\t\t\"pagedown\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\"pageup\": function () {\r\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\r\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t);\r\n\r\n\r\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\r\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\r\n\r\n};","export default function(gantt) {\r\n\r\n\tgantt.$keyboardNavigation.dispatcher = {\r\n\t\tisActive: false,\r\n\t\tactiveNode: null,\r\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\r\n\r\n\t\tenable: function () {\r\n\t\t\tthis.isActive = true;\r\n\t\t\tthis.setActiveNode(this.getActiveNode());\r\n\t\t},\r\n\r\n\t\tdisable: function () {\r\n\t\t\tthis.isActive = false;\r\n\t\t},\r\n\r\n\t\tisEnabled: function () {\r\n\t\t\treturn !!this.isActive;\r\n\t\t},\r\n\r\n\t\tgetDefaultNode: function () {\r\n\t\t\tvar node;\r\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\r\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\r\n\t\t\t} else {\r\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\r\n\t\t\t}\r\n\r\n\t\t\tif (!node.isValid()) {\r\n\t\t\t\tnode = node.fallback();\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\tsetDefaultNode: function () {\r\n\t\t\tthis.setActiveNode(this.getDefaultNode());\r\n\t\t},\r\n\r\n\t\tgetActiveNode: function () {\r\n\t\t\tvar node = this.activeNode;\r\n\t\t\tif (node && !node.isValid()) {\r\n\t\t\t\tnode = node.fallback();\r\n\t\t\t}\r\n\t\t\treturn node;\r\n\t\t},\r\n\r\n\t\tfromDomElement: function(e){\r\n\t\t\tvar inputs = [\r\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\r\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\r\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\r\n\t\t\t];\r\n\t\t\tfor(var i = 0; i < inputs.length; i++){\r\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\r\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\r\n\t\t\t\t\tif(node) return node;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tfocusGlobalNode: function () {\r\n\t\t\tthis.blurNode(this.globalNode);\r\n\t\t\tthis.focusNode(this.globalNode);\r\n\t\t},\r\n\r\n\t\tsetActiveNode: function (el) {\r\n\t\t\t//console.trace()\r\n\t\t\tvar focusChanged = true;\r\n\t\t\tif (this.activeNode) {\r\n\t\t\t\tif (this.activeNode.compareTo(el)) {\r\n\t\t\t\t\tfocusChanged = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (this.isEnabled()) {\r\n\t\t\t\tif(focusChanged)\r\n\t\t\t\t\tthis.blurNode(this.activeNode);\r\n\r\n\t\t\t\tthis.activeNode = el;\r\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfocusNode: function (el, keptFocus) {\r\n\t\t\tif (el && el.focus) {\r\n\t\t\t\tel.focus(keptFocus);\r\n\t\t\t}\r\n\t\t},\r\n\t\tblurNode: function (el) {\r\n\t\t\tif (el && el.blur) {\r\n\t\t\t\tel.blur();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tkeyDownHandler: function (e) {\r\n\r\n\t\t\tif (gantt.$keyboardNavigation.isModal())\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (!this.isEnabled())\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif(e.defaultPrevented){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar ganttNode = this.globalNode;\r\n\r\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\r\n\r\n\t\t\tvar activeElement = this.getActiveNode();\r\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\r\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!activeElement) {\r\n\t\t\t\tthis.setDefaultNode();\r\n\t\t\t} else if (activeElement.findHandler(command)) {\r\n\t\t\t\tactiveElement.doAction(command, e);\r\n\t\t\t} else if (ganttNode.findHandler(command)) {\r\n\t\t\t\tganttNode.doAction(command, e);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t_timeout: null,\r\n\t\tawaitsFocus: function(){\r\n\t\t\treturn this._timeout !== null;\r\n\t\t},\r\n\t\tdelay: function(callback, delay){\r\n\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\r\n\t\t\t\tthis._timeout = null;\r\n\t\t\t\tcallback();\r\n\t\t\t}, this)  , delay || 1);\r\n\r\n\t\t},\r\n\t\tclearDelay: function(){\r\n\t\t\tclearTimeout(this._timeout);\r\n\t\t}\r\n\t};\r\n\r\n};","import { QuickInfo } from \"./quickInfo\";\r\n\r\nexport default function(gantt: any){\r\n\r\nif (!gantt.ext) {\r\n\tgantt.ext = {};\r\n}\r\ngantt.ext.quickInfo = new QuickInfo(gantt);\r\n\r\ngantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\r\ngantt.config.quick_info_detached = true;\r\ngantt.config.show_quick_info = true;\r\n\r\ngantt.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\r\ngantt.templates.quick_info_content = function(start, end, ev){ return ev.details || ev.text; };\r\ngantt.templates.quick_info_date = function(start, end, ev){\r\n\treturn gantt.templates.task_time(start, end, ev);\r\n};\r\ngantt.templates.quick_info_class = function(start, end, task){ return \"\"; };\r\n\r\ngantt.attachEvent(\"onTaskClick\", function(id,e){\r\n\t// GS-1460 and GS-1787. Don't show Quick Info when clicking on the add, collapse, and expand buttons\r\n\tconst addButton = gantt.utils.dom.closest(e.target, \".gantt_add\");\r\n\tconst collapseButton = gantt.utils.dom.closest(e.target, \".gantt_close\");\r\n\tconst expandButton = gantt.utils.dom.closest(e.target, \".gantt_open\");\r\n\tconst showQuickInfo = !addButton && !collapseButton && !expandButton;\r\n\tif (showQuickInfo){\r\n\t\tsetTimeout(function() {\r\n\t\t\tgantt.ext.quickInfo.show(id);\r\n\t\t}, 0);\r\n\t}\r\n\r\n\treturn true;\r\n});\r\n\r\nconst events = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"];\r\nconst hidingFunction = function(){\r\n\tgantt.ext.quickInfo.hide();\r\n\treturn true;\r\n};\r\nfor (let i=0; i<events.length; i++){\r\n\tgantt.attachEvent(events[i], hidingFunction);\r\n}\r\n// GS-957: We don't want to hide QuickInfo when we click on it.\r\ngantt.attachEvent(\"onEmptyClick\", function(e){\r\n\tlet hideQuickInfo = true;\r\n\tconst parent = document.querySelector(\".gantt_cal_quick_info\");\r\n\tif (parent){\r\n\t\tconst quickInfoClick = gantt.utils.dom.isChildOf(e.target, parent);\r\n\t\tif (quickInfoClick){\r\n\t\t\thideQuickInfo = false;\r\n\t\t}\r\n\t}\r\n\tif (hideQuickInfo){\r\n\t\thidingFunction();\r\n\t}\r\n});\r\nfunction clearQuickInfo() {\r\n\tgantt.ext.quickInfo.hide();\r\n\tgantt.ext.quickInfo._quickInfoBox = null;\r\n\treturn true;\r\n}\r\ngantt.attachEvent(\"onGanttReady\", clearQuickInfo);\r\ngantt.attachEvent(\"onDestroy\", clearQuickInfo);\r\n\r\n// eslint-disable-next-line no-restricted-globals\r\ngantt.event(window, \"keydown\", function(e){\r\n\tif (e.keyCode === 27){\r\n\t\tgantt.ext.quickInfo.hide();\r\n\t}\r\n});\r\n\r\ngantt.showQuickInfo = function(){\r\n\tgantt.ext.quickInfo.show.apply(gantt.ext.quickInfo, arguments);\r\n};\r\ngantt.hideQuickInfo = function(){\r\n\tgantt.ext.quickInfo.hide.apply(gantt.ext.quickInfo, arguments);\r\n};\r\n\r\n}","import {TooltipManager} from \"./tooltipManager\";\r\n\r\nexport default function(gantt: any){\r\n\r\ngantt.config.tooltip_timeout = 30;\r\ngantt.config.tooltip_offset_y = 20;\r\ngantt.config.tooltip_offset_x = 10;\r\ngantt.config.tooltip_hide_timeout = 30;\r\n\r\n\r\n\r\nconst tooltipManager = new TooltipManager(gantt);\r\n\r\ngantt.ext.tooltips = tooltipManager;\r\n\r\ngantt.attachEvent(\"onGanttReady\", function(){\r\n\t//GS-2230: in case if `getGanttInstance` created without container\r\n\tif(!gantt.$root) return;\r\n\ttooltipManager.tooltipFor({\r\n\t\tselector: \"[\"+gantt.config.task_attribute+\"]:not(.gantt_task_row)\",\r\n\t\thtml: (event: MouseEvent) => {\r\n\t\t\tif (gantt.config.touch && !gantt.config.touch_tooltip) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst targetTaskId = gantt.locate(event);\r\n\t\t\tif(gantt.isTaskExists(targetTaskId)){\r\n\t\t\t\tconst task = gantt.getTask(targetTaskId);\r\n\t\t\t\treturn gantt.templates.tooltip_text(task.start_date, task.end_date, task);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tglobal: false\r\n\t});\r\n});\r\n\r\ngantt.attachEvent(\"onDestroy\", function() {\r\n\ttooltipManager.destructor();\r\n});\r\n\r\ngantt.attachEvent(\"onLightbox\", function() {\r\n\ttooltipManager.hideTooltip();\r\n});\r\nconst isLinkCreate = () => {\r\n\tconst state = gantt.getState();\r\n\treturn !!state.link_source_id;\r\n};\r\ngantt.attachEvent(\"onBeforeTooltip\", function() {\r\n\tif (isLinkCreate()){\r\n\t\treturn false;\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onGanttScroll\", function(){\r\n\ttooltipManager.hideTooltip();\r\n});\r\n\r\n}","import { Monitor } from \"./monitor\";\r\nimport { IMonitor, IUndoCommand, TEntityType, TUndoStack } from \"./types\";\r\nimport { Undo } from \"./undo\";\r\n\r\nexport default function(gantt: any){\r\n\r\nconst _undo = new Undo(gantt);\r\nconst monitor: IMonitor = new Monitor(_undo, gantt);\r\n\r\ngantt.config.undo = true;\r\ngantt.config.redo = true;\r\n\r\n/**\r\n * entities that require different processing for undoing-redoing changes\r\n * @type {{link: string, task: string}}\r\n */\r\ngantt.config.undo_types = {\r\n\tlink: \"link\",\r\n\ttask: \"task\"\r\n};\r\n\r\n/**\r\n * types of traced actions\r\n * @type {{update: string, remove: string, add: string}}\r\n */\r\ngantt.config.undo_actions = {\r\n\tupdate: \"update\",\r\n\tremove: \"remove\", // remove item from datastore\r\n\tadd: \"add\",\r\n\tmove: \"move\" // move task in grid\r\n};\r\n\r\nif (!gantt.ext) {\r\n\tgantt.ext = {};\r\n}\r\n\r\ngantt.ext.undo = {\r\n\tundo: () => _undo.undo(),\r\n\tredo: () => _undo.redo(),\r\n\tgetUndoStack: () => _undo.getUndoStack(),\r\n\tsetUndoStack: (stack:[]) => _undo.setUndoStack(stack),\r\n\tgetRedoStack: () => _undo.getRedoStack(),\r\n\tsetRedoStack: (stack:[]) => _undo.setRedoStack(stack),\r\n\tclearUndoStack: () => _undo.clearUndoStack(),\r\n\tclearRedoStack: () => _undo.clearRedoStack(),\r\n\tsaveState: (id: TaskID | LinkID, type: TEntityType) => monitor.store(id, type, true),\r\n\tgetInitialState: (id: TaskID | LinkID, type: TEntityType) => {\r\n\t\tif(type === gantt.config.undo_types.link){\r\n\t\t\treturn monitor.getInitialLink(id);\r\n\t\t}else{\r\n\t\t\treturn monitor.getInitialTask(id);\r\n\t\t}\r\n\t}\r\n};\r\n\r\ngantt.undo = gantt.ext.undo.undo;\r\ngantt.redo = gantt.ext.undo.redo;\r\ngantt.getUndoStack = gantt.ext.undo.getUndoStack;\r\ngantt.getRedoStack = gantt.ext.undo.getRedoStack;\r\ngantt.clearUndoStack = gantt.ext.undo.clearUndoStack;\r\ngantt.clearRedoStack = gantt.ext.undo.clearRedoStack;\r\n\r\nfunction isEqualIds(first: TaskID, second: TaskID){\r\n\treturn String(first) === String(second);\r\n};\r\n\r\nfunction updTask(task: ITask, oldId: TaskID, newId: TaskID) {\r\n\tif (!task) { return; }\r\n\r\n\tif (isEqualIds(task.id, oldId)) {\r\n\t\ttask.id = newId;\r\n\t}\r\n\r\n\tif (isEqualIds(task.parent, oldId)) {\r\n\t\ttask.parent = newId;\r\n\t}\r\n}\r\n\r\nfunction changeTaskCommandId(command: IUndoCommand, oldId: TaskID, newId: TaskID) {\r\n\tupdTask(command.value, oldId, newId);\r\n\tupdTask(command.oldValue, oldId, newId);\r\n}\r\n\r\nfunction updLink(link: ILink, oldTaskId: TaskID, newTaskId: TaskID) {\r\n\tif (!link) { return; }\r\n\tif (isEqualIds(link.source, oldTaskId)) {\r\n\t\tlink.source = newTaskId;\r\n\t}\r\n\tif (isEqualIds(link.target, oldTaskId)) {\r\n\t\tlink.target = newTaskId;\r\n\t}\r\n}\r\n\r\nfunction changeLinkCommandId(command: IUndoCommand, oldId: LinkID, newId: LinkID) {\r\n\tupdLink(command.value, oldId, newId);\r\n\tupdLink(command.oldValue, oldId, newId);\r\n}\r\n\r\nfunction updateTasksIds(log: TUndoStack, oldId: TaskID, newId: TaskID) {\r\n\tconst undo = _undo;\r\n\r\n\tfor (let i = 0; i < log.length; i++) {\r\n\t\tconst entry = log[i];\r\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\r\n\t\t\tif (entry.commands[j].entity === undo.command.entity.task) {\r\n\t\t\t\tchangeTaskCommandId(entry.commands[j], oldId, newId);\r\n\t\t\t} else if (entry.commands[j].entity === undo.command.entity.link) {\r\n\t\t\t\tchangeLinkCommandId(entry.commands[j], oldId, newId);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction updateLinksIds(log: TUndoStack, oldId: LinkID, newId: LinkID) {\r\n\tconst undo = _undo;\r\n\r\n\tfor (let i = 0; i < log.length; i++) {\r\n\t\tconst entry = log[i];\r\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\r\n\t\t\tconst command = entry.commands[j];\r\n\t\t\tif (command.entity === undo.command.entity.link) {\r\n\t\t\t\tif (command.value && command.value.id === oldId) {\r\n\t\t\t\t\tcommand.value.id = newId;\r\n\t\t\t\t}\r\n\t\t\t\tif (command.oldValue && command.oldValue.id === oldId) {\r\n\t\t\t\t\tcommand.oldValue.id = newId;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\ngantt.attachEvent(\"onTaskIdChange\", (oldId: TaskID, newId: TaskID) => {\r\n\tconst undo = _undo;\r\n\tupdateTasksIds(undo.getUndoStack(), oldId, newId);\r\n\tupdateTasksIds(undo.getRedoStack(), oldId, newId);\r\n});\r\n\r\ngantt.attachEvent(\"onLinkIdChange\", (oldId: LinkID, newId: LinkID) => {\r\n\tconst undo = _undo;\r\n\tupdateLinksIds(undo.getUndoStack(), oldId, newId);\r\n\tupdateLinksIds(undo.getRedoStack(), oldId, newId);\r\n});\r\n\r\ngantt.attachEvent(\"onGanttReady\", () => {\r\n\t_undo.updateConfigs();\r\n});\r\n\r\n}","\r\nexport default function(gantt){\r\n\r\nif(!gantt._markers) {\r\n\tgantt._markers = gantt.createDatastore({\r\n\t\tname: \"marker\",\r\n\t\tinitItem: function (marker) {\r\n\t\t\tmarker.id = marker.id || gantt.uid();\r\n\t\t\treturn marker;\r\n\t\t}\r\n\t});\r\n}\r\n\r\ngantt.config.show_markers = true;\r\n\r\nfunction render_marker(marker){\r\n\tif(!gantt.config.show_markers)\r\n\t\treturn false;\r\n\r\n\tif(!marker.start_date)\r\n\t\treturn false;\r\n\r\n\tvar state = gantt.getState();\r\n\tif(+marker.start_date > +state.max_date)\r\n\t\treturn;\r\n\tif((!marker.end_date || +marker.end_date < +state.min_date) && +marker.start_date < +state.min_date)\r\n\t\treturn;\r\n\r\n\tvar div = document.createElement(\"div\");\r\n\r\n\tdiv.setAttribute(\"data-marker-id\", marker.id);\r\n\r\n\tvar css = \"gantt_marker\";\r\n\tif(gantt.templates.marker_class)\r\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\r\n\r\n\tif(marker.css){\r\n\t\tcss += \" \" + marker.css;\r\n\t}\r\n\r\n\tif(gantt.templates.marker_class)\r\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\r\n\r\n\tif(marker.title){\r\n\t\tdiv.title = marker.title;\r\n\t}\r\n\tdiv.className = css;\r\n\r\n\tvar start = gantt.posFromDate(marker.start_date);\r\n\tdiv.style.left = start + \"px\";\r\n\tlet markerHeight = Math.max(gantt.getRowTop(gantt.getVisibleTaskCount()), 0) + \"px\";\r\n\tif (gantt.config.timeline_placeholder && gantt.$task_data){\r\n\t\tmarkerHeight = gantt.$task_data.scrollHeight + \"px\";\r\n\t}\r\n\tdiv.style.height = markerHeight;\r\n\tif(marker.end_date){\r\n\t\tvar end = gantt.posFromDate(marker.end_date);\r\n\t\tdiv.style.width = Math.max((end - start), 0) + \"px\";\r\n\r\n\t}\r\n\r\n\tif(marker.text){\r\n\t\tlet content = null;\r\n\t\tif(typeof marker.text === \"function\"){\r\n\t\t\tcontent = marker.text(marker);\r\n\t\t}else {\r\n\t\t\tcontent = marker.text;\r\n\t\t}\r\n\t\tif(content){\r\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(content)){\r\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' ></div>\";\r\n\t\t\t\tgantt.config.external_render.renderElement(content, div.querySelector(\".gantt_marker_content\"));\r\n\t\t\t}else{\r\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' >\" + marker.text + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\r\n\t\t\r\n\t}\r\n\r\n\treturn div;\r\n}\r\n\r\nfunction initMarkerArea(){\r\n\t// GS-481. Reset $marker_area if there is no timeline\r\n\tif(!gantt.$task_data || !gantt.$root.contains(gantt.$task_data)){\r\n\t\tgantt.$marker_area = null;\r\n\t\treturn;\r\n\t}\r\n\r\n\t// GS-2084. Don't add $marker_area when it already exists\r\n\tif(gantt.$marker_area && gantt.$task_data.contains(gantt.$marker_area)){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar markerArea = document.createElement(\"div\");\r\n\tmarkerArea.className = \"gantt_marker_area\";\r\n\tgantt.$task_data.appendChild(markerArea);\r\n\tgantt.$marker_area = markerArea;\r\n}\r\n\r\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\r\n\tif(!gantt.$marker_area)\r\n\t\tinitMarkerArea();\r\n});\r\n\r\ngantt.attachEvent(\"onDataRender\", function(){\r\n\tif(!gantt.$marker_area){\r\n\t\tinitMarkerArea();\r\n\t\tgantt.renderMarkers();\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onGanttLayoutReady\", function(){\r\n\t// GS-1304 - markers should attach when layout is initialized, both on gantt.init and gantt.resetLayout\r\n\t// wait for \"onBeforeGanttRender\", so all layout elements will be in DOM\r\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\r\n\t\t// GS-882. If markers are rendered in the onDataRender handler, \r\n\t\t// they are not attached to the layer, so we need to remove the DOM elements\r\n\t\tif (gantt.$marker_area) {\r\n\t\t\tgantt.$marker_area.innerHTML = \"\";\r\n\t\t}\r\n\t\tinitMarkerArea();\r\n\r\n\t\tvar layers = gantt.$services.getService(\"layers\");\r\n\t\tvar markerRenderer = layers.createDataRender({\r\n\t\t\tname: \"marker\",\r\n\t\t\tdefaultContainer: function(){ return gantt.$marker_area;}\r\n\t\t});\r\n\t\tmarkerRenderer.addLayer(render_marker);\r\n\t}, {once: true});\r\n});\r\n\r\ngantt.getMarker = function(id){\r\n\tif(!this._markers) return null;\r\n\r\n\treturn this._markers.getItem(id);\r\n};\r\n\r\ngantt.addMarker = function(marker){\r\n\treturn this._markers.addItem(marker);\r\n};\r\n\r\ngantt.deleteMarker = function(id){\r\n\tif(!this._markers.exists(id))\r\n\t\treturn false;\r\n\r\n\tthis._markers.removeItem(id);\r\n\treturn true;\r\n};\r\ngantt.updateMarker = function(id){\r\n\tthis._markers.refresh(id);\r\n};\r\n\r\ngantt._getMarkers = function(){\r\n\treturn this._markers.getItems();\r\n};\r\n\r\ngantt.renderMarkers = function () {\r\n\tthis._markers.refresh();\r\n};\r\n\r\n};","import {replaceValidZeroId} from \"../utils/helpers\";\r\n\r\nexport default function(gantt){\r\n\r\ngantt.config.multiselect = true;\r\ngantt.config.multiselect_one_level = false;\r\n\r\ngantt._multiselect = {\r\n\t_selected: {},\r\n\t_one_level: false,\r\n\t_active: true,\r\n\t_first_selected_when_shift: null,\r\n\tgetDefaultSelected: function() {\r\n\t\tvar selected = this.getSelected();\r\n\t\treturn selected.length ? selected[selected.length - 1] : null;\r\n\t},\r\n\tsetFirstSelected: function(id) {\r\n\t\tthis._first_selected_when_shift = id;\r\n\t},\r\n\tgetFirstSelected: function() {\r\n\t\treturn this._first_selected_when_shift;\r\n\t},\r\n\tisActive: function() {\r\n\t\tthis.updateState();\r\n\t\treturn this._active;\r\n\t},\r\n\tupdateState: function() {\r\n\t\tthis._one_level = gantt.config.multiselect_one_level;\r\n\t\tvar active = this._active;\r\n\t\tthis._active = gantt.config.select_task;\r\n\t\tif (this._active != active) {\r\n\t\t\tthis.reset();\r\n\t\t}\r\n\t},\r\n\treset: function () {\r\n\t\tthis._selected = {};\r\n\t},\r\n\tsetLastSelected: function (id) {\r\n\t\tgantt.$data.tasksStore.silent(function(){\r\n\t\t\tvar store = gantt.$data.tasksStore;\r\n\t\t\tif (id)\r\n\t\t\t\tstore.select(id+\"\");\r\n\t\t\telse\r\n\t\t\t\tstore.unselect(null);\r\n\t\t});\r\n\t},\r\n\tgetLastSelected: function () {\r\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\r\n\t\tif (last && gantt.isTaskExists(last))\r\n\t\t\treturn last;\r\n\t\treturn null;\r\n\t},\r\n\tselect: function (id, e) {\r\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\r\n\t\t\tthis._selected[id] = true;\r\n\t\t\tthis.setLastSelected(id);\r\n\t\t\tthis.afterSelect(id);\r\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\r\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\ttoggle: function (id, e) {\r\n\t\tif (this._selected[id]) {\r\n\t\t\tthis.unselect(id, e);\r\n\t\t} else {\r\n\t\t\tthis.select(id, e);\r\n\t\t}\r\n\t},\r\n\tunselect: function (id, e) {\r\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\r\n\t\t\tthis._selected[id] = false;\r\n\t\t\tif (this.getLastSelected() == id)\r\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\r\n\t\t\tthis.afterSelect(id);\r\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\r\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\r\n\t\t}\r\n\t},\r\n\tisSelected: function (id) {\r\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\r\n\t},\r\n\tgetSelected: function () {\r\n\t\tvar res = [];\r\n\t\tfor (var i in this._selected) {\r\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\r\n\t\t\t\tres.push(i);\r\n\t\t\t} else {\r\n\t\t\t\tthis._selected[i] = false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tres.sort(function(a, b) {\r\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\tforSelected: function (callback) {\r\n\t\tvar selected = this.getSelected();\r\n\t\tfor (var i = 0; i < selected.length; i++) {\r\n\t\t\tcallback(selected[i]);\r\n\t\t}\r\n\t},\r\n\tisSameLevel: function(id) {\r\n\t\tif (!this._one_level)\r\n\t\t\treturn true;\r\n\t\tvar last = this.getLastSelected();\r\n\t\tif (!last)\r\n\t\t\treturn true;\r\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\r\n\t\t\treturn true;\r\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\r\n\t},\r\n\tafterSelect: function(id) {\r\n\t\tif (gantt.isTaskExists(id)){\r\n\t\t\t// FIXME: quick workaround to prevent re-filtering inside refresh on multiselect\r\n\t\t\tgantt._quickRefresh(function(){\r\n\t\t\t\tgantt.refreshTask(id);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tdoSelection: function(e) {\r\n\t\tif (!this.isActive())\r\n\t\t\treturn false;\r\n\r\n\t\t// deny selection when click on 'expand' or 'collapse' icons\r\n\t\tif (gantt._is_icon_open_click(e))\r\n\t\t\treturn false;\r\n\r\n\t\tvar target_ev = gantt.locate(e);\r\n\t\tif (!target_ev)\r\n\t\t\treturn false;\r\n\r\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\r\n\t\t\treturn false;\r\n\r\n\t\tvar selected = this.getSelected();\r\n\t\tvar defaultLast = this.getFirstSelected();\r\n\t\tvar isLast = false;\r\n\t\tvar last = this.getLastSelected();\r\n\t\tvar multiSelect = gantt.config.multiselect;\r\n\r\n\r\n\t\tvar singleSelection = (function () {\r\n\t\t\t// GS-719: If the multiselect extension is added we still need a way\r\n\t\t\t// to open the inline editors after clicking on the cells in the grid\r\n\t\t\tconst controller = gantt.ext.inlineEditors;\r\n\t\t\tif(controller && controller.getState){\r\n\t\t\t\tconst state = controller.getState();\r\n\t\t\t\tconst cell = controller.locateCell(e.target);\r\n\r\n\t\t\t\tif (gantt.config.inline_editors_multiselect_open && cell && controller.getEditorConfig(cell.columnName)) {\r\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\r\n\t\t\t\t\t\t// do nothing if editor is already active in this cell\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.setFirstSelected(target_ev);\r\n\r\n\t\t\tif (!this.isSelected(target_ev)) {\r\n\t\t\t\tthis.select(target_ev, e);\r\n\t\t\t}\r\n\t\t\tselected = this.getSelected();\r\n\t\t\tfor (var i = 0; i < selected.length; i++) {\r\n\t\t\t\tif (selected[i] !== target_ev) {\r\n\t\t\t\t\tthis.unselect(selected[i], e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).bind(this);\r\n\r\n\t\tvar blockSelection = (function(){\r\n\t\t\tif (!last)\r\n\t\t\t\tlast = target_ev;\r\n\t\t\telse if (target_ev) {\r\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\r\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\r\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\r\n\t\t\t\t// GS-1969: if the selected tasks are collapsed, need to remove them\r\n\t\t\t\tif(first_indx == -1 || last_indx == -1){\r\n\t\t\t\t\tfirst_indx = target_indx;\r\n\t\t\t\t\tthis.reset();\r\n\t\t\t\t}\r\n\t\t\t\t// clear prev selection\r\n\t\t\t\tvar tmp = last;\r\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\r\n\t\t\t\t\tthis.unselect(tmp, e);\r\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\r\n\t\t\t\t}\r\n\t\t\t\ttmp = target_ev;\r\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\r\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\r\n\t\t\t\t\t\tisLast = true;\r\n\t\t\t\t\t\tdefaultLast = tmp;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}).bind(this);\r\n\r\n\r\n\t\tif (multiSelect && (e.ctrlKey || e.metaKey)) {\r\n\t\t\tif (!this.isSelected(target_ev))\r\n\t\t\t\tthis.setFirstSelected(target_ev);\r\n\r\n\t\t\tif (target_ev) {\r\n\t\t\t\tthis.toggle(target_ev, e);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\telse if (multiSelect && e.shiftKey) {\r\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\r\n\t\t\t\tthis.setFirstSelected(target_ev);\r\n\t\t\t}\r\n\r\n\t\t\tif (selected.length) { // select a group of tasks\r\n\t\t\t\tblockSelection();\r\n\t\t\t}\r\n\t\t\telse { // select a task when no task is selected and Shift is pressed\r\n\t\t\t\tsingleSelection();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\telse { // no key press or no multiple selection on the mouse click\r\n\t\t\tsingleSelection();\r\n\t\t}\r\n\r\n\r\n\t\tif (this.isSelected(target_ev)) {\r\n\t\t\tthis.setLastSelected(target_ev);\r\n\t\t} else if (defaultLast) {\r\n\t\t\tif (target_ev == last)\r\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\r\n\t\t} else {\r\n\t\t\tthis.setLastSelected(null);\r\n\t\t}\r\n\r\n\t\tif (!this.getSelected().length)\r\n\t\t\tthis.setLastSelected(null);\r\n\r\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\r\n\t\t\tthis.setFirstSelected(this.getLastSelected());\r\n\r\n\t\treturn true;\r\n\t}\r\n};\r\n\r\n(function(){\r\n\tvar old_selectTask = gantt.selectTask;\r\n\tgantt.selectTask = function(id) {\r\n\t\tid = replaceValidZeroId(id, this.config.root_id);\r\n\t\tif (!id)\r\n\t\t\treturn false;\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tvar res = id;\r\n\t\tif (multiselect.isActive()) {\r\n\t\t\tif (multiselect.select(id, null)) {\r\n\t\t\t\tmultiselect.setLastSelected(id);\r\n\t\t\t}\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t} else {\r\n\t\t\tres = old_selectTask.call(this, id);\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\tvar old_unselectTask = gantt.unselectTask;\r\n\tgantt.unselectTask = function(id) {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tvar isActive = multiselect.isActive();\r\n\t\tid = id || multiselect.getLastSelected();\r\n\t\tif(id && isActive) {\r\n\t\t\tmultiselect.unselect(id, null);\r\n\t\t\tif (id == multiselect.getLastSelected())\r\n\t\t\t\tmultiselect.setLastSelected(null);\r\n\t\t\tgantt.refreshTask(id);\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t}\r\n\t\tvar res = id;\r\n\t\tif (!isActive)\r\n\t\t\tres = old_unselectTask.call(this, id);\r\n\t\treturn res;\r\n\t};\r\n\r\n\tgantt.toggleTaskSelection = function(id) {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tif (id && multiselect.isActive()) {\r\n\t\t\tmultiselect.toggle(id);\r\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\r\n\t\t}\r\n\t};\r\n\tgantt.getSelectedTasks = function() {\r\n\t\tvar multiselect = gantt._multiselect;\r\n\t\tmultiselect.isActive();\r\n\t\treturn multiselect.getSelected();\r\n\t};\r\n\tgantt.eachSelectedTask = function(callback){\r\n\t\treturn this._multiselect.forSelected(callback);\r\n\t};\r\n\tgantt.isSelectedTask = function(id){\r\n\t\treturn this._multiselect.isSelected(id);\r\n\t};\r\n\tgantt.getLastSelectedTask = function(){\r\n\t\treturn this._multiselect.getLastSelected();\r\n\t};\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tvar old_isSelected = gantt.$data.tasksStore.isSelected;\r\n\t\tgantt.$data.tasksStore.isSelected = function(id){\r\n\t\t\tif (gantt._multiselect.isActive()) {\r\n\t\t\t\treturn gantt._multiselect.isSelected(id);\r\n\t\t\t}\r\n\t\t\treturn old_isSelected.call(this, id);\r\n\t\t};\r\n\t});\r\n})();\r\n\r\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\r\n\tvar multiselect = gantt._multiselect;\r\n\tif (!multiselect.isActive())\r\n\t\treturn true;\r\n\tif (gantt.isSelectedTask(id)) {\r\n\t\tmultiselect.unselect(id, null);\r\n\t\tmultiselect.select(new_id, null);\r\n\t}\r\n});\r\n\r\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\r\n\tvar multiselect = gantt._multiselect;\r\n\tif (!multiselect.isActive())\r\n\t\treturn true;\r\n\r\n\tif (multiselect._selected[id]) {\r\n\t\t// GS-1057: don't unselect the task here because the task is already unselected \r\n\t\t// it was in the select.js file before it was deleted\r\n\t\t// multiselect.unselect(id, null);\r\n\t\tmultiselect._selected[id] = false;\r\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\r\n\t}\r\n\r\n\tmultiselect.forSelected(function (task_id) {\r\n\t\tif (!gantt.isTaskExists(task_id))\r\n\t\t\tmultiselect.unselect(task_id, null);\r\n\t});\r\n});\r\n\r\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\r\n\tconst multiselect = gantt._multiselect;\r\n\tif (state && multiselect.isActive()) {\r\n\t\t//GS-1321: prevent unselecting task\r\n\t\tlet oldSelectedId = gantt.getSelectedId();\r\n\t\tlet oldSelectedTask = null;\r\n\t\tif (oldSelectedId) {\r\n\t\t\toldSelectedTask = gantt.getTask(oldSelectedId);\r\n\t\t}\r\n\t\tlet newSelectedTask = gantt.getTask(id);\r\n\t\tlet differentTreeLevel = false;\r\n\t\tif (oldSelectedTask && oldSelectedTask.$level != newSelectedTask.$level){\r\n\t\t\tdifferentTreeLevel = true;\r\n\t\t}\r\n\r\n\t\tif (gantt.config.multiselect_one_level && differentTreeLevel && !e.ctrlKey && !e.shiftKey) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (multiselect._one_level) {\r\n\t\t\treturn multiselect.isSameLevel(id);\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n});\r\n\r\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\r\n\tif (gantt._multiselect.doSelection(e))\r\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\r\n\treturn true;\r\n});\r\n\r\n};","/* eslint-disable */\r\n\r\nexport default function(gantt: any) {\r\n\r\n\tgantt.ext = gantt.ext || {};\r\n\r\n\tgantt.ext.export_api = gantt.ext.export_api || {\r\n\r\n\t\t_apiUrl: \"https://export.dhtmlx.com/gantt\",\r\n\r\n\t\t_preparePDFConfigRaw(config, type){\r\n\t\t\tlet previousDateRage:any = null;\r\n\t\t\tif (config.start && config.end){\r\n\t\t\t\tpreviousDateRage = {\r\n\t\t\t\t\tstart_date: gantt.config.start_date,\r\n\t\t\t\t\tend_date: gantt.config.end_date,\r\n\t\t\t\t};\r\n\t\t\t\tgantt.config.start_date = gantt.date.str_to_date(gantt.config.date_format)(config.start);\r\n\t\t\t\tgantt.config.end_date = gantt.date.str_to_date(gantt.config.date_format)(config.end);\r\n\t\t\t}\r\n\r\n\t\t\tconfig = gantt.mixin(config, {\r\n\t\t\t\tname: \"gantt.\" + type, data: gantt.ext.export_api._serializeHtml()\r\n\t\t\t});\r\n\r\n\t\t\tif (previousDateRage){\r\n\t\t\t\tgantt.config.start_date = previousDateRage.start_date;\r\n\t\t\t\tgantt.config.end_date = previousDateRage.end_date;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_prepareConfigPDF(config, type){\r\n\t\t\tconfig = gantt.mixin((config || {}), {\r\n\t\t\t\tname: \"gantt.\" + type,\r\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\r\n\t\t\t\tconfig: gantt.config\r\n\t\t\t});\r\n\t\t\tgantt.ext.export_api._fixColumns(config.config.columns);\r\n\t\t\treturn config;\r\n\t\t},\r\n\r\n\t\t_pdfExportRouter(config, type){\r\n\t\t\tif (config && config.raw) {\r\n\t\t\t\tgantt.ext.export_api._preparePDFConfigRaw(config, type);\r\n\t\t\t} else {\r\n\t\t\t\tconfig = gantt.ext.export_api._prepareConfigPDF(config, type);\r\n\t\t\t}\r\n\t\t\tconfig.version = gantt.version;\r\n\t\t\tgantt.ext.export_api._sendToExport(config, type);\r\n\t\t},\r\n\r\n\t\texportToPDF(config) {\r\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"pdf\");\r\n\t\t},\r\n\r\n\t\texportToPNG(config) {\r\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"png\");\r\n\t\t},\r\n\r\n\r\n\t\texportToICal(config) {\r\n\t\t\tconfig = gantt.mixin((config || {}), {\r\n\t\t\t\tname: \"gantt.ical\",\r\n\t\t\t\tdata: gantt.ext.export_api._serializePlain().data,\r\n\t\t\t\tversion: gantt.version\r\n\t\t\t});\r\n\t\t\tgantt.ext.export_api._sendToExport(config, \"ical\");\r\n\t\t},\r\n\r\n\t\texportToExcel(config) {\r\n\t\t\tconfig = config || {};\r\n\r\n\t\t\tlet tasks;\r\n\t\t\tlet dates;\r\n\t\t\tlet state;\r\n\t\t\tlet scroll;\r\n\t\t\t// GS-2124, we need to get all task nodes to correctly obtain the colors\r\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\r\n\t\t\tif (config.visual === \"base-colors\"){\r\n\t\t\t\tgantt.config.smart_rendering = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (config.start || config.end) {\r\n\t\t\t\tstate = gantt.getState();\r\n\t\t\t\tdates = [gantt.config.start_date, gantt.config.end_date];\r\n\t\t\t\tscroll = gantt.getScrollState();\r\n\t\t\t\tconst convert = gantt.date.str_to_date(gantt.config.date_format);\r\n\t\t\t\ttasks = gantt.eachTask;\r\n\r\n\t\t\t\tif (config.start){\r\n\t\t\t\t\tgantt.config.start_date = convert(config.start);\r\n\t\t\t\t}\r\n\t\t\t\tif (config.end){\r\n\t\t\t\t\tgantt.config.end_date = convert(config.end);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgantt.render();\r\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\r\n\r\n\t\t\t\tgantt.eachTask = gantt.ext.export_api._eachTaskTimed(gantt.config.start_date, gantt.config.end_date);\r\n\t\t\t} else if (config.visual === \"base-colors\"){\r\n\t\t\t\tgantt.render();\r\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\r\n\t\t\t}\r\n\r\n\t\t\tgantt._no_progress_colors = config.visual === \"base-colors\";\r\n\r\n\t\t\tconfig = gantt.mixin(config, {\r\n\t\t\t\tname: \"gantt.xlsx\",\r\n\t\t\t\ttitle: \"Tasks\",\r\n\t\t\t\tdata: gantt.ext.export_api._serializeTimeline(config).data,\r\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid({ rawDates: true }),\r\n\t\t\t\tversion: gantt.version\r\n\t\t\t});\r\n\r\n\t\t\tif (config.visual){\r\n\t\t\t\tconfig.scales = gantt.ext.export_api._serializeScales(config);\r\n\t\t\t}\r\n\r\n\t\t\tgantt.ext.export_api._sendToExport(config, \"excel\");\r\n\r\n\t\t\tif (config.start || config.end) {\r\n\t\t\t\tgantt.config.start_date = state.min_date;\r\n\t\t\t\tgantt.config.end_date = state.max_date;\r\n\t\t\t\tgantt.eachTask = tasks;\r\n\r\n\t\t\t\tgantt.render();\r\n\t\t\t\tgantt.scrollTo(scroll.x, scroll.y);\r\n\r\n\t\t\t\tgantt.config.start_date = dates[0];\r\n\t\t\t\tgantt.config.end_date = dates[1];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\texportToJSON(config) {\r\n\t\t\tconfig = gantt.mixin((config || {}), {\r\n\t\t\t\tname: \"gantt.json\",\r\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\r\n\t\t\t\tconfig: gantt.config,\r\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid(),\r\n\t\t\t\tworktime: gantt.ext.export_api._getWorktimeSettings(),\r\n\t\t\t\tversion: gantt.version\r\n\t\t\t});\r\n\t\t\tgantt.ext.export_api._sendToExport(config, \"json\");\r\n\t\t},\r\n\r\n\r\n\t\timportFromExcel(config) {\r\n\t\t\ttry {\r\n\t\t\t\tconst formData = config.data;\r\n\t\t\t\tif (formData instanceof File) {\r\n\t\t\t\t\tconst data = new FormData();\r\n\t\t\t\t\tdata.append(\"file\", formData);\r\n\t\t\t\t\tconfig.data = data;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {}\r\n\t\t\tgantt.ext.export_api._sendImportAjaxExcel(config);\r\n\t\t},\r\n\r\n\t\timportFromMSProject(config) {\r\n\t\t\tconst formData = config.data;\r\n\t\t\ttry {\r\n\t\t\t\tif (formData  instanceof File) {\r\n\t\t\t\t\tconst data = new FormData();\r\n\t\t\t\t\tdata.append(\"file\", formData);\r\n\t\t\t\t\tconfig.data = data;\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {}\r\n\t\t\tgantt.ext.export_api._sendImportAjaxMSP(config);\r\n\t\t},\r\n\r\n\t\timportFromPrimaveraP6(config) {\r\n\t\t\tconfig.type = \"primaveraP6-parse\";\r\n\t\t\treturn gantt.importFromMSProject(config);\r\n\t\t},\r\n\r\n\t\texportToMSProject(config) {\r\n\t\t\tconfig = config || {};\r\n\t\t\tconfig.skip_circular_links = config.skip_circular_links === undefined ? true : !!config.skip_circular_links;\r\n\r\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\r\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\r\n\t\t\tconst oldXmlDate = gantt.config.xml_date;\r\n\t\t\tconst oldDateFormat = gantt.config.date_format;\r\n\r\n\t\t\tconst exportServiceDateFormat = \"%d-%m-%Y %H:%i:%s\";\r\n\r\n\t\t\tgantt.config.xml_date = exportServiceDateFormat;\r\n\t\t\tgantt.config.date_format = exportServiceDateFormat;\r\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(exportServiceDateFormat);\r\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(exportServiceDateFormat);\r\n\t\t\tconst data = gantt.ext.export_api._serializeAll();\r\n\r\n\t\t\tgantt.ext.export_api._customProjectProperties(data, config);\r\n\r\n\t\t\tgantt.ext.export_api._customTaskProperties(data, config);\r\n\r\n\t\t\tif (config.skip_circular_links) {\r\n\t\t\t\tgantt.ext.export_api._clearRecLinks(data);\r\n\t\t\t}\r\n\r\n\t\t\tconfig = gantt.ext.export_api._exportConfig(data, config);\r\n\r\n\t\t\tgantt.ext.export_api._sendToExport(config, config.type || \"msproject\");\r\n\t\t\tgantt.config.xml_date = oldXmlDate;\r\n\t\t\tgantt.config.date_format = oldDateFormat;\r\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\r\n\t\t\tgantt.templates.format_date = oldFormatDate;\r\n\r\n\t\t\tgantt.config.$custom_data = null;\r\n\t\t\tgantt.config.custom = null;\r\n\t\t},\r\n\r\n\t\texportToPrimaveraP6(config) {\r\n\t\t\tconfig = config || {};\r\n\t\t\tconfig.type = \"primaveraP6\";\r\n\t\t\treturn gantt.exportToMSProject(config);\r\n\t\t},\r\n\r\n\t\t_fixColumns(columns) {\r\n\t\t\tfor (let i = 0; i < columns.length; i++) {\r\n\t\t\t\tcolumns[i].label = columns[i].label || gantt.locale.labels[\"column_\" + columns[i].name];\r\n\t\t\t\tif (typeof columns[i].width === \"string\") {\r\n\t\t\t\t\tcolumns[i].width = columns[i].width * 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_xdr(url, pack, cb) {\r\n\t\t\tgantt.ajax.post(url, pack, cb);\r\n\t\t},\r\n\r\n\t\t_markColumns(base) {\r\n\t\t\tconst columns = base.config.columns;\r\n\t\t\tif (columns){\r\n\t\t\t\tfor (let i = 0; i < columns.length; i++) {\r\n\t\t\t\t\tif (columns[i].template){\r\n\t\t\t\t\t\tcolumns[i].$template = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\t_sendImportAjaxExcel(config) {\r\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\r\n\t\t\tconst store = config.store || 0;\r\n\t\t\tconst formData = config.data;\r\n\t\t\tconst callback = config.callback;\r\n\r\n\t\t\tformData.append(\"type\", \"excel-parse\");\r\n\t\t\tformData.append(\"data\", JSON.stringify({\r\n\t\t\t\tsheet: config.sheet || 0\r\n\t\t\t}));\r\n\r\n\t\t\tif (store){\r\n\t\t\t\tformData.append(\"store\", store);\r\n\t\t\t}\r\n\r\n\t\t\tconst xhr = new XMLHttpRequest();\r\n\t\t\txhr.onreadystatechange = function(e) {\r\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tcallback(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.onload = function() {\r\n\t\t\t\tconst fail = xhr.status > 400;\r\n\t\t\t\tlet info = null;\r\n\r\n\t\t\t\tif (!fail) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\r\n\t\t\t\t\t} catch (e) { }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback) {\r\n\t\t\t\t\tcallback(info);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n\t\t\txhr.send(formData);\r\n\t\t},\r\n\r\n\r\n\t\t_ajaxToExport(data, type, callback) {\r\n\t\t\tdelete data.callback;\r\n\r\n\t\t\tconst url = data.server || gantt.ext.export_api._apiUrl;\r\n\t\t\tconst pack = \"type=\" + type + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(data));\r\n\r\n\t\t\tconst cb = function(loader) {\r\n\t\t\t\tconst xdoc = loader.xmlDoc || loader;\r\n\t\t\t\tconst fail = xdoc.status > 400;\r\n\t\t\t\tlet info = null;\r\n\r\n\t\t\t\tif (!fail) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tinfo = JSON.parse(xdoc.responseText);\r\n\t\t\t\t\t} catch (e) { }\r\n\t\t\t\t}\r\n\t\t\t\tcallback(info);\r\n\t\t\t};\r\n\r\n\t\t\tgantt.ext.export_api._xdr(url, pack, cb);\r\n\t\t},\r\n\t\t_serializableGanttConfig(config) {\r\n\t\t\tconst result = gantt.mixin({}, config);\r\n\r\n\t\t\tif (result.columns) {\r\n\t\t\t\tresult.columns = result.columns.map(function(col) {\r\n\t\t\t\t\tconst copy = gantt.mixin({}, col);\r\n\t\t\t\t\tdelete copy.editor;\r\n\t\t\t\t\treturn copy;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tdelete result.editor_types;\r\n\t\t\treturn result;\r\n\t\t},\r\n\r\n\t\t_sendToExport(data, type) {\r\n\t\t\tconst convert = gantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\r\n\t\t\tif(!data.skin){\r\n\t\t\t\tdata.skin = gantt.skin;\r\n\t\t\t}\r\n\t\t\tif (data.config) {\r\n\t\t\t\tdata.config = gantt.copy(gantt.ext.export_api._serializableGanttConfig(data.config));\r\n\t\t\t\tgantt.ext.export_api._markColumns(data, type);\r\n\r\n\t\t\t\tif (data.config.start_date && data.config.end_date) {\r\n\t\t\t\t\tif (data.config.start_date instanceof Date) {\r\n\t\t\t\t\t\tdata.config.start_date = convert(data.config.start_date);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (data.config.end_date instanceof Date) {\r\n\t\t\t\t\t\tdata.config.end_date = convert(data.config.end_date);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (data.callback) {\r\n\t\t\t\treturn gantt.ext.export_api._ajaxToExport(data, type, data.callback);\r\n\t\t\t}\r\n\r\n\t\t\tconst form = gantt.ext.export_api._createHiddenForm();\r\n\t\t\tform.firstChild.action = data.server || gantt.ext.export_api._apiUrl;\r\n\t\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\r\n\t\t\tform.firstChild.childNodes[1].value = type;\r\n\t\t\tform.firstChild.submit();\r\n\t\t},\r\n\r\n\t\t_createHiddenForm() {\r\n\t\t\tif (!gantt.ext.export_api._hidden_export_form) {\r\n\t\t\t\tconst t = gantt.ext.export_api._hidden_export_form = document.createElement(\"div\");\r\n\t\t\t\tt.style.display = \"none\";\r\n\t\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\";\r\n\t\t\t\tdocument.body.appendChild(t);\r\n\t\t\t}\r\n\t\t\treturn gantt.ext.export_api._hidden_export_form;\r\n\t\t},\r\n\r\n\r\n\t\t_copyObjectBase(obj) {\r\n\t\t\tconst copy = {\r\n\t\t\t\tstart_date: undefined,\r\n\t\t\t\tend_date: undefined,\r\n\t\t\t\tconstraint_date: undefined,\r\n\t\t\t\tdeadline: undefined\r\n\t\t\t};\r\n\t\t\tfor (const key in obj) {\r\n\t\t\t\tif (key.charAt(0) === \"$\" || key === \"baselines\"){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tcopy[key] = obj[key];\r\n\t\t\t}\r\n\t\t\tconst formatDate = gantt.templates.xml_format || gantt.templates.format_date;\r\n\r\n\t\t\tcopy.start_date = formatDate(copy.start_date);\r\n\t\t\tif (copy.end_date){\r\n\t\t\t\tcopy.end_date = formatDate(copy.end_date);\r\n\t\t\t}\r\n\t\t\tif (copy.constraint_date){\r\n\t\t\t\tcopy.constraint_date = formatDate(copy.constraint_date);\r\n\t\t\t}\r\n\t\t\tif (copy.deadline){\r\n\t\t\t\tcopy.deadline = formatDate(copy.deadline);\r\n\t\t\t}\r\n\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\r\n\t\t_color_box: null,\r\n\t\t_color_hash: {},\r\n\r\n\t\t_getStyles(css) {\r\n\t\t\tif (!gantt.ext.export_api._color_box) {\r\n\t\t\t\tgantt.ext.export_api._color_box = document.createElement(\"DIV\");\r\n\t\t\t\tgantt.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\";\r\n\t\t\t\tdocument.body.appendChild(gantt.ext.export_api._color_box);\r\n\t\t\t}\r\n\t\t\tif (gantt.ext.export_api._color_hash[css]){\r\n\t\t\t\treturn gantt.ext.export_api._color_hash[css];\r\n\t\t\t}\r\n\r\n\t\t\tgantt.ext.export_api._color_box.className = css;\r\n\t\t\tconst color = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"color\");\r\n\t\t\tconst backgroundColor = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"backgroundColor\");\r\n\t\t\treturn (gantt.ext.export_api._color_hash[css] = color + \";\" + backgroundColor);\r\n\t\t},\r\n\r\n\r\n\t\t_getMinutesWorktimeSettings(parsedRanges) {\r\n\t\t\tconst minutes:any = [];\r\n\t\t\tparsedRanges.forEach(function(range) {\r\n\t\t\t\tminutes.push(range.startMinute);\r\n\t\t\t\tminutes.push(range.endMinute);\r\n\t\t\t});\r\n\t\t\treturn minutes;\r\n\t\t},\r\n\r\n\t\t_getWorktimeSettings() {\r\n\r\n\t\t\tconst defaultWorkTimes = {\r\n\t\t\t\thours: [0, 24],\r\n\t\t\t\tminutes: null,\r\n\t\t\t\tdates: { 0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true }\r\n\t\t\t};\r\n\r\n\t\t\tlet time;\r\n\t\t\tif (!gantt.config.work_time) {\r\n\t\t\t\ttime = defaultWorkTimes;\r\n\t\t\t} else {\r\n\t\t\t\tconst wTime = gantt._working_time_helper;\r\n\t\t\t\tif (wTime && wTime.get_calendar) {\r\n\t\t\t\t\ttime = wTime.get_calendar();\r\n\t\t\t\t} else if (wTime) {\r\n\t\t\t\t\ttime = {\r\n\t\t\t\t\t\thours: wTime.hours,\r\n\t\t\t\t\t\tminutes: null,\r\n\t\t\t\t\t\tdates: wTime.dates\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (gantt.config.worktimes && gantt.config.worktimes.global) {\r\n\t\t\t\t\tconst settings = gantt.config.worktimes.global;\r\n\r\n\t\t\t\t\tif (settings.parsed) {\r\n\t\t\t\t\t\tconst minutes = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.hours);\r\n\t\t\t\t\t\ttime = {\r\n\t\t\t\t\t\t\thours: null,\r\n\t\t\t\t\t\t\tminutes,\r\n\t\t\t\t\t\t\tdates: {}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tfor (const i in settings.parsed.dates) {\r\n\t\t\t\t\t\t\tif (Array.isArray(settings.parsed.dates[i])) {\r\n\t\t\t\t\t\t\t\ttime.dates[i] = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.dates[i]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttime.dates[i] = settings.parsed.dates[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttime = {\r\n\t\t\t\t\t\t\thours: settings.hours,\r\n\t\t\t\t\t\t\tminutes: null,\r\n\t\t\t\t\t\t\tdates: settings.dates\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttime = defaultWorkTimes;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn time;\r\n\t\t},\r\n\r\n\r\n\t\t_eachTaskTimed(start, end) {\r\n\t\t\treturn function(code, parent, master) {\r\n\t\t\t\tparent = parent || gantt.config.root_id;\r\n\t\t\t\tmaster = master || gantt;\r\n\r\n\t\t\t\tconst branch = gantt.getChildren(parent);\r\n\t\t\t\tif (branch){\r\n\t\t\t\t\tfor (let i = 0; i < branch.length; i++) {\r\n\t\t\t\t\t\tconst item = gantt._pull[branch[i]];\r\n\t\t\t\t\t\tif ((!start || item.end_date > start) && (!end || item.start_date < end)){\r\n\t\t\t\t\t\t\tcode.call(master, item);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (gantt.hasChild(item.id)){\r\n\t\t\t\t\t\t\tgantt.eachTask(code, item.id, master);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\r\n\r\n\t\t// patch broken json serialization in gantt 2.1\r\n\t\t_originalCopyObject: gantt.json._copyObject,\r\n\r\n\r\n\t\t_copyObjectPlain(obj) {\r\n\t\t\tconst text = gantt.templates.task_text(obj.start_date, obj.end_date, obj);\r\n\r\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\r\n\t\t\tcopy.text = text || copy.text;\r\n\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\t\t_getColor(node, style) {\r\n\t\t\tconst value = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\r\n\t\t\tconst rgb = value.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\r\n\t\t\treturn ((rgb && rgb.length === 4) ?\r\n\t\t\t\t(\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\r\n\t\t\t\t(\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\r\n\t\t\t\t(\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : value).replace(\"#\", \"\");\r\n\t\t},\r\n\r\n\r\n\t\t// excel serialization\r\n\t\t_copyObjectTable(obj) {\r\n\t\t\t// Excel interprets UTC time as local time in every timezone, send local time instead of actual UTC time.\r\n\t\t\t// https://github.com/SheetJS/js-xlsx/issues/126#issuecomment-60531614\r\n\t\t\tconst toISOstring = gantt.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\");\r\n\r\n\t\t\tconst copy = gantt.ext.export_api._copyObjectColumns(obj, gantt.ext.export_api._copyObjectPlain(obj));\r\n\t\t\tif (copy.start_date){\r\n\t\t\t\tcopy.start_date = toISOstring(obj.start_date);\r\n\t\t\t}\r\n\t\t\tif (copy.end_date){\r\n\t\t\t\tcopy.end_date = toISOstring(obj.end_date);\r\n\t\t\t}\r\n\r\n\t\t\t// private gantt._day_index_by_date was replaced by public gantt.columnIndexByDate in gantt 5.0\r\n\t\t\tconst getDayIndex = gantt._day_index_by_date ? gantt._day_index_by_date : gantt.columnIndexByDate;\r\n\r\n\t\t\tcopy.$start = getDayIndex.call(gantt, obj.start_date);\r\n\t\t\tcopy.$end = getDayIndex.call(gantt, obj.end_date);\r\n\r\n\t\t\t// GS-2100. Correct bar position considering hidden cells\r\n\t\t\tlet hiddenCells = 0;\r\n\t\t\tconst scaleCellsWidth = gantt.getScale().width;\r\n\t\t\tif (scaleCellsWidth.indexOf(0) > -1) {\r\n\t\t\t\tlet i = 0;\r\n\t\t\t\tfor (i; i < copy.$start; i++) {\r\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\r\n\t\t\t\t\t\thiddenCells++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcopy.$start -= hiddenCells;\r\n\r\n\t\t\t\tfor (i; i < copy.$end; i++) {\r\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\r\n\t\t\t\t\t\thiddenCells++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcopy.$end -= hiddenCells;\r\n\t\t\t}\r\n\r\n\t\t\tcopy.$level = obj.$level;\r\n\t\t\tcopy.$type = obj.$rendered_type;\r\n\r\n\t\t\tconst tmps = gantt.templates;\r\n\t\t\tcopy.$text = tmps.task_text(obj.start, obj.end_date, obj);\r\n\t\t\tcopy.$left = tmps.leftside_text ? tmps.leftside_text(obj.start, obj.end_date, obj) : \"\";\r\n\t\t\tcopy.$right = tmps.rightside_text ? tmps.rightside_text(obj.start, obj.end_date, obj) : \"\";\r\n\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\t\t_copyObjectColors(obj) {\r\n\t\t\tconst copy = gantt.ext.export_api._copyObjectTable(obj);\r\n\r\n\t\t\tconst node = gantt.getTaskNode(obj.id);\r\n\t\t\tif (node && node.firstChild) {\r\n\t\t\t\tlet color = gantt.ext.export_api._getColor((gantt._no_progress_colors ? node : node.firstChild), \"backgroundColor\");\r\n\t\t\t\tif (color === \"363636\"){\r\n\t\t\t\t\tcolor = gantt.ext.export_api._getColor(node, \"backgroundColor\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcopy.$color = color;\r\n\t\t\t} else if (obj.color){\r\n\t\t\t\tcopy.$color = obj.color;\r\n\t\t\t}\r\n\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\t\t_copyObjectColumns(obj, copy) {\r\n\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\r\n\t\t\t\tconst ct = gantt.config.columns[i].template;\r\n\t\t\t\tif (ct) {\r\n\t\t\t\t\tlet val = ct(obj);\r\n\t\t\t\t\tif (val instanceof Date){\r\n\t\t\t\t\t\tval = gantt.templates.date_grid(val, obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcopy[\"_\" + i] = val;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\t\t_copyObjectAll(obj) {\r\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\r\n\r\n\t\t\tconst templates = [\r\n\t\t\t\t\"leftside_text\",\r\n\t\t\t\t\"rightside_text\",\r\n\t\t\t\t\"task_text\",\r\n\t\t\t\t\"progress_text\",\r\n\t\t\t\t\"task_class\"\r\n\t\t\t];\r\n\r\n\t\t\t// serialize all text templates\r\n\t\t\tfor (let i = 0; i < templates.length; i++) {\r\n\t\t\t\tconst template = gantt.templates[templates[i]];\r\n\t\t\t\tif (template){\r\n\t\t\t\t\tcopy[\"$\" + i] = template(obj.start_date, obj.end_date, obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tgantt.ext.export_api._copyObjectColumns(obj, copy);\r\n\t\t\tcopy.open = obj.$open;\r\n\t\t\treturn copy;\r\n\t\t},\r\n\r\n\r\n\t\t_serializeHtml() {\r\n\t\t\tconst smartScales = gantt.config.smart_scales;\r\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\r\n\t\t\tif (smartScales || smartRendering) {\r\n\t\t\t\tgantt.config.smart_rendering = false;\r\n\t\t\t\tgantt.config.smart_scales = false;\r\n\t\t\t\tgantt.render();\r\n\t\t\t}\r\n\r\n\t\t\tconst html = gantt.$container.parentNode.innerHTML;\r\n\r\n\t\t\tif (smartScales || smartRendering) {\r\n\t\t\t\tgantt.config.smart_scales = smartScales;\r\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\r\n\t\t\t\tgantt.render();\r\n\t\t\t}\r\n\r\n\t\t\treturn html;\r\n\t\t},\r\n\r\n\t\t_serializeAll() {\r\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectAll;\r\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\r\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\r\n\t\t\treturn data;\r\n\t\t},\r\n\r\n\t\t_serializePlain() {\r\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\r\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\r\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\r\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\r\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectPlain;\r\n\r\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\r\n\r\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\r\n\t\t\tgantt.templates.format_date = oldFormatDate;\r\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\r\n\r\n\t\t\tdelete data.links;\r\n\t\t\treturn data;\r\n\t\t},\r\n\r\n\t\t_getRaw() {\r\n\t\t\t// support Gantt < 5.0\r\n\t\t\tif (gantt._scale_helpers) {\r\n\t\t\t\tconst scales = gantt._get_scales();\r\n\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\r\n\t\t\t\tconst\tautosizeMinWidth = gantt._get_resize_options().x ? Math.max(gantt.config.autosize_min_width, 0) : gantt.config.$task.offsetWidth;\r\n\t\t\t\tconst\theight = gantt.config.config.scale_height - 1;\r\n\t\t\t\treturn gantt._scale_helpers.prepareConfigs(scales, minWidth, autosizeMinWidth, height);\r\n\t\t\t} else { // Gantt >= 5.0\r\n\t\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\r\n\t\t\t\tif (timeline) {\r\n\t\t\t\t\tlet availWidth = timeline.$config.width;\r\n\t\t\t\t\tif (gantt.config.autosize === \"x\" || gantt.config.autosize === \"xy\") {\r\n\t\t\t\t\t\tavailWidth = Math.max(gantt.config.autosize_min_width, 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst state = gantt.getState();\r\n\t\t\t\t\tconst\tscales = timeline._getScales();\r\n\t\t\t\t\tconst\tminWidth = gantt.config.min_column_width;\r\n\t\t\t\t\tconst\theight = gantt.config.scale_height - 1;\r\n\t\t\t\t\tconst\trtl = gantt.config.rtl;\r\n\t\t\t\t\treturn timeline.$scaleHelper.prepareConfigs(scales, minWidth, availWidth, height, state.min_date, state.max_date, rtl);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_serializeTimeline(config) {\r\n\t\t\tgantt.json._copyObject = config.visual ? gantt.ext.export_api._copyObjectColors : gantt.ext.export_api._copyObjectTable;\r\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\r\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\r\n\r\n\t\t\tdelete data.links;\r\n\r\n\t\t\tif (config.cellColors) {\r\n\t\t\t\tconst css = gantt.templates.timeline_cell_class || gantt.templates.task_cell_class;\r\n\t\t\t\tif (css) {\r\n\t\t\t\t\tconst raw = gantt.ext.export_api._getRaw();\r\n\t\t\t\t\tlet steps = raw[0].trace_x;\r\n\t\t\t\t\tfor (let i = 1; i < raw.length; i++){\r\n\t\t\t\t\t\tif (raw[i].trace_x.length > steps.length){\r\n\t\t\t\t\t\t\tsteps = raw[i].trace_x;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (let i = 0; i < data.data.length; i++) {\r\n\t\t\t\t\t\tdata.data[i].styles = [];\r\n\t\t\t\t\t\tconst task = gantt.getTask(data.data[i].id);\r\n\t\t\t\t\t\tfor (let j = 0; j < steps.length; j++) {\r\n\t\t\t\t\t\t\tconst date = steps[j];\r\n\t\t\t\t\t\t\tconst cellCss = css(task, date);\r\n\t\t\t\t\t\t\tif (cellCss){\r\n\t\t\t\t\t\t\t\tdata.data[i].styles.push({ index: j, styles: gantt.ext.export_api._getStyles(cellCss) });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn data;\r\n\t\t},\r\n\r\n\t\t_serializeScales(config) {\r\n\t\t\tconst scales:any = [];\r\n\t\t\tconst raw = gantt.ext.export_api._getRaw();\r\n\r\n\t\t\tlet min = Infinity;\r\n\t\t\tlet max = 0;\r\n\t\t\tfor (let i = 0; i < raw.length; i++) {\r\n\t\t\t\tmin = Math.min(min, raw[i].col_width);\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i < raw.length; i++) {\r\n\t\t\t\tlet start = 0;\r\n\t\t\t\tlet end = 0;\r\n\t\t\t\tconst row:any = [];\r\n\r\n\t\t\t\tscales.push(row);\r\n\t\t\t\tconst step = raw[i];\r\n\t\t\t\tmax = Math.max(max, step.trace_x.length);\r\n\t\t\t\tconst template = step.format || step.template || (step.date ? gantt.date.date_to_str(step.date) : gantt.config.date_scale);\r\n\r\n\t\t\t\tfor (let j = 0; j < step.trace_x.length; j++) {\r\n\t\t\t\t\tconst date = step.trace_x[j];\r\n\t\t\t\t\tend = start + Math.round(step.width[j] / min);\r\n\r\n\t\t\t\t\tconst scaleCell = { text: template(date), start, end, styles: \"\" };\r\n\r\n\t\t\t\t\tif (config.cellColors) {\r\n\t\t\t\t\t\tconst css = step.css || gantt.templates.scaleCell_class;\r\n\t\t\t\t\t\tif (css) {\r\n\t\t\t\t\t\t\tconst scaleCss = css(date);\r\n\t\t\t\t\t\t\tif (scaleCss){\r\n\t\t\t\t\t\t\t\tscaleCell.styles = gantt.ext.export_api._getStyles(scaleCss);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trow.push(scaleCell);\r\n\t\t\t\t\tstart = end;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn { width: max, height: scales.length, data: scales };\r\n\t\t},\r\n\r\n\t\t_serializeGrid(config) {\r\n\t\t\tgantt.exportMode = true;\r\n\r\n\t\t\tconst columns:any = [];\r\n\t\t\tconst cols = gantt.config.columns;\r\n\r\n\t\t\tlet ccount = 0;\r\n\t\t\tfor (let i = 0; i < cols.length; i++) {\r\n\t\t\t\tif (cols[i].name === \"add\" || cols[i].name === \"buttons\") {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcolumns[ccount] = {\r\n\t\t\t\t\tid: ((cols[i].template) ? (\"_\" + i) : cols[i].name),\r\n\t\t\t\t\theader: cols[i].label || gantt.locale.labels[\"column_\" + cols[i].name],\r\n\t\t\t\t\twidth: (cols[i].width ? Math.floor(cols[i].width / 4) : \"\"),\r\n\t\t\t\t\ttree: cols[i].tree || false\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (cols[i].name === \"duration\"){\r\n\t\t\t\t\tcolumns[ccount].type = \"number\";\r\n\t\t\t\t}\r\n\t\t\t\tif (cols[i].name === \"start_date\" || cols[i].name === \"end_date\") {\r\n\t\t\t\t\tcolumns[ccount].type = \"date\";\r\n\t\t\t\t\tif (config && config.rawDates){\r\n\t\t\t\t\t\tcolumns[ccount].id = cols[i].name;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tccount++;\r\n\t\t\t}\r\n\r\n\t\t\tgantt.exportMode = false;\r\n\t\t\treturn columns;\r\n\t\t},\r\n\r\n\t\t_exportSerialize() {\r\n\t\t\tgantt.exportMode = true;\r\n\r\n\t\t\tconst xmlFormat = gantt.templates.xml_format;\r\n\t\t\tconst formatDate = gantt.templates.format_date;\r\n\r\n\t\t\t// use configuration date format for serialization so date could be parsed on the export\r\n\t\t\t// required when custom format date function is defined\r\n\t\t\tgantt.templates.xml_format =\r\n\t\t\t\tgantt.templates.format_date =\r\n\t\t\t\tgantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\r\n\r\n\t\t\tconst data = gantt.serialize();\r\n\r\n\t\t\tgantt.templates.xml_format = xmlFormat;\r\n\t\t\tgantt.templates.format_date = formatDate;\r\n\t\t\tgantt.exportMode = false;\r\n\t\t\treturn data;\r\n\t\t},\r\n\r\n\r\n\t\t_setLevel(data) {\r\n\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\t// tslint:disable-next-line triple-equals\r\n\t\t\t\tif (data[i].parent == 0) {\r\n\t\t\t\t\tdata[i]._lvl = 1;\r\n\t\t\t\t}\r\n\t\t\t\tfor (let j = i + 1; j < data.length; j++) {\r\n\t\t\t\t\t// tslint:disable-next-line triple-equals\r\n\t\t\t\t\tif (data[i].id == data[j].parent) {\r\n\t\t\t\t\t\tdata[j]._lvl = data[i]._lvl + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_clearLevel(data) {\r\n\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\tdelete data[i]._lvl;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_clearRecLinks(data) {\r\n\t\t\tgantt.ext.export_api._setLevel(data.data);\r\n\t\t\tconst tasks = {};\r\n\t\t\tfor (let i = 0; i < data.data.length; i++) {\r\n\t\t\t\ttasks[data.data[i].id] = data.data[i];\r\n\t\t\t}\r\n\r\n\t\t\tconst links = {};\r\n\r\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\r\n\t\t\t\tconst link = data.links[i];\r\n\t\t\t\tif (gantt.isTaskExists(link.source) && gantt.isTaskExists(link.target) &&\r\n\t\t\t\t\ttasks[link.source] && tasks[link.target]) {\r\n\t\t\t\t\tlinks[link.id] = link;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (const j in links) {\r\n\t\t\t\tgantt.ext.export_api._makeLinksSameLevel(links[j], tasks);\r\n\t\t\t}\r\n\r\n\t\t\tconst skippedLinks = {};\r\n\t\t\tfor (const j in tasks) {\r\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(tasks[j], links, tasks, {}, skippedLinks, null);\r\n\t\t\t}\r\n\r\n\t\t\tif (Object.keys(links)) {\r\n\t\t\t\tgantt.ext.export_api._clearLinksSameLevel(links, tasks);\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\r\n\t\t\t\tif (!links[data.links[i].id]) {\r\n\t\t\t\t\tdata.links.splice(i, 1);\r\n\t\t\t\t\ti--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tgantt.ext.export_api._clearLevel(data.data);\r\n\t\t},\r\n\r\n\t\t_clearCircDependencies(task, links, tasks, usedTasks, skippedLinks, prevLink) {\r\n\t\t\tconst sources = task.$_source;\r\n\t\t\tif (!sources) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (usedTasks[task.id]) {\r\n\t\t\t\tgantt.ext.export_api._onCircDependencyFind(prevLink, links, usedTasks, skippedLinks);\r\n\t\t\t}\r\n\r\n\t\t\tusedTasks[task.id] = true;\r\n\r\n\t\t\tconst targets = {};\r\n\r\n\t\t\tfor (let i = 0; i < sources.length; i++) {\r\n\t\t\t\tif (skippedLinks[sources[i]]) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst curLink = links[sources[i]];\r\n\t\t\t\tconst targetTask = tasks[curLink._target];\r\n\t\t\t\tif (targets[targetTask.id]) { // two link from one task to another\r\n\t\t\t\t\tgantt.ext.export_api._onCircDependencyFind(curLink, links, usedTasks, skippedLinks);\r\n\t\t\t\t}\r\n\t\t\t\ttargets[targetTask.id] = true;\r\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(targetTask, links, tasks, usedTasks, skippedLinks, curLink);\r\n\t\t\t}\r\n\t\t\tusedTasks[task.id] = false;\r\n\t\t},\r\n\r\n\t\t_onCircDependencyFind(link, links, usedTasks, skippedLinks) {\r\n\t\t\tif (link) {\r\n\t\t\t\tif (gantt.callEvent(\"onExportCircularDependency\", [link.id, link])) {\r\n\t\t\t\t\tdelete links[link.id];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdelete usedTasks[link._source];\r\n\t\t\t\tdelete usedTasks[link._target];\r\n\t\t\t\tskippedLinks[link.id] = true;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_makeLinksSameLevel(link, tasks) {\r\n\t\t\tlet task;\r\n\t\t\tlet targetLvl;\r\n\t\t\tconst linkT = {\r\n\t\t\t\ttarget: tasks[link.target],\r\n\t\t\t\tsource: tasks[link.source]\r\n\t\t\t};\r\n\t\t\t// tslint:disable-next-line triple-equals\r\n\t\t\tif (linkT.target._lvl != linkT.source._lvl) {\r\n\t\t\t\tif (linkT.target._lvl < linkT.source._lvl) {\r\n\t\t\t\t\ttask = \"source\";\r\n\t\t\t\t\ttargetLvl = linkT.target._lvl;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttask = \"target\";\r\n\t\t\t\t\ttargetLvl = linkT.source._lvl;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdo {\r\n\t\t\t\t\tconst parent = tasks[linkT[task].parent];\r\n\t\t\t\t\tif (!parent) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlinkT[task] = parent;\r\n\t\t\t\t} while (linkT[task]._lvl < targetLvl);\r\n\r\n\t\t\t\tlet sourceParent = tasks[linkT.source.parent];\r\n\t\t\t\tlet\ttargetParent = tasks[linkT.target.parent];\r\n\t\t\t\t// tslint:disable-next-line triple-equals\r\n\t\t\t\twhile (sourceParent && targetParent && sourceParent.id != targetParent.id) {\r\n\t\t\t\t\tlinkT.source = sourceParent;\r\n\t\t\t\t\tlinkT.target = targetParent;\r\n\t\t\t\t\tsourceParent = tasks[linkT.source.parent];\r\n\t\t\t\t\ttargetParent = tasks[linkT.target.parent];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlink._target = linkT.target.id;\r\n\t\t\tlink._source = linkT.source.id;\r\n\r\n\t\t\tif (!linkT.target.$_target){\r\n\t\t\t\tlinkT.target.$_target = [];\r\n\t\t\t}\r\n\t\t\tlinkT.target.$_target.push(link.id);\r\n\r\n\t\t\tif (!linkT.source.$_source){\r\n\t\t\t\tlinkT.source.$_source = [];\r\n\t\t\t}\r\n\t\t\tlinkT.source.$_source.push(link.id);\r\n\t\t},\r\n\r\n\t\t_clearLinksSameLevel(links, tasks) {\r\n\t\t\tfor (const link in links) {\r\n\t\t\t\tdelete links[link]._target;\r\n\t\t\t\tdelete links[link]._source;\r\n\t\t\t}\r\n\r\n\t\t\tfor (const task in tasks) {\r\n\t\t\t\tdelete tasks[task].$_source;\r\n\t\t\t\tdelete tasks[task].$_target;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\t_customProjectProperties(data, config) {\r\n\t\t\tif (config && config.project) {\r\n\t\t\t\tfor (const i in config.project) {\r\n\t\t\t\t\tif (!gantt.config.$custom_data){\r\n\t\t\t\t\t\tgantt.config.$custom_data = {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt.config.$custom_data[i] = typeof config.project[i] === \"function\" ? config.project[i](gantt.config) : config.project[i];\r\n\t\t\t\t}\r\n\t\t\t\tdelete config.project;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_customTaskProperties(data, config) {\r\n\t\t\tif (config && config.tasks) {\r\n\t\t\t\tdata.data.forEach(function(el) {\r\n\t\t\t\t\tfor (const i in config.tasks) {\r\n\t\t\t\t\t\tif (!el.$custom_data){\r\n\t\t\t\t\t\t\tel.$custom_data = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tel.$custom_data[i] = typeof config.tasks[i] === \"function\" ? config.tasks[i](el, gantt.config) : config.tasks[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdelete config.tasks;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_exportConfig(data, config) {\r\n\t\t\tconst projectName = config.name || \"gantt.xml\";\r\n\t\t\tdelete config.name;\r\n\r\n\t\t\tgantt.config.custom = config;\r\n\r\n\t\t\tconst time = gantt.ext.export_api._getWorktimeSettings();\r\n\r\n\t\t\tconst projectDates = gantt.getSubtaskDates();\r\n\t\t\tif (projectDates.start_date && projectDates.end_date) {\r\n\t\t\t\tconst formatDate = gantt.templates.format_date || gantt.templates.xml_format;\r\n\t\t\t\tgantt.config.start_end = {\r\n\t\t\t\t\tstart_date: formatDate(projectDates.start_date),\r\n\t\t\t\t\tend_date: formatDate(projectDates.end_date)\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tconst manual = config.auto_scheduling === undefined ? false : !!config.auto_scheduling;\r\n\r\n\t\t\tconst res = {\r\n\t\t\t\tcallback: config.callback || null,\r\n\t\t\t\tconfig: gantt.config,\r\n\t\t\t\tdata,\r\n\t\t\t\tmanual,\r\n\t\t\t\tname: projectName,\r\n\t\t\t\tworktime: time\r\n\t\t\t};\r\n\t\t\tfor (const i in config) {\r\n\t\t\t\tres[i] = config[i];\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t},\r\n\r\n\r\n\t\t_sendImportAjaxMSP(config) {\r\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\r\n\t\t\tconst store = config.store || 0;\r\n\t\t\tconst formData = config.data;\r\n\t\t\tconst callback = config.callback;\r\n\r\n\t\t\tconst settings = {\r\n\t\t\t\tdurationUnit: config.durationUnit || undefined,\r\n\t\t\t\tprojectProperties: config.projectProperties || undefined,\r\n\t\t\t\ttaskProperties: config.taskProperties || undefined\r\n\t\t\t};\r\n\r\n\t\t\tformData.append(\"type\", config.type || \"msproject-parse\");\r\n\t\t\tformData.append(\"data\", JSON.stringify(settings));\r\n\r\n\t\t\tif (store){\r\n\t\t\t\tformData.append(\"store\", store);\r\n\t\t\t}\r\n\r\n\t\t\tconst xhr = new XMLHttpRequest();\r\n\t\t\txhr.onreadystatechange = function(e) {\r\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tcallback(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.onload = function(){\r\n\t\t\t\tconst fail = xhr.status > 400;\r\n\t\t\t\tlet info = null;\r\n\r\n\t\t\t\tif (!fail) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\r\n\t\t\t\t\t} catch (e) { }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (callback) {\r\n\t\t\t\t\tcallback(info);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n\t\t\txhr.send(formData);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n\tgantt.exportToPDF = gantt.ext.export_api.exportToPDF;\r\n\tgantt.exportToPNG = gantt.ext.export_api.exportToPNG;\r\n\tgantt.exportToICal = gantt.ext.export_api.exportToICal;\r\n\tgantt.exportToExcel = gantt.ext.export_api.exportToExcel;\r\n\tgantt.exportToJSON = gantt.ext.export_api.exportToJSON;\r\n\tgantt.importFromExcel = gantt.ext.export_api.importFromExcel;\r\n\tgantt.importFromMSProject = gantt.ext.export_api.importFromMSProject;\r\n\tgantt.exportToMSProject = gantt.ext.export_api.exportToMSProject;\r\n\tgantt.importFromPrimaveraP6 = gantt.ext.export_api.importFromPrimaveraP6;\r\n\tgantt.exportToPrimaveraP6 = gantt.ext.export_api.exportToPrimaveraP6;\r\n\r\n\r\n\treturn gantt.ext.export_api;\r\n}\r\n","export default {\r\n\tKEY_CODES: {\r\n\t\tUP: 38,\r\n\t\tDOWN: 40,\r\n\t\tLEFT: 37,\r\n\t\tRIGHT: 39,\r\n\t\tSPACE: 32,\r\n\t\tENTER: 13,\r\n\t\tDELETE: 46,\r\n\t\tESC: 27,\r\n\t\tTAB: 9\r\n\t}\r\n};","export default class ExtensionsManager{\r\n\tprivate _extensions:{[key:string]: GanttPlugin };\r\n\r\n\tconstructor(config: {[key:string]: GanttPlugin }){\r\n\t\tthis._extensions = {};\r\n\t\tfor(const i in config){\r\n\t\t\tthis._extensions[i] = config[i];\r\n\t\t}\r\n\t}\r\n\r\n\taddExtension = (name: string, ext: GanttPlugin) => {\r\n\t\tthis._extensions[name] = ext;\r\n\t};\r\n\r\n\tgetExtension = (name: string): GanttPlugin => {\r\n\t\treturn this._extensions[name];\r\n\t};\r\n}","import global from \"./global\";\r\n\r\n/* eslint-disable no-restricted-globals */\r\nvar isWindowAwailable = typeof window !== \"undefined\";\r\n\r\n/* eslint-enable no-restricted-globals */\r\n\r\nexport default {\r\n\tisIE: isWindowAwailable && (navigator.userAgent.indexOf(\"MSIE\") >= 0 || navigator.userAgent.indexOf(\"Trident\") >= 0),\r\n\tisOpera: isWindowAwailable && (navigator.userAgent.indexOf(\"Opera\") >= 0 || navigator.userAgent.indexOf(\"OPR\") >= 0),\r\n\tisChrome: isWindowAwailable && (navigator.userAgent.indexOf(\"Chrome\") >= 0),\r\n\tisSafari: isWindowAwailable && (navigator.userAgent.indexOf(\"Safari\") >= 0 || navigator.userAgent.indexOf(\"Konqueror\") >= 0),\r\n\tisFF: isWindowAwailable && (navigator.userAgent.indexOf(\"Firefox\") >= 0),\r\n\tisIPad: isWindowAwailable && (navigator.userAgent.search(/iPad/gi) >= 0),\r\n\tisEdge: isWindowAwailable && (navigator.userAgent.indexOf(\"Edge\")!=-1),\r\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\" || (typeof PRODUCTION !== \"undefined\" && PRODUCTION === \"test\")),\r\n\tisSalesforce: isWindowAwailable && (!!global[\"Sfdc\"] || !!global[\"$A\"] || global[\"Aura\"])\r\n};\r\n","export default function serialize(data: object | string) {\r\n\tif (typeof data === \"string\" || typeof data === \"number\") {\r\n\t\treturn data;\r\n\t}\r\n\r\n\tlet result = \"\";\r\n\r\n\tfor (const key in data) {\r\n\t\tlet serialized = \"\";\r\n\t\tif (data.hasOwnProperty(key)) {\r\n\t\t\tif (typeof data[key] === \"string\") {\r\n\t\t\t\tserialized = encodeURIComponent(data[key]);\r\n\t\t\t} else if (typeof data[key] === \"number\") {\r\n\t\t\t\tserialized = String(data[key]);\r\n\t\t\t} else {\r\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\r\n\t\t\t}\r\n\t\t\tserialized = key + \"=\" + serialized;\r\n\r\n\t\t\tif (result.length) {\r\n\t\t\t\tserialized = \"&\" + serialized;\r\n\t\t\t}\r\n\t\t\tresult += serialized;\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n","import env from \"../../utils/env\";\r\nimport global from \"../../utils/global\";\r\nimport serialize from \"./serialize\";\r\n\r\nfunction createConfig(method, args) {\r\n\tvar result = {\r\n\t\tmethod: method\r\n\t};\r\n\r\n\tif (args.length === 0) {\r\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\r\n\t}\r\n\tif (args.length === 1) {\r\n\t\tif (typeof args[0] === \"string\") {\r\n\t\t\tresult.url = args[0];\r\n\t\t\tresult.async = true;\r\n\t\t} else {\r\n\t\t\tresult.url = args[0].url;\r\n\t\t\tresult.async = (args[0].async || true);\r\n\t\t\tresult.callback = args[0].callback;\r\n\t\t\tresult.headers = args[0].headers;\r\n\t\t}\r\n\t\tif (method === \"POST\" || \"PUT\") {\r\n\t\t\tif (args[0].data) {\r\n\t\t\t\tif (typeof args[0].data !== \"string\") {\r\n\t\t\t\t\tresult.data = serialize(args[0].data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.data = args[0].data;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresult.data = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tresult.url = args[0];\r\n\tswitch(method) {\r\n\t\tcase \"GET\":\r\n\t\tcase \"DELETE\":\r\n\t\t\tresult.callback = args[1];\r\n\t\t\tresult.headers = args[2];\r\n\t\tbreak;\r\n\t\tcase \"POST\":\r\n\t\tcase \"PUT\":\r\n\t\t\tif (args[1]) {\r\n\t\t\t\tif (typeof args[1] !== \"string\") {\r\n\t\t\t\t\tresult.data = serialize(args[1]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.data = args[1];\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresult.data = \"\";\r\n\t\t\t}\r\n\t\t\tresult.callback = args[2];\r\n\t\t\tresult.headers = args[3];\r\n\t\tbreak;\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport default function(gantt) {\r\n\treturn {\r\n\r\n\t\t// if false - dhxr param will added to prevent caching on client side (default),\r\n\t\t// if true - do not add extra params\r\n\t\tcache: true,\r\n\r\n\t\t// default method for load/loadStruct, post/get allowed\r\n\t\t// get - since 4.1.1, this should fix 412 error for macos safari\r\n\t\tmethod: \"get\",\r\n\r\n\t\tparse: function(data) {\r\n\t\t\tif (typeof data !== \"string\") return data;\r\n\r\n\t\t\tvar obj;\r\n\t\t\tdata = data.replace(/^[\\s]+/,\"\");\r\n\t\t\tif (typeof DOMParser !== \"undefined\" && !env.isIE) { // ff,ie9\r\n\t\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\r\n\t\t\t} else if (typeof global.ActiveXObject !== \"undefined\") {\r\n\t\t\t\tobj = new global.ActiveXObject(\"Microsoft.XMLDOM\");\r\n\t\t\t\tobj.async = \"false\";\r\n\t\t\t\tobj.loadXML(data);\r\n\t\t\t}\r\n\t\t\treturn obj;\r\n\t\t},\r\n\t\txmltop: function(tagname, xhr, obj) {\r\n\t\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\r\n\t\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\r\n\t\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\r\n\t\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (obj !== -1) gantt.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\r\n\t\t\treturn document.createElement(\"DIV\");\r\n\t\t},\r\n\t\txpath: function(xpathExp, docObj) {\r\n\t\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\r\n\t\t\tif (env.isIE) {\r\n\t\t\t\treturn docObj.selectNodes(xpathExp)||[];\r\n\t\t\t} else {\r\n\t\t\t\tvar rows = [];\r\n\t\t\t\tvar first;\r\n\t\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\r\n\r\n\t\t\t\twhile (true){\r\n\t\t\t\t\tfirst = col.iterateNext();\r\n\t\t\t\t\tif(first){\r\n\t\t\t\t\t\trows.push(first);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn rows;\r\n\t\t\t}\r\n\t\t},\r\n\t\tquery: function(config) {\r\n\t\t\treturn this._call(\r\n\t\t\t\t(config.method || \"GET\"),\r\n\t\t\t\tconfig.url,\r\n\t\t\t\tconfig.data || \"\",\r\n\t\t\t\t(config.async || true),\r\n\t\t\t\tconfig.callback,\r\n\t\t\t\tconfig.headers\r\n\t\t\t);\r\n\t\t},\r\n\t\tget: function(url, onLoad, headers) {\r\n\t\t\tvar config = createConfig(\"GET\", arguments);\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\tgetSync: function(url, headers) {\r\n\t\t\tvar config = createConfig(\"GET\", arguments);\r\n\t\t\tconfig.async = false;\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\tput: function(url, postData, onLoad, headers) {\r\n\t\t\tvar config = createConfig(\"PUT\", arguments);\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\tdel: function(url, onLoad, headers) {\r\n\t\t\t/**\r\n\t\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\r\n\t\t\t * A payload within a DELETE request message has no defined semantics;\r\n\t\t\t * sending a payload body on a DELETE request might cause some existing\r\n\t\t\t * implementations to reject the request.\r\n\t\t\t */\r\n\t\t\tvar config = createConfig(\"DELETE\", arguments);\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\tpost: function(url, postData, onLoad, headers) {\r\n\t\t\tif (arguments.length == 1) {\r\n\t\t\t\tpostData = \"\";\r\n\t\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\r\n\t\t\t\tonLoad = postData;\r\n\t\t\t\tpostData = \"\";\r\n\t\t\t}\r\n\t\t\tvar config = createConfig(\"POST\", arguments);\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\tpostSync: function(url, postData, headers) {\r\n\t\t\tpostData = (postData === null ? \"\" : String(postData));\r\n\r\n\t\t\tvar config = createConfig(\"POST\", arguments);\r\n\t\t\tconfig.async = false;\r\n\t\t\treturn this.query(config);\r\n\t\t},\r\n\t\t_call: function(method, url, postData, async, onLoad, headers) {\r\n\t\t\treturn new gantt.Promise(function(resolve, reject) {\r\n\t\t\t\tvar t = (typeof XMLHttpRequest !== undefined ? new XMLHttpRequest() : new global.ActiveXObject(\"Microsoft.XMLHTTP\"));\r\n\t\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\r\n\r\n\t\t\t\tif (!!async) {\r\n\t\t\t\t\tt.onreadystatechange = function() {\r\n\t\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\r\n\t\t\t\t\t\t\tconst errorStatus = t.status < 200 || t.status > 299;\r\n\t\t\t\t\t\t\tif (errorStatus || t.responseText === \"\")\r\n\t\t\t\t\t\t\t\tif (!gantt.callEvent(\"onAjaxError\", [t])) return;\r\n\r\n\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\r\n\t\t\t\t\t\t\t\t\tonLoad.apply(global, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\r\n\t\t\t\t\t\t\t\t\tonLoad = null;\r\n\t\t\t\t\t\t\t\t\tt = null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar noCache = !this || !this.cache;\r\n\t\t\t\tif (method == \"GET\" && noCache) {\r\n\t\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tt.open(method, url, async);\r\n\r\n\t\t\t\tif (headers){\r\n\t\t\t\t\tfor (var key in headers)\r\n\t\t\t\t\t\tt.setRequestHeader(key, headers[key]);\r\n\t\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\r\n\t\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\r\n\t\t\t\t} else if (method == \"GET\") {\r\n\t\t\t\t\tpostData = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\r\n\r\n\t\t\t\tt.send(postData);\r\n\r\n\t\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\r\n\t\t\t});\r\n\t\t},\r\n\t\turlSeparator: function(str){\r\n\t\t\tif (str.indexOf(\"?\") != -1)\r\n\t\t\t\treturn \"&\";\r\n\t\t\telse\r\n\t\t\t\treturn \"?\";\r\n\t\t}\r\n\t};\r\n};\r\n","const dateToStr = (format: string, utc: boolean, gantt) => {\r\n\tformat = format.replace(/%[a-zA-Z]/g, (a) => {\r\n\t\tswitch (a) {\r\n\t\t\tcase \"%d\":\r\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Date())+\"`;\r\n\t\t\tcase \"%m\":\r\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Month()+1))+\"`;\r\n\t\t\tcase \"%j\":\r\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Date()+\"`;\r\n\t\t\tcase \"%n\":\r\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Month()+1)+\"`;\r\n\t\t\tcase \"%y\":\r\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}FullYear()%100)+\"`;\r\n\t\t\tcase \"%Y\":\r\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}FullYear()+\"`;\r\n\t\t\tcase \"%D\":\r\n\t\t\t\treturn `\"+locale.date.day_short[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\r\n\t\t\tcase \"%l\":\r\n\t\t\t\treturn `\"+locale.date.day_full[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\r\n\t\t\tcase \"%M\":\r\n\t\t\t\treturn `\"+locale.date.month_short[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\r\n\t\t\tcase \"%F\":\r\n\t\t\t\treturn `\"+locale.date.month_full[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\r\n\t\t\tcase \"%h\":\r\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\r\n\t\t\tcase \"%g\":\r\n\t\t\t\treturn `\"+((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\r\n\t\t\tcase \"%G\":\r\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Hours()+\"`;\r\n\t\t\tcase \"%H\":\r\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Hours())+\"`;\r\n\t\t\tcase \"%i\":\r\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Minutes())+\"`;\r\n\t\t\tcase \"%a\":\r\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"pm\":\"am\")+\"`;\r\n\t\t\tcase \"%A\":\r\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"PM\":\"AM\")+\"`;\r\n\t\t\tcase \"%s\":\r\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Seconds())+\"`;\r\n\t\t\tcase \"%W\":\r\n\t\t\t\treturn `\"+to_fixed(getISOWeek(date))+\"`;\r\n\t\t\tcase \"%w\":\r\n\t\t\t\treturn `\"+to_fixed(getWeek(date))+\"`;\r\n\t\t\tdefault:\r\n\t\t\t\treturn a;\r\n\t\t}\r\n\t});\r\n\r\n\t// tslint:disable-next-line: function-constructor\r\n\tconst dateToStrFn = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${format}\";`);\r\n\r\n\treturn (date: Date) => {\r\n\t\treturn dateToStrFn(date, gantt.date.to_fixed, gantt.locale, gantt.date.getISOWeek, gantt.date.getWeek);\r\n\t};\r\n};\r\n\r\n\r\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\r\n\tlet splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\r\n\tconst mask = format.match(/%[a-zA-Z]/g);\r\n\tfor (let i = 0; i < mask.length; i++) {\r\n\t\tswitch (mask[i]) {\r\n\t\t\tcase \"%j\":\r\n\t\t\tcase \"%d\":\r\n\t\t\t\tsplt += `set[2]=temp[${i}]||1;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%n\":\r\n\t\t\tcase \"%m\":\r\n\t\t\t\tsplt += `set[1]=(temp[${i}]||1)-1;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%y\":\r\n\t\t\t\tsplt += `set[0]=temp[${i}]*1+(temp[${i}]>50?1900:2000);`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%g\":\r\n\t\t\tcase \"%G\":\r\n\t\t\tcase \"%h\":\r\n\t\t\tcase \"%H\":\r\n\t\t\t\tsplt += `set[3]=temp[${i}]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%i\":\r\n\t\t\t\tsplt += `set[4]=temp[${i}]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%Y\":\r\n\t\t\t\tsplt += `set[0]=temp[${i}]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%a\":\r\n\t\t\tcase \"%A\":\r\n\t\t\t\tsplt += `set[3]=set[3]%12+((temp[${i}]||'').toLowerCase()=='am'?0:12);`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%s\":\r\n\t\t\t\tsplt += `set[5]=temp[${i}]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%M\":\r\n\t\t\t\tsplt += `set[1]=locale.date.month_short_hash[temp[${i}]]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%F\":\r\n\t\t\t\tsplt += `set[1]=locale.date.month_full_hash[temp[${i}]]||0;`;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tlet code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\r\n\tif (utc) { code = ` Date.UTC(${code})`; }\r\n\t// tslint:disable-next-line: function-constructor\r\n\tconst strToDateFn = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${splt} return new Date(${code});`);\r\n\r\n\treturn (dateString) => {\r\n\t\treturn strToDateFn(dateString, gantt.locale);\r\n\t};\r\n};\r\n\r\nconst fastVersion = {\r\n\tdate_to_str: dateToStr,\r\n\tstr_to_date: strToDate\r\n};\r\n\r\nexport default fastVersion;","const dateToStr = (format: string, utc: boolean, gantt) => {\r\n\treturn (date) => {\r\n\t\treturn format.replace(/%[a-zA-Z]/g, (a) => {\r\n\t\t\tswitch (a) {\r\n\t\t\t\tcase \"%d\": return utc ? gantt.date.to_fixed(date.getUTCDate()) : gantt.date.to_fixed(date.getDate());\r\n\t\t\t\tcase \"%m\": return utc ? gantt.date.to_fixed((date.getUTCMonth() + 1)) : gantt.date.to_fixed((date.getMonth() + 1));\r\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\r\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\r\n\t\t\t\tcase \"%y\": return utc ? gantt.date.to_fixed(date.getUTCFullYear() % 100) : gantt.date.to_fixed(date.getFullYear() % 100);\r\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\r\n\t\t\t\tcase \"%D\": return utc ? gantt.locale.date.day_short[date.getUTCDay()] : gantt.locale.date.day_short[date.getDay()];\r\n\t\t\t\tcase \"%l\": return utc ? gantt.locale.date.day_full[date.getUTCDay()] : gantt.locale.date.day_full[date.getDay()];\r\n\t\t\t\tcase \"%M\": return utc ? gantt.locale.date.month_short[date.getUTCMonth()] : gantt.locale.date.month_short[date.getMonth()];\r\n\t\t\t\tcase \"%F\": return utc ? gantt.locale.date.month_full[date.getUTCMonth()] : gantt.locale.date.month_full[date.getMonth()];\r\n\t\t\t\tcase \"%h\": return utc ? gantt.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : gantt.date.to_fixed((date.getHours() + 11) % 12 + 1);\r\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\r\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\r\n\t\t\t\tcase \"%H\": return utc ? gantt.date.to_fixed(date.getUTCHours()) : gantt.date.to_fixed(date.getHours());\r\n\t\t\t\tcase \"%i\": return utc ? gantt.date.to_fixed(date.getUTCMinutes()) : gantt.date.to_fixed(date.getMinutes());\r\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\r\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\r\n\t\t\t\tcase \"%s\": return utc ? gantt.date.to_fixed(date.getUTCSeconds()) : gantt.date.to_fixed(date.getSeconds());\r\n\t\t\t\tcase \"%W\": return utc ? gantt.date.to_fixed(gantt.date.getUTCISOWeek(date)) : gantt.date.to_fixed(gantt.date.getISOWeek(date));\r\n\t\t\t\tdefault: return a;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n};\r\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\r\n\treturn (date: string) => {\r\n\t\tconst set: Array<string|number> = [0, 0, 1, 0, 0, 0];\r\n\t\tconst temp = date.match(/[a-zA-Z]+|[0-9]+/g);\r\n\t\tconst mask = format.match(/%[a-zA-Z]/g);\r\n\r\n\t\tfor (let i = 0; i < mask.length; i++) {\r\n\t\t\tswitch (mask[i]) {\r\n\t\t\t\tcase \"%j\":\r\n\t\t\t\tcase \"%d\":\r\n\t\t\t\t\tset[2] = temp[i] as unknown as number || 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%n\":\r\n\t\t\t\tcase \"%m\":\r\n\t\t\t\t\tset[1] = (temp[i] as unknown as number || 1) - 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%y\":\r\n\t\t\t\t\tset[0] = temp[i] as unknown as number * 1 + ((temp[i] as unknown as number) > 50 ? 1900 : 2000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%g\":\r\n\t\t\t\tcase \"%G\":\r\n\t\t\t\tcase \"%h\":\r\n\t\t\t\tcase \"%H\":\r\n\t\t\t\t\tset[3] = temp[i] as unknown as number || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%i\":\r\n\t\t\t\t\tset[4] = temp[i] as unknown as number || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%Y\":\r\n\t\t\t\t\tset[0] = temp[i] as unknown as number || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%a\":\r\n\t\t\t\tcase \"%A\":\r\n\t\t\t\t\tset[3] = set[3] as number % 12 + ((temp[i] || \"\").toLowerCase() === \"am\" ? 0 : 12);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%s\":\r\n\t\t\t\t\tset[5] = temp[i] || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%M\":\r\n\t\t\t\t\tset[1] = gantt.locale.date.month_short_hash[temp[i]] || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%F\":\r\n\t\t\t\t\tset[1] = gantt.locale.date.month_full_hash[temp[i]] || 0;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (utc) {\r\n\t\t\treturn new Date(Date.UTC(\r\n\t\t\t\tset[0] as number,\r\n\t\t\t\tset[1] as number,\r\n\t\t\t\tset[2] as number,\r\n\t\t\t\tset[3] as number,\r\n\t\t\t\tset[4] as number,\r\n\t\t\t\tset[5] as number\r\n\t\t\t));\r\n\t\t}\r\n\t\treturn new Date(\r\n\t\t\tset[0] as number,\r\n\t\t\tset[1] as number,\r\n\t\t\tset[2] as number,\r\n\t\t\tset[3] as number,\r\n\t\t\tset[4] as number,\r\n\t\t\tset[5] as number\r\n\t\t);\r\n\t};\r\n\r\n};\r\n\r\n\r\nconst cspVersion = {\r\n\tdate_to_str: dateToStr,\r\n\tstr_to_date: strToDate\r\n};\r\n\r\nexport default cspVersion;","/*\r\n %d - the day as a number with a leading zero ( 01 to 31 );\r\n %j - the day as a number without a leading zero ( 1 to 31 );\r\n %D - the day as an abbreviation ( Sun to Sat );\r\n %l - the day as a full name ( Sunday to Saturday );\r\n %W - the ISO-8601 week number of the year. Weeks start on Monday; 1)\r\n %m - the month as a number without a leading zero ( 1 to 12 );\r\n %n - the month as a number with a leading zero ( 01 to 12);\r\n %M - the month as an abbreviation ( Jan to Dec );\r\n %F - the month as a full name ( January to December );\r\n %y - the year as a two-digit number ( 00 to 99 );\r\n %Y - the year as a four-digit number ( 19009999 );\r\n %h - the hour based on the 12-hour clock ( 00 to 11 );\r\n %H - the hour based on the 24-hour clock ( 00 to 23 );\r\n %i - the minute as a number with a leading zero ( 00 to 59 );\r\n %s - the second as a number without a leading zero ( 00 to 59 ); 2)\r\n %a - displays am (for times from midnight until noon) and pm (for times from noon until midnight);\r\n %A - displays AM (for times from midnight until noon) and PM (for times from noon until midnight).\r\n*/\r\n\r\nimport fastVersion from \"./date_parsers/fast_version\";\r\nimport cspCompliantVersion from \"./date_parsers/csp_compliant_version\";\r\n\r\nexport default function(gantt) {\r\n\tvar canUseCsp = null;\r\n\tfunction cspAutoCheck() {\r\n\t\ttry {\r\n\t\t\tnew Function(\"canUseCsp = false;\");\r\n\t\t} catch(e) {\r\n\t\t\tcanUseCsp = true;\r\n\t\t}\r\n\t}\r\n\tfunction useCsp() {\r\n\t\tvar result = false;\r\n\t\tif (gantt.config.csp === \"auto\") {\r\n\t\t\tif(canUseCsp === null) {\r\n\t\t\t\tcspAutoCheck();\r\n\t\t\t}\r\n\t\t\tresult = canUseCsp;\r\n\t\t} else {\r\n\t\t\tresult = gantt.config.csp;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tvar dateHelper = {\r\n\t\tinit: function () {\r\n\t\t\tvar locale = gantt.locale;\r\n\r\n\t\t\tvar s = locale.date.month_short;\r\n\t\t\tvar t = locale.date.month_short_hash = {};\r\n\t\t\tfor (var i = 0; i < s.length; i++)\r\n\t\t\t\tt[s[i]] = i;\r\n\r\n\t\t\tvar s = locale.date.month_full;\r\n\t\t\tvar t = locale.date.month_full_hash = {};\r\n\t\t\tfor (var i = 0; i < s.length; i++)\r\n\t\t\t\tt[s[i]] = i;\r\n\t\t},\r\n\t\tdate_part: function (date) {\r\n\t\t\tvar old = new Date(date);\r\n\t\t\tdate.setHours(0);\r\n\t\t\tthis.hour_start(date);\r\n\t\t\tif (date.getHours() && //shift to yesterday on dst\r\n\t\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()))\r\n\t\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\ttime_part: function (date) {\r\n\t\t\treturn (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\r\n\t\t},\r\n\t\tweek_start: function (date) {\r\n\t\t\tvar shift = date.getDay();\r\n\t\t\tif (gantt.config.start_on_monday) {\r\n\t\t\t\tif (shift === 0) shift = 6;\r\n\t\t\t\telse shift--;\r\n\t\t\t}\r\n\t\t\treturn this.date_part(this.add(date, -1 * shift, \"day\"));\r\n\t\t},\r\n\t\tmonth_start: function (date) {\r\n\t\t\tdate.setDate(1);\r\n\t\t\treturn this.date_part(date);\r\n\t\t},\r\n\t\tquarter_start: function (date) {\r\n\t\t\tthis.month_start(date);\r\n\t\t\tvar m = date.getMonth(),\r\n\t\t\t\tres_month;\r\n\r\n\t\t\tif (m >= 9) {\r\n\t\t\t\tres_month = 9;\r\n\t\t\t} else if (m >= 6) {\r\n\t\t\t\tres_month = 6;\r\n\t\t\t} else if (m >= 3) {\r\n\t\t\t\tres_month = 3;\r\n\t\t\t} else {\r\n\t\t\t\tres_month = 0;\r\n\t\t\t}\r\n\r\n\t\t\tdate.setMonth(res_month);\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\tyear_start: function (date) {\r\n\t\t\tdate.setMonth(0);\r\n\t\t\treturn this.month_start(date);\r\n\t\t},\r\n\t\tday_start: function (date) {\r\n\t\t\treturn this.date_part(date);\r\n\t\t},\r\n\t\thour_start: function (date) {\r\n\t\t\tif (date.getMinutes())\r\n\t\t\t\tdate.setMinutes(0);\r\n\t\t\tthis.minute_start(date);\r\n\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\tminute_start: function (date) {\r\n\t\t\tif (date.getSeconds())\r\n\t\t\t\tdate.setSeconds(0);\r\n\t\t\tif (date.getMilliseconds())\r\n\t\t\t\tdate.setMilliseconds(0);\r\n\t\t\treturn date;\r\n\t\t},\r\n\t\t_add_days: function (modifiedDate, inc, originalDate) {\r\n\r\n\t\t\tmodifiedDate.setDate(modifiedDate.getDate() + inc);\r\n\t\t\tvar incCondition = inc >= 0;\r\n\t\t\tvar getHoursCondition = !originalDate.getHours() && modifiedDate.getHours(); //shift to yesterday on dst\r\n\t\t\tvar getDateCondition = (modifiedDate.getDate() <= originalDate.getDate() || modifiedDate.getMonth() < originalDate.getMonth() || modifiedDate.getFullYear() < originalDate.getFullYear());\r\n\t\t\tif (incCondition && getHoursCondition && getDateCondition){\r\n\t\t\t\tmodifiedDate.setTime(modifiedDate.getTime() + 60 * 60 * 1000 * (24 - modifiedDate.getHours()));\r\n\t\t\t}\r\n\t\t\tvar worktimeCalculation = inc > 1;\r\n\t\t\tif (worktimeCalculation && getHoursCondition){\r\n\t\t\t\t// try to shift the modified Date to 00:00\r\n\t\t\t\tmodifiedDate.setHours(0);\r\n\t\t\t}\r\n\t\t\treturn modifiedDate;\r\n\t\t},\r\n\r\n\t\tadd: function (date, inc, mode) {\r\n\t\t\t/*jsl:ignore*/\r\n\t\t\tvar ndate = new Date(date.valueOf());\r\n\t\t\tswitch (mode) {\r\n\t\t\t\tcase \"day\":\r\n\t\t\t\t\tndate = this._add_days(ndate, inc, date);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"week\":\r\n\t\t\t\t\tndate = this._add_days(ndate, inc * 7, date);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"month\":\r\n\t\t\t\t\tndate.setMonth(ndate.getMonth() + inc);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"year\":\r\n\t\t\t\t\tndate.setYear(ndate.getFullYear() + inc);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"hour\":\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t\tadding hours/minutes via setHour(getHour() + inc) gives weird result when\r\n\t\t\t\t\t\tadding one hour to the time before switch to a Daylight Saving time\r\n\r\n\t\t\t\t\t\texample: //Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\r\n\t\t\t\t\t\tnew Date(2014, 02, 30, 1).setHours(2)\r\n\t\t\t\t\t\t>>Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\r\n\r\n\t\t\t\t\t\tsetTime seems working as expected\r\n\t\t\t\t\t */\r\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"minute\":\r\n\r\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\treturn this[\"add_\" + mode](date, inc, mode);\r\n\t\t\t}\r\n\t\t\treturn ndate;\r\n\t\t\t/*jsl:end*/\r\n\t\t},\r\n\t\tadd_quarter: function (date, inc) {\r\n\t\t\treturn this.add(date, inc * 3, \"month\");\r\n\t\t},\r\n\r\n\t\tto_fixed: function (num) {\r\n\t\t\tif (num < 10) return \"0\" + num;\r\n\t\t\treturn num;\r\n\t\t},\r\n\t\tcopy: function (date) {\r\n\t\t\treturn new Date(date.valueOf());\r\n\t\t},\r\n\t\tdate_to_str: function (format, utc) {\r\n\t\t\tvar result = fastVersion;\r\n\t\t\tif (useCsp()) {\r\n\t\t\t\tresult = cspCompliantVersion;\r\n\t\t\t}\r\n\t\t\treturn result.date_to_str(format, utc, gantt);\r\n\t\t},\r\n\t\tstr_to_date: function (format, utc) {\r\n\t\t\tvar result = fastVersion;\r\n\t\t\tif (useCsp()) {\r\n\t\t\t\tresult = cspCompliantVersion;\r\n\t\t\t}\r\n\t\t\treturn result.str_to_date(format, utc, gantt);\r\n\t\t},\r\n\t\tgetISOWeek: function (ndate) {\r\n\t\t\treturn gantt.date._getWeekNumber(ndate, true);\r\n\t\t},\r\n\t\t_getWeekNumber: function(ndate, isoWeek){\r\n\t\t\tif (!ndate) return false;\r\n\t\t\tvar nday = ndate.getDay();\r\n\t\t\tif(isoWeek){\r\n\t\t\t\tif (nday === 0) {\r\n\t\t\t\t\tnday = 7;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar first_thursday = new Date(ndate.valueOf());\r\n\t\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\r\n\t\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\r\n\t\t\tvar ordinal_date = Math.round((first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\r\n\t\t\tvar week_number = 1 + Math.floor(ordinal_date / 7);\r\n\t\t\treturn week_number;\r\n\t\t},\r\n\r\n\t\tgetWeek: function(ndate){\r\n\t\t\treturn gantt.date._getWeekNumber(ndate, gantt.config.start_on_monday);\r\n\t\t},\r\n\t\tgetUTCISOWeek: function (ndate) {\r\n\t\t\treturn gantt.date.getISOWeek(ndate);\r\n\t\t},\r\n\t\tconvert_to_utc: function (date) {\r\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\r\n\t\t},\r\n\t\tparseDate: function (date, format) {\r\n\t\t\t// raw date may be of type string, number (timestamp) or something else\r\n\t\t\t// do not check for instanceof Date explicitly, since we may swap native date with different date implementation at some point\r\n\t\t\tif (date && !date.getFullYear) {\r\n\t\t\t\tif (typeof(format) !== \"function\") {\r\n\t\t\t\t\tif (typeof(format) === \"string\") {\r\n\t\t\t\t\t\tif (format === \"parse_date\" || format === \"xml_date\") {\r\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates[format]) ? gantt.templates[format] : gantt.date.str_to_date(format);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (date) {\r\n\t\t\t\t\tdate = format(date);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdate = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn date;\r\n\t\t}\r\n\t};\r\n\treturn dateHelper;\r\n};","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import * as remote_client from \"remote-client\";\r\nexport const remoteEvents = function(url, token) {\r\n    const remote = new remote_client.Client({\r\n      url,\r\n      token\r\n    });\r\n\r\n    // temporary patch, as we do not want credentials\r\n    remote.fetch = function (url, body) {\r\n      const req = {\r\n        headers: this.headers()\r\n      };\r\n      if (body) {\r\n        req.method = \"POST\";\r\n        req.body = body;\r\n      }\r\n\r\n      return fetch(url, req).then((res) => res.json());\r\n    };\r\n\r\n    this._ready = remote.load().then((back) => (this._remote = back));\r\n\r\n    function ready() {\r\n      return this._ready;\r\n    }\r\n  \r\n    function on(name, handler) {\r\n      this.ready().then((back) => {\r\n        if (typeof name === \"string\") back.on(name, handler);\r\n        else {\r\n          for (const key in name) {\r\n            back.on(key, name[key]);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    this.ready = ready;\r\n    this.on = on;\r\n  };\r\n\r\n","function checkTimeout(host, updPerSecond){\r\n\tif (!updPerSecond)\r\n\t\treturn true;\r\n\t\r\n\tif (host._on_timeout)\r\n\t\treturn false;\r\n\t\r\n\tvar timeout = Math.ceil(1000/updPerSecond);\r\n\tif (timeout < 2) return true;\r\n\r\n\tsetTimeout(function(){\r\n\t\tdelete host._on_timeout;\r\n\t}, timeout);\r\n\r\n\thost._on_timeout = true;\r\n\treturn true;\r\n}\r\n\r\nexport default checkTimeout;","import * as utils from \"../../utils/utils\";\r\n\r\nvar StateService = (function(){\r\n\tvar stateProviders = {};\r\n\r\n\tfunction getState(name){\r\n\t\tvar provider = stateProviders[name];\r\n\t\tif(provider){\r\n\t\t\treturn stateProviders[name].method();\r\n\t\t}else{\r\n\t\t\tvar res = {};\r\n\t\t\tfor(var i in stateProviders){\r\n\t\t\t\tif(!stateProviders[i].internal)\r\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction registerProvider(name, provider, internal){\r\n\t\tstateProviders[name] = { method: provider, internal: internal};\r\n\t}\r\n\r\n\tfunction unregisterProvider(name){\r\n\t\tdelete stateProviders[name];\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetState: getState,\r\n\t\tregisterProvider: registerProvider,\r\n\t\tunregisterProvider: unregisterProvider\r\n\t};\r\n});\r\n\r\nexport default StateService;\r\n\r\n","export default Promise;","import * as utils from \"../../utils/utils\";\r\nimport {replaceValidZeroId} from \"../../utils/helpers\";\r\n\r\nvar createTasksDatastoreFacade = function(){\r\n\treturn {\r\n\tgetTask: function (id) {\r\n\t\tid = replaceValidZeroId(id, this.config.root_id);\r\n\t\tthis.assert(id, \"Invalid argument for gantt.getTask\");\r\n\t\tvar task = this.$data.tasksStore.getItem(id);\r\n\t\tthis.assert(task, \"Task not found id=\" + id);\r\n\t\treturn task;\r\n\t},\r\n\tgetTaskByTime: function (from, to) {\r\n\t\tvar p = this.$data.tasksStore.getItems();\r\n\r\n\t\tvar res = [];\r\n\r\n\t\tif (!(from || to)) {\r\n\t\t\tres = p;\r\n\t\t} else {\r\n\t\t\tfrom = +from || -Infinity;\r\n\t\t\tto = +to || Infinity;\r\n\t\t\tfor (var t = 0; t < p.length; t++){\r\n\t\t\t\tvar task = p[t];\r\n\t\t\t\tif (+task.start_date < to && +task.end_date > from)\r\n\t\t\t\t\tres.push(task);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tisTaskExists: function (id) {\r\n\t\tif(!this.$data || !this.$data.tasksStore){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this.$data.tasksStore.exists(id);\r\n\t},\r\n\tupdateTask: function (id, item) {\r\n\t\tif (!utils.defined(item)) item = this.getTask(id);\r\n\t\tthis.$data.tasksStore.updateItem(id, item);\r\n\t\tif(this.isTaskExists(id))\r\n\t\t\tthis.refreshTask(id);\r\n\t},\r\n\taddTask: function (item, parent, index) {\r\n\t\tif (!utils.defined(item.id))\r\n\t\t\titem.id = utils.uid();\r\n\r\n\t\t//GS-761: assert unique ID\r\n\t\tif (this.isTaskExists(item.id)){\r\n\t\t\tvar task = this.getTask(item.id);\r\n\t\t\tif (task.$index != item.$index) {\r\n\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\r\n\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\r\n\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\r\n\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\r\n\t\t\t\t}\r\n\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\r\n\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.$data.tasksStore.updateItem(item.id, item);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (!utils.defined(parent)) parent = this.getParent(item) || 0;\r\n\t\tif (!this.isTaskExists(parent)) parent = this.config.root_id;\r\n\t\tthis.setParent(item, parent);\r\n\r\n\t\t// GS-1583. Save the $open state to the Undo Stack\r\n\t\tif (this.getState().lightbox && this.isTaskExists(parent)) {\r\n\t\t\tvar parentObj = this.getTask(parent);\r\n\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\r\n\t\t}\r\n\t\treturn this.$data.tasksStore.addItem(item, index, parent);\r\n\t},\r\n\tdeleteTask: function (id) {\r\n\t\tid = replaceValidZeroId(id, this.config.root_id);\r\n\t\treturn this.$data.tasksStore.removeItem(id);\r\n\t},\r\n\tgetTaskCount: function () {\r\n\t\treturn this.$data.tasksStore.count();\r\n\t},\r\n\tgetVisibleTaskCount: function () {\r\n\t\treturn this.$data.tasksStore.countVisible();\r\n\t},\r\n\tgetTaskIndex: function (id) {\r\n\t\treturn this.$data.tasksStore.getBranchIndex(id);\r\n\t},\r\n\tgetGlobalTaskIndex: function (id) {\r\n\t\tid = replaceValidZeroId(id, this.config.root_id);\r\n\t\tthis.assert(id, \"Invalid argument\");\r\n\t\treturn this.$data.tasksStore.getIndexById(id);\r\n\t},\r\n\teachTask: function (code, parent, master) {\r\n\t\treturn this.$data.tasksStore.eachItem(utils.bind(code, master||this), parent);\r\n\t},\r\n\teachParent: function (callback, startTask, master) {\r\n\t\treturn this.$data.tasksStore.eachParent(utils.bind(callback, master || this), startTask);\r\n\t},\r\n\tchangeTaskId: function (oldid, newid) {\r\n\t\tthis.$data.tasksStore.changeId(oldid, newid);\r\n\t\tvar task = this.$data.tasksStore.getItem(newid);\r\n\r\n\t\tvar links = [];\r\n\r\n\t\tif (task.$source) {\r\n\t\t\tlinks = links.concat(task.$source);\r\n\t\t}\r\n\t\tif (task.$target) {\r\n\t\t\tlinks = links.concat(task.$target);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < links.length; i++) {\r\n\t\t\tvar link = this.getLink(links[i]);\r\n\t\t\tif (link.source == oldid) {\r\n\t\t\t\tlink.source = newid;\r\n\t\t\t}\r\n\t\t\tif (link.target == oldid) {\r\n\t\t\t\tlink.target = newid;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcalculateTaskLevel: function (item) {\r\n\t\treturn this.$data.tasksStore.calculateItemLevel(item);\r\n\t},\r\n\tgetNext: function (id) {\r\n\t\treturn this.$data.tasksStore.getNext(id);\r\n\t},\r\n\tgetPrev: function (id) {\r\n\t\treturn this.$data.tasksStore.getPrev(id);\r\n\t},\r\n\tgetParent: function (id) {\r\n\t\treturn this.$data.tasksStore.getParent(id);\r\n\t},\r\n\tsetParent: function (task, new_pid, silent) {\r\n\t\treturn this.$data.tasksStore.setParent(task, new_pid, silent);\r\n\t},\r\n\tgetSiblings: function (id) {\r\n\t\treturn this.$data.tasksStore.getSiblings(id).slice();\r\n\t},\r\n\tgetNextSibling: function (id) {\r\n\t\treturn this.$data.tasksStore.getNextSibling(id);\r\n\t},\r\n\tgetPrevSibling: function (id) {\r\n\t\treturn this.$data.tasksStore.getPrevSibling(id);\r\n\t},\r\n\tgetTaskByIndex: function(index){\r\n\t\tvar id = this.$data.tasksStore.getIdByIndex(index);\r\n\t\tif(this.isTaskExists(id)){\r\n\t\t\treturn this.getTask(id);\r\n\t\t}else{\r\n\t\t\treturn null;\r\n\t\t}\r\n\t},\r\n\tgetChildren: function (id) {\r\n\t\tif(!this.hasChild(id)){\r\n\t\t\treturn [];\r\n\t\t}else{\r\n\t\t\treturn this.$data.tasksStore.getChildren(id).slice();\r\n\t\t}\r\n\t},\r\n\thasChild: function (id) {\r\n\t\treturn this.$data.tasksStore.hasChild(id);\r\n\t},\r\n\topen: function (id) {\r\n\t\tthis.$data.tasksStore.open(id);\r\n\t},\r\n\tclose: function (id) {\r\n\t\tthis.$data.tasksStore.close(id);\r\n\t},\r\n\tmoveTask: function (sid, tindex, parent) {\r\n\t\tparent = replaceValidZeroId(parent, this.config.root_id);\r\n\t\treturn this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\r\n\t},\r\n\tsort: function(field, desc, parent, silent) {\r\n\t\tvar render = !silent;//4th argument to cancel redraw after sorting\r\n\r\n\t\tthis.$data.tasksStore.sort(field, desc, parent);\r\n\t\tthis.callEvent(\"onAfterSort\", [field, desc, parent]);\r\n\r\n\t\tif (render) {\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t}\r\n};\r\n};\r\n\r\nexport default createTasksDatastoreFacade;\r\n\r\n\r\n","import * as utils from \"../../utils/utils\";\r\n\r\nvar $powerArray  = {\r\n\t$create: function(array){\r\n\t\treturn utils.mixin(array || [], this);\r\n\t},\r\n\t//remove element at specified position\r\n\t$removeAt:function(pos,len){\r\n\t\tif (pos>=0) this.splice(pos,(len||1));\r\n\t},\r\n\t//find element in collection and remove it\r\n\t$remove:function(value){\r\n\t\tthis.$removeAt(this.$find(value));\r\n\t},\r\n\t//add element to collection at specific position\r\n\t$insertAt:function(data,pos){\r\n\t\tif (!pos && pos!==0) \t//add to the end by default\r\n\t\t\tthis.push(data);\r\n\t\telse {\r\n\t\t\tvar b = this.splice(pos,(this.length-pos));\r\n\t\t\tthis[pos] = data;\r\n\t\t\tthis.push.apply(this,b); //reconstruct array without loosing this pointer\r\n\t\t}\r\n\t},\r\n\t//return index of element, -1 if it doesn't exists\r\n\t$find:function(data){\r\n\t\tfor (var i=0; i<this.length; i++)\r\n\t\t\tif (data==this[i]) return i;\r\n\t\treturn -1;\r\n\t},\r\n\t//execute some method for each element of array\r\n\t$each:function(functor,master){\r\n\t\tfor (var i=0; i < this.length; i++)\r\n\t\t\tfunctor.call((master||this),this[i]);\r\n\t},\r\n\t//create new array from source, by using results of functor\r\n\t$map:function(functor,master){\r\n\t\tfor (var i=0; i < this.length; i++)\r\n\t\t\tthis[i]=functor.call((master||this),this[i]);\r\n\t\treturn this;\r\n\t},\r\n\t$filter:function(functor, master){\r\n\t\tfor (var i=0; i < this.length; i++)\r\n\t\t\tif (!functor.call((master||this),this[i])){\r\n\t\t\t\tthis.splice(i,1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\treturn this;\r\n\t}\r\n};\r\n\r\nexport default $powerArray;","/**\r\n * Check the over task or draggble task is placeholder task\r\n */\r\n\r\nexport default function isPlaceholderTask(id, gantt, store, config) {\r\n\t// return false;\r\n\tvar config = gantt ? gantt.config : config;\r\n\tif (config && config.placeholder_task) {\r\n\t\tif (store.exists(id)){\r\n\t\t\tvar item = store.getItem(id);\r\n\t\t\treturn item.type === config.types.placeholder;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n};","import powerArray from \"./power_array\";\r\nimport * as utils from \"../../utils/utils\";\r\nimport eventable from \"../../utils/eventable\";\r\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\r\n\r\nvar DataStore = function(config){\r\n\tthis.pull = {};\r\n\tthis.$initItem = config.initItem;\r\n\tthis.visibleOrder = powerArray.$create();\r\n\tthis.fullOrder = powerArray.$create();\r\n\tthis._skip_refresh = false;\r\n\tthis._filterRule = null;\r\n\tthis._searchVisibleOrder = {};\r\n\tthis._indexRangeCache = {};\r\n\tthis._getItemsCache = null;\r\n\tthis.$config = config;\r\n\teventable(this);\r\n\r\n\tthis._attachDataChange(function(){\r\n\t\tthis._indexRangeCache = {};\r\n\t\tthis._getItemsCache = null;\r\n\t\treturn true;\r\n\t});\r\n\treturn this;\r\n};\r\nDataStore.prototype = {\r\n\r\n\t_attachDataChange: function(callback){\r\n\t\tthis.attachEvent(\"onClearAll\", callback);\r\n\t\tthis.attachEvent(\"onBeforeParse\", callback);\r\n\t\tthis.attachEvent(\"onBeforeUpdate\", callback);\r\n\t\tthis.attachEvent(\"onBeforeDelete\", callback);\r\n\t\tthis.attachEvent(\"onBeforeAdd\", callback);\r\n\t\tthis.attachEvent(\"onParse\", callback);\r\n\t\tthis.attachEvent(\"onBeforeFilter\", callback);\r\n\t},\r\n\t_parseInner: function(data){\r\n\t\tvar item = null,\r\n\t\t\tloaded = [];\r\n\t\tfor(var i = 0, len = data.length; i< len; i++){\r\n\t\t\titem = data[i];\r\n\t\t\tif(this.$initItem){\r\n\t\t\t\tif(this.$config.copyOnParse()){\r\n\t\t\t\t\titem = utils.copy(item);\r\n\t\t\t\t}\r\n\t\t\t\titem = this.$initItem(item);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(this.callEvent(\"onItemLoading\", [item])){\r\n\t\t\t\tif (!this.pull.hasOwnProperty(item.id)) {\r\n\t\t\t\t\tthis.fullOrder.push(item.id);\r\n\t\t\t\t}\r\n\t\t\t\tloaded.push(item);\r\n\t\t\t\tthis.pull[item.id] = item;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn loaded;\r\n\t},\r\n\tparse: function(data){\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\r\n\t\t}\r\n\t\tvar loaded = this._parseInner(data);\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.refresh();\r\n\t\t\tthis.callEvent(\"onParse\", [loaded]);\r\n\t\t}\r\n\t},\r\n\tgetItem: function(id){\r\n\t\treturn this.pull[id];\r\n\t},\r\n\r\n\t_updateOrder: function(code){\r\n\t\tcode.call(this.visibleOrder);\r\n\t\tcode.call(this.fullOrder);\r\n\t},\r\n\tupdateItem: function(id, item){\r\n\t\tif (!utils.defined(item)) item = this.getItem(id);\r\n\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tif (this.callEvent(\"onBeforeUpdate\", [item.id, item]) === false) return false;\r\n\t\t}\r\n\t\t// This is how it worked before updating the properties:\r\n\t\t// this.pull[id]=item;\r\n\t\tutils.mixin(this.pull[id],item, true);\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.callEvent(\"onAfterUpdate\", [item.id, item]);\r\n\t\t\tthis.callEvent(\"onStoreUpdated\", [item.id, item, \"update\"]);\r\n\t\t}\r\n\t},\r\n\r\n\t_removeItemInner: function(id){\r\n\t\t//clear from collections\r\n\t\t//this.visibleOrder.$remove(id);\r\n\t\tthis._updateOrder(function(){ this.$remove(id);});\r\n\t\tdelete this.pull[id];\r\n\t},\r\n\r\n\tremoveItem: function(id){\r\n\t\t//utils.assert(this.exists(id), \"Not existing ID in remove command\"+id);\r\n\r\n\t\tvar obj = this.getItem(id);\t//save for later event\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tif (this.callEvent(\"onBeforeDelete\", [obj.id, obj]) === false) return false;\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onAfterDeleteConfirmed\", [obj.id, obj]);\r\n\t\tthis._removeItemInner(id);\r\n\t\t\r\n\t\tif (this.isSilent()) {\r\n\t\t\tthis.callEvent(\"onAfterSilentDelete\", [obj.id, obj]);\r\n\t\t}\r\n\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.filter();\r\n\t\t\tthis.callEvent(\"onAfterDelete\", [obj.id, obj]);\r\n\t\t\t//repaint signal\r\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"delete\"]);\r\n\t\t}\r\n\t},\r\n\r\n\t_addItemInner: function(item, index){\r\n\t\t//in case of treetable order is sent as 3rd parameter\r\n\t\t//var order = index;\r\n\r\n\t\tif(this.exists(item.id)){\r\n\t\t\tthis.silent(function(){this.updateItem(item.id, item);});\r\n\t\t}else{\r\n\t\t\tvar order = this.visibleOrder;\r\n\r\n\t\t\t//by default item is added to the end of the list\r\n\t\t\tvar data_size = order.length;\r\n\r\n\t\t\tif (!utils.defined(index) || index < 0)\r\n\t\t\t\tindex = data_size;\r\n\t\t\t//check to prevent too big indexes\r\n\t\t\tif (index > data_size){\r\n\t\t\t\t//dhx.log(\"Warning\",\"DataStore:add\",\"Index of out of bounds\");\r\n\t\t\t\tindex = Math.min(order.length,index);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\t//gantt.assert(!this.exists(id), \"Not unique ID\");\r\n\r\n\t\tthis.pull[item.id]=item;\r\n\t\tthis._updateOrder(function(){\r\n\t\t\tif(this.$find(item.id) === -1)\r\n\t\t\t\tthis.$insertAt(item.id,index);\r\n\t\t});\r\n\t\tthis.filter();\r\n\t\t//order.$insertAt(item.id,index);\r\n\t},\r\n\r\n\r\n\tisVisible: function(id){\r\n\t\treturn this.visibleOrder.$find(id) > -1;\r\n\t},\r\n\tgetVisibleItems: function(){\r\n\t\treturn this.getIndexRange();\r\n\t},\r\n\r\n\taddItem: function(item, index){\r\n\t\tif (!utils.defined(item.id))\r\n\t\t\titem.id = utils.uid();\r\n\r\n\t\tif(this.$initItem){\r\n\t\t\titem = this.$initItem(item);\r\n\t\t}\r\n\r\n\t\tif (!this.isSilent()){\r\n\t\t\tif (this.callEvent(\"onBeforeAdd\", [item.id, item]) === false) return false;\r\n\t\t}\r\n\r\n\r\n\t\tthis._addItemInner(item, index);\r\n\r\n\t\tif (!this.isSilent()){\r\n\t\t\tthis.callEvent(\"onAfterAdd\",[item.id, item]);\r\n\t\t\t//repaint signal\r\n\t\t\tthis.callEvent(\"onStoreUpdated\",[item.id,item,\"add\"]);\r\n\t\t}\r\n\t\treturn item.id;\r\n\t},\r\n\r\n\t_changeIdInner: function(oldId, newId){\r\n\t\tif(this.pull[oldId])\r\n\t\t\tthis.pull[newId] = this.pull[oldId];\r\n\r\n\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\r\n\t\tthis.pull[newId].id = newId;\r\n\t\tthis._updateOrder(function(){\r\n\t\t\tthis[this.$find(oldId)] = newId;\r\n\t\t});\r\n\t\tthis._searchVisibleOrder[newId] = visibleOrder;\r\n\t\tdelete this._searchVisibleOrder[oldId];\r\n\r\n\t\t//this.visibleOrder[this.visibleOrder.$find(oldId)]=newId;\r\n\t\tdelete this.pull[oldId];\r\n\t},\r\n\tchangeId: function(oldId, newId){\r\n\t\tthis._changeIdInner(oldId, newId);\r\n\r\n\t\tthis.callEvent(\"onIdChange\", [oldId, newId]);\r\n\r\n\t},\r\n\texists: function(id){\r\n\t\treturn !!(this.pull[id]);\r\n\t},\r\n\r\n\t_moveInner: function(sindex, tindex){\r\n\t\tvar id = this.getIdByIndex(sindex);\r\n\r\n\t\tthis._updateOrder(function(){\r\n\t\t\tthis.$removeAt(sindex);\r\n\t\t\tthis.$insertAt(id,Math.min(this.length, tindex));\r\n\t\t});\r\n\t\t//this.visibleOrder.$removeAt(sindex);\t//remove at old position\r\n\t\t//if (sindex<tindex) tindex--;\t//correct shift, caused by element removing\r\n\t\t//this.visibleOrder.$insertAt(id,Math.min(this.visibleOrder.length, tindex));\t//insert at new position\r\n\t},\r\n\r\n\tmove: function(sindex, tindex){\r\n\t\t//gantt.assert(sindex>=0 && tindex>=0, \"DataStore::move\",\"Incorrect indexes\");\r\n\r\n\t\tvar id = this.getIdByIndex(sindex);\r\n\t\tvar obj = this.getItem(id);\r\n\t\tthis._moveInner(sindex, tindex);\r\n\r\n\t\tif (!this.isSilent()) {\r\n\t\t\t//repaint signal\r\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"move\"]);\r\n\t\t}\r\n\t},\r\n\tclearAll: function(){\r\n\t\tif(this.$destroyed){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// GS-956 We need to unselect the resource as its ID is cached\r\n\t\tthis.silent(function(){\r\n\t\t\tthis.unselect();\r\n\t\t});\r\n\t\tthis.pull = {};\r\n\t\tthis.visibleOrder = powerArray.$create();\r\n\t\tthis.fullOrder = powerArray.$create();\r\n\t\tif (this.isSilent()) return;\r\n\t\tthis.callEvent(\"onClearAll\",[]);\r\n\t\tthis.refresh();\r\n\t},\r\n\r\n\tsilent:function(code, master){\r\n\t\tvar alreadySilent = false;\r\n\t\tif(this.isSilent()) {\r\n\t\t\talreadySilent = true;\r\n\t\t}\r\n\t\tthis._skip_refresh = true;\r\n\t\tcode.call(master||this);\r\n\t\t\r\n\t\tif (!alreadySilent) {\r\n\t\t\tthis._skip_refresh = false;\r\n\t\t}\r\n\t},\r\n\tisSilent: function(){\r\n\t\treturn !!this._skip_refresh;\r\n\t},\r\n\r\n\tarraysEqual: function (arr1, arr2) {\r\n\t\tif(arr1.length !== arr2.length)\r\n\t\t\treturn false;\r\n\t\tfor(var i = 0; i < arr1.length; i++) {\r\n\t\t\tif(arr1[i] !== arr2[i])\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\trefresh: function(id, quick){\r\n\t\tif(this.$destroyed){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.isSilent()) return;\r\n\r\n\t\tvar item;\r\n\t\tif(id){\r\n\t\t\titem = this.getItem(id);\r\n\t\t}\r\n\r\n\t\tvar args;\r\n\t\tif (id){\r\n\t\t\targs = [id, item, \"paint\"];\r\n\t\t}else{\r\n\t\t\targs = [null,null,null];\r\n\t\t}\r\n\r\n\t\tif(this.callEvent(\"onBeforeStoreUpdate\", args) === false){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar skipFilter = this._quick_refresh && !this._mark_recompute;\r\n\t\tthis._mark_recompute = false;\r\n\t\tif(id){\r\n\t\t\t// if item changes visible order (e.g. expand-collapse branch) - do a complete repaint\r\n\t\t\tif(!quick && !skipFilter){\r\n\t\t\t\tvar oldOrder = this.visibleOrder;\r\n\t\t\t\tthis.filter();\r\n\t\t\t\tif(!this.arraysEqual(oldOrder, this.visibleOrder)){\r\n\t\t\t\t\tid = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}else if(!skipFilter){\r\n\t\t\tthis.filter();\r\n\t\t}\r\n\r\n\t\tif (id){\r\n\t\t\targs = [id, item, \"paint\"];\r\n\t\t}else{\r\n\t\t\targs = [null,null,null];\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onStoreUpdated\",args);\r\n\t},\r\n\r\n\tcount: function(){\r\n\t\treturn this.fullOrder.length;\r\n\t},\r\n\tcountVisible: function(){\r\n\t\treturn this.visibleOrder.length;\r\n\t},\r\n\r\n\tsort: function(sort){},\r\n\r\n\tserialize: function(){},\r\n\r\n\teachItem: function(code){\r\n\t\tfor (var i=0; i<this.fullOrder.length; i++) {\r\n\t\t\tvar item = this.getItem(this.fullOrder[i]);\r\n\t\t\tcode.call(this, item);\r\n\t\t}\r\n\t},\r\n\r\n\tfind: function(filter) {\r\n\t\tvar result = [];\r\n\t\tthis.eachItem(function(item) {\r\n\t\t\tif(filter(item)){\r\n\t\t\t\tresult.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result;\r\n\t},\r\n\r\n\tfilter: function(rule){\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.callEvent(\"onBeforeFilter\", []);\r\n\t\t}\r\n\t\tthis.callEvent(\"onPreFilter\", []);\r\n\t\tvar filteredOrder = powerArray.$create();\r\n\t\tvar placeholderIds = [];\r\n\t\tthis.eachItem(function(item){\r\n\t\t\tif(this.callEvent(\"onFilterItem\", [item.id, item])){\r\n\t\t\t\tif(isPlaceholderTask(item.id, null, this, this._ganttConfig)){\r\n\t\t\t\t\tplaceholderIds.push(item.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tfilteredOrder.push(item.id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfor(var i = 0; i < placeholderIds.length; i++){\r\n\t\t\tfilteredOrder.push(placeholderIds[i]);\r\n\t\t}\r\n\r\n\t\tthis.visibleOrder = filteredOrder;\r\n\t\tthis._searchVisibleOrder = {};\r\n\t\tfor(var i = 0; i < this.visibleOrder.length; i++){\r\n\t\t\tthis._searchVisibleOrder[this.visibleOrder[i]] = i;\r\n\t\t}\r\n\t\tif (!this.isSilent()) {\r\n\t\t\tthis.callEvent(\"onFilter\", []);\r\n\t\t}\r\n\t},\r\n\r\n\tgetIndexRange: function(from, to){\r\n\t\tvar max = Math.min((to||Infinity),this.countVisible()-1);\r\n\t\tvar min = from||0;\r\n\r\n\t\tvar cacheKey = min + '-' + max;\r\n\t\tif(this._indexRangeCache[cacheKey]){\r\n\t\t\treturn this._indexRangeCache[cacheKey].slice();\r\n\t\t}\r\n\r\n\t\tvar ret= [];\r\n\t\tfor (var i=min; i <= max; i++)\r\n\t\t\tret.push(this.getItem(this.visibleOrder[i]));\r\n\r\n\t\tthis._indexRangeCache[cacheKey] = ret.slice();\r\n\t\treturn ret;\r\n\t},\r\n\tgetItems: function(){\r\n\t\tif(this._getItemsCache){\r\n\t\t\treturn this._getItemsCache.slice();\r\n\t\t}\r\n\r\n\t\tvar res = [];\r\n\t\tfor(var i in this.pull){\r\n\t\t\tres.push(this.pull[i]);\r\n\t\t}\r\n\t\tthis._getItemsCache = res.slice();\r\n\r\n\t\treturn res;\r\n\t},\r\n\r\n\tgetIdByIndex: function(index){\r\n\t\treturn this.visibleOrder[index];\r\n\t},\r\n\tgetIndexById: function(id){\r\n\t\tvar res = this._searchVisibleOrder[id];\r\n\t\tif(res === undefined){\r\n\t\t\tres = -1;\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t_getNullIfUndefined: function(value){\r\n\t\tif(value === undefined){\r\n\t\t\treturn null;\r\n\t\t}else{\r\n\t\t\treturn value;\r\n\t\t}\r\n\t},\r\n\tgetFirst: function(){\r\n\t\treturn this._getNullIfUndefined(this.visibleOrder[0]);\r\n\t},\r\n\tgetLast: function(){\r\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1]);\r\n\t},\r\n\tgetNext: function(id){\r\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) + 1]);\r\n\t},\r\n\tgetPrev: function(id){\r\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) - 1]);\r\n\t},\r\n\tdestructor: function(){\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\t\tthis.detachAllEvents();\r\n\t\tthis.$destroyed = true;\r\n\t\tthis.pull = null;\r\n\t\tthis.$initItem = null;\r\n\t\tthis.visibleOrder = null;\r\n\t\tthis.fullOrder = null;\r\n\t\tthis._skip_refresh = null;\r\n\t\tthis._filterRule = null;\r\n\t\tthis._searchVisibleOrder = null;\r\n\t\tthis._indexRangeCache = {};\r\n\t}\r\n};\r\n\r\nexport default DataStore;","import powerArray from \"./power_array\";\r\nimport * as utils from \"../../utils/utils\";\r\nimport * as helpers from \"../../utils/helpers\";\r\nimport DataStore from \"./datastore\";\r\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\r\nimport {replaceValidZeroId} from \"../../utils/helpers\";\r\n\r\nvar TreeDataStore = function(config){\r\n\tDataStore.apply(this, [config]);\r\n\tthis._branches = {};\r\n\r\n\tthis.pull = {};\r\n\t//GS-761 Update existing item instead of adding it to the new position\r\n\tthis.$initItem = function (item){\r\n\t\tvar loadedItem = item;\r\n\t\tif(config.initItem){\r\n\t\t\tloadedItem = config.initItem(loadedItem);\r\n\t\t}\r\n\t\tvar existingItem = this.getItem(item.id);\r\n\t\tif(existingItem && !isEqualIds(existingItem.parent,loadedItem.parent)){\r\n\t\t\tthis.move(loadedItem.id, loadedItem.$index || -1, loadedItem.parent || this._ganttConfig.root_id);\r\n\t\t}\r\n\t\treturn loadedItem;\r\n\t};\r\n\tthis.$parentProperty = config.parentProperty || \"parent\";\r\n\r\n\tif(typeof config.rootId !== \"function\"){\r\n\t\tthis.$getRootId = (function(val){\r\n\t\t\treturn function(){return val;};\r\n\t\t})(config.rootId || 0);\r\n\t}else{\r\n\t\tthis.$getRootId = config.rootId;\r\n\t}\r\n\r\n\t// TODO: replace with live reference to gantt config\r\n\tthis.$openInitially = config.openInitially;\r\n\r\n\tthis.visibleOrder = powerArray.$create();\r\n\tthis.fullOrder = powerArray.$create();\r\n\tthis._searchVisibleOrder = {};\r\n\tthis._indexRangeCache = {};\r\n\tthis._eachItemMainRangeCache = null;\r\n\tthis._getItemsCache = null;\r\n\tthis._skip_refresh = false;\r\n\r\n\tthis._ganttConfig = null;\r\n\tif(config.getConfig){\r\n\t\tthis._ganttConfig = config.getConfig();\r\n\t}\r\n\r\n\tvar splitParents = {};\r\n\tvar splitItems = {};\r\n\r\n\tvar taskOpenState = {};\r\n\tvar taskVisibility = {};\r\n\tvar haveSplitItems = false;\r\n\r\n\tthis._attachDataChange(function(){\r\n\t\tthis._indexRangeCache = {};\r\n\t\tthis._eachItemMainRangeCache = null;\r\n\t\tthis._getItemsCache = null;\r\n\t\treturn true;\r\n\t});\r\n\r\n\tthis.attachEvent(\"onPreFilter\", function(){\r\n\t\tthis._indexRangeCache = {};\r\n\t\tthis._eachItemMainRangeCache = null;\r\n\r\n\t\tsplitParents = {};\r\n\t\tsplitItems = {};\r\n\t\ttaskOpenState = {};\r\n\t\ttaskVisibility = {};\r\n\t\thaveSplitItems = false;\r\n\r\n\t\tthis.eachItem(function(item){\r\n\t\t\tvar parent = this.getParent(item.id);\r\n\t\t\tif(item.$open && taskOpenState[parent] !== false){\r\n\t\t\t\ttaskOpenState[item.id] = true;\r\n\t\t\t}else{\r\n\t\t\t\ttaskOpenState[item.id] = false;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._isSplitItem(item)){\r\n\t\t\t\thaveSplitItems = true;\r\n\t\t\t\tsplitParents[item.id] = true;\r\n\t\t\t\tsplitItems[item.id] = true;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif(haveSplitItems && splitItems[parent]){\r\n\t\t\t\tsplitItems[item.id] = true;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif(taskOpenState[parent] || taskOpenState[parent] === undefined){\r\n\t\t\t\ttaskVisibility[item.id] = true;\r\n\t\t\t}else{\r\n\t\t\t\ttaskVisibility[item.id] = false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tthis.attachEvent(\"onFilterItem\", function(id, item){\r\n\r\n\t\tvar canOpenSplitTasks = false;\r\n\t\tif(this._ganttConfig){\r\n\t\t\tvar canOpenSplitTasks = this._ganttConfig.open_split_tasks;\r\n\t\t}\r\n\r\n\t\tvar open = taskVisibility[item.id];\r\n\r\n\t\tif(haveSplitItems){\r\n\t\t\tif(open && splitItems[item.id] && !splitParents[item.id]){\r\n\t\t\t\topen = !!canOpenSplitTasks;\r\n\t\t\t}\r\n\r\n\t\t\tif(splitItems[item.id] && !splitParents[item.id]){\r\n\t\t\t\titem.$split_subtask = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\titem.$expanded_branch = !!taskVisibility[item.id];\r\n\r\n\t\treturn !!open;\r\n\t});\r\n\r\n\tthis.attachEvent(\"onFilter\", function(){\r\n\t\tsplitParents = {};\r\n\t\tsplitItems = {};\r\n\r\n\t\ttaskOpenState = {};\r\n\t\ttaskVisibility = {};\r\n\t});\r\n\r\n\treturn this;\r\n};\r\n\r\nTreeDataStore.prototype = utils.mixin({\r\n\r\n\t\t_buildTree: function(data){\r\n\t\t\tvar item = null;\r\n\t\t\tvar rootId = this.$getRootId();\r\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\r\n\t\t\t\titem = data[i];\r\n\t\t\t\tthis.setParent(item, replaceValidZeroId(this.getParent(item), rootId) || rootId);\r\n\t\t\t}\r\n\r\n\t\t\t// calculating $level for each item\r\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\r\n\t\t\t\titem = data[i];\r\n\t\t\t\tthis._add_branch(item);\r\n\t\t\t\titem.$level = this.calculateItemLevel(item);\r\n\t\t\t\titem.$local_index = this.getBranchIndex(item.id);\r\n\r\n\t\t\t\tif (!utils.defined(item.$open)) {\r\n\t\t\t\t\titem.$open = utils.defined(item.open) ? item.open : this.$openInitially();\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis._updateOrder();\r\n\t\t},\r\n\t\t_isSplitItem: function(item){\r\n\t\t\treturn (item.render == \"split\" && this.hasChild(item.id));\r\n\t\t},\r\n\t\tparse: function(data){\r\n\t\t\tif (!this._skip_refresh) {\r\n\t\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\r\n\t\t\t}\r\n\t\t\tvar loaded = this._parseInner(data);\r\n\t\t\tthis._buildTree(loaded);\r\n\t\t\tthis.filter();\r\n\t\t\tif (!this._skip_refresh) {\r\n\t\t\t\tthis.callEvent(\"onParse\", [loaded]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_addItemInner: function(item, index){\r\n\r\n\t\t\tvar parent = this.getParent(item);\r\n\r\n\t\t\tif(!utils.defined(parent)){\r\n\t\t\t\tparent = this.$getRootId();\r\n\t\t\t\tthis.setParent(item, parent);\r\n\t\t\t}\r\n\r\n\t\t\tvar parentIndex = this.getIndexById(parent);\r\n\t\t\tvar targetIndex = parentIndex + Math.min(Math.max(index, 0), this.visibleOrder.length);\r\n\r\n\t\t\tif(targetIndex*1 !== targetIndex){\r\n\t\t\t\ttargetIndex = undefined;\r\n\t\t\t}\r\n\t\t\tDataStore.prototype._addItemInner.call(this, item, targetIndex);\r\n\t\t\tthis.setParent(item, parent);\r\n\r\n\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\r\n\t\t\t\tthis._move_branch(item, item.$rendered_parent);\r\n\t\t\t}\r\n\t\t\tthis._add_branch(item, index);\r\n\t\t},\r\n\t\t_changeIdInner: function(oldId, newId){\r\n\t\t\tvar children = this.getChildren(oldId);\r\n\t\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\r\n\r\n\t\t\tDataStore.prototype._changeIdInner.call(this, oldId, newId);\r\n\r\n\t\t\tvar parent = this.getParent(newId);\r\n\r\n\t\t\tthis._replace_branch_child(parent, oldId, newId);\r\n\r\n\t\t\tif(this._branches[oldId]){\r\n\t\t\t\tthis._branches[newId] = this._branches[oldId];\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < children.length; i++){\r\n\t\t\t\tvar child = this.getItem(children[i]);\r\n\t\t\t\tchild[this.$parentProperty] = newId;\r\n\t\t\t\tchild.$rendered_parent = newId;\r\n\t\t\t}\r\n\r\n\t\t\tthis._searchVisibleOrder[newId] = visibleOrder;\r\n\t\t\tdelete this._branches[oldId];\r\n\t\t},\r\n\r\n\t\t_traverseBranches: function(code, parent){\r\n\t\t\tif (!utils.defined(parent)) {\r\n\t\t\t\tparent = this.$getRootId();\r\n\t\t\t}\r\n\t\t\tvar branch = this._branches[parent];\r\n\t\t\tif (branch) {\r\n\t\t\t\tfor (var i = 0; i < branch.length; i++) {\r\n\t\t\t\t\tvar itemId = branch[i];\r\n\t\t\t\t\tcode.call(this, itemId);\r\n\t\t\t\t\tif (this._branches[itemId])\r\n\t\t\t\t\t\tthis._traverseBranches(code, itemId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_updateOrder: function(code){\r\n\r\n\t\t\tthis.fullOrder = powerArray.$create();\r\n\t\t\tthis._traverseBranches(function(taskId){\r\n\t\t\t\tthis.fullOrder.push(taskId);\r\n\t\t\t});\r\n\r\n\t\t\tif(code)\r\n\t\t\t\tDataStore.prototype._updateOrder.call(this, code);\r\n\t\t},\r\n\r\n\t\t_removeItemInner: function(id){\r\n\r\n\t\t\tvar items = [];\r\n\t\t\tthis.eachItem(function(child){\r\n\t\t\t\titems.push(child);\r\n\t\t\t}, id);\r\n\r\n\t\t\titems.push(this.getItem(id));\r\n\r\n\t\t\tfor(var i = 0; i < items.length; i++){\r\n\r\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\r\n\t\t\t\tDataStore.prototype._removeItemInner.call(this, items[i].id);\r\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tmove: function(sid, tindex, parent){\r\n\t\t\t//target id as 4th parameter\r\n\t\t\tvar id = arguments[3];\r\n\t\t\tvar config = this._ganttConfig || {};\r\n\t\t\tvar root_id = config.root_id || 0;\r\n\t\t\tid = replaceValidZeroId(id, root_id);\r\n\t\t\tif (id) {\r\n\t\t\t\tif (id === sid) return;\r\n\r\n\t\t\t\tparent = this.getParent(id);\r\n\t\t\t\ttindex = this.getBranchIndex(id);\r\n\t\t\t}\r\n\t\t\tif(isEqualIds(sid, parent)){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!utils.defined(parent)) {\r\n\t\t\t\tparent = this.$getRootId();\r\n\t\t\t}\r\n\t\t\tvar source = this.getItem(sid);\r\n\t\t\tvar source_pid = this.getParent(source.id);\r\n\r\n\t\t\tvar tbranch = this.getChildren(parent);\r\n\r\n\t\t\tif (tindex == -1)\r\n\t\t\t\ttindex = tbranch.length + 1;\r\n\t\t\tif (isEqualIds(source_pid, parent)) {\r\n\t\t\t\tvar sindex = this.getBranchIndex(sid);\r\n\t\t\t\tif (sindex == tindex) return;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.callEvent(\"onBeforeItemMove\", [sid, parent, tindex]) === false)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\tvar placeholderIds = [];\r\n\t\t\tfor(var i = 0; i < tbranch.length; i++){\r\n\t\t\t\tif (isPlaceholderTask(tbranch[i], null, this, this._ganttConfig)){\r\n\t\t\t\t\tplaceholderIds.push(tbranch[i]);\r\n\t\t\t\t\ttbranch.splice(i, 1);\r\n\t\t\t\t\ti--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._replace_branch_child(source_pid, sid);\r\n\t\t\ttbranch = this.getChildren(parent);\r\n\r\n\t\t\tvar tid = tbranch[tindex];\r\n\t\t\ttid = replaceValidZeroId(tid, root_id);\r\n\t\t\tif (!tid) //adding as last element\r\n\t\t\t\ttbranch.push(sid);\r\n\t\t\telse\r\n\t\t\t\ttbranch = tbranch.slice(0, tindex).concat([ sid ]).concat(tbranch.slice(tindex));\r\n\r\n\t\t\tif (placeholderIds.length){\r\n\t\t\t\ttbranch = tbranch.concat(placeholderIds);\r\n\t\t\t}\r\n\t\t\t// GS-2423 to return initial parent to the task before it will be moved\r\n\t\t\tif (!isEqualIds(source.$rendered_parent, source_pid) && !isEqualIds(source_pid, parent)){\r\n\t\t\t\tsource.$rendered_parent = source_pid;\r\n\t\t\t}\r\n\t\t\tthis.setParent(source, parent);\r\n\t\t\tthis._branches[parent] = tbranch;\r\n\r\n\t\t\tvar diff = this.calculateItemLevel(source) - source.$level;\r\n\t\t\tsource.$level += diff;\r\n\t\t\tthis.eachItem(function(item){\r\n\t\t\t\titem.$level += diff;\r\n\t\t\t}, source.id, this);\r\n\r\n\r\n\t\t\tthis._moveInner(this.getIndexById(sid), this.getIndexById(parent) + tindex);\r\n\r\n\t\t\tthis.callEvent(\"onAfterItemMove\", [sid, parent, tindex]);\r\n\t\t\tthis.refresh();\r\n\t\t},\r\n\r\n\t\tgetBranchIndex: function(id){\r\n\t\t\tvar branch = this.getChildren(this.getParent(id));\r\n\t\t\tlet index = branch.indexOf(id + \"\");\r\n\t\t\tif (index == -1){\r\n\t\t\t\tindex = branch.indexOf(+id);\r\n\t\t\t}\r\n\t\t\treturn index;\r\n\t\t},\r\n\t\thasChild: function(id){\r\n\t\t\tvar branch = this._branches[id];\r\n\t\t\treturn branch && branch.length;\r\n\t\t},\r\n\t\tgetChildren: function(id){\r\n\t\t\tvar branch = this._branches[id];\r\n\t\t\treturn branch ? branch : powerArray.$create();\r\n\t\t},\r\n\r\n\t\tisChildOf: function(childId, parentId){\r\n\t\t\tif (!this.exists(childId))\r\n\t\t\t\treturn false;\r\n\t\t\tif (parentId === this.$getRootId())\r\n\t\t\t\treturn true;\r\n\r\n\t\t\tif (!this.hasChild(parentId))\r\n\t\t\t\treturn false;\r\n\r\n\t\t\tvar item = this.getItem(childId);\r\n\t\t\tvar pid = this.getParent(childId);\r\n\r\n\t\t\tvar parent = this.getItem(parentId);\r\n\t\t\tif(parent.$level >= item.$level){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\twhile (item && this.exists(pid)) {\r\n\t\t\t\titem = this.getItem(pid);\r\n\r\n\t\t\t\tif (item && isEqualIds(item.id, parentId))\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tpid = this.getParent(item);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tgetSiblings: function(id){\r\n\t\t\tif(!this.exists(id)){\r\n\t\t\t\treturn powerArray.$create();\r\n\t\t\t}\r\n\t\t\tvar parent = this.getParent(id);\r\n\t\t\treturn this.getChildren(parent);\r\n\r\n\t\t},\r\n\t\tgetNextSibling: function(id){\r\n\t\t\tvar siblings = this.getSiblings(id);\r\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\r\n\t\t\t\tif(isEqualIds(siblings[i], id)){\r\n\t\t\t\t\tvar nextSibling = siblings[i+1];\r\n\t\t\t\t\tif (nextSibling === 0 && i > 0){\r\n\t\t\t\t\t\tnextSibling = \"0\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn nextSibling || null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetPrevSibling: function(id){\r\n\t\t\tvar siblings = this.getSiblings(id);\r\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\r\n\t\t\t\tif(isEqualIds(siblings[i], id)){\r\n\t\t\t\t\tvar previousSibling = siblings[i-1];\r\n\t\t\t\t\tif (previousSibling === 0 && i > 0){\r\n\t\t\t\t\t\tpreviousSibling = \"0\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn previousSibling || null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t},\r\n\t\tgetParent: function(id){\r\n\t\t\tvar item = null;\r\n\t\t\tif(id.id !== undefined){\r\n\t\t\t\titem = id;\r\n\t\t\t}else{\r\n\t\t\t\titem = this.getItem(id);\r\n\t\t\t}\r\n\r\n\t\t\tvar parent;\r\n\t\t\tif(item){\r\n\t\t\t\tparent = item[this.$parentProperty];\r\n\t\t\t}else{\r\n\t\t\t\tparent = this.$getRootId();\r\n\t\t\t}\r\n\t\t\treturn parent;\r\n\r\n\t\t},\r\n\r\n\t\tclearAll: function(){\r\n\t\t\tthis._branches = {};\r\n\t\t\tDataStore.prototype.clearAll.call(this);\r\n\t\t},\r\n\r\n\t\tcalculateItemLevel: function(item){\r\n\t\t\tvar level = 0;\r\n\t\t\tthis.eachParent(function(){\r\n\t\t\t\tlevel++;\r\n\t\t\t}, item);\r\n\t\t\treturn level;\r\n\t\t},\r\n\r\n\t\t_setParentInner: function(item, new_pid, silent){\r\n\t\t\tif(!silent){\r\n\t\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\r\n\t\t\t\t\tthis._move_branch(item, item.$rendered_parent, new_pid);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis._move_branch(item, item[this.$parentProperty], new_pid);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetParent: function(item, new_pid, silent){\r\n\t\t\tthis._setParentInner(item, new_pid, silent);\r\n\r\n\t\t\titem[this.$parentProperty] = new_pid;\r\n\t\t},\r\n\r\n\t\t_eachItemCached: function(code, cache){\r\n\t\t\tfor(var i = 0, len = cache.length; i < len; i++){\r\n\t\t\t\tcode.call(this, cache[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_eachItemIterate: function(code, startId, cache){\r\n\t\t\tvar itemsStack = this.getChildren(startId);\r\n\t\t\tif(itemsStack.length){\r\n\t\t\t\titemsStack = itemsStack.slice().reverse();\r\n\t\t\t}\r\n\t\t\twhile(itemsStack.length){\r\n\t\t\t\tvar itemId = itemsStack.pop();\r\n\t\t\t\tvar item = this.getItem(itemId);\r\n\t\t\t\tcode.call(this, item);\r\n\t\t\t\tif(cache){\r\n\t\t\t\t\tcache.push(item);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.hasChild(item.id)){\r\n\t\t\t\t\tvar children = this.getChildren(item.id);\r\n\t\t\t\t\tvar len = children.length;\r\n\t\t\t\t\tfor(var i = len - 1; i >= 0; i--){\r\n\t\t\t\t\t\titemsStack.push(children[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\teachItem: function(code, parent){\r\n\t\t\tvar rootId = this.$getRootId();\r\n\t\t\tif (!utils.defined(parent)) {\r\n\t\t\t\tparent = rootId;\r\n\t\t\t}\r\n\t\t\tvar startId = replaceValidZeroId(parent, rootId) || rootId;\r\n\r\n\t\t\tvar useCache = false;\r\n\t\t\tvar buildCache = false;\r\n\t\t\tvar cache = null;\r\n\t\t\tif(startId === rootId){\r\n\t\t\t\tif(this._eachItemMainRangeCache){\r\n\t\t\t\t\tuseCache = true;\r\n\t\t\t\t\tcache = this._eachItemMainRangeCache;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tbuildCache = true;\r\n\t\t\t\t\tcache = this._eachItemMainRangeCache = [];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(useCache){\r\n\t\t\t\tthis._eachItemCached(code, cache);\r\n\t\t\t}else{\r\n\t\t\t\tthis._eachItemIterate(code, startId, buildCache ? cache : null);\r\n\t\t\t}\r\n\t\t},\r\n\t\teachParent: function(code, startItem) {\r\n\t\t\tvar parentsHash = {};\r\n\t\t\tvar item = startItem;\r\n\t\t\tvar parent = this.getParent(item);\r\n\r\n\t\t\twhile (this.exists(parent)) {\r\n\t\t\t\tif (parentsHash[parent]) {\r\n\t\t\t\t\tthrow new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + parent);\r\n\t\t\t\t}\r\n\t\t\t\tparentsHash[parent] = true;\r\n\t\t\t\titem = this.getItem(parent);\r\n\t\t\t\tcode.call(this, item);\r\n\t\t\t\tparent = this.getParent(item);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_add_branch: function(item, index, parent){\r\n\t\t\tvar pid = parent === undefined ? this.getParent(item) : parent;\r\n\t\t\tif (!this.hasChild(pid))\r\n\t\t\t\tthis._branches[pid] = powerArray.$create();\r\n\t\t\tvar branch = this.getChildren(pid);\r\n\t\t\tvar added_already = branch.indexOf(item.id + \"\") > -1 || branch.indexOf(+item.id) > -1;\r\n\t\t\tif(!added_already){\r\n\t\t\t\tif(index*1 == index){\r\n\r\n\t\t\t\t\tbranch.splice(index, 0, item.id);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tbranch.push(item.id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\titem.$rendered_parent = pid;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_move_branch: function(item, old_parent, new_parent){\r\n\t\t\tthis._eachItemMainRangeCache = null;\r\n\t\t\t//this.setParent(item, new_parent);\r\n\t\t\t//this._sync_parent(task);\r\n\t\t\tthis._replace_branch_child(old_parent, item.id);\r\n\t\t\tif(this.exists(new_parent) || isEqualIds(new_parent, this.$getRootId())){\r\n\r\n\t\t\t\tthis._add_branch(item, undefined, new_parent);\r\n\t\t\t}else{\r\n\t\t\t\tdelete this._branches[item.id];\r\n\t\t\t}\r\n\t\t\titem.$level =  this.calculateItemLevel(item);\r\n\t\t\tthis.eachItem(function(child){\r\n\t\t\t\tchild.$level = this.calculateItemLevel(child);\r\n\t\t\t}, item.id);\r\n\t\t},\r\n\r\n\t\t_replace_branch_child: function(node, old_id, new_id){\r\n\t\t\tvar branch = this.getChildren(node);\r\n\t\t\tif (branch && node !== undefined){\r\n\t\t\t\tvar newbranch = powerArray.$create();\r\n\r\n\t\t\t\tlet index = branch.indexOf(old_id + \"\");\r\n\t\t\t\tif (index == -1 && !isNaN(+old_id)){\r\n\t\t\t\t\tindex = branch.indexOf(+old_id);\r\n\t\t\t\t} \r\n\r\n\t\t\t\tif (index > -1){\r\n\t\t\t\t\tif (new_id){\r\n\t\t\t\t\t\tbranch.splice(index, 1, new_id);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tbranch.splice(index, 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnewbranch = branch;\r\n\r\n\t\t\t\tthis._branches[node] = newbranch;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsort: function(field, desc, parent){\r\n\t\t\tif (!this.exists(parent)) {\r\n\t\t\t\tparent = this.$getRootId();\r\n\t\t\t}\r\n\r\n\t\t\tif (!field) field = \"order\";\r\n\t\t\tvar criteria = (typeof(field) == \"string\") ? (function(a, b) {\r\n\t\t\t\tif (a[field] == b[field] ||\r\n\t\t\t\t\t(helpers.isDate(a[field]) && helpers.isDate(b[field]) && a[field].valueOf() == b[field].valueOf()))\r\n\t\t\t\t{\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar result = a[field] > b[field];\r\n\t\t\t\treturn result ? 1 : -1;\r\n\t\t\t}) : field;\r\n\r\n\t\t\tif (desc) {\r\n\t\t\t\tvar original_criteria = criteria;\r\n\t\t\t\tcriteria = function (a, b) {\r\n\t\t\t\t\treturn original_criteria(b, a);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tvar els = this.getChildren(parent);\r\n\r\n\t\t\tif (els){\r\n\t\t\t\tvar temp = [];\r\n\t\t\t\tfor (var i = els.length - 1; i >= 0; i--)\r\n\t\t\t\t\ttemp[i] = this.getItem(els[i]);\r\n\r\n\t\t\t\ttemp.sort(criteria);\r\n\r\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\r\n\t\t\t\t\tels[i] = temp[i].id;\r\n\t\t\t\t\tthis.sort(field, desc, els[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tfilter: function(rule){\r\n\t\t\tfor(let i in this.pull){\r\n\t\t\t\tconst renderedParent = this.pull[i].$rendered_parent;\r\n\t\t\t\tconst actualParent = this.getParent(this.pull[i]);\r\n\t\t\t\t//GS-2339: could be different types of the ids\r\n\t\t\t\tif(!isEqualIds(renderedParent,actualParent)){\r\n\t\t\t\t\tthis._move_branch(this.pull[i], renderedParent, actualParent);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn DataStore.prototype.filter.apply(this, arguments);\r\n\t\t},\r\n\r\n\t\topen: function(id){\r\n\t\t\tif(this.exists(id)){\r\n\t\t\t\tthis.getItem(id).$open = true;\r\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\r\n\t\t\t\tthis._skipTaskRecalculation = true;\r\n\t\t\t\tthis.callEvent(\"onItemOpen\", [id]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tclose: function(id){\r\n\t\t\tif(this.exists(id)){\r\n\t\t\t\tthis.getItem(id).$open = false;\r\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\r\n\t\t\t\tthis._skipTaskRecalculation = true;\r\n\t\t\t\tthis.callEvent(\"onItemClose\", [id]);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdestructor: function(){\r\n\t\t\tDataStore.prototype.destructor.call(this);\r\n\t\t\tthis._branches = null;\r\n\t\t\tthis._indexRangeCache = {};\r\n\t\t\tthis._eachItemMainRangeCache = null;\r\n\t\t}\r\n\t},\r\n\tDataStore.prototype\r\n);\r\n\r\nfunction isEqualIds(first, second){\r\n\treturn String(first) === String(second);\r\n};\r\n\r\nexport default TreeDataStore;","import env from \"./env\";\r\n\r\nexport default function(gantt){\r\n\treturn env.isNode || !gantt.$root;\r\n};","import isHeadless from \"../../utils/is_headless\";\r\n\r\nconst storeRenderCreator = function(name, gantt){\r\n\r\n\tconst store = gantt.getDatastore(name);\r\n\r\n\tconst itemRepainter = {\r\n\t\trenderItem: function(id, renderer){\r\n\r\n\t\t\tconst renders = renderer.getLayers();\r\n\r\n\t\t\tconst item = store.getItem(id);\r\n\t\t\tif(item && store.isVisible(id)) {\r\n\t\t\t\tfor (let i = 0; i < renders.length; i++)\r\n\t\t\t\t\trenders[i].render_item(item);\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderItems: function(renderer){\r\n\t\t\tconst renderers = renderer.getLayers();\r\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\r\n\t\t\t\trenderers[i].clear();\r\n\t\t\t}\r\n\r\n\t\t\tlet allData = null;\r\n\r\n\t\t\tconst loadedRanges = {};\r\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\r\n\t\t\t\tconst layer = renderers[i];\r\n\t\t\t\tlet layerData;\r\n\t\t\t\tif(layer.get_visible_range){\r\n\r\n\t\t\t\t\tvar range = layer.get_visible_range(store);\r\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\r\n\t\t\t\t\t\tvar key = range.start + \" - \" + range.end;\r\n\t\t\t\t\t\tif(loadedRanges[key]){\r\n\t\t\t\t\t\t\tlayerData = loadedRanges[key];\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tlayerData = store.getIndexRange(range.start, range.end);\r\n\t\t\t\t\t\t\tloadedRanges[key] = layerData;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else if(range.ids !== undefined){\r\n\t\t\t\t\t\tlayerData = range.ids.map(function(id){\r\n\t\t\t\t\t\t\treturn store.getItem(id);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif(!allData){\r\n\t\t\t\t\t\tallData = store.getVisibleItems();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlayerData = allData;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (layer.prepare_data) {\r\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\r\n\t\t\t\t\tlayer.prepare_data(layerData);\r\n\t\t\t\t}\r\n\r\n\t\t\t\trenderers[i].render_items(layerData);\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdateItems: function(layer) {\r\n\t\t\tif(layer.update_items){\r\n\t\t\t\tlet data = [];\r\n\t\t\t\tif(layer.get_visible_range){\r\n\r\n\t\t\t\t\tvar range = layer.get_visible_range(store);\r\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\r\n\t\t\t\t\t\tdata = store.getIndexRange(range.start, range.end);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(range.ids !== undefined){\r\n\t\t\t\t\t\tlet extraDataArr = range.ids.map(function(id){\r\n\t\t\t\t\t\t\treturn store.getItem(id);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// GS-2502: range.ids might not exist in other datastores\r\n\t\t\t\t\t\tif(extraDataArr.length > 0){\r\n\t\t\t\t\t\t\textraDataArr = extraDataArr.filter(element => element !== undefined);\r\n\t\t\t\t\t\t\tdata = data.concat(extraDataArr);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif((range.start == undefined || range.end == undefined) && range.ids == undefined)  {\r\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdata = store.getVisibleItems();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (layer.prepare_data) {\r\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\r\n\t\t\t\t\tlayer.prepare_data(data, layer);\r\n\t\t\t\t}\r\n\t\t\t\tlayer.update_items(data);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\r\n\t\tif(isHeadless(gantt)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\r\n\t\tif(renderer){\r\n\t\t\trenderer.onUpdateRequest = function(layer){\r\n\t\t\t\titemRepainter.updateItems(layer);\r\n\t\t\t};\r\n\t\t}\r\n\t});\r\n\r\n\tfunction skipRepaint(gantt){\r\n\t\tconst state = gantt.$services.getService(\"state\");\r\n\t\tif(state.getState(\"batchUpdate\").batch_update){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\r\n\t\tif(skipRepaint(gantt)){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!id || action == \"move\" || action == \"delete\"){\r\n\t\t\tstore.callEvent(\"onBeforeRefreshAll\", []);\r\n\t\t\tstore.callEvent(\"onAfterRefreshAll\", []);\r\n\t\t}else{\r\n\t\t\tstore.callEvent(\"onBeforeRefreshItem\", [item.id]);\r\n\t\t\tstore.callEvent(\"onAfterRefreshItem\", [item.id]);\r\n\t\t}\r\n\t});\r\n\r\n\tstore.attachEvent(\"onAfterRefreshAll\", function(){\r\n\t\tif(isHeadless(gantt)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\r\n\t\tif(renderer && !skipRepaint(gantt)){\r\n\t\t\titemRepainter.renderItems(renderer);\r\n\t\t}\r\n\t});\r\n\tstore.attachEvent(\"onAfterRefreshItem\", function(id){\r\n\t\tif(isHeadless(gantt)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\r\n\t\tif(renderer){\r\n\t\t\titemRepainter.renderItem(id, renderer);\r\n\t\t}\r\n\t});\r\n\r\n\t// TODO: probably can be done more in a more efficient way\r\n\tstore.attachEvent(\"onItemOpen\", function(){\r\n\t\tif(isHeadless(gantt) || store.isSilent()){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tgantt.render();\r\n\t});\r\n\r\n\tstore.attachEvent(\"onItemClose\", function(){\r\n\t\tif(isHeadless(gantt) || store.isSilent()){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tgantt.render();\r\n\t});\r\n\r\n\tfunction refreshId(renders, oldId, newId, item) {\r\n\t\tfor (let i = 0; i < renders.length; i++) {\r\n\t\t\trenders[i].change_id(oldId, newId);\r\n\t\t}\r\n\t}\r\n\r\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId){\r\n\t\tif(isHeadless(gantt)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// in case of linked datastores (tasks <-> links), id change should recalculate something in linked datastore before any repaint\r\n\t\t// use onBeforeIdChange for this hook.\r\n\t\t// TODO: use something more reasonable instead\r\n\t\tstore.callEvent(\"onBeforeIdChange\", [oldId, newId]);\r\n\r\n\t\tif(skipRepaint(gantt)){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!store.isSilent()){\r\n\t\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\r\n\t\t\tif(renderer){ // missing check for renderer GS-1814\r\n\t\t\t\trefreshId(renderer.getLayers(), oldId, newId, store.getItem(newId));\r\n\t\t\t\titemRepainter.renderItem(newId, renderer);\r\n\t\t\t}else{\r\n\t\t\t\t// GS-1814 repaint ui to apply new id when the datastore don't have own renderer\r\n\t\t\t\tgantt.render();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n};\r\n\r\nexport default {\r\n\tbindDataStore: storeRenderCreator\r\n};","import * as utils from \"../../utils/utils\";\r\nimport createTasksFacade from \"./datastore_tasks\";\r\nimport createLinksFacade from \"./datastore_links\";\r\nimport DataStore from \"../datastore/datastore\";\r\nimport TreeDataStore from \"../datastore/treedatastore\";\r\nimport createDatastoreSelect from \"../datastore/select\";\r\nimport datastoreRender from \"../datastore/datastore_render\";\r\nimport isHeadless from \"../../utils/is_headless\";\r\nimport {replaceValidZeroId} from \"../../utils/helpers\";\r\n\r\nfunction getDatastores(){\r\n\tvar storeNames = this.$services.getService(\"datastores\");\r\n\tvar res = [];\r\n\tfor(var i = 0; i < storeNames.length; i++){\r\n\t\tvar store = this.getDatastore(storeNames[i]);\r\n\t\tif(!store.$destroyed){\r\n\t\t\tres.push(store);\r\n\t\t}\r\n\t}\r\n\treturn res;\r\n}\r\n\r\nvar createDatastoreFacade = function(){\r\n\treturn {\r\n\tcreateDatastore: function(config){\r\n\r\n\t\tvar $StoreType = (config.type || \"\").toLowerCase() == \"treedatastore\" ? TreeDataStore : DataStore;\r\n\r\n\t\tif (config) {\r\n\t\t\tvar self = this;\r\n\t\t\tconfig.openInitially = function(){ return self.config.open_tree_initially; };\r\n\t\t\tconfig.copyOnParse = function(){ return self.config.deepcopy_on_parse; };\r\n\t\t}\r\n\r\n\t\tvar store = new $StoreType(config);\r\n\t\tthis.mixin(store, createDatastoreSelect(store));\r\n\r\n\t\tif (config.name) {\r\n\t\t\tvar servicePrefix = \"datastore:\";\r\n\t\t\tvar storeAccessName = servicePrefix + config.name;\r\n\r\n\t\t\tstore.attachEvent(\"onDestroy\", function(){\r\n\t\t\t\tthis.$services.dropService(storeAccessName);\r\n\t\t\t\tvar storeList = this.$services.getService(\"datastores\");\r\n\t\t\t\tfor(var i = 0; i < storeList.length; i++){\r\n\t\t\t\t\tif(storeList[i] === config.name){\r\n\t\t\t\t\t\tstoreList.splice(i, 1);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\r\n\t\t\tthis.$services.dropService(storeAccessName);\r\n\t\t\tthis.$services.setService(storeAccessName, function() { return store; } );\r\n\r\n\t\t\tvar storeList = this.$services.getService(\"datastores\");\r\n\t\t\tif (!storeList) {\r\n\t\t\t\tstoreList = [];\r\n\t\t\t\tthis.$services.setService(\"datastores\", function() { return storeList; });\r\n\t\t\t\tstoreList.push(config.name);\r\n\t\t\t} else if (storeList.indexOf(config.name) < 0) {\r\n\t\t\t\tstoreList.push(config.name);\r\n\t\t\t}\r\n\r\n\t\t\tdatastoreRender.bindDataStore(config.name, this);\r\n\r\n\t\t}\r\n\r\n\t\treturn store;\r\n\t},\r\n\tgetDatastore: function(name){\r\n\t\treturn this.$services.getService(\"datastore:\" + name);\r\n\t},\r\n\t_getDatastores: getDatastores,\r\n\r\n\trefreshData: function () {\r\n\t\tvar scrollState;\r\n\t\tif(!isHeadless(this)){\r\n\t\t\tscrollState = this.getScrollState();\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onBeforeDataRender\", []);\r\n\r\n\t\tvar stores = getDatastores.call(this);\r\n\t\tfor(var i = 0; i < stores.length; i++){\r\n\t\t\tstores[i].refresh();\r\n\t\t}\r\n\r\n\t\tif(this.config.preserve_scroll && !isHeadless(this) && (scrollState.x || scrollState.y)){\r\n\t\t\tthis.scrollTo(scrollState.x, scrollState.y);\r\n\t\t}\r\n\t\tthis.callEvent(\"onDataRender\", []);\r\n\r\n\t},\r\n\r\n\tisChildOf: function(childId, parentId){\r\n\t\treturn this.$data.tasksStore.isChildOf(childId, parentId);\r\n\t},\r\n\r\n\trefreshTask: function (taskId, refresh_links) {\r\n\t\tvar task = this.getTask(taskId);\r\n\t\tvar self = this;\r\n\t\tfunction refreshLinks(){\r\n\t\t\tif (refresh_links !== undefined && !refresh_links)\r\n\t\t\t\treturn;\r\n\t\t\tfor (var i = 0; i < task.$source.length; i++) {\r\n\t\t\t\tself.refreshLink(task.$source[i]);\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < task.$target.length; i++) {\r\n\t\t\t\tself.refreshLink(task.$target[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (task && this.isTaskVisible(taskId)) {\r\n\t\t\tthis.$data.tasksStore.refresh(taskId, !!this.getState(\"tasksDnd\").drag_id || refresh_links === false);// do quick refresh during drag and drop\r\n\t\t\trefreshLinks();\r\n\t\t}else if(this.isTaskExists(taskId) && this.isTaskExists(this.getParent(taskId)) && !this._bulk_dnd){\r\n\t\t\tthis.refreshTask(this.getParent(taskId));\r\n\r\n\t\t\tvar hasSplitParent = false;\r\n\t\t\tthis.eachParent(function(parent){\r\n\t\t\t\tif(hasSplitParent || this.isSplitTask(parent)){\r\n\t\t\t\t\thasSplitParent = true;\r\n\t\t\t\t}\r\n\t\t\t}, taskId);\r\n\t\t\tif(hasSplitParent){\r\n\t\t\t\trefreshLinks();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t},\r\n\trefreshLink: function (linkId) {\r\n\t\tthis.$data.linksStore.refresh(linkId, !!this.getState(\"tasksDnd\").drag_id);// do quick refresh during drag and drop\r\n\t},\r\n\r\n\tsilent: function(code){\r\n\t\tvar gantt = this;\r\n\t\tgantt.$data.tasksStore.silent(function(){\r\n\t\t\tgantt.$data.linksStore.silent(function(){\r\n\t\t\t\tcode();\r\n\t\t\t});\r\n\t\t});\r\n\t},\r\n\r\n\tclearAll: function () {\r\n\t\tvar stores = getDatastores.call(this);\r\n\t\t\r\n\t\t// clear all stores without invoking clearAll event\r\n\t\t// in order to prevent calling handlers when only some stores are cleared\r\n\t\tfor(var i = 0; i < stores.length; i++){\r\n\t\t\tstores[i].silent(function(){\r\n\t\t\t\tstores[i].clearAll();\t\r\n\t\t\t});\r\n\t\t}\r\n\t\t// run clearAll again to invoke events\r\n\t\tfor(var i = 0; i < stores.length; i++){\r\n\t\t\tstores[i].clearAll();\t\r\n\t\t}\r\n\r\n\t\tthis._update_flags();\r\n\t\tthis.userdata = {};\r\n\t\tthis.callEvent(\"onClear\", []);\r\n\t\tthis.render();\r\n\t},\r\n\t_clear_data: function () {\r\n\t\tthis.$data.tasksStore.clearAll();\r\n\t\tthis.$data.linksStore.clearAll();\r\n\t\tthis._update_flags();\r\n\t\tthis.userdata = {};\r\n\t},\r\n\r\n\tselectTask: function(id){\r\n\t\tvar store = this.$data.tasksStore;\r\n\t\tif(!this.config.select_task)\r\n\t\t\treturn false;\r\n\t\tid = replaceValidZeroId(id, this.config.root_id);\r\n\t\tif (id){\r\n\t\t\tlet oldSelectId = this.getSelectedId();\r\n\t\t\t// Don't repaint the resource panel as the data didn't change\r\n\t\t\tstore._skipResourceRepaint = true;\r\n\t\t\tstore.select(id);\r\n\t\t\tstore._skipResourceRepaint = false;\r\n\t\t\t// GS-730. Split task is not included in the tree, \r\n\t\t\t// so the datastore renderer will think that the task is not visible\r\n\t\t\tif (oldSelectId && store.pull[oldSelectId].$split_subtask && oldSelectId != id) {\r\n\t\t\t\tthis.refreshTask(oldSelectId);\r\n\t\t\t}\r\n\t\t\tif (store.pull[id].$split_subtask && oldSelectId != id) {// GS-1850. Do not repaint split task after double click\r\n\t\t\t\tthis.refreshTask(id);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn store.getSelectedId();\r\n\t},\r\n\tunselectTask: function(id){\r\n\t\tvar store = this.$data.tasksStore;\r\n\t\tstore.unselect(id);\r\n\t\t// GS-730. Split task is not included in the tree, \r\n\t\t// so the datastore renderer will think that the task is not visible\r\n\t\tif (id && store.pull[id].$split_subtask) {\r\n\t\t\tthis.refreshTask(id);\r\n\t\t}\r\n\t},\r\n\tisSelectedTask: function(id){\r\n\t\treturn this.$data.tasksStore.isSelected(id);\r\n\t},\r\n\tgetSelectedId: function() {\r\n\t\treturn this.$data.tasksStore.getSelectedId();\r\n\t}\r\n};\r\n};\r\n\r\nfunction createFacade(){\r\n\tvar res = utils.mixin({}, createDatastoreFacade());\r\n\tutils.mixin(res, createTasksFacade());\r\n\tutils.mixin(res, createLinksFacade());\r\n\treturn res;\r\n}\r\n\r\n\r\n\r\n\r\nexport default {create: createFacade};","function createDataStoreSelectMixin(store){\r\n\tvar selectedId = null;\r\n\r\n\tvar deleteItem = store._removeItemInner;\r\n\t\r\n\tfunction unselect(id){\r\n\t\tselectedId = null;\r\n\t\tthis.callEvent(\"onAfterUnselect\", [id]);\r\n\t}\r\n\r\n\tstore._removeItemInner = function(id){\r\n\t\tif(selectedId == id){\r\n\t\t\tunselect.call(this, id);\r\n\t\t}\r\n\r\n\t\tif(selectedId && this.eachItem){\r\n\t\t\tthis.eachItem(function(subItem){\r\n\t\t\t\tif(subItem.id == selectedId){\r\n\t\t\t\t\tunselect.call(this, subItem.id);\r\n\t\t\t\t}\r\n\t\t\t}, id);\r\n\t\t}\r\n\r\n\t\treturn deleteItem.apply(this, arguments);\r\n\t};\r\n\r\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId) {\r\n\t\tif (store.getSelectedId() == oldId) {\r\n\t\t\tstore.silent(function () {\r\n\t\t\t\tstore.unselect(oldId);\r\n\t\t\t\tstore.select(newId);\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\treturn {\r\n\t\tselect: function(id){\r\n\t\t\tif (id){\r\n\r\n\t\t\t\tif(selectedId == id)\r\n\t\t\t\t\treturn selectedId;\r\n\r\n\t\t\t\tif(!this._skip_refresh) {\r\n\t\t\t\t\tif (!this.callEvent(\"onBeforeSelect\", [id])) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.unselect();\r\n\r\n\t\t\t\tselectedId = id;\r\n\r\n\t\t\t\tif(!this._skip_refresh) {\r\n\t\t\t\t\tthis.refresh(id);\r\n\t\t\t\t\tthis.callEvent(\"onAfterSelect\", [id]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn selectedId;\r\n\t\t},\r\n\t\tgetSelectedId: function(){\r\n\t\t\treturn selectedId;\r\n\t\t},\r\n\t\tisSelected: function(id){\r\n\t\t\treturn id == selectedId;\r\n\t\t},\r\n\t\tunselect: function(id){\r\n\t\t\tvar id = id || selectedId;\r\n\t\t\tif(!id)\r\n\t\t\t\treturn;\r\n\t\t\tselectedId = null;\r\n\t\t\tif(!this._skip_refresh){\r\n\t\t\t\tthis.refresh(id);\r\n\t\t\t\tunselect.call(this, id);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default createDataStoreSelectMixin;","import * as utils from \"../../utils/utils\";\r\n\r\n\r\nvar createLinksStoreFacade = function(){\r\n\treturn {\r\n\tgetLinkCount: function () {\r\n\t\treturn this.$data.linksStore.count();\r\n\t},\r\n\r\n\tgetLink : function (id) {\r\n\t\treturn this.$data.linksStore.getItem(id);\r\n\t},\r\n\r\n\tgetLinks : function () {\r\n\t\treturn this.$data.linksStore.getItems();\r\n\t},\r\n\r\n\tisLinkExists : function (id) {\r\n\t\treturn this.$data.linksStore.exists(id);\r\n\t},\r\n\r\n\taddLink : function (link) {\r\n\t\treturn this.$data.linksStore.addItem(link);\r\n\t},\r\n\r\n\tupdateLink : function (id, data) {\r\n\t\tif (!utils.defined(data))\r\n\t\t\tdata = this.getLink(id);\r\n\t\tthis.$data.linksStore.updateItem(id, data);\r\n\t},\r\n\r\n\tdeleteLink : function (id) {\r\n\t\treturn this.$data.linksStore.removeItem(id);\r\n\t},\r\n\r\n\tchangeLinkId : function (oldid, newid) {\r\n\t\treturn this.$data.linksStore.changeId(oldid, newid);\r\n\t}\r\n};\r\n};\r\n\r\nexport default createLinksStoreFacade;","import * as utils from \"../../../utils/utils\";\r\n\r\nfunction ScaleHelper(gantt){\r\n\tvar dateHelper = gantt.date;\r\n\tvar services = gantt.$services;\r\n\r\n\treturn {\r\n\t\tgetSum: function (sizes, from, to) {\r\n\t\t\tif (to === undefined)\r\n\t\t\t\tto = sizes.length - 1;\r\n\t\t\tif (from === undefined)\r\n\t\t\t\tfrom = 0;\r\n\r\n\t\t\tvar summ = 0;\r\n\t\t\tfor (var i = from; i <= to; i++)\r\n\t\t\t\tsumm += sizes[i];\r\n\r\n\t\t\treturn summ;\r\n\t\t},\r\n\t\tsetSumWidth: function (sum_width, scale, from, to) {\r\n\t\t\tvar parts = scale.width;\r\n\r\n\t\t\tif (to === undefined)\r\n\t\t\t\tto = parts.length - 1;\r\n\t\t\tif (from === undefined)\r\n\t\t\t\tfrom = 0;\r\n\t\t\tvar length = to - from + 1;\r\n\r\n\t\t\tif (from > parts.length - 1 || length <= 0 || to > parts.length - 1)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tvar oldWidth = this.getSum(parts, from, to);\r\n\r\n\t\t\tvar diff = sum_width - oldWidth;\r\n\r\n\t\t\tthis.adjustSize(diff, parts, from, to);\r\n\t\t\tthis.adjustSize(-diff, parts, to + 1);\r\n\r\n\t\t\tscale.full_width = this.getSum(parts);\r\n\t\t},\r\n\t\tsplitSize: function (width, count) {\r\n\t\t\tvar arr = [];\r\n\t\t\tfor (var i = 0; i < count; i++) arr[i] = 0;\r\n\r\n\t\t\tthis.adjustSize(width, arr);\r\n\t\t\treturn arr;\r\n\r\n\t\t},\r\n\t\tadjustSize: function (width, parts, from, to) {\r\n\t\t\tif (!from)\r\n\t\t\t\tfrom = 0;\r\n\t\t\tif (to === undefined)\r\n\t\t\t\tto = parts.length - 1;\r\n\r\n\t\t\tvar length = to - from + 1;\r\n\r\n\t\t\tvar full = this.getSum(parts, from, to);\r\n\r\n\t\t\tfor (var i = from; i <= to; i++) {\r\n\t\t\t\tvar share = Math.floor(width * (full ? (parts[i] / full) : (1 / length)));\r\n\r\n\t\t\t\tfull -= parts[i];\r\n\t\t\t\twidth -= share;\r\n\t\t\t\tlength--;\r\n\r\n\t\t\t\tparts[i] += share;\r\n\t\t\t}\r\n\t\t\tparts[parts.length - 1] += width;\r\n\t\t},\r\n\t\tsortScales: function (scales) {\r\n\t\t\tfunction cellSize(unit, step) {\r\n\t\t\t\tvar d = new Date(1970, 0, 1);\r\n\t\t\t\treturn dateHelper.add(d, step, unit) - d;\r\n\t\t\t}\r\n\r\n\t\t\tscales.sort(function (a, b) {\r\n\t\t\t\tif (cellSize(a.unit, a.step) < cellSize(b.unit, b.step)) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t} else if (cellSize(a.unit, a.step) > cellSize(b.unit, b.step)) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tfor (var i = 0; i < scales.length; i++) {\r\n\t\t\t\tscales[i].index = i;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_isLegacyMode: function(config){\r\n\t\t\tvar scaleConfig = config || gantt.config;\r\n\t\t\treturn scaleConfig.scale_unit || scaleConfig.date_scale || scaleConfig.subscales;\r\n\t\t},\r\n\t\t_prepareScaleObject: function(scale){\r\n\t\t\tvar format = scale.format;\r\n\t\t\tif(!format){\r\n\t\t\t\tformat = scale.template || scale.date || \"%d %M\";\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof format === \"string\"){\r\n\t\t\t\tformat = gantt.date.date_to_str(format);\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tunit: scale.unit || \"day\",\r\n\t\t\t\tstep: scale.step || 1,\r\n\t\t\t\tformat: format,\r\n\t\t\t\tcss: scale.css\r\n\t\t\t};\r\n\t\t},\r\n\t\tprimaryScale: function(config) {\r\n\t\t\tvar templates = services.getService(\"templateLoader\");\r\n\t\t\tvar legacyMode = this._isLegacyMode(config);\r\n\r\n\t\t\tvar scaleConfig = config || gantt.config;\r\n\r\n\t\t\tvar result;\r\n\t\t\tif(legacyMode){\r\n\t\t\t\ttemplates.initTemplate(\"date_scale\", undefined, undefined, scaleConfig, gantt.config.templates);\r\n\t\t\t\tresult = {\r\n\t\t\t\t\tunit: gantt.config.scale_unit,\r\n\t\t\t\t\tstep: gantt.config.step,\r\n\t\t\t\t\ttemplate: gantt.templates.date_scale,\r\n\t\t\t\t\tdate: gantt.config.date_scale,\r\n\t\t\t\t\tcss: gantt.templates.scale_cell_class\r\n\t\t\t\t};\r\n\t\t\t}else{\r\n\t\t\t\tvar primaryScale = scaleConfig.scales[0];\r\n\t\t\t\tresult = {\r\n\t\t\t\t\tunit: primaryScale.unit,\r\n\t\t\t\t\tstep: primaryScale.step,\r\n\t\t\t\t\ttemplate: primaryScale.template,\r\n\t\t\t\t\tformat: primaryScale.format,\r\n\t\t\t\t\tdate: primaryScale.date,\r\n\t\t\t\t\tcss: primaryScale.css || gantt.templates.scale_cell_class\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn this._prepareScaleObject(result);\r\n\t\t},\r\n\t\tgetSubScales: function(config) {\r\n\t\t\tvar legacyMode = this._isLegacyMode(config);\r\n\t\t\tvar scaleConfig = config || gantt.config;\r\n\t\t\tvar scales;\r\n\t\t\tif(legacyMode){\r\n\t\t\t\tlet docLink = \"https://docs.dhtmlx.com/gantt/migrating.html#:~:text=%3D%20false%3B-,Time%20scale%20settings,-Configuration%20of%20time\";\r\n\t\t\t\tif (gantt.env.isFF){\r\n\t\t\t\t\tdocLink = \"https://docs.dhtmlx.com/gantt/migrating.html#6162\";\r\n\t\t\t\t}\r\n\t\t\t\t// eslint-disable-next-line no-console\r\n\t\t\t\tconsole.warn(`You are using the obsolete scale configuration.\r\nIt will stop working in the future versions.\r\nPlease migrate the configuration to the newer version:\r\n${docLink}`);\r\n\t\t\t\tscales = scaleConfig.subscales || [];\r\n\t\t\t}else{\r\n\t\t\t\tscales = scaleConfig.scales.slice(1);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn scales.map(function(scale){\r\n\t\t\t\treturn this._prepareScaleObject(scale);\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\r\n\t\tprepareConfigs: function (scales, min_coll_width, container_width, scale_height, minDate, maxDate, rtl) {\r\n\t\t\tvar heights = this.splitSize(scale_height, scales.length);\r\n\t\t\tvar full_width = container_width;\r\n\r\n\t\t\tvar configs = [];\r\n\t\t\tfor (var i = scales.length - 1; i >= 0; i--) {\r\n\t\t\t\tvar main_scale = (i == scales.length - 1);\r\n\t\t\t\tvar cfg = this.initScaleConfig(scales[i], minDate, maxDate);\r\n\t\t\t\tif (main_scale) {\r\n\t\t\t\t\tthis.processIgnores(cfg);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.initColSizes(cfg, min_coll_width, full_width, heights[i]);\r\n\t\t\t\tthis.limitVisibleRange(cfg);\r\n\r\n\t\t\t\tif (main_scale) {\r\n\t\t\t\t\tfull_width = cfg.full_width;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconfigs.unshift(cfg);\r\n\t\t\t}\r\n\r\n\r\n\t\t\tfor (var i = 0; i < configs.length - 1; i++) {\r\n\t\t\t\tthis.alineScaleColumns(configs[configs.length - 1], configs[i]);\r\n\t\t\t}\r\n\t\t\tfor (var i = 0; i < configs.length; i++) {\r\n\r\n\t\t\t\tif(rtl){\r\n\t\t\t\t\tthis.reverseScale(configs[i]);\r\n\t\t\t\t}\r\n\t\t\t\tthis.setPosSettings(configs[i]);\r\n\t\t\t}\r\n\t\t\treturn configs;\r\n\r\n\t\t},\r\n\r\n\t\treverseScale: function(scale){\r\n\t\t\tscale.width = scale.width.reverse();\r\n\t\t\tscale.trace_x = scale.trace_x.reverse();\r\n\r\n\t\t\tvar indexes = scale.trace_indexes;\r\n\t\t\tscale.trace_indexes = {};\r\n\t\t\tscale.trace_index_transition = {};\r\n\t\t\tscale.rtl = true;\r\n\t\t\tfor(var i = 0; i < scale.trace_x.length; i++){\r\n\t\t\t\tscale.trace_indexes[scale.trace_x[i].valueOf()] = i;\r\n\t\t\t\tscale.trace_index_transition[indexes[scale.trace_x[i].valueOf()]] = i;\r\n\t\t\t}\r\n\t\t\treturn scale;\r\n\t\t},\r\n\r\n\t\tsetPosSettings: function (config) {\r\n\t\t\tfor (var i = 0, len = config.trace_x.length; i < len; i++) {\r\n\t\t\t\tconfig.left.push((config.width[i - 1] || 0) + (config.left[i - 1] || 0));\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_ignore_time_config: function (date, scale) {\r\n\r\n\t\t\tif (gantt.config.skip_off_time) {\r\n\t\t\t\tvar skip = true;\r\n\t\t\t\tvar probe = date;\r\n\r\n\t\t\t\t// check dates in case custom scale unit, e.g. {unit: \"month\", step: 3}\r\n\t\t\t\tfor (var i = 0; i < scale.step; i++) {\r\n\t\t\t\t\tif (i) {\r\n\t\t\t\t\t\tprobe = dateHelper.add(date, i, scale.unit);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tskip = skip && !this.isWorkTime(probe, scale.unit);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn skip;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t//defined in an extension\r\n\t\tprocessIgnores: function (config) {\r\n\t\t\tconfig.ignore_x = {};\r\n\t\t\tconfig.display_count = config.count;\r\n\t\t},\r\n\t\tinitColSizes: function (config, min_col_width, full_width, line_height) {\r\n\t\t\tvar cont_width = full_width;\r\n\r\n\t\t\tconfig.height = line_height;\r\n\r\n\t\t\tvar column_count = config.display_count === undefined ? config.count : config.display_count;\r\n\r\n\t\t\tif (!column_count)\r\n\t\t\t\tcolumn_count = 1;\r\n\r\n\t\t\tconfig.col_width = Math.floor(cont_width / column_count);\r\n\r\n\t\t\tif (min_col_width) {\r\n\t\t\t\tif (config.col_width < min_col_width) {\r\n\t\t\t\t\tconfig.col_width = min_col_width;\r\n\t\t\t\t\tcont_width = config.col_width * column_count;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconfig.width = [];\r\n\t\t\tvar ignores = config.ignore_x || {};\r\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\r\n\t\t\t\tif (ignores[config.trace_x[i].valueOf()] || (config.display_count == config.count)) {\r\n\t\t\t\t\tconfig.width[i] = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// width of month columns should be proportional month duration\r\n\t\t\t\t\tvar width = 1;\r\n\t\t\t\t\tif (config.unit == \"month\") {\r\n\t\t\t\t\t\tvar days = Math.round((dateHelper.add(config.trace_x[i], config.step, config.unit) - config.trace_x[i]) / (1000 * 60 * 60 * 24));\r\n\t\t\t\t\t\twidth = days;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconfig.width[i] = width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.adjustSize(cont_width - this.getSum(config.width)/* 1 width per column from the code above */, config.width);\r\n\t\t\tconfig.full_width = this.getSum(config.width);\r\n\t\t},\r\n\t\tinitScaleConfig: function (config, min_date, max_date) {\r\n\t\t\tvar cfg = utils.mixin({\r\n\t\t\t\tcount: 0,\r\n\t\t\t\tcol_width: 0,\r\n\t\t\t\tfull_width: 0,\r\n\t\t\t\theight: 0,\r\n\t\t\t\twidth: [],\r\n\t\t\t\tleft: [],\r\n\t\t\t\ttrace_x: [],\r\n\t\t\t\ttrace_indexes: {},\r\n\t\t\t\tmin_date: new Date(min_date),\r\n\t\t\t\tmax_date: new Date(max_date)\r\n\t\t\t}, config);\r\n\r\n\t\t\tthis.eachColumn(config.unit, config.step, min_date, max_date, function (date) {\r\n\t\t\t\tcfg.count++;\r\n\t\t\t\tcfg.trace_x.push(new Date(date));\r\n\t\t\t\tcfg.trace_indexes[date.valueOf()] = cfg.trace_x.length - 1;\r\n\t\t\t});\r\n\r\n\t\t\tcfg.trace_x_ascending = cfg.trace_x.slice();\r\n\t\t\treturn cfg;\r\n\t\t},\r\n\t\titerateScales: function (lower_scale, upper_scale, from, to, callback) {\r\n\t\t\tvar upper_dates = upper_scale.trace_x;\r\n\t\t\tvar lower_dates = lower_scale.trace_x;\r\n\r\n\t\t\tvar prev = from || 0;\r\n\t\t\tvar end = to || (lower_dates.length - 1);\r\n\t\t\tvar prevUpper = 0;\r\n\r\n\r\n\t\t\tfor (var up = 1; up < upper_dates.length; up++) {\r\n\t\t\t\tvar target_index = (lower_scale.trace_indexes[+upper_dates[up]]);\r\n\t\t\t\tif (target_index !== undefined && target_index <= end) {\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tcallback.apply(this, [prevUpper, up, prev, target_index]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprev = target_index;\r\n\t\t\t\t\tprevUpper = up;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\talineScaleColumns: function (lower_scale, upper_scale, from, to) {\r\n\t\t\tthis.iterateScales(lower_scale, upper_scale, from, to, function (upper_start, upper_end, lower_start, lower_end) {\r\n\t\t\t\tvar targetWidth = this.getSum(lower_scale.width, lower_start, lower_end - 1);\r\n\t\t\t\tvar actualWidth = this.getSum(upper_scale.width, upper_start, upper_end - 1);\r\n\t\t\t\tif (actualWidth != targetWidth) {\r\n\t\t\t\t\tthis.setSumWidth(targetWidth, upper_scale, upper_start, upper_end - 1);\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\teachColumn: function (unit, step, min_date, max_date, callback) {\r\n\t\t\tvar start = new Date(min_date),\r\n\t\t\t\tend = new Date(max_date);\r\n\t\t\tif (dateHelper[unit + \"_start\"]) {\r\n\t\t\t\tstart = dateHelper[unit + \"_start\"](start);\r\n\t\t\t}\r\n\r\n\t\t\tvar curr = new Date(start);\r\n\t\t\tif (+curr >= +end) {\r\n\t\t\t\tend = dateHelper.add(curr, step, unit);\r\n\t\t\t}\r\n\t\t\twhile (+curr < +end) {\r\n\t\t\t\tcallback.call(this, new Date(curr));\r\n\t\t\t\tvar tzOffset = curr.getTimezoneOffset();\r\n\t\t\t\tcurr = dateHelper.add(curr, step, unit);\r\n\t\t\t\tcurr = gantt._correct_dst_change(curr, tzOffset, step, unit);\r\n\t\t\t\tif (dateHelper[unit + '_start'])\r\n\t\t\t\t\tcurr = dateHelper[unit + \"_start\"](curr);\r\n\t\t\t}\r\n\t\t},\r\n\t\tlimitVisibleRange: function (cfg) {\r\n\t\t\tvar dates = cfg.trace_x;\r\n\r\n\t\t\tvar left = 0, right = cfg.width.length - 1;\r\n\t\t\tvar diff = 0;\r\n\t\t\tif (+dates[0] < +cfg.min_date && left != right) {\r\n\t\t\t\tvar width = Math.floor(cfg.width[0] * ((dates[1] - cfg.min_date) / (dates[1] - dates[0])));\r\n\t\t\t\tdiff += cfg.width[0] - width;\r\n\t\t\t\tcfg.width[0] = width;\r\n\r\n\t\t\t\tdates[0] = new Date(cfg.min_date);\r\n\t\t\t}\r\n\r\n\t\t\tvar last = dates.length - 1;\r\n\t\t\tvar lastDate = dates[last];\r\n\t\t\tvar outDate = dateHelper.add(lastDate, cfg.step, cfg.unit);\r\n\t\t\tif (+outDate > +cfg.max_date && last > 0) {\r\n\t\t\t\tvar width = cfg.width[last] - Math.floor(cfg.width[last] * ((outDate - cfg.max_date) / (outDate - lastDate)));\r\n\t\t\t\tdiff += cfg.width[last] - width;\r\n\t\t\t\tcfg.width[last] = width;\r\n\t\t\t}\r\n\r\n\t\t\tif (diff) {\r\n\t\t\t\tvar full = this.getSum(cfg.width);\r\n\t\t\t\tvar shared = 0;\r\n\t\t\t\tfor (var i = 0; i < cfg.width.length; i++) {\r\n\t\t\t\t\tvar share = Math.floor(diff * (cfg.width[i] / full));\r\n\t\t\t\t\tcfg.width[i] += share;\r\n\t\t\t\t\tshared += share;\r\n\t\t\t\t}\r\n\t\t\t\tthis.adjustSize(diff - shared, cfg.width);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default ScaleHelper;\r\n","import ScaleHelper from \"./ui/timeline/scales_ignore\";\r\nimport PrimaryScaleHelper from \"./ui/timeline/scales\";\r\n\r\nfunction resolveConfigRange(unit, gantt){\r\n\tvar range = {\r\n\t\tstart_date:null,\r\n\t\tend_date:null\r\n\t};\r\n\r\n\tif (gantt.config.start_date && gantt.config.end_date) {\r\n\t\trange.start_date = gantt.date[unit + \"_start\"](new Date(gantt.config.start_date));\r\n\r\n\t\tvar end = new Date(gantt.config.end_date);\r\n\t\tvar start_interval = gantt.date[unit + \"_start\"](new Date(end));\r\n\t\tif (+end != +start_interval) {\r\n\t\t\tend = gantt.date.add(start_interval, 1, unit);\r\n\t\t} else {\r\n\t\t\tend = start_interval;\r\n\t\t}\r\n\r\n\t\trange.end_date = end;\r\n\t}\r\n\treturn range;\r\n}\r\n\r\nfunction _scale_range_unit(gantt) {\r\n\tvar primaryScale = (new PrimaryScaleHelper(gantt)).primaryScale();\r\n\tvar unit = primaryScale.unit;\r\n\tvar step = primaryScale.step;\r\n\tif (gantt.config.scale_offset_minimal) {\r\n\r\n\t\tvar helper = new ScaleHelper(gantt);\r\n\t\tvar scales = [helper.primaryScale()].concat(helper.getSubScales());\r\n\r\n\t\thelper.sortScales(scales);\r\n\t\tunit = scales[scales.length - 1].unit;\r\n\t\tstep = scales[scales.length - 1].step || 1;\r\n\t}\r\n\treturn { unit:unit, step:step };\r\n}\r\n\r\nfunction _init_tasks_range(gantt) {\r\n\tvar cfg = _scale_range_unit(gantt);\r\n\tvar unit = cfg.unit,\r\n\t\tstep = cfg.step;\r\n\tvar range = resolveConfigRange(unit, gantt);\r\n\r\n\t// GS-1544: Show correct date range if we have tasks or only projects\r\n\tif(!(range.start_date && range.end_date)){\r\n\t\tvar onlyProjectTasks = true;\r\n\t\tvar tasks = gantt.getTaskByTime();\r\n\t\tfor (var i = 0; i < tasks.length; i++) {\r\n\t\t\tvar task = tasks[i];\r\n\t\t\tif (task.type !== gantt.config.types.project){\r\n\t\t\t\tonlyProjectTasks = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (tasks.length && onlyProjectTasks){\r\n\t\t\tvar start_date = tasks[0].start_date;\r\n\t\t\tvar end_date = gantt.date.add(start_date, 1, gantt.config.duration_unit);\r\n\t\t\trange = {\r\n\t\t\t\tstart_date: new Date(start_date),\r\n\t\t\t\tend_date: new Date(end_date)\r\n\t\t\t};\r\n\t\t} else{\r\n\t\t\trange = gantt.getSubtaskDates();\r\n\t\t}\r\n\r\n\t\tif(!range.start_date || !range.end_date){\r\n\t\t\trange = {\r\n\t\t\t\tstart_date: new Date(),\r\n\t\t\t\tend_date: new Date()\r\n\t\t\t};\r\n\t\t}\r\n\t\t// extend the displayed date range including the constraints, deadlines and baselines\r\n\t\tgantt.eachTask(function(task){\r\n\t\t\tif (gantt.config.deadlines && task.deadline){\r\n\t\t\t\textendRangeForDates(range, task.deadline, task.deadline);\r\n\t\t\t}\r\n\t\t\tif (task.constraint_date && task.constraint_type){\r\n\t\t\t\tif (gantt.config.constraint_types && task.constraint_type !== gantt.config.constraint_types.ASAP && task.constraint_type !== gantt.config.constraint_types.ALAP){\r\n\t\t\t\t\textendRangeForDates(range, task.constraint_date, task.constraint_date);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (gantt.config.baselines && task.baselines){\r\n\t\t\t\ttask.baselines.forEach(function(baseline){\r\n\t\t\t\t\textendRangeForDates(range, baseline.start_date, baseline.end_date);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\trange.start_date = gantt.date[unit + \"_start\"](range.start_date);\r\n\t\trange.start_date = gantt.calculateEndDate({\r\n\t\t\tstart_date: gantt.date[unit + \"_start\"](range.start_date),\r\n\t\t\tduration: -1,\r\n\t\t\tunit: unit,\r\n\t\t\tstep:step\r\n\t\t});//one free column before first task\r\n\r\n\t\trange.end_date = gantt.date[unit + \"_start\"](range.end_date);\r\n\t\trange.end_date = gantt.calculateEndDate({start_date: range.end_date, duration: 2, unit: unit, step:step});//one free column after last task\r\n\t}\r\n\r\n\tgantt._min_date = range.start_date;\r\n\tgantt._max_date = range.end_date;\r\n}\r\n\r\nfunction extendRangeForDates(range, start_date, end_date){\r\n\tif (start_date < range.start_date){\r\n\t\trange.start_date = new Date(start_date);\r\n\t}\r\n\tif (end_date > range.end_date){\r\n\t\trange.end_date = new Date(end_date);\r\n\t}\r\n}\r\n\r\nfunction _adjust_scales(gantt) {\r\n\tif (gantt.config.fit_tasks) {\r\n\t\tvar old_min = +gantt._min_date,\r\n\t\t\told_max = +gantt._max_date;\r\n\t\t//this._init_tasks_range();\r\n\t\tif (+gantt._min_date != old_min || +gantt._max_date != old_max) {\r\n\t\t\tgantt.render();\r\n\r\n\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nexport default function updateTasksRange(gantt){\r\n\t_init_tasks_range(gantt);\r\n\t_adjust_scales(gantt);\r\n};\r\n","function copyLinkIdsArray(gantt, linkIds, targetHash){\r\n\tfor(var i = 0; i < linkIds.length; i++) {\r\n\t\tif(gantt.isLinkExists(linkIds[i])){\r\n\t\t\ttargetHash[linkIds[i]] = gantt.getLink(linkIds[i]);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction copyLinkIds(gantt, task, targetHash){\r\n\tcopyLinkIdsArray(gantt, task.$source, targetHash);\r\n\tcopyLinkIdsArray(gantt, task.$target, targetHash);\r\n}\r\n\r\nfunction getSubtreeLinks(gantt, rootId){\r\n\tvar res = {};\r\n\r\n\tif(gantt.isTaskExists(rootId)){\r\n\t\tcopyLinkIds(gantt, gantt.getTask(rootId), res);\r\n\t}\r\n\r\n\tgantt.eachTask(function(child){\r\n\t\tcopyLinkIds(gantt, child, res);\r\n\t}, rootId);\r\n\r\n\treturn res;\r\n}\r\n\r\nfunction getSubtreeTasks(gantt, rootId){\r\n\tvar res = {};\r\n\r\n\tgantt.eachTask(function(child){\r\n\t\tres[child.id] = child;\r\n\t}, rootId);\r\n\r\n\treturn res;\r\n}\r\n\r\nexport default {\r\n\tgetSubtreeLinks: getSubtreeLinks,\r\n\tgetSubtreeTasks: getSubtreeTasks\r\n};","import * as helpers from \"../../utils/helpers\";\r\nimport treeHelper from \"../../utils/task_tree_helpers\";\r\n\r\n\r\nexport default class DataProcessorEvents {\r\n\tprotected _dataProcessorHandlers: any[];\r\n\tprotected $gantt: any;\r\n\tprotected $dp: any;\r\n\r\n\tconstructor(gantt: any, dp: any) {\r\n\t\tthis.$gantt = gantt;\r\n\t\tthis.$dp = dp;\r\n\t\tthis._dataProcessorHandlers = [];\r\n\t}\r\n\r\n\tattach() {\r\n\t\tconst dp = this.$dp;\r\n\t\tconst gantt = this.$gantt;\r\n\t\tconst cascadeDelete = {};\r\n\r\n\t\tconst clientSideDelete = (id) => {\r\n\t\t\treturn this.clientSideDelete(id, dp, gantt);\r\n\t\t};\r\n\r\n\t\tfunction getTaskLinks(task) {\r\n\t\t\tlet _links = [];\r\n\r\n\t\t\tif (task.$source) {\r\n\t\t\t\t_links = _links.concat(task.$source);\r\n\t\t\t}\r\n\t\t\tif (task.$target) {\r\n\t\t\t\t_links = _links.concat(task.$target);\r\n\t\t\t}\r\n\r\n\t\t\treturn _links;\r\n\t\t}\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskAdd\", function(id, item) { // tslint:disable-line\r\n\t\t\tif (gantt.isTaskExists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"tasks\");\r\n\t\t\t\tdp.setUpdated(id, true, \"inserted\");\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskUpdate\", function(id, item) { // tslint:disable-line\r\n\t\t\tif (gantt.isTaskExists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"tasks\");\r\n\t\t\t\tdp.setUpdated(id, true);\r\n\r\n\t\t\t\t// gantt can be destroyed/reinitialized after dp.setUpdated\r\n\t\t\t\tif(gantt._sendTaskOrder){\r\n\t\t\t\t\tgantt._sendTaskOrder(id, item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onBeforeTaskDelete\", function(id, item) { // tslint:disable-line\r\n\t\t\tif (gantt.config.cascade_delete) {\r\n\t\t\t\tcascadeDelete[id] = {\r\n\t\t\t\t\ttasks: treeHelper.getSubtreeTasks(gantt, id),\r\n\t\t\t\t\tlinks: treeHelper.getSubtreeLinks(gantt, id)\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\t// GS-631. Keep the deleted item in Gantt until we receive the successful response from the server\r\n\t\t\tif (dp.deleteAfterConfirmation) {\r\n\t\t\t\tdp.setGanttMode(\"tasks\");\r\n\t\t\t\tdp.setUpdated(id, true, \"deleted\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskDelete\", function(id, item) { // tslint:disable-line\r\n\t\t\tdp.setGanttMode(\"tasks\");\r\n\r\n\t\t\t// not send delete request if item is not inserted into the db - just remove it from the client\r\n\t\t\tconst needDbDelete = !clientSideDelete(id);\r\n\t\t\tconst needCascadeDelete = gantt.config.cascade_delete && cascadeDelete[id];\r\n\t\t\tif (!needDbDelete && !needCascadeDelete) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (needCascadeDelete) {\r\n\t\t\t\tconst dpMode = dp.updateMode;\r\n\t\t\t\tdp.setUpdateMode(\"off\");\r\n\r\n\t\t\t\tconst cascade = cascadeDelete[id];\r\n\t\t\t\tfor (const i in cascade.tasks) {\r\n\t\t\t\t\tif (!clientSideDelete(i)) {\r\n\t\t\t\t\t\tdp.storeItem(cascade.tasks[i]);\r\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tdp.setGanttMode(\"links\");\r\n\t\t\t\tfor (const i in cascade.links) {\r\n\t\t\t\t\tif (!clientSideDelete(i)) {\r\n\t\t\t\t\t\tdp.storeItem(cascade.links[i]);\r\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcascadeDelete[id] = null;\r\n\r\n\t\t\t\tif (dpMode !== \"off\") {\r\n\t\t\t\t\tdp.sendAllData();\r\n\t\t\t\t}\r\n\t\t\t\tdp.setGanttMode(\"tasks\");\r\n\t\t\t\tdp.setUpdateMode(dpMode);\r\n\t\t\t}\r\n\r\n\t\t\tif (needDbDelete){\r\n\t\t\t\tdp.storeItem(item);\r\n\t\t\t\tif (!dp.deleteAfterConfirmation){\r\n\t\t\t\t\tdp.setUpdated(id, true, \"deleted\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tif (dp.updateMode !== \"off\" && !dp._tSend) {\r\n\t\t\t\tdp.sendAllData();\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkUpdate\", function(id, item) { // tslint:disable-line\r\n\t\t\tif (gantt.isLinkExists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"links\");\r\n\t\t\t\tdp.setUpdated(id, true);\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkAdd\", function(id, item) { // tslint:disable-line\r\n\t\t\tif (gantt.isLinkExists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"links\");\r\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkDelete\", function(id, item) { // tslint:disable-line\r\n\t\t\tdp.setGanttMode(\"links\");\r\n\r\n\t\t\tconst needDbDelete = !clientSideDelete(id);\r\n\t\t\tif (!needDbDelete) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdp.storeItem(item);\r\n\t\t\tdp.setUpdated(id, true,\"deleted\");\r\n\t\t}));\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onRowDragEnd\", function(id, target) { // tslint:disable-line\r\n\t\t\tgantt._sendTaskOrder(id, gantt.getTask(id));\r\n\t\t}));\r\n\r\n\t\tlet tasks = null;\r\n\t\tlet links = null;\r\n\r\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onTaskIdChange\", function(oldId, newId) { // tslint:disable-line\r\n\t\t\tif (!dp._waitMode) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst children = gantt.getChildren(newId);\r\n\t\t\tif (children.length) {\r\n\t\t\t\ttasks = tasks || {};\r\n\r\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\r\n\t\t\t\t\tconst ch = this.getTask(children[i]);\r\n\t\t\t\t\ttasks[ch.id] = ch;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst item = this.getTask(newId);\r\n\t\t\tconst itemLinks = getTaskLinks(item);\r\n\r\n\t\t\tif (itemLinks.length) {\r\n\t\t\t\tlinks = links || {};\r\n\r\n\t\t\t\tfor (let i = 0; i < itemLinks.length; i++) {\r\n\t\t\t\t\tconst link = this.getLink(itemLinks[i]);\r\n\t\t\t\t\tlinks[link.id] = link;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}));\r\n\r\n\t\tdp.attachEvent(\"onAfterUpdateFinish\", function() {\r\n\t\t\tif (tasks || links) {\r\n\t\t\t\tgantt.batchUpdate(function() {\r\n\t\t\t\t\tfor (const id in tasks) {\r\n\t\t\t\t\t\tgantt.updateTask(tasks[id].id);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (const id in links) {\r\n\t\t\t\t\t\tgantt.updateLink(links[id].id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttasks = null;\r\n\t\t\t\t\tlinks = null;\r\n\t\t\t\t});\r\n\t\t\t\tif (tasks) {\r\n\t\t\t\t\tgantt._dp.setGanttMode(\"tasks\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgantt._dp.setGanttMode(\"links\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdp.attachEvent(\"onBeforeDataSending\", function() {\r\n\t\t\tif (this._tMode === \"CUSTOM\") {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tlet url = this._serverProcessor;\r\n\t\t\tif (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\r\n\t\t\t\tconst mode = this._ganttMode;\r\n\r\n\t\t\t\turl = url.substring(0, url.indexOf(\"?\") > -1 ? url.indexOf(\"?\") : url.length);\r\n\t\t\t\t// editing=true&\r\n\t\t\t\tthis.serverProcessor = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + mode;\r\n\t\t\t} else {\r\n\t\t\t\tconst pluralizedMode = this._ganttMode + \"s\";\r\n\t\t\t\tthis.serverProcessor = url + gantt.ajax.urlSeparator(url) + \"gantt_mode=\" + pluralizedMode;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tdp.attachEvent(\"insertCallback\", function insertCallback(upd, id, parent, mode) { // tslint:disable-line\r\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\r\n\t\t\tconst methods = {\r\n\t\t\t\tadd: gantt.addTask,\r\n\t\t\t\tisExist: gantt.isTaskExists\r\n\t\t\t};\r\n\t\t\tif (mode === \"links\") {\r\n\t\t\t\tmethods.add = gantt.addLink;\r\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\r\n\t\t\t}\r\n\t\t\tif (methods.isExist.call(gantt, id)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdata.id = id;\r\n\t\t\tmethods.add.call(gantt, data);\r\n\t\t});\r\n\r\n\t\tdp.attachEvent(\"updateCallback\", function updateCallback(upd, id) {\r\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\r\n\t\t\tif (!gantt.isTaskExists(id)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst objData = gantt.getTask(id);\r\n\t\t\tfor (const key in data) {\r\n\t\t\t\tlet property = data[key];\r\n\t\t\t\tswitch (key) {\r\n\t\t\t\t\tcase \"id\":\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tcase \"start_date\":\r\n\t\t\t\t\tcase \"end_date\":\r\n\t\t\t\t\t\tproperty = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date(property) : gantt.templates.parse_date(property);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"duration\":\r\n\t\t\t\t\t\tobjData.end_date = gantt.calculateEndDate({start_date: objData.start_date, duration: property, task:objData});\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tobjData[key] = property;\r\n\t\t\t}\r\n\t\t\tgantt.updateTask(id);\r\n\t\t\tgantt.refreshData();\r\n\t\t});\r\n\t\tdp.attachEvent(\"deleteCallback\", function deleteCallback(upd, id, parent, mode) { // tslint:disable-line\r\n\t\t\tconst methods = {\r\n\t\t\t\tdelete: gantt.deleteTask,\r\n\t\t\t\tisExist: gantt.isTaskExists\r\n\t\t\t};\r\n\t\t\tif (mode === \"links\") {\r\n\t\t\t\tmethods.delete = gantt.deleteLink;\r\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\r\n\t\t\t} else if(mode === \"assignment\") {\r\n\t\t\t\tmethods.delete = function(val) {\r\n\t\t\t\t\tgantt.$data.assignmentsStore.remove(val);\r\n\t\t\t\t};\r\n\t\t\t\tmethods.isExist = function(val){\r\n\t\t\t\t\treturn gantt.$data.assignmentsStore.exists(val);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tif (methods.isExist.call(gantt, id)) {\r\n\t\t\t\tmethods.delete.call(gantt, id);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.handleResourceCRUD(dp, gantt);\r\n\t\tthis.handleResourceAssignmentCRUD(dp, gantt);\r\n\t\tthis.handleBaselineCRUD(dp, gantt);\r\n\t}\r\n\r\n\tclientSideDelete(id, dp, gantt){\r\n\t\tconst updated = dp.updatedRows.slice();\r\n\t\tlet clientOnly = false;\r\n\r\n\t\tif(gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"true_deleted\"){\r\n\t\t\tclientOnly = true;\r\n\t\t\tdp.setUpdated(id,false);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < updated.length && !dp._in_progress[id]; i++) {\r\n\t\t\tif (updated[i] === id) {\r\n\t\t\t\tif (gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"inserted\") {\r\n\t\t\t\t\tclientOnly = true;\r\n\t\t\t\t}\r\n\t\t\t\tdp.setUpdated(id,false);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn clientOnly;\r\n\t}\r\n\r\n\thandleResourceAssignmentCRUD(dp, gantt){\r\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_assignments !== true){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst assignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);\r\n\t\tconst insertedTasks = {};\r\n\t\tconst pendingAssignments = {};\r\n\r\n\t\tgantt.attachEvent(\"onBeforeTaskAdd\", function(id, task){\r\n\t\t\tinsertedTasks[id] = true;\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tfunction putAssignmentToQueue(item){\r\n\t\t\tpendingAssignments[item.id] = item;\r\n\t\t\tinsertedTasks[item.task_id] = true;\r\n\t\t}\r\n\r\n\t\tfunction insertResourceAssignment(assignment){\r\n\t\t\tconst id = assignment.id;\r\n\t\t\tif (assignmentsStore.exists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"assignment\");\r\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\r\n\t\t\t}\r\n\t\t\tdelete pendingAssignments[id];\r\n\t\t}\r\n\r\n\t\tgantt.attachEvent(\"onTaskIdChange\", function(id, newId){\r\n\t\t\tdelete insertedTasks[id];\r\n\t\t});\r\n\r\n\t\tassignmentsStore.attachEvent(\"onAfterAdd\", (id, item) => {\r\n\t\t\tif(insertedTasks[item.task_id]){\r\n\t\t\t\t// inserting assignment of new task\r\n\t\t\t\t// task is not saved yet, need to wait till it gets permanent id and save assigmnents after that\r\n\t\t\t\tputAssignmentToQueue(item);\r\n\t\t\t}else{\r\n\t\t\t\tinsertResourceAssignment(item);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tassignmentsStore.attachEvent(\"onAfterUpdate\", (id, item) => {\r\n\t\t\tif (assignmentsStore.exists(id)) {\r\n\t\t\t\tif(pendingAssignments[id]){\r\n\t\t\t\t\tinsertResourceAssignment(item);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdp.setGanttMode(\"assignment\");\r\n\t\t\t\t\tdp.setUpdated(id, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tassignmentsStore.attachEvent(\"onAfterDelete\", (id, item) => {\r\n\t\t\tdp.setGanttMode(\"assignment\");\r\n\r\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\r\n\t\t\tif (!needDbDelete) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdp.storeItem(item);\r\n\t\t\tdp.setUpdated(id, true,\"deleted\");\r\n\t\t});\r\n\r\n\t}\r\n\r\n\thandleResourceCRUD(dp, gantt){\r\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_resources !== true){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst resourcesStore = gantt.getDatastore(gantt.config.resource_store);\r\n\r\n\t\tfunction insertResource(resource){\r\n\t\t\tconst id = resource.id;\r\n\t\t\tif (resourcesStore.exists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"resource\");\r\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tresourcesStore.attachEvent(\"onAfterAdd\", (id, item) => {\r\n\t\t\tinsertResource(item);\r\n\t\t});\r\n\r\n\t\tresourcesStore.attachEvent(\"onAfterUpdate\", (id, item) => {\r\n\t\t\tif (resourcesStore.exists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"resource\");\r\n\t\t\t\tdp.setUpdated(id, true);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tresourcesStore.attachEvent(\"onAfterDelete\", (id, item) => {\r\n\t\t\tdp.setGanttMode(\"resource\");\r\n\r\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\r\n\t\t\tif (!needDbDelete) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdp.storeItem(item);\r\n\t\t\tdp.setUpdated(id, true,\"deleted\");\r\n\t\t});\r\n\r\n\t}\r\n\r\n\thandleBaselineCRUD(dp, gantt){\r\n\t\tif(!gantt.config.baselines || gantt.config.baselines.dataprocessor_baselines !== true){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst baselineStore = gantt.getDatastore(gantt.config.baselines.datastore);\r\n\r\n\t\tfunction insertResource(resource){\r\n\t\t\tconst id = resource.id;\r\n\t\t\tif (baselineStore.exists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"baseline\");\r\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbaselineStore.attachEvent(\"onAfterAdd\", (id, item) => {\r\n\t\t\tinsertResource(item);\r\n\t\t});\r\n\r\n\t\tbaselineStore.attachEvent(\"onAfterUpdate\", (id, item) => {\r\n\t\t\tif (baselineStore.exists(id)) {\r\n\t\t\t\tdp.setGanttMode(\"baseline\");\r\n\t\t\t\tdp.setUpdated(id, true);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tbaselineStore.attachEvent(\"onAfterDelete\", (id, item) => {\r\n\t\t\tdp.setGanttMode(\"baseline\");\r\n\r\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\r\n\t\t\tif (!needDbDelete) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdp.storeItem(item);\r\n\t\t\tdp.setUpdated(id, true,\"deleted\");\r\n\t\t});\r\n\t}\r\n\r\n\tdetach() {\r\n\t\thelpers.forEach(this._dataProcessorHandlers, (e) => {\r\n\t\t\tthis.$gantt.detachEvent(e);\r\n\t\t});\r\n\t\tthis._dataProcessorHandlers = [];\r\n\t}\r\n}\r\n","import * as utils from \"../../utils/utils\";\r\n\r\nexport default class SimpleStorage {\r\n\tpublic static create = () : SimpleStorage => {\r\n\t\treturn new SimpleStorage();\r\n\t};\r\n\r\n\tprotected _storage: { [id: string]: any; };\r\n\r\n\tprotected constructor() {\r\n\t\tthis._storage = {};\r\n\t}\r\n\r\n\tpublic clear = (): void => {\r\n\t\tthis._storage = {};\r\n\t};\r\n\r\n\tpublic storeItem = (item: any): void => {\r\n\t\tthis._storage[item.id] = utils.copy(item);\r\n\t};\r\n\r\n\tpublic getStoredItem = (id: string): any => {\r\n\t\treturn this._storage[id] || null;\r\n\t};\r\n}","import eventable from \"../../utils/eventable\";\r\nimport * as helpers from \"../../utils/helpers\";\r\nimport * as utils from \"../../utils/utils\";\r\nimport DataProcessorEvents from \"./data_processor_events\";\r\nimport extendGantt from \"./extend_gantt\";\r\nimport SimpleStorage from \"./simple_storage\";\r\nimport global from \"../../utils/global\";\r\n\r\nexport interface DataProcessor { // tslint:disable-line\r\n\t$gantt: any;\r\n\tdetachAllEvents: any;\r\n\tattachEvent: any;\r\n\tcallEvent: any;\r\n\r\n\tserverProcessor: string;\r\n\taction_param: string;\r\n\tupdatedRows: any[];\r\n\tautoUpdate: boolean;\r\n\tupdateMode: string;\r\n\tmessages: any[];\r\n\tstyles: object;\r\n\tdnd: any;\r\n\tdeleteAfterConfirmation?: any;\r\n}\r\n\r\nexport function createDataProcessor(config: any) {\r\n\tlet router;\r\n\tlet tMode;\r\n\tlet headers;\r\n\tif (config instanceof Function) {\r\n\t\trouter = config;\r\n\t} else if (config.hasOwnProperty(\"router\")) {\r\n\t\trouter = config.router;\r\n\t} else if (config.hasOwnProperty(\"assignment\") || config.hasOwnProperty(\"baseline\") || config.hasOwnProperty(\"link\") || config.hasOwnProperty(\"task\")) {\r\n\t\trouter = config;\r\n\t} else if(config.hasOwnProperty(\"headers\")){\r\n\t\t// GS-2312 for custom headers\r\n\t\theaders = config.headers;\r\n\t}\r\n\tif (router) {\r\n\t\ttMode = \"CUSTOM\";\r\n\t} else {\r\n\t\ttMode = config.mode || \"REST-JSON\";\r\n\t}\r\n\tconst gantt = this; // tslint:disable-line\r\n\tconst dp = new DataProcessor(config.url);\r\n\r\n\r\n\tdp.init(gantt);\r\n\tdp.setTransactionMode({\r\n\t\tmode: tMode,\r\n\t\trouter,\r\n\t\theaders\r\n\t}, config.batchUpdate);\r\n\tif(config.deleteAfterConfirmation){\r\n\t\tdp.deleteAfterConfirmation = config.deleteAfterConfirmation;\r\n\t}\r\n\treturn dp;\r\n}\r\n\r\nexport class DataProcessor {\r\n\tpublic modes: object;\r\n\tpublic serverProcessor: string;\r\n\tpublic action_param: string; // tslint:disable-line\r\n\tpublic updatedRows: any[];\r\n\tpublic autoUpdate: boolean;\r\n\tpublic updateMode: string;\r\n\tpublic messages: any[];\r\n\tpublic styles: object;\r\n\tpublic dnd: any;\r\n\r\n\tprotected _tMode: string;\r\n\tprotected _headers: any;\r\n\tprotected _payload: any;\r\n\tprotected _postDelim: string;\r\n\tprotected _waitMode: number;\r\n\tprotected _in_progress: object; // tslint:disable-line\r\n\tprotected _invalid: object;\r\n\tprotected _storage: SimpleStorage;\r\n\tprotected _tSend: boolean;\r\n\tprotected _serializeAsJson: boolean;\r\n\tprotected _router: any;\r\n\tprotected _utf: boolean;\r\n\tprotected _methods: any[];\r\n\tprotected _user: any;\r\n\tprotected _uActions: object;\r\n\tprotected _needUpdate: boolean;\r\n\tprotected _ganttMode: \"task\"|\"link\";\r\n\tprotected _routerParametersFormat: \"parameters\"|\"object\";\r\n\r\n\tprotected _silent_mode: any; // tslint:disable-line\r\n\tprotected _updateBusy: any;\r\n\tprotected _serverProcessor: any;\r\n\tprotected _initialized: boolean;\r\n\r\n\tconstructor(serverProcessorURL?) {\r\n\t\tthis.serverProcessor = serverProcessorURL;\r\n\t\tthis.action_param = \"!nativeeditor_status\";\r\n\r\n\t\tthis.updatedRows = []; // ids of updated rows\r\n\r\n\t\tthis.autoUpdate = true;\r\n\t\tthis.updateMode = \"cell\";\r\n\t\tthis._headers = null;\r\n\t\tthis._payload = null;\r\n\t\tthis._postDelim = \"_\";\r\n\t\tthis._routerParametersFormat = \"parameters\";\r\n\r\n\t\tthis._waitMode = 0;\r\n\t\tthis._in_progress = {}; // ?\r\n\t\tthis._storage = SimpleStorage.create();\r\n\t\tthis._invalid = {};\r\n\t\tthis.messages = [];\r\n\r\n\t\tthis.styles = {\r\n\t\t\tupdated: \"font-weight:bold;\",\r\n\t\t\tinserted: \"font-weight:bold;\",\r\n\t\t\tdeleted: \"text-decoration : line-through;\",\r\n\t\t\tinvalid: \"background-color:FFE0E0;\",\r\n\t\t\tinvalid_cell: \"border-bottom:2px solid red;\",\r\n\t\t\terror: \"color:red;\",\r\n\t\t\tclear: \"font-weight:normal;text-decoration:none;\"\r\n\t\t};\r\n\t\tthis.enableUTFencoding(true);\r\n\t\teventable(this);\r\n\t}\r\n\r\n\tsetTransactionMode(mode:any, total?:any) {\r\n\t\tif (typeof mode === \"object\") {\r\n\t\t\tthis._tMode = mode.mode || this._tMode;\r\n\r\n\t\t\tif (utils.defined(mode.headers)) {\r\n\t\t\t\tthis._headers = mode.headers;\r\n\t\t\t}\r\n\r\n\t\t\tif (utils.defined(mode.payload)) {\r\n\t\t\t\tthis._payload = mode.payload;\r\n\t\t\t}\r\n\t\t\tthis._tSend = !!total;\r\n\t\t} else {\r\n\t\t\tthis._tMode = mode;\r\n\t\t\tthis._tSend = total;\r\n\t\t}\r\n\r\n\t\tif (this._tMode === \"REST\") {\r\n\t\t\tthis._tSend = false;\r\n\t\t}\r\n\r\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\r\n\t\t\tthis._tSend = false;\r\n\t\t\tthis._serializeAsJson = true;\r\n\t\t\tthis._headers = this._headers || {};\r\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\r\n\t\t}else{\r\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\r\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this._tMode === \"CUSTOM\") {\r\n\t\t\tthis._tSend = false;\r\n\t\t\tthis._router = mode.router;\r\n\t\t}\r\n\t}\r\n\r\n\tescape(data:any) {\r\n\t\tif (this._utf) {\r\n\t\t\treturn encodeURIComponent(data);\r\n\t\t} else {\r\n\t\t\treturn escape(data);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: allows to set escaping mode\r\n\t * @param: true - utf based escaping, simple - use current page encoding\r\n\t * @type: public\r\n\t */\r\n\tenableUTFencoding(mode:boolean) {\r\n\t\tthis._utf = !!mode;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: get state of updating\r\n\t * @returns:   true - all in sync with server, false - some items not updated yet.\r\n\t * @type: public\r\n\t */\r\n\tgetSyncState() {\r\n\t\treturn !this.updatedRows.length;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: set if rows should be send to server automatically\r\n\t * @param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\r\n\t * @type: public\r\n\t */\r\n\tsetUpdateMode(mode: string, dnd: any) {\r\n\t\tthis.autoUpdate = (mode === \"cell\");\r\n\t\tthis.updateMode = mode;\r\n\t\tthis.dnd = dnd;\r\n\t}\r\n\r\n\tignore(code: any, master: any) {\r\n\t\tthis._silent_mode = true;\r\n\t\tcode.call(master || global);\r\n\t\tthis._silent_mode = false;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: mark row as updated/normal. check mandatory fields, initiate autoupdate (if turned on)\r\n\t * @param: rowId - id of row to set update-status for\r\n\t * @param: state - true for \"updated\", false for \"not updated\"\r\n\t * @param: mode - update mode name\r\n\t * @type: public\r\n\t */\r\n\tsetUpdated(rowId:number|string, state: boolean, mode?: string) {\r\n\t\tif (this._silent_mode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst ind = this.findRow(rowId);\r\n\r\n\t\tmode = mode || \"updated\";\r\n\t\tconst existing = this.$gantt.getUserData(rowId, this.action_param, this._ganttMode);\r\n\t\tif (existing && mode === \"updated\") {\r\n\t\t\tmode = existing;\r\n\t\t}\r\n\t\tif (state) {\r\n\t\t\tthis.set_invalid(rowId, false); // clear previous error flag\r\n\t\t\tthis.updatedRows[ind] = rowId;\r\n\t\t\tthis.$gantt.setUserData(rowId, this.action_param, mode, this._ganttMode);\r\n\t\t\tif (this._in_progress[rowId]) {\r\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (!this.is_invalid(rowId)) {\r\n\t\t\t\tthis.updatedRows.splice(ind, 1);\r\n\t\t\t\tthis.$gantt.setUserData(rowId, this.action_param, \"\", this._ganttMode);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.markRow(rowId, state, mode);\r\n\t\tif (state && this.autoUpdate) {\r\n\t\t\tthis.sendData(rowId);\r\n\t\t}\r\n\t}\r\n\r\n\tmarkRow(id: number | string, state: boolean, mode: string) {\r\n\t\tlet str = \"\";\r\n\t\tconst invalid = this.is_invalid(id);\r\n\t\tif (invalid) {\r\n\t\t\tstr = this.styles[invalid];\r\n\t\t\tstate = true;\r\n\t\t}\r\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\r\n\t\t\t// default logic\r\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + \" \" + str;\r\n\r\n\t\t\tthis.$gantt[this._methods[0]](id, str);\r\n\r\n\t\t\tif (invalid && invalid.details) {\r\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\r\n\t\t\t\tfor (let i = 0; i < invalid.details.length; i++) {\r\n\t\t\t\t\tif (invalid.details[i]) {\r\n\t\t\t\t\t\tthis.$gantt[this._methods[1]](id, i, str);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgetActionByState(state: string):string {\r\n\t\tif (state === \"inserted\") {\r\n\t\t\treturn \"create\";\r\n\t\t}\r\n\r\n\t\tif (state === \"updated\") {\r\n\t\t\treturn \"update\";\r\n\t\t}\r\n\r\n\t\tif (state === \"deleted\") {\r\n\t\t\treturn \"delete\";\r\n\t\t}\r\n\r\n\t\t// reorder\r\n\t\treturn \"update\";\r\n\t}\r\n\r\n\tgetState(id: number | string) {\r\n\t\treturn this.$gantt.getUserData(id, this.action_param, this._ganttMode);\r\n\t}\r\n\r\n\tis_invalid(id: number | string) {\r\n\t\treturn this._invalid[id];\r\n\t}\r\n\r\n\tset_invalid(id: number | string, mode: any, details?) {\r\n\t\tif (details) {\r\n\t\t\tmode = {\r\n\t\t\t\tvalue: mode,\r\n\t\t\t\tdetails,\r\n\t\t\t\ttoString: function() { // tslint:disable-line\r\n\t\t\t\t\treturn this.value.toString();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tthis._invalid[id] = mode;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: check mandatory fields and verify values of cells, initiate update (if specified). Can be redefined in order to provide custom validation\r\n\t * @param: rowId - id of row to set update-status for\r\n\t * @type: public\r\n\t */\r\n\t// tslint:disable-next-line\r\n\tcheckBeforeUpdate(rowId: number | string) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: send row(s) values to server\r\n\t * @param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\r\n\t * @type: public\r\n\t */\r\n\tsendData(rowId?: any) {\r\n\t\tif (this.$gantt.editStop) {\r\n\t\t\tthis.$gantt.editStop();\r\n\t\t}\r\n\r\n\t\tif (typeof rowId === \"undefined\" || this._tSend) {\r\n\r\n\t\t\tconst pendingUpdateModes = [];\r\n\t\t\tif(this.modes){\r\n\t\t\t\tconst knownModes = [\"task\", \"link\", \"assignment\", \"baseline\"];\r\n\t\t\t\tknownModes.forEach((mode) => {\r\n\t\t\t\t\tif(this.modes[mode] && this.modes[mode].updatedRows.length){\r\n\t\t\t\t\t\tpendingUpdateModes.push(mode);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (pendingUpdateModes.length){\r\n\t\t\t\tfor(let i = 0; i < pendingUpdateModes.length; i++){\r\n\t\t\t\t\tthis.setGanttMode(pendingUpdateModes[i]);\r\n\t\t\t\t\tthis.sendAllData();\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.sendAllData();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this._in_progress[rowId]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.messages = [];\r\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\r\n\t}\r\n\r\n\tserialize(data: any, id: any) {\r\n\t\tif (this._serializeAsJson) {\r\n\t\t\treturn  this._serializeAsJSON(data);\r\n\t\t}\r\n\r\n\t\tif (typeof data === \"string\") {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\tif (typeof id !== \"undefined\") {\r\n\t\t\treturn this.serialize_one(data, \"\");\r\n\t\t} else {\r\n\t\t\tconst stack = [];\r\n\t\t\tconst keys = [];\r\n\t\t\tfor (const key in data) {\r\n\t\t\t\tif (data.hasOwnProperty(key)) {\r\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this._postDelim));\r\n\t\t\t\t\tkeys.push(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\r\n\t\t\tif (this.$gantt.security_key) {\r\n\t\t\t\tstack.push(\"dhx_security=\" + this.$gantt.security_key);\r\n\t\t\t}\r\n\t\t\treturn stack.join(\"&\");\r\n\t\t}\r\n\t}\r\n\r\n\tserialize_one(data: any, pref: string) {\r\n\t\tif (typeof data === \"string\") {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\tconst stack: string[] = [];\r\n\t\tlet serialized = \"\";\r\n\t\tfor (const key in data)\r\n\t\t\tif (data.hasOwnProperty(key)) {\r\n\t\t\t\tif ((key === \"id\" ||\r\n\t\t\t\t\tkey == this.action_param) && // tslint:disable-line\r\n\t\t\t\t\tthis._tMode === \"REST\") {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\r\n\t\t\t\t\tserialized = String(data[key]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\r\n\t\t\t\t}\r\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\r\n\t\t\t}\r\n\t\treturn stack.join(\"&\");\r\n\t}\r\n\r\n\tsendAllData() {\r\n\t\tif (!this.updatedRows.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.messages = [];\r\n\t\tlet valid: any = true;\r\n\r\n\t\tthis._forEachUpdatedRow(function(rowId) {\r\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\r\n\t\t});\r\n\r\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this._tSend) {\r\n\t\t\tthis._sendData(this._getAllData());\r\n\t\t} else {\r\n\t\t\t// this.updatedRows can be spliced from onBeforeUpdate via dp.setUpdated false\r\n\t\t\t// use an iterator instead of for(var i = 0; i < this.updatedRows; i++) then\r\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\r\n\t\t\t\tif (!this._in_progress[rowId]) {\r\n\t\t\t\t\tif (this.is_invalid(rowId)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfindRow(pattern: any) {\r\n\t\tlet i = 0;\r\n\t\tfor (i = 0; i < this.updatedRows.length; i++) {\r\n\t\t\tif (pattern == this.updatedRows[i]) { // tslint:disable-line\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn i;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: define custom actions\r\n\t * @param: name - name of action, same as value of action attribute\r\n\t * @param: handler - custom function, which receives a XMl response content for action\r\n\t * @type: private\r\n\t */\r\n\tdefineAction(name: string, handler: any) {\r\n\t\tif (!this._uActions) {\r\n\t\t\tthis._uActions = {};\r\n\t\t}\r\n\t\tthis._uActions[name] = handler;\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\r\n\t * @param: sid - id of item before update\r\n\t * @param: tid - id of item after up0ate\r\n\t * @param: action - action name\r\n\t * @type: public\r\n\t * @topic: 0\r\n\t */\r\n\tafterUpdateCallback(sid: number | string, tid: number | string, action: string, btag: any, ganttMode: string) {\r\n\t\tif(!this.$gantt){\r\n\t\t\t// destructor has been called before the callback\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setGanttMode(ganttMode);\r\n\r\n\t\tconst marker = sid;\r\n\t\tconst correct = (action !== \"error\" && action !== \"invalid\");\r\n\t\tif (!correct) {\r\n\t\t\tthis.set_invalid(sid, action);\r\n\t\t}\r\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\r\n\t\t\treturn (delete this._in_progress[marker]);\r\n\t\t}\r\n\r\n\t\tif (this._in_progress[marker] !== \"wait\") {\r\n\t\t\tthis.setUpdated(sid, false);\r\n\t\t}\r\n\r\n\t\tconst originalSid = sid;\r\n\r\n\t\tswitch (action) {\r\n\t\t\tcase \"inserted\":\r\n\t\t\tcase \"insert\":\r\n\t\t\t\tif (tid != sid) { // tslint:disable-line\r\n\t\t\t\t\tthis.setUpdated(sid, false);\r\n\t\t\t\t\tthis.$gantt[this._methods[2]](sid, tid);\r\n\t\t\t\t\tsid = tid;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"delete\":\r\n\t\t\tcase \"deleted\":\r\n\t\t\t\tif(!this.deleteAfterConfirmation || this._ganttMode !== \"task\"){\r\n\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\r\n\t\t\t\t\tthis.$gantt[this._methods[3]](sid);\r\n\t\t\t\t\tdelete this._in_progress[marker];\r\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif (this._ganttMode === \"task\" && this.$gantt.isTaskExists(sid)) {\r\n\t\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\r\n\t\t\t\t\t\tconst task = this.$gantt.getTask(sid);\r\n\t\t\t\t\t\tthis.$gantt.silent(() => {\r\n\t\t\t\t\t\t\tthis.$gantt.deleteTask(sid);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.$gantt.callEvent(\"onAfterTaskDelete\", [sid, task]);\r\n\t\t\t\t\t\tthis.$gantt.render();\r\n\t\t\t\t\t\tdelete this._in_progress[marker];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\r\n\t\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (this._in_progress[marker] !== \"wait\") {\r\n\t\t\tif (correct) {\r\n\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"\", this._ganttMode);\r\n\t\t\t}\r\n\t\t\tdelete this._in_progress[marker];\r\n\t\t} else {\r\n\t\t\tdelete this._in_progress[marker];\r\n\t\t\tthis.setUpdated(tid, true, this.$gantt.getUserData(sid, this.action_param, this._ganttMode));\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: response from server\r\n\t * @param: xml - XMLLoader object with response XML\r\n\t * @type: private\r\n\t */\r\n\tafterUpdate(that: any, xml: any, id?:any) {\r\n\t\tlet _xml;\r\n\t\tif (arguments.length === 3) {\r\n\t\t\t_xml = arguments[1];\r\n\t\t} else {\r\n\t\t\t// old dataprocessor\r\n\t\t\t_xml = arguments[4];\r\n\t\t}\r\n\t\tlet mode = this.getGanttMode();\r\n\t\tconst reqUrl = _xml.filePath || _xml.url;\r\n\r\n\t\tif (this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\") {\r\n\t\t\tif (reqUrl.indexOf(\"gantt_mode=links\") !== -1) {\r\n\t\t\t\tmode = \"link\";\r\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=assignments\") !== -1) {\r\n\t\t\t\tmode = \"assignment\";\r\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=baselines\") !== -1) {\r\n\t\t\t\tmode = \"baseline\";\r\n\t\t\t} else {\r\n\t\t\t\tmode = \"task\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (reqUrl.indexOf(\"/link\") >= 0) {\r\n\t\t\t\tmode = \"link\";\r\n\t\t\t} else if(reqUrl.indexOf(\"/assignment\") >= 0){\r\n\t\t\t\tmode = \"assignment\";\r\n\t\t\t} else if(reqUrl.indexOf(\"/baseline\") >= 0){\r\n\t\t\t\tmode = \"baseline\";\r\n\t\t\t} else {\r\n\t\t\t\tmode = \"task\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.setGanttMode(mode);\r\n\r\n\t\tconst ajax = this.$gantt.ajax;\r\n\t\t// try to use json first\r\n\t\tlet tag;\r\n\r\n\t\ttry {\r\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\t} catch (e) {\r\n\r\n\t\t\t// empty response also can be processed by json handler\r\n\t\t\tif (!xml.xmlDoc.responseText.length) {\r\n\t\t\t\ttag = {};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst processCallback = (itemId: any) => {\r\n\t\t\tconst action = tag.action || this.getState(itemId) || \"updated\";\r\n\t\t\tconst sid = tag.sid || itemId[0];\r\n\t\t\tconst tid = tag.tid || itemId[0];\r\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag, mode);\r\n\t\t};\r\n\t\tif (tag) {\r\n\t\t\t// GS-753. When multiple tasks are updated, unhighlight all of them\r\n\t\t\tif (Array.isArray(id) && id.length > 1) {\r\n\t\t\t\tid.forEach((taskId) => processCallback(taskId));\r\n\t\t\t} else {\r\n\t\t\t\tprocessCallback(id);\r\n\t\t\t}\r\n\t\t\tthat.finalizeUpdate();\r\n\t\t\tthis.setGanttMode(mode);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// xml response\r\n\t\tconst top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\r\n\t\tif (!top) {\r\n\t\t\treturn this.cleanUpdate(id);\r\n\t\t}\r\n\t\tconst atag = ajax.xpath(\"//data/action\", top);\r\n\t\tif (!atag.length) {\r\n\t\t\treturn this.cleanUpdate(id);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < atag.length; i++) {\r\n\t\t\tconst btag = atag[i];\r\n\t\t\tconst action = btag.getAttribute(\"type\");\r\n\t\t\tconst sid = btag.getAttribute(\"sid\");\r\n\t\t\tconst tid = btag.getAttribute(\"tid\");\r\n\r\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag, mode);\r\n\t\t}\r\n\t\tthat.finalizeUpdate();\r\n\t}\r\n\r\n\tcleanUpdate(id: any[]) {\r\n\t\tif (id) {\r\n\t\t\tfor (let i = 0; i < id.length; i++) {\r\n\t\t\t\tdelete this._in_progress[id[i]];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfinalizeUpdate() {\r\n\t\tif (this._waitMode) {\r\n\t\t\tthis._waitMode--;\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\r\n\t\tif (!this.updatedRows.length) {\r\n\t\t\tthis.callEvent(\"onFullSync\", []);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @desc: initializes data-processor\r\n\t * @param: gantt - dhtmlxGantt object to attach this data-processor to\r\n\t * @type: public\r\n\t */\r\n\tinit(gantt: any) {\r\n\t\tif (this._initialized) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.$gantt = gantt;\r\n\t\tif (this.$gantt._dp_init) {\r\n\t\t\tthis.$gantt._dp_init(this);\r\n\t\t}\r\n\r\n\t\tthis._setDefaultTransactionMode();\r\n\r\n\t\tthis.styles = {\r\n\t\t\tupdated:\"gantt_updated\",\r\n\t\t\torder:\"gantt_updated\",\r\n\t\t\tinserted:\"gantt_inserted\",\r\n\t\t\tdeleted:\"gantt_deleted\",\r\n\t\t\tdelete_confirmation:\"gantt_deleted\",\r\n\t\t\tinvalid:\"gantt_invalid\",\r\n\t\t\terror:\"gantt_error\",\r\n\t\t\tclear:\"\"\r\n\t\t};\r\n\r\n\t\tthis._methods=[\"_row_style\",\"setCellTextStyle\",\"_change_id\",\"_delete_task\"];\r\n\t\textendGantt(this.$gantt, this);\r\n\t\tconst dataProcessorEvents = new DataProcessorEvents(this.$gantt, this);\r\n\t\tdataProcessorEvents.attach();\r\n\t\tthis.attachEvent(\"onDestroy\", function() {\r\n\t\t\tdelete this.setGanttMode;\r\n\t\t\tdelete this._getRowData;\r\n\r\n\t\t\tdelete this.$gantt._dp;\r\n\t\t\tdelete this.$gantt._change_id;\r\n\t\t\tdelete this.$gantt._row_style;\r\n\t\t\tdelete this.$gantt._delete_task;\r\n\t\t\tdelete this.$gantt._sendTaskOrder;\r\n\t\t\tdelete this.$gantt;\r\n\r\n\t\t\tdataProcessorEvents.detach();\r\n\t\t});\r\n\t\tthis.$gantt.callEvent(\"onDataProcessorReady\", [this]);\r\n\t\tthis._initialized = true;\r\n\t}\r\n\r\n\tsetOnAfterUpdate(handler) {\r\n\t\tthis.attachEvent(\"onAfterUpdate\", handler);\r\n\t}\r\n\r\n\tsetOnBeforeUpdateHandler(handler) {\r\n\t\tthis.attachEvent(\"onBeforeDataSending\", handler);\r\n\t}\r\n\r\n\t/* starts autoupdate mode\r\n\t\t@param interval time interval for sending update requests\r\n\t*/\r\n\tsetAutoUpdate(interval, user) {\r\n\t\tinterval = interval || 2000;\r\n\r\n\t\tthis._user = user || (new Date()).valueOf();\r\n\t\tthis._needUpdate = false;\r\n\r\n\t\tthis._updateBusy = false;\r\n\r\n\t\tthis.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate); // arguments sid, action, tid, xml_node;\r\n\r\n\t\tthis.attachEvent(\"onFullSync\", this.fullSync);\r\n\r\n\t\tsetInterval(() => {\r\n\t\t\tthis.loadUpdate();\r\n\t\t}, interval);\r\n\t}\r\n\r\n\t/* process updating request response\r\n\t\tif status == collision version is deprecated\r\n\t\tset flag for autoupdating immediately\r\n\t*/\r\n\tafterAutoUpdate(sid, action, tid, xml_node) { // tslint:disable-line\r\n\t\tif (action === \"collision\") {\r\n\t\t\tthis._needUpdate = true;\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\t/* callback function for onFillSync event\r\n\t\tcall update function if it's need\r\n\t*/\r\n\tfullSync() {\r\n\t\tif (this._needUpdate) {\r\n\t\t\tthis._needUpdate = false;\r\n\t\t\tthis.loadUpdate();\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/* sends query to the server and call callback function\r\n\t*/\r\n\tgetUpdates(url, callback) {\r\n\t\tconst ajax = this.$gantt.ajax;\r\n\t\tif (this._updateBusy) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tthis._updateBusy = true;\r\n\t\t}\r\n\r\n\t\tajax.get(url, callback);\r\n\r\n\t}\r\n\r\n\t/* loads updates and processes them\r\n\t*/\r\n\tloadUpdate() {\r\n\t\tconst ajax = this.$gantt.ajax;\r\n\t\tconst version = this.$gantt.getUserData(0, \"version\", this._ganttMode);\r\n\t\tlet url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\r\n\t\turl = url.replace(\"editing=true&\", \"\");\r\n\t\tthis.getUpdates(url, (xml) => {\r\n\t\t\tconst vers = ajax.xpath(\"//userdata\", xml);\r\n\t\t\tthis.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(vers[0]), this._ganttMode);\r\n\r\n\t\t\tconst updates = ajax.xpath(\"//update\", xml);\r\n\t\t\tif (updates.length) {\r\n\t\t\t\tthis._silent_mode = true;\r\n\r\n\t\t\t\tfor (let i = 0; i < updates.length; i++) {\r\n\t\t\t\t\tconst status = updates[i].getAttribute(\"status\");\r\n\t\t\t\t\tconst id = updates[i].getAttribute(\"id\");\r\n\t\t\t\t\tconst parent = updates[i].getAttribute(\"parent\");\r\n\t\t\t\t\tswitch (status) {\r\n\t\t\t\t\t\tcase \"inserted\":\r\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"updated\":\r\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"deleted\":\r\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._silent_mode = false;\r\n\t\t\t}\r\n\r\n\t\t\tthis._updateBusy = false;\r\n\t\t});\r\n\t}\r\n\r\n\tdestructor() {\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\t\tthis.detachAllEvents();\r\n\r\n\t\tthis.updatedRows = [];\r\n\t\tthis._in_progress = {}; // ?\r\n\t\tthis._invalid = {};\r\n\t\tthis._storage.clear();\r\n\t\tthis._storage = null;\r\n\t\tthis._headers = null;\r\n\t\tthis._payload = null;\r\n\t\tdelete this._initialized;\r\n\t}\r\n\r\n\tsetGanttMode(mode) {\r\n\t\tif (mode === \"tasks\") {\r\n\t\t\tmode = \"task\";\r\n\t\t} else if (mode === \"links\") {\r\n\t\t\tmode = \"link\";\r\n\t\t}\r\n\r\n\t\tconst modes = this.modes || {};\r\n\t\tconst ganttMode = this.getGanttMode();\r\n\t\tif (ganttMode) {\r\n\t\t\tmodes[ganttMode] = {\r\n\t\t\t\t_in_progress : this._in_progress,\r\n\t\t\t\t_invalid: this._invalid,\r\n\t\t\t\t_storage: this._storage,\r\n\t\t\t\tupdatedRows : this.updatedRows\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tlet newState = modes[mode];\r\n\t\tif (!newState) {\r\n\t\t\tnewState = modes[mode] = {\r\n\t\t\t\t_in_progress : {},\r\n\t\t\t\t_invalid : {},\r\n\t\t\t\t_storage : SimpleStorage.create(),\r\n\t\t\t\tupdatedRows : []\r\n\t\t\t};\r\n\t\t}\r\n\t\tthis._in_progress = newState._in_progress;\r\n\t\tthis._invalid = newState._invalid;\r\n\t\tthis._storage = newState._storage;\r\n\t\tthis.updatedRows = newState.updatedRows;\r\n\t\tthis.modes = modes;\r\n\t\tthis._ganttMode = mode;\r\n\t}\r\n\tgetGanttMode():string {\r\n\t\treturn this._ganttMode;\r\n\t}\r\n\r\n\tstoreItem(item) {\r\n\t\tthis._storage.storeItem(item);\r\n\t}\r\n\r\n\turl(url: string) {\r\n\t\tthis.serverProcessor = this._serverProcessor = url;\r\n\t}\r\n\r\n\tprotected _beforeSendData(data: any, rowId: any) {\r\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis._sendData(data, rowId);\r\n\t}\r\n\r\n\tprotected _serializeAsJSON(data: any) {\r\n\t\tif (typeof data === \"string\") {\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\tconst copy = utils.copy(data);\r\n\t\tif (this._tMode === \"REST-JSON\") {\r\n\t\t\tdelete copy.id;\r\n\t\t\tdelete copy[this.action_param];\r\n\t\t}\r\n\r\n\t\treturn JSON.stringify(copy);\r\n\t}\r\n\r\n\tprotected _applyPayload(url: string) {\r\n\t\tconst ajax = this.$gantt.ajax;\r\n\t\tif (this._payload) {\r\n\t\t\tfor (const key in this._payload) {\r\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn url;\r\n\t}\r\n\r\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\r\n\t// clear extra info from the data in order not to change the request format\r\n\tprotected _cleanupArgumentsBeforeSend(dataToSend: any) {\r\n\t\tlet processedData;\r\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\r\n\t\t\tprocessedData = {};\r\n\t\t\tfor(const i in dataToSend) {\r\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\r\n\t\t}\r\n\t\treturn processedData;\r\n\t}\r\n\tprotected _cleanupItemBeforeSend(updatedItem: any) {\r\n\t\tlet output = null;\r\n\t\tif(updatedItem){\r\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\r\n\t\t\t\toutput = {};\r\n\t\t\t\toutput.id = updatedItem.id;\r\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\r\n\t\t\t}else{\r\n\t\t\t\toutput = updatedItem;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t}\r\n\r\n\tprotected _sendData(dataToSend: any, rowId?: any) {\r\n\t\tif (!dataToSend) {\r\n\t\t\treturn; // nothing to send\r\n\t\t}\r\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (rowId) {\r\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\r\n\t\t}\r\n\r\n\t\tconst ajax = this.$gantt.ajax;\r\n\r\n\t\tif (this._tMode === \"CUSTOM\") {\r\n\t\t\tconst taskState = this.getState(rowId);\r\n\t\t\tconst taskAction = this.getActionByState(taskState);\r\n\t\t\tdelete dataToSend[this.action_param]; // not send !nativeeditor_status parameter in router mode\r\n\t\t\tconst ganttMode = this.getGanttMode();\r\n\t\t\tconst _onResolvedCreateUpdate = (tag) => {\r\n\t\t\t\tlet action = taskState || \"updated\";\r\n\t\t\t\tlet sid = rowId;\r\n\t\t\t\tlet tid = rowId;\r\n\r\n\t\t\t\tif (tag) {\r\n\t\t\t\t\taction = tag.action || taskState;\r\n\t\t\t\t\tsid = tag.sid || sid;\r\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\r\n\t\t\t\t}\r\n\t\t\t\tthis.afterUpdateCallback(sid, tid, action, tag, ganttMode);\r\n\t\t\t};\r\n\r\n\t\t\tlet actionPromise;\r\n\t\t\tif (this._router instanceof Function) {\r\n\t\t\t\tif(this._routerParametersFormat === \"object\"){\r\n\t\t\t\t\tconst obj = {\r\n\t\t\t\t\t\tentity: ganttMode,\r\n\t\t\t\t\t\taction: taskAction,\r\n\t\t\t\t\t\tdata: dataToSend,\r\n\t\t\t\t\t\tid: rowId\r\n\t\t\t\t\t};\r\n\t\t\t\t\tactionPromise = this._router(obj);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tactionPromise = this._router(ganttMode, taskAction, dataToSend, rowId);\r\n\t\t\t\t}\r\n\t\t\t} else if (this._router[ganttMode] instanceof Function) {\r\n\t\t\t\tactionPromise = this._router[ganttMode](taskAction, dataToSend, rowId);\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst errorMsgStart = \"Incorrect configuration of gantt.createDataProcessor\";\r\n\t\t\t\tconst errorMsgEnd = `\r\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\r\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\r\n\r\n\t\t\t\tif(!this._router[ganttMode]){\r\n\t\t\t\t\tthrow new Error(`${errorMsgStart}: router for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\r\n\t\t\t\t}\r\n\t\t\t\tswitch (taskState) {\r\n\t\t\t\t\tcase \"inserted\":\r\n\t\t\t\t\t\tif(!this._router[ganttMode].create){\r\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **create** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].create(dataToSend);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"deleted\":\r\n\t\t\t\t\t\tif(!this._router[ganttMode].delete){\r\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **delete** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].delete(rowId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tif(!this._router[ganttMode].update){\r\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **update**\" action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].update(dataToSend, rowId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(actionPromise){\r\n\t\t\t\t// neither promise nor {tid: newId} response object\r\n\t\t\t\tif(!actionPromise.then &&\r\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\r\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(actionPromise.then){\r\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch((error) => {\r\n\t\t\t\t\t\tif(error && error.action){\r\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// custom method may return a response object in case of sync action\r\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\t_onResolvedCreateUpdate(null);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet queryParams: any;\r\n\t\tqueryParams = {\r\n\t\t\tcallback: (xml) => {\r\n\t\t\t\tconst ids = [];\r\n\r\n\t\t\t\tif (rowId) {\r\n\t\t\t\t\tids.push(rowId);\r\n\t\t\t\t} else if (dataToSend) {\r\n\t\t\t\t\tfor (const key in dataToSend) {\r\n\t\t\t\t\t\tids.push(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this.afterUpdate(this, xml, ids);\r\n\t\t\t},\r\n\t\t\theaders: this._headers\r\n\t\t};\r\n\r\n\t\tconst dhxVersion = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode);\r\n\t\tconst urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, dhxVersion].join(\"&\")) : \"\");\r\n\t\tlet url: any = this._applyPayload(urlParams);\r\n\t\tlet data;\r\n\r\n\t\tswitch (this._tMode) {\r\n\t\t\tcase \"GET\":\r\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\r\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\r\n\t\t\t\tqueryParams.method = \"GET\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"POST\":\r\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\r\n\t\t\t\tqueryParams.url = url;\r\n\t\t\t\tqueryParams.method = \"POST\";\r\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"JSON\":\r\n\t\t\t\tdata = {};\r\n\t\t\t\tconst preprocessedData = this._cleanupItemBeforeSend(dataToSend);\r\n\t\t\t\tfor (const key in preprocessedData) {\r\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdata[key] = preprocessedData[key];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tqueryParams.url = url;\r\n\t\t\t\tqueryParams.method = \"POST\";\r\n\t\t\t\tqueryParams.data = JSON.stringify({\r\n\t\t\t\t\tid: rowId,\r\n\t\t\t\t\taction: dataToSend[this.action_param],\r\n\t\t\t\t\tdata\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"REST\":\r\n\t\t\tcase \"REST-JSON\":\r\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\r\n\t\t\t\tdata = \"\";\r\n\r\n\t\t\t\tswitch (this.getState(rowId)) {\r\n\t\t\t\t\tcase \"inserted\":\r\n\t\t\t\t\t\tqueryParams.method = \"POST\";\r\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"deleted\":\r\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\r\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\r\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\r\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tqueryParams.url = this._applyPayload(url);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis._waitMode++;\r\n\t\treturn ajax.query(queryParams);\r\n\t}\r\n\r\n\tprotected _forEachUpdatedRow(code: any) {\r\n\t\tconst updatedRows = this.updatedRows.slice();\r\n\t\tfor (let i = 0; i < updatedRows.length; i++) {\r\n\t\t\tconst rowId = updatedRows[i];\r\n\t\t\tif (this.$gantt.getUserData(rowId, this.action_param, this._ganttMode)) {\r\n\t\t\t\tcode.call(this, rowId);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected _setDefaultTransactionMode() {\r\n\t\tif (this.serverProcessor) {\r\n\t\t\tthis.setTransactionMode(\"POST\", true);\r\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\r\n\t\t\tthis._serverProcessor = this.serverProcessor;\r\n\t\t}\r\n\t}\r\n\r\n\t/* returns xml node value\r\n\t\t@param node\r\n\t\t\txml node\r\n\t*/\r\n\tprotected _getXmlNodeValue(node) {\r\n\t\tif (node.firstChild) {\r\n\t\t\treturn node.firstChild.nodeValue;\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\tprotected _getAllData() {\r\n\t\tconst out = {};\r\n\t\tlet hasOne = false;\r\n\r\n\t\tthis._forEachUpdatedRow(function(id) {\r\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst row = this._getRowData(id);\r\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tout[id] = row;\r\n\t\t\thasOne = true;\r\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\r\n\t\t});\r\n\r\n\t\treturn hasOne ? out : null;\r\n\t}\r\n\r\n\tprotected _prepareDate(value: Date) : string {\r\n\t\treturn this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(value) : this.$gantt.templates.format_date(value);\r\n\t}\r\n\r\n\tprotected _prepareArray(value: any[], traversedObjects: object[]) : any[] {\r\n\t\ttraversedObjects.push(value);\r\n\r\n\t\treturn value.map((item) => {\r\n\t\t\tif(helpers.isDate(item)){\r\n\t\t\t\treturn this._prepareDate(item);\r\n\t\t\t} else if (Array.isArray(item) && !helpers.arrayIncludes(traversedObjects, item)){\r\n\t\t\t\treturn this._prepareArray(item, traversedObjects);\r\n\t\t\t} else if (item && typeof item === \"object\" && !helpers.arrayIncludes(traversedObjects, item)) {\r\n\t\t\t\treturn this._prepareObject(item, traversedObjects);\r\n\t\t\t} else {\r\n\t\t\t\treturn item;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _prepareObject(rawItem: any, traversedObjects: object[]) : any {\r\n\t\tconst processedItem = {};\r\n\t\ttraversedObjects.push(rawItem);\r\n\r\n\t\tfor (const key in rawItem) {\r\n\t\t\tif (key.substr(0, 1) === \"$\") {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst value = rawItem[key];\r\n\t\t\tif (helpers.isDate(value)) {\r\n\t\t\t\tprocessedItem[key] = this._prepareDate(value);\r\n\t\t\t} else if(value === null) {\r\n\t\t\t\tprocessedItem[key] = \"\";\r\n\t\t\t} else if (Array.isArray(value) && !helpers.arrayIncludes(traversedObjects, value)){\r\n\t\t\t\tprocessedItem[key] = this._prepareArray(value, traversedObjects);\r\n\t\t\t} else if (value && typeof value === \"object\" && !helpers.arrayIncludes(traversedObjects, value)) {\r\n\t\t\t\tprocessedItem[key] = this._prepareObject(value, traversedObjects);\r\n\t\t\t} else {\r\n\t\t\t\tprocessedItem[key] = value;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn processedItem;\r\n\t}\r\n\r\n\tprotected _prepareDataItem(rawItem: any): any {\r\n\t\tconst processedItem = this._prepareObject(rawItem, []);\r\n\r\n\t\tprocessedItem[this.action_param] = this.$gantt.getUserData(rawItem.id, this.action_param, this._ganttMode);\r\n\t\treturn processedItem;\r\n\t}\r\n\r\n\tprotected getStoredItem(id){\r\n\t\treturn this._storage.getStoredItem(id);\r\n\t}\r\n\r\n\tprotected _getRowData(id) {\r\n\t\tlet dataItem;\r\n\t\tconst gantt = this.$gantt;\r\n\t\tif (this.getGanttMode() === \"task\") {\r\n\t\t\tif(gantt.isTaskExists(id)){\r\n\t\t\t\tdataItem =this.$gantt.getTask(id);\r\n\t\t\t}\r\n\t\t} else if (this.getGanttMode() === \"assignment\") {\r\n\t\t\tif(this.$gantt.$data.assignmentsStore.exists(id)){\r\n\t\t\t\tdataItem =this.$gantt.$data.assignmentsStore.getItem(id);\r\n\t\t\t}\r\n\t\t} else if (this.getGanttMode() === \"baseline\") {\r\n\t\t\tif(this.$gantt.$data.baselineStore.exists(id)){\r\n\t\t\t\tdataItem =this.$gantt.$data.baselineStore.getItem(id);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif(gantt.isLinkExists(id)){\r\n\t\t\t\tdataItem =this.$gantt.getLink(id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!dataItem) {\r\n\t\t\tdataItem = this.getStoredItem(id);\r\n\t\t}\r\n\r\n\t\tif (!dataItem) {\r\n\t\t\tdataItem = { id };\r\n\t\t}\r\n\r\n\t\treturn this._prepareDataItem(dataItem);\r\n\t}\r\n}","\r\nexport default function extendGantt(gantt: any, dp: any) {\r\n\tgantt.getUserData = function(id, name, store) {\r\n\t\tif (!this.userdata) {\r\n\t\t\tthis.userdata = {};\r\n\t\t}\r\n\t\tthis.userdata[store] = this.userdata[store] || {};\r\n\t\tif (this.userdata[store][id] && this.userdata[store][id][name]) {\r\n\t\t\treturn this.userdata[store][id][name];\r\n\t\t}\r\n\t\treturn \"\";\r\n\t};\r\n\tgantt.setUserData = function(id, name, value, store) {\r\n\t\tif (!this.userdata) {\r\n\t\t\tthis.userdata = {};\r\n\t\t}\r\n\t\tthis.userdata[store] = this.userdata[store] || {};\r\n\t\tthis.userdata[store][id] = this.userdata[store][id] || {};\r\n\t\tthis.userdata[store][id][name] = value;\r\n\t};\r\n\r\n\tgantt._change_id = function(oldId, newId) {\r\n\t\tswitch (this._dp._ganttMode) {\r\n\t\t\tcase \"task\":\r\n\t\t\t\tthis.changeTaskId(oldId, newId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"link\":\r\n\t\t\t\tthis.changeLinkId(oldId, newId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"assignment\":\r\n\t\t\t\tthis.$data.assignmentsStore.changeId(oldId, newId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"resource\":\r\n\t\t\t\tthis.$data.resourcesStore.changeId(oldId, newId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"baseline\":\r\n\t\t\t\tthis.$data.baselineStore.changeId(oldId, newId);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${newId}`);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt._row_style = function(rowId, classname){\r\n\t\tif (this._dp._ganttMode !== \"task\") {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!gantt.isTaskExists(rowId)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst task = gantt.getTask(rowId);\r\n\t\ttask.$dataprocessor_class = classname;\r\n\t\tgantt.refreshTask(rowId);\r\n\t};\r\n\r\n\t// fake method for dataprocessor\r\n\tgantt._delete_task = function(rowId, node) {}; // tslint:disable-line\r\n\r\n\tgantt._sendTaskOrder = function(id, item){\r\n\t\tif (item.$drop_target) {\r\n\t\t\tthis._dp.setGanttMode(\"task\");\r\n\t\t\tthis.getTask(id).target = item.$drop_target;\r\n\t\t\tthis._dp.setUpdated(id, true,\"order\");\r\n\t\t\tdelete this.getTask(id).$drop_target;\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.setDp = function() {\r\n\t\tthis._dp = dp;\r\n\t};\r\n\r\n\tgantt.setDp();\r\n}","import * as DataProcessor from \"./data_processor\";\r\nexport default {\r\n\tDEPRECATED_api: function(server) {\r\n\t\treturn new (DataProcessor.DataProcessor)(server);\r\n\t},\r\n\tcreateDataProcessor: DataProcessor.createDataProcessor\r\n};","import global from \"../../utils/global\";\r\n\r\nfunction createMethod(gantt){\r\n\tvar methods = {};\r\n\tvar isActive = false;\r\n\tfunction disableMethod(methodName, dummyMethod){\r\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\r\n\r\n\t\tif(!methods[methodName]){\r\n\t\t\tmethods[methodName] = this[methodName];\r\n\t\t\tthis[methodName] = dummyMethod;\r\n\t\t}\r\n\t}\r\n\tfunction restoreMethod(methodName){\r\n\t\tif(methods[methodName]){\r\n\t\t\tthis[methodName] = methods[methodName];\r\n\t\t\tmethods[methodName] = null;\r\n\t\t}\r\n\t}\r\n\tfunction disableMethods(methodsHash){\r\n\t\tfor(var i in methodsHash){\r\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\r\n\t\t}\r\n\t}\r\n\tfunction restoreMethods(){\r\n\t\tfor(var i in methods){\r\n\t\t\trestoreMethod.call(this, i);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction batchUpdatePayload(callback){\r\n\t\ttry{\r\n\t\t\tcallback();\r\n\t\t}catch(e){\r\n\t\t\tglobal.console.error(e);\r\n\t\t}\r\n\t}\r\n\r\n\tvar state = gantt.$services.getService(\"state\");\r\n\tstate.registerProvider(\"batchUpdate\", function(){\r\n\t\treturn {\r\n\t\t\tbatch_update: isActive\r\n\t\t};\r\n\t}, false);\r\n\r\n\treturn function batchUpdate(callback, noRedraw) {\r\n\t\tif(isActive){\r\n\t\t\t// batch mode is already active\r\n\t\t\tbatchUpdatePayload(callback);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\r\n\t\tvar dp_mode;\r\n\t\tif (call_dp){\r\n\t\t\tdp_mode = this._dp.updateMode;\r\n\t\t\tthis._dp.setUpdateMode(\"off\");\r\n\t\t}\r\n\r\n\t\t// temporary disable some methods while updating multiple tasks\r\n\t\tvar resetProjects = {};\r\n\t\tvar methods = {\r\n\t\t\t\"render\":true,\r\n\t\t\t\"refreshData\":true,\r\n\t\t\t\"refreshTask\":true,\r\n\t\t\t\"refreshLink\":true,\r\n\t\t\t\"resetProjectDates\":function(task){\r\n\t\t\t\tresetProjects[task.id] = task;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdisableMethods.call(this, methods);\r\n\r\n\t\tisActive = true;\r\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\r\n\r\n\t\tbatchUpdatePayload(callback);\r\n\r\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\r\n\r\n\t\trestoreMethods.call(this);\r\n\r\n\t\t// do required updates after changes applied\r\n\t\tfor(var i in resetProjects){\r\n\t\t\tthis.resetProjectDates(resetProjects[i]);\r\n\t\t}\r\n\r\n\t\tisActive = false;\r\n\r\n\t\tif(!noRedraw){\r\n\t\t\tthis.render();\r\n\t\t}\r\n\r\n\t\tif (call_dp) {\r\n\t\t\tthis._dp.setUpdateMode(dp_mode);\r\n\t\t\tthis._dp.setGanttMode(\"task\");\r\n\t\t\tthis._dp.sendData();\r\n\t\t\tthis._dp.setGanttMode(\"link\");\r\n\t\t\tthis._dp.sendData();\r\n\t\t}\r\n\t};\r\n\r\n\r\n\r\n}\r\n\r\nexport default function(gantt){\r\n\tgantt.batchUpdate = createMethod(gantt);\r\n};","const createWbs = (function(gantt){\r\n\treturn {\r\n\t_needRecalc: true,\r\n\treset: function(){\r\n\t\tthis._needRecalc = true;\r\n\t},\r\n\t_isRecalcNeeded: function(){\r\n\t\treturn (!this._isGroupSort() && this._needRecalc);\r\n\t},\r\n\t_isGroupSort: function() {\r\n\t\treturn !!(gantt.getState().group_mode);\r\n\t},\r\n\t_getWBSCode: function(task) {\r\n\t\tif(!task) return \"\";\r\n\r\n\t\tif(this._isRecalcNeeded()){\r\n\t\t\tthis._calcWBS();\r\n\t\t}\r\n\r\n\t\tif(task.$virtual) return \"\";\r\n\t\tif(this._isGroupSort()) return task.$wbs || \"\";\r\n\r\n\t\tif(!task.$wbs) {\r\n\t\t\tthis.reset();\r\n\t\t\tthis._calcWBS();\r\n\t\t}\r\n\t\treturn task.$wbs;\r\n\t},\r\n\t_setWBSCode: function(task, value) {\r\n\t\ttask.$wbs = value;\r\n\t},\r\n\tgetWBSCode: function(task) {\r\n\t\treturn this._getWBSCode(task);\r\n\t},\r\n\tgetByWBSCode: function(code){\r\n\t\tlet parts = code.split(\".\");\r\n\t\tlet currentNode = gantt.config.root_id;\r\n\t\tfor(let i = 0; i < parts.length; i++){\r\n\t\t\tconst children = gantt.getChildren(currentNode);\r\n\t\t\tlet index = parts[i]*1 - 1;\r\n\t\t\tif(gantt.isTaskExists(children[index])){\r\n\t\t\t\tcurrentNode = children[index];\r\n\t\t\t}else{\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(gantt.isTaskExists(currentNode)){\r\n\t\t\treturn gantt.getTask(currentNode);\r\n\t\t}else{\r\n\t\t\treturn null;\r\n\t\t}\r\n\t},\r\n\t_calcWBS: function() {\r\n\t\tif(!this._isRecalcNeeded()) return;\r\n\r\n\t\tlet _isFirst = true;\r\n\t\tgantt.eachTask(function(ch) {\r\n\t\t\tif(ch.type == gantt.config.types.placeholder) return;\r\n\t\t\tif(_isFirst) {\r\n\t\t\t\t_isFirst = false;\r\n\t\t\t\tthis._setWBSCode(ch, \"1\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst _prevSibling = this._getPrevNonPlaceholderSibling(ch.id);\r\n\t\t\tif (_prevSibling !== null) {\r\n\t\t\t\tthis._increaseWBS(ch, _prevSibling);\r\n\t\t\t} else {\r\n\t\t\t\tlet _parent = gantt.getParent(ch.id);\r\n\t\t\t\tthis._setWBSCode(ch, gantt.getTask(_parent).$wbs + \".1\");\r\n\t\t\t}\r\n\t\t}, gantt.config.root_id, this);\r\n\r\n\t\tthis._needRecalc = false;\r\n\t},\r\n\t_increaseWBS: function(task, siblingiId){\r\n\t\tlet _wbs = gantt.getTask(siblingiId).$wbs;\r\n\t\tif(_wbs) {\r\n\t\t\t_wbs = _wbs.split(\".\");\r\n\t\t\t_wbs[_wbs.length-1]++;\r\n\t\t\tthis._setWBSCode(task, _wbs.join(\".\"));\r\n\t\t}\r\n\t},\r\n\t_getPrevNonPlaceholderSibling: function(childId) {\r\n\t\tlet prevSibling;\r\n\t\tlet currentId = childId;\r\n\t\tdo {\r\n\t\t\tprevSibling = gantt.getPrevSibling(currentId);\r\n\t\t\tcurrentId = prevSibling;\r\n\t\t} while (prevSibling !== null && gantt.getTask(prevSibling).type == gantt.config.types.placeholder);\r\n\t\treturn prevSibling;\r\n   }\r\n};\r\n});\r\n\r\nexport default function(gantt){\r\n\tconst wbs = createWbs(gantt);\r\n\tgantt.getWBSCode = function getWBSCode(task) {\r\n\t\treturn wbs.getWBSCode(task);\r\n\t};\r\n\r\n\tgantt.getTaskByWBSCode = function(code) {\r\n\t\treturn wbs.getByWBSCode(code);\r\n\t};\r\n\r\n\tfunction resetCache(){\r\n\t\twbs.reset();\r\n\t\treturn true;\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onAfterTaskMove\", resetCache);\r\n\tgantt.attachEvent(\"onBeforeParse\", resetCache);\r\n\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\r\n\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\r\n\tgantt.attachEvent(\"onAfterSort\", resetCache);\r\n\r\n};\r\n","import * as helpers from \"../../utils/helpers\";\r\nimport * as dom_helpers from \"../ui/utils/dom_helpers\";\r\nfunction createResourceMethods(gantt){\r\n\r\n\tvar resourceTaskCache = {};\r\n\tvar singleResourceCacheBuilt = false;\r\n\r\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\r\n\t\tresourceTaskCache = {};\r\n\t\tsingleResourceCacheBuilt = false;\r\n\t});\r\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\r\n\t\tresourceTaskCache = {};\r\n\t});\r\n\r\n\tfunction getTaskBy(propertyName, propertyValue, typeFilter) {\r\n\t\tif (typeof propertyName == \"function\") {\r\n\t\t\treturn filterResourceTasks(propertyName);\r\n\t\t} else {\r\n\t\t\tif (helpers.isArray(propertyValue)) {\r\n\t\t\t\treturn getResourceTasks(propertyName, propertyValue, typeFilter);\r\n\t\t\t} else {\r\n\t\t\t\treturn getResourceTasks(propertyName, [propertyValue], typeFilter);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction filterResourceTasks(filter) {\r\n\t\tvar res = [];\r\n\t\tgantt.eachTask(function (task) {\r\n\t\t\tif (filter(task)) {\r\n\t\t\t\tres.push(task);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn res;\r\n\t}\r\n\r\n\tvar falsyValuePrefix = String(Math.random());\r\n\tfunction resourceHashFunction(value){\r\n\t\tif (value === null){\r\n\t\t\treturn falsyValuePrefix + String(value);\r\n\t\t}\r\n\t\treturn String(value);\r\n\t}\r\n\r\n\tfunction getCacheKey(resourceIds, property, typeFilter) {\r\n\t\tif (Array.isArray(resourceIds)) {\r\n\t\t\treturn resourceIds.map(function (value) {\r\n\t\t\t\treturn resourceHashFunction(value);\r\n\t\t\t}).join(\"_\") + `_${property}_${typeFilter}`;\r\n\t\t} else {\r\n\t\t\treturn resourceHashFunction(resourceIds) + `_${property}_${typeFilter}`;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getResourceTasks(property, resourceIds, typeFilter) {\r\n\t\tvar res;\r\n\t\tvar cacheKey = getCacheKey(resourceIds, property, JSON.stringify(typeFilter));\r\n\t\tvar matchingResources = {};\r\n\t\thelpers.forEach(resourceIds, function(resourceId) {\r\n\t\t\tmatchingResources[resourceHashFunction(resourceId)] = true;\r\n\t\t});\r\n\r\n\t\tif (!resourceTaskCache[cacheKey]) {\r\n\t\t\tres = resourceTaskCache[cacheKey] = [];\r\n\t\t\tgantt.eachTask(function (task) {\r\n\t\t\t\tif (typeFilter) {\r\n\t\t\t\t\tif (!typeFilter[gantt.getTaskType(task)]) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (task.type == gantt.config.types.project) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (property in task) {\r\n\t\t\t\t\tvar resourceValue;\r\n\t\t\t\t\tif (!helpers.isArray(task[property])) {\r\n\t\t\t\t\t\tresourceValue = [task[property]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresourceValue = task[property];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thelpers.forEach(resourceValue, function(value) {\r\n\t\t\t\t\t\tvar resourceValue = (value && value.resource_id) ? value.resource_id : value;\r\n\r\n\t\t\t\t\t\tif (matchingResources[resourceHashFunction(resourceValue)]) {\r\n\t\t\t\t\t\t\tres.push(task);\r\n\t\t\t\t\t\t}else if(!singleResourceCacheBuilt){\r\n\r\n\t\t\t\t\t\t\tvar key = getCacheKey(value, property);\r\n\t\t\t\t\t\t\tif(!resourceTaskCache[key]){\r\n\t\t\t\t\t\t\t\tresourceTaskCache[key] = [];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tresourceTaskCache[key].push(task);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tsingleResourceCacheBuilt = true;\r\n\t\t} else {\r\n\t\t\tres = resourceTaskCache[cacheKey];\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t}\r\n\r\n\tfunction selectAssignments(resourceId, taskId, result){\r\n\t\tvar property = gantt.config.resource_property;\r\n\t\tvar owners = [];\r\n\t\tif (gantt.getDatastore(\"task\").exists(taskId)) {\r\n\t\t\tvar task = gantt.getTask(taskId);\r\n\t\t\towners = task[property] || [];\r\n\t\t}\r\n\r\n\t\tif (!Array.isArray(owners)) {\r\n\t\t\towners = [owners];\r\n\t\t}\r\n\t\tfor (var i = 0; i < owners.length; i++) {\r\n\t\t\tif (owners[i].resource_id == resourceId) {\r\n\t\t\t\tresult.push({task_id: task.id, resource_id:owners[i].resource_id, value:owners[i].value});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getResourceAssignments(resourceId, taskId){\r\n\t\t// resource assignment as an independent module:\r\n\t\t// {taskId:, resourceId, value}\r\n\t\t// TODO: probably should add a separate datastore for these\r\n\t\tvar assignments = [];\r\n\t\tvar property = gantt.config.resource_property;\r\n\t\tif(taskId !== undefined){\r\n\t\t\tselectAssignments(resourceId, taskId, assignments);\r\n\t\t}else{\r\n\t\t\tvar tasks = gantt.getTaskBy(property, resourceId);\r\n\t\t\ttasks.forEach(function(task){\r\n\t\t\t\tselectAssignments(resourceId, task.id, assignments);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn assignments;\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetTaskBy: getTaskBy,\r\n\t\tgetResourceAssignments: getResourceAssignments\r\n\t};\r\n}\r\n\r\nfunction createHelper(gantt){\r\n\tconst resourcePlugin = {\r\n\t\trenderEditableLabel: function(start_date, end_date, resource, tasks, assignments){\r\n\t\t\tconst editable = gantt.config.readonly ? \"\" : \"contenteditable\";\r\n\t\t\tif(start_date < resource.end_date && end_date > resource.start_date){\r\n\t\t\t\tfor(let i = 0; i < assignments.length; i++){\r\n\t\t\t\t\tconst a = assignments[i];\r\n\t\t\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-assignment-id='\"+a.id+\"'\"+\r\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\r\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\r\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\r\n\t\t\t\t\t\t\" data-end-date='\"+gantt.templates.format_date(end_date)+\"'>\" + a.value + \"</div>\";\r\n\t\t\t\t}\r\n\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-empty \"+ \r\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\r\n\t\t\t\t\t\t\" data-resource-id='\"+resource.$resource_id+\"'\"+\r\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\r\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\r\n\t\t\t\t\t\t\"'  data-end-date='\"+gantt.templates.format_date(end_date)+\"'>-</div>\";\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\trenderSummaryLabel: function(start_date, end_date, resource, tasks, assignments){\r\n\t\t\tlet sum = assignments.reduce(function(total, assignment){ \r\n\t\t\t\treturn total + Number(assignment.value);\r\n\t\t\t}, 0);\r\n\r\n\t\t\tif(sum % 1){\r\n\t\t\t\tsum = Math.round(sum * 10)/10;\r\n\t\t\t}\r\n\r\n\t\t\tif(sum){\r\n\t\t\t\treturn \"<div>\" + sum + \"</div>\";\r\n\t\t\t}\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\teditableResourceCellTemplate: function(start_date, end_date, resource, tasks, assignments){\r\n\t\t\tif(resource.$role === \"task\"){\r\n\t\t\t\treturn resourcePlugin.renderEditableLabel(start_date, end_date, resource, tasks, assignments);\r\n\t\t\t}else{\r\n\t\t\t\treturn resourcePlugin.renderSummaryLabel(start_date, end_date, resource, tasks, assignments);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t\r\n\t\teditableResourceCellClass: function(start_date, end_date, resource, tasks, assignments){\r\n\t\t\tconst css = [];\r\n\t\t\tcss.push(\"resource_marker\");\r\n\r\n\t\t\tif(resource.$role === \"task\"){\r\n\t\t\t\tcss.push(\"task_cell\");\r\n\t\t\t}else{\r\n\t\t\t\tcss.push(\"resource_cell\");\r\n\t\t\t}\r\n\r\n\t\t\tconst sum = assignments.reduce(function(total, assignment){ \r\n\t\t\t\treturn total + Number(assignment.value);\r\n\t\t\t}, 0);\r\n\r\n\t\t\tlet capacity = Number(resource.capacity);\r\n\t\t\tif(isNaN(capacity)){\r\n\t\t\t\tcapacity = 8;\r\n\t\t\t}\r\n\t\t\tif (sum <= capacity) {\r\n\t\t\t\tcss.push(\"workday_ok\");\r\n\t\t\t} else {\r\n\t\t\t\tcss.push(\"workday_over\");\r\n\t\t\t}\r\n\t\t\treturn css.join(\" \");\r\n\t\t},\r\n\t\tgetSummaryResourceAssignments: function getResourceAssignments(resourceId) {\r\n\t\t\tlet assignments;\r\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\r\n\t\t\tconst resource = store.getItem(resourceId);\r\n\r\n\t\t\tif(resource.$role === \"task\"){\r\n\t\t\t\tassignments = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\r\n\t\t\t}else{\r\n\t\t\t\tassignments = gantt.getResourceAssignments(resourceId);\r\n\t\t\t\tif(store.eachItem){\r\n\t\t\t\t\tstore.eachItem(function(childResource){\r\n\t\t\t\t\t\tif(childResource.$role !== \"task\"){\r\n\t\t\t\t\t\t\tassignments = assignments.concat(gantt.getResourceAssignments(childResource.id));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, resourceId);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn assignments;\r\n\t\t},\r\n\t\t\r\n\t\tinitEditableDiagram: function(){\r\n\t\t\tgantt.config.resource_render_empty_cells = true;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t(function(){\r\n\t\t\t\t/// salesforce locker workaround\r\n\t\t\t\t// SF removes 'contenteditable' attribute from cells\r\n\t\t\t\t// restore it on render\r\n\t\t\t\tlet timeoutId = null;\r\n\t\t\t\tfunction makeEditable() {\r\n\t\t\t\t\tif (timeoutId) {\r\n\t\t\t\t\t\tcancelAnimationFrame(timeoutId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttimeoutId = requestAnimationFrame(function () {\r\n\t\t\t\t\t\tif (gantt.$container){\r\n\t\t\t\t\t\t\tvar cells = Array.prototype.slice.call(gantt.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\"));\r\n\t\t\t\t\t\t\tcells.forEach(function (cell) {\r\n\t\t\t\t\t\t\t\tcell.contentEditable = true;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", makeEditable);\r\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).attachEvent(\"onStoreUpdated\", makeEditable);\r\n\t\t\t\t}, {once: true});\r\n\t\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\r\n\t\t\t\t\tconst ganttViews = gantt.$layout.getCellsByType(\"viewCell\");\r\n\t\t\t\t\tganttViews.forEach(function(view){\r\n\t\t\t\t\t\tif(view.$config && view.$config.view === \"resourceTimeline\" && view.$content){\r\n\t\t\t\t\t\t\tview.$content.attachEvent(\"onScroll\", makeEditable);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t})();\r\n\t\t\t//GS-2766: need to restore focus after updating assignments\r\n\t\t\tlet currentFocusIndex = null;\r\n\t\t\tfunction setNextFocus(){\r\n\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\tconst focusableElementsAfterRender = dom_helpers.getFocusableNodes(gantt.$container);\r\n\t\t\t\t\tif(currentFocusIndex > -1){\r\n\t\t\t\t\t\tfocusableElementsAfterRender[currentFocusIndex +1].focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 300);\r\n\t\t\t};\r\n\r\n\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\t\t\tlet assignmentEditInProcess = false;\r\n\t\t\t\tgantt.event(gantt.$container, \"keypress\", function(e){\r\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\r\n\t\t\t\t\tif(target){\r\n\t\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 27) {\r\n\t\t\t\t\t\t\ttarget.blur();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tgantt.event(gantt.$container, \"keydown\", function(event){\r\n\t\t\t\t\tif (event.key === \"Tab\") {\r\n\t\t\t\t\t\tconst focusableElements = dom_helpers.getFocusableNodes(gantt.$container);\r\n\t\t\t\t\t\tcurrentFocusIndex = focusableElements.indexOf(document.activeElement);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tgantt.event(gantt.$container, \"focusout\", function(e){\r\n\t\t\t\t\tif (assignmentEditInProcess){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tassignmentEditInProcess = true;\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tassignmentEditInProcess = false;\r\n\t\t\t\t\t}, 300);\r\n\t\t\t\t\tvar target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\r\n\t\t\t\t\tif(target){\r\n\t\t\t\t\t\tvar strValue = (target.innerText || \"\").trim();\r\n\t\t\t\t\t\tif(strValue == \"-\"){\r\n\t\t\t\t\t\t\tstrValue = \"0\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar value = Number(strValue);\r\n\t\t\t\t\t\tvar rowId = target.getAttribute(\"data-row-id\");\r\n\t\t\t\t\t\tvar assignmentId = target.getAttribute(\"data-assignment-id\");\r\n\t\t\t\t\t\tvar taskId = target.getAttribute(\"data-task\");\r\n\t\t\t\t\t\tvar resourceId = target.getAttribute(\"data-resource-id\");\r\n\t\t\t\t\t\tvar startDate = gantt.templates.parse_date(target.getAttribute(\"data-start-date\"));\r\n\t\t\t\t\t\tvar endDate = gantt.templates.parse_date(target.getAttribute(\"data-end-date\"));\r\n\r\n\t\t\t\t\t\tvar assignmentStore = gantt.getDatastore(gantt.config.resource_assignment_store);\r\n\t\t\t\t\t\tif(isNaN(value)){\r\n\t\t\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).refresh(rowId);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tvar task = gantt.getTask(taskId);\r\n\t\t\t\t\t\t\t// GS-2141. Track the changes by the Undo extension\r\n\t\t\t\t\t\t\tif (gantt.plugins().undo){\r\n\t\t\t\t\t\t\t\tgantt.ext.undo.saveState(taskId, \"task\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif(assignmentId){\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar assignment = assignmentStore.getItem(assignmentId);\r\n\t\t\t\t\t\t\t\tif(value === assignment.value){\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() === startDate.valueOf() && assignment.end_date.valueOf() === endDate.valueOf()){\r\n\t\t\t\t\t\t\t\t\tassignment.value = value;\r\n\t\t\t\t\t\t\t\t\tif(!value){\r\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tif(assignment.end_date.valueOf() > endDate.valueOf()){\r\n\t\t\t\t\t\t\t\t\t\tvar nextChunk = gantt.copy(assignment);\r\n\t\t\t\t\t\t\t\t\t\tnextChunk.id = gantt.uid();\r\n\t\t\t\t\t\t\t\t\t\tnextChunk.start_date = endDate;\r\n\t\t\t\t\t\t\t\t\t\tnextChunk.duration = gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\t\tstart_date: nextChunk.start_date,\r\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.end_date,\r\n\t\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tnextChunk.delay = gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.start_date,\r\n\t\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tnextChunk.mode = assignment.mode || \"default\";\r\n\t\t\t\t\t\t\t\t\t\tif(nextChunk.duration !== 0){\r\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem(nextChunk);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() < startDate.valueOf()){\r\n\t\t\t\t\t\t\t\t\t\tassignment.end_date = startDate;\r\n\t\t\t\t\t\t\t\t\t\tassignment.duration = gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\t\tstart_date: assignment.start_date,\r\n\t\t\t\t\t\t\t\t\t\t\tend_date: assignment.end_date,\r\n\t\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tassignment.mode = \"fixedDuration\";\r\n\r\n\t\t\t\t\t\t\t\t\t\tif(assignment.duration === 0){\r\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif(value){\r\n\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem({\r\n\t\t\t\t\t\t\t\t\t\t\ttask_id: assignment.task_id,\r\n\t\t\t\t\t\t\t\t\t\t\tresource_id: assignment.resource_id,\r\n\t\t\t\t\t\t\t\t\t\t\tvalue: value,\r\n\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\r\n\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\r\n\t\t\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\r\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\t\t\t\t\t\t\t\t\tend_date: startDate,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\r\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\r\n\t\t\t\t\t\t\t\tsetNextFocus();\r\n\r\n\t\t\t\t\t\t\t}else if(value){\r\n\t\t\t\t\t\t\t\tvar assignment = {\r\n\t\t\t\t\t\t\t\t\ttask_id: taskId,\r\n\t\t\t\t\t\t\t\t\tresource_id: resourceId,\r\n\t\t\t\t\t\t\t\t\tvalue: value,\r\n\t\t\t\t\t\t\t\t\tstart_date: startDate,\r\n\t\t\t\t\t\t\t\t\tend_date: endDate,\r\n\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\r\n\t\t\t\t\t\t\t\t\t\tend_date: endDate,\r\n\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\r\n\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\t\t\t\t\t\t\tend_date: startDate,\r\n\t\t\t\t\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\r\n\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\tassignmentStore.addItem(assignment);\r\n\t\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\r\n\t\t\t\t\t\t\t\tgantt.updateTask(task.id);\r\n\t\t\t\t\t\t\t\tsetNextFocus();\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}, {once: true});\r\n\t\t}\r\n\t};\r\n\treturn resourcePlugin;\r\n}\r\n\r\nexport default function(gantt){\r\n\tvar methods = createResourceMethods(gantt);\r\n\t\r\n\tgantt.ext.resources = createHelper(gantt);\r\n\r\n\tgantt.config.resources = {\r\n\t\tdataprocessor_assignments: false,\r\n\t\tdataprocessor_resources: false,\r\n\t\teditable_resource_diagram: false,\r\n\t\tresource_store: {\r\n\t\t\ttype: \"treeDataStore\",\r\n\t\t\tfetchTasks: false,\r\n\t\t\tinitItem: function(item) {\r\n\t\t\t\titem.parent = item.parent || gantt.config.root_id;\r\n\t\t\t\titem[gantt.config.resource_property] = item.parent;\r\n\t\t\t\titem.open = true;\r\n\t\t\t\treturn item;\r\n\t\t\t}\r\n\t\t},\r\n\t\tlightbox_resources: function selectResourceControlOptions(resources){\r\n\t\t\tconst lightboxOptions = [];\r\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\r\n\t\t\tresources.forEach(function(res) {\r\n\t\t\t\tif (!store.hasChild(res.id)) {\r\n\t\t\t\t\tconst copy = gantt.copy(res);\r\n\t\t\t\t\tcopy.key = res.id;\r\n\t\t\t\t\tcopy.label = res.text;\r\n\t\t\t\t\tlightboxOptions.push(copy);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn lightboxOptions;\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\r\n\t\tif(gantt.getDatastore(gantt.config.resource_store)){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst resourceStoreConfig = gantt.config.resources ? gantt.config.resources.resource_store : undefined;\r\n\t\tlet fetchTasks = resourceStoreConfig ? resourceStoreConfig.fetchTasks : undefined;\r\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\r\n\t\t\tfetchTasks = true;\r\n\t\t}\r\n\r\n\t\tlet initItems = function(item) {\r\n\t\t\titem.parent = item.parent || gantt.config.root_id;\r\n\t\t\titem[gantt.config.resource_property] = item.parent;\r\n\t\t\titem.open = true;\r\n\t\t\treturn item;\r\n\t\t};\r\n\r\n\t\tif(resourceStoreConfig && resourceStoreConfig.initItem){\r\n\t\t\tinitItems = resourceStoreConfig.initItem;\r\n\t\t}\r\n\r\n\t\tconst storeType = resourceStoreConfig && resourceStoreConfig.type ? resourceStoreConfig.type : \"treeDatastore\";\r\n\r\n\t\tgantt.$resourcesStore = gantt.createDatastore({\r\n\t\t\tname: gantt.config.resource_store,\r\n\t\t\ttype: storeType,\r\n\t\t\tfetchTasks: fetchTasks !== undefined ? fetchTasks : false,\r\n\t\t\tinitItem: initItems\r\n\t\t});\r\n\r\n\t\tgantt.$data.resourcesStore = gantt.$resourcesStore;\r\n\r\n\t\tgantt.$resourcesStore.attachEvent(\"onParse\", function() {\r\n\t\t\tfunction selectResourceControlOptions(resources){\r\n\t\t\t\tconst lightboxOptions = [];\r\n\t\t\t\tresources.forEach(function(res) {\r\n\t\t\t\t\tconst copy = gantt.copy(res);\r\n\t\t\t\t\tcopy.key = res.id;\r\n\t\t\t\t\tcopy.label = res.text;\r\n\t\t\t\t\tlightboxOptions.push(copy);\r\n\t\t\t\t});\r\n\t\t\t\treturn lightboxOptions;\r\n\t\t\t}\r\n\r\n\t\t\tlet lightboxOptionsFnc = selectResourceControlOptions;\r\n\t\t\tlet options;\r\n\t\t\tif(gantt.config.resources && gantt.config.resources.lightbox_resources){\r\n\t\t\t\tlightboxOptionsFnc = gantt.config.resources.lightbox_resources;\r\n\t\t\t}\r\n\t\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\r\n\t\t\t\t// GS-2604: case for the next parsed resources\r\n\t\t\t\t// to filter only resources with assignments\r\n\t\t\t\tconst resources = gantt.$resourcesStore.getItems();\r\n\t\t\t\tconst filteredResources = resources.filter(resource => {\r\n\t\t\t\t\tlet assignments = gantt.getResourceAssignments(resource.id);\r\n\t\t\t\t\tif(!gantt.$resourcesStore.hasChild(resource.id) || (assignments && assignments.length)){\r\n\t\t\t\t\t\tif(resource.$resource_id && resource.$task_id){\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\toptions = lightboxOptionsFnc(filteredResources);\r\n\t\t\t} else {\r\n\t\t\t\toptions = lightboxOptionsFnc(gantt.$resourcesStore.getItems());\r\n\t\t\t}\r\n\t\t\tgantt.updateCollection(\"resourceOptions\", options);\r\n\t\t});\r\n\t});\r\n\r\n\tgantt.getTaskBy = methods.getTaskBy;\r\n\tgantt.getResourceAssignments = methods.getResourceAssignments;\r\n\tgantt.config.resource_property = \"owner_id\";\r\n\tgantt.config.resource_store = \"resource\";\r\n\tgantt.config.resource_render_empty_cells = false;\r\n\r\n\t/**\r\n\t * these are placeholder functions that should be redefined by the user\r\n\t*/\r\n\tgantt.templates.histogram_cell_class = function(start_date, end_date, resource, tasks, assignments) {};\r\n\tgantt.templates.histogram_cell_label = function(start_date, end_date, resource, tasks, assignments) {\r\n\t\treturn tasks.length + \"/3\";\r\n\t};\r\n\tgantt.templates.histogram_cell_allocated = function(start_date, end_date, resource, tasks, assignments) {\r\n\t\treturn tasks.length / 3;\r\n\t};\r\n\tgantt.templates.histogram_cell_capacity = function(start_date, end_date, resource, tasks, assignments) {\r\n\t\treturn 0;\r\n\t};\r\n\r\n\r\n\tconst defaultResourceCellClass = function(start, end, resource, tasks, assignments) {\r\n\t\tvar css = \"\";\r\n\t\tif (tasks.length <= 1) {\r\n\t\t\tcss = \"gantt_resource_marker_ok\";\r\n\t\t} else {\r\n\t\t\tcss = \"gantt_resource_marker_overtime\";\r\n\t\t}\r\n\t\treturn css;\r\n\t};\r\n\r\n\tconst defaultResourceCellTemplate = function(start, end, resource, tasks, assignments) {\r\n\t\treturn tasks.length * 8;\r\n\t};\r\n\r\n\tgantt.templates.resource_cell_value = defaultResourceCellTemplate;\r\n\tgantt.templates.resource_cell_class = defaultResourceCellClass;\r\n\r\n\t//editable_resource_diagram\r\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\r\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\r\n\r\n\t\t\tgantt.config.resource_render_empty_cells = true;\r\n\t\t\tif(gantt.templates.resource_cell_value === defaultResourceCellTemplate){\r\n\t\t\t\tgantt.templates.resource_cell_value = gantt.ext.resources.editableResourceCellTemplate;\r\n\t\t\t}\r\n\t\t\tif(gantt.templates.resource_cell_class === defaultResourceCellClass){\r\n\t\t\t\tgantt.templates.resource_cell_class = gantt.ext.resources.editableResourceCellClass;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tgantt.ext.resources.initEditableDiagram(gantt);\r\n\t\t}\r\n\t});\r\n};\r\n\r\n\r\n","export default function (gantt) {\r\n\tvar resourceAssignmentsProperty = \"$resourceAssignments\";\r\n\tgantt.config.resource_assignment_store = \"resourceAssignments\";\r\n\tgantt.config.process_resource_assignments = true;\r\n\r\n\tvar resourceAssignmentFormats = {\r\n\t\tauto: \"auto\",\r\n\t\tsingleValue: \"singleValue\",\r\n\t\tvalueArray: \"valueArray\",\r\n\t\tresourceValueArray: \"resourceValueArray\",\r\n\t\tassignmentsArray: \"assignmentsArray\"\r\n\t};\r\n\tvar resourceAssignmentFormat = resourceAssignmentFormats.auto;//\"primitiveSingle\";//\"primitive\";//\"object\"|\"assignment\"\r\n\r\n\tvar assignmentModes = {\r\n\t\tfixedDates: \"fixedDates\",\r\n\t\tfixedDuration: \"fixedDuration\",\r\n\t\tdefault: \"default\"\r\n\t};\r\n\r\n\r\n\tfunction initAssignmentFields(item, task){\r\n\t\tif (item.start_date) {\r\n\t\t\titem.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\r\n\t\t} else {\r\n\t\t\titem.start_date = null;\r\n\t\t}\r\n\r\n\t\tif (item.end_date) {\r\n\t\t\titem.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\r\n\t\t} else {\r\n\t\t\titem.end_date = null;\r\n\t\t}\r\n\r\n\t\tvar delay = Number(item.delay);\r\n\t\tvar initDelay = false;\r\n\t\tif (!isNaN(delay)) {\r\n\t\t\titem.delay = delay;\r\n\t\t} else {\r\n\t\t\titem.delay = 0;\r\n\t\t\tinitDelay = true;\r\n\t\t}\r\n\r\n\t\tif (!gantt.defined(item.value)) {\r\n\t\t\titem.value = null;\r\n\t\t}\r\n\r\n\t\tif (!item.task_id || !item.resource_id) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\titem.mode = item.mode || assignmentModes.default;\r\n\r\n\t\tif(item.mode === assignmentModes.fixedDuration){\r\n\t\t\tif(isNaN(Number(item.duration))){\r\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\r\n\t\t\t\titem.duration = gantt.calculateDuration({\r\n\t\t\t\t\tstart_date: item.start_date,\r\n\t\t\t\t\tend_date: item.end_date,\r\n\t\t\t\t\tid: task\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif(initDelay){\r\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\r\n\t\t\t\titem.delay = gantt.calculateDuration({\r\n\t\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\t\tend_date: item.start_date,\r\n\t\t\t\t\tid: task\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (item.mode !== assignmentModes.fixedDates && (task || gantt.isTaskExists(item.task_id))) {\r\n\t\t\ttask = task || gantt.getTask(item.task_id);\r\n\t\t\tvar timing = _assignmentTimeFromTask(item, task);\r\n\t\t\titem.start_date = timing.start_date;\r\n\t\t\titem.end_date = timing.end_date;\r\n\t\t\titem.duration = timing.duration;\r\n\t\t}\r\n\t}\r\n\t// gantt init\r\n\tvar resourceAssignmentsStore = gantt.createDatastore({\r\n\t\tname: gantt.config.resource_assignment_store,\r\n\t\tinitItem: function (item) {\r\n\t\t\tif (!item.id) {\r\n\t\t\t\titem.id = gantt.uid();\r\n\t\t\t}\r\n\r\n\t\t\tinitAssignmentFields(item);\r\n\r\n\t\t\treturn item;\r\n\t\t}\r\n\t});\r\n\t\r\n\tgantt.$data.assignmentsStore = resourceAssignmentsStore;\r\n\r\n\tfunction _assignmentTimeFromTask(assignment, task) {\r\n\r\n\t\tif (assignment.mode === assignmentModes.fixedDates) {\r\n\t\t\treturn {\r\n\t\t\t\tstart_date: assignment.start_date,\r\n\t\t\t\tend_date: assignment.end_date,\r\n\t\t\t\tduration: assignment.duration\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tvar start = assignment.delay ? gantt.calculateEndDate({\r\n\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\tduration: assignment.delay,\r\n\t\t\t\ttask: task\r\n\t\t\t}) : new Date(task.start_date);\r\n\r\n\t\t\tvar end;\r\n\t\t\tvar duration;\r\n\t\t\tif (assignment.mode === assignmentModes.fixedDuration) {\r\n\t\t\t\tend = gantt.calculateEndDate({\r\n\t\t\t\t\tstart_date: start,\r\n\t\t\t\t\tduration: assignment.duration,\r\n\t\t\t\t\ttask: task\r\n\t\t\t\t});\r\n\t\t\t\tduration = assignment.duration;\r\n\t\t\t} else {\r\n\t\t\t\tend = new Date(task.end_date);\r\n\t\t\t\tduration = task.duration - assignment.delay;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tstart_date: start,\r\n\t\t\tend_date: end,\r\n\t\t\tduration: duration\r\n\t\t};\r\n\t}\r\n\r\n\t// data loading\r\n\r\n\tfunction _makeAssignmentsFromTask(task) {\r\n\t\tconst property = gantt.config.resource_property;\r\n\t\tlet assignments = task[property];\r\n\t\tconst resourceAssignments = [];\r\n\t\tlet detectFormat = resourceAssignmentFormat === resourceAssignmentFormats.auto;\r\n\r\n\t\tif (gantt.defined(assignments) && assignments) {\r\n\t\t\tif (!Array.isArray(assignments)) {\r\n\t\t\t\tassignments = [assignments];\r\n\t\t\t\tif (detectFormat) {\r\n\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.singleValue;\r\n\t\t\t\t\tdetectFormat = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst usedIds = {};\r\n\t\t\tassignments.forEach(function (res) {\r\n\t\t\t\tif (!res.resource_id) { // when resource is a string/number\r\n\t\t\t\t\tres = { resource_id: res };\r\n\t\t\t\t\tif (detectFormat) {\r\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.valueArray;\r\n\t\t\t\t\t\tdetectFormat = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//\tisSimpleArray = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (detectFormat) {\r\n\t\t\t\t\tif (res.id && res.resource_id) {\r\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.assignmentsArray;\r\n\t\t\t\t\t\tdetectFormat = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.resourceValueArray;\r\n\t\t\t\t\t\tdetectFormat = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet defaultMode = assignmentModes.default;\r\n\t\t\t\tif(!res.mode){\r\n\t\t\t\t\tif((res.start_date && res.end_date) || (res.start_date && res.duration)){\r\n\t\t\t\t\t\tdefaultMode = assignmentModes.fixedDuration;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet id;\r\n\t\t\t\tif(!res.id && res.$id && !usedIds[res.$id]){\r\n\t\t\t\t\tid = res.$id;\r\n\t\t\t\t} else if(res.id && !usedIds[res.id]){\r\n\t\t\t\t\tid = res.id;\r\n\t\t\t\t} else{\r\n\t\t\t\t\tid = gantt.uid();\r\n\t\t\t\t}\r\n\t\t\t\tusedIds[id] = true;\r\n\r\n\t\t\t\tconst assignment = {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\tstart_date: res.start_date,\r\n\t\t\t\t\tduration: res.duration,\r\n\t\t\t\t\tend_date: res.end_date,\r\n\t\t\t\t\tdelay: res.delay,\r\n\t\t\t\t\ttask_id: task.id,\r\n\t\t\t\t\tresource_id: res.resource_id,\r\n\t\t\t\t\tvalue: res.value,\r\n\t\t\t\t\tmode: res.mode || defaultMode\r\n\t\t\t\t};\r\n\t\t\t\t// GS-2490: to add custom properties to assignment\r\n\t\t\t\t// need to exclude $id which incfluences on render \r\n\t\t\t\tObject.keys(res).forEach(key => {\r\n\t\t\t\t\tif(key != \"$id\") {\r\n\t\t\t\t\t\tassignment[key] = res[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif(!(assignment.start_date && assignment.start_date.getMonth \r\n\t\t\t\t\t&& assignment.end_date && assignment.end_date.getMonth && typeof assignment.duration === \"number\")){\r\n\t\t\t\t\tinitAssignmentFields(assignment, task);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresourceAssignments.push(assignment);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn resourceAssignments;\r\n\t}\r\n\r\n\tfunction _updateTaskBack(taskId) {\r\n\t\t// GS-1493. In some cases, the resource assignment store has the tasks that no longer exist\r\n\t\tif (!gantt.isTaskExists(taskId)){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar task = gantt.getTask(taskId);\r\n\t\tvar assignments = gantt.getTaskAssignments(task.id);\r\n\t\t_assignAssignments(task, assignments);\r\n\t}\r\n\r\n\tfunction _assignAssignments(task, assignments){\r\n\t\tassignments.sort(function(a, b){\r\n\t\t\tif(a.start_date && b.start_date && a.start_date.valueOf() != b.start_date.valueOf()){\r\n\t\t\t\treturn a.start_date - b.start_date;\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray) {\r\n\t\t\ttask[gantt.config.resource_property] = assignments;\r\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray) {\r\n\t\t\ttask[gantt.config.resource_property] = assignments.map(function (a) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t$id: a.id,\r\n\t\t\t\t\tstart_date: a.start_date,\r\n\t\t\t\t\tduration: a.duration,\r\n\t\t\t\t\tend_date: a.end_date,\r\n\t\t\t\t\tdelay: a.delay,\r\n\t\t\t\t\tresource_id: a.resource_id,\r\n\t\t\t\t\tvalue: a.value,\r\n\t\t\t\t\tmode: a.mode\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\ttask[resourceAssignmentsProperty] = assignments;\r\n\t}\r\n\r\n\tfunction _loadAssignmentsFromTask(task) {\r\n\t\tvar assignments = _makeAssignmentsFromTask(task);\r\n\t\tvar taskAssignments = [];\r\n\t\tassignments.forEach(function (a) {\r\n\t\t\ta.id = a.id || gantt.uid();\r\n\t\t\t//var newId = resourceAssignmentsStore.addItem(a);\r\n\t\t\ttaskAssignments.push(a);\r\n\t\t});\r\n\r\n\t\treturn assignments;\r\n\t}\r\n\r\n\tfunction diffAssignments(taskValues, assignmentsStoreValues) {\r\n\t\tvar result = {\r\n\t\t\tinBoth: [],\r\n\t\t\tinTaskNotInStore: [],\r\n\t\t\tinStoreNotInTask: []\r\n\t\t};\r\n\r\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.singleValue) {\r\n\t\t\tvar taskOwner = taskValues[0];\r\n\t\t\tvar ownerId = taskOwner ? taskOwner.resource_id : null;\r\n\t\t\tvar foundOwnerAssignment = false;\r\n\t\t\tassignmentsStoreValues.forEach(function (a) {\r\n\t\t\t\tif (a.resource_id != ownerId) {\r\n\t\t\t\t\tresult.inStoreNotInTask.push(a);\r\n\t\t\t\t} else if (a.resource_id == ownerId) {\r\n\t\t\t\t\tresult.inBoth.push({ store: a, task: taskOwner });\r\n\t\t\t\t\tfoundOwnerAssignment = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tif (!foundOwnerAssignment && taskOwner) {\r\n\t\t\t\tresult.inTaskNotInStore.push(taskOwner);\r\n\t\t\t}\r\n\r\n\r\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.valueArray){\r\n\r\n\t\t\tvar taskSearch = {};\r\n\t\t\tvar storeSearch = {};\r\n\t\t\tvar processedIds = {};\r\n\t\t\ttaskValues.forEach(function (a) {\r\n\t\t\t\ttaskSearch[a.resource_id] = a;\r\n\t\t\t});\r\n\t\t\tassignmentsStoreValues.forEach(function (a) {\r\n\t\t\t\tstoreSearch[a.resource_id] = a;\r\n\t\t\t});\r\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\r\n\t\t\t\tif (processedIds[a.resource_id]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tprocessedIds[a.resource_id] = true;\r\n\t\t\t\tvar inTask = taskSearch[a.resource_id];\r\n\t\t\t\tvar inStore = storeSearch[a.resource_id];\r\n\r\n\t\t\t\tif (inTask && inStore) {\r\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\r\n\t\t\t\t} else if (inTask && !inStore) {\r\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\r\n\t\t\t\t} else if (!inTask && inStore) {\r\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if ((resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray)\r\n\t\t\t|| (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray)) {\r\n\t\t\tvar taskSearch = {};\r\n\t\t\tvar storeSearch = {};\r\n\t\t\tvar processedIds = {};\r\n\t\t\ttaskValues.forEach(function (a) {\r\n\t\t\t\ttaskSearch[a.id || a.$id] = a;\r\n\t\t\t});\r\n\t\t\tassignmentsStoreValues.forEach(function (a) {\r\n\t\t\t\tstoreSearch[a.id] = a;\r\n\t\t\t});\r\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\r\n\t\t\t\tvar id = a.id || a.$id;\r\n\t\t\t\tif (processedIds[id]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tprocessedIds[id] = true;\r\n\t\t\t\tvar inTask = taskSearch[id];\r\n\t\t\t\tvar inStore = storeSearch[id];\r\n\r\n\t\t\t\tif (inTask && inStore) {\r\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\r\n\t\t\t\t} else if (inTask && !inStore) {\r\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\r\n\t\t\t\t} else if (!inTask && inStore) {\r\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction assignmentHasChanged(source, target) {\r\n\t\tvar ignoreFields = {\r\n\t\t\tid: true\r\n\t\t};\r\n\r\n\t\tfor (var i in source) {\r\n\t\t\tif (!ignoreFields[i]) {\r\n\t\t\t\tif (String(source[i]) !== String(target[i])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tfunction updateAssignment(source, target) {\r\n\t\tvar ignoreFields = {\r\n\t\t\tid: true\r\n\t\t};\r\n\r\n\t\tfor (var i in source) {\r\n\t\t\tif (!ignoreFields[i]) {\r\n\t\t\t\ttarget[i] = source[i];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _syncAssignments(task, storeAssignments){\r\n\t\tvar tasksAssignments = _makeAssignmentsFromTask(task);\r\n\r\n\t\tvar diff = diffAssignments(tasksAssignments, storeAssignments);\r\n\t\tdiff.inStoreNotInTask.forEach(function (a) {\r\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\r\n\t\t});\r\n\t\tdiff.inTaskNotInStore.forEach(function (a) {\r\n\t\t\tresourceAssignmentsStore.addItem(a);\r\n\t\t});\r\n\r\n\t\tdiff.inBoth.forEach(function (a) {\r\n\t\t\tif (assignmentHasChanged(a.task, a.store)) {\r\n\t\t\t\tupdateAssignment(a.task, a.store);\r\n\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\r\n\t\t\t} else {\r\n\t\t\t\tif (a.task.start_date && a.task.end_date && a.task.mode !== assignmentModes.fixedDates) {\r\n\t\t\t\t\tvar timing = _assignmentTimeFromTask(a.store, task);\r\n\t\t\t\t\tif (a.store.start_date.valueOf() != timing.start_date.valueOf() || a.store.end_date.valueOf() != timing.end_date.valueOf()) {\r\n\t\t\t\t\t\ta.store.start_date = timing.start_date;\r\n\t\t\t\t\t\ta.store.end_date = timing.end_date;\r\n\t\t\t\t\t\ta.store.duration = timing.duration;\r\n\t\t\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t_updateTaskBack(task.id);\r\n\t}\r\n\r\n\tfunction _syncOnTaskUpdate(task) {\r\n\t\tvar storeAssignments = task[resourceAssignmentsProperty] || resourceAssignmentsStore.find(function (a) {\r\n\t\t\treturn a.task_id == task.id;\r\n\t\t});\r\n\r\n\t\t_syncAssignments(task, storeAssignments);\r\n\t}\r\n\r\n\tfunction _syncOnTaskDelete(ids) {\r\n\t\tvar idsSearch = {};\r\n\t\tids.forEach(function (id) {\r\n\t\t\tidsSearch[id] = true;\r\n\t\t});\r\n\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\r\n\t\t\treturn idsSearch[a.task_id];\r\n\t\t});\r\n\t\ttaskResources.forEach(function (a) {\r\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\r\n\t\t});\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\r\n\t\tif (gantt.config.process_resource_assignments) {\r\n\t\t\tgantt.attachEvent(\"onParse\", function () {\r\n\t\t\t\tgantt.silent(function () {\r\n\t\t\t\t\tresourceAssignmentsStore.clearAll();\r\n\t\t\t\t\tvar totalAssignments = [];\r\n\t\t\t\t\tgantt.eachTask(function (task) {\r\n\t\t\t\t\t\tif (task.type === gantt.config.types.project) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar assignments = _loadAssignmentsFromTask(task);\r\n\t\t\t\t\t\t_assignAssignments(task, assignments);\r\n\r\n\t\t\t\t\t\tassignments.forEach(function (a) {\r\n\t\t\t\t\t\t\ttotalAssignments.push(a);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\tresourceAssignmentsStore.parse(totalAssignments);\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\r\n\t\t\tvar batchUpdate = false;\r\n\t\t\tvar needUpdate = false;\r\n\t\t\tvar needUpdateFor = {};\r\n\t\t\tvar undoBatchCancel = false;\r\n\t\t\tgantt.attachEvent(\"onBeforeBatchUpdate\", function(){\r\n\t\t\t\tbatchUpdate = true;\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\r\n\t\t\t\t\r\n\t\t\t\tif(needUpdate){\r\n\t\t\t\t\tvar assignmentsHash = {};\r\n\t\t\t\t\tfor(var i in needUpdateFor){\r\n\t\t\t\t\t\tassignmentsHash[i] = gantt.getTaskAssignments(needUpdateFor[i].id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// GS-2546. If we add a task that has the data in the old format,\r\n\t\t\t\t\t// we need to reset the cache as the assignment will be added\r\n\t\t\t\t\t// to the assignment store, but the cache won't have the changes\r\n\t\t\t\t\tif (gantt.config.process_resource_assignments && resourceAssignmentFormat === \"resourceValueArray\"){\r\n\t\t\t\t\t\ttaskAssignmentsCache = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor(var i in needUpdateFor){\r\n\t\t\t\t\t\t_syncAssignments(needUpdateFor[i], assignmentsHash[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tneedUpdate = false;\r\n\t\t\t\tbatchUpdate = false;\r\n\t\t\t\tneedUpdateFor = {};\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (item) {\r\n\t\t\t\tvar assignments = _loadAssignmentsFromTask(item);\r\n\t\t\t\tresourceAssignmentsStore.parse(assignments);\r\n\t\t\t\t_assignAssignments(item, assignments);\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\r\n\t\t\t\tif(batchUpdate){\r\n\t\t\t\t\tneedUpdate = true;\r\n\t\t\t\t\tneedUpdateFor[id] = item;\r\n\t\t\t\t}else if (!item.unscheduled){\r\n\t\t\t\t\t_syncOnTaskUpdate(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\r\n\t\t\t\tif(batchUpdate){\r\n\t\t\t\t\tneedUpdate = true;\r\n\t\t\t\t\tneedUpdateFor[id] = item;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t_syncOnTaskUpdate(item);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t/*\tgantt.attachEvent(\"onRowDragMove\", function (id) {\r\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\r\n\t\t\t});*/\r\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", function (id) {\r\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\r\n\t\t\t});\r\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (id, item) {\r\n\t\t\t\tvar deleteIds = [id];\r\n\t\t\t\tgantt.eachTask(function (task) {\r\n\t\t\t\t\tdeleteIds.push(task.id);\r\n\t\t\t\t}, id);\r\n\t\t\t\t_syncOnTaskDelete(deleteIds);\r\n\t\t\t});\r\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\r\n\t\t\t\tresourceAssignmentsCache = null;\r\n\t\t\t\tresourceTaskAssignmentsCache = null;\r\n\t\t\t\ttaskAssignmentsCache = null;\r\n\t\t\t\tresourceAssignmentsStore.clearAll();\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\r\n\t\t\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\r\n\t\t\t\t\treturn a.task_id == id;\r\n\t\t\t\t});\r\n\t\t\t\ttaskResources.forEach(function (a) {\r\n\t\t\t\t\ta.task_id = new_id;\r\n\t\t\t\t\tresourceAssignmentsStore.updateItem(a.id);\r\n\t\t\t\t});\r\n\t\t\t\t_updateTaskBack(new_id);\r\n\t\t\t\t//any custom logic here\r\n\t\t\t});\r\n\t\t\t// GS-2144. When we Undo something, the cache should be reset\r\n\t\t\t// during the `onStoreUpdated` event to properly update the assignments\r\n\t\t\tgantt.attachEvent(\"onBeforeUndo\", function (action) {\r\n\t\t\t\tundoBatchCancel = true;\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tgantt.attachEvent(\"onAfterUndo\", function (action) {\r\n\t\t\t\tundoBatchCancel = true;\r\n\t\t\t});\r\n\r\n\r\n\t\t\tvar resourceAssignmentsCache = null;\r\n\t\t\tvar resourceTaskAssignmentsCache = null;\r\n\t\t\tvar taskAssignmentsCache = null;\r\n\r\n\t\t\tresourceAssignmentsStore.attachEvent(\"onStoreUpdated\", function resetCache(){\r\n\t\t\t\tif(batchUpdate && !undoBatchCancel){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tresourceAssignmentsCache = null;\r\n\t\t\t\tresourceTaskAssignmentsCache = null;\r\n\t\t\t\ttaskAssignmentsCache = null;\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\r\n\t\t\tgantt.getResourceAssignments = function (resourceId, taskId) {\r\n\t\t\t\tvar searchTaskId = gantt.defined(taskId) && taskId !== null;\r\n\r\n\t\t\t\tif(resourceAssignmentsCache === null){\r\n\t\t\t\t\tresourceAssignmentsCache = {};\r\n\t\t\t\t\tresourceTaskAssignmentsCache = {};\r\n\r\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\r\n\t\t\t\t\t\tif(!resourceAssignmentsCache[a.resource_id]){\r\n\t\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id].push(a);\r\n\r\n\t\t\t\t\t\tvar resourceTaskCacheKey = a.resource_id + \"-\" + a.task_id;\r\n\t\t\t\t\t\tif(!resourceTaskAssignmentsCache[resourceTaskCacheKey]){\r\n\t\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey].push(a);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tif(searchTaskId){\r\n\t\t\t\t\treturn (resourceTaskAssignmentsCache[resourceId + \"-\" + taskId] || []).slice();\r\n\t\t\t\t}else{\r\n\t\t\t\t\treturn (resourceAssignmentsCache[resourceId] || []).slice();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t\r\n\t\t\tgantt.getTaskAssignments = function (taskId) {\r\n\t\t\t\tif(taskAssignmentsCache === null){\r\n\t\t\t\t\tvar result = [];\r\n\t\t\t\t\ttaskAssignmentsCache = {};\r\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\r\n\t\t\t\t\t\tif(!taskAssignmentsCache[a.task_id]){\r\n\t\t\t\t\t\t\ttaskAssignmentsCache[a.task_id] = [];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttaskAssignmentsCache[a.task_id].push(a);\r\n\t\t\t\t\t\tif (a.task_id == taskId) {\r\n\t\t\t\t\t\t\tresult.push(a);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\treturn (taskAssignmentsCache[taskId] || []).slice();\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tgantt.getTaskResources = function (taskId) {\r\n\t\t\t\tconst store = gantt.getDatastore(\"resource\");\r\n\t\t\t\tconst assignments = gantt.getTaskAssignments(taskId);\r\n\t\r\n\t\t\t\tconst uniqueResources = {};\r\n\t\t\t\tassignments.forEach(function(a){\r\n\t\t\t\t\tif(!uniqueResources[a.resource_id]){\r\n\t\t\t\t\t\tuniqueResources[a.resource_id] = a.resource_id;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tconst resources = [];\r\n\t\t\t\tfor(const i in uniqueResources){\r\n\t\t\t\t\tconst res = store.getItem(uniqueResources[i]);\r\n\t\t\t\t\tif(res){\r\n\t\t\t\t\t\tresources.push(res);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn resources;\r\n\t\t\t};\r\n\r\n\t\t\tgantt.updateTaskAssignments = _updateTaskBack;\r\n\t\t}\r\n\t}, {once: true});\r\n};","export default function addPlaceholder(gantt){\r\n\tfunction isEnabled(){\r\n\t\treturn gantt.config.placeholder_task;\r\n\t}\r\n\r\n\tfunction callIfEnabled(callback){\r\n\t\treturn function(){\r\n\t\t\tif(!isEnabled()){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn callback.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\r\n\tfunction silenceDataProcessor(dataProcessor){\r\n\t\tif(dataProcessor && !dataProcessor._silencedPlaceholder){\r\n\t\t\tdataProcessor._silencedPlaceholder = true;\r\n\t\t\tdataProcessor.attachEvent(\"onBeforeUpdate\", callIfEnabled(function(id, state, data){\r\n\t\t\t\tif(data.type == gantt.config.types.placeholder){\r\n\t\t\t\t\tdataProcessor.setUpdated(id, false);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}));\r\n\t\t}\r\n\t}\r\n\r\n\tfunction insertPlaceholder(){\r\n\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\r\n\t\tif(!placeholders.length || !gantt.isTaskExists(placeholders[0].id)){\r\n\t\t\tvar placeholder = {\r\n\t\t\t\tunscheduled: true,\r\n\t\t\t\ttype: gantt.config.types.placeholder,\r\n\t\t\t\tduration:0,\r\n\t\t\t\ttext: gantt.locale.labels.new_task\r\n\t\t\t};\r\n\t\t\tif(gantt.callEvent(\"onTaskCreated\", [placeholder]) === false){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tgantt.addTask(placeholder);\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tfunction afterEdit(id){\r\n\t\tvar item = gantt.getTask(id);\r\n\t\tif(item.type == gantt.config.types.placeholder) {\r\n\t\t\tif(item.start_date && item.end_date && item.unscheduled){\r\n\t\t\t\titem.unscheduled = false;\r\n\t\t\t}\r\n\r\n\t\t\tgantt.batchUpdate(function(){\r\n\t\t\t\tvar newTask = gantt.copy(item);\r\n\t\t\t\tgantt.silent(function(){\r\n\t\t\t\t\tgantt.deleteTask(item.id);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdelete newTask[\"!nativeeditor_status\"];\r\n\t\t\t\tnewTask.type = gantt.config.types.task;\r\n\t\t\t\tnewTask.id = gantt.uid();\r\n\t\t\t\tgantt.addTask(newTask);\r\n\r\n\t\t\t\t//insertPlaceholder();\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tgantt.config.types.placeholder = \"placeholder\";\r\n\tgantt.attachEvent(\"onDataProcessorReady\", callIfEnabled(silenceDataProcessor));\r\n\r\n\tvar ready = false;\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tif(ready){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tready = true;\r\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(afterEdit));\r\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id, task){\r\n\t\t\tif(task.type != gantt.config.types.placeholder){\r\n\t\t\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\r\n\t\t\t\tplaceholders.forEach(function(p){\r\n\t\t\t\t\tgantt.silent(function(){\r\n\t\t\t\t\t\tif(gantt.isTaskExists(p.id))\r\n\t\t\t\t\t\t\tgantt.deleteTask(p.id);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tinsertPlaceholder();\r\n\t\t\t}\r\n\t\t}));\r\n\t\tgantt.attachEvent(\"onParse\", callIfEnabled(insertPlaceholder));\r\n\t});\r\n\r\n\tfunction isPlaceholderTask(taskId){\r\n\t\tif(gantt.config.types.placeholder && gantt.isTaskExists(taskId)){\r\n\t\t\tvar task = gantt.getTask(taskId);\r\n\t\t\tif(task.type == gantt.config.types.placeholder){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tfunction isPlaceholderLink(link){\r\n\t\tif(isPlaceholderTask(link.source) || isPlaceholderTask(link.target)){\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\r\n\t\tif(isPlaceholderLink(link)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t});\r\n\tgantt.attachEvent(\"onBeforeLinkAdd\", function(id,link){\r\n\t\tif(isPlaceholderLink(link)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onBeforeUndoStack\", function(action){\r\n\t\tfor(var i = 0; i < action.commands.length; i++){\r\n\t\t\tvar command = action.commands[i];\r\n\t\t\tif(command.entity === \"task\" && command.value.type === gantt.config.types.placeholder){\r\n\t\t\t\taction.commands.splice(i,1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t});\r\n\r\n};","export default function(gantt) {\r\n\tfunction isEnabled() {\r\n\t\treturn gantt.config.auto_types && // if enabled\r\n\t\t\t(gantt.getTaskType(gantt.config.types.project) == gantt.config.types.project);// and supported\r\n\t}\r\n\r\n\tfunction callIfEnabled(callback) {\r\n\t\treturn function() {\r\n\t\t\tif (!isEnabled()) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn callback.apply(this, arguments);\r\n\t\t};\r\n\t}\r\n\r\n\tfunction checkTaskType(id, changedTypes) {\r\n\t\tvar task = gantt.getTask(id);\r\n\t\tvar targetType = getTaskTypeToUpdate(task);\r\n\t\tif (targetType !== false && gantt.getTaskType(task) !== targetType) {\r\n\t\t\tchangedTypes.$needsUpdate = true;\r\n\t\t\tchangedTypes[task.id] = {task: task, type: targetType};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getUpdatedTypes(id, changedTypes) {\r\n\t\tchangedTypes = changedTypes || {};\r\n\t\t\r\n\t\tcheckTaskType(id, changedTypes);\r\n\t\tgantt.eachParent(function(parent) {\r\n\t\t\tcheckTaskType(parent.id, changedTypes);\r\n\t\t}, id);\r\n\r\n\t\treturn changedTypes;\r\n\t}\r\n\r\n\tfunction applyChanges(changedTypes) {\r\n\t\tfor (var i in changedTypes) {\r\n\t\t\tif(changedTypes[i] && changedTypes[i].task){\r\n\t\t\t\tvar task = changedTypes[i].task;\r\n\t\t\t\ttask.type = changedTypes[i].type;\r\n\t\t\t\tgantt.updateTask(task.id);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction updateParentTypes(startId) {\r\n\t\tif (gantt.getState().group_mode) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar changedTypes = getUpdatedTypes(startId);\r\n\t\tif (changedTypes.$needsUpdate) {\r\n\t\t\tgantt.batchUpdate(function() {\r\n\t\t\t\tapplyChanges(changedTypes);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tvar delTaskParent;\r\n\r\n\tfunction updateTaskType(task, targetType) {\r\n\t\tif(!gantt.getState().group_mode){\r\n\t\t\ttask.type = targetType;\r\n\t\t\tgantt.updateTask(task.id);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTaskTypeToUpdate(task) {\r\n\t\tvar allTypes = gantt.config.types;\r\n\t\tvar hasChildren = gantt.hasChild(task.id);\r\n\t\tvar taskType = gantt.getTaskType(task.type);\r\n\r\n\t\tif (hasChildren && taskType === allTypes.task) {\r\n\t\t\treturn allTypes.project;\r\n\t\t}\r\n\r\n\t\tif (!hasChildren && taskType === allTypes.project) {\r\n\t\t\treturn allTypes.task;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar isParsingDone = true;\r\n\r\n\tgantt.attachEvent(\"onParse\", callIfEnabled(function() {\r\n\t\tisParsingDone = false;\r\n\t\tif(gantt.getState().group_mode){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tgantt.batchUpdate(function() {\r\n\t\t\tgantt.eachTask(function(task) {\r\n\t\t\t\tvar targetType = getTaskTypeToUpdate(task);\r\n\t\t\t\tif (targetType !== false) {\r\n\t\t\t\t\tupdateTaskType(task, targetType);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tisParsingDone = true;\r\n\t}));\r\n\r\n\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id) {\r\n\t\tif (isParsingDone) {\r\n\t\t\tupdateParentTypes(id);\r\n\t\t}\r\n\t}));\r\n\r\n\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(function(id) {\r\n\t\tif (isParsingDone) {\r\n\t\t\tupdateParentTypes(id);\r\n\t\t}\r\n\t}));\r\n\r\n\tfunction updateAfterRemoveChild(id){\r\n\t\tif (id != gantt.config.root_id && gantt.isTaskExists(id)) {\r\n\t\t\tupdateParentTypes(id);\r\n\t\t}\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onBeforeTaskDelete\", callIfEnabled(function(id, task) {\r\n\t\tdelTaskParent = gantt.getParent(id);\r\n\t\treturn true;\r\n\t}));\r\n\r\n\tgantt.attachEvent(\"onAfterTaskDelete\", callIfEnabled(function(id, task) {\r\n\t\tupdateAfterRemoveChild(delTaskParent);\r\n\t}));\r\n\r\n\r\n\tvar originalRowDndParent;\r\n\r\n\tgantt.attachEvent(\"onRowDragStart\", callIfEnabled(function(id, target, e) {\r\n\t\toriginalRowDndParent = gantt.getParent(id);\r\n\t\treturn true;\r\n\t}));\r\n\r\n\tgantt.attachEvent(\"onRowDragEnd\", callIfEnabled(function(id, target) {\r\n\t\tupdateAfterRemoveChild(originalRowDndParent);\r\n\t\tupdateParentTypes(id);\r\n\t}));\r\n\r\n\tvar originalMoveTaskParent;\r\n\r\n\tgantt.attachEvent(\"onBeforeTaskMove\", callIfEnabled(function(sid, parent, tindex) {\r\n\t\toriginalMoveTaskParent = gantt.getParent(sid);\r\n\t\treturn true;\r\n\t}));\r\n\r\n\tgantt.attachEvent(\"onAfterTaskMove\", callIfEnabled(function(id, parent, tindex) {\r\n\t\tif (document.querySelector(\".gantt_drag_marker\")) {\r\n\t\t\t// vertical dnd in progress\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tupdateAfterRemoveChild(originalMoveTaskParent);\r\n\t\tupdateParentTypes(id);\r\n\t}));\r\n};","export default class DurationFormatterNumeric implements IDurationFormatter {\r\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\r\n\t\treturn new DurationFormatterNumeric();\r\n\t};\r\n\tcanParse = (value: string) : boolean => {\r\n\t\treturn !isNaN(this.parse(value));\r\n\t};\r\n\tformat = (value: number) : string => {\r\n\t\treturn String(value);\r\n\t};\r\n\tparse = (value: string) : number => {\r\n\t\treturn parseInt(value, 10);\r\n\t};\r\n}","export default class LinkFormatterSimple implements ILinkFormatter {\r\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatterSimple => {\r\n\t\treturn new LinkFormatterSimple(gantt);\r\n\t};\r\n\tprotected _linkReg: RegExp;\r\n\tprotected _gantt: any;\r\n\r\n\tconstructor(gantt: any) {\r\n\t\tthis._linkReg = /^[0-9\\.]+/;\r\n\t\tthis._gantt = gantt;\r\n\t}\r\n\r\n\tformat = (link: ILink) : string => {\r\n\t\tconst wbs = this._getWBSCode(link.source);\r\n\t\treturn wbs;\r\n\t};\r\n\r\n\tcanParse = (value: string) : boolean => {\r\n\t\treturn this._linkReg.test(value);\r\n\t};\r\n\tparse = (value: string) : ILink => {\r\n\t\tif(!this.canParse(value)){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\r\n\r\n\t\tconst source = this._findSource(linkPart) || null;\r\n\r\n\t\treturn {\r\n\t\t\tid: undefined,\r\n\t\t\tsource,\r\n\t\t\ttarget: null,\r\n\t\t\ttype: this._gantt.config.links.finish_to_start,\r\n\t\t\tlag: 0\r\n\t\t};\r\n\t};\r\n\r\n\tprotected _getWBSCode = (source: number | string) => {\r\n\t\tconst pred = this._gantt.getTask(source);\r\n\t\treturn this._gantt.getWBSCode(pred);\r\n\t};\r\n\r\n\tprotected _findSource = (value: string) => {\r\n\t\tconst reqTemplate = new RegExp(\"^[0-9\\.]+\", \"i\");\r\n\t\tif(reqTemplate.exec(value)){\r\n\t\t\tconst wbs = reqTemplate.exec(value)[0];\r\n\t\t\tconst task = this._gantt.getTaskByWBSCode(wbs);\r\n\t\t\tif(task){\r\n\t\t\t\treturn task.id;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n}","\r\nimport DurationFormatter from \"../common/duration_formatter\";\r\nimport LinkFormatter from \"../common/link_formatter\";\r\n\r\nexport default function(gantt){\r\n\tgantt.ext.formatters = {\r\n\t\tdurationFormatter: function(settings){\r\n\t\t\tif(!settings){\r\n\t\t\t\tsettings = {};\r\n\t\t\t}\r\n\t\t\tif(!settings.store){\r\n\t\t\t\tsettings.store = gantt.config.duration_unit;\r\n\t\t\t}\r\n\t\t\tif(!settings.enter){\r\n\t\t\t\tsettings.enter = gantt.config.duration_unit;\r\n\t\t\t}\r\n\t\t\treturn DurationFormatter.create(settings, gantt);\r\n\t\t},\r\n\t\tlinkFormatter: function(settings){\r\n\t\t\treturn LinkFormatter.create(settings, gantt);\r\n\t\t}\r\n\t};\r\n};","export default function(gantt: any){\r\n\r\n\tgantt.ext = gantt.ext || {};\r\n\tgantt.config.show_empty_state = false;\r\n\r\n\tgantt.ext.emptyStateElement = gantt.ext.emptyStateElement || {\r\n\t\tisEnabled() {\r\n\t\t\treturn gantt.config.show_empty_state === true;\r\n\t\t},\r\n\t\tisGanttEmpty(){\r\n\t\t\treturn !gantt.getTaskByTime().length;\r\n\t\t},\r\n\t\trenderContent(container){\r\n\t\t\tconst placeholderTextElement = `<div class='gantt_empty_state_text'>\r\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${gantt.locale.labels.empty_state_text_link}</div>\r\n    <div class='gantt_empty_state_text_description'>${gantt.locale.labels.empty_state_text_description}</div>\r\n    </div>`;\r\n\t\t\tconst placeholderImageElement = \"<div class='gantt_empty_state_image'></div>\";\r\n\r\n\t\t\tconst placeholderContainer = `<div class='gantt_empty_state'>${placeholderImageElement}${placeholderTextElement}</div>`;\r\n\t\t\tcontainer.innerHTML = placeholderContainer;\r\n\t\t},\r\n\r\n\t\tclickEvents: [],\r\n\t\tattachAddTaskEvent(){\r\n\t\t\tconst id = gantt.attachEvent(\"onEmptyClick\", function(e){\r\n\t\t\t\tconst domHelpers = gantt.utils.dom;\r\n\t\t\t\tconst gridPlaceholder = domHelpers.closest(e.target, \"[data-empty-state-create-task]\");\r\n\t\t\t\tif (gridPlaceholder){\r\n\t\t\t\t\tgantt.createTask({\r\n\t\t\t\t\t\tid: gantt.uid(),\r\n\t\t\t\t\t\ttext: \"New Task\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis.clickEvents.push(id);\r\n\t\t},\r\n\t\tdetachAddTaskEvents(){\r\n\t\t\tthis.clickEvents.forEach(function(event){\r\n\t\t\t\tgantt.detachEvent(event);\r\n\t\t\t});\r\n\t\t\tthis.clickEvents = [];\r\n\t\t},\r\n\r\n\t\tgetContainer(){\r\n\t\t\tif (gantt.$container) {\r\n\t\t\t\tconst domHelpers = gantt.utils.dom;\r\n\t\t\t\tif (gantt.$container.contains(gantt.$grid_data)) {\r\n\t\t\t\t\treturn domHelpers.closest(gantt.$grid_data, \".gantt_layout_content\");\r\n\t\t\t\t}\r\n\t\t\t\tif (gantt.$container.contains(gantt.$task_data)){\r\n\t\t\t\t\treturn domHelpers.closest(gantt.$task_data, \".gantt_layout_content\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn null;\r\n\t\t},\r\n\r\n\t\tgetNode(){\r\n\t\t\tconst container = this.getContainer();\r\n\t\t\tif (!container){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tconst emptyStateElementNode = container.querySelector(\".gantt_empty_state_wrapper\");\r\n\t\t\treturn emptyStateElementNode;\r\n\t\t},\r\n\r\n\t\tshow(){\r\n\t\t\tconst container = this.getContainer();\r\n\t\t\tif (!container && this.isGanttEmpty()){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconst wrapper = document.createElement(\"div\");\r\n\t\t\twrapper.className = \"gantt_empty_state_wrapper\";\r\n\t\t\twrapper.style.marginTop = (gantt.config.scale_height - container.offsetHeight) + \"px\";\r\n\t\t\tconst oldNodes = gantt.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\r\n\t\t\t// for IE11\r\n\t\t\tArray.prototype.forEach.call(oldNodes, function(node){\r\n\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t});\r\n\r\n\t\t\tthis.detachAddTaskEvents();\r\n\t\t\tthis.attachAddTaskEvent();\r\n\r\n\t\t\tcontainer.appendChild(wrapper);\r\n\t\t\tthis.renderContent(wrapper);\r\n\t\t},\r\n\t\thide(){\r\n\t\t\tconst emptyStateElementNode = this.getNode();\r\n\t\t\tif (emptyStateElementNode){\r\n\t\t\t\temptyStateElementNode.parentNode.removeChild(emptyStateElementNode);\r\n\t\t\t} else{\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tinit(){ }\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onDataRender\", function() {\r\n\t\tconst emptyStateElement = gantt.ext.emptyStateElement;\r\n\t\tif (emptyStateElement.isEnabled() && emptyStateElement.isGanttEmpty()) {\r\n\t\t\temptyStateElement.show();\r\n\t\t} else {\r\n\t\t\temptyStateElement.hide();\r\n\t\t}\r\n\t});\r\n\r\n\r\n\r\n\r\n}\r\n","export const hasBaselinesBelow = function (gantt, task) {\r\n  const baselines = task.baselines && task.baselines.length;\r\n  const baselinesOnDifferentRow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\r\n  if (baselines && baselinesOnDifferentRow) {\r\n    return true;\r\n  }\r\n};\r\n\r\nexport const childrenHaveBaselines = function (gantt, taskId) {\r\n  let hasBaselines = false;\r\n  gantt.eachTask(function (child) {\r\n    if (hasBaselines) {\r\n      return;\r\n    }\r\n    hasBaselines = hasBaselinesBelow(gantt, child);\r\n  }, taskId);\r\n  return hasBaselines;\r\n};\r\n\r\nexport const isSplitChild = function (gantt, id) {\r\n  let splitChild = false;\r\n  gantt.eachParent(function (parent) {\r\n    if (isSplitParent(parent)) {\r\n      splitChild = true;\r\n    }\r\n  }, id);\r\n  return splitChild;\r\n};\r\n\r\nexport const isSplitParent = function (task) {\r\n  return task.render && task.render == \"split\" && !task.$open;\r\n};\r\n\r\nexport const getMaxParentHeight = function (gantt, view, task, heightLimit) {\r\n  let maxHeight = heightLimit || view.$task_data.scrollHeight;\r\n  let shrinkHeight = false;\r\n  let splitChild = false;\r\n\r\n  gantt.eachParent(function (parent) {\r\n    if (isSplitParent(parent)) {\r\n      splitChild = true;\r\n      const parentSizes = view.getItemPosition(parent);\r\n      const parentHeight = parentSizes.rowHeight;\r\n      if (parentHeight < maxHeight) {\r\n        maxHeight = parentHeight;\r\n        shrinkHeight = true;\r\n      }\r\n    }\r\n  }, task.id);\r\n\r\n  return { maxHeight, shrinkHeight, splitChild };\r\n};\r\n\r\nexport const getMilestoneHeight = function (height) {\r\n  return Math.sqrt(2 * height * height);\r\n};\r\n\r\nexport const getInvertedMilestoneHeight = function (height) {\r\n  return Math.round(height / Math.sqrt(2));\r\n};\r\n\r\nexport const getAdjustedPosition = function (gantt, timeline, sizes, heightLimit, task, childBaselines) {\r\n  const baselines = hasBaselinesBelow(gantt, task);\r\n\r\n  const splitParams = getMaxParentHeight(gantt, timeline, task);\r\n  let maxHeight = splitParams.maxHeight;\r\n\r\n  let height = sizes.height;\r\n  let largerHeight = height > heightLimit;\r\n  let noNeedToShrink = sizes.rowHeight >= heightLimit && !splitParams.splitChild && !baselines;\r\n  if (largerHeight || noNeedToShrink) {\r\n    height = heightLimit;\r\n  }\r\n\r\n  if (maxHeight < height) {\r\n    height = maxHeight;\r\n  }\r\n\r\n  let marginTop = Math.floor((sizes.rowHeight - height) / 2);\r\n\r\n  if (splitParams.splitChild) {\r\n    marginTop = Math.floor((maxHeight - height) / 2);\r\n  }\r\n  if (childBaselines || baselines) {\r\n    let heightDiff = Math.min(sizes.height, maxHeight) - height;\r\n\r\n    let additionalMargin = 2;\r\n    let exceedBarHeight = baselines && task.bar_height >= task.row_height;\r\n    let exceedParentHeight = splitParams.splitChild && sizes.height >= maxHeight;\r\n    if (exceedBarHeight || exceedParentHeight){\r\n      additionalMargin = 0;\r\n    }\r\n\r\n    marginTop = Math.floor(heightDiff / 2) + additionalMargin;\r\n    const bottom = height + marginTop;\r\n    if (bottom > sizes.rowHeight || bottom > maxHeight) {\r\n      // marginTop = 0;\r\n    }\r\n  }\r\n\r\n  return { height, marginTop };\r\n};\r\n\r\nexport default {\r\n  hasBaselinesBelow,\r\n  childrenHaveBaselines,\r\n  isSplitChild,\r\n  isSplitParent,\r\n  getMaxParentHeight,\r\n  getMilestoneHeight,\r\n  getInvertedMilestoneHeight,\r\n  getAdjustedPosition\r\n};\r\n","import { hasBaselinesBelow, isSplitParent } from \"../ui/render/baseline_helper\";\r\nimport isHeadless from \"../../utils/is_headless\";\r\n\r\nexport default function (gantt) {\r\n  gantt.config.baselines = {\r\n    datastore: \"baselines\",\r\n    render_mode: false,\r\n    dataprocessor_baselines: false,\r\n    row_height: 16,\r\n    bar_height: 8\r\n  };\r\n\r\n  function initBaselineFields(item, task) {\r\n    // don't add baseline if it doesn't belong to any task\r\n    // or if doesn't have the dates\r\n    if (!item.task_id || (!item.start_date && !item.end_date)) {\r\n      return false;\r\n    }\r\n\r\n    if (item.start_date) {\r\n      item.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\r\n    } else {\r\n      item.start_date = null;\r\n    }\r\n\r\n    if (item.end_date) {\r\n      item.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\r\n    } else {\r\n      item.end_date = null;\r\n    }\r\n\r\n    // set min baseline duration\r\n    item.duration = item.duration || 1;\r\n\r\n    // GS-2636. Calculate the 3rd date parameter basing on existing date parameters\r\n    if (item.start_date && !item.end_date){\r\n      item.end_date = gantt.calculateEndDate(item.start_date, item.duration);\r\n    } else if (item.end_date && !item.start_date){\r\n      item.start_date = gantt.calculateEndDate(item.end_date, -item.duration);\r\n    } \r\n  }\r\n  // gantt init\r\n  const baselineStore = gantt.createDatastore({\r\n    name: gantt.config.baselines.datastore,\r\n    initItem: function (item) {\r\n      if (!item.id) {\r\n        item.id = gantt.uid();\r\n      }\r\n\r\n      initBaselineFields(item);\r\n\r\n      return item;\r\n    }\r\n  });\r\n\r\n  gantt.$data.baselineStore = baselineStore;\r\n\r\n  function _syncBaselines(task) {\r\n    let shouldRepaint = false;\r\n    const iteratedBaselines = {};\r\n\r\n    const taskBaselines = task.baselines || [];\r\n    const exisingBaselines = gantt.getTaskBaselines(task.id);\r\n\r\n    if (taskBaselines.length != exisingBaselines.length) {\r\n      shouldRepaint = true;\r\n    }\r\n\r\n    taskBaselines.forEach(function (baseline) {\r\n      iteratedBaselines[baseline.id] = true;\r\n      const exisingBaseline = baselineStore.getItem(baseline.id);\r\n      if (exisingBaseline) {\r\n        const start = +exisingBaseline.start_date !== +baseline.start_date;\r\n        const end = +exisingBaseline.end_date !== +baseline.end_date;\r\n        if (start || end) {\r\n          baselineStore.updateItem(baseline.id, baseline);\r\n        }\r\n      } else {\r\n        baselineStore.addItem(baseline);\r\n      }\r\n    });\r\n\r\n    exisingBaselines.forEach(function (baseline) {\r\n      if (!iteratedBaselines[baseline.id]) {\r\n        baselineStore.removeItem(baseline.id);\r\n      }\r\n    });\r\n\r\n    if (shouldRepaint) {\r\n      if (isSplitParent(task)){\r\n        // here we adjust the parent height, then adjust it with the total child height\r\n        _adjustSplitParentHeight (task);\r\n      } else {\r\n        gantt.adjustTaskHeightForBaselines(task);\r\n      }\r\n      gantt.render();\r\n    }\r\n  }\r\n\r\n  function _deleteOrphanBaselines() {\r\n    baselineStore.eachItem(function (baseline) {\r\n      if (!gantt.isTaskExists(baseline.task_id)) {\r\n        baselineStore.removeItem(baseline.id);\r\n      }\r\n    });\r\n  }\r\n\r\n  function _adjustSplitParentHeight (task){\r\n    let maxParentHeight = 0;\r\n\r\n    gantt.adjustTaskHeightForBaselines(task);\r\n\r\n    gantt.eachTask(function(child){\r\n      let childHeight = child.row_height || gantt.config.row_height;\r\n\r\n      maxParentHeight = maxParentHeight || childHeight;\r\n      if (childHeight > maxParentHeight){\r\n        maxParentHeight = childHeight;\r\n      }\r\n    }, task.id);\r\n\r\n    if (task.row_height < maxParentHeight){\r\n      task.row_height = maxParentHeight;\r\n    }\r\n  }\r\n\r\n  gantt.adjustTaskHeightForBaselines = function (task) {\r\n    let height, baselineSize, betweenBaselines;\r\n    let margins = 2;\r\n    let baselineAmount = task.baselines && task.baselines.length || 0;\r\n    const subrowHeight = gantt.config.baselines.row_height;\r\n    //const baselineBarHeight = task?.baselines.bar_height\r\n\r\n    const timelineView = gantt.getLayoutView(\"timeline\");\r\n    if (!timelineView || !gantt.config.show_chart){\r\n      return;\r\n    }\r\n\r\n    switch (gantt.config.baselines.render_mode) {\r\n      case \"taskRow\":\r\n        task.row_height = task.bar_height + 8;\r\n        break;\r\n\r\n      case \"separateRow\":\r\n        height = timelineView.getBarHeight(task.id);\r\n        if (baselineAmount) {\r\n          task.bar_height = task.bar_height || height;\r\n\r\n          if (task.bar_height > height){\r\n            height = task.bar_height;\r\n          }\r\n\r\n          task.row_height = height + subrowHeight;\r\n        } else if (task.bar_height) {\r\n          task.row_height = task.bar_height + 4;\r\n        }\r\n\r\n        _increaseSplitParentHeight(task);\r\n        break;\r\n\r\n      case \"individualRow\":\r\n        height = timelineView.getBarHeight(task.id);\r\n\r\n        if (baselineAmount) {\r\n          task.bar_height = task.bar_height || height;\r\n\r\n          if (task.bar_height > height){\r\n            height = task.bar_height;\r\n          }\r\n\r\n          baselineSize = subrowHeight * baselineAmount;\r\n       //   betweenBaselines = 3 * (baselineAmount + 1);\r\n\r\n          task.row_height = height + baselineSize + margins;\r\n        } else if (task.bar_height){\r\n          task.row_height = task.bar_height + 4;\r\n        }\r\n\r\n        _increaseSplitParentHeight(task);\r\n        break;\r\n      default:\r\n        task.row_height = task.bar_height + 8;\r\n        break;\r\n    }\r\n  };\r\n\r\n  function _increaseSplitParentHeight(task) {\r\n    gantt.eachParent(function (parent) {\r\n      if (isSplitParent(parent)) {\r\n        const parentHeight = parent.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(parent.id);\r\n        let maxHeight = task.row_height;\r\n\r\n        // iterate only direct children\r\n        const subtasks = gantt.getChildren(parent.id);\r\n        subtasks.forEach(function (subtaskId) {\r\n          const subtask = gantt.getTask(subtaskId);\r\n          if (subtask.id == task.id) {\r\n            return;\r\n          }\r\n          const subtaskHeight = subtask.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(subtask.id);\r\n          maxHeight = maxHeight || subtaskHeight;\r\n          if (subtaskHeight > maxHeight) {\r\n            maxHeight = subtaskHeight;\r\n          }\r\n        });\r\n\r\n        parent.row_height = maxHeight;\r\n        parent.bar_height = parent.bar_height || parentHeight;\r\n      }\r\n    }, task.id);\r\n  }\r\n\r\n  gantt.attachEvent(\r\n    \"onGanttReady\",\r\n    function () {\r\n\r\n      if(!gantt.config.baselines){\r\n        return;\r\n      }\r\n\r\n      gantt.attachEvent(\"onParse\", function () {\r\n        baselineStore.eachItem(function (baseline) {\r\n          const taskId = baseline.task_id;\r\n          if (gantt.isTaskExists(taskId)) {\r\n            const task = gantt.getTask(taskId);\r\n\r\n            task.baselines = task.baselines || [];\r\n\r\n            let newBaseline = true;\r\n            for (let i = 0; i < task.baselines.length; i++) {\r\n              let existingBaseline = task.baselines[i];\r\n              if (existingBaseline.id == baseline.id){\r\n                newBaseline = false;\r\n                gantt.mixin(existingBaseline, baseline, true);\r\n                break;\r\n              }\r\n            }\r\n            if (newBaseline){\r\n              task.baselines.push(baseline);\r\n            }\r\n\r\n            if(!isHeadless(gantt)){\r\n              if (isSplitParent(task)){\r\n                _adjustSplitParentHeight (task);\r\n              } else {\r\n                gantt.adjustTaskHeightForBaselines(task);\r\n              }\r\n            }\r\n          }\r\n        });\r\n      });\r\n\r\n      gantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\r\n        _syncBaselines(task);\r\n        return true;\r\n      });\r\n\r\n      gantt.attachEvent(\"onAfterUndo\", function(action){\r\n        const baselinesRenderedBelow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\r\n        if (baselinesRenderedBelow && action){\r\n          let repaint = false;\r\n          action.commands.forEach(function(command){\r\n            if (command.entity == \"task\"){\r\n              const taskId = command.value.id;\r\n              if (gantt.isTaskExists(taskId)){\r\n                const task = gantt.getTask(taskId);\r\n                if (task.parent && gantt.isTaskExists(task.parent)){\r\n                  const parent = gantt.getTask(task.parent);\r\n                  if (isSplitParent(parent)){\r\n                    _adjustSplitParentHeight (parent);\r\n                    repaint = true;\r\n                  }\r\n                }\r\n              }    \r\n            }\r\n          });\r\n          if (repaint){\r\n            gantt.render();\r\n          }\r\n        }\r\n      });\r\n\r\n      gantt.attachEvent(\"onAfterTaskDelete\", function (id, task) {\r\n        if (hasBaselinesBelow){\r\n          if (task.parent && gantt.isTaskExists(task.parent)){\r\n            const parent = gantt.getTask(task.parent);\r\n            if (isSplitParent(parent)){\r\n              _adjustSplitParentHeight (parent);\r\n            }\r\n          }\r\n        }\r\n        _deleteOrphanBaselines();\r\n      });\r\n\r\n      gantt.getTaskBaselines = function (taskId) {\r\n        const baselines = [];\r\n        baselineStore.eachItem(function (baseline) {\r\n          if (baseline.task_id == taskId) {\r\n            baselines.push(baseline);\r\n          }\r\n        });\r\n        return baselines;\r\n      };\r\n      gantt.$data.baselineStore.attachEvent(\"onClearAll\", function () {\r\n        gantt.eachTask(function(task){\r\n          if (task.baselines){\r\n            delete task.baselines;\r\n          }\r\n        });\r\n        // The data should not be repainted as otherwise it causes issues when we have resource \r\n        // assignments and group tasks. It should be fixed when we add a repaint stack\r\n        // gantt.refreshData();\r\n        return true;\r\n      });\r\n\r\n      gantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\r\n        baselineStore.clearAll();\r\n        return true;\r\n      });\r\n      gantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\r\n        const baselines = baselineStore.find(function (a) {\r\n          return a.task_id == id;\r\n        });\r\n        baselines.forEach(function (a) {\r\n          a.task_id = new_id;\r\n          baselineStore.updateItem(a.id);\r\n        });\r\n      });\r\n    },\r\n    { once: true }\r\n  );\r\n};\r\n","import * as helpers from \"../../utils/helpers\";\r\n\r\nexport default function(gantt) {\r\n\tgantt.load = function(){\r\n\t\tthrow new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\r\n\t};\r\n\tgantt.parse = function (data, type) {\r\n\t\tthis.on_load({xmlDoc: {responseText: data}}, type);\r\n\t};\r\n\r\n\tgantt.serialize = function (type) {\r\n\t\ttype = type || \"json\";\r\n\t\treturn this[type].serialize();\r\n\t};\r\n\r\n\t/*\r\n\ttasks and relations\r\n\t{\r\n\tdata:[\r\n\t\t{\r\n\t\t\t\"id\":\"string\",\r\n\t\t\t\"text\":\"...\",\r\n\t\t\t\"start_date\":\"Date or string\",\r\n\t\t\t\"end_date\":\"Date or string\",\r\n\t\t\t\"duration\":\"number\",\r\n\t\t\t\"progress\":\"0..1\",\r\n\t\t\t\"parent_id\":\"string\",\r\n\t\t\t\"order\":\"number\"\r\n\t\t},...],\r\n\tlinks:[\r\n\t\t{\r\n\t\t\tid:\"string\",\r\n\t\t\tsource:\"string\",\r\n\t\t\ttarget:\"string\",\r\n\t\t\ttype:\"string\"\r\n\t\t},...],\r\n\tcollections:{\r\n\t\t\tcollectionName:[\r\n\t\t\t\t{key:, label:, optional:...},...\r\n\t\t\t],...\r\n\t\t}\r\n\t}\r\n\r\n\t* */\r\n\r\n\tgantt.on_load = function (resp, type) {\r\n\t\tif(resp.xmlDoc && resp.xmlDoc.status === 404){ // work if we don't have a file at current url\r\n\t\t\tthis.assert(false, \"Failed to load the data from <a href='\" + resp.xmlDoc.responseURL + \"' target='_blank'>\" \r\n\t\t\t\t+ resp.xmlDoc.responseURL + \"</a>, server returns 404\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(gantt.$destroyed){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.callEvent(\"onBeforeParse\", []);\r\n\t\tif (!type)\r\n\t\t\ttype = \"json\";\r\n\t\tthis.assert(this[type], \"Invalid data type:'\" + type + \"'\");\r\n\r\n\t\tvar raw = resp.xmlDoc.responseText;\r\n\r\n\t\tvar data = this[type].parse(raw, resp);\r\n\t\tthis._process_loading(data);\r\n\t};\r\n\r\n\tfunction attachAssignmentsToTasks(tasks, assignments) {\r\n\t\tconst assignmentsByTasks = {};\r\n\t\tassignments.forEach((a)=>{\r\n\t\t\tif(!assignmentsByTasks[a.task_id]) {\r\n\t\t\t\tassignmentsByTasks[a.task_id] = [];\r\n\t\t\t}\r\n\t\t\tassignmentsByTasks[a.task_id].push(a);\r\n\t\t});\r\n\t\ttasks.forEach((t) => {\r\n\t\t\tt[gantt.config.resource_property] = assignmentsByTasks[t.id] || [];\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tgantt._process_loading = function (data) {\r\n\t\tif(data.collections)\r\n\t\t\tthis._load_collections(data.collections);\r\n\r\n\t\tif(data.resources && this.$data.resourcesStore){\r\n\t\t\tthis.$data.resourcesStore.parse(data.resources);\r\n\t\t}\r\n\t\tif(gantt.config.baselines && data.baselines && this.$data.baselineStore){\r\n\t\t\tthis.$data.baselineStore.parse(data.baselines);\r\n\t\t}\r\n\t\t\r\n\t\tconst tasks = data.data || data.tasks;\r\n\t\tif(data.assignments){\r\n\t\t\tattachAssignmentsToTasks(tasks, data.assignments);\r\n\t\t}\r\n\r\n\t\tthis.$data.tasksStore.parse(tasks);\r\n\t\tvar links = data.links || ((data.collections && data.collections.links) ? data.collections.links : []);\r\n\t\tthis.$data.linksStore.parse(links);\r\n\r\n\t\t//this._sync_links();\r\n\t\tthis.callEvent(\"onParse\", []);\r\n\t\tthis.render();\r\n\t};\r\n\r\n\tgantt._load_collections = function (collections) {\r\n\t\tvar collections_loaded = false;\r\n\t\tfor (var key in collections) {\r\n\t\t\tif (collections.hasOwnProperty(key)) {\r\n\t\t\t\tcollections_loaded = true;\r\n\t\t\t\tvar collection = collections[key];\r\n\t\t\t\t// GS-1728. Create an empty serverList if it doesn't exist\r\n\t\t\t\tthis.serverList[key] = this.serverList[key] || [];\r\n\t\t\t\tvar arr = this.serverList[key];\r\n\t\t\t\tif (!arr) continue;\r\n\t\t\t\tarr.splice(0, arr.length); //clear old options\r\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\r\n\t\t\t\t\tvar option = collection[j];\r\n\t\t\t\t\tvar obj = this.copy(option);\r\n\t\t\t\t\tobj.key = obj.value;// resulting option object\r\n\r\n\t\t\t\t\tfor (var option_key in option) {\r\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\r\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr.push(obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (collections_loaded)\r\n\t\t\tthis.callEvent(\"onOptionsLoad\", []);\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onBeforeTaskDisplay\", function (id, task) {\r\n\t\treturn !task.$ignore;\r\n\t});\r\n\r\n\tfunction jsonParseError(data){\r\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\r\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\r\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \"\r\n\t\t\t+ JSON.stringify(data));\r\n\t}\r\n\r\n\tgantt.json = {\r\n\t\tparse: function (data) {\r\n\t\t\tif(!data){\r\n\t\t\t\tjsonParseError(data);\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof data == \"string\") {\r\n\t\t\t\tif (typeof JSON != undefined){\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tdata = JSON.parse(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch(e) {\r\n\t\t\t\t\t\tjsonParseError(data);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgantt.assert(false, \"JSON is not supported\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(!data.data && !data.tasks){\r\n\t\t\t\tjsonParseError(data);\r\n\t\t\t}\r\n\r\n\t\t\tif (data.dhx_security)\r\n\t\t\t\tgantt.security_key = data.dhx_security;\r\n\t\t\treturn data;\r\n\t\t},\r\n\t\tserializeTask: function (task) {\r\n\t\t\treturn this._copyObject(task);\r\n\t\t},\r\n\t\tserializeLink: function (link) {\r\n\t\t\treturn this._copyLink(link);\r\n\t\t},\r\n\t\t_copyLink: function (obj) {\r\n\t\t\tvar copy = {};\r\n\t\t\tfor (var key in obj)\r\n\t\t\t\tcopy[key] = obj[key];\r\n\t\t\treturn copy;\r\n\t\t},\r\n\t\t_copyObject: function (obj) {\r\n\t\t\tvar copy = {};\r\n\t\t\tfor (var key in obj) {\r\n\t\t\t\tif (key.charAt(0) == \"$\")\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\tcopy[key] = obj[key];\r\n\r\n\t\t\t\tif (helpers.isDate(copy[key])) {\r\n\t\t\t\t\tcopy[key] = gantt.defined(gantt.templates.xml_format) ? gantt.templates.xml_format(copy[key]) : gantt.templates.format_date(copy[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn copy;\r\n\t\t},\r\n\t\tserialize: function () {\r\n\t\t\tvar tasks = [];\r\n\t\t\tvar links = [];\r\n\t\t\tlet baselines = [];\r\n\r\n\t\t\tgantt.eachTask(function (obj) {\r\n\t\t\t\tgantt.resetProjectDates(obj);\r\n\t\t\t\ttasks.push(this.serializeTask(obj));\r\n\t\t\t}, gantt.config.root_id, this);\r\n\r\n\t\t\tvar rawLinks = gantt.getLinks();\r\n\t\t\tfor (var i = 0; i < rawLinks.length; i++) {\r\n\t\t\t\tlinks.push(this.serializeLink(rawLinks[i]));\r\n\t\t\t}\r\n\r\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\r\n\t\t\tbaselineStore.eachItem(function(baseline){\r\n\t\t\t\tconst baselineCopy = gantt.json.serializeTask(baseline);\r\n\t\t\t\tbaselines.push(baselineCopy);\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdata: tasks,\r\n\t\t\t\tlinks,\r\n\t\t\t\tbaselines\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n\t/*\r\n\t<data>\r\n\t\t<task id:\"some\" parent_id=\"0\" progress=\"0.5\">\r\n\t\t\t<text>My task 1</text>\r\n\t\t\t<start_date>16.08.2013</start_date>\r\n\t\t\t<end_date>22.08.2013</end_date>\r\n\t\t</task>\r\n\t\t<coll_options>\r\n\t\t\t<links>\r\n\t\t\t\t<link source='a1' target='b2' type='c3' />\r\n\t\t\t</links>\r\n\t\t</coll_options>\r\n\t</data>\r\n\t*/\r\n\r\n\tfunction xmlParseError(data){\r\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\r\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\r\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \"\r\n\t\t\t+ JSON.stringify(data));\r\n\t}\r\n\r\n\tgantt.xml = {\r\n\t\t_xmlNodeToJSON: function (node, attrs_only) {\r\n\t\t\tvar t = {};\r\n\t\t\tfor (var i = 0; i < node.attributes.length; i++)\r\n\t\t\t\tt[node.attributes[i].name] = node.attributes[i].value;\r\n\r\n\t\t\tif (!attrs_only) {\r\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\r\n\t\t\t\t\tvar child = node.childNodes[i];\r\n\t\t\t\t\tif (child.nodeType == 1)\r\n\t\t\t\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\r\n\t\t\t}\r\n\r\n\t\t\treturn t;\r\n\t\t},\r\n\t\t_getCollections: function (loader) {\r\n\t\t\tvar collection = {};\r\n\t\t\tvar opts = gantt.ajax.xpath(\"//coll_options\", loader);\r\n\t\t\tfor (var i = 0; i < opts.length; i++) {\r\n\t\t\t\tvar bind = opts[i].getAttribute(\"for\");\r\n\t\t\t\tvar arr = collection[bind] = [];\r\n\t\t\t\tvar itms = gantt.ajax.xpath(\".//item\", opts[i]);\r\n\t\t\t\tfor (var j = 0; j < itms.length; j++) {\r\n\t\t\t\t\tvar itm = itms[j];\r\n\t\t\t\t\tvar attrs = itm.attributes;\r\n\t\t\t\t\tvar obj = {key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\r\n\t\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\r\n\t\t\t\t\t\tvar attr = attrs[k];\r\n\t\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tarr.push(obj);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn collection;\r\n\t\t},\r\n\t\t_getXML: function (text, loader, toptag) {\r\n\t\t\ttoptag = toptag || \"data\";\r\n\t\t\tif (!loader.getXMLTopNode) {\r\n\t\t\t\tloader = gantt.ajax.parse(loader);\r\n\t\t\t}\r\n\r\n\t\t\tvar xml = gantt.ajax.xmltop(toptag, loader.xmlDoc);\r\n\t\t\tif (!xml || xml.tagName != toptag) {\r\n\t\t\t\txmlParseError(text);\r\n\t\t\t}\r\n\r\n\t\t\tvar skey = xml.getAttribute(\"dhx_security\");\r\n\t\t\tif (skey)\r\n\t\t\t\tgantt.security_key = skey;\r\n\r\n\t\t\treturn xml;\r\n\t\t},\r\n\t\tparse: function (text, loader) {\r\n\t\t\tloader = this._getXML(text, loader);\r\n\t\t\tvar data = {};\r\n\r\n\t\t\tvar evs = data.data = [];\r\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\r\n\r\n\t\t\tfor (var i = 0; i < xml.length; i++)\r\n\t\t\t\tevs[i] = this._xmlNodeToJSON(xml[i]);\r\n\r\n\t\t\tdata.collections = this._getCollections(loader);\r\n\t\t\treturn data;\r\n\t\t},\r\n\t\t_copyLink: function (obj) {\r\n\t\t\treturn \"<item id='\" + obj.id + \"' source='\" + obj.source + \"' target='\" + obj.target + \"' type='\" + obj.type + \"' />\";\r\n\t\t},\r\n\t\t_copyObject: function (obj) {\r\n\t\t\treturn \"<task id='\" + obj.id + \"' parent='\" + (obj.parent || \"\") + \"' start_date='\" + obj.start_date + \"' duration='\" + obj.duration + \"' open='\" + (!!obj.open) + \"' progress='\" + obj.progress + \"' end_date='\" + obj.end_date + \"'><![CDATA[\" + obj.text + \"]]></task>\";\r\n\t\t},\r\n\t\tserialize: function () {\r\n\t\t\tvar tasks = [];\r\n\t\t\tvar links = [];\r\n\r\n\t\t\tvar json = gantt.json.serialize();\r\n\t\t\tfor (var i = 0, len = json.data.length; i < len; i++) {\r\n\t\t\t\ttasks.push(this._copyObject(json.data[i]));\r\n\t\t\t}\r\n\t\t\tfor (var i = 0, len = json.links.length; i < len; i++) {\r\n\t\t\t\tlinks.push(this._copyLink(json.links[i]));\r\n\t\t\t}\r\n\t\t\treturn \"<data>\" + tasks.join(\"\") + \"<coll_options for='links'>\" + links.join(\"\") + \"</coll_options></data>\";\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tgantt.oldxml = {\r\n\t\tparse: function (text, loader) {\r\n\t\t\tloader = gantt.xml._getXML(text, loader, \"projects\");\r\n\t\t\tvar data = {collections: {links: []}};\r\n\r\n\t\t\tvar evs = data.data = [];\r\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\r\n\r\n\t\t\tfor (var i = 0; i < xml.length; i++) {\r\n\t\t\t\tevs[i] = gantt.xml._xmlNodeToJSON(xml[i]);\r\n\t\t\t\tvar parent = xml[i].parentNode;\r\n\r\n\t\t\t\tif (parent.tagName == \"project\")\r\n\t\t\t\t\tevs[i].parent = \"project-\" + parent.getAttribute(\"id\");\r\n\t\t\t\telse\r\n\t\t\t\t\tevs[i].parent = parent.parentNode.getAttribute(\"id\");\r\n\t\t\t}\r\n\r\n\t\t\txml = gantt.ajax.xpath(\"//project\", loader);\r\n\t\t\tfor (var i = 0; i < xml.length; i++) {\r\n\t\t\t\tvar ev = gantt.xml._xmlNodeToJSON(xml[i], true);\r\n\t\t\t\tev.id = \"project-\" + ev.id;\r\n\t\t\t\tevs.push(ev);\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < evs.length; i++) {\r\n\t\t\t\tvar ev = evs[i];\r\n\t\t\t\tev.start_date = ev.startdate || ev.est;\r\n\t\t\t\tev.end_date = ev.enddate;\r\n\t\t\t\tev.text = ev.name;\r\n\t\t\t\tev.duration = ev.duration / 8;\r\n\t\t\t\tev.open = 1;\r\n\t\t\t\tif (!ev.duration && !ev.end_date) ev.duration = 1;\r\n\t\t\t\tif (ev.predecessortasks)\r\n\t\t\t\t\tdata.collections.links.push({\r\n\t\t\t\t\t\ttarget: ev.id,\r\n\t\t\t\t\t\tsource: ev.predecessortasks,\r\n\t\t\t\t\t\ttype: gantt.config.links.finish_to_start\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn data;\r\n\t\t},\r\n\t\tserialize: function () {\r\n\t\t\tgantt.message(\"Serialization to 'old XML' is not implemented\");\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.serverList = function (name, array) {\r\n\t\tif (array) {\r\n\t\t\tthis.serverList[name] = array.slice(0);\r\n\t\t} else if (!this.serverList[name]) {\r\n\t\t\tthis.serverList[name] = [];\r\n\t\t}\r\n\t\treturn this.serverList[name];\r\n\t};\r\n\r\n};","import * as utils from \"../../utils/utils\";\r\nimport * as helpers from \"../../utils/helpers\";\r\n\r\n\r\nfunction IsWorkTimeArgument(date, unit, task, id, calendar){\r\n\tthis.date = date;\r\n\tthis.unit = unit;\r\n\tthis.task = task;\r\n\tthis.id = id;\r\n\tthis.calendar = calendar;\r\n\treturn this;\r\n}\r\n\r\nfunction ClosestWorkTimeArgument(date, dir, unit, task, id, calendar){\r\n\tthis.date = date;\r\n\tthis.dir = dir;\r\n\tthis.unit = unit;\r\n\tthis.task = task;\r\n\tthis.id = id;\r\n\tthis.calendar = calendar;\r\n\treturn this;\r\n}\r\n\r\nfunction CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar){\r\n\tthis.start_date = start_date;\r\n\tthis.duration = duration;\r\n\tthis.unit = unit;\r\n\tthis.step = step;\r\n\tthis.task = task;\r\n\tthis.id = id;\r\n\tthis.calendar = calendar;\r\n\treturn this;\r\n}\r\n\r\nfunction GetDurationArgument(start, end, task, calendar) {\r\n\tthis.start_date = start;\r\n\tthis.end_date = end;\r\n\tthis.task = task;\r\n\tthis.calendar = calendar;\r\n\tthis.unit = null;\r\n\tthis.step = null;\r\n\treturn this;\r\n}\r\n\r\nvar calendarArgumentsHelper = function(gantt){\r\n\treturn {\r\n\t\tgetWorkHoursArguments: function () {\r\n\t\t\tvar config = arguments[0];\r\n\t\t\tif (helpers.isDate(config)) {\r\n\t\t\t\tconfig = {\r\n\t\t\t\t\tdate: config\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tconfig = utils.mixin({}, config);\r\n\t\t\t}\r\n\r\n\t\t\tif(!helpers.isValidDate(config.date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getWorkHours method\");\r\n\t\t\t\tthrow new Error(\"Invalid date argument for getWorkHours method\");\r\n\t\t\t}\r\n\r\n\t\t\treturn config;\r\n\t\t},\r\n\t\tsetWorkTimeArguments: function () {\r\n\t\t\treturn arguments[0];\r\n\t\t},\r\n\t\tunsetWorkTimeArguments: function () {\r\n\t\t\treturn arguments[0];\r\n\t\t},\r\n\t\tisWorkTimeArguments: function () {\r\n\t\t\tvar config = arguments[0];\r\n\t\t\tif(config instanceof IsWorkTimeArgument){\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\r\n\t\t\tvar processedConfig;\r\n\t\t\tif (!config.date) {\r\n\t\t\t\t//IsWorkTimeArgument(date, unit, task, id, calendar)\r\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(arguments[0], arguments[1], arguments[2], null, arguments[3]);\r\n\t\t\t} else {\r\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(config.date, config.unit, config.task, null, config.calendar);\r\n\t\t\t}\r\n\r\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\r\n\r\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid date argument for isWorkTime method\");\r\n\t\t\t\tthrow new Error(\"Invalid date argument for isWorkTime method\");\r\n\t\t\t}\r\n\r\n\t\t\treturn processedConfig;\r\n\t\t},\r\n\t\tgetClosestWorkTimeArguments: function (arg) {\r\n\t\t\tvar config = arguments[0];\r\n\t\t\tif (config instanceof ClosestWorkTimeArgument)\r\n\t\t\t\treturn config;\r\n\r\n\t\t\tvar processedConfig;\r\n\t\t\tif (helpers.isDate(config)) {\r\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(config);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(\r\n\t\t\t\t\tconfig.date,\r\n\t\t\t\t\tconfig.dir,\r\n\t\t\t\t\tconfig.unit,\r\n\t\t\t\t\tconfig.task,\r\n\t\t\t\t\tnull,//config.id,\r\n\t\t\t\t\tconfig.calendar\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tif(config.id){\r\n\t\t\t\tprocessedConfig.task = config;\r\n\t\t\t}\r\n\t\t\tprocessedConfig.dir = config.dir || 'any';\r\n\t\t\tprocessedConfig.unit = config.unit || gantt.config.duration_unit;\r\n\r\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getClosestWorkTime method\");\r\n\t\t\t\tthrow new Error(\"Invalid date argument for getClosestWorkTime method\");\r\n\t\t\t}\r\n\t\t\treturn processedConfig;\r\n\t\t},\r\n\r\n\t\t_getStartEndConfig: function (param) {\r\n\t\t\tvar argumentType = GetDurationArgument;\r\n\t\t\tvar config;\r\n\t\t\tif (param instanceof argumentType)\r\n\t\t\t\treturn param;\r\n\r\n\t\t\tif (helpers.isDate(param)) {\r\n\t\t\t\tconfig = new argumentType(arguments[0], arguments[1], arguments[2], arguments[3]);\r\n\t\t\t} else {\r\n\t\t\t\tconfig = new argumentType(param.start_date, param.end_date, param.task);\r\n\t\t\t\tif (param.id !== null && param.id !== undefined) {\r\n\t\t\t\t\tconfig.task = param;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconfig.unit = config.unit || gantt.config.duration_unit;\r\n\t\t\tconfig.step = config.step || gantt.config.duration_step;\r\n\t\t\tconfig.start_date = config.start_date || config.start || config.date;\r\n\r\n\t\t\tif(!helpers.isValidDate(config.start_date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for getDuration method\");\r\n\t\t\t\tthrow new Error(\"Invalid start_date argument for getDuration method\");\r\n\t\t\t}\r\n\r\n\t\t\tif(!helpers.isValidDate(config.end_date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid end_date argument for getDuration method\");\r\n\t\t\t\tthrow new Error(\"Invalid end_date argument for getDuration method\");\r\n\t\t\t}\r\n\r\n\t\t\treturn config;\r\n\t\t},\r\n\r\n\t\tgetDurationArguments: function (start, end, unit, step) {\r\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\r\n\t\t},\r\n\r\n\t\thasDurationArguments: function (start, end, unit, step) {\r\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\r\n\t\t},\r\n\r\n\t\tcalculateEndDateArguments: function (start, duration, unit, step) {\r\n\t\t\tvar config = arguments[0];\r\n\t\t\tif (config instanceof CalculateEndDateArgument)\r\n\t\t\t\treturn config;\r\n\r\n\t\t\tvar processedConfig;\r\n\t\t\t//CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar)\r\n\t\t\tif (helpers.isDate(config)) {\r\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\r\n\t\t\t\t\targuments[0],\r\n\t\t\t\t\targuments[1],\r\n\t\t\t\t\targuments[2],\r\n\t\t\t\t\tundefined,\r\n\t\t\t\t\targuments[3],\r\n\t\t\t\t\tundefined,\r\n\t\t\t\t\targuments[4]\r\n\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\r\n\t\t\t\t\tconfig.start_date,\r\n\t\t\t\t\tconfig.duration,\r\n\t\t\t\t\tconfig.unit,\r\n\t\t\t\t\tconfig.step,\r\n\t\t\t\t\tconfig.task,\r\n\t\t\t\t\tnull,//config.id,\r\n\t\t\t\t\tconfig.calendar\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif(config.id !== null && config.id !== undefined){\r\n\t\t\t\tprocessedConfig.task = config;\r\n\r\n\t\t\t\t// received a task object as an argument\r\n\t\t\t\t// ignore 'unit' and 'step' properties in this case, since it's likely a part of data model of a task\r\n\t\t\t\tprocessedConfig.unit = null;\r\n\t\t\t\tprocessedConfig.step = null;\r\n\t\t\t}\r\n\r\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\r\n\t\t\tprocessedConfig.step = processedConfig.step || gantt.config.duration_step;\r\n\r\n\t\t\tif(!helpers.isValidDate(processedConfig.start_date)){\r\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for calculateEndDate method\");\r\n\t\t\t\tthrow new Error(\"Invalid start_date argument for calculateEndDate method\");\r\n\t\t\t}\r\n\r\n\t\t\treturn processedConfig;\r\n\t\t}\r\n\t};\r\n};\r\n\r\n\r\nexport default calendarArgumentsHelper;","import * as utils from \"../../../utils/utils\";\r\nfunction WorkTimeCalendarMerger(){\r\n}\r\n\r\nWorkTimeCalendarMerger.prototype = {\r\n\r\n\r\n\t/**\r\n\t * convert hours array items into objects, e.g. [8, 12, 17, 18] -> [{start: 8, end: 12}, {start:17, end:18}]\r\n\t * @param {Array} hoursArray\r\n\t */\r\n\t_getIntervals: function(hoursArray){\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < hoursArray.length; i += 2){\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tstart: hoursArray[i],\r\n\t\t\t\tend: hoursArray[i+1]\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Convert ranges config into hours array\r\n\t * [{start: 8, end: 12}, {start:17, end:18}] --> [8, 12, 17, 18]\r\n\t * @param {*} intervalsArray\r\n\t */\r\n\t_toHoursArray: function(intervalsArray){\r\n\t\tvar result = [];\r\n\r\n\t\tfunction toFixed(value){\r\n\t\t\tvar str = String(value);\r\n\t\t\tif(str.length < 2){\r\n\t\t\t\tstr = \"0\" + str;\r\n\t\t\t}\r\n\t\t\treturn str;\r\n\t\t}\r\n\t\tfunction formatHHMM(secondsValue){\r\n\t\t\tvar hours = Math.floor(secondsValue / (60*60));\r\n\t\t\tvar minutePart = secondsValue - hours * 60 * 60;\r\n\r\n\t\t\tvar minutes = Math.floor(minutePart / (60));\r\n\t\t\treturn hours + \":\" + toFixed(minutes);\r\n\t\t}\r\n\t\tfor(var i = 0; i < intervalsArray.length; i++){\r\n\t\t\tresult.push(\r\n\t\t\t\tformatHHMM(intervalsArray[i].start) +\r\n\t\t\t\t\"-\" +\r\n\t\t\t\tformatHHMM(intervalsArray[i].end)\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Build intersection of hour intervals. e.g.\r\n\t * first: [{start: 8, end: 12}, {start:13, end:18}]\r\n\t * second: [{start: 10, end: 15}]\r\n\t * result: [{start: 10, end: 12}, {start: 13, end: 15}]\r\n\t * @param {Array} first\r\n\t * @param {Array} second\r\n\t */\r\n\t_intersectHourRanges: function(first, second){\r\n\t\tvar result = [];\r\n\r\n\t\tvar baseArray = first.length > second.length ? first : second;\r\n\t\tvar overridesArray = first === baseArray ? second: first;\r\n\t\tbaseArray = baseArray.slice();\r\n\t\toverridesArray = overridesArray.slice();\r\n\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < baseArray.length; i++){\r\n\t\t\tvar base = baseArray[i];\r\n\r\n\t\t\tfor(var j = 0; j < overridesArray.length; j++){\r\n\t\t\t\tvar current = overridesArray[j];\r\n\t\t\t\tif(current.start < base.end && current.end > base.start){\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\tstart: Math.max(base.start, current.start),\r\n\t\t\t\t\t\tend: Math.min(base.end, current.end)\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif(base.end > current.end){\r\n\t\t\t\t\t\toverridesArray.splice(j, 1);\r\n\t\t\t\t\t\tj--;\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Reduce the number of ranges in config when possible,\r\n\t * joins ranges that can be merged\r\n\t * parts: [{start: 8, end: 12}, {start:12, end:13}, {start: 15, end: 17}]\r\n\t * result: [{start: 8, end: 13}, {start: 15, end: 17}]\r\n\t * @param {Array} parts\r\n\t */\r\n\t_mergeAdjacentIntervals: function(parts){\r\n\t\tvar result = parts.slice();\r\n\t\tresult.sort(function(a, b){\r\n\t\t\treturn a.start - b.start;\r\n\t\t});\r\n\t\tvar base = result[0];\r\n\t\tfor(var i = 1; i < result.length; i++){\r\n\t\t\tvar current = result[i];\r\n\t\t\tif(current.start <= base.end){\r\n\t\t\t\tif(current.end > base.end){\r\n\t\t\t\t\tbase.end = current.end;\r\n\t\t\t\t}\r\n\t\t\t\tresult.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}else{\r\n\t\t\t\tbase = current;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t_mergeHoursConfig: function(firstHours, secondHours){\r\n\t\t//var firstIntervals = this._getIntervals(firstHours);\r\n\t\t//var secondIntervals = this._getIntervals(secondHours);\r\n\r\n\t\treturn this._mergeAdjacentIntervals(\r\n\t\t\tthis._intersectHourRanges(firstHours, secondHours)\r\n\t\t);\r\n\t},\r\n\r\n\tmerge: function(first, second){\r\n\t\tconst firstCalendar = utils.copy(first.getConfig());\r\n\t\tconst secondCalendar = utils.copy(second.getConfig());\r\n\r\n\t\tconst firstConfig = firstCalendar.parsed;\r\n\t\tconst secondConfig = secondCalendar.parsed;\r\n\r\n\t\t// GS-2101. The customWeeks config shouldn't have parsed values as we'll parse them later\r\n\t\tfirstConfig.customWeeks = firstCalendar.customWeeks;\r\n\t\tsecondConfig.customWeeks = secondCalendar.customWeeks;\r\n\r\n\t\tvar mergedSettings = {\r\n\t\t\thours: this._toHoursArray(this._mergeHoursConfig(firstConfig.hours, secondConfig.hours)),\r\n\t\t\tdates: {},\r\n\t\t\tcustomWeeks: {}\r\n\t\t};\r\n\r\n\t\tconst processCalendar = (config1, config2) => {\r\n\t\t\tfor (let i in config1.dates) {\r\n\t\t\t\tconst date1 = config1.dates[i];\r\n\t\r\n\t\t\t\t// dates contain day-of-week rules [0-7] and rules for specific dates (js date timestamps) - set false date rules initially\r\n\t\t\t\tif (+i > 1000) {\r\n\t\t\t\t\tmergedSettings.dates[i] = false;\r\n\t\t\t\t}\r\n\t\t\t\t// Check if the key exists in the fisrt calendar object\r\n\t\t\t\tfor (const key in config2.dates) {\r\n\t\t\t\t\tconst date2 = config2.dates[key];\r\n\t\r\n\t\t\t\t\t// Logical AND for week days\r\n\t\t\t\t\tif (key == i) {\r\n\t\t\t\t\t\tmergedSettings.dates[i] = !!(date1 && date2);\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t// Handle case where dates are arrays\r\n\t\t\t\t\tif (Array.isArray(date1)) {\r\n\t\t\t\t\t\tconst hours2 = Array.isArray(date2) ? date2 : config2.hours;\r\n\t\t\t\t\t\tmergedSettings.dates[i] = this._toHoursArray(this._mergeHoursConfig(date1, hours2));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\r\n\t\t// Check both calendars\r\n\t\tprocessCalendar(firstConfig, secondConfig);\r\n\t\tprocessCalendar(secondConfig, firstConfig);\r\n\r\n\t\t// transfer and overwrite custom week calendars\r\n\t\tif(firstConfig.customWeeks){\r\n\t\t\tfor(var i in firstConfig.customWeeks){\r\n\t\t\t\tmergedSettings.customWeeks[i] = firstConfig.customWeeks[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(secondConfig.customWeeks){\r\n\t\t\tfor(var i in secondConfig.customWeeks){\r\n\t\t\t\t// GS-2101. If both calendars have the same name for a period, we need to rename it\r\n\t\t\t\tif (mergedSettings.customWeeks[i]){\r\n\t\t\t\t\tmergedSettings.customWeeks[i + \"_second\"] = secondConfig.customWeeks[i];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmergedSettings.customWeeks[i] = secondConfig.customWeeks[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn mergedSettings;\r\n\r\n\t}\r\n\r\n};\r\n\r\nexport default WorkTimeCalendarMerger;","\r\n\r\nimport { IWorkUnitCache } from \"./workunit_cache_interface\";\r\n\r\nexport class WorkUnitsMapCache implements IWorkUnitCache {\r\n\tprivate _cache: Map<string, Array<Map<string, boolean>>>;\r\n\tconstructor() {\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\r\n\t\tif (this._cache.has(unit)) {\r\n\t\t\tconst unitCache = this._cache.get(unit);\r\n\r\n\t\t\tconst subCache = unitCache[value.getFullYear()];\r\n\t\t\tif (subCache && subCache.has(timestamp)) {\r\n\t\t\t\treturn subCache.get(timestamp);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\r\n\t\tif (!unit || !timestamp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst cache = this._cache;\r\n\t\tconst year = rawValue.getFullYear();\r\n\r\n\t\tlet unitCache;\r\n\t\tif (!cache.has(unit)) {\r\n\t\t\tunitCache = [];\r\n\t\t\tcache.set(unit, unitCache);\r\n\t\t} else {\r\n\t\t\tunitCache = cache.get(unit);\r\n\t\t}\r\n\r\n\t\tlet yearCache = unitCache[year];\r\n\t\tif(!yearCache){\r\n\t\t\tyearCache = unitCache[year] = new Map<string, boolean>();\r\n\t\t}\r\n\r\n\r\n\t\tyearCache.set(timestamp, value);\r\n\t}\r\n\tclear(): void{\r\n\t\tthis._cache = new Map<string, Array<Map<string, boolean>>>();\r\n\t}\r\n}","import { IWorkUnitCache } from \"./workunit_cache_interface\";\r\n\r\nexport class WorkUnitsObjectCache implements IWorkUnitCache {\r\n\tprivate _cache: any;\r\n\tconstructor() {\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\r\n\t\tconst cache = this._cache;\r\n\t\tif (cache && cache[unit]) {\r\n\t\t\tconst units = cache[unit];\r\n\t\t\tif(units === undefined){\r\n\t\t\t\treturn -1;\r\n\t\t\t}\r\n\t\t\tconst subCache = units[value.getFullYear()];\r\n\t\t\tif (subCache && subCache[timestamp] !== undefined) {\r\n\t\t\t\treturn subCache[timestamp];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn -1;\r\n\t}\r\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\r\n\t\tif (!unit || !timestamp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst cache = this._cache;\r\n\r\n\t\tif (!cache) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!cache[unit]) {\r\n\t\t\tcache[unit] = [];\r\n\t\t}\r\n\t\tconst unitCache = cache[unit];\r\n\r\n\t\tconst year = rawValue.getFullYear();\r\n\t\tlet yearCache = unitCache[year];\r\n\t\tif(!yearCache){\r\n\t\t\tyearCache = unitCache[year] = {};\r\n\t\t}\r\n\t\tyearCache[timestamp] = value;\r\n\t}\r\n\tclear(): void{\r\n\t\tthis._cache = {};\r\n\t}\r\n}","\r\n\r\nexport class LargerUnitsCache {\r\n\tprivate _weekCache: Map<number, number>;\r\n\tprivate _monthCache: Map<number, number>;\r\n\tprivate _calendar: any;\r\n\tconstructor(calendar) {\r\n\t\tthis.clear();\r\n\t\tthis._calendar = calendar;\r\n\t}\r\n\r\n\tgetMinutesPerWeek = (weekStart: Date) => {\r\n\t\tconst key = weekStart.valueOf();\r\n\r\n\t\tif(this._weekCache.has(key)){\r\n\t\t\treturn this._weekCache.get(key);\r\n\t\t}\r\n\r\n\t\tconst calendar = this._calendar;\r\n\t\tconst gantt = this._calendar.$gantt;\r\n\r\n\t\tlet minutesPerWeek = 0;\r\n\t\tlet start = gantt.date.week_start(new Date(weekStart));\r\n\t\tfor(let i = 0; i < 7; i++){\r\n\t\t\tminutesPerWeek += calendar.getHoursPerDay(start) * 60;\r\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\r\n\t\t}\r\n\r\n\t\tthis._weekCache.set(key, minutesPerWeek);\r\n\t\treturn minutesPerWeek;\r\n\t};\r\n\r\n\tgetMinutesPerMonth = (monthStart: Date) => {\r\n\t\tconst key = monthStart.valueOf();\r\n\r\n\t\tif(this._monthCache.has(key)){\r\n\t\t\treturn this._monthCache.get(key);\r\n\t\t}\r\n\r\n\t\tconst calendar = this._calendar;\r\n\t\tconst gantt = this._calendar.$gantt;\r\n\r\n\t\tlet minutesPerMonth = 0;\r\n\t\tlet start = gantt.date.week_start(new Date(monthStart));\r\n\t\tconst nextMonth = gantt.date.add(start, 1, \"month\").valueOf();\r\n\t\twhile(start.valueOf() < nextMonth){\r\n\t\t\tminutesPerMonth += calendar.getHoursPerDay(start) * 60;\r\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\r\n\t\t}\r\n\r\n\t\tthis._monthCache.set(key, minutesPerMonth);\r\n\t\treturn minutesPerMonth;\r\n\t};\r\n\r\n\tclear = (): void => {\r\n\t\tthis._weekCache = new Map<number, number>();\r\n\t\tthis._monthCache = new Map<number, number>();\r\n\t};\r\n}","export class DateDurationCache  {\r\n\tprivate _cache: any;\r\n\tconstructor() {\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\t_getCacheObject(startDate: Date, unit: string, step:number){\r\n\t\tconst cache = this._cache;\r\n\t\tif (!cache[unit]) {\r\n\t\t\tcache[unit] = [];\r\n\t\t}\r\n\t\tlet unitCache = cache[unit];\r\n\t\tif(!unitCache) {\r\n\t\t\tunitCache = cache[unit] = {};\r\n\t\t}\r\n\r\n\t\tlet stepCache = unitCache[step];\r\n\t\tif(!stepCache) {\r\n\t\t\tstepCache = unitCache[step] = {};\r\n\t\t}\r\n\r\n\t\tconst year = startDate.getFullYear();\r\n\t\tlet yearCache = stepCache[year];\r\n\t\tif(!yearCache){\r\n\t\t\tyearCache = stepCache[year] = {durations: {}, endDates: {}};\r\n\t\t}\r\n\r\n\t\treturn yearCache;\r\n\t}\r\n\t_endDateCacheKey(startDate: number, duration: number){\r\n\t\treturn String(startDate) + \"-\" + String(duration);\r\n\t}\r\n\t_durationCacheKey(startDate: number, endDate: number){\r\n\t\treturn String(startDate) + \"-\" + String(endDate);\r\n\t}\r\n\tgetEndDate(startDate: Date, duration: number, unit: string, step: number, compute: () => Date): number|null{\r\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\r\n\r\n\t\tconst startDateTimestamp = startDate.valueOf();\r\n\t\tconst key = this._endDateCacheKey(startDateTimestamp, duration);\r\n\t\tlet endDate;\r\n\t\tif(cache.endDates[key] === undefined){\r\n\t\t\tconst result = compute();\r\n\t\t\tconst resultTimestamp = result.valueOf();\r\n\t\t\tcache.endDates[key] = resultTimestamp;\r\n\t\t\tcache.durations[this._durationCacheKey(startDateTimestamp, resultTimestamp)] = duration;\r\n\t\t\tendDate = result;\r\n\t\t}else{\r\n\t\t\tendDate = new Date(cache.endDates[key]);\r\n\t\t}\r\n\r\n\t\treturn endDate;\r\n\t}\r\n\r\n\tgetDuration(startDate: Date, endDate: Date, unit: string, step: number, compute: () => number): number|null{\r\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\r\n\r\n\t\tconst startDateTimestamp = startDate.valueOf();\r\n\t\tconst endDateTimestamp = endDate.valueOf();\r\n\t\tconst key = this._durationCacheKey(startDateTimestamp, endDateTimestamp);\r\n\t\tlet duration;\r\n\t\tif(cache.durations[key] === undefined){\r\n\t\t\tconst result = compute();\r\n\t\t\tcache.durations[key] = result.valueOf();\r\n\r\n\t\t\t// can't populate end date due to logic of end date calculation, current unit tests capture it\r\n\t\t\t// cache.endDates[this._endDateCacheKey(startDateTimestamp, result)] = endDateTimestamp;\r\n\t\t\tduration = result;\r\n\t\t}else{\r\n\t\t\tduration = cache.durations[key];\r\n\t\t}\r\n\r\n\t\treturn duration;\r\n\t}\r\n\r\n\tclear(): void{\r\n\t\tthis._cache = {};\r\n\t}\r\n}","import {createCacheObject} from \"./work_unit_cache\";\r\nimport {LargerUnitsCache} from \"./work_unit_cache\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport {DateDurationCache} from \"./work_unit_cache/date_duration_cache\";\r\n\r\nfunction CalendarWorkTimeStrategy(gantt, argumentsHelper) {\r\n\tthis.argumentsHelper = argumentsHelper;\r\n\tthis.$gantt = gantt;\r\n\tthis._workingUnitsCache = createCacheObject();\r\n\tthis._largeUnitsCache = new LargerUnitsCache(this);\r\n\tthis._dateDurationCache = new DateDurationCache();\r\n\tthis._worktime = null;\r\n\tthis._cached_timestamps = {};\r\n\tthis._cached_timestamps_count = 0;\r\n}\r\n\r\nCalendarWorkTimeStrategy.prototype = {\r\n\tunits: [\r\n\t\t\"year\",\r\n\t\t\"month\",\r\n\t\t\"week\",\r\n\t\t\"day\",\r\n\t\t\"hour\",\r\n\t\t\"minute\"\r\n\t],\r\n\t_clearCaches: function(){\r\n\t\tthis._workingUnitsCache.clear();\r\n\t\tthis._largeUnitsCache.clear();\r\n\t\tthis._dateDurationCache.clear();\r\n\t},\r\n\t// cache previously calculated worktime\r\n\t_getUnitOrder: function (unit) {\r\n\t\tfor (var i = 0, len = this.units.length; i < len; i++) {\r\n\t\t\tif (this.units[i] == unit)\r\n\t\t\t\treturn i;\r\n\t\t}\r\n\t},\r\n\t_resetTimestampCache: function(){\r\n\t\tthis._cached_timestamps = {};\r\n\t\tthis._cached_timestamps_count = 0;\r\n\t},\r\n\t_timestamp: function (settings) {\r\n\t\t// minor optimization, store calculated timestamps to reduce computations\r\n\t\t// reset cache when number of keys exceeds large number where key lookup may became more expensive than the recalculation\r\n\t\tif(this._cached_timestamps_count > 1000000){\r\n\t\t\tthis._resetTimestampCache();\r\n\t\t}\r\n\r\n\t\tvar timestamp = null;\r\n\t\tif ((settings.day || settings.day === 0)) {\r\n\t\t\ttimestamp = settings.day;\r\n\t\t} else if (settings.date) {\r\n\t\t\tvar value = String(settings.date.valueOf());\r\n\t\t\tif(this._cached_timestamps[value]){\r\n\t\t\t\ttimestamp = this._cached_timestamps[value];\r\n\t\t\t}else{\r\n\t\t\t\t// store worktime datestamp in utc so it could be recognized in different timezones (e.g. opened locally and sent to the export service in different timezone)\r\n\t\t\t\ttimestamp = Date.UTC(settings.date.getFullYear(), settings.date.getMonth(), settings.date.getDate());\r\n\t\t\t\tthis._cached_timestamps[value] = timestamp;\r\n\t\t\t\tthis._cached_timestamps_count++;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn timestamp;\r\n\t},\r\n\t_checkIfWorkingUnit: function (date, unit) {\r\n\t\t// GS-596: If unit is larger than day or has a custom logic\r\n\t\tif (!this[\"_is_work_\" + unit]) {\r\n\t\t\tconst from = this.$gantt.date[`${unit}_start`](new Date(date));\r\n\t\t\tconst to = this.$gantt.date.add(from, 1, unit);\r\n\t\t\treturn this.hasDuration(from, to);\r\n\t\t}\r\n\t\treturn this[\"_is_work_\" + unit](date);\r\n\t},\r\n\t//checkings for particular time units\r\n\t//methods for month-year-week can be defined, otherwise always return 'true'\r\n\t_is_work_day: function (date) {\r\n\t\tvar val = this._getWorkHours(date);\r\n\r\n\t\tif (Array.isArray(val)) {\r\n\t\t\treturn val.length > 0;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\t_is_work_hour: function (date) {\r\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\r\n\t\tvar value = date.getHours();\r\n\t\tfor (var i = 0; i < hours.length; i++) {\r\n\t\t\tif(value >= hours[i].startHour && value < hours[i].endHour){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t_getTimeOfDayStamp: function(date, dayEnd) {\r\n\t\tvar hours = date.getHours();\r\n\t\tif(!date.getHours() && !date.getMinutes() && dayEnd){\r\n\t\t\thours = 24;\r\n\t\t}\r\n\t\treturn hours * 60 * 60 + date.getMinutes() * 60;\r\n\t},\r\n\r\n\t_is_work_minute: function(date){\r\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\r\n\t\tvar checkTime = this._getTimeOfDayStamp(date);\r\n\t\tfor (var i = 0; i < hours.length; i++) {\r\n\t\t\tif(checkTime >= hours[i].start && checkTime < hours[i].end){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t_nextDate: function (start, unit, step) {\r\n\t\treturn this.$gantt.date.add(start, step, unit);\r\n\t},\r\n\t_getWorkUnitsBetweenGeneric: function (from, to, unit, step) {\r\n\t\tvar dateHelper = this.$gantt.date;\r\n\t\tvar start = new Date(from),\r\n\t\t\tend = new Date(to);\r\n\t\tstep = step || 1;\r\n\t\tvar units = 0;\r\n\r\n\r\n\t\tvar next = null;\r\n\t\tvar stepStart,\r\n\t\t\tstepEnd;\r\n\r\n\t\t// calculating decimal durations, i.e. 2016-09-20 00:05:00 - 2016-09-20 01:00:00 ~ 0.95 instead of 1\r\n\t\t// and also  2016-09-20 00:00:00 - 2016-09-20 00:05:00 ~ 0.05 instead of 1\r\n\t\t// durations must be rounded later\r\n\t\tvar checkFirst = false;\r\n\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\r\n\t\tif (stepStart.valueOf() != start.valueOf()) {\r\n\t\t\tcheckFirst = true;\r\n\t\t}\r\n\t\tvar checkLast = false;\r\n\t\tstepEnd = dateHelper[unit + \"_start\"](new Date(to));\r\n\t\tif (stepEnd.valueOf() != to.valueOf()) {\r\n\t\t\tcheckLast = true;\r\n\t\t}\r\n\r\n\t\tvar isLastStep = false;\r\n\t\twhile (start.valueOf() < end.valueOf()) {\r\n\t\t\tnext = this._nextDate(start, unit, step);\r\n\t\t\tisLastStep = (next.valueOf() > end.valueOf());\r\n\r\n\t\t\tif (this._isWorkTime(start, unit)) {\r\n\t\t\t\tif (checkFirst || (checkLast && isLastStep)) {\r\n\t\t\t\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\r\n\t\t\t\t\tstepEnd = dateHelper.add(stepStart, step, unit);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (checkFirst) {\r\n\t\t\t\t\tcheckFirst = false;\r\n\t\t\t\t\tnext = this._nextDate(stepStart, unit, step);\r\n\t\t\t\t\tunits += ((stepEnd.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\r\n\t\t\t\t} else if (checkLast && isLastStep) {\r\n\t\t\t\t\tcheckLast = false;\r\n\t\t\t\t\tunits += ((end.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tunits++;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tvar unitOrder = this._getUnitOrder(unit);\r\n\t\t\t\tvar biggerTimeUnit = this.units[unitOrder - 1];\r\n\t\t\t\tif(biggerTimeUnit && !this._isWorkTime(start, biggerTimeUnit)){\r\n\t\t\t\t\tnext = this._getClosestWorkTimeFuture(start, biggerTimeUnit);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstart = next;\r\n\t\t}\r\n\t\treturn units;\r\n\t},\r\n\r\n\t_getMinutesPerHour: function (date) {\r\n\t\tvar hourStart = this._getTimeOfDayStamp(date);\r\n\t\tvar hourEnd = this._getTimeOfDayStamp(this._nextDate(date, \"hour\", 1));\r\n\t\tif (hourEnd === 0){\r\n\t\t\thourEnd = 24 * 60 * 60;\r\n\t\t}\r\n\t\tvar worktimes = this._getWorkHours(date);\r\n\r\n\t\tfor(var i = 0; i < worktimes.length; i++){\r\n\t\t\tvar interval = worktimes[i];\r\n\t\t\tif(hourStart >= interval.start && hourEnd <= interval.end){\r\n\t\t\t\treturn 60;// hour inside a working interval, all hour is a work hour\r\n\t\t\t}else if(hourStart < interval.end && hourEnd > interval.start){\r\n\t\t\t\t// hour is partially work time\r\n\t\t\t\tvar duration = Math.min(hourEnd, interval.end) - Math.max(hourStart, interval.start);\r\n\t\t\t\treturn duration / 60;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\t},\r\n\r\n\t_getMinutesPerDay: function (date) {\r\n\t\tvar hours = this._getWorkHours(date);\r\n\t\tvar res = 0;\r\n\t\thours.forEach(function(interval){\r\n\t\t\tres+= interval.durationMinutes;\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\tgetHoursPerDay: function (date) {\r\n\t\tvar hours = this._getWorkHours(date);\r\n\t\tvar res = 0;\r\n\t\thours.forEach(function(interval){\r\n\t\t\tres+= interval.durationHours;\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\t_getWorkUnitsForRange: function (from, to, unit, step) {\r\n\t\tvar total = 0;\r\n\t\tvar start = new Date(from),\r\n\t\t\tend = new Date(to);\r\n\r\n\t\tvar getUnitsPerDay;\r\n\t\tif (unit == \"minute\") {\r\n\t\t\tgetUnitsPerDay = utils.bind(this._getMinutesPerDay, this);\r\n\t\t} else {\r\n\t\t\tgetUnitsPerDay = utils.bind(this.getHoursPerDay, this);\r\n\t\t}\r\n\r\n\t\twhile (start.valueOf() < end.valueOf()) {\r\n\t\t\tif(end - start > 1000*60*60*24*32 && start.getDate() === 0) {\r\n\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerMonth(start);\r\n\t\t\t\tif(unit == \"hour\"){\r\n\t\t\t\t\tunits = units / 60;\r\n\t\t\t\t}\r\n\t\t\t\ttotal += units;\r\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"month\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}else if(end - start > 1000*60*60*24*16) {\r\n\t\t\t\tvar weekStart = this.$gantt.date.week_start(new Date(start));\r\n\t\t\t\tif(start.valueOf() === weekStart.valueOf()){\r\n\t\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerWeek(start);\r\n\t\t\t\t\tif(unit == \"hour\"){\r\n\t\t\t\t\t\tunits = units / 60;\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttotal += units;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, 7, \"day\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t//\tif (this._isWorkTime(start, \"day\")) {\r\n\t\t\ttotal += getUnitsPerDay(start);\r\n\t\t//\t}\r\n\t\t\tstart = this._nextDate(start, \"day\", 1);\r\n\t\t}\r\n\r\n\t\treturn total / step;\r\n\t},\r\n\r\n\r\n\t_getMinutesBetweenSingleDay: function(from, to){\r\n\t\tvar range = this._getIntervalTimestamp(from, to);\r\n\t\tvar worktimes = this._getWorkHours(from);\r\n\t\tvar result = 0;\r\n\r\n\t\tfor(var i = 0; i < worktimes.length; i++){\r\n\t\t\tvar interval = worktimes[i];\r\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\r\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\r\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\r\n\r\n\t\t\t\tresult += (minuteTo - minuteFrom) / 60;\r\n\t\t\t\trange.start = minuteTo;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn Math.floor(result);\r\n\t},\r\n\r\n\t_getMinutesBetween: function(from, to, unit, step){\r\n\t\tvar start = new Date(from),\r\n\t\t\tend = new Date(to);\r\n\t\tstep = step || 1;\r\n\r\n\t\tvar firstDayStart = new Date(start);\r\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\r\n\r\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\r\n\t\t\treturn this._getMinutesBetweenSingleDay(from, to);\r\n\t\t} else {\r\n\r\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\r\n\t\t\tvar lastDayEnd = end;\r\n\r\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd);\r\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd);\r\n\r\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\r\n\t\t\tvar total = startPart + rangePart + endPart;\r\n\r\n\t\t\treturn total;\r\n\t\t}\r\n\t},\r\n\t// optimized method for calculating work units duration of large time spans\r\n\t// implemented for hours and minutes units, bigger time units don't benefit from the optimization so much\r\n\t_getHoursBetween: function (from, to, unit, step) {\r\n\t\tvar start = new Date(from),\r\n\t\t\tend = new Date(to);\r\n\t\tstep = step || 1;\r\n\r\n\t\tvar firstDayStart = new Date(start);\r\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\r\n\r\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\r\n\t\t\treturn Math.round(this._getMinutesBetweenSingleDay(from, to) / 60);\r\n\t\t} else {\r\n\r\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\r\n\t\t\tvar lastDayEnd = end;\r\n\r\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd, unit, step) / 60;\r\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd, unit, step) / 60;\r\n\r\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\r\n\t\t\tvar total = startPart + rangePart + endPart;\r\n\r\n\t\t\treturn Math.round(total);\r\n\t\t}\r\n\t},\r\n\r\n\tgetConfig: function () {\r\n\t\treturn this._worktime;\r\n\t},\r\n\t_setConfig: function (settings) {\r\n\t\tthis._worktime = settings;\r\n\t\tthis._parseSettings();\r\n\t\tthis._clearCaches();\r\n\t},\r\n\t_parseSettings: function() {\r\n\t\tvar settings = this.getConfig();\r\n\t\tsettings.parsed = {\r\n\t\t\tdates: {},\r\n\t\t\thours: null,\r\n\t\t\thaveCustomWeeks: false,\r\n\t\t\tcustomWeeks: {},\r\n\t\t\tcustomWeeksRangeStart: null,\r\n\t\t\tcustomWeeksRangeEnd: null,\r\n\t\t\tcustomWeeksBoundaries: []\r\n\t\t};\r\n\r\n\t\tsettings.parsed.hours = this._parseHours(settings.hours);\r\n\t\tfor(var i in settings.dates){\r\n\t\t\tsettings.parsed.dates[i] = this._parseHours(settings.dates[i]);\r\n\t\t}\r\n\r\n\t\tif(settings.customWeeks) {\r\n\t\t\tvar minCustomRangeStart = null;\r\n\t\t\tvar maxCustomRangeEnd = null;\r\n\t\t\tfor(var i in settings.customWeeks){\r\n\t\t\t\tvar customTime = settings.customWeeks[i];\r\n\r\n\t\t\t\tif(customTime.from && customTime.to){\r\n\t\t\t\t\tvar rangeStart = customTime.from;\r\n\t\t\t\t\tvar rangeEnd = customTime.to;\r\n\t\t\t\t\tif(!minCustomRangeStart || minCustomRangeStart > rangeStart.valueOf()){\r\n\t\t\t\t\t\tminCustomRangeStart = rangeStart.valueOf();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(!maxCustomRangeEnd || maxCustomRangeEnd < rangeEnd.valueOf()){\r\n\t\t\t\t\t\tmaxCustomRangeEnd = rangeEnd.valueOf();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsettings.parsed.customWeeksBoundaries.push({\r\n\t\t\t\t\t\tfrom: rangeStart.valueOf(),\r\n\t\t\t\t\t\tfromReadable: new Date(rangeStart),\r\n\t\t\t\t\t\tto: rangeEnd.valueOf(),\r\n\t\t\t\t\t\ttoReadable: new Date(rangeEnd),\r\n\t\t\t\t\t\tname: i\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tsettings.parsed.haveCustomWeeks = true;\r\n\t\t\t\t\tvar currentWeek = settings.parsed.customWeeks[i] = {\r\n\t\t\t\t\t\tfrom: customTime.from,\r\n\t\t\t\t\t\tto: customTime.to,\r\n\t\t\t\t\t\thours: this._parseHours(customTime.hours),\r\n\t\t\t\t\t\tdates: {}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// GS-1840. If there are no dates, it should work correctly with the weekdays\r\n\t\t\t\t\tif (customTime.days && !customTime.dates) {\r\n\t\t\t\t\t\tcustomTime.dates = customTime.dates || {};\r\n\t\t\t\t\t\tfor (var i = 0; i < customTime.days.length; i++) {\r\n\t\t\t\t\t\t\tcustomTime.dates[i] = customTime.days[i];\r\n\t\t\t\t\t\t\tif (!(customTime.days[i] instanceof Array)) {\r\n\t\t\t\t\t\t\t\tcustomTime.dates[i] = !!customTime.days[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdelete customTime.days;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor(var d in customTime.dates){\r\n\t\t\t\t\t\tcurrentWeek.dates[d] = this._parseHours(customTime.dates[d]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tsettings.parsed.customWeeksRangeStart = minCustomRangeStart;\r\n\t\t\tsettings.parsed.customWeeksRangeEnd = maxCustomRangeEnd;\r\n\r\n\t\t}\r\n\t},\r\n\r\n\t_tryChangeCalendarSettings: function (payload) {\r\n\t\tvar backup = JSON.stringify(this.getConfig());\r\n\t\tpayload();\r\n\t\tif (!this.hasWorkTime()) {\r\n\t\t//\tthis.$gantt.assert(false, \"Invalid calendar settings, no worktime available\");\r\n\t\t\tthis._setConfig(JSON.parse(backup));\r\n\t\t\tthis._clearCaches();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\t_arraysEqual: function(a, b){\r\n\t\tif (a === b) return true;\r\n\t\tif (!a || !b) return false;\r\n\t\tif (a.length != b.length) return false;\r\n\r\n\t\tfor (var i = 0; i < a.length; ++i) {\r\n\t\t\tif (a[i] !== b[i]) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\r\n\t_compareSettings: function (mySettings, thatSettings) {\r\n\t\tif (!this._arraysEqual(mySettings.hours, thatSettings.hours)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar myDays = Object.keys(mySettings.dates);\r\n\t\tvar otherDates = Object.keys(thatSettings.dates);\r\n\t\tmyDays.sort();\r\n\t\totherDates.sort();\r\n\r\n\t\tif (!this._arraysEqual(myDays, otherDates)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfor(var i = 0; i < myDays.length; i++){\r\n\t\t\tvar timestamp = myDays[i];\r\n\t\t\tvar myHours = mySettings.dates[timestamp];\r\n\t\t\tvar otherHours = mySettings.dates[timestamp];\r\n\r\n\t\t\t// day settings not equal\r\n\t\t\tif(myHours !== otherHours &&\r\n\t\t\t\t// but still can be two arrays with the equivalent hour settings\r\n\t\t\t\t!(Array.isArray(myHours) && Array.isArray(otherHours) && this._arraysEqual(myHours, otherHours))\r\n\t\t\t\t){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\tequals: function (calendar) {\r\n\t\tif(!(calendar instanceof CalendarWorkTimeStrategy)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar mySettings = this.getConfig();\r\n\t\tvar thatSettings = calendar.getConfig();\r\n\r\n\t\tif(!this._compareSettings(mySettings, thatSettings)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif(mySettings.parsed.haveCustomWeeks && thatSettings.parsed.haveCustomWeeks){\r\n\t\t\tif(mySettings.parsed.customWeeksBoundaries.length != thatSettings.parsed.customWeeksBoundaries.length){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tfor(var i in mySettings.parsed.customWeeks){\r\n\t\t\t\tvar myWeek = mySettings.parsed.customWeeks[i];\r\n\t\t\t\tvar thatWeek = thatSettings.parsed.customWeeks[i];\r\n\t\t\t\tif(!thatWeek){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!this._compareSettings(myWeek, thatWeek)){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else if(mySettings.parse.haveCustomWeeks !== thatSettings.parsed.haveCustomWeeks){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\tgetWorkHours: function () {\r\n\t\tvar config = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\r\n\t\treturn this._getWorkHours(config.date, false);\r\n\t},\r\n\t_getWorkHours: function (date, parsed) {\r\n\t\tvar calendar = this.getConfig();\r\n\t\tif(parsed !== false){\r\n\t\t\tcalendar = calendar.parsed;\r\n\t\t}\r\n\r\n\t\tif(!date){\r\n\t\t\treturn calendar.hours;\r\n\t\t}\r\n\r\n\t\tvar dateValue = this._timestamp({date: date});\r\n\r\n\t\tif(calendar.haveCustomWeeks){\r\n\t\t\tif(calendar.customWeeksRangeStart <= dateValue && calendar.customWeeksRangeEnd > dateValue){\r\n\t\t\t\tfor(var i = 0; i < calendar.customWeeksBoundaries.length; i++){\r\n\t\t\t\t\tif(calendar.customWeeksBoundaries[i].from <= dateValue && calendar.customWeeksBoundaries[i].to > dateValue){\r\n\t\t\t\t\t\tcalendar = calendar.customWeeks[calendar.customWeeksBoundaries[i].name];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar hours = true;\r\n\r\n\t\tif (calendar.dates[dateValue] !== undefined) {\r\n\t\t\thours = calendar.dates[dateValue];//custom day\r\n\t\t} else if (calendar.dates[date.getDay()] !== undefined) {\r\n\t\t\thours = calendar.dates[date.getDay()];//week day\r\n\t\t}\r\n\t\tif (hours === true) {\r\n\t\t\treturn calendar.hours;\r\n\t\t} else if (hours) {\r\n\t\t\treturn hours;\r\n\t\t}\r\n\t\treturn [];\r\n\t},\r\n\r\n\t_getIntervalTimestamp: function(from, to){\r\n\t\tvar res = {\r\n\t\t\tstart: 0,\r\n\t\t\tend: 0\r\n\t\t};\r\n\r\n\t\tres.start = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\r\n\t\tvar endHours = to.getHours();\r\n\t\tif(!endHours && !to.getMinutes() && !to.getSeconds() && from.valueOf() < to.valueOf()){\r\n\t\t\tendHours = 24;\r\n\t\t}\r\n\t\tres.end = endHours * 60 * 60 + to.getMinutes() * 60 + to.getSeconds();\r\n\t\treturn res;\r\n\t},\r\n\r\n\t_parseHours: function(hours) {\r\n\t\tif(Array.isArray(hours)){\r\n\r\n\t\t\tvar timestampRanges = [];// worktime as seconds range\r\n\t\t\thours.forEach(function(hour){\r\n\t\t\t\tif(typeof hour === \"number\"){\r\n\t\t\t\t\ttimestampRanges.push(hour*60*60);\r\n\t\t\t\t}else if(typeof hour === \"string\") {\r\n\t\t\t\t\t// \"12-13\", or \"12:00-13:00\", or \"12:00:00-13:00:00\"\r\n\t\t\t\t\thour.split(\"-\").map(function(time){\r\n\t\t\t\t\t\treturn time.trim();\r\n\t\t\t\t\t}).forEach(function(part){\r\n\t\t\t\t\t\tvar parsed = part.split(\":\").map(function(time){\r\n\t\t\t\t\t\t\treturn time.trim();\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar value = parseInt(parsed[0]*60*60);\r\n\t\t\t\t\t\tif(parsed[1]){\r\n\t\t\t\t\t\t\tvalue += parseInt(parsed[1]*60);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(parsed[2]){\r\n\t\t\t\t\t\t\tvalue += parseInt(parsed[2]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\ttimestampRanges.push(value);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tvar timerangeConfig = [];\r\n\t\t\tfor (var i = 0; i < timestampRanges.length; i += 2) {\r\n\t\t\t\tvar start = timestampRanges[i];\r\n\t\t\t\tvar end = timestampRanges[i + 1];\r\n\t\t\t\tvar duration = end - start;\r\n\r\n\t\t\t\ttimerangeConfig.push({\r\n\t\t\t\t\tstart: start,\r\n\t\t\t\t\tend: end,\r\n\t\t\t\t\tstartHour: Math.floor(start / (60*60)),\r\n\t\t\t\t\tstartMinute: Math.floor(start / (60)),\r\n\t\t\t\t\tendHour: Math.ceil(end / (60*60)),\r\n\t\t\t\t\tendMinute: Math.ceil(end / (60)),\r\n\t\t\t\t\tdurationSeconds: duration,\r\n\t\t\t\t\tdurationMinutes: duration/60,\r\n\t\t\t\t\tdurationHours: duration/(60 * 60)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn timerangeConfig;\r\n\t\t} else {\r\n\t\t\treturn hours;\r\n\t\t}\r\n\t},\r\n\r\n\tsetWorkTime: function (settings) {\r\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\r\n\t\t\tvar hours = settings.hours !== undefined ? settings.hours : true;\r\n\t\t\tvar timestamp = this._timestamp(settings);\r\n\t\t\tvar calendarConfig = this.getConfig();\r\n\t\t\tif (timestamp !== null) {\r\n\t\t\t\tcalendarConfig.dates[timestamp] = hours;\r\n\t\t\t} else if(!settings.customWeeks) {\r\n\t\t\t\tcalendarConfig.hours = hours;\r\n\t\t\t}\r\n\r\n\t\t\tif(settings.customWeeks){\r\n\t\t\t\tif(!calendarConfig.customWeeks){\r\n\t\t\t\t\tcalendarConfig.customWeeks = {};\r\n\t\t\t\t}\r\n\t\t\t\t// GS-1867. allow setWorkTime to exclude dates in the customWeeks range\r\n\t\t\t\tif (typeof settings.customWeeks == \"string\"){\r\n\t\t\t\t\tif (timestamp !== null) {\r\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].dates[timestamp] = hours;\r\n\t\t\t\t\t} else if(!settings.customWeeks) {\r\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].hours = hours;\r\n\t\t\t\t\t}\t\t\r\n\t\t\t\t} else if (typeof settings.customWeeks === \"object\"\r\n\t\t\t\t&& settings.customWeeks.constructor === Object){\r\n\t\t\t\t\tfor(var i in settings.customWeeks){\r\n\t\t\t\t\t\tcalendarConfig.customWeeks[i] = settings.customWeeks[i];\r\n\t\t\t\t\t}\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._parseSettings();\r\n\t\t\tthis._clearCaches();\r\n\t\t}, this));\r\n\t},\r\n\r\n\tunsetWorkTime: function (settings) {\r\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\r\n\t\t\tif (!settings) {\r\n\t\t\t\tthis.reset_calendar();\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar timestamp = this._timestamp(settings);\r\n\r\n\t\t\t\tif (timestamp !== null) {\r\n\t\t\t\t\tdelete this.getConfig().dates[timestamp];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Load updated settings and clear work units cache\r\n\t\t\tthis._parseSettings();\r\n\t\t\tthis._clearCaches();\r\n\t\t}, this));\r\n\t},\r\n\r\n\t_isWorkTime: function (date, unit) {\r\n\t\t// Check if this item has in the cache\r\n\r\n\t\tvar useCache = true;//unit === \"day\"; // use cache only for days. In case of hours/minutes cache size grows too large and the overhead exceeds the gains\r\n\t\tvar isWorkUnit = -1;\r\n\t\tvar dateKey = null;\r\n\r\n\t\tif(useCache){\r\n\t\t\t// use string keys\r\n\t\t\tdateKey = String(date.valueOf());\r\n\t\t\tisWorkUnit = this._workingUnitsCache.getItem(unit, dateKey, date);\r\n\t\t}\r\n\r\n\t\tif (isWorkUnit == -1) {\r\n\t\t\t// calculate if not cached\r\n\t\t\tisWorkUnit = this._checkIfWorkingUnit(date, unit);\r\n\t\t\tif(useCache){\r\n\t\t\t\tthis._workingUnitsCache.setItem(unit, dateKey, isWorkUnit, date);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn isWorkUnit;\r\n\t},\r\n\r\n\tisWorkTime: function () {\r\n\t\tvar config =  this.argumentsHelper.isWorkTimeArguments.apply( this.argumentsHelper, arguments);\r\n\t\treturn this._isWorkTime(config.date, config.unit);\r\n\t},\r\n\r\n\tcalculateDuration: function () {\r\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\r\n\r\n\t\tif (!config.unit) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t//return this._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\r\n\r\n\t\tvar self = this;\r\n\t\treturn this._dateDurationCache.getDuration(config.start_date, config.end_date, config.unit, config.step, function(){ \r\n\t\t\treturn self._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\r\n\t\t});\r\n\t},\r\n\r\n\t_calculateDuration: function (from, to, unit, step) {\r\n\t\tvar res = 0;\r\n\r\n\t\tvar sign = 1;\r\n\t\tif(from.valueOf() > to.valueOf()){\r\n\t\t\tvar tmp = to;\r\n\t\t\tto = from;\r\n\t\t\tfrom = tmp;\r\n\t\t\tsign = -1;\r\n\t\t}\r\n\r\n\t\tif (unit == \"hour\" && step == 1) {\r\n\t\t\tres = this._getHoursBetween(from, to, unit, step);\r\n\t\t} else if(unit == \"minute\" && step == 1){\r\n\t\t\t// quick calculation for minutes with 1 minute step\r\n\t\t\tres = this._getMinutesBetween(from, to, unit, step);\r\n\t\t} else {\r\n\t\t\tres = this._getWorkUnitsBetweenGeneric(from, to, unit, step);\r\n\t\t}\r\n\r\n\t\t// getWorkUnits.. returns decimal durations\r\n\t\treturn sign * Math.round(res);\r\n\t},\r\n\thasDuration: function () {\r\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\r\n\r\n\t\tvar from = config.start_date,\r\n\t\t\tto = config.end_date,\r\n\t\t\tunit = config.unit,\r\n\t\t\tstep = config.step;\r\n\r\n\t\tif (!unit) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar start = new Date(from),\r\n\t\t\tend = new Date(to);\r\n\t\tstep = step || 1;\r\n\r\n\t\twhile (start.valueOf() < end.valueOf()) {\r\n\t\t\tif (this._isWorkTime(start, unit))\r\n\t\t\t\treturn true;\r\n\t\t\tstart = this._nextDate(start, unit, step);\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\tcalculateEndDate: function () {\r\n\t\tvar config =  this.argumentsHelper.calculateEndDateArguments.apply( this.argumentsHelper, arguments);\r\n\r\n\t\tvar from = config.start_date,\r\n\t\t\tduration = config.duration,\r\n\t\t\tunit = config.unit,\r\n\t\t\tstep = config.step;\r\n\r\n\t\tif (!unit)\r\n\t\t\treturn false;\r\n\r\n\t\tvar mult = (config.duration >= 0) ? 1 : -1;\r\n\t\tduration = Math.abs(duration * 1);\r\n\t//\tvar endDate = this._calculateEndDate(from, duration, unit, step * mult);\r\n\t//\treturn endDate;\r\n\t\tvar self = this;\r\n\t\treturn this._dateDurationCache.getEndDate(from, duration, unit, step * mult, function(){ \r\n\t\t\treturn self._calculateEndDate(from, duration, unit, step * mult);\r\n\t\t} );\r\n\t},\r\n\r\n\t_calculateEndDate: function (from, duration, unit, step) {\r\n\t\tif (!unit)\r\n\t\t\treturn false;\r\n\r\n\t\tif (step == 1 && unit == \"minute\") {\r\n\t\t\treturn this._calculateMinuteEndDate(from, duration, step);\r\n\t\t} else if(step == -1 && unit == \"minute\") {\r\n\t\t\treturn this._subtractMinuteDate(from, duration, step);\r\n\t\t} else if (step == 1 && unit == \"hour\") {\r\n\t\t\treturn this._calculateHourEndDate(from, duration, step);\r\n\t\t} else {\r\n\t\t\tvar interval = this._addInterval(from, duration, unit, step, null);\r\n\t\t\treturn interval.end;\r\n\t\t}\r\n\t},\r\n\r\n\t_addInterval: function (start, duration, unit, step, stopAction) {\r\n\t\tvar added = 0;\r\n\t\tvar current = start;\r\n\t\tvar dstShift = false;\r\n\r\n\t\twhile (added < duration && !(stopAction && stopAction(current))) {\r\n\t\t\tvar next = this._nextDate(current, unit, step);\r\n\r\n\t\t\t// GS-1501. Correct hours after DST change\r\n\t\t\tif (unit == \"day\"){\r\n\t\t\t\tdstShift = dstShift || !current.getHours() && next.getHours();\r\n\r\n\t\t\t\tif (dstShift){\r\n\t\t\t\t\tnext.setHours(0);\r\n\t\t\t\t\tif (next.getHours()){\r\n\t\t\t\t\t// the day when the timezone is changed, try to correct hours next time\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdstShift = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar dateValue = new Date(next.valueOf() + 1);\r\n\t\t\tif (step > 0) {\r\n\t\t\t\tdateValue = new Date(next.valueOf() - 1);\r\n\t\t\t}\r\n\t\t\tvar workTimeCheck = this._isWorkTime(dateValue, unit);\r\n\r\n\t\t\tif (workTimeCheck && !dstShift) {\r\n\t\t\t\tadded++;\r\n\t\t\t}\r\n\t\t\tcurrent = next;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tend: current,\r\n\t\t\tstart: start,\r\n\t\t\tadded: added\r\n\t\t};\r\n\t},\r\n\r\n\t_addHoursUntilDayEnd: function(from, duration) {\r\n\t\tvar dayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(from)), 1, \"day\");\r\n\t\tvar added = 0;\r\n\t\tvar left = duration;\r\n\r\n\t\tvar range = this._getIntervalTimestamp(from, dayEnd);\r\n\t\tvar worktimes = this._getWorkHours(from);\r\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\r\n\t\t\tvar interval = worktimes[i];\r\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\r\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\r\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\r\n\t\t\t\tvar rangeHours = (minuteTo - minuteFrom) / (60 * 60);\r\n\t\t\t\tif(rangeHours > left){\r\n\t\t\t\t\trangeHours = left;\r\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60 * 60);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar addHours = Math.round((minuteTo - minuteFrom) / (60 * 60));\r\n\t\t\t\tadded += addHours;\r\n\t\t\t\tleft -= addHours;\r\n\t\t\t\trange.start = minuteTo;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar intervalEnd = dayEnd;\r\n\t\tif(added === duration){\r\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tadded: added,\r\n\t\t\tend: intervalEnd\r\n\t\t};\r\n\t},\r\n\r\n\t_calculateHourEndDate: function (from, duration,  step) {\r\n\t\tvar start = new Date(from),\r\n\t\tadded = 0;\r\n\t\tstep = step || 1;\r\n\t\tduration = Math.abs(duration * 1);\r\n\r\n\t\tvar interval = this._addHoursUntilDayEnd(start, duration);\r\n\t\tadded = interval.added;\r\n\t\tstart = interval.end;\r\n\r\n\t\tvar durationLeft = duration - added;\r\n\r\n\t\tif (durationLeft) {\r\n\t\t\tvar current = start;\r\n\t\t\twhile (added < duration) {\r\n\t\t\t\tvar next = this._nextDate(current, \"day\", step);\r\n\t\t\t\t// reset to day start in case DST switch happens in the process\r\n\t\t\t\tnext.setHours(0);\r\n\t\t\t\tnext.setMinutes(0);\r\n\t\t\t\tnext.setSeconds(0);\r\n\r\n\t\t\t\tvar hoursPerDay = 0;\r\n\t\t\t\tif(step > 0){\r\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() - 1));\r\n\t\t\t\t}else{\r\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() + 1));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (added + hoursPerDay >= duration) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tadded += hoursPerDay;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcurrent = next;\r\n\t\t\t}\r\n\t\t\tstart = current;\r\n\t\t}\r\n\r\n\t\tif (added < duration) {\r\n\t\t\tvar durationLeft = duration - added;\r\n\t\t\tinterval = this._addHoursUntilDayEnd(start, durationLeft);\r\n\t\t\tstart = interval.end;\r\n\t\t}\r\n\r\n\t\treturn start;\r\n\t},\r\n\r\n\t_addMinutesUntilHourEnd: function(from, duration){\r\n\t\tif(from.getMinutes() === 0) {\r\n\t\t\t// already at hour end\r\n\t\t\treturn {\r\n\t\t\t\tadded: 0,\r\n\t\t\t\tend: new Date(from)\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar hourEnd = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(from)), 1, \"hour\");\r\n\t\tvar added = 0;\r\n\t\tvar left = duration;\r\n\r\n\t\tvar range = this._getIntervalTimestamp(from, hourEnd);\r\n\t\tvar worktimes = this._getWorkHours(from);\r\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\r\n\t\t\tvar interval = worktimes[i];\r\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\r\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\r\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\r\n\t\t\t\tvar rangeMinutes = (minuteTo - minuteFrom) / 60;\r\n\t\t\t\tif(rangeMinutes > left){\r\n\t\t\t\t\trangeMinutes = left;\r\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\r\n\t\t\t\t/*if (rangeMinutes === 0) {\r\n\t\t\t\t\trangeMinutes = left;\r\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\r\n\t\t\t\t}*/\r\n\r\n\t\t\t\tvar addMinutes = Math.round((minuteTo - minuteFrom) / 60);\r\n\t\t\t\tleft -= addMinutes;\r\n\t\t\t\tadded += addMinutes;\r\n\t\t\t\trange.start = minuteTo;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar intervalEnd = hourEnd;\r\n\t\tif(added === duration){\r\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tadded: added,\r\n\t\t\tend: intervalEnd\r\n\t\t};\r\n\t},\r\n\r\n\t_subtractMinutesUntilHourStart: function(from, duration){\r\n\t\tvar hourStart = this.$gantt.date.hour_start(new Date(from));\r\n\t\tvar added = 0;\r\n\t\tvar left = duration;\r\n\r\n\t\tvar hourStartTimestamp = hourStart.getHours() * 60 * 60 + hourStart.getMinutes() * 60 + hourStart.getSeconds();\r\n\t\tvar initialDateTimestamp = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\r\n\r\n\t\tvar worktimes = this._getWorkHours(from);\r\n\t\tfor(var i = worktimes.length - 1; i >= 0 && added < duration; i--){\r\n\t\t\tvar interval = worktimes[i];\r\n\t\t\tif(initialDateTimestamp > interval.start && hourStartTimestamp <= interval.end){\r\n\t\t\t\tvar minuteFrom = Math.min(initialDateTimestamp, interval.end);\r\n\t\t\t\tvar minuteTo = Math.max(hourStartTimestamp, interval.start);\r\n\r\n\t\t\t//\tvar minuteFrom = Math.max(interval.start, currentHour.start);\r\n\t\t\t//\tvar minuteTo = Math.min(interval.end, currentHour.end);\r\n\t\t\t\tvar rangeMinutes = (minuteFrom - minuteTo) / 60;\r\n\t\t\t\tif(rangeMinutes > left){\r\n\t\t\t\t\trangeMinutes = left;\r\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\r\n\t\t\t\t/*if (rangeMinutes === 0) {\r\n\t\t\t\t\trangeMinutes = left;\r\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\r\n\t\t\t\t}*/\r\n\r\n\t\t\t\tvar addMinutes = Math.abs(Math.round((minuteFrom - minuteTo) / 60));\r\n\t\t\t\tleft -= addMinutes;\r\n\t\t\t\tadded += addMinutes;\r\n\t\t\t\tinitialDateTimestamp = minuteTo;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar intervalEnd = hourStart;\r\n\t\tif(added === duration){\r\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, initialDateTimestamp);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tadded: added,\r\n\t\t\tend: intervalEnd\r\n\t\t};\r\n\t},\r\n\r\n\t_subtractMinuteDate: function (from, duration, step) {\r\n\t\t// var start = new Date(from),\r\n\t\t// GS-2683. We should start calculating minutes from the working time\r\n\t\tvar start = this.getClosestWorkTime({ date: from, dir: \"past\", unit: \"minute\" }),\r\n\t\t\tadded = 0;\r\n\t\tstep = step || -1;\r\n\t\tduration = Math.abs(duration * 1);\r\n\t\tduration = Math.round(duration);\r\n\r\n\t\tconst minutePrecision = this._isMinutePrecision(start);\r\n\r\n\t\tlet addedInterval = this._subtractMinutesUntilHourStart(start, duration);\r\n\t\tadded += addedInterval.added;\r\n\r\n\t\tstart = addedInterval.end;\r\n\r\n\t\tvar calculatedDay = 0;\r\n\t\tvar daySchedule = [];\r\n\t\tvar minutesInDay = 0;\r\n\r\n\t\twhile (added < duration) {\r\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start));\r\n\r\n\t\t\tvar iterateFromDayEnd = false;\r\n\t\t\tif(start.valueOf() === dayStart.valueOf()){\r\n\t\t\t\tdayStart = this.$gantt.date.add(dayStart, -1, \"day\");\r\n\t\t\t\titerateFromDayEnd = true;\r\n\t\t\t}\r\n\t\t\t//var dayStartTimestamp = this.$gantt.date.day_start(new Date(start)).valueOf();\r\n\t\t\tvar dayEnd = new Date(dayStart.getFullYear(), dayStart.getMonth(), dayStart.getDate(), 23, 59,59,999).valueOf();\r\n\r\n\t\t\tif(dayEnd !== calculatedDay){\r\n\t\t\t\tdaySchedule = this._getWorkHours(dayStart);\r\n\t\t\t\tminutesInDay = this._getMinutesPerDay(dayStart);\r\n\t\t\t\tcalculatedDay = dayEnd;\r\n\t\t\t}\r\n\r\n\t\t\tvar left = duration - added;\r\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start, iterateFromDayEnd);\r\n\r\n\t\t\tif(!daySchedule.length || !minutesInDay){\r\n\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(daySchedule[daySchedule.length - 1].end <= timestamp){\r\n\t\t\t\tif(left > minutesInDay){\r\n\t\t\t\t\tadded += minutesInDay;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar isWorkHour = false;\r\n\t\t\tvar workInterval = null;\r\n\t\t\tvar prevInterval = null;\r\n\t\t\tfor(var i = daySchedule.length - 1; i >= 0; i--){\r\n\t\t\t\tif(daySchedule[i].start < timestamp - 1 && daySchedule[i].end >= timestamp - 1){\r\n\t\t\t\t\tisWorkHour = true;\r\n\t\t\t\t\tworkInterval = daySchedule[i];\r\n\t\t\t\t\tprevInterval = daySchedule[i-1];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(isWorkHour){\r\n\r\n\t\t\t\t// we're at the end of worktime interval and subtracting more than the duration of the interval\r\n\t\t\t\t// -> subtract the duration of the interval and move to the start of the interval (we're moving from end)\r\n\t\t\t\tif(timestamp === workInterval.end && left >= workInterval.durationMinutes){\r\n\t\t\t\t\tadded += workInterval.durationMinutes;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, -workInterval.durationMinutes, \"minute\");\r\n\t\t\t\t} // worktime is set in whole hours (no intervals like 9:15-10:00)\r\n\t\t\t\t// the amount we need to subtract lies inside the interval\r\n\t\t\t\telse if(!minutePrecision && left <= (timestamp/60 - workInterval.startMinute)){\r\n\t\t\t\t\tadded += left;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\r\n\t\t\t\t}else if (minutePrecision){\r\n\t\t\t\t\t// GS-2129. If the working time is set in minutes, we accumulate the working time in minutes from right to left\r\n\t\t\t\t\t\r\n\t\t\t\t\t// duration we need to subtract lies completely inside the work interval\r\n\t\t\t\t\tif(left <= (timestamp/60 - workInterval.startMinute)){\r\n\t\t\t\t\t\tadded += left;\r\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\r\n\t\t\t\t\t}else {\r\n\t\t\t\t\t\t// we need to go trough multiple work intervals to subtract needed time\r\n\t\t\t\t\t\tadded += (timestamp/60 - workInterval.startMinute);\r\n\t\t\t\t\t\tif(prevInterval){\r\n\t\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, prevInterval.end);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\r\n\t\t\t\t\tif(minutesInHour <= left){\r\n\t\t\t\t\t\tadded += minutesInHour;\r\n\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, left);\r\n\t\t\t\t\t\tadded += addedInterval.added;\r\n\t\t\t\t\t\tstart = addedInterval.end;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0){\r\n\t\t\t\t\tvar prev = this._getClosestWorkTimePast(start, \"hour\");\r\n\t\t\t\t\tif(prev.valueOf() === start.valueOf()){\r\n\t\t\t\t\t\tvar prev = this.$gantt.date.add(start, -1, \"day\");\r\n\t\t\t\t\t\tvar times = this._getWorkHours(prev);\r\n\t\t\t\t\t\tif(times.length){\r\n\t\t\t\t\t\t\tvar lastInterval = times[times.length - 1];\r\n\t\t\t\t\t\t\tprev.setSeconds(lastInterval.durationSeconds);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstart = prev;\r\n\r\n\t\t\t\t} else{\r\n\t\t\t\t\tstart = this._getClosestWorkTimePast(new Date(start - 1), \"hour\");\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (added < duration) {\r\n\t\t\tvar durationLeft = duration - added;\r\n\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, durationLeft);\r\n\t\t\tadded += addedInterval.added;\r\n\t\t\tstart = addedInterval.end;\r\n\t\t}\r\n\r\n\t\treturn start;\r\n\t},\r\n\t_calculateMinuteEndDate: function (from, duration, step) {\r\n\t\tvar start = new Date(from),\r\n\t\t\tadded = 0;\r\n\t\tstep = step || 1;\r\n\t\tduration = Math.abs(duration * 1);\r\n\t\tduration = Math.round(duration);\r\n\r\n\t\tvar addedInterval = this._addMinutesUntilHourEnd(start, duration);\r\n\t\tadded += addedInterval.added;\r\n\r\n\t\tstart = addedInterval.end;\r\n\r\n\t\tvar calculatedDay = 0;\r\n\t\tvar daySchedule = [];\r\n\t\tvar minutesInDay = 0;\r\n\r\n\t\tvar minutePrecision = this._isMinutePrecision(start);\r\n\r\n\t\twhile (added < duration) {\r\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start)).valueOf();\r\n\t\t\tif(dayStart !== calculatedDay){\r\n\t\t\t\tdaySchedule = this._getWorkHours(start);\r\n\t\t\t\tminutesInDay = this._getMinutesPerDay(start);\r\n\t\t\t\tcalculatedDay = dayStart;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar left = duration - added;\r\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start);\r\n\r\n\t\t\tif(!daySchedule.length || !minutesInDay){\r\n\t\t\t\tstart = this.$gantt.date.add(this.$gantt.date.day_start(start), 1, \"day\");\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(daySchedule[0].start >= timestamp){\r\n\t\t\t\tif(left >= minutesInDay){\r\n\t\t\t\t\tadded += minutesInDay;\r\n\t\t\t\t\tif (left == minutesInDay) {\r\n\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, daySchedule[daySchedule.length - 1].end);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\r\n\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar isWorkHour = false;\r\n\t\t\tvar workInterval = null;\r\n\t\t\tfor(var i = 0; i < daySchedule.length; i++){\r\n\t\t\t\tif(daySchedule[i].start <= timestamp && daySchedule[i].end > timestamp){\r\n\t\t\t\t\tisWorkHour = true;\r\n\t\t\t\t\tworkInterval = daySchedule[i];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(isWorkHour){\r\n\r\n\t\t\t\tif(timestamp === workInterval.start && left >= workInterval.durationMinutes){\r\n\t\t\t\t\tadded += workInterval.durationMinutes;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, workInterval.durationMinutes, \"minute\");\r\n\t\t\t\t}else if(left <= (workInterval.endMinute - timestamp/60)){\r\n\t\t\t\t\tadded += left;\r\n\t\t\t\t\tstart = this.$gantt.date.add(start, left, \"minute\");\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\r\n\t\t\t\t\tif(minutesInHour <= left){\r\n\t\t\t\t\t\tadded += minutesInHour;\r\n\t\t\t\t\t\t// when the working time settings are set in minutes move to the next minutes\r\n\t\t\t\t\t\tif (minutePrecision) {\r\n\t\t\t\t\t\t\tstart = this.$gantt.date.add(start, minutesInHour, \"minute\");\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, left);\r\n\t\t\t\t\t\tadded += addedInterval.added;\r\n\t\t\t\t\t\tstart = addedInterval.end;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tstart = this._getClosestWorkTimeFuture(start, \"hour\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (added < duration) {\r\n\t\t\tvar durationLeft = duration - added;\r\n\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, durationLeft);\r\n\t\t\tadded += addedInterval.added;\r\n\t\t\tstart = addedInterval.end;\r\n\t\t}\r\n\r\n\t\treturn start;\r\n\t},\r\n\r\n\tgetClosestWorkTime: function () {\r\n\t\tvar settings =  this.argumentsHelper.getClosestWorkTimeArguments.apply( this.argumentsHelper, arguments);\r\n\t\treturn this._getClosestWorkTime(settings.date, settings.unit, settings.dir);\r\n\t},\r\n\r\n\t_getClosestWorkTime: function (inputDate, unit, direction) {\r\n\t\tvar result = new Date(inputDate);\r\n\r\n\t\tif (this._isWorkTime(result, unit)) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tresult = this.$gantt.date[unit + '_start'](result);\r\n\r\n\t\tif (direction == 'any' || !direction) {\r\n\t\t\tvar closestFuture = this._getClosestWorkTimeFuture(result, unit);\r\n\t\t\tvar closestPast = this._getClosestWorkTimePast(result, unit);\r\n\t\t\tif (Math.abs(closestFuture - inputDate) <= Math.abs(inputDate - closestPast)) {\r\n\t\t\t\tresult = closestFuture;\r\n\t\t\t} else {\r\n\t\t\t\tresult = closestPast;\r\n\t\t\t}\r\n\t\t} else if (direction == \"past\") {\r\n\t\t\tresult = this._getClosestWorkTimePast(result, unit);\r\n\t\t} else {\r\n\t\t\tresult = this._getClosestWorkTimeFuture(result, unit);\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t_getClosestWorkTimeFuture: function (date, unit) {\r\n\t\treturn this._getClosestWorkTimeGeneric(date, unit, 1);\r\n\t},\r\n\r\n\t_getClosestWorkTimePast: function (date, unit) {\r\n\t\tvar result = this._getClosestWorkTimeGeneric(date, unit, -1);\r\n\t\t// should return the end of the closest work interval\r\n\t\treturn this.$gantt.date.add(result, 1, unit);\r\n\t},\r\n\r\n\t_findClosestTimeInDay: function(date, direction, worktimes) {\r\n\t\tvar start = new Date(date);\r\n\t\tvar resultDate = null;\r\n\t\tvar fromDayEnd = false;\r\n\t\tif(!this._getWorkHours(start).length){\r\n\t\t\tstart = this._getClosestWorkTime(start, \"day\", direction < 0 ? \"past\" : \"future\");\r\n\t\t\tif(direction < 0){\r\n\t\t\t\tstart = new Date(start.valueOf() - 1);\r\n\t\t\t\tfromDayEnd = true;\r\n\t\t\t}\r\n\t\t\tworktimes = this._getWorkHours(start);\r\n\t\t}\r\n\r\n\t\tvar value = this._getTimeOfDayStamp(start);\r\n\t\tif(fromDayEnd){\r\n\t\t\tvalue = this._getTimeOfDayStamp(new Date(start.valueOf() + 1), fromDayEnd);\r\n\t\t}\r\n\t\tif(direction > 0){\r\n\t\t\tfor(var i = 0; i < worktimes.length; i++){\r\n\t\t\t\tif(worktimes[i].start >= value){\r\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].start);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tfor(var i = worktimes.length - 1; i >= 0; i--){\r\n\t\t\t\tif(worktimes[i].end <= value){\r\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].end);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}else if(worktimes[i].end > value && worktimes[i].start <= value) {\r\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, value);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn resultDate;\r\n\t},\r\n\t_getClosestWorkMinute: function(date, unit, direction) {\r\n\t\tvar start = new Date(date);\r\n\t\tvar worktimes = this._getWorkHours(start);\r\n\t\tvar resultDate = this._findClosestTimeInDay(start, direction, worktimes);\r\n\t\tif(!resultDate){\r\n\t\t\tif(direction > 0){\r\n\t\t\t\tstart = this.calculateEndDate(start, direction, unit);\r\n\t\t\t\tstart = this.$gantt.date.day_start(start);\r\n\t\t\t}else{\r\n\t\t\t\tstart = this.calculateEndDate(start, direction, \"day\");\r\n\t\t\t\tstart = this.$gantt.date.day_start(start);\r\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\r\n\t\t\t\tstart = new Date(start.valueOf() - 1);\r\n\t\t\t}\r\n\t\t\tworktimes = this._getWorkHours(start);\r\n\t\t\tresultDate = this._findClosestTimeInDay(start, direction, worktimes);\r\n\t\t}\r\n\t\tif(direction < 0){\r\n\t\t\t// getClosestWorkTimePast adds one time unit to the result date after this\r\n\t\t\tresultDate = this.$gantt.date.add(resultDate, -1, unit);\r\n\t\t}\r\n\t\treturn resultDate;\r\n\t},\r\n\r\n\t_getClosestWorkTimeGeneric: function (date, unit, increment) {\r\n\t\tif(unit === \"hour\" || unit === \"minute\"){\r\n\t\t\treturn this._getClosestWorkMinute(date, unit, increment);\r\n\t\t}\r\n\r\n\t\tvar unitOrder = this._getUnitOrder(unit),\r\n\t\t\tbiggerTimeUnit = this.units[unitOrder - 1];\r\n\r\n\t\tvar result = date;\r\n\r\n\t\t// be extra sure we won't fall into infinite loop, 3k seems big enough\r\n\t\tvar maximumLoop = 3000,\r\n\t\t\tcount = 0;\r\n\r\n\t\twhile (!this._isWorkTime(result, unit)) {\r\n\t\t\tif (biggerTimeUnit && !this._isWorkTime(result, biggerTimeUnit)) {\r\n\t\t\t\t// if we look for closest work hour and detect a week-end - first find the closest work day,\r\n\t\t\t\t// and continue iterations after that\r\n\t\t\t\tif (increment > 0) {\r\n\t\t\t\t\tresult = this._getClosestWorkTimeFuture(result, biggerTimeUnit);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult = this._getClosestWorkTimePast(result, biggerTimeUnit);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._isWorkTime(result, unit)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcount++;\r\n\t\t\tif (count > maximumLoop) {\r\n\t\t\t\tthis.$gantt.assert(false, \"Invalid working time check\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tvar tzOffset = result.getTimezoneOffset();\r\n\t\t\tresult = this.$gantt.date.add(result, increment, unit);\r\n\r\n\t\t\tresult = this.$gantt._correct_dst_change(result, tzOffset, increment, unit);\r\n\t\t\tif (this.$gantt.date[unit + '_start']) {\r\n\t\t\t\tresult = this.$gantt.date[unit + '_start'](result);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t/**\r\n\t * Check whether this calendar has working time. Calendar has working time only if there are regular working days of week\r\n\t *\r\n\t */\r\n\thasWorkTime: function () {\r\n\t\tvar worktime = this.getConfig();\r\n\t\tvar dates = worktime.dates;\r\n\r\n\t\tvar daysOfWeek = [0, 1, 2, 3, 4, 5, 6];\r\n\t\tvar exceptions = [];\r\n\t\tfor(var i in worktime.dates){\r\n\t\t\tif(Number(i) > 6){\r\n\t\t\t\texceptions.push(Number(i));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar hasRegularHours = this._checkWorkHours(worktime.hours);\r\n\r\n\t\tvar result = false;\r\n\t\tdaysOfWeek.forEach((function(day){\r\n\t\t\tif(result){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar dayConfig = dates[day];\r\n\t\t\tif(dayConfig === true){\r\n\t\t\t\t// workday uses global hours\r\n\t\t\t\tresult = hasRegularHours;\r\n\t\t\t}else if(Array.isArray(dayConfig)){\r\n\t\t\t\t// workday uses custom hours\r\n\t\t\t\tresult = this._checkWorkHours(dayConfig);\r\n\t\t\t}\r\n\t\t}).bind(this));\r\n\r\n\t\treturn result;\r\n\r\n\t},\r\n\r\n\t_checkWorkHours: function(hoursArray) {\r\n\t\tif (hoursArray.length === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar result = false;\r\n\t\tfor (var i = 0; i < hoursArray.length; i += 2) {\r\n\t\t\tif (hoursArray[i] !== hoursArray[i + 1]) {\r\n\t\t\t\tresult = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\r\n\t_isMinutePrecision: function (date) {\r\n\t\tlet minutePrecision = false;\r\n\t\tthis._getWorkHours(date).forEach(function(interval){\r\n\t\t\tif (interval.startMinute % 60 || interval.endMinute % 60){\r\n\t\t\t\tminutePrecision = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn minutePrecision;\r\n\t}\r\n};\r\n\r\nexport default CalendarWorkTimeStrategy;","import { IWorkUnitCache } from \"./workunit_cache_interface\";\r\nimport { WorkUnitsMapCache } from \"./workunit_map_cache\";\r\nimport { WorkUnitsObjectCache } from \"./workunit_object_cache\";\r\nexport { LargerUnitsCache } from \"./larger_units_helper\";\r\n\r\nexport function createCacheObject(): IWorkUnitCache {\r\n\r\n\t// worktime hash is on the hot path,\r\n\t// Map seems to work faster than plain array, use it whenever possible\r\n\tif (typeof Map !== \"undefined\") {\r\n\t\treturn new WorkUnitsMapCache();\r\n\t} else {\r\n\t\treturn new WorkUnitsObjectCache();\r\n\t}\r\n}\r\n","export default {\r\n\tisLegacyResourceCalendarFormat: function(resourceCalendarsProperty){\r\n\t\t// modern format:\r\n\t\t//gantt.config.resource_calendars = {\r\n\t\t//\tresourceId: calendarId,\r\n\t\t//\tresourceId: calendarId,\r\n\t\t//\tresourceId: calendarId\r\n\t\t//\t};\r\n\t\t\r\n\t\t// legacy format:\r\n\t\t// gantt.config.resource_calendars = {\r\n\t\t//\t\"resourceProperty\": {\r\n\t\t//\t\tresourceId: calendarId,\r\n\t\t//\t\tresourceId: calendarId,\r\n\t\t//\t\tresourceId: calendarId\r\n\t\t//\t\t}\r\n\t\t//\t};\r\n\r\n\t\tif(!resourceCalendarsProperty){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor(var i in resourceCalendarsProperty){\r\n\t\t\tif(resourceCalendarsProperty[i] && typeof resourceCalendarsProperty[i] === \"object\"){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t},\r\n\tgetResourceProperty: function(config){\r\n\t\tvar resourceCalendarsConfig = config.resource_calendars;\r\n\t\tvar propertyName = config.resource_property;\r\n\t\tif(this.isLegacyResourceCalendarFormat(resourceCalendarsConfig)){\r\n\t\t\tfor(var i in config){\r\n\t\t\t\tpropertyName = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn propertyName;\r\n\t},\r\n\tgetCalendarIdFromLegacyConfig: function(task, config){\r\n\t\tif (config) {\r\n\t\t\tfor (var field in config) {\r\n\t\t\t\tvar resource = config[field];\r\n\t\t\t\tif (task[field]) {\r\n\t\t\t\t\tvar calendarId = resource[task[field]];\r\n\t\t\t\t\tif (calendarId) {\r\n\t\t\t\t\t\treturn calendarId;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n};","import * as utils from \"../../utils/utils\";\r\nimport createArgumentsHelper from \"./calendar_arguments_helper\";\r\nimport CalendarMergeHelper from \"./strategy/work_calendar_merger\";\r\nimport CalendarWorkTimeStrategy from \"./strategy/calendar_strategy\";\r\nimport legacyResourceCalendarConfig from \"./legacy_resource_config\";\r\nimport dynamicResourceCalendarsFactory from \"./dynamic_resource_calendars\";\r\n\r\nconst dynamicResourceCalendars = dynamicResourceCalendarsFactory();\r\n\r\nfunction CalendarManager (gantt){\r\n\tthis.$gantt = gantt;\r\n\tthis._calendars = {};\r\n\tthis._legacyConfig = undefined;\r\n\tthis.$gantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tif(this.$gantt.config.resource_calendars){\r\n\t\t\tthis._isLegacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars);\r\n\t\t}\r\n\t}.bind(this));\r\n\r\n\tthis.$gantt.attachEvent(\"onBeforeGanttReady\", function(){\r\n\t\tthis.createDefaultCalendars();\r\n\t}.bind(this));\r\n\tthis.$gantt.attachEvent(\"onBeforeGanttRender\", function(){\r\n\t\tthis.createDefaultCalendars();\r\n\t}.bind(this));\r\n}\r\n\r\nCalendarManager.prototype = {\r\n\t_calendars: {},\r\n\t_convertWorkTimeSettings: function (settings) {\r\n\t\tvar days = settings.days;\r\n\t\tif (days && !settings.dates) {\r\n\t\t\tsettings.dates = settings.dates || {};\r\n\t\t\tfor (var i = 0; i < days.length; i++) {\r\n\t\t\t\tsettings.dates[i] = days[i];\r\n\t\t\t\tif (!(days[i] instanceof Array)) {\r\n\t\t\t\t\tsettings.dates[i] = !!days[i];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tdelete settings.days;\r\n\t\treturn settings;\r\n\t},\r\n\tmergeCalendars: function(){\r\n\t\tvar calendars = [];\r\n\t\tvar args = arguments;\r\n\t\tif(Array.isArray(args[0])){\r\n\t\t\tcalendars = args[0].slice();\r\n\t\t}else{\r\n\t\t\tfor(var i = 0; i < arguments.length; i++){\r\n\t\t\t\tcalendars.push(arguments[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar mergeHelper = new CalendarMergeHelper();\r\n\r\n\t\tvar result;\r\n\t\tcalendars.forEach(function(calendar){\r\n\t\t\tif(!result){\r\n\t\t\t\tresult = calendar;\r\n\t\t\t} else{\r\n\t\t\t\tresult = this._createCalendarFromConfig(mergeHelper.merge(result, calendar));\r\n\t\t\t}\r\n\r\n\t\t}.bind(this));\r\n\t\treturn this.createCalendar(result);\r\n\t},\r\n\r\n\t_createCalendarFromConfig: function(config){\r\n\t\tvar apiCore = new CalendarWorkTimeStrategy(this.$gantt, createArgumentsHelper(this.$gantt));\r\n\t\tapiCore.id = String(utils.uid());\r\n\r\n\t\tvar preparedConfig = this._convertWorkTimeSettings(config);\r\n\t\tif(preparedConfig.customWeeks){\r\n\t\t\tfor(var i in preparedConfig.customWeeks){\r\n\t\t\t\tpreparedConfig.customWeeks[i] = this._convertWorkTimeSettings(preparedConfig.customWeeks[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tapiCore._setConfig(preparedConfig);\r\n\r\n\t\treturn apiCore;\r\n\t},\r\n\r\n\tcreateCalendar: function (parentCalendar) {\r\n\t\tvar settings;\r\n\r\n\t\tif (!parentCalendar) {\r\n\t\t\tparentCalendar = {};\r\n\t\t}\r\n\r\n\t\tif (parentCalendar.getConfig){\r\n\t\t\tsettings = utils.copy(parentCalendar.getConfig());\r\n\t\t} else if (parentCalendar.worktime) {\r\n\t\t\tsettings = utils.copy(parentCalendar.worktime);\r\n\t\t} else {\r\n\t\t\tsettings = utils.copy(parentCalendar);\r\n\t\t}\r\n\r\n\t\tvar defaults = utils.copy(this.defaults.fulltime.worktime);\r\n\t\tutils.mixin(settings, defaults);\r\n\r\n\t\treturn this._createCalendarFromConfig(settings);\r\n\t},\r\n\r\n\tgetCalendar: function (id) {\r\n\t\tid = id || \"global\";\r\n\t\tvar calendar = this._calendars[id];\r\n\t\tif(!calendar){\r\n\t\t\tthis.createDefaultCalendars();\r\n\t\t\tcalendar = this._calendars[id];\r\n\t\t}\r\n\r\n\t\treturn calendar;\r\n\t},\r\n\r\n\tgetCalendars: function () {\r\n\t\tvar res = [];\r\n\t\tfor (var i in this._calendars) {\r\n\t\t\tres.push(this.getCalendar(i));\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\r\n\t_getOwnCalendar: function(task){\r\n\t\tvar config = this.$gantt.config;\r\n\t\tif (task[config.calendar_property]) {\r\n\t\t\treturn this.getCalendar(task[config.calendar_property]);\r\n\t\t}\r\n\r\n\t\tif (config.resource_calendars) {\r\n\t\t\tvar calendar;\r\n\t\t\tvar calendarId;\r\n\t\t\tvar resourceProperty;\r\n\t\t\tif(this._legacyConfig === false){\r\n\t\t\t\tresourceProperty = config.resource_property;\r\n\t\t\t}else{\r\n\t\t\t\tresourceProperty = legacyResourceCalendarConfig.getResourceProperty(config);\r\n\t\t\t}\r\n\t\t\t// GS-2821. If no resource is assigned to a task,\r\n\t\t\t// there is no need to check the resource calendar\r\n\t\t\tif(Array.isArray(task[resourceProperty]) && task[resourceProperty].length){\r\n\t\t\t\t// if multiple resources are attached to the task - merge their calendars\r\n\t\t\t\tif(config.dynamic_resource_calendars){\r\n\t\t\t\t\tcalendarId = dynamicResourceCalendars.getCalendarIdFromMultipleResources(task[resourceProperty], this);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcalendar = this.getResourceCalendar(task[resourceProperty]);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tif(this._legacyConfig === undefined){\r\n\t\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this._legacyConfig){\r\n\t\t\t\t\tvar calendarId = legacyResourceCalendarConfig.getCalendarIdFromLegacyConfig(task, config.resource_calendars);\r\n\t\t\t\t}else if(resourceProperty && task[resourceProperty] && config.resource_calendars[task[resourceProperty]]){\r\n\t\t\t\t\tvar calendar = this.getResourceCalendar(task[resourceProperty]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(calendarId){\r\n\t\t\t\tcalendar = this.getCalendar(calendarId);\r\n\t\t\t}\r\n\r\n\t\t\tif(calendar){\r\n\t\t\t\treturn calendar;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\t/**\r\n\t * Returns calendar assigned to the specified resource.\r\n\t * Returns the global calendar if no custom calendar is associated with the resource.\r\n\t * @param {(string|number|Object)} resource - resource object or resource id\r\n\t * @returns {object} Calendar object\r\n\t */\r\n\tgetResourceCalendar: function(resource) {\r\n\t\tif (resource === null || resource === undefined) {\r\n\t\t\treturn this.getCalendar();\r\n\t\t}\r\n\r\n\t\tvar resourceId = null;\r\n\t\t// if task id is provided\r\n\t\tif((typeof resource === \"number\" || typeof resource === \"string\")){\r\n\t\t\tresourceId = resource;\r\n\t\t}else{\r\n\t\t\tresourceId = resource.id || resource.key;\r\n\t\t}\r\n\r\n\t\tvar config = this.$gantt.config;\r\n\t\tvar calendarsConfig = config.resource_calendars;\r\n\t\tvar calendarId = null;\r\n\r\n\t\t// GS-1714: if resource is specified through array\r\n\t\tif (Array.isArray(resource)){\r\n\t\t\tif (resource.length === 1){\r\n\t\t\t\tif (typeof resource[0] === 'object'){\r\n\t\t\t\t\tresourceId = resource[0].resource_id; // if resource: [\"resource_id: \"6\", value: \"4\", ...\"]\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresourceId = resource[0]; // if resource: [1]\r\n\t\t\t\t}\r\n\t\t\t} \r\n\t\t}\r\n\t\t\r\n\t\tif (calendarsConfig) {\r\n\t\t\tif(this._legacyConfig === undefined){\r\n\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\r\n\t\t\t}\r\n\r\n\t\t\tif(this._legacyConfig){\r\n\t\t\t\tfor(var field in calendarsConfig){\r\n\t\t\t\t\tif(calendarsConfig[field][resourceId]){\r\n\t\t\t\t\t\tcalendarId = calendarsConfig[field][resourceId];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tvar calendarId = calendarsConfig[resourceId];\r\n\t\t\t}\r\n\r\n\t\t\tif(calendarId){\r\n\t\t\t\treturn this.getCalendar(calendarId);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn this.getCalendar();\r\n\t},\r\n\r\n\t/**\r\n\t * Returns the calendar assigned to a task.\r\n\t * - Returns a calendar assigned via task[gantt.config.calendar_property] if specified.\r\n\t * - Returns a calendar assigned to the task resource if specified.\r\n\t * - Returns the global calendar otherwise.\r\n\t * @param {(string|number|Object)} task - task object or task id\r\n\t * @returns {object} Calendar object\r\n\t */\r\n\tgetTaskCalendar: function (task) {\r\n\t\tvar gantt = this.$gantt;\r\n\t\tvar taskObject;\r\n\t\tif (task === null || task === undefined) {\r\n\t\t\treturn this.getCalendar();\r\n\t\t}\r\n\r\n\t\t// if task id is provided\r\n\t\tif((typeof task === \"number\" || typeof task === \"string\") && gantt.isTaskExists(task)){\r\n\t\t\ttaskObject = gantt.getTask(task);\r\n\t\t}else{\r\n\t\t\ttaskObject = task;\r\n\t\t}\r\n\r\n\t\tif(!taskObject){\r\n\t\t\treturn this.getCalendar();\r\n\t\t}\r\n\r\n\t\tvar calendar = this._getOwnCalendar(taskObject);\r\n\t\tvar groupMode = !!gantt.getState().group_mode;\r\n\r\n\t\tif (!calendar && gantt.config.inherit_calendar && gantt.isTaskExists(taskObject.parent)){\r\n\t\t\t// GS-1579  group mode overrides tree hierarchy, iterate using `.parent` property, instead of using eachParent iterator\r\n\t\t\tvar currentTask = taskObject;\r\n\t\t\twhile(gantt.isTaskExists(currentTask.parent)){\r\n\t\t\t\tcurrentTask = gantt.getTask(currentTask.parent);\r\n\t\t\t\tif(gantt.isSummaryTask(currentTask)){\r\n\t\t\t\t\tcalendar = this._getOwnCalendar(currentTask);\r\n\t\t\t\t\tif(calendar){\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(groupMode && !calendar){\r\n\t\t\t\t// if group mode and inherit_calendars is enabled - preserve previously applied parent calendar\r\n\t\t\t\t// we may need it when groupBy parses grouped data, old parent may be not loaded yet\r\n\t\t\t\tif(task.$effective_calendar){\r\n\t\t\t\t\tcalendar = this.getCalendar(task.$effective_calendar);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn calendar || this.getCalendar();\r\n\t},\r\n\r\n\taddCalendar: function(calendar) { // puts new calendar to Global Storage - gantt.calendarManager._calendars {}\r\n\t\tif (!(this.isCalendar(calendar))) {\r\n\t\t\tvar id = calendar.id;\r\n\t\t\tcalendar = this.createCalendar(calendar);\r\n\t\t\tcalendar.id = id;\r\n\t\t}\r\n\r\n\t\t// validate/check if empty calendar\r\n\t\tif (!calendar._tryChangeCalendarSettings(function () {\r\n\t\t\t})) {\r\n\r\n\t\t\tthis.$gantt.callEvent(\"onCalendarError\", [{message: \"Invalid calendar settings, no worktime available\"}, calendar]);\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\tvar config = this.$gantt.config;\r\n\r\n\t\t\tcalendar.id = calendar.id || utils.uid();\r\n\t\t\tthis._calendars[calendar.id] = calendar;\r\n\t\t\tif (!config.worktimes)\r\n\t\t\t\tconfig.worktimes = {};\r\n\t\t\tconfig.worktimes[calendar.id] = calendar.getConfig();\r\n\t\t\treturn calendar.id;\r\n\t\t}\r\n\t},\r\n\r\n\tdeleteCalendar: function (calendar) {\r\n\t\tvar config = this.$gantt.config;\r\n\t\tif (!calendar) return false;\r\n\t\tif (this._calendars[calendar]) {\r\n\t\t\tdelete this._calendars[calendar];\r\n\t\t\tif (config.worktimes && config.worktimes[calendar])\r\n\t\t\t\tdelete config.worktimes[calendar];\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t},\r\n\r\n\trestoreConfigCalendars: function (configs) {\r\n\t\tfor (var i in configs) {\r\n\t\t\tif (this._calendars[i])\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tvar settings = configs[i];\r\n\t\t\tvar calendar = this.createCalendar(settings);\r\n\t\t\tcalendar.id = i;\r\n\t\t\tthis.addCalendar(calendar);\r\n\t\t}\r\n\t},\r\n\r\n\tdefaults: {\r\n\t\tglobal: {\r\n\t\t\tid: \"global\",\r\n\t\t\tworktime: {\r\n\t\t\t\thours: [8, 12, 13, 17],\r\n\t\t\t\tdays: [0, 1, 1, 1, 1, 1, 0]\r\n\t\t\t}\r\n\t\t},\r\n\t\tfulltime: {\r\n\t\t\tid: \"fulltime\",\r\n\t\t\tworktime: {\r\n\t\t\t\thours: [0, 24],\r\n\t\t\t\tdays: [1, 1, 1, 1, 1, 1, 1]\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcreateDefaultCalendars: function () {\r\n\t\tvar config = this.$gantt.config;\r\n\t\tthis.restoreConfigCalendars(this.defaults);\r\n\t\tthis.restoreConfigCalendars(config.worktimes);\r\n\t},\r\n\r\n\tisCalendar: function(possibleCalendar) {\r\n\t\t// because we don't have any way to check without dependency to CalendarWorkTimeStrategy\r\n\t\tvar props = [\r\n\t\t\tpossibleCalendar.isWorkTime,\r\n\t\t\tpossibleCalendar.setWorkTime,\r\n\t\t\tpossibleCalendar.getWorkHours,\r\n\t\t\tpossibleCalendar.unsetWorkTime,\r\n\t\t\tpossibleCalendar.getClosestWorkTime,\r\n\t\t\tpossibleCalendar.calculateDuration,\r\n\t\t\tpossibleCalendar.hasDuration,\r\n\t\t\tpossibleCalendar.calculateEndDate\r\n\t\t];\r\n\t\treturn props.every(function(entry) {\r\n\t\t\treturn entry instanceof Function;\r\n\t\t});\r\n\t}\r\n};\r\n\r\nexport default CalendarManager;","export default function() {\r\n\tfunction getResourcesCalendarKey(resourceAssignments){\r\n\t\treturn resourceAssignments.map(function(res){\r\n\t\t\tif(res && res.resource_id){\r\n\t\t\t\treturn res.resource_id;\r\n\t\t\t} else {\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t}).sort().join(\"-\");\r\n\t}\r\n\r\n\tvar dynamicCalendars = {};\r\n\r\n\tfunction mergeResourceCalendars(resourceAssignments, manager){\r\n\t\treturn manager.mergeCalendars(resourceAssignments.map(function(assignment){\r\n\t\t\tvar resourceId = (assignment && assignment.resource_id) ? assignment.resource_id : assignment;\r\n\t\t\treturn manager.getResourceCalendar(resourceId);\r\n\t\t}));\r\n\t}\r\n\tfunction getCalendarIdFromMultipleResources(resourceAssignments, manager){\r\n\t\tvar key = getResourcesCalendarKey(resourceAssignments);\r\n\t\tif(!resourceAssignments.length){\r\n\t\t\treturn null;\r\n\t\t}else if(resourceAssignments.length === 1){\r\n\t\t\treturn manager.getResourceCalendar(key).id;\r\n\t\t}else if (dynamicCalendars[key]){\r\n\t\t\treturn dynamicCalendars[key].id;\r\n\t\t} else {\r\n\t\t\tvar tempCalendar = mergeResourceCalendars(resourceAssignments, manager);\r\n\r\n\t\t\tdynamicCalendars[key] = tempCalendar;\r\n\t\t\treturn manager.addCalendar(tempCalendar);\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetCalendarIdFromMultipleResources: getCalendarIdFromMultipleResources\r\n\t};\r\n};","function CalendarDisabledTimeStrategy(gantt, argumentsHelper){\r\n\tthis.argumentsHelper = argumentsHelper;\r\n\tthis.$gantt = gantt;\r\n}\r\n\r\nCalendarDisabledTimeStrategy.prototype = {\r\n\tgetWorkHours: function () {\r\n\t\treturn [0, 24];\r\n\t},\r\n\tsetWorkTime: function () {\r\n\t\treturn true;\r\n\t},\r\n\tunsetWorkTime: function () {\r\n\t\treturn true;\r\n\t},\r\n\tisWorkTime: function () {\r\n\t\treturn true;\r\n\t},\r\n\tgetClosestWorkTime: function (config) {\r\n\t\tvar config = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\r\n\t\treturn config.date;\r\n\t},\r\n\r\n\tcalculateDuration: function () {\r\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\r\n\t\tvar from = config.start_date,\r\n\t\t\tto = config.end_date,\r\n\t\t\tunit = config.unit,\r\n\t\t\tstep = config.step;\r\n\r\n\t\treturn this._calculateDuration(from, to, unit, step);\r\n\t},\r\n\t_calculateDuration: function (start, end, unit, step) {\r\n\t\tvar dateHelper = this.$gantt.date;\r\n\t\tvar fixedUnits = {\r\n\t\t\t\"week\": 1000 * 60 * 60 * 24 * 7,\r\n\t\t\t\"day\": 1000 * 60 * 60 * 24,\r\n\t\t\t\"hour\": 1000 * 60 * 60,\r\n\t\t\t\"minute\": 1000 * 60\r\n\t\t};\r\n\r\n\t\tvar res = 0;\r\n\t\tif (fixedUnits[unit]) {\r\n\t\t\tres = Math.round((end - start) / (step * fixedUnits[unit]));\r\n\t\t} else {\r\n\t\t\tvar from = new Date(start),\r\n\t\t\t\tto = new Date(end);\r\n\t\t\twhile (from.valueOf() < to.valueOf()) {\r\n\t\t\t\tres += 1;\r\n\t\t\t\tfrom = dateHelper.add(from, step, unit);\r\n\t\t\t}\r\n\r\n\t\t\tif (from.valueOf() != end.valueOf()) {\r\n\t\t\t\tres += (to - from) / (dateHelper.add(from, step, unit) - from);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn Math.round(res);\r\n\t},\r\n\r\n\thasDuration: function () {\r\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\r\n\t\tvar from = config.start_date,\r\n\t\t\tto = config.end_date,\r\n\t\t\tunit = config.unit;\r\n\r\n\t\tif (!unit) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfrom = new Date(from);\r\n\t\tto = new Date(to);\r\n\r\n\t\treturn (from.valueOf() < to.valueOf());\r\n\t},\r\n\r\n\thasWorkTime: function() {\r\n\t\treturn true;\r\n\t},\r\n\r\n\tequals: function(calendar) {\r\n\t\tif(!(calendar instanceof CalendarDisabledTimeStrategy)){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\r\n\tcalculateEndDate: function () {\r\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tvar start = config.start_date,\r\n\t\t\tduration = config.duration,\r\n\t\t\tunit = config.unit,\r\n\t\t\tstep = config.step;\r\n\r\n\t\treturn this.$gantt.date.add(start, step * duration, unit);\r\n\t}\r\n};\r\n\r\nexport default CalendarDisabledTimeStrategy;","import createArgumentsHelper from \"./calendar_arguments_helper\";\r\nimport NoWorkTimeCalendar from \"./strategy/no_work_time\";\r\n\r\nfunction TimeCalculator(calendarManager){\r\n\r\n\tthis.$gantt = calendarManager.$gantt;\r\n\tthis.argumentsHelper = createArgumentsHelper(this.$gantt);\r\n\tthis.calendarManager = calendarManager;\r\n\tthis.$disabledCalendar = new NoWorkTimeCalendar(this.$gantt, this.argumentsHelper);\r\n}\r\n\r\nTimeCalculator.prototype = {\r\n\t_getCalendar: function (config) {\r\n\t\tvar calendar;\r\n\t\tif (!this.$gantt.config.work_time) {\r\n\t\t\tcalendar = this.$disabledCalendar;\r\n\t\t} else {\r\n\t\t\tvar manager = this.calendarManager;\r\n\t\t\tif (config.task) {\r\n\t\t\t\tcalendar = manager.getTaskCalendar(config.task);\r\n\t\t\t} else if (config.id) {\r\n\t\t\t\tcalendar = manager.getTaskCalendar(config);\r\n\t\t\t} else if (config.calendar) {\r\n\t\t\t\tcalendar = config.calendar;\r\n\t\t\t}\r\n\t\t\tif (!calendar) {\r\n\t\t\t\tcalendar = manager.getTaskCalendar();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn calendar;\r\n\t},\r\n\r\n\tgetWorkHours: function (config) {\r\n\t\tconfig = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tvar calendar = this._getCalendar(config);\r\n\r\n\t\treturn calendar.getWorkHours(config.date);\r\n\t},\r\n\r\n\tsetWorkTime: function (config, calendar) {\r\n\t\tconfig = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tif (!calendar)\r\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\r\n\t\treturn calendar.setWorkTime(config);\r\n\t},\r\n\r\n\tunsetWorkTime: function (config, calendar) {\r\n\t\tconfig = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tif (!calendar)\r\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\r\n\t\treturn calendar.unsetWorkTime(config);\r\n\t},\r\n\tisWorkTime: function (date, unit, task, calendar) {\r\n\t\tvar config = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tcalendar = this._getCalendar(config);\r\n\t\treturn calendar.isWorkTime(config);\r\n\t},\r\n\tgetClosestWorkTime: function (config) {\r\n\t\tconfig = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tvar calendar = this._getCalendar(config);\r\n\r\n\t\treturn calendar.getClosestWorkTime(config);\r\n\t},\r\n\r\n\tcalculateDuration: function () { // start_date_date, end_date, task\r\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\r\n\t\tvar calendar = this._getCalendar(config);\r\n\t\treturn calendar.calculateDuration(config);\r\n\t},\r\n\thasDuration: function () {\r\n\t\tvar config = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tvar calendar = this._getCalendar(config);\r\n\r\n\t\treturn calendar.hasDuration(config);\r\n\t},\r\n\tcalculateEndDate: function (config) { // start_date, duration, unit, task\r\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\r\n\r\n\t\tvar calendar = this._getCalendar(config);\r\n\t\treturn calendar.calculateEndDate(config);\r\n\t}\r\n};\r\n\r\nexport default TimeCalculator;\r\n\r\n","// TODO: rework public api for date methods\r\nimport * as utils from \"../../utils/utils\";\r\n\r\nvar createWorkTimeFacade = function(calendarManager, timeCalculator){\r\n\treturn {\r\n\t\tgetWorkHours: function (date) {\r\n\t\t\treturn timeCalculator.getWorkHours(date);\r\n\t\t},\r\n\r\n\t\tsetWorkTime: function (config) {\r\n\t\t\treturn timeCalculator.setWorkTime(config);\r\n\t\t},\r\n\r\n\t\tunsetWorkTime: function (config) {\r\n\t\t\ttimeCalculator.unsetWorkTime(config);\r\n\t\t},\r\n\r\n\t\tisWorkTime: function (date, unit, task) {\r\n\t\t\treturn timeCalculator.isWorkTime(date, unit, task);\r\n\t\t},\r\n\r\n\t\tgetClosestWorkTime: function (config) {\r\n\t\t\treturn timeCalculator.getClosestWorkTime(config);\r\n\t\t},\r\n\r\n\t\tcalculateDuration: function (start_date, end_date, task) {\r\n\t\t\treturn timeCalculator.calculateDuration(start_date, end_date, task);\r\n\t\t},\r\n\t\t_hasDuration: function (start_date, end_date, task) {\r\n\t\t\treturn timeCalculator.hasDuration(start_date, end_date, task);\r\n\t\t},\r\n\r\n\t\tcalculateEndDate: function (start, duration, unit, task) {\r\n\t\t\treturn timeCalculator.calculateEndDate(start, duration, unit, task);\r\n\t\t},\r\n\r\n\t\tmergeCalendars: utils.bind(calendarManager.mergeCalendars, calendarManager),\r\n\t\tcreateCalendar: utils.bind(calendarManager.createCalendar, calendarManager),\r\n\t\taddCalendar: utils.bind(calendarManager.addCalendar, calendarManager),\r\n\t\tgetCalendar: utils.bind(calendarManager.getCalendar, calendarManager),\r\n\t\tgetCalendars: utils.bind(calendarManager.getCalendars, calendarManager),\r\n\t\tgetResourceCalendar: utils.bind(calendarManager.getResourceCalendar, calendarManager),\r\n\t\tgetTaskCalendar: utils.bind(calendarManager.getTaskCalendar, calendarManager),\r\n\t\tdeleteCalendar: utils.bind(calendarManager.deleteCalendar, calendarManager)\r\n\t};\r\n};\r\n\r\n\r\nexport default { create: createWorkTimeFacade };","import * as helpers from \"../utils/helpers\";\r\n\r\nexport default function(gantt) {\r\n\r\n\tgantt.isUnscheduledTask = function (task) {\r\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isUnscheduledTask. Task object was expected\");\r\n\t\treturn (!!task.unscheduled || !task.start_date);\r\n\t};\r\n\r\n\tgantt._isAllowedUnscheduledTask = function (task) {\r\n\t\treturn !!(task.unscheduled && gantt.config.show_unscheduled);\r\n\t};\r\n\r\n\tgantt._isTaskInTimelineLimits = function(task) {\r\n\t\tvar taskStart = task.start_date ? task.start_date.valueOf() : null;\r\n\t\tvar taskEnd = task.end_date ? task.end_date.valueOf() : null;\r\n\t\treturn !!(taskStart && taskEnd && taskStart <= this._max_date.valueOf() && taskEnd >= this._min_date.valueOf());\r\n\t};\r\n\tgantt.isTaskVisible = function (id) {\r\n\t\tif (!this.isTaskExists(id)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar task = this.getTask(id);\r\n\t\tif (!(this._isAllowedUnscheduledTask(task) || this._isTaskInTimelineLimits(task))) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn !!(this.getGlobalTaskIndex(id) >= 0);\r\n\t};\r\n\r\n\tgantt._getProjectEnd = function() {\r\n\t\tif(gantt.config.project_end){\r\n\t\t\treturn gantt.config.project_end;\r\n\t\t}else{\r\n\t\t\tvar tasks = gantt.getTaskByTime();\r\n\t\t\ttasks = tasks.sort(function (a, b) {\r\n\t\t\t\treturn +a.end_date > +b.end_date ? 1 : -1;\r\n\t\t\t});\r\n\t\t\treturn tasks.length ? tasks[tasks.length - 1].end_date : null;\r\n\t\t}\r\n\t};\r\n\tgantt._getProjectStart = function() {\r\n\t\tif (gantt.config.project_start) {\r\n\t\t\treturn gantt.config.project_start;\r\n\t\t}\r\n\r\n\t\t// use timeline start if project start is not specified\r\n\t\tif (gantt.config.start_date) {\r\n\t\t\treturn gantt.config.start_date;\r\n\t\t}\r\n\t\tif (gantt.getState().min_date) {\r\n\t\t\treturn gantt.getState().min_date;\r\n\t\t}\r\n\r\n\t\t// earliest task start if neither project start nor timeline are specified\r\n\t\tvar tasks = gantt.getTaskByTime();\r\n\t\ttasks = tasks.sort(function (a, b) {\r\n\t\t\treturn +a.start_date > +b.start_date ? 1 : -1;\r\n\t\t});\r\n\t\treturn tasks.length ? tasks[0].start_date : null;\r\n\t};\r\n\r\n\tvar getDefaultTaskDate = function (item, parent_id) {\r\n\t\tvar parentExists = parent_id && parent_id != gantt.config.root_id && gantt.isTaskExists(parent_id);\r\n\t\tvar parent = parentExists ? gantt.getTask(parent_id) : false,\r\n\t\t\tstartDate = null;\r\n\t\tif (parent) {\r\n\t\t\tif(gantt.config.schedule_from_end){\r\n\t\t\t\tstartDate = gantt.calculateEndDate({\r\n\t\t\t\t\tstart_date: parent.end_date,\r\n\t\t\t\t\tduration: - gantt.config.duration_step,\r\n\t\t\t\t\ttask:item\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tif(!parent.start_date){\r\n\t\t\t\t\treturn getDefaultTaskDate(parent, gantt.getParent(parent));\r\n\t\t\t\t}\r\n\t\t\t\tstartDate = parent.start_date;\r\n\t\t\t}\r\n\r\n\t\t} else if(gantt.config.schedule_from_end) {\r\n\t\t\tstartDate = gantt.calculateEndDate({\r\n\t\t\t\tstart_date: gantt._getProjectEnd(),\r\n\t\t\t\tduration: - gantt.config.duration_step,\r\n\t\t\t\ttask:item\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst first = gantt.getTaskByIndex(0);\r\n\t\t\tconst minDate = gantt.config.start_date || gantt.getState().min_date;\r\n\r\n\t\t\tif (first){\r\n\t\t\t\tif (first.start_date){\r\n\t\t\t\t\tstartDate = first.start_date;\r\n\t\t\t\t}\r\n\t\t\t\telse if (first.end_date){\r\n\t\t\t\t\tstartDate = gantt.calculateEndDate({\r\n\t\t\t\t\t\tstart_date: first.end_date,\r\n\t\t\t\t\t\tduration: -gantt.config.duration_step,\r\n\t\t\t\t\t\ttask:item\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tstartDate = minDate;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tstartDate = minDate;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgantt.assert(startDate, \"Invalid dates\");\r\n\t\treturn new Date(startDate);\r\n\t};\r\n\r\n\tgantt._set_default_task_timing = function (task) {\r\n\t\ttask.start_date = task.start_date || getDefaultTaskDate(task, gantt.getParent(task));\r\n\t\ttask.duration = task.duration || gantt.config.duration_step;\r\n\t\ttask.end_date = task.end_date || gantt.calculateEndDate(task);\r\n\t};\r\n\r\n\tgantt.createTask = function (item, parent, index) {\r\n\t\titem = item || {};\r\n\r\n\t\tif (!gantt.defined(item.id))\r\n\t\t\titem.id = gantt.uid();\r\n\r\n\t\tif (!item.start_date) {\r\n\t\t\titem.start_date = getDefaultTaskDate(item, parent);\r\n\t\t}\r\n\t\tif (item.text === undefined) {\r\n\t\t\titem.text = gantt.locale.labels.new_task;\r\n\t\t}\r\n\t\tif (item.duration === undefined) {\r\n\t\t\titem.duration = 1;\r\n\t\t}\r\n\r\n\t\tif (this.isTaskExists(parent)) {\r\n\t\t\tthis.setParent(item, parent, true);\r\n\t\t\tvar parentObj = this.getTask(parent);\r\n\t\t\tparentObj.$open = true;\r\n\t\t\t// GS-1583. Save the $open state to the Undo Stack\r\n\t\t\tif (!this.config.details_on_create){\r\n\t\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!this.callEvent(\"onTaskCreated\", [item])) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (this.config.details_on_create) {\r\n\t\t\t//GS-761: assert unique ID\r\n\t\t\tif (gantt.isTaskExists(item.id)){\r\n\t\t\t\tvar task = gantt.getTask(item.id);\r\n\t\t\t\tif (task.$index != item.$index) {\r\n\t\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\r\n\t\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\r\n\t\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\r\n\t\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\r\n\t\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.$data.tasksStore.updateItem(item.id, item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\titem.$new = true;\r\n\t\t\t\tthis.silent(function(){\r\n\t\t\t\t\tgantt.$data.tasksStore.addItem(item, index);\r\n\t\t\t\t});\t\r\n\t\t\t}\r\n\t\t\tthis.selectTask(item.id);\r\n\t\t\tthis.refreshData();\r\n\t\t\tthis.showLightbox(item.id);\r\n\t\t} else {\r\n\t\t\tif (this.addTask(item, parent, index)) {\r\n\t\t\t\tthis.showTask(item.id);\r\n\t\t\t\tthis.selectTask(item.id);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn item.id;\r\n\t};\r\n\r\n\tgantt._update_flags = function (oldid, newid) {\r\n\t\t//  TODO: need a proper way to update all possible flags\r\n\t\tvar store = gantt.$data.tasksStore;\r\n\t\tif (oldid === undefined) {\r\n\t\t\tthis._lightbox_id = null;\r\n\r\n\t\t\tstore.silent(function(){\r\n\t\t\t\tstore.unselect();\r\n\t\t\t});\r\n\t\t\t// GS-1522. If we have multiselect, unselect all previously selected tasks\r\n\t\t\tif (this.getSelectedTasks) {\r\n\t\t\t\tthis._multiselect.reset();\r\n\t\t\t}\r\n\r\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag) {\r\n\t\t\t\tthis._tasks_dnd.drag.id = null;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (this._lightbox_id == oldid)\r\n\t\t\t\tthis._lightbox_id = newid;\r\n\r\n\t\t\t// TODO: probably can be removed\r\n\t\t\tif (store.getSelectedId() == oldid) {\r\n\t\t\t\tstore.silent(function(){\r\n\t\t\t\t\tstore.unselect(oldid);\r\n\t\t\t\t\tstore.select(newid);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == oldid) {\r\n\t\t\t\tthis._tasks_dnd.drag.id = newid;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tvar getTaskTimingMode = function (task, force) {\r\n\t\tvar task_type = gantt.getTaskType(task.type);\r\n\r\n\t\tvar state = {\r\n\t\t\ttype: task_type,\r\n\t\t\t$no_start: false,\r\n\t\t\t$no_end: false,\r\n\t\t\tscheduled_summary: false\r\n\t\t};\r\n\r\n\t\tif(task_type === gantt.config.types.project && task.auto_scheduling === false){\r\n\t\t\tstate.scheduled_summary = true;\r\n\t\t}\r\n\r\n\t\tif (!force && task_type == task.$rendered_type) {\r\n\t\t\tstate.$no_start = task.$no_start;\r\n\t\t\tstate.$no_end = task.$no_end;\r\n\t\t\treturn state;\r\n\t\t}\r\n\r\n\t\tif (task_type == gantt.config.types.project) {\r\n\t\t\t//project duration is always defined by children duration\r\n\t\t\tstate.$no_end = state.$no_start = true;\r\n\t\t} else if (task_type != gantt.config.types.milestone) {\r\n\t\t\t//tasks can have fixed duration, children duration(as projects), or one date fixed, and other defined by nested items\r\n\t\t\tstate.$no_end = !(task.end_date || task.duration);\r\n\t\t\tstate.$no_start = !task.start_date;\r\n\r\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) {\r\n\t\t\t\tstate.$no_end = state.$no_start = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn state;\r\n\t};\r\n\r\n\tgantt._init_task_timing = function (task) {\r\n\t\tvar task_mode = getTaskTimingMode(task, true);\r\n\r\n\t\tvar dirty = task.$rendered_type != task_mode.type;\r\n\r\n\t\tvar task_type = task_mode.type;\r\n\r\n\t\tif (dirty) {\r\n\t\t\ttask.$no_start = task_mode.$no_start;\r\n\t\t\ttask.$no_end = task_mode.$no_end;\r\n\t\t\ttask.$rendered_type = task_mode.type;\r\n\t\t}\r\n\r\n\t\tif (dirty && task_type != this.config.types.milestone) {\r\n\t\t\tif (task_type == this.config.types.project) {\r\n\t\t\t\t//project duration is always defined by children duration\r\n\t\t\t\tthis._set_default_task_timing(task);\r\n\t\t\t\ttask.$calculate_duration = false;// do not recalculate duration below\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (task_type == this.config.types.milestone) {\r\n\t\t\ttask.end_date = task.start_date;\r\n\t\t}\r\n\t\tif (task.start_date && task.end_date && task.$calculate_duration !== false) {\r\n\t\t\ttask.duration = this.calculateDuration(task);\r\n\t\t}\r\n\r\n\t\tif(!task.$calculate_duration){\r\n\t\t\ttask.$calculate_duration = true;\r\n\t\t}\r\n\r\n\t\tif (!task.end_date) {\r\n\t\t\ttask.end_date = task.start_date;\r\n\t\t}\r\n\r\n\t\ttask.duration = task.duration || 0;\r\n\t\t// GS-1145. We should let tasks to have 0 duration if user wants it\r\n\t\tif (this.config.min_duration === 0 && task.duration === 0){\r\n\t\t\ttask.$no_end = false;\r\n\t\t\t//GS-2813: special case for project that has 0 duration with milestone child\r\n\t\t\tif(task.type === gantt.config.types.project && gantt.hasChild(task.id)){\r\n\t\t\t\ttask.$no_end = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// work calendar of task has changed\r\n\t\tvar effectiveCalendar = this.getTaskCalendar(task);\r\n\t\tif(task.$effective_calendar && task.$effective_calendar !== effectiveCalendar.id){\r\n\t\t\tupdateTaskTiming(task);\r\n\t\t\tif(this.config.inherit_calendar && this.isSummaryTask(task)){\r\n\t\t\t\tthis.eachTask(function(child){\r\n\t\t\t\t\tupdateTaskTiming(child);\r\n\t\t\t\t}, task.id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttask.$effective_calendar = effectiveCalendar.id;\r\n\t};\r\n\r\n\tfunction updateTaskTiming(task) {\r\n\t\ttask.$effective_calendar = gantt.getTaskCalendar(task).id;\r\n\t\ttask.start_date = gantt.getClosestWorkTime({\r\n\t\t\tdir: \"future\",\r\n\t\t\tdate: task.start_date,\r\n\t\t\tunit: gantt.config.duration_unit,\r\n\t\t\ttask: task\r\n\t\t});\r\n\t\ttask.end_date = gantt.calculateEndDate(task);\r\n\t}\r\n\r\n\tgantt.isSummaryTask = function (task) {\r\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSummaryTask. Task object was expected\");\r\n\r\n\t\tvar mode = getTaskTimingMode(task);\r\n\r\n\t\treturn !!(mode.$no_end || mode.$no_start);\r\n\t};\r\n\r\n// downward calculation of project duration\r\n\tgantt.resetProjectDates = function (task) {\r\n\t\tvar taskMode = getTaskTimingMode(task);\r\n\t\tif (taskMode.$no_end || taskMode.$no_start) {\r\n\t\t\tvar info = getSubtaskInfo(task.id);\r\n\t\t\tassignProjectDates.call(this, task, taskMode, info.start_date, info.end_date);\r\n\t\t\ttask.$rollup = info.rollup;\r\n\t\t}\r\n\t};\r\n\r\n\tfunction assignProjectDates(task, taskTiming, from, to) {\r\n\r\n\t\tconst summaryDateFields = {\r\n\t\t\tstart: \"start_date\",\r\n\t\t\tend: \"end_date\"\r\n\t\t};\r\n\t\tconst manuallyScheduledSummaryDateFields = {\r\n\t\t\tstart: \"$auto_start_date\",\r\n\t\t\tend: \"$auto_end_date\"\r\n\t\t};\r\n\r\n\t\tlet dateFields;\r\n\t\tif(task.type === gantt.config.types.project && task.auto_scheduling === false){\r\n\t\t\tdateFields = manuallyScheduledSummaryDateFields;\r\n\t\t}else{\r\n\t\t\tdateFields = summaryDateFields;\r\n\t\t}\r\n\r\n\t\tif (taskTiming.$no_start) {\r\n\t\t\tif (from) {\r\n\t\t\t\ttask[dateFields.start] = new Date(from);\r\n\t\t\t} else {\r\n\t\t\t\ttask[dateFields.start] = getDefaultTaskDate(task, this.getParent(task));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (taskTiming.$no_end) {\r\n\t\t\tif (to) {\r\n\t\t\t\ttask[dateFields.end] = new Date(to);\r\n\t\t\t} else {\r\n\t\t\t\ttask[dateFields.end] = this.calculateEndDate({\r\n\t\t\t\t\tstart_date: task[dateFields.start],\r\n\t\t\t\t\tduration: this.config.duration_step,\r\n\t\t\t\t\ttask: task\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (taskTiming.$no_start || taskTiming.$no_end) {\r\n\t\t\tthis._init_task_timing(task);\r\n\t\t}\r\n\t}\r\n\r\n\tgantt.getSubtaskDuration = function (taskId) {\r\n\t\tvar res = 0,\r\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id;\r\n\r\n\t\tthis.eachTask(function (child) {\r\n\t\t\tif (this.getTaskType(child.type) == gantt.config.types.project || this.isUnscheduledTask(child))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tres += child.duration;\r\n\t\t}, root);\r\n\r\n\t\treturn res;\r\n\t};\r\n\r\n\tfunction getSubtaskInfo (taskId){\r\n\t\tvar min = null,\r\n\t\t\tmax = null,\r\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id,\r\n\t\t\trollup = [];\r\n\r\n\t\tgantt.eachTask(function (child) {\r\n\t\t\tconst isScheduledSummary = (gantt.getTaskType(child.type) == gantt.config.types.project && (child.auto_scheduling === false));\r\n\t\t\tif ((gantt.getTaskType(child.type) == gantt.config.types.project && !isScheduledSummary) || gantt.isUnscheduledTask(child))\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\tif(child.rollup){\r\n\t\t\t\trollup.push(child.id);\r\n\t\t\t}\r\n\r\n\t\t\tif ((child.start_date && (!child.$no_start || isScheduledSummary)) && (!min || min > child.start_date.valueOf()))\r\n\t\t\t\tmin = child.start_date.valueOf();\r\n\t\t\tif ((child.end_date && (!child.$no_end || isScheduledSummary)) && (!max || max < child.end_date.valueOf()))\r\n\t\t\t\tmax = child.end_date.valueOf();\r\n\t\t}, root);\r\n\r\n\t\treturn {\r\n\t\t\tstart_date: min ? new Date(min) : null,\r\n\t\t\tend_date: max ? new Date(max) : null,\r\n\t\t\trollup: rollup\r\n\t\t};\r\n\t}\r\n\r\n\tgantt.getSubtaskDates = function (task_id) {\r\n\t\tvar info = getSubtaskInfo(task_id);\r\n\t\treturn {\r\n\t\t\tstart_date: info.start_date,\r\n\t\t\tend_date: info.end_date\r\n\t\t};\r\n\t};\r\n\r\n\r\n// upward calculation of project duration\r\n\tgantt._update_parents = function (taskId, silent, updateAll) {\r\n\t\tif (!taskId) return;\r\n\r\n\t\tvar task = this.getTask(taskId);\r\n\t\tif(task.rollup){\r\n\t\t\tupdateAll = true;\r\n\t\t}\r\n\t\tvar pid = this.getParent(task);\r\n\r\n\t\tvar taskTiming = getTaskTimingMode(task);\r\n\r\n\t\tvar has_changed = true;\r\n\t\t// GS-761 the dates check is necessary for adding empty tasks: gantt.addTask({id:\"2\"})\r\n\t\tif (updateAll || (task.start_date && task.end_date && (taskTiming.$no_start || taskTiming.$no_end))) {\r\n\r\n\t\t\tconst startDateField = task.$auto_start_date ? \"$auto_start_date\" : \"start_date\";\r\n\t\t\tconst endDateField = task.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\r\n\r\n\t\t\tvar oldStart = task[startDateField].valueOf(),\r\n\t\t\t\toldEnd = task[endDateField].valueOf();\r\n\r\n\t\t\tgantt.resetProjectDates(task);\r\n\r\n\t\t\t// not refresh parent projects if dates hasn't changed\r\n\t\t\tif (!updateAll && oldStart == task[startDateField].valueOf() && oldEnd == task[endDateField].valueOf()) {\r\n\t\t\t\thas_changed = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (has_changed && !silent) {\r\n\t\t\t\tthis.refreshTask(task.id, true);\r\n\t\t\t}\r\n\r\n\t\t\tif(taskTiming.scheduled_summary){\r\n\t\t\t\thas_changed = true;//recalculate upwards from scheduled summaries\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (has_changed && pid && this.isTaskExists(pid)) {\r\n\t\t\tthis._update_parents(pid, silent, updateAll);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.roundDate = function (config) {\r\n\t\tvar scale = gantt.getScale();\r\n\r\n\t\tif (helpers.isDate(config)) {\r\n\t\t\tconfig = {\r\n\t\t\t\tdate: config,\r\n\t\t\t\tunit: scale ? scale.unit : gantt.config.duration_unit,\r\n\t\t\t\tstep: scale ?  scale.step : gantt.config.duration_step\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar date = config.date,\r\n\t\t\tsteps = config.step,\r\n\t\t\tunit = config.unit;\r\n\r\n\t\tif(!scale){\r\n\t\t\treturn date;\r\n\t\t}\r\n\r\n\t\tvar upper, lower, colIndex;\r\n\t\tif (unit == scale.unit && steps == scale.step &&\r\n\t\t\t+date >= +scale.min_date && +date <= +scale.max_date) {\r\n\t\t\t//find date in time scale config\r\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\r\n\r\n\t\t\tif (!scale.trace_x[colIndex]) {\r\n\t\t\t\tcolIndex -= 1;// end of time scale\r\n\t\t\t\tif(scale.rtl){\r\n\t\t\t\t\tcolIndex = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlower = new Date(scale.trace_x[colIndex]);\r\n\t\t\tupper = gantt.date.add(lower, steps, unit);\r\n\t\t} else {\r\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\r\n\r\n\t\t\tupper = gantt.date[unit + \"_start\"](new Date(scale.min_date));\r\n\t\t\tif (scale.trace_x[colIndex]) {\r\n\t\t\t\tupper = gantt.date[unit + \"_start\"](scale.trace_x[colIndex]);// end of time scale\r\n\t\t\t}\r\n\r\n\t\t\twhile (+upper < +date) {\r\n\t\t\t\tupper = gantt.date[unit + \"_start\"](gantt.date.add(upper, steps, unit));\r\n\r\n\t\t\t\tvar tzOffset = upper.getTimezoneOffset();\r\n\r\n\t\t\t\tupper = gantt._correct_dst_change(upper, tzOffset, upper, unit);\r\n\t\t\t\tif (gantt.date[unit + '_start'])\r\n\t\t\t\t\tupper = gantt.date[unit + '_start'](upper);\r\n\t\t\t}\r\n\r\n\t\t\tlower = gantt.date.add(upper, -1 * steps, unit);\r\n\r\n\t\t}\r\n\t\tif (config.dir && config.dir == 'future')\r\n\t\t\treturn upper;\r\n\t\tif (config.dir && config.dir == 'past')\r\n\t\t\treturn lower;\r\n\r\n\t\tif (Math.abs(date - lower) < Math.abs(upper - date)) {\r\n\t\t\treturn lower;\r\n\t\t} else {\r\n\t\t\treturn upper;\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tgantt.correctTaskWorkTime = function (task) {\r\n\t\tif (gantt.config.work_time && gantt.config.correct_work_time) {\r\n\t\t\tif (!this.isWorkTime(task.start_date, undefined, task)) {\r\n\t\t\t\ttask.start_date = this.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\r\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\r\n\t\t\t} else if (!this.isWorkTime(new Date(+task.end_date - 1), undefined, task)) {\r\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\r\n\t\tgantt._init_task_timing(task);\r\n\t\treturn true;\r\n\t});\r\n\tgantt.attachEvent(\"onBeforeTaskAdd\", function (id, task) {\r\n\t\tgantt._init_task_timing(task);\r\n\t\treturn true;\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\r\n\t\tgantt._init_task_timing(gantt.getTask(id));\r\n\t\treturn true;\r\n\t});\r\n\r\n};","function addResizeListener(gantt){\r\n\tvar containerStyles = window.getComputedStyle(gantt.$root);\r\n\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\r\n\t\tgantt.$root.style.position = \"relative\";\r\n\t}\r\n\r\n\tvar resizeWatcher = document.createElement('iframe');\r\n\tresizeWatcher.className = \"gantt_container_resize_watcher\";\r\n\tresizeWatcher.tabIndex = -1;\r\n\tif(gantt.config.wai_aria_attributes){\r\n\t\tresizeWatcher.setAttribute(\"role\", \"none\");\r\n\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\r\n\t}\r\n\r\n\tif (gantt.env.isSalesforce){\r\n\t\tgantt.config.container_resize_method = \"timeout\";\r\n\t}\r\n\r\n\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\r\n\tgantt.$root.appendChild(resizeWatcher);\r\n\tif (resizeWatcher.contentWindow) {\r\n\t\tlistenWindowResize(gantt, resizeWatcher.contentWindow);\r\n\t} else {\r\n\t\t// if so - ditch the iframe and fallback to listening the main window resize\r\n\t\tgantt.$root.removeChild(resizeWatcher);\r\n\t\tlistenWindowResize(gantt, window);\r\n\t}\r\n}\r\n\r\nfunction listenWindowResize(gantt, window){\r\n\tvar resizeTimeout = gantt.config.container_resize_timeout || 20;\r\n\tvar resizeDelay;\r\n\tlet previousSize = getContainerSize(gantt);\r\n\r\n\tif (gantt.config.container_resize_method == \"timeout\"){\r\n\t\tlowlevelResizeWatcher();\r\n\t}\r\n\telse {\r\n\t\ttry {\r\n\t\t\tgantt.event(window, \"resize\", function () {\r\n\t\t\t\tif (gantt.$scrollbarRepaint) {\r\n\t\t\t\t\tgantt.$scrollbarRepaint = null;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// GS-2140. Don't repaint Gantt if it has the same sizes\r\n\t\t\t\t\tlet currentSize = getContainerSize(gantt);\r\n\t\t\t\t\tif (previousSize.x == currentSize.x && previousSize.y == currentSize.y){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpreviousSize = currentSize;\r\n\t\t\t\t\trepaintGantt();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (e) {\r\n\t\t\tlowlevelResizeWatcher();\r\n\t\t}\r\n\t}\r\n\r\n\tfunction repaintGantt(){\r\n\t\tclearTimeout(resizeDelay);\r\n\t\tresizeDelay = setTimeout(function(){\r\n\t\t\tif(!gantt.$destroyed){\r\n\t\t\t\tgantt.render();\r\n\t\t\t}\r\n\t\t}, resizeTimeout);\r\n\t}\r\n\r\n\tvar previousHeight = gantt.$root.offsetHeight;\r\n\tvar previousWidth = gantt.$root.offsetWidth;\t\r\n\r\n\tfunction lowlevelResizeWatcher(){\r\n\t\tif (gantt.$root.offsetHeight != previousHeight ||\r\n\t\t\t\tgantt.$root.offsetWidth != previousWidth){\r\n\t\t\t\trepaintGantt();\r\n\t\t}\r\n\r\n\t\tpreviousHeight = gantt.$root.offsetHeight;\r\n\t\tpreviousWidth = gantt.$root.offsetWidth;\r\n\r\n\t\tsetTimeout(lowlevelResizeWatcher, resizeTimeout);\r\n\t}\r\n}\r\n\r\nfunction getContainerSize(gantt){\r\n\treturn {\r\n\t\tx: gantt.$root.offsetWidth,\r\n\t\ty: gantt.$root.offsetHeight\r\n\t};\r\n}\r\n\r\nexport default addResizeListener;","import * as domHelpers from \"./ui/utils/dom_helpers\";\r\nimport * as helpers from \"../utils/helpers\";\r\nimport isHeadless from \"../utils/is_headless\";\r\nimport addResizeListener from \"./ui/resize_listener\";\r\nimport calculateScaleRange from \"./gantt_data_range\";\r\nimport assert from \"./common/assert\";\r\n\r\nexport default function(gantt){\r\n\t\r\n\r\n\tgantt.assert = assert(gantt);\r\n\r\n\tfunction isHTMLElement(node){\r\n\t\ttry {\r\n\t\t\tnode.cloneNode(false);\r\n\t\t}\r\n\t\tcatch (e){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\r\n\t}\r\n\r\n\tvar invalidContainerMessage = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).\" +\r\n\t\"This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\r\n\r\n\tfunction validateNode(node){\r\n\t\tif (!node || (typeof node == 'string' && document.getElementById(node))) return true;\r\n\t\tif (isHTMLElement(node)) return true;\r\n\r\n\t\tgantt.assert(false, invalidContainerMessage);\r\n\t\tthrow new Error(invalidContainerMessage);\r\n\t}\r\n\r\n//initial initialization\r\n\tgantt.init = function(node, from, to){\r\n\t\tif (gantt.env.isNode) { \r\n\t\t\tnode = null; // for the nodejs version\r\n\t\t} else {\r\n\t\t\tvalidateNode(node); // for the web version\r\n\t\t}\r\n\r\n\t\tif(from && to){\r\n\t\t\tthis.config.start_date = this._min_date = new Date(from);\r\n\t\t\tthis.config.end_date = this._max_date = new Date(to);\r\n\t\t}\r\n\t\tthis.date.init();\r\n\r\n\t\t//can be called only once\r\n\t\tthis.init = function(node){\r\n\t\t\tif (gantt.env.isNode) { \r\n\t\t\t\tnode = null; // for the nodejs version\r\n\t\t\t} else {\r\n\t\t\t\tvalidateNode(node); // for the web version\r\n\t\t\t}\r\n\r\n\t\t\tif (this.$container && this.$container.parentNode){\r\n\t\t\t\tthis.$container.parentNode.removeChild(this.$container);\r\n\t\t\t\tthis.$container = null;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.$layout){\r\n\t\t\t\tthis.$layout.clear();\r\n\t\t\t}\r\n\t\t\tthis._reinit(node);\r\n\t\t};\r\n\t\tthis._reinit(node);\r\n\t};\r\n\r\n\tgantt._quickRefresh = function(code){\r\n\t\tvar stores = this._getDatastores.call(this);\r\n\t\tfor(var i = 0; i < stores.length; i++){\r\n\t\t\tstores[i]._quick_refresh = true;\r\n\t\t}\r\n\r\n\t\tcode();\r\n\r\n\t\tfor(var i = 0; i < stores.length; i++){\r\n\t\t\tstores[i]._quick_refresh = false;\r\n\t\t}\r\n\t};\r\n\r\n\tvar dropLayout = (function dropLayout(){\r\n\t\tif(this._clearTaskLayers){\r\n\t\t\tthis._clearTaskLayers();\r\n\t\t}\r\n\r\n\t\tif(this._clearLinkLayers){\r\n\t\t\tthis._clearLinkLayers();\r\n\t\t}\r\n\r\n\t\tif(this.$layout){\r\n\t\t\tthis.$layout.destructor();\r\n\t\t\tthis.$layout = null;\r\n\t\t\tthis.$ui.reset();\r\n\t\t}\r\n\t}).bind(gantt);\r\n\r\n\tvar rebuildLayout = (function rebuildLayout(){\r\n\t\tif(isHeadless(gantt)){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.$root.innerHTML = \"\";\r\n\r\n\t\tthis.$root.gantt = this;\r\n\t\tcalculateScaleRange(this);\r\n\t\tthis.config.layout.id = \"main\";\r\n\t\tthis.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout);\r\n\r\n\t\tthis.$layout.attachEvent(\"onBeforeResize\", function(){\r\n\t\t\tvar storeNames = gantt.$services.getService(\"datastores\");\r\n\t\t\tfor(var i = 0; i < storeNames.length; i++){\r\n\t\t\t\tgantt.getDatastore(storeNames[i]).filter();\r\n\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation){\r\n\t\t\t\t\t// do not repaint items, they will be repainted later in the onStoreUpdate event\r\n\t\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation != \"lightbox\"){\r\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgantt.getDatastore(storeNames[i]).callEvent(\"onBeforeRefreshAll\", []);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.$layout.attachEvent(\"onResize\", function(){\r\n\t\t\tgantt._quickRefresh(function(){\r\n\t\t\t\tgantt.refreshData();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.callEvent(\"onGanttLayoutReady\", []);\r\n\t\tthis.$layout.render();\r\n\r\n\t\tthis.$container = this.$layout.$container.firstChild;\r\n\r\n\t\taddResizeListener(this);\r\n\t}).bind(gantt);\r\n\r\n\tgantt.resetLayout = function(){\r\n\t\tdropLayout();\r\n\t\trebuildLayout();\r\n\t\tthis.render();\r\n\t};\r\n\r\n\tgantt._reinit = function(node){\r\n\t\tthis.callEvent(\"onBeforeGanttReady\", []);\r\n\t\tthis._update_flags();\r\n\r\n\t\tvar config = this.$services.getService(\"templateLoader\");\r\n\t\tconfig.initTemplates(this);\r\n\r\n\t\tdropLayout();\r\n\r\n\t\tthis.$root = null;\r\n\t\tif(node){\r\n\t\t\tthis.$root = domHelpers.toNode(node);\r\n\t\t\trebuildLayout();\r\n\t\t\tthis.$mouseEvents.reset(this.$root);\r\n\t\t\taddMinimalSizes(gantt);\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onTemplatesReady\",[]);\r\n\r\n\t\tthis.callEvent(\"onGanttReady\", []);\r\n\r\n\t\tthis.render();\r\n\t};\r\n\r\n\tfunction addMinimalSizes(gantt) {\r\n\t\tif (gantt.$container && !gantt.config.autosize) {\r\n\t\t\tif (gantt.$root.offsetHeight < 50) {\r\n\t\t\t\t// eslint-disable-next-line no-console\r\n\t\t\t\tconsole.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\r\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tgantt.$click={\r\n\t\tbuttons:{\r\n\t\t\t\"edit\": function(id) {\r\n\t\t\t\tif (gantt.isReadonly(gantt.getTask(id))) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tgantt.showLightbox(id);\r\n\t\t\t},\r\n\t\t\t\"delete\": function(id) {\r\n\t\t\t\tvar task = gantt.getTask(id);\r\n\t\t\t\tif (gantt.isReadonly(task)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar question = gantt.locale.labels.confirm_deleting;\r\n\t\t\t\tvar title = gantt.locale.labels.confirm_deleting_title;\r\n\r\n\t\t\t\tgantt._delete_task_confirm({\r\n\t\t\t\t\ttask: task,\r\n\t\t\t\t\tmessage: question,\r\n\t\t\t\t\ttitle: title,\r\n\t\t\t\t\tcallback: function(){\r\n\t\t\t\t\t\tif(!gantt.isTaskExists(id)){\r\n\t\t\t\t\t\t\tgantt.hideLightbox();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif(task.$new){\r\n\t\t\t\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\r\n\t\t\t\t\t\t\t// as they will be recalculated in the `refreshData`\r\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\r\n\t\t\t\t\t\t\tgantt.silent(function(){\r\n\t\t\t\t\t\t\t\tgantt.deleteTask(id, true);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\r\n\t\t\t\t\t\t\tgantt.refreshData();\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = true;\r\n\t\t\t\t\t\t\tgantt.deleteTask(id);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tgantt.hideLightbox();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n//renders self\r\n\tgantt.render = function(){\r\n\t\tthis.callEvent(\"onBeforeGanttRender\", []);\r\n\r\n\t\tvar visibleDate;\r\n\t\tif(!isHeadless(gantt)){\r\n\t\t\tif (!this.config.sort && this._sort) {\r\n\t\t\t\tthis._sort = undefined;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.$root){\r\n\t\t\t\tif(this.config.rtl){\r\n\t\t\t\t\tthis.$root.classList.add(\"gantt_rtl\");\r\n\t\t\t\t\tthis.$root.firstChild.classList.add(\"gantt_rtl\"); // GS-1499\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$root.classList.remove(\"gantt_rtl\");\r\n\t\t\t\t\tthis.$root.firstChild.classList.remove(\"gantt_rtl\"); // GS-1499\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar pos = this.getScrollState();\r\n\t\t\tvar posX = pos ? pos.x : 0;\r\n\t\t\tif(this._getHorizontalScrollbar()){\r\n\t\t\t\tvar scrollbar = this._getHorizontalScrollbar();\r\n\t\t\t\tposX = scrollbar.$config.codeScrollLeft || posX || 0;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvisibleDate = null;\r\n\t\t\tif(posX){\r\n\t\t\t\tvisibleDate = gantt.dateFromPos(posX + this.config.task_scroll_offset);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcalculateScaleRange(this);\r\n\r\n\t\tif(!isHeadless(gantt)){\r\n\t\t\tthis.$layout.$config.autosize = this.config.autosize;\r\n\t\t\tvar preserveScroll = this.config.preserve_scroll;\r\n\t\t\tthis.config.preserve_scroll = false; // prevent scrolling from layout resize, scroll will be called here later on\r\n\t\t\tthis.$layout.resize();\r\n\t\t\tthis.config.preserve_scroll = preserveScroll;\r\n\r\n\t\t\tif(this.config.preserve_scroll && pos){\r\n\r\n\t\t\t\t// GS-1640: We need pos.y, otherwise part of the timeline won't be rendered if the scrollbar disappeared\r\n\t\t\t\tif (posX || pos.y) {\r\n\t\t\t\t\tvar new_pos = gantt.getScrollState();\r\n\t\t\t\t\tvar new_date = gantt.dateFromPos(new_pos.x);\r\n\t\t\t\t\tif(!(+visibleDate == +new_date && new_pos.y == pos.y)){\r\n\t\t\t\t\t\tvar posX = null;\r\n\t\t\t\t\t\tvar posY = null;\r\n\t\t\t\t\t\tif(visibleDate){\r\n\t\t\t\t\t\t\tvar posX = Math.max(gantt.posFromDate(visibleDate) - gantt.config.task_scroll_offset, 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(pos.y){\r\n\t\t\t\t\t\t\tposY = pos.y;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgantt.scrollTo(posX, posY);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// GS-1640: We need to reset the scroll position for the grid if the scrollbar disappeared and\r\n\t\t\t\t// the grid and timeline have different scrollbars\r\n\t\t\t\t// GS-2718: if we have resources and two verticall scrollbars for tasks timeline and resource timeline\r\n\t\t\t\t// we don't get the scroll state of the resource timeline\r\n\t\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\r\n\t\t\t\tscrollbarsInfo.forEach((scroll_info) => {\r\n\t\t\t\t\tconst scroll = gantt.$ui.getView(scroll_info.id);\r\n\t\t\t\t\tconst scrollbarNodeVisible = gantt.utils.dom.isChildOf(scroll.$view, gantt.$container);\r\n\t\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\r\n\t\t\t\t\t\tconst view = gantt.$ui.getView(viewName);\r\n\t\t\t\t\t\tif(scroll_info.y && scroll_info.y != pos.y){\r\n\t\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\r\n\t\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//GS-2586: take into account the horizontal scroll of the resource timeline\r\n\t\t\t\t\t\tif(scroll_info.x_pos && scroll_info.x_pos != pos.x){\r\n\t\t\t\t\t\t\tif(view && scrollbarNodeVisible){\r\n\t\t\t\t\t\t\t\tview.scrollTo(scroll_info.x_pos, undefined);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}else{\r\n\t\t\tgantt.refreshData();\r\n\t\t}\r\n\t\tthis.callEvent(\"onGanttRender\", []);\r\n\t};\r\n\r\n\t//TODO: add layout.resize method that wouldn't trigger data repaint\r\n\tgantt.setSizes = gantt.render;\r\n\r\n\r\n\tgantt.getTaskRowNode = function(id) {\r\n\t\tvar els = this.$grid_data.childNodes;\r\n\t\tvar attribute = this.config.task_attribute;\r\n\t\tfor (var i = 0; i < els.length; i++) {\r\n\t\t\tif (els[i].getAttribute) {\r\n\t\t\t\tvar value = els[i].getAttribute(attribute);\r\n\t\t\t\tif (value == id) return els[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t};\r\n\r\n\tgantt.changeLightboxType = function(type){\r\n\t\tif(this.getLightboxType() == type)\r\n\t\t\treturn true;\r\n\t\tgantt._silent_redraw_lightbox(type);\r\n\t};\r\n\r\n\tgantt._get_link_type = function (from_start, to_start) {\r\n\t\tvar type = null;\r\n\t\tif (from_start && to_start) {\r\n\t\t\ttype = gantt.config.links.start_to_start;\r\n\t\t} else if (!from_start && to_start) {\r\n\t\t\ttype = gantt.config.links.finish_to_start;\r\n\t\t} else if (!from_start && !to_start) {\r\n\t\t\ttype = gantt.config.links.finish_to_finish;\r\n\t\t} else if (from_start && !to_start) {\r\n\t\t\ttype = gantt.config.links.start_to_finish;\r\n\t\t}\r\n\t\treturn type;\r\n\t};\r\n\r\n\tgantt.isLinkAllowed = function (from, to, from_start, to_start) {\r\n\t\tvar link = null;\r\n\t\tif (typeof(from) == \"object\") {\r\n\t\t\tlink = from;\r\n\t\t} else {\r\n\t\t\tlink = {source: from, target: to, type: this._get_link_type(from_start, to_start)};\r\n\t\t}\r\n\r\n\t\tif (!link) return false;\r\n\t\tif (!(link.source && link.target && link.type)) return false;\r\n\t\tif (link.source == link.target) return false;\r\n\r\n\t\tvar res = true;\r\n\t\t//any custom rules\r\n\t\tif (this.checkEvent(\"onLinkValidation\"))\r\n\t\t\tres = this.callEvent(\"onLinkValidation\", [link]);\r\n\r\n\t\treturn res;\r\n\t};\r\n\r\n\r\n\tgantt._correct_dst_change = function(date, prevOffset, step, unit){\r\n\t\tvar time_unit = helpers.getSecondsInUnit(unit) * step;\r\n\t\tif(time_unit > 60*60 && time_unit < 60*60*24){\r\n\t\t\t//correct dst change only if current unit is more than one hour and less than day (days have own checking), e.g. 12h\r\n\t\t\tvar offsetChanged = date.getTimezoneOffset() - prevOffset;\r\n\t\t\tif(offsetChanged){\r\n\t\t\t\tdate = gantt.date.add(date, offsetChanged, \"minute\");\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn date;\r\n\t};\r\n\r\n\tgantt.isSplitTask = function(task){\r\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSplitTask. Task object was expected\");\r\n\t\treturn this.$data.tasksStore._isSplitItem(task);\r\n\t};\r\n\r\n\tgantt._is_icon_open_click = function(e) {\r\n\t\tif (!e)\r\n\t\t\treturn false;\r\n\t\tvar target = e.target || e.srcElement;\r\n\t\tif (!(target && target.className))\r\n\t\t\treturn false;\r\n\t\tvar className = domHelpers.getClassName(target);\r\n\t\tif (className.indexOf(\"gantt_tree_icon\") !== -1 && (className.indexOf(\"gantt_close\") !== -1 || className.indexOf(\"gantt_open\") !== -1))\r\n\t\t\treturn true;\r\n\t\treturn false;\r\n\t};\r\n\r\n};","/*\r\n \tasserts will be removed in final code, so you can place them anythere\r\n\twithout caring about performance impacts\r\n*/\r\n\r\nexport default function(gantt){\r\n\treturn function assert(check, message){\r\n\t\tif (!check){\r\n\t\t\tif(gantt.config.show_errors && gantt.callEvent(\"onError\",[message]) !== false) {\r\n\t\t\t\tif (gantt.message) {\r\n\t\t\t\t\tgantt.message({type: \"error\", text: message, expire: -1});\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t// eslint-disable-next-line\r\n\t\t\t\t\tconsole.log(message);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// eslint-disable-next-line no-debugger\r\n\t\t\t\tdebugger;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\" \", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \" \", \" \", \" \"],\r\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"  ,   \", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"       \",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", //    , ?\r\n\t\tconfirm_deleting: \"   , ?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"\",\r\n\t\tcolumn_text: \"\",\r\n\t\tcolumn_start_date: \"\",\r\n\t\tcolumn_duration: \"\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"\",\r\n\t\tconfirm_link_deleting: \" \",\r\n\t\tlink_start: \"()\",\r\n\t\tlink_end: \"()\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"ii\",\r\n\t\thours: \"i\",\r\n\t\tdays: \"\",\r\n\t\tweeks: \"\",\r\n\t\tmonths: \"\",\r\n\t\tyears: \"\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\r\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\r\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\r\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nova tasca\",\r\n\t\ticon_save: \"Guardar\",\r\n\t\ticon_cancel: \"Cancellar\",\r\n\t\ticon_details: \"Detalls\",\r\n\t\ticon_edit: \"Editar\",\r\n\t\ticon_delete: \"Esborrar\",\r\n\t\tconfirm_closing: \"\", // \"Els seus canvis es perdrn, continuar ?\"\r\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrar definitivament, continuar ?\",\r\n\t\tsection_description: \"Descripci\",\r\n\t\tsection_time: \"Periode de temps\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Cancellar\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\nTranslation by FreezeSoul\r\n\r\nUpdate 26/10/2015:\r\nTranslation of new labels by zwh8800\r\n https://github.com/DHTMLX/gantt/pull/7\r\n\r\n*/\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"\",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"!\", // Your changes will be lost, are your sure?\r\n\t\tconfirm_deleting: \"?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \"\",\r\n\t\tsection_type: \"\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"\",\r\n\t\tcolumn_text: \"\",\r\n\t\tcolumn_start_date: \"\",\r\n\t\tcolumn_duration: \"\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\r\n\t\tlink: \"\",\r\n\t\tconfirm_link_deleting: \"\",\r\n\t\tlink_start: \" ()\",\r\n\t\tlink_end: \" ()\",\r\n\r\n\t\ttype_task: \"\",\r\n\t\ttype_project: \"\",\r\n\t\ttype_milestone: \"\",\r\n\r\n\t\tminutes: \"\",\r\n\t\thours: \"\",\r\n\t\tdays: \"\",\r\n\t\tweeks: \"\",\r\n\t\tmonths: \"\",\r\n\t\tyears: \"\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\r\n\t\tmonth_short: [\"Led\", \"n\", \"Be\", \"Dub\", \"Kv\", \"er\", \"ec\", \"Srp\", \"Z\", \"j\", \"List\", \"Pro\"],\r\n\t\tday_full: [\"Nedle\", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"],\r\n\t\tday_short: [\"Ne\", \"Po\", \"t\", \"St\", \"t\", \"P\", \"So\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nov prce\",\r\n\t\ticon_save: \"Uloit\",\r\n\t\ticon_cancel: \"Zpt\",\r\n\t\ticon_details: \"Detail\",\r\n\t\ticon_edit: \"Edituj\",\r\n\t\ticon_delete: \"Smazat\",\r\n\t\tconfirm_closing: \"\", // Vae zmny budou ztraceny, opravdu ?\r\n\t\tconfirm_deleting: \"Udlost bude trvale smazna, opravdu?\",\r\n\t\tsection_description: \"Poznmky\",\r\n\t\tsection_time: \"Doba platnosti\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Zpt\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\r\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Ny opgave\",\r\n\t\ticon_save: \"Gem\",\r\n\t\ticon_cancel: \"Fortryd\",\r\n\t\ticon_details: \"Detaljer\",\r\n\t\ticon_edit: \"Tilret\",\r\n\t\ticon_delete: \"Slet\",\r\n\t\tconfirm_closing: \"Dine rettelser vil g tabt.. Er dy sikker?\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\r\n\t\tsection_description: \"Beskrivelse\",\r\n\t\tsection_time: \"Tidsperiode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Fortryd\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\" Januar\", \" Februar\", \" Mrz \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\r\n\t\tday_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\r\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Neue Aufgabe\",\r\n\t\ticon_save: \"Speichern\",\r\n\t\ticon_cancel: \"Abbrechen\",\r\n\t\ticon_details: \"Details\",\r\n\t\ticon_edit: \"ndern\",\r\n\t\ticon_delete: \"Lschen\",\r\n\t\tconfirm_closing: \"\", // \"Ihre Vernderungen werden verloren sein, wollen Sie ergnzen? \"\r\n\t\tconfirm_deleting: \"Der Eintrag wird gelscht\",\r\n\t\tsection_description: \"Beschreibung\",\r\n\t\tsection_time: \"Zeitspanne\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"PSP\",\r\n\t\tcolumn_text: \"Task-Namen\",\r\n\t\tcolumn_start_date: \"Startzeit\",\r\n\t\tcolumn_duration: \"Dauer\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"werden gelscht\",\r\n\t\tlink_start: \"(starten)\",\r\n\t\tlink_end: \"(ende)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minuten\",\r\n\t\thours: \"Stunden\",\r\n\t\tdays: \"Tage\",\r\n\t\tweeks: \"Wochen\",\r\n\t\tmonths: \"Monate\",\r\n\t\tyears: \"Jahre\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Abbrechen\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Regel\",\r\n\t\tconstraint_type: \"Regel\",\r\n\t\tconstraint_date: \"Regel - Datum\",\r\n\t\tasap: \"So bald wie mglich\",\r\n\t\talap: \"So spt wie mglich\",\r\n\t\tsnet: \"Beginn nicht vor\",\r\n\t\tsnlt: \"Beginn nicht spter als\",\r\n\t\tfnet: \"Fertigstellung nicht vor\",\r\n\t\tfnlt: \"Fertigstellung nicht spter als\",\r\n\t\tmso: \"Muss beginnen am\",\r\n\t\tmfo: \"Muss fertig sein am\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"    .   ;\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n\t\tday_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"New task\",\r\n\t\ticon_save: \"Save\",\r\n\t\ticon_cancel: \"Cancel\",\r\n\t\ticon_details: \"Details\",\r\n\t\ticon_edit: \"Edit\",\r\n\t\ticon_delete: \"Delete\",\r\n\t\tconfirm_closing: \"\",// Your changes will be lost, are you sure?\r\n\t\tconfirm_deleting: \"Task will be deleted permanently, are you sure?\",\r\n\t\tsection_description: \"Description\",\r\n\t\tsection_time: \"Time period\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Cancel\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;","/*\r\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\r\n\r\n Update 30/10/2015:\r\n Translation of new labels by Jorge Macias\r\n https://disqus.com/by/disqus_bTuZk1voC7/\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\r\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\r\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jueves\", \"Viernes\", \"Sbado\"],\r\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nueva tarea\",\r\n\t\ticon_save: \"Guardar\",\r\n\t\ticon_cancel: \"Cancelar\",\r\n\t\ticon_details: \"Detalles\",\r\n\t\ticon_edit: \"Editar\",\r\n\t\ticon_delete: \"Eliminar\",\r\n\t\tconfirm_closing: \"\", // \"Sus cambios se perdern, continuar ?\"\r\n\t\tconfirm_deleting: \"El evento se borrar definitivamente, continuar?\",\r\n\t\tsection_description: \"Descripcin\",\r\n\t\tsection_time: \"Perodo\",\r\n\t\tsection_type: \"Tipo\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"EDT\",\r\n\t\tcolumn_text: \"Tarea\",\r\n\t\tcolumn_start_date: \"Inicio\",\r\n\t\tcolumn_duration: \"Duracin\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Enlace\",\r\n\t\tconfirm_link_deleting: \"ser borrada\",\r\n\t\tlink_start: \" (inicio)\",\r\n\t\tlink_end: \" (fin)\",\r\n\r\n\t\ttype_task: \"Tarea\",\r\n\t\ttype_project: \"Proyecto\",\r\n\t\ttype_milestone: \"Hito\",\r\n\r\n\r\n\t\tminutes: \"Minutos\",\r\n\t\thours: \"Horas\",\r\n\t\tdays: \"Das\",\r\n\t\tweeks: \"Semanas\",\r\n\t\tmonths: \"Meses\",\r\n\t\tyears: \"Aos\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Cancelar\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n dhtmlxGantt Persian (Farsi, fa_IR) locale by Mohammad Shokri http://slashsbin.com/\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\"\r\n\t\t],\r\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tday_full: [\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\"\r\n\t\t],\r\n\t\tday_short: [\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\",\r\n\t\t\t\"\"\r\n\t\t]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"       \",\r\n\t\tconfirm_deleting: \"         \",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"\",\r\n\t\tcolumn_start_date: \" \",\r\n\t\tcolumn_duration: \"\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"\",\r\n\t\tconfirm_link_deleting: \"  \",\r\n\t\tlink_start: \" ()\",\r\n\t\tlink_end: \" ()\",\r\n\r\n\t\ttype_task: \"\",\r\n\t\ttype_project: \"\",\r\n\t\ttype_milestone: \"\",\r\n\r\n\t\tminutes: \"\",\r\n\t\thours: \"\",\r\n\t\tdays: \"\",\r\n\t\tweeks: \"\",\r\n\t\tmonths: \"\",\r\n\t\tyears: \"\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\r\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\r\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\r\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Uusi tehtv\",\r\n\t\ticon_save: \"Tallenna\",\r\n\t\ticon_cancel: \"Peru\",\r\n\t\ticon_details: \"Tiedot\",\r\n\t\ticon_edit: \"Muokkaa\",\r\n\t\ticon_delete: \"Poista\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\r\n\t\tsection_description: \"Kuvaus\",\r\n\t\tsection_time: \"Aikajakso\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Peru\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\r\n\t\tmonth_short: [\"Jan\", \"Fv\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Ao\", \"Sep\", \"Oct\", \"Nov\", \"Dc\"],\r\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\r\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nouvelle tche\",\r\n\t\ticon_save: \"Enregistrer\",\r\n\t\ticon_cancel: \"Annuler\",\r\n\t\ticon_details: \"Dtails\",\r\n\t\ticon_edit: \"Modifier\",\r\n\t\ticon_delete: \"Effacer\",\r\n\t\tconfirm_closing: \"\",// Vos modifications seront perdus, tes-vous sr ?\r\n\t\tconfirm_deleting: \"L'vnement sera effac sans appel, tes-vous sr ?\",\r\n\r\n\t\tsection_description: \"Description\",\r\n\t\tsection_time: \"Priode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"OTP\",\r\n\t\tcolumn_text: \"Nom de la tche\",\r\n\t\tcolumn_start_date: \"Date initiale\",\r\n\t\tcolumn_duration: \"Dure\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Le lien\",\r\n\t\tconfirm_link_deleting: \"sera supprim\",\r\n\t\tlink_start: \"(dbut)\",\r\n\t\tlink_end: \"(fin)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Heures\",\r\n\t\tdays: \"Jours\",\r\n\t\tweeks: \"Semaines\",\r\n\t\tmonths: \"Mois\",\r\n\t\tyears: \"Annes\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Annuler\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"  .?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \"\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n  Translation by Davor\r\n http://docs.dhtmlx.com/gantt/desktop__localization.html#comment-2569116291\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Sijeanj\", \"Veljaa\", \"Oujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\r\n\t\tmonth_short: [\"Sij\", \"Velj\", \"Ou\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\r\n\t\tday_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"etvrtak\", \"Petak\", \"Subota\"],\r\n\t\tday_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"et\", \"Pet\", \"Sub\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Novi Zadatak\",\r\n\t\ticon_save: \"Spremi\",\r\n\t\ticon_cancel: \"Odustani\",\r\n\t\ticon_details: \"Detalji\",\r\n\t\ticon_edit: \"Izmjeni\",\r\n\t\ticon_delete: \"Obrii\",\r\n\t\tconfirm_closing: \"\",\r\n\t\tconfirm_deleting: \"Zadatak e biti trajno izbrisan, jeste li sigurni?\",\r\n\t\tsection_description: \"Opis\",\r\n\t\tsection_time: \"Vremenski Period\",\r\n\t\tsection_type: \"Tip\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Naziv Zadatka\",\r\n\t\tcolumn_start_date: \"Poetno Vrijeme\",\r\n\t\tcolumn_duration: \"Trajanje\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Poveznica\",\r\n\t\tconfirm_link_deleting: \"e biti izbrisan\",\r\n\t\tlink_start: \" (poetak)\",\r\n\t\tlink_end: \" (kraj)\",\r\n\r\n\t\ttype_task: \"Zadatak\",\r\n\t\ttype_project: \"Projekt\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\t\tminutes: \"Minute\",\r\n\t\thours: \"Sati\",\r\n\t\tdays: \"Dani\",\r\n\t\tweeks: \"Tjedni\",\r\n\t\tmonths: \"Mjeseci\",\r\n\t\tyears: \"Godine\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Odustani\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"pr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"szombat\"],\r\n\t\tday_short: [\"Va\", \"H\", \"Ke\", \"Sze\", \"Cs\", \"P\", \"Szo\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"j feladat\",\r\n\t\ticon_save: \"Ments\",\r\n\t\ticon_cancel: \"Mgse\",\r\n\t\ticon_details: \"Rszletek\",\r\n\t\ticon_edit: \"Szerkeszts\",\r\n\t\ticon_delete: \"Trls\",\r\n\t\tconfirm_closing: \"\", // A vltozsok elvesznek, biztosan folytatja? \"\r\n\t\tconfirm_deleting: \"Az esemny trlve lesz, biztosan folytatja?\",\r\n\t\tsection_description: \"Lers\",\r\n\t\tsection_time: \"Idszak\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Mgse\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\r\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\r\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Tugas baru\",\r\n\t\ticon_save: \"Simpan\",\r\n\t\ticon_cancel: \"Batal\",\r\n\t\ticon_details: \"Detail\",\r\n\t\ticon_edit: \"Edit\",\r\n\t\ticon_delete: \"Hapus\",\r\n\t\tconfirm_closing: \"\", /* Perubahan tidak akan disimpan ? */\r\n\t\tconfirm_deleting: \"Acara akan dihapus\",\r\n\t\tsection_description: \"Keterangan\",\r\n\t\tsection_time: \"Periode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Batal\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n Update 29/12/2015:\r\n New labels translation by ARCANGELI CLAUDIO\r\n\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\r\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\r\n\t\tday_full: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Gioved\", \"Venerd\", \"Sabato\"],\r\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nuovo compito\",\r\n\t\ticon_save: \"Salva\",\r\n\t\ticon_cancel: \"Chiudi\",\r\n\t\ticon_details: \"Dettagli\",\r\n\t\ticon_edit: \"Modifica\",\r\n\t\ticon_delete: \"Elimina\",\r\n\t\tconfirm_closing: \"\",// \"Sei sicuro di confermare la chiusura?\",\r\n\t\tconfirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\r\n\t\tsection_description: \"Descrizione\",\r\n\t\tsection_time: \"Periodo di tempo\",\r\n\t\tsection_type: \"Tipo\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Nome Attivit\",\r\n\t\tcolumn_start_date: \"Inizio\",\r\n\t\tcolumn_duration: \"Durata\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"sar eliminato\",\r\n\t\tlink_start: \" (inizio)\",\r\n\t\tlink_end: \" (fine)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minuti\",\r\n\t\thours: \"Ore\",\r\n\t\tdays: \"Giorni\",\r\n\t\tweeks: \"Settimane\",\r\n\t\tmonths: \"Mesi\",\r\n\t\tyears: \"Anni\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Chiudi\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n Translation by Genexus Japan Inc.\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"\",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", // \r\n\t\tconfirm_deleting: \"\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \"\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n\tTranslated by cjkim@dbvalley.com\r\n*/\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \" \",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\",\r\n\t\tconfirm_deleting: \" ?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \"\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"\",\r\n\t\tcolumn_start_date: \"\",\r\n\t\tcolumn_duration: \"\",\r\n\t\tcolumn_add: \"\",\r\n\t\tlink: \"\",\r\n\t\tconfirm_link_deleting: \" ?\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\t\ttype_task: \"\",\r\n\t\ttype_project: \"\",\r\n\t\ttype_milestone: \"\",\r\n\t\tminutes: \"\",\r\n\t\thours: \"\",\r\n\t\tdays: \"\",\r\n\t\tweeks: \"\",\r\n\t\tmonths: \"\",\r\n\t\tyears: \"\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","export default class LocaleManager{\r\n\tprivate _locales:{[key:string]: IGanttLocale };\r\n\r\n\tconstructor(config: {[key:string]: IGanttLocale }){\r\n\t\tthis._locales = {};\r\n\t\tfor(const i in config){\r\n\t\t\tthis._locales[i] = config[i];\r\n\t\t}\r\n\t}\r\n\r\n\taddLocale = (name: string, locale: IGanttLocale) => {\r\n\t\tthis._locales[name] = locale;\r\n\t};\r\n\r\n\tgetLocale = (name: string): IGanttLocale => {\r\n\t\treturn this._locales[name];\r\n\t};\r\n}","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\r\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\r\n\t\tday_short: [\"Sn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Ny oppgave\",\r\n\t\ticon_save: \"Lagre\",\r\n\t\ticon_cancel: \"Avbryt\",\r\n\t\ticon_details: \"Detaljer\",\r\n\t\ticon_edit: \"Rediger\",\r\n\t\ticon_delete: \"Slett\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\r\n\t\tsection_description: \"Beskrivelse\",\r\n\t\tsection_time: \"Tidsperiode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Avbryt\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\r\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nieuwe taak\",\r\n\t\ticon_save: \"Opslaan\",\r\n\t\ticon_cancel: \"Annuleren\",\r\n\t\ticon_details: \"Details\",\r\n\t\ticon_edit: \"Bewerken\",\r\n\t\ticon_delete: \"Verwijderen\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\r\n\t\tsection_description: \"Beschrijving\",\r\n\t\tsection_time: \"Tijd periode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Taak omschrijving\",\r\n\t\tcolumn_start_date: \"Startdatum\",\r\n\t\tcolumn_duration: \"Duur\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Koppeling\",\r\n\t\tconfirm_link_deleting: \"zal worden verwijderd\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (eind)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"minuten\",\r\n\t\thours: \"uren\",\r\n\t\tdays: \"dagen\",\r\n\t\tweeks: \"weken\",\r\n\t\tmonths: \"maanden\",\r\n\t\tyears: \"jaren\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Annuleren\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\r\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\r\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Ny oppgave\",\r\n\t\ticon_save: \"Lagre\",\r\n\t\ticon_cancel: \"Avbryt\",\r\n\t\ticon_details: \"Detaljer\",\r\n\t\ticon_edit: \"Endre\",\r\n\t\ticon_delete: \"Slett\",\r\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", // Endringer blir ikke lagret, er du sikker?\r\n\t\tconfirm_deleting: \"Oppfringen vil bli slettet, er du sikker?\",\r\n\t\tsection_description: \"Beskrivelse\",\r\n\t\tsection_time: \"Tidsperiode\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Avbryt\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Stycze\", \"Luty\", \"Marzec\", \"Kwiecie\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpie\", \"Wrzesie\", \"Padziernik\", \"Listopad\", \"Grudzie\"],\r\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Pa\", \"Lis\", \"Gru\"],\r\n\t\tday_full: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"],\r\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"ro\", \"Czw\", \"Pi\", \"Sob\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nowe zadanie\",\r\n\t\ticon_save: \"Zapisz\",\r\n\t\ticon_cancel: \"Anuluj\",\r\n\t\ticon_details: \"Szczegy\",\r\n\t\ticon_edit: \"Edytuj\",\r\n\t\ticon_delete: \"Usu\",\r\n\t\tconfirm_closing: \"\", // Zmiany zostan usunite, jeste pewien?\r\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunite na zawsze, kontynuowa?\",\r\n\t\tsection_description: \"Opis\",\r\n\t\tsection_time: \"Okres czasu\",\r\n\t\tsection_type: \"Typ\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Nazwa zadania\",\r\n\t\tcolumn_start_date: \"Pocztek\",\r\n\t\tcolumn_duration: \"Czas trwania\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"zostanie usunity\",\r\n\t\tlink_start: \" (pocztek)\",\r\n\t\tlink_end: \" (koniec)\",\r\n\r\n\t\ttype_task: \"Zadanie\",\r\n\t\ttype_project: \"Projekt\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minuty\",\r\n\t\thours: \"Godziny\",\r\n\t\tdays: \"Dni\",\r\n\t\tweeks: \"Tydzie\",\r\n\t\tmonths: \"Miesice\",\r\n\t\tyears: \"Lata\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Anuluj\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n\r\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONALVES\r\n\r\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\r\n\r\n www.atrixian.com.br\r\n\r\n\r\n Updated by Jorge Albernaz Martins\r\n\r\n jorgefox@hotmail.com\r\n\r\n www.redfox.inf.br\r\n\r\n JorgeFox\r\n\r\n*/\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\r\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\r\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"],\r\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nova tarefa\",\r\n\t\ticon_save: \"Salvar\",\r\n\t\ticon_cancel: \"Cancelar\",\r\n\t\ticon_details: \"Detalhes\",\r\n\t\ticon_edit: \"Editar\",\r\n\t\ticon_delete: \"Excluir\",\r\n\t\tconfirm_closing: \"\",// Suas alteraes sero perdidas, confirme?\r\n\t\tconfirm_deleting: \"As tarefas sero excluidas permanentemente, confirme?\",\r\n\t\tsection_description: \"Descrio\",\r\n\t\tsection_time: \"Perodo\",\r\n\t\tsection_type: \"Tipo\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"EAP\",\r\n\t\tcolumn_text: \"Nome tarefa\",\r\n\t\tcolumn_start_date: \"Data incio\",\r\n\t\tcolumn_duration: \"Durao\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"Ser excludo!\",\r\n\t\tlink_start: \" (incio)\",\r\n\t\tlink_end: \" (fim)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Projeto\",\r\n\t\ttype_milestone: \"Marco\",\r\n\r\n\r\n\t\tminutes: \"Minutos\",\r\n\t\thours: \"Horas\",\r\n\t\tdays: \"Dias\",\r\n\t\tweeks: \"Semanas\",\r\n\t\tmonths: \"Meses\",\r\n\t\tyears: \"Anos\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Cancelar\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Restrio\",\r\n\t\tconstraint_type: \"Tipo Restrio\",\r\n\t\tconstraint_date: \"Data restrio\",\r\n\t\tasap: \"Mais breve possvel\",\r\n\t\talap: \"Mais tarde possvel\",\r\n\t\tsnet: \"No comear antes de\",\r\n\t\tsnlt: \"No comear depois de\",\r\n\t\tfnet: \"No terminar antes de\",\r\n\t\tfnlt: \"No terminar depois de\",\r\n\t\tmso: \"Precisa comear em\",\r\n\t\tmfo: \"Precisa terminar em\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"Tipo de filtros\",\r\n\t\tresources_filter_label: \"Ocultar vazios\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\r\n */\r\n\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\r\n\t\tday_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Sarcina noua\",\r\n\t\ticon_save: \"Salveaza\",\r\n\t\ticon_cancel: \"Anuleaza\",\r\n\t\ticon_details: \"Detalii\",\r\n\t\ticon_edit: \"Editeaza\",\r\n\t\ticon_delete: \"Sterge\",\r\n\t\tconfirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",// Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\r\n\t\tsection_description: \"Descriere\",\r\n\t\tsection_time: \"Interval\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Anuleaza\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"O\", \"\", \"\"],\r\n\t\tmonth_short: [\"\", \"\", \"Ma\", \"A\", \"Ma\", \"\", \"\", \"A\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", //    , ?\r\n\t\tconfirm_deleting: \"   , ?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"\",\r\n\t\tcolumn_text: \"\",\r\n\t\tcolumn_start_date: \"\",\r\n\t\tcolumn_duration: \"\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"\",\r\n\t\tconfirm_link_deleting: \" \",\r\n\t\tlink_start: \" ()\",\r\n\t\tlink_end: \" ()\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"\",\r\n\t\thours: \"\",\r\n\t\tdays: \"\",\r\n\t\tweeks: \"\",\r\n\t\tmonths: \"\",\r\n\t\tyears: \"\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"    \",\r\n\t\tresources_filter_label: \"  \",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"],\r\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"et\", \"Pet\", \"Sob\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nova naloga\",\r\n\t\ticon_save: \"Shrani\",\r\n\t\ticon_cancel: \"Preklii\",\r\n\t\ticon_details: \"Podrobnosti\",\r\n\t\ticon_edit: \"Uredi\",\r\n\t\ticon_delete: \"Izbrii\",\r\n\t\tconfirm_closing: \"\", // Spremembe ne bodo shranjene. elite nadaljevati ?\r\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. elite nadaljevati?\",\r\n\t\tsection_description: \"Opis\",\r\n\t\tsection_time: \"asovni okvir\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Preklii\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"],\r\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"t\", \"Pi\", \"So\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Nov loha\",\r\n\t\ticon_save: \"Uloi\",\r\n\t\ticon_cancel: \"Sp\",\r\n\t\ticon_details: \"Detail\",\r\n\t\ticon_edit: \"Edituj\",\r\n\t\ticon_delete: \"Zmaza\",\r\n\t\tconfirm_closing: \"Vae zmeny nebud uloen. Skutone?\", // Vae zmny budou ztraceny, opravdu ?\r\n\t\tconfirm_deleting: \"Udalos bude natrvalo vymazan. Skutone?\",\r\n\t\tsection_description: \"Poznmky\",\r\n\t\tsection_time: \"Doba platnosti\",\r\n\t\tsection_type: \"Type\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Sp\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n\tTranslation by Peter Eriksson\r\n */\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\r\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\r\n\t\tday_full: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\r\n\t\tday_short: [\"Sn\", \"Mn\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Ny uppgift\",\r\n\t\ticon_save: \"Spara\",\r\n\t\ticon_cancel: \"Avbryt\",\r\n\t\ticon_details: \"Detajer\",\r\n\t\ticon_edit: \"ndra\",\r\n\t\ticon_delete: \"Ta bort\",\r\n\t\tconfirm_closing: \"\",\r\n\t\tconfirm_deleting: \"r du sker p att du vill ta bort hndelsen permanent?\",\r\n\t\tsection_description: \"Beskrivning\",\r\n\t\tsection_time: \"Tid\",\r\n\t\tsection_type: \"Typ\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Uppgiftsnamn\",\r\n\t\tcolumn_start_date: \"Starttid\",\r\n\t\tcolumn_duration: \"Varaktighet\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\r\n\t\tlink: \"Lnk\",\r\n\t\tconfirm_link_deleting: \"kommer tas bort\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (slut)\",\r\n\t\ttype_task: \"Uppgift\",\r\n\t\ttype_project: \"Projekt\",\r\n\t\ttype_milestone: \"Milstolpe\",\r\n\r\n\t\tminutes: \"Minuter\",\r\n\t\thours: \"Timmar\",\r\n\t\tdays: \"Dagar\",\r\n\t\tweeks: \"Veckor\",\r\n\t\tmonths: \"Mnader\",\r\n\t\tyears: \"r\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"Avbryt\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","/*\r\n * updated by @levkar at https://github.com/DHTMLX/gantt/pull/10\r\n */\r\nconst locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\r\n\t\tmonth_short: [\"Oca\", \"ub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Au\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\r\n\t\tday_full: [\"Pazar\", \"Pazartesi\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"],\r\n\t\tday_short: [\"Paz\", \"Pzt\", \"Sal\", \"ar\", \"Per\", \"Cum\", \"Cmt\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \"Yeni grev\",\r\n\t\ticon_save: \"Kaydet\",\r\n\t\ticon_cancel: \"ptal\",\r\n\t\ticon_details: \"Detaylar\",\r\n\t\ticon_edit: \"Dzenle\",\r\n\t\ticon_delete: \"Sil\",\r\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\r\n\t\tconfirm_deleting: \"Grev silinecek, emin misiniz?\",\r\n\t\tsection_description: \"Aklama\",\r\n\t\tsection_time: \"Zaman Aral\",\r\n\t\tsection_type: \"Tip\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Grev Ad\",\r\n\t\tcolumn_start_date: \"Balang\",\r\n\t\tcolumn_duration: \"Sre\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Balant\",\r\n\t\tconfirm_link_deleting: \"silinecek\",\r\n\t\tlink_start: \" (balang)\",\r\n\t\tlink_end: \" (biti)\",\r\n\r\n\t\ttype_task: \"Grev\",\r\n\t\ttype_project: \"Proje\",\r\n\t\ttype_milestone: \"Kilometreta\",\r\n\r\n\r\n\t\tminutes: \"Dakika\",\r\n\t\thours: \"Saat\",\r\n\t\tdays: \"Gn\",\r\n\t\tweeks: \"Hafta\",\r\n\t\tmonths: \"Ay\",\r\n\t\tyears: \"Yl\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"ptal\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","const locale: IGanttLocale = {\r\n\tdate: {\r\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\r\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"],\r\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\r\n\t},\r\n\tlabels: {\r\n\t\tnew_task: \" \",\r\n\t\ticon_save: \"\",\r\n\t\ticon_cancel: \"\",\r\n\t\ticon_details: \"\",\r\n\t\ticon_edit: \"\",\r\n\t\ticon_delete: \"\",\r\n\t\tconfirm_closing: \"\", //   .   ?\r\n\t\tconfirm_deleting: \"  .  ?\",\r\n\t\tsection_description: \"\",\r\n\t\tsection_time: \" \",\r\n\t\tsection_type: \"\",\r\n\t\tsection_deadline: \"Deadline\",\r\n\t\tsection_baselines: \"Baselines\",\r\n\t\t/* grid columns */\r\n\r\n\t\tcolumn_wbs: \"WBS\",\r\n\t\tcolumn_text: \"Task name\",\r\n\t\tcolumn_start_date: \"Start time\",\r\n\t\tcolumn_duration: \"Duration\",\r\n\t\tcolumn_add: \"\",\r\n\r\n\t\t/* link confirmation */\r\n\t\tlink: \"Link\",\r\n\t\tconfirm_link_deleting: \"will be deleted\",\r\n\t\tlink_start: \" (start)\",\r\n\t\tlink_end: \" (end)\",\r\n\r\n\t\ttype_task: \"Task\",\r\n\t\ttype_project: \"Project\",\r\n\t\ttype_milestone: \"Milestone\",\r\n\r\n\r\n\t\tminutes: \"Minutes\",\r\n\t\thours: \"Hours\",\r\n\t\tdays: \"Days\",\r\n\t\tweeks: \"Week\",\r\n\t\tmonths: \"Months\",\r\n\t\tyears: \"Years\",\r\n\r\n\t\t/* message popup */\r\n\t\tmessage_ok: \"OK\",\r\n\t\tmessage_cancel: \"\",\r\n\r\n\t\t/* constraints */\r\n\t\tsection_constraint: \"Constraint\",\r\n\t\tconstraint_type: \"Constraint type\",\r\n\t\tconstraint_date: \"Constraint date\",\r\n\t\tasap: \"As Soon As Possible\",\r\n\t\talap: \"As Late As Possible\",\r\n\t\tsnet: \"Start No Earlier Than\",\r\n\t\tsnlt: \"Start No Later Than\",\r\n\t\tfnet: \"Finish No Earlier Than\",\r\n\t\tfnlt: \"Finish No Later Than\",\r\n\t\tmso: \"Must Start On\",\r\n\t\tmfo: \"Must Finish On\",\r\n\r\n\t\t/* resource control */\r\n\t\tresources_filter_placeholder: \"type to filter\",\r\n\t\tresources_filter_label: \"hide empty\",\r\n\r\n\t\t/* empty state screen */\r\n\t\tempty_state_text_link: \"Click here\",\r\n\t\tempty_state_text_description: \"to create your first task\",\r\n\r\n\t\t/* baselines control */\r\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\r\n\t\tbaselines_add_button: \"Add Baseline\",\r\n\t\tbaselines_remove_button: \"Remove\",\r\n\t\tbaselines_remove_all_button: \"Remove All\",\r\n\r\n\t\t/* deadline control */\r\n\t\tdeadline_enable_button: \"Set\",\r\n\t\tdeadline_disable_button: \"Remove\"\r\n\t}\r\n};\r\n\r\nexport default locale;\r\n","import * as utils from \"../utils/utils\";\r\nimport constants from \"../constants\";\r\nimport ExtensionManager from \"../ext/extension_manager\";\r\n\r\nimport services from \"../core/common/services\";\r\nimport config from \"../core/common/config\";\r\nimport ajax from \"../core/common/ajax\";\r\nimport date from \"../core/common/date\";\r\nimport {remoteEvents} from \"../core/remote/remote_events\";\r\n\r\nimport DnD from \"../core/common/dnd\";\r\nimport templates from \"../core/common/templates\";\r\nimport eventable from \"../utils/eventable\";\r\n\r\nimport StateService from \"../core/common/state\";\r\n\r\nimport Promise from \"../utils/promise\";\r\nimport env from \"../utils/env\";\r\nimport datastoreHooks from \"../core/datastore/datastore_hooks\";\r\nimport DataProcessor from \"../core/dataprocessor\";\r\n\r\nimport plugins from \"../core/plugins\";\r\n\r\nimport grid_column_api from \"../core/grid_column_api\";\r\nimport tasks from \"../core/tasks\";\r\nimport parsing from \"../core/loading/parsing\";\r\nimport work_time from \"../core/worktime/work_time\";\r\nimport data from \"../core/data\";\r\n\r\nimport void_script_second from \"../publish_helpers/void_script_second\";\r\n\r\nimport data_task_types from \"../core/data_task_types\";\r\nimport cached_functions from \"../core/cached_functions\";\r\n\r\nimport gantt_core from \"../core/gantt_core\";\r\nimport destructor from \"../core/destructor\";\r\nimport void_script_third from \"../publish_helpers/void_script_third\";\r\n\r\nimport i18nFactory from \"../locale\";\r\n\r\nfunction DHXGantt(){\r\n\tthis.constants = constants;\r\n\tthis.version = VERSION;\r\n\tthis.license = LICENSE;\r\n\tthis.templates = {};\r\n\tthis.ext = {};\r\n\tthis.keys = {\r\n\t\tedit_save: this.constants.KEY_CODES.ENTER,\r\n\t\tedit_cancel: this.constants.KEY_CODES.ESC\r\n\t};\r\n}\r\n\r\nexport default function(supportedExtensions) {\r\n\t// use a named constructor to make gantt instance discoverable in heap snapshots\r\n\tvar gantt = new DHXGantt();\r\n\r\n\tvar extensionManager = new ExtensionManager(supportedExtensions);\r\n\tvar activePlugins = {};\r\n\tgantt.plugins = function(config){\r\n\t\tfor(var i in config){\r\n\t\t\tif(config[i] && !activePlugins[i]){\r\n\t\t\t\tvar plugin = extensionManager.getExtension(i);\r\n\t\t\t\tif(plugin){\r\n\t\t\t\t\tplugin(gantt);\r\n\t\t\t\t\tactivePlugins[i] = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn activePlugins;\r\n\t};\r\n\r\n\tgantt.$services = services();\r\n\tgantt.config = config();\r\n\tgantt.ajax =  ajax(gantt);\r\n\tgantt.date = date(gantt);\r\n\tgantt.RemoteEvents = remoteEvents;\r\n\r\n\tvar dnd = DnD(gantt);\r\n\tgantt.$services.setService(\"dnd\", function(){return dnd;});\r\n\r\n\tvar templatesLoader = templates(gantt);\r\n\tgantt.$services.setService(\"templateLoader\", function () {\r\n\t\treturn templatesLoader;\r\n\t});\r\n\r\n\teventable(gantt);\r\n\r\n\t\r\n\tvar stateService = new StateService();\r\n\r\n\tstateService.registerProvider(\"global\", function () {\r\n\t\tvar res = {\r\n\t\t\tmin_date: gantt._min_date,\r\n\t\t\tmax_date: gantt._max_date,\r\n\t\t\tselected_task: null\r\n\t\t};\r\n\r\n\t\t// do not throw error if getState called from non-initialized gantt\r\n\t\tif(gantt.$data && gantt.$data.tasksStore){\r\n\t\t\tres.selected_task = gantt.$data.tasksStore.getSelectedId();\r\n\t\t}\r\n\t\treturn res;\r\n\t});\r\n\tgantt.getState = stateService.getState;\r\n\tgantt.$services.setService(\"state\", function () {\r\n\t\treturn stateService;\r\n\t});\r\n\r\n\tutils.mixin(gantt, utils);\r\n\r\n\tgantt.Promise = Promise;\r\n\tgantt.env = env;\r\n\r\n\tdatastoreHooks(gantt);\r\n\r\n\tgantt.dataProcessor = DataProcessor.DEPRECATED_api;\r\n\tgantt.createDataProcessor = DataProcessor.createDataProcessor;\r\n\r\n\tplugins(gantt);\r\n\r\n\tgrid_column_api(gantt);\r\n\ttasks(gantt);\r\n\tparsing(gantt);\r\n\twork_time(gantt);\r\n\tdata(gantt);\r\n\r\n\tvoid_script_second(gantt);\r\n\r\n\tdata_task_types(gantt);\r\n\tcached_functions(gantt);\r\n\r\n\tgantt_core(gantt);\r\n\tdestructor(gantt);\r\n\tvoid_script_third(gantt);\r\n\r\n\tvar i18n = i18nFactory();\r\n\tgantt.i18n = {\r\n\t\taddLocale: i18n.addLocale,\r\n\t\tsetLocale: function(locale){\r\n\t\t\tif(typeof locale === \"string\"){\r\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\r\n\t\t\t\tif(!localeObject){\r\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgantt.locale = localeObject;\r\n\t\t\t}else if(locale){\r\n\t\t\t\tif(!gantt.locale){\r\n\t\t\t\t\tgantt.locale = locale;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tfor(var i in locale){\r\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\r\n\t\t\t\t\t\t\tif(!gantt.locale[i]){\r\n\t\t\t\t\t\t\t\tgantt.locale[i] = {};\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tgantt.mixin(gantt.locale[i], locale[i], true);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tgantt.locale[i] = locale[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst labels = gantt.locale.labels;\r\n\t\t\tlabels.gantt_save_btn = labels.gantt_save_btn || labels.icon_save;\r\n\t\t\tlabels.gantt_cancel_btn = labels.gantt_cancel_btn || labels.icon_cancel;\r\n\t\t\tlabels.gantt_delete_btn = labels.gantt_delete_btn || labels.icon_delete;\r\n\t\t},\r\n\t\tgetLocale: i18n.getLocale\r\n\t};\r\n\tgantt.i18n.setLocale(\"en\");\r\n\treturn gantt;\r\n};","export default function(){\r\n\tvar services = {};\r\n\tfunction register (name, getter){\r\n\t\tservices[name] = getter;\r\n\t}\r\n\r\n\tfunction getService(name){\r\n\t\tif(!services[name]){\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn services[name]();\r\n\t}\r\n\r\n\tfunction dropService(name) {\r\n\t\tif (services[name]) {\r\n\t\t\tdelete services[name];\r\n\t\t}\r\n\t}\r\n\r\n\tvar servicesEnum = {};\r\n\r\n\treturn {\r\n\t\tservices: servicesEnum,\r\n\t\tsetService: register,\r\n\t\tgetService: getService,\r\n\t\tdropService: dropService,\r\n\t\tdestructor: function(){\r\n\t\t\tfor(var i in services){\r\n\t\t\t\tif(services[i]){\r\n\t\t\t\t\tvar service = services[i];\r\n\t\t\t\t\tif(service && service.destructor){\r\n\t\t\t\t\t\tservice.destructor();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tservices = null;\r\n\t\t}\r\n\t};\r\n};\r\n","type DurationUnits = \"minute\" | \"hour\" | \"day\" | \"week\" | \"month\" | \"year\";\r\ntype Align = \"left\" | \"center\" | \"right\";\r\ntype SectionType = \"textarea\"\r\n\t\t\t\t\t| \"time\"\r\n\t\t\t\t\t| \"duration\"\r\n\t\t\t\t\t| \"select\"\r\n\t\t\t\t\t| \"typeselect\"\r\n\t\t\t\t\t| \"parent\"\r\n\t\t\t\t\t| \"template\"\r\n\t\t\t\t\t| \"checkbox\"\r\n\t\t\t\t\t| \"radio\"\r\n\t\t\t\t\t| \"resources\"\r\n\t\t\t\t\t| \"constraint\";\r\n\r\ntype LightboxSection = Array<ILightboxSection\r\n\t| ILightboxTimeAndDurationSection\r\n\t| ILightboxInputControl\r\n\t| ILightboxSelectControl\r\n\t| ILightboxParentControl\r\n\t| ILightboxTypeselectControl>;\r\n\r\ntype LayoutView = \"grid\"\r\n\t| \"timeline\"\r\n\t| \"resizer\"\r\n\t| \"scrollbar\"\r\n\t| \"resourceGrid\"\r\n\t| \"resourceTimeline\";\r\n\r\ninterface IColumnItem {\r\n\tname: string;\r\n\tlabel?: string;\r\n\ttree?: boolean;\r\n\talign?: Align;\r\n\thide?: boolean;\r\n\tmax_width?: number;\r\n\tmin_width?: number;\r\n\tresize?: boolean;\r\n\ttemplate?: (obj: any) => string;\r\n\twidth?: number | \"*\";\r\n}\r\n\r\nexport type TModifierKeys = \"metaKey\" | \"ctrlKey\" | \"altKey\" | \"shiftKey\" | false | undefined;\r\n\r\nexport interface IScale {\r\n\tcss?: () => string;\r\n\tdate?: string;\r\n\tstep: number;\r\n\ttemplate?: (date: Date) => string;\r\n\tunit: DurationUnits;\r\n}\r\n\r\ninterface ILightboxSection {\r\n\tname: string;\r\n\tmap_to: string;\r\n\ttype: SectionType;\r\n\theight?: number;\r\n\tfocus?: boolean;\r\n}\r\n\r\ninterface ILightboxTimeAndDurationSection extends ILightboxSection {\r\n\treadonly: boolean;\r\n\tyear_range: number[] | number;\r\n\tsingle_date: boolean;\r\n\ttime_format: string;\r\n}\r\n\r\ninterface ILightboxInputControl extends ILightboxSection {\r\n\tdefault_value?: any;\r\n\toptions?: Array<{key: string, label: string}>;\r\n}\r\n\r\ninterface ILightboxSelectControl extends ILightboxInputControl {\r\n\tonchange: () => boolean | undefined;\r\n}\r\n\r\ninterface ILightboxParentControl extends ILightboxSection {\r\n\tallow_root: boolean;\r\n\troot_label: string;\r\n\tsort?: (a: any, b: any) => -1 | 0 | 1;\r\n\tfilter?: (task: string | number | object) => boolean;\r\n\ttemplate?: (start: Date, end: Date, ev: object) => string;\r\n}\r\n\r\ninterface ILightboxTypeselectControl extends ILightboxSection {\r\n\tfilter?: (typeName: string) => boolean;\r\n}\r\n\r\n\r\ninterface ILayoutScrollbar {\r\n\tview: \"scrollbar\";\r\n\tscroll?: \"x\" | \"y\";\r\n\tid: string;\r\n\theight?: number;\r\n\twidth?: number;\r\n}\r\n\r\ninterface ILayoutView {\r\n\tview: LayoutView;\r\n\tid?: string;\r\n\tscrollX?: string;\r\n\tscrollY?: string;\r\n\tconfig?: object;\r\n}\r\n\r\ninterface ILayoutGrid extends ILayoutView {\r\n\tview: \"grid\";\r\n\tbind?: string;\r\n}\r\n\r\ninterface ILayoutTimeline extends ILayoutView {\r\n\tview: \"timeline\";\r\n\tbindLinks?: string;\r\n\tlayers?: any[];\r\n}\r\n\r\ninterface ILayoutResizer {\r\n\tview?: undefined;\r\n\tresizer: boolean;\r\n\twidth: number;\r\n}\r\n\r\ninterface ILayoutResourceGrid extends ILayoutView {\r\n\tview: \"resourceGrid\";\r\n\twidth: number;\r\n\tgroup: \"string\";\r\n}\r\n\r\ninterface ILayoutResourceTimeline extends ILayoutView {\r\n\tview: \"resourceTimeline\";\r\n\twidth: number;\r\n\tgroup: \"string\";\r\n}\r\n\r\ninterface ILayoutHtml {\r\n\thtml: string;\r\n\tcss: string;\r\n\twidth: number;\r\n}\r\n\r\ntype LayoutRow = ILayoutGrid\r\n\t| ILayoutTimeline\r\n\t| ILayoutResizer\r\n\t| ILayoutResourceGrid\r\n\t| ILayoutResourceTimeline\r\n\t| ILayoutHtml\r\n\t| ILayoutScrollbar\r\n\t| { cols: LayoutCol[] };\r\n\r\ntype LayoutCol = ILayoutGrid\r\n\t| ILayoutTimeline\r\n\t| ILayoutResizer\r\n\t| ILayoutResourceGrid\r\n\t| ILayoutResourceTimeline\r\n\t| ILayoutHtml\r\n\t| ILayoutScrollbar\r\n\t| { rows: LayoutRow[] };\r\n\r\ninterface ILayout {\r\n\tcss: string;\r\n\trows?: LayoutRow[];\r\n\tcols?: LayoutCol[];\r\n}\r\n\r\ntype TCsp = boolean | \"auto\";\r\n\r\ninterface IResourceConfig {\r\n\tdataprocessor_assignments?: boolean;\r\n\tdataprocessor_resources?: boolean;\r\n\teditable_resource_diagram?: boolean;\r\n\tresource_store?: {\r\n\t\ttype?: \"treeDataStore\"|\"dataStore\"|string;\r\n\t\tfetchTasks?: boolean;\r\n\t\tinitItem?: (item: any) => any;\r\n\t};\r\n\tlightbox_resources?: (resources: any[]) => any[];\r\n\r\n}\r\n\r\ninterface IGanttConfig {\r\n\tlayout: ILayout;\r\n\tlinks: {\r\n\t\tfinish_to_start: \"0\";\r\n\t\tstart_to_start: \"1\";\r\n\t\tfinish_to_finish: \"2\";\r\n\t\tstart_to_finish: \"3\";\r\n\t};\r\n\ttypes: {\r\n\t\ttask: string;\r\n\t\tproject: string;\r\n\t\tmilestone: string;\r\n\t};\r\n\tauto_types: boolean;\r\n\tduration_unit: DurationUnits;\r\n\twork_time: boolean;\r\n\tcorrect_work_time: boolean;\r\n\tdeadlines: boolean;\r\n\tskip_off_time: boolean;\r\n\tcascade_delete: boolean;\r\n\tautosize: boolean | string;\r\n\tautoscroll: boolean;\r\n\tshow_links: boolean;\r\n\tshow_task_cells: boolean;\r\n\tautosize_min_width: number;\r\n\tautoscroll_speed: number;\r\n\tdeepcopy_on_parse: boolean;\r\n\tstatic_background: boolean;\r\n\tstatic_background_cells: boolean;\r\n\tbranch_loading: boolean;\r\n\tbranch_loading_property: string;\r\n\tshow_loading: boolean;\r\n\tshow_chart: boolean;\r\n\tshow_grid: boolean;\r\n\tmin_duration: number;\r\n\tdate_format: string; // use instead xml_date\r\n\txml_date?: string; // deprecated\r\n\tstart_on_monday: boolean;\r\n\tserver_utc: boolean;\r\n\tshow_progress: boolean;\r\n\tfit_tasks: boolean;\r\n\tselect_task: boolean;\r\n\tscroll_on_click: boolean;\r\n\tsmart_rendering: boolean;\r\n\tpreserve_scroll: boolean;\r\n\treadonly: boolean;\r\n\tcontainer_resize_timeout: number;\r\n\r\n\t/*grid */\r\n\tdate_grid: string;\r\n\r\n\tdrag_links: boolean;\r\n\tdrag_progress: boolean;\r\n\tdrag_resize: boolean;\r\n\tdrag_project: boolean;\r\n\tdrag_move: boolean;\r\n\tdrag_mode: {\r\n\t\tresize: \"resize\",\r\n\t\tprogress: \"progress\",\r\n\t\tmove: \"move\",\r\n\t\tignore: \"ignore\"\r\n\t};\r\n\tround_dnd_dates: boolean;\r\n\tlink_wrapper_width: number;\r\n\troot_id: string | number;\r\n\r\n\tlink_arrow_size:number;\r\n\r\n\tautofit: boolean;\r\n\tcolumns: IColumnItem[];\r\n\r\n\t/* scale*/\r\n\t/* it will be deprecated */\r\n\tdate_scale?: string;\r\n\tstep?: number;\r\n\tscale_unit?: DurationUnits;\r\n\tsubscales?: IScale[];\r\n\t/* it will be deprecated end */\r\n\r\n\tscales: IScale[];\r\n\r\n\tscale_offset_minimal: boolean;\r\n\r\n\tinherit_scale_class: boolean;\r\n\r\n\r\n\ttime_step: number;\r\n\tduration_step: number;\r\n\r\n\r\n\ttask_date: string;\r\n\ttime_picker: string;\r\n\ttask_attribute: string;\r\n\tlink_attribute: string;\r\n\tlayer_attribute: string;\r\n\tbuttons_left: string[];\r\n\t_migrate_buttons: {\r\n\t\tdhx_save_btn: \"gantt_save_btn\",\r\n\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\r\n\t\tdhx_delete_btn: \"gantt_delete_btn\"\r\n\t};\r\n\r\n\tbuttons_right: string[];\r\n\r\n\r\n\tlightbox: {\r\n\t\tsections?: LightboxSection,\r\n\t\tproject_sections?: LightboxSection,\r\n\t\tmilestone_sections?: LightboxSection\r\n\t};\r\n\tdrag_lightbox: boolean;\r\n\tsort: boolean;\r\n\tdetails_on_create: boolean;\r\n\tdetails_on_dblclick: boolean;\r\n\tinitial_scroll: boolean;\r\n\ttask_scroll_offset: number;\r\n\r\n\torder_branch: boolean;\r\n\torder_branch_free: boolean;\r\n\r\n\t// task_height is deprecated, use 'bar_height` instead\r\n\ttask_height: number | \"full\" | undefined;\r\n\tbar_height: number | \"full\";\r\n\tmin_column_width: number;\r\n\tbar_height_padding: number,\r\n\trow_height: number,\r\n\r\n\t// min width for grid column (when resizing)\r\n\tmin_grid_column_width: number;\r\n\t// name of the attribute with column index for resize element\r\n\tgrid_resizer_column_attribute: string;\r\n\t// name of the attribute with column index for resize element\r\n\t// grid_resizer_attribute: string; // usage of this parameter is not found\r\n\r\n\t// grid width can be increased after the column has been resized\r\n\tkeep_grid_width: boolean;\r\n\r\n\t// grid width can be adjusted\r\n\tgrid_resize: boolean;\r\n\tgrid_elastic_columns: boolean;\r\n\tshow_tasks_outside_timescale: boolean;\r\n\tshow_unscheduled: boolean;\r\n\treadonly_property: string;\r\n\teditable_property: string;\r\n\tcalendar_property: string;\r\n\tresource_calendars: object;\r\n\tdynamic_resource_calendars: boolean;\r\n\tinherit_calendar: boolean;\r\n\ttype_renderers: object;\r\n\r\n\tresize_rows: boolean;\r\n\t// name of the attribute with row index for resize element\r\n\ttask_grid_row_resizer_attribute: string;\r\n\t// min height for row (when resizing)\r\n\tmin_task_grid_row_height: number;\r\n\r\n\topen_tree_initially: boolean;\r\n\toptimize_render: boolean;\r\n\tprevent_default_scroll: boolean;\r\n\tshow_errors: boolean;\r\n\twai_aria_attributes: boolean;\r\n\tsmart_scales: boolean;\r\n\trtl: boolean;\r\n\tplaceholder_task: boolean | object;\r\n\thorizontal_scroll_key: TModifierKeys;\r\n\tdrag_timeline: {\r\n\t\tuseKey: TModifierKeys;\r\n\t\tignore: string;\r\n\t\trender?: boolean;\r\n\t};\r\n\tdrag_multiple: boolean;\r\n\tcsp: TCsp;\r\n\r\n\tresources?: IResourceConfig;\r\n}\r\n\r\nexport default () => {\r\n\tconst result: IGanttConfig = {\r\n\t\tlayout: {\r\n\t\t\tcss: \"gantt_container\",\r\n\t\t\trows: [\r\n\t\t\t\t{\r\n\t\t\t\t\tcols: [\r\n\t\t\t\t\t\t{view: \"grid\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\r\n\t\t\t\t\t\t{resizer: true, width: 1},\r\n\t\t\t\t\t\t{view: \"timeline\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\r\n\t\t\t\t\t\t{view: \"scrollbar\", id: \"scrollVer\"}\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t{view: \"scrollbar\", id: \"scrollHor\", height: 20}\r\n\t\t\t]\r\n\t\t},\r\n\t\tlinks: {\r\n\t\t\tfinish_to_start: \"0\",\r\n\t\t\tstart_to_start: \"1\",\r\n\t\t\tfinish_to_finish: \"2\",\r\n\t\t\tstart_to_finish: \"3\"\r\n\t\t},\r\n\t\ttypes: {\r\n\t\t\ttask: \"task\",\r\n\t\t\tproject: \"project\",\r\n\t\t\tmilestone: \"milestone\"\r\n\t\t},\r\n\t\tauto_types: false,\r\n\t\tduration_unit: \"day\",\r\n\t\twork_time: false,\r\n\t\tcorrect_work_time: false,\r\n\t\tskip_off_time: false,\r\n\r\n\t\tcascade_delete: true,\r\n\r\n\t\tautosize: false,\r\n\t\tautosize_min_width: 0,\r\n\t\tautoscroll: true,\r\n\t\tautoscroll_speed: 30,\r\n\t\tdeepcopy_on_parse: false,\r\n\t\tshow_links: true,\r\n\t\tshow_task_cells: true,\r\n\t\t// replace backgroung of the task area with a canvas img\r\n\t\tstatic_background: false,\r\n\t\tstatic_background_cells: true,\r\n\t\tbranch_loading: false,\r\n\t\tbranch_loading_property: \"$has_child\",\r\n\t\tshow_loading: false,\r\n\t\tshow_chart: true,\r\n\t\tshow_grid: true,\r\n\t\tmin_duration: 60 * 60 * 1000,\r\n\t\tdate_format: \"%d-%m-%Y %H:%i\", // use instead xml_date\r\n\t\txml_date: undefined, // \"%d-%m-%Y %H:%i\", // deprecated\r\n\t\tstart_on_monday: true,\r\n\t\tserver_utc: false,\r\n\t\tshow_progress: true,\r\n\t\tfit_tasks: false,\r\n\t\tselect_task: true,\r\n\t\tscroll_on_click: true,\r\n\t\tsmart_rendering: true,\r\n\t\tpreserve_scroll: true,\r\n\t\treadonly: false,\r\n\t\tcontainer_resize_timeout: 20,\r\n\t\tdeadlines: true,\r\n\r\n\t\t/*grid */\r\n\t\tdate_grid: \"%Y-%m-%d\",\r\n\r\n\t\tdrag_links: true,\r\n\t\tdrag_progress: true,\r\n\t\tdrag_resize: true,\r\n\t\tdrag_project: false,\r\n\t\tdrag_move: true,\r\n\t\tdrag_mode: {\r\n\t\t\tresize: \"resize\",\r\n\t\t\tprogress: \"progress\",\r\n\t\t\tmove: \"move\",\r\n\t\t\tignore: \"ignore\"\r\n\t\t},\r\n\t\tround_dnd_dates: true,\r\n\t\tlink_wrapper_width: 20,\r\n\t\tlink_arrow_size:12,\r\n\t\troot_id: 0,\r\n\r\n\t\tautofit: false, // grid column automatic fit grid_width config\r\n\t\tcolumns: [\r\n\t\t\t{name: \"text\", tree: true, width: \"*\", resize: true},\r\n\t\t\t{name: \"start_date\", align: \"center\", resize: true},\r\n\t\t\t{name: \"duration\", align: \"center\"},\r\n\t\t\t{name: \"add\", width: 44}\r\n\t\t],\r\n\r\n\t\t/*scale*/\r\n\r\n\t\tscale_offset_minimal: true,\r\n\t\tinherit_scale_class: false,\r\n\r\n\t\tscales: [\r\n\t\t\t{\r\n\t\t\t\tunit: \"day\",\r\n\t\t\t\tstep: 1,\r\n\t\t\t\tdate: \"%d %M\"\r\n\t\t\t}\r\n\t\t],\r\n// \t\tdate_scale: \"%d %M\",\r\n\r\n\t\ttime_step: 60,\r\n\t\tduration_step: 1,\r\n\t\ttask_date: \"%d %F %Y\",\r\n\t\ttime_picker: \"%H:%i\",\r\n\t\ttask_attribute: \"data-task-id\",\r\n\t\tlink_attribute: \"data-link-id\",\r\n\t\tlayer_attribute: \"data-layer\",\r\n\t\tbuttons_left: [\r\n\t\t\t\"gantt_save_btn\",\r\n\t\t\t\"gantt_cancel_btn\"\r\n\t\t],\r\n\t\t_migrate_buttons: {\r\n\t\t\tdhx_save_btn: \"gantt_save_btn\",\r\n\t\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\r\n\t\t\tdhx_delete_btn: \"gantt_delete_btn\"\r\n\t\t},\r\n\t\tbuttons_right: [\r\n\t\t\t\"gantt_delete_btn\"\r\n\t\t],\r\n\t\tlightbox: {\r\n\t\t\tsections: [\r\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\r\n\t\t\t\t{name: \"time\", type: \"duration\", map_to: \"auto\"}\r\n\t\t\t],\r\n\t\t\tproject_sections: [\r\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\r\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\r\n\t\t\t\t{name: \"time\", type: \"duration\", readonly: true, map_to: \"auto\"}\r\n\t\t\t],\r\n\t\t\tmilestone_sections: [\r\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\r\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\r\n\t\t\t\t{name: \"time\", type: \"duration\", single_date: true, map_to: \"auto\"}\r\n\t\t\t]\r\n\t\t},\r\n\t\tdrag_lightbox: true,\r\n\t\tsort: false,\r\n\t\tdetails_on_create: true,\r\n\t\tdetails_on_dblclick: true,\r\n\t\tinitial_scroll: true,\r\n\t\ttask_scroll_offset: 100,\r\n\r\n\t\torder_branch: false,\r\n\t\torder_branch_free: false,\r\n\r\n\t\t// task height is deprecated, use 'bar_height' instead\r\n\t\ttask_height: undefined,// number px of 'full' for row height\r\n\t\tbar_height: \"full\",\r\n\t\tbar_height_padding:9,\r\n\t\tmin_column_width: 70,\r\n\r\n\t\t// min width for grid column (when resizing)\r\n\t\tmin_grid_column_width: 70,\r\n\t\t// name of the attribute with column index for resize element\r\n\t\tgrid_resizer_column_attribute: \"data-column-index\",\r\n\t\t// name of the attribute with column index for resize element\r\n\t\t// grid_resizer_attribute: \"grid_resizer\", // - usage of this parameter is not found in code\r\n\r\n\t\t// grid width can be increased after the column has been resized\r\n\t\tkeep_grid_width: false,\r\n\r\n\t\t// grid width can be adjusted\r\n\t\tgrid_resize: false,\r\n\t\tgrid_elastic_columns: false,\r\n\t\tshow_tasks_outside_timescale: false,\r\n\t\tshow_unscheduled: true,\r\n\r\n\t\tresize_rows: false,\r\n\t\t// name of the attribute with row index for resize element\r\n\t\ttask_grid_row_resizer_attribute: \"data-row-index\",\r\n\t\t// min height for row (when resizing)\r\n\t\tmin_task_grid_row_height: 30,\r\n\t\trow_height: 36,\r\n\r\n\t\t//\r\n\t\treadonly_property: \"readonly\",\r\n\t\teditable_property: \"editable\",\r\n\t\tcalendar_property: \"calendar_id\",\r\n\t\tresource_calendars: {},\r\n\t\tdynamic_resource_calendars: false,\r\n\t\tinherit_calendar: false,\r\n\t\ttype_renderers: {},\r\n\r\n\t\topen_tree_initially: false,\r\n\t\toptimize_render: true,\r\n\t\tprevent_default_scroll: false,\r\n\t\tshow_errors: true,\r\n\t\twai_aria_attributes: true,\r\n\t\tsmart_scales: true,\r\n\t\trtl:false,\r\n\t\tplaceholder_task: false,\r\n\t\thorizontal_scroll_key: \"shiftKey\",\r\n\t\tdrag_timeline: {\r\n\t\t\tuseKey: undefined,\r\n\t\t\tignore: \".gantt_task_line, .gantt_task_link\",\r\n\t\t\trender: false\r\n\t\t},\r\n\t\tdrag_multiple: true,\r\n\t\tcsp: \"auto\"\r\n\t};\r\n\treturn result;\r\n};\r\n","import eventable from \"../../utils/eventable\";\r\nimport * as utils from \"../../utils/utils\";\r\nimport timeout from \"../../utils/timeout\";\r\nimport global from \"../../utils/global\";\r\nimport * as domHelpers from \"../ui/utils/dom_helpers\";\r\n\r\nexport default function(gantt){\r\n\r\n\tfunction copyDomEvent(e){\r\n\t\treturn {\r\n\t\t\ttarget: e.target || e.srcElement,\r\n\t\t\tpageX: e.pageX,\r\n\t\t\tpageY: e.pageY,\r\n\t\t\tclientX: e.clientX,\r\n\t\t\tclientY: e.clientY,\r\n\t\t\tmetaKey: e.metaKey,\r\n\t\t\tshiftKey: e.shiftKey,\r\n\t\t\tctrlKey: e.ctrlKey,\r\n\t\t\taltKey: e.altKey\r\n\t\t};\r\n\t}\r\n\r\n\tfunction DnD(obj, config) {\r\n\t\tthis._obj = obj;\r\n\t\tthis._settings = config || {};\r\n\t\teventable(this);\r\n\r\n\t\tvar inputMethods = this.getInputMethods();\r\n\r\n\t\tthis._drag_start_timer = null;\r\n\t\tgantt.attachEvent(\"onGanttScroll\", utils.bind(function (left, top) {\r\n\t\t\tthis.clearDragTimer();\r\n\t\t}, this));\r\n\r\n\t\tvar lastDown = 0;\r\n\t\tvar eventParams = {passive: false};\r\n\t\tfor(var i = 0; i < inputMethods.length; i++){\r\n\t\t\t(utils.bind(function(input){\r\n\r\n\t\t\t\tgantt.event(obj, input.down, utils.bind(function (e) {\r\n\t\t\t\t\tif(!input.accessor(e)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(config.preventDefault && config.selector && domHelpers.closest(e.target, config.selector)){\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (gantt.config.touch && e.timeStamp && e.timeStamp - lastDown < 300) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis._settings.original_target = copyDomEvent(e);\r\n\r\n\t\t\t\t\tthis._settings.original_element_sizes = {\r\n\t\t\t\t\t\t...domHelpers.getRelativeEventPosition(e, domHelpers.getClosestSizedElement(obj)), \r\n\t\t\t\t\t\twidth: e.target.offsetWidth,\r\n\t\t\t\t\t\theight: e.target.offsetHeight\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (gantt.config.touch) {\r\n\t\t\t\t\t\tthis.clearDragTimer();\r\n\t\t\t\t\t\tthis._drag_start_timer = setTimeout(utils.bind(function () {\r\n\t\t\t\t\t\t\tif(gantt.getState().lightbox){\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.dragStart(obj, e, input);\r\n\t\t\t\t\t\t}, this), gantt.config.touch_drag);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.dragStart(obj, e, input);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, this), eventParams);\r\n\t\t\t\tvar eventElement = document.body;\r\n\t\t\t\tgantt.event(eventElement, input.up, utils.bind(function (e) {\r\n\t\t\t\t\tif(!input.accessor(e)){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.clearDragTimer();\r\n\t\t\t\t}, this), eventParams);\r\n\r\n\t\t\t}, this))(inputMethods[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tDnD.prototype = {\r\n\t\ttraceDragEvents: function (domElement, inputMethod) {\r\n\t\t\tvar mousemove = utils.bind(function (e) {\r\n\t\t\t\treturn this.dragMove(domElement, e, inputMethod.accessor);\r\n\t\t\t}, this);\r\n\t\t\tutils.bind(function (e) {\r\n\t\t\t\treturn this.dragScroll(domElement, e);\r\n\t\t\t}, this);\r\n\r\n\t\t\tvar limited_mousemove = utils.bind(function (e) {\r\n\t\t\t\tif (this.config.started && utils.defined(this.config.updates_per_second)) {\r\n\t\t\t\t\tif (!timeout(this, this.config.updates_per_second))\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar dndActive = mousemove(e);\r\n\r\n\t\t\t\tif (dndActive) {\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tif (e && e.preventDefault && e.cancelable){//e.cancelable condition - because navigator.vibrate is blocked by Chrome\r\n\t\t\t\t\t\t\te.preventDefault();//Cancel default action on DND\r\n\t\t\t\t\t\t} //Cancel default action on DND\r\n\t\t\t\t\t}catch (e){\r\n\t\t\t\t\t\t// just suppress the exception, nothing needed to be done here\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//e.cancelBubble = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn dndActive;\r\n\t\t\t}, this);\r\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root);\r\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || domHelpers.getRootNode(gantt.$root);\r\n\r\n\t\t\tvar eventParams = {passive: false};\r\n\t\t\tvar mouseup = utils.bind(function (e) {\r\n\t\t\t\tgantt.eventRemove(mousemoveContainer, inputMethod.move, limited_mousemove);\r\n\t\t\t\tgantt.eventRemove(eventElement, inputMethod.up, mouseup, eventParams);\r\n\t\t\t\treturn this.dragEnd(domElement);\r\n\t\t\t}, this);\r\n\r\n\t\t\tgantt.event(mousemoveContainer, inputMethod.move, limited_mousemove, eventParams);\r\n\t\t\tgantt.event(eventElement, inputMethod.up, mouseup, eventParams);\r\n\t\t},\r\n\t\tcheckPositionChange: function (pos) {\r\n\t\t\tvar diff_x = pos.x - this.config.pos.x;\r\n\t\t\tvar diff_y = pos.y - this.config.pos.y;\r\n\t\t\tvar distance = Math.sqrt(Math.pow(Math.abs(diff_x), 2) + Math.pow(Math.abs(diff_y), 2));\r\n\r\n\t\t\tif (distance > this.config.sensitivity) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tinitDnDMarker: function () {\r\n\t\t\t// create dnd placeholder and put it in dom\r\n\t\t\tvar marker = this.config.marker = document.createElement(\"div\");\r\n\t\t\tmarker.className = \"gantt_drag_marker\";\r\n\t\t\t// GS-1333: don't show any message when we resize grid columns\r\n\t\t\tmarker.innerHTML = \"\";\r\n\t\t\tdocument.body.appendChild(marker);\r\n\t\t},\r\n\t\tbackupEventTarget: function (domEvent, getEvent) {\r\n\t\t\tif (!gantt.config.touch) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// keep original event target in DOM in order to keep dnd on touchmove event\r\n\t\t\tvar e = getEvent(domEvent);\r\n\r\n\t\t\tvar el = e.target || e.srcElement;\r\n\t\t\tvar copy = el.cloneNode(true);\r\n\t\t\t//this.config.target.target = copy;\r\n\t\t\tthis.config.original_target = copyDomEvent(e);\r\n\t\t\tthis.config.original_target.target = copy;\r\n\t\t\tthis.config.backup_element = el;\r\n\t\t\tel.parentNode.appendChild(copy);\r\n\r\n\t\t\tel.style.display = \"none\";\r\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || document.body;\r\n\t\t\tmousemoveContainer.appendChild(el);\r\n\t\t},\r\n\t\tgetInputMethods: function () {\r\n\t\t\t// bind actions to browser events\r\n\t\t\tvar inputMethods = [];\r\n\r\n\t\t\tinputMethods.push({\r\n\t\t\t\t\"move\": \"mousemove\",\r\n\t\t\t\t\"down\": \"mousedown\",\r\n\t\t\t\t\"up\": \"mouseup\",\r\n\t\t\t\t\"accessor\": function (e) {\r\n\t\t\t\t\treturn e;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (gantt.config.touch) {\r\n\r\n\t\t\t\tvar touchEventsSupported = true;\r\n\t\t\t\ttry{\r\n\t\t\t\t\tdocument.createEvent(\"TouchEvent\");\r\n\t\t\t\t}catch (e){\r\n\t\t\t\t\ttouchEventsSupported = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(touchEventsSupported){\r\n\t\t\t\t\tinputMethods.push({\r\n\t\t\t\t\t\t\"move\": \"touchmove\",\r\n\t\t\t\t\t\t\"down\": \"touchstart\",\r\n\t\t\t\t\t\t\"up\": \"touchend\",\r\n\t\t\t\t\t\t\"accessor\": function (ev) {\r\n\t\t\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\r\n\t\t\t\t\t\t\tif (ev.touches[0])\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\ttarget: document.elementFromPoint(ev.touches[0].clientX, ev.touches[0].clientY),\r\n\t\t\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\r\n\t\t\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\r\n\t\t\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\r\n\t\t\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\treturn ev;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}else if(global.navigator.pointerEnabled){\r\n\t\t\t\t\tinputMethods.push({\r\n\t\t\t\t\t\t\"move\": \"pointermove\",\r\n\t\t\t\t\t\t\"down\": \"pointerdown\",\r\n\t\t\t\t\t\t\"up\": \"pointerup\",\r\n\t\t\t\t\t\t\"accessor\": function (ev) {\r\n\t\t\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\r\n\t\t\t\t\t\t\treturn ev;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}else if (global.navigator.msPointerEnabled){\r\n\t\t\t\t\tinputMethods.push({\r\n\t\t\t\t\t\t\"move\": \"MSPointerMove\",\r\n\t\t\t\t\t\t\"down\": \"MSPointerDown\",\r\n\t\t\t\t\t\t\"up\": \"MSPointerUp\",\r\n\t\t\t\t\t\t\"accessor\": function (ev) {\r\n\t\t\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\r\n\t\t\t\t\t\t\treturn ev;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn inputMethods;\r\n\t\t},\r\n\t\tclearDragTimer: function () {\r\n\t\t\tif (this._drag_start_timer) {\r\n\t\t\t\tclearTimeout(this._drag_start_timer);\r\n\t\t\t\tthis._drag_start_timer = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdragStart: function (obj, e, inputMethod) {\r\n\t\t\tif (this.config && this.config.started) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.config = {\r\n\t\t\t\tobj: obj,\r\n\t\t\t\tmarker: null,\r\n\t\t\t\tstarted: false,\r\n\t\t\t\tpos: this.getPosition(e),\r\n\t\t\t\tsensitivity: 4\r\n\t\t\t};\r\n\t\t\tif (this._settings)\r\n\t\t\t\tutils.mixin(this.config, this._settings, true);\r\n\r\n\r\n\t\t\tthis.traceDragEvents(obj, inputMethod);\r\n\r\n\t\t\tgantt._prevent_touch_scroll = true;\r\n\t\t\t// GS-2664. Prevent grid scroll only if we can reorder rows\r\n\t\t\tif (e.target.closest(\".gantt_row\") && !gantt.config.order_branch){\r\n\t\t\t\tgantt._prevent_touch_scroll = false;\r\n\t\t\t}\r\n\t\t\tdocument.body.classList.add(\"gantt_noselect\");\r\n\r\n\t\t\tif (gantt.config.touch) {\r\n\t\t\t\tthis.dragMove(obj, e, inputMethod.accessor);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tdragMove: function (obj, e, getEvent) {\r\n\t\t\tvar source = getEvent(e);\r\n\t\t\tif (!source) return false;\r\n\r\n\t\t\tif (!this.config.marker && !this.config.started) {\r\n\t\t\t\tvar pos = this.getPosition(source);\r\n\r\n\t\t\t\tif (gantt.config.touch || this.checkPositionChange(pos)) {\r\n\t\t\t\t\t// real drag starts here,\r\n\t\t\t\t\t// when user moves mouse at first time after onmousedown\r\n\t\t\t\t\tthis.config.started = true;\r\n\t\t\t\t\tthis.config.ignore = false;\r\n\t\t\t\t\tgantt._touch_drag = true;\r\n\t\t\t\t\tif (this.callEvent(\"onBeforeDragStart\", [obj, this.config.original_target]) === false) {\r\n\t\t\t\t\t\tthis.config.ignore = true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.backupEventTarget(e, getEvent);\r\n\t\t\t\t\tthis.initDnDMarker();\r\n\t\t\t\t\tgantt._touch_feedback();\r\n\t\t\t\t\tthis.callEvent(\"onAfterDragStart\", [obj, this.config.original_target]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.config.ignore = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.config.ignore) {\r\n\t\t\t\t// GS-1279 Gantt crashes on Mobile Firefox after starting to create a link and moving finger outisde the page.\r\n\t\t\t\tif (e.targetTouches && !source.target) return;\r\n\t\t\t\t\r\n\t\t\t\tsource.pos = this.getPosition(source);\r\n\t\t\t\tthis.config.marker.style.left = source.pos.x + \"px\";\r\n\t\t\t\tthis.config.marker.style.top = source.pos.y + \"px\";\r\n\t\t\t\tthis.callEvent(\"onDragMove\", [obj, source]);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\tdragEnd: function (obj) {\r\n\t\t\tvar target = this.config.backup_element;\r\n\t\t\tif (target && target.parentNode) {\r\n\t\t\t\ttarget.parentNode.removeChild(target);\r\n\t\t\t}\r\n\t\t\tgantt._prevent_touch_scroll = false;\r\n\t\t\tif (this.config.marker) {\r\n\t\t\t\tthis.config.marker.parentNode.removeChild(this.config.marker);\r\n\t\t\t\tthis.config.marker = null;\r\n\r\n\t\t\t\tthis.callEvent(\"onDragEnd\", []);\r\n\t\t\t}\r\n\t\t\tthis.config.started = false;\r\n\t\t\tgantt._touch_drag = false;\r\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\r\n\t\t},\r\n\r\n\t\tgetPosition: function (e) {\r\n\t\t\tvar x = 0, y = 0;\r\n\t\t\tif (e.pageX || e.pageY) {\r\n\t\t\t\tx = e.pageX;\r\n\t\t\t\ty = e.pageY;\r\n\t\t\t} else if (e.clientX || e.clientY) {\r\n\t\t\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n\t\t\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n\t\t\t}\r\n\t\t\treturn {x: x, y: y};\r\n\t\t}\r\n\t};\r\n\r\n\treturn DnD;\r\n};\r\n","export default function(gantt) {\r\n\r\n\tvar regTemplates = {};\r\n\r\n\tfunction initTemplate(name, initial, template_name) {\r\n\t\ttemplate_name = template_name || name;\r\n\t\tvar config = gantt.config,\r\n\t\t\ttemplates = gantt.templates;\r\n\r\n\t\tif (gantt.config[name] && regTemplates[template_name] != config[name]) {\r\n\t\t\tif (!(initial && templates[template_name])) {\r\n\t\t\t\ttemplates[template_name] = gantt.date.date_to_str(config[name]);\r\n\t\t\t\tregTemplates[template_name] = config[name];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction initTemplates() {\r\n\t\tvar date = gantt.date;\r\n\r\n\t\t//build configuration based templates\r\n\t\tvar d = date.date_to_str;\r\n\t\tvar c = gantt.config;\r\n\t\tvar format_date = d(c.xml_date || c.date_format, c.server_utc);\r\n\t\tvar parse_date = date.str_to_date(c.xml_date || c.date_format, c.server_utc);\r\n\r\n\t\tinitTemplate(\"date_scale\", true, undefined, gantt.config, gantt.templates);\r\n\t\tinitTemplate(\"date_grid\", true, \"grid_date_format\", gantt.config, gantt.templates);\r\n\t\tinitTemplate(\"task_date\", true, undefined, gantt.config, gantt.templates);\r\n\r\n\t\tgantt.mixin(gantt.templates, {\r\n\t\t\txml_format: undefined, // deprecated\r\n\t\t\tformat_date: format_date,\r\n\r\n\t\t\txml_date: undefined, // deprecated\r\n\t\t\tparse_date: parse_date,\r\n\r\n\t\t\tprogress_text: function (start, end, task) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\tgrid_header_class: function (column, config) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\r\n\t\t\ttask_text: function (start, end, task) {\r\n\t\t\t\treturn task.text;\r\n\t\t\t},\r\n\t\t\ttask_class: function (start, end, task) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\ttask_end_date: function (date) {\r\n\t\t\t\treturn gantt.templates.task_date(date);\r\n\t\t\t},\r\n\t\t\tgrid_row_class: function (start, end, task) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\ttask_row_class: function (start, end, task) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\ttimeline_cell_class: function (item, date) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\ttimeline_cell_content: function (item, date) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\tscale_cell_class: function (date) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\tscale_row_class: function (date) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\r\n\t\t\tgrid_indent: function (item) {\r\n\t\t\t\treturn \"<div class='gantt_tree_indent'></div>\";\r\n\t\t\t},\r\n\t\t\tgrid_folder: function (item) {\r\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_folder_\" + (item.$open ? \"open\" : \"closed\") + \"'></div>\";\r\n\t\t\t},\r\n\t\t\tgrid_file: function (item) {\r\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_file'></div>\";\r\n\t\t\t},\r\n\t\t\tgrid_open: function (item) {\r\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_\" + (item.$open ? \"close\" : \"open\") + \"'></div>\";\r\n\t\t\t},\r\n\t\t\tgrid_blank: function (item) {\r\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_blank'></div>\";\r\n\t\t\t},\r\n\t\t\tdate_grid: function (date, item, column) {\r\n\t\t\t\tif (item && gantt.isUnscheduledTask(item) && gantt.config.show_unscheduled) {\r\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(item);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn gantt.templates.grid_date_format(date, column);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\ttask_time: function (start, end, ev) {\r\n\t\t\t\tif (gantt.isUnscheduledTask(ev) && gantt.config.show_unscheduled) {\r\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(ev);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn gantt.templates.task_date(start) + \" - \" + gantt.templates.task_end_date(end);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\ttask_unscheduled_time: function (task) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\r\n\t\t\ttime_picker: d(c.time_picker),\r\n\t\t\tlink_class: function (link) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t},\r\n\t\t\tlink_description: function (link) {\r\n\t\t\t\tvar from = gantt.getTask(link.source),\r\n\t\t\t\t\tto = gantt.getTask(link.target);\r\n\r\n\t\t\t\treturn \"<b>\" + from.text + \"</b> &ndash;  <b>\" + to.text + \"</b>\";\r\n\t\t\t},\r\n\r\n\t\t\tdrag_link: function (from, from_start, to, to_start) {\r\n\t\t\t\tfrom = gantt.getTask(from);\r\n\t\t\t\tvar labels = gantt.locale.labels;\r\n\r\n\t\t\t\tvar text = \"<b>\" + from.text + \"</b> \" + (from_start ? labels.link_start : labels.link_end) + \"<br/>\";\r\n\t\t\t\tif (to) {\r\n\t\t\t\t\tto = gantt.getTask(to);\r\n\t\t\t\t\ttext += \"<b> \" + to.text + \"</b> \" + (to_start ? labels.link_start : labels.link_end) + \"<br/>\";\r\n\t\t\t\t}\r\n\t\t\t\treturn text;\r\n\t\t\t},\r\n\t\t\tdrag_link_class: function (from, from_start, to, to_start) {\r\n\t\t\t\tvar add = \"\";\r\n\r\n\t\t\t\tif (from && to) {\r\n\t\t\t\t\tvar allowed = gantt.isLinkAllowed(from, to, from_start, to_start);\r\n\t\t\t\t\tadd = \" \" + (allowed ? \"gantt_link_allow\" : \"gantt_link_deny\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn \"gantt_link_tooltip\" + add;\r\n\t\t\t},\r\n\r\n\t\t\t/* used for aria-labels of bar elements and for tooltip.js */\r\n\t\t\ttooltip_date_format: date.date_to_str(\"%Y-%m-%d\"),\r\n\t\t\ttooltip_text: function (start, end, event) {\r\n\t\t\t\treturn `<div>Task: ${event.text}</div>\r\n\t\t\t\t<div>Start date: ${gantt.templates.tooltip_date_format(start)}</div>\r\n\t\t\t\t<div>End date: ${gantt.templates.tooltip_date_format(end)}</div>`;\r\n\t\t\t},\r\n\t\t\tbaseline_text: function (task, baseline, index) {\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\treturn {\r\n\t\tinitTemplates: initTemplates,\r\n\t\tinitTemplate: initTemplate\r\n\t};\r\n\r\n};","import * as utils from \"../../utils/utils\";\r\nimport facadeFactory from \"./../facades/datastore\";\r\nimport calculateScaleRange from \"../gantt_data_range\";\r\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\r\n\r\nimport treeHelper from \"../../utils/task_tree_helpers\";\r\n\r\nfunction initDataStores(gantt){\r\n\r\n\tvar facade = facadeFactory.create();\r\n\tutils.mixin(gantt, facade);\r\n\tvar tasksStore = gantt.createDatastore({\r\n\t\tname: \"task\",\r\n\t\ttype: \"treeDatastore\",\r\n\t\trootId: function() { return gantt.config.root_id; },\r\n\t\tinitItem: utils.bind(_init_task, gantt),\r\n\t\tgetConfig: function() { return gantt.config; }\r\n\t});\r\n\r\n\tvar linksStore = gantt.createDatastore({\r\n\t\tname: \"link\",\r\n\t\tinitItem: utils.bind(_init_link, gantt)\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\ttasksStore.destructor();\r\n\t\tlinksStore.destructor();\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\r\n\t\tif(gantt.isLinkExists(link.id) || link.id === \"predecessor_generated\"){\r\n\t\t\t// link was already added into gantt\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar source = gantt.getTask(link.source);\r\n\t\tvar taskLinks = source.$source;\r\n\t\tfor (var i = 0; i < taskLinks.length; i++) {\r\n\t\t\tvar existingLink = gantt.getLink(taskLinks[i]);\r\n\r\n\t\t\tvar sourceMatch = link.source == existingLink.source;\r\n\t\t\tvar targetMatch = link.target == existingLink.target;\r\n\t\t\tvar typeMatch = link.type == existingLink.type;\r\n\r\n\t\t\t// prevent creating duplicated links from the UI\r\n\t\t\tif (sourceMatch && targetMatch && typeMatch) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onBeforeRefreshAll\", function(){\r\n\r\n\t\t// GS-2170 do not recalculate indexes and dates as the event will be called later in the onStoreUpdate event\r\n\t\tif (tasksStore._skipTaskRecalculation){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar order = tasksStore.getVisibleItems();\r\n\r\n\t\tfor(var i=0; i < order.length; i++){\r\n\t\t\tvar item = order[i];\r\n\t\t\titem.$index = i;\r\n\t\t\titem.$local_index = gantt.getTaskIndex(item.id);\r\n\t\t\tgantt.resetProjectDates(item);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onFilterItem\", function(id, task) {\r\n\t\tif (gantt.config.show_tasks_outside_timescale) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tvar min = null, max = null;\r\n\t\tif (gantt.config.start_date && gantt.config.end_date) {\r\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) return true;\r\n\t\t\tmin = gantt.config.start_date.valueOf();\r\n\t\t\tmax = gantt.config.end_date.valueOf();\r\n\r\n\t\t\tif (+task.start_date > max || +task.end_date < +min)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onIdChange\", function(oldId, newId){\r\n\t\tgantt._update_flags(oldId, newId);\r\n\r\n\t\tvar changedTask = gantt.getTask(newId);\r\n\t\tif(!tasksStore.isSilent()){\r\n\t\t\tif(changedTask.$split_subtask || changedTask.rollup){\r\n\t\t\t\tgantt.eachParent(function(parent){\r\n\t\t\t\t\tgantt.refreshTask(parent.id);\r\n\t\t\t\t}, newId);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onAfterUpdate\", function(id){\r\n\t\tgantt._update_parents(id);\r\n\t\tif(gantt.getState(\"batchUpdate\").batch_update){\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tvar task = tasksStore.getItem(id);\r\n\t\tif (!task.$source) task.$source = [];\r\n\t\tfor (var i = 0; i < task.$source.length; i++) {\r\n\t\t\tlinksStore.refresh(task.$source[i]);\r\n\t\t}\r\n\t\tif (!task.$target) task.$target = [];\r\n\t\tfor (var i = 0; i < task.$target.length; i++) {\r\n\t\t\tlinksStore.refresh(task.$target[i]);\r\n\t\t}\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onBeforeItemMove\", function(sid, parent, tindex){\r\n\t\t// GS-125. Don't allow users to move the placeholder task\r\n\t\tif (isPlaceholderTask(sid, gantt, tasksStore)){\r\n\t\t\t//eslint-disable-next-line\r\n\t\t\tconsole.log(\"The placeholder task cannot be moved to another position.\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onAfterItemMove\", function(sid, parent, tindex){\r\n\t\tvar source = gantt.getTask(sid);\r\n\r\n\t\tif(this.getNextSibling(sid) !== null){\r\n\t\t\tsource.$drop_target = this.getNextSibling(sid);\r\n\t\t} else if(this.getPrevSibling(sid) !== null){\r\n\t\t\tsource.$drop_target = \"next:\" + this.getPrevSibling(sid);\r\n\t\t}else{\r\n\t\t\tsource.$drop_target = \"next:null\";\r\n\t\t}\r\n\r\n\t});\r\n\r\n\ttasksStore.attachEvent(\"onStoreUpdated\", function(id, item, action){\r\n\t\tif(action == \"delete\"){\r\n\t\t\tgantt._update_flags(id, null);\r\n\t\t}\r\n\r\n\t\tvar state = gantt.$services.getService(\"state\");\r\n\t\tif(state.getState(\"batchUpdate\").batch_update){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif(gantt.config.fit_tasks && action !== \"paint\"){\r\n\t\t\tvar oldState = gantt.getState();\r\n\t\t\tcalculateScaleRange(gantt);\r\n\t\t\tvar newState = gantt.getState();\r\n\r\n\t\t\t//this._init_tasks_range();\r\n\t\t\tif (+oldState.min_date != +newState.min_date || +oldState.max_date != +newState.max_date) {\r\n\t\t\t\tgantt.render();\r\n\r\n\t\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif(action == \"add\" || action == \"move\" || action == \"delete\"){\r\n\t\t\tif(gantt.$layout){\r\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks in the\r\n\t\t\t\t// onBeforeResize layout event, but do it later. If lightbox is opened, it will\r\n\t\t\t\t// trigger the refreshData, so the indexes and dates will be recalculated there\r\n\t\t\t\tif (this.$config.name == \"task\" && (action == \"add\" || action == \"delete\")){\r\n\t\t\t\t\tif (this._skipTaskRecalculation != \"lightbox\"){\r\n\t\t\t\t\t\tthis._skipTaskRecalculation = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgantt.$layout.resize();\r\n\t\t\t}\r\n\r\n\t\t}else if(!id){\r\n\t\t\tlinksStore.refresh();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tlinksStore.attachEvent(\"onAfterAdd\", function(id, link){\r\n\t\tsync_link(link);\r\n\t});\r\n\tlinksStore.attachEvent(\"onAfterUpdate\", function(id, link){\r\n\t\tsync_links();\r\n\t});\r\n\tlinksStore.attachEvent(\"onAfterDelete\", function(id, link){\r\n\t\tsync_link_delete(link);\r\n\t});\r\n\tlinksStore.attachEvent(\"onAfterSilentDelete\", function(id, link){\r\n\t\tsync_link_delete(link);\r\n\t});\r\n\tlinksStore.attachEvent(\"onBeforeIdChange\", function(oldId, newId){\r\n\t\tsync_link_delete(gantt.mixin({id:oldId}, gantt.$data.linksStore.getItem(newId)));\r\n\t\tsync_link(gantt.$data.linksStore.getItem(newId));\r\n\t});\r\n\r\n\tfunction checkLinkedTaskVisibility(taskId){\r\n\t\tvar isVisible = gantt.isTaskVisible(taskId);\r\n\t\tif(!isVisible && gantt.isTaskExists(taskId)){\r\n\t\t\tvar parent = gantt.getParent(taskId);\r\n\t\t\tif(gantt.isTaskExists(parent) && gantt.isTaskVisible(parent)){\r\n\t\t\t\tparent = gantt.getTask(parent);\r\n\t\t\t\tif(gantt.isSplitTask(parent)){\r\n\t\t\t\t\tisVisible = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn isVisible;\r\n\t}\r\n\r\n\tlinksStore.attachEvent(\"onFilterItem\", function(id, link){\r\n\t\tif (!gantt.config.show_links) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar sourceVisible = checkLinkedTaskVisibility(link.source);\r\n\t\tvar targetVisible = checkLinkedTaskVisibility(link.target);\r\n\r\n\t\tif (!(sourceVisible && targetVisible) ||\r\n\t\t\tgantt._isAllowedUnscheduledTask(gantt.getTask(link.source)) || gantt._isAllowedUnscheduledTask(gantt.getTask(link.target)))\r\n\t\t\treturn false;\r\n\r\n\t\treturn gantt.callEvent(\"onBeforeLinkDisplay\", [id, link]);\r\n\t});\r\n\r\n\r\n\t(function(){\r\n\t\t// delete all connected links after task is deleted\r\n\t\tvar deletedLinks = {};\r\n\r\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", function(id, item){\r\n\t\t\tdeletedLinks[id] = treeHelper.getSubtreeLinks(gantt, id);\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", function(id, item) {\r\n\t\t\tif(deletedLinks[id]){\r\n\t\t\t\tgantt.$data.linksStore.silent(function(){\r\n\t\t\t\t\tfor(var i in deletedLinks[id]){\r\n\t\t\t\t\t\tif (gantt.isLinkExists(i)){\r\n\t\t\t\t\t\t\tgantt.$data.linksStore.removeItem(i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsync_link_delete(deletedLinks[id][i]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdeletedLinks[id] = null;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t})();\r\n\r\n\tgantt.attachEvent(\"onAfterLinkDelete\", function(id, link) {\r\n\t\t// GS-1786. Repaint tasks only if they are loaded\r\n\t\tif(gantt.isTaskExists(link.source)){\r\n\t\t\tgantt.refreshTask(link.source);\r\n\t\t}\r\n\t\tif(gantt.isTaskExists(link.target)){\r\n\t\t\tgantt.refreshTask(link.target);\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onParse\", sync_links);\r\n\r\n\tmapEvents({\r\n\t\tsource: linksStore,\r\n\t\ttarget: gantt,\r\n\t\tevents:{\r\n\t\t\t\"onItemLoading\":\"onLinkLoading\",\r\n\t\t\t\"onBeforeAdd\":\"onBeforeLinkAdd\",\r\n\t\t\t\"onAfterAdd\":\"onAfterLinkAdd\",\r\n\t\t\t\"onBeforeUpdate\":\"onBeforeLinkUpdate\",\r\n\t\t\t\"onAfterUpdate\":\"onAfterLinkUpdate\",\r\n\t\t\t\"onBeforeDelete\":\"onBeforeLinkDelete\",\r\n\t\t\t\"onAfterDelete\":\"onAfterLinkDelete\",\r\n\t\t\t\"onIdChange\":\"onLinkIdChange\"\r\n\t\t}\r\n\t});\r\n\r\n\tmapEvents({\r\n\t\tsource: tasksStore,\r\n\t\ttarget: gantt,\r\n\t\tevents:{\r\n\t\t\t\"onItemLoading\":\"onTaskLoading\",\r\n\t\t\t\"onBeforeAdd\":\"onBeforeTaskAdd\",\r\n\t\t\t\"onAfterAdd\":\"onAfterTaskAdd\",\r\n\t\t\t\"onBeforeUpdate\":\"onBeforeTaskUpdate\",\r\n\t\t\t\"onAfterUpdate\":\"onAfterTaskUpdate\",\r\n\t\t\t\"onBeforeDelete\":\"onBeforeTaskDelete\",\r\n\t\t\t\"onAfterDelete\":\"onAfterTaskDelete\",\r\n\t\t\t\"onIdChange\":\"onTaskIdChange\",\r\n\t\t\t\"onBeforeItemMove\":\"onBeforeTaskMove\",\r\n\t\t\t\"onAfterItemMove\":\"onAfterTaskMove\",\r\n\t\t\t\"onFilterItem\":\"onBeforeTaskDisplay\",\r\n\t\t\t\"onItemOpen\":\"onTaskOpened\",\r\n\t\t\t\"onItemClose\":\"onTaskClosed\",\r\n\t\t\t\"onBeforeSelect\":\"onBeforeTaskSelected\",\r\n\t\t\t\"onAfterSelect\":\"onTaskSelected\",\r\n\t\t\t\"onAfterUnselect\":\"onTaskUnselected\"\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.$data = {\r\n\t\ttasksStore: tasksStore,\r\n\t\tlinksStore: linksStore\r\n\t};\r\n\r\n\tfunction sync_link(link){\r\n\t\tif(gantt.isTaskExists(link.source)){\r\n\t\t\tvar sourceTask = gantt.getTask(link.source);\r\n\t\t\tsourceTask.$source = sourceTask.$source || [];\r\n\t\t\tif (noDuplicateIds(link.id, sourceTask.$source)){\r\n\t\t\t\tsourceTask.$source.push(link.id);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(gantt.isTaskExists(link.target)){\r\n\t\t\tvar targetTask = gantt.getTask(link.target);\r\n\t\t\ttargetTask.$target = targetTask.$target || [];\r\n\t\t\tif (noDuplicateIds(link.id, targetTask.$target)){\r\n\t\t\t\ttargetTask.$target.push(link.id);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// GS-2085. Don't add duplicate link IDs\r\n\tfunction noDuplicateIds(id, array){\r\n\t\treturn array.indexOf(String(id)) === -1 && array.indexOf(Number(id)) === -1;\r\n\t}\r\n\r\n\tfunction sync_link_delete(link){\r\n\t\tif(gantt.isTaskExists(link.source)){\r\n\t\t\tvar sourceTask = gantt.getTask(link.source);\r\n\t\t\tfor(var i = 0; i < sourceTask.$source.length; i++){\r\n\t\t\t\tif(sourceTask.$source[i] == link.id){\r\n\t\t\t\t\tsourceTask.$source.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(gantt.isTaskExists(link.target)){\r\n\t\t\tvar targetTask = gantt.getTask(link.target);\r\n\t\t\tfor(var i = 0; i < targetTask.$target.length; i++){\r\n\t\t\t\tif(targetTask.$target[i] == link.id){\r\n\t\t\t\t\ttargetTask.$target.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction sync_links() {\r\n\t\tvar task = null;\r\n\t\tvar tasks = gantt.$data.tasksStore.getItems();\r\n\r\n\t\tfor(var i = 0, len = tasks.length; i < len; i++){\r\n\t\t\ttask = tasks[i];\r\n\t\t\ttask.$source = [];\r\n\t\t\ttask.$target = [];\r\n\t\t}\r\n\r\n\t\tvar links = gantt.$data.linksStore.getItems();\r\n\t\tfor (var i = 0, len = links.length; i < len; i++) {\r\n\r\n\t\t\tvar link = links[i];\r\n\t\t\tsync_link(link);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction mapEvents(conf){\r\n\t\tvar mapFrom = conf.source;\r\n\t\tvar mapTo = conf.target;\r\n\t\tfor(var i in conf.events){\r\n\t\t\t(function(sourceEvent, targetEvent){\r\n\t\t\t\tmapFrom.attachEvent(sourceEvent, function(){\r\n\t\t\t\t\treturn mapTo.callEvent(targetEvent, Array.prototype.slice.call(arguments));\r\n\t\t\t\t}, targetEvent);\r\n\t\t\t})(i, conf.events[i]);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _init_task(task) {\r\n\t\tif (!this.defined(task.id))\r\n\t\t\ttask.id = this.uid();\r\n\r\n\t\tif (task.start_date)\r\n\t\t\ttask.start_date = gantt.date.parseDate(task.start_date, \"parse_date\");\r\n\t\tif (task.end_date)\r\n\t\t\ttask.end_date = gantt.date.parseDate(task.end_date, \"parse_date\");\r\n\r\n\r\n\t\tvar duration = null;\r\n\t\tif (task.duration || task.duration === 0) {\r\n\t\t\ttask.duration = duration = task.duration * 1;\r\n\t\t}\r\n\r\n\t\tif (duration) {\r\n\t\t\tif (task.start_date && !task.end_date) {\r\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\r\n\t\t\t} else if (!task.start_date && task.end_date) {\r\n\t\t\t\ttask.start_date = this.calculateEndDate({\r\n\t\t\t\t\tstart_date: task.end_date,\r\n\t\t\t\t\tduration: -task.duration,\r\n\t\t\t\t\ttask: task\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t//task.$calculate_duration = false;\r\n\t\t}\r\n\r\n\t\tif (gantt.config.deadlines !== false && task.deadline){\r\n\t\t\ttask.deadline = gantt.date.parseDate(task.deadline, \"parse_date\");\r\n\t\t}\r\n\r\n\t\ttask.progress = Number(task.progress) || 0;\r\n\r\n\t\tif (this._isAllowedUnscheduledTask(task)) {\r\n\t\t\tthis._set_default_task_timing(task);\r\n\t\t}\r\n\t\tthis._init_task_timing(task);\r\n\t\tif (task.start_date && task.end_date)\r\n\t\t\tthis.correctTaskWorkTime(task);\r\n\r\n\t\ttask.$source = [];\r\n\t\ttask.$target = [];\r\n\r\n\t\tvar originalTask = this.$data.tasksStore.getItem(task.id);\r\n\t\tif (originalTask && !utils.defined(task.open)) {\r\n\t\t\t// if a task with the same id is already in the gantt and the new object doesn't specify the `open` state -\r\n\t\t\t// restore the `open` state we already have in the chart\r\n\t\t\ttask.$open = originalTask.$open;\r\n\t\t}\r\n\r\n\t\tif (task.parent === undefined) {\r\n\t\t\ttask.parent = this.config.root_id;\r\n\t\t}\r\n\t\tif(task.open){\r\n\t\t\ttask.$open = true;\r\n\t\t}\r\n\t\treturn task;\r\n\t}\r\n\r\n\tfunction _init_link(link) {\r\n\t\tif (!this.defined(link.id))\r\n\t\t\tlink.id = this.uid();\r\n\t\treturn link;\r\n\t}\r\n}\r\n\r\n\r\nexport default initDataStores;\r\n","import batch_update from \"./batch_update\";\r\nimport wbs from \"./wbs\";\r\nimport resources from \"./resources\";\r\nimport resource_assignments from \"./resource_assignments\";\r\nimport new_task_placeholder from \"./new_task_placeholder\";\r\nimport auto_task_types from \"./auto_task_types\";\r\nimport formatters from \"./formatters\";\r\nimport empty_state_screen from \"./empty_state_screen\";\r\nimport baselines from \"./baselines\";\r\n\r\nexport default function(gantt){\r\n\tif(!gantt.ext){\r\n\t\tgantt.ext = {};\r\n\t}\r\n\r\n\tvar modules = [\r\n\t\tbatch_update,\r\n\t\twbs,\r\n\t\tresources,\r\n\t\tresource_assignments,\r\n\t\tnew_task_placeholder,\r\n\t\tauto_task_types,\r\n\t\tformatters,\r\n\t\tempty_state_screen,\r\n\t\tbaselines\r\n\t];\r\n\r\n\tfor(var i = 0; i < modules.length; i++){\r\n\t\tif(modules[i])\r\n\t\t\tmodules[i](gantt);\r\n\t}\r\n};","export default function(gantt) {\r\n\tgantt.getGridColumn = function(name) {\r\n\t\tvar columns = gantt.config.columns;\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tif (columns[i].name == name)\r\n\t\t\t\treturn columns[i];\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t};\r\n\r\n\tgantt.getGridColumns = function() {\r\n\t\treturn gantt.config.columns.slice();\r\n\t};\r\n};","export default function(gantt) {\r\n\tgantt.isReadonly = function (item) {\r\n\r\n\t\tif((typeof item == \"number\" || typeof item == \"string\") && gantt.isTaskExists(item)){\r\n\t\t\titem = gantt.getTask(item);\r\n\t\t}\r\n\t\tif (item && item[this.config.editable_property]) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\treturn (item && item[this.config.readonly_property]) || this.config.readonly;\r\n\t\t}\r\n\t};\r\n};","import CalendarManager from \"./calendar_manager\";\r\nimport TimeCalculator from \"./time_calculator\";\r\nimport worktimeFacadeFactory from \"../facades/worktime_calendars\";\r\nimport * as utils from \"../../utils/utils\";\r\n\r\nexport default function (gantt) {\r\n\tvar manager = new CalendarManager(gantt),\r\n\ttimeCalculator = new TimeCalculator(manager);\r\n\tvar facade = worktimeFacadeFactory.create(manager, timeCalculator);\r\n\tutils.mixin(gantt, facade);\r\n};\r\n","export default function(gantt) {\r\n\r\n\tgantt.getTaskType = function (type) {\r\n\t\treturn \"task\";\r\n\t};\r\n};","/*\r\n reuse results of functions that can be recalculated during rendering\r\n greatly increases the rendering speed when critical path enabled\r\n Sample - 94_dev/critical_path.html\r\n\r\n */\r\nexport default function(gantt){\r\n\r\ngantt._cached_functions = {\r\n\tcache: {},\r\n\tmode: false,\r\n\tcritical_path_mode: false,\r\n\twrap_methods : function(methods, object){\r\n\t\tif(object._prefetch_originals){\r\n\t\t\tfor(var i in object._prefetch_originals){\r\n\t\t\t\tobject[i] = object._prefetch_originals[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tobject._prefetch_originals = {};\r\n\t\tfor(var i = 0; i < methods.length; i++)\r\n\t\t\tthis.prefetch(methods[i], object);\r\n\r\n\t},\r\n\tprefetch : function(methodname, host){\r\n\t\tvar original = host[methodname];\r\n\t\tif(original){\r\n\t\t\tvar optimizer = this;\r\n\r\n\t\t\thost._prefetch_originals[methodname] = original;\r\n\t\t\thost[methodname] = function get_prefetched_value(){\r\n\r\n\t\t\t\tvar argumentsArray = new Array(arguments.length);\r\n\t\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\r\n\t\t\t\t\targumentsArray[i] = arguments[i];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(optimizer.active){\r\n\t\t\t\t\tvar args = optimizer.get_arguments_hash(Array.prototype.slice.call(argumentsArray));\r\n\t\t\t\t\tif(!optimizer.cache[methodname]){\r\n\t\t\t\t\t\toptimizer.cache[methodname] = {};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar cached_values = optimizer.cache[methodname];\r\n\r\n\t\t\t\t\tif(optimizer.has_cached_value(cached_values, args)){\r\n\t\t\t\t\t\treturn optimizer.get_cached_value(cached_values, args);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tvar value = original.apply(this, argumentsArray);\r\n\t\t\t\t\t\toptimizer.cache_value(cached_values, args, value);\r\n\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn original.apply(this, argumentsArray);\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn original;\r\n\t},\r\n\tcache_value: function(cache, arguments_hash, value){\r\n\t\tif(this.is_date(value))\r\n\t\t\tvalue = new Date(value);\r\n\t\tcache[arguments_hash] = value;\r\n\t},\r\n\thas_cached_value: function(cache, arguments_hash){\r\n\t\treturn cache.hasOwnProperty(arguments_hash);\r\n\t},\r\n\tget_cached_value: function(cache, arguments_hash){\r\n\t\tvar data = cache[arguments_hash];\r\n\r\n\t\t//for cached dates - return copy\r\n\t\tif(this.is_date(data)){\r\n\t\t\tdata = new Date(data);\r\n\t\t}\r\n\t\treturn data;\r\n\t},\r\n\tis_date: function(value){\r\n\t\treturn (value && value.getUTCDate);\r\n\t},\r\n\tget_arguments_hash:function(args){\r\n\t\tvar values = [];\r\n\t\tfor(var i = 0; i < args.length; i++){\r\n\t\t\tvalues.push(this.stringify_argument(args[i]));\r\n\t\t}\r\n\t\treturn \"(\" + values.join(\";\") + \")\";\r\n\t},\r\n\tstringify_argument: function(value){\r\n\t\t//expecting task or link, or any other data entries, dates and primitive values\r\n\t\tvar ret = \"\";\r\n\t\tif(value.id){\r\n\t\t\tret = value.id;\r\n\t\t}else if(this.is_date(value)){\r\n\t\t\tret = value.valueOf();\r\n\t\t}else{\r\n\t\t\tret = value;\r\n\t\t}\r\n\t\treturn ret + \"\";\r\n\t},\r\n\tactivate: function(){\r\n\t\tthis.clear();\r\n\t\tthis.active = true;\r\n\t},\r\n\tdeactivate: function(){\r\n\t\tthis.clear();\r\n\t\tthis.active = false;\r\n\t},\r\n\tclear: function(){\r\n\t\tthis.cache = {};\r\n\t},\r\n\r\n\tsetup: function(gantt){\r\n\t\tvar override_gantt = [];\r\n\r\n\t\tvar gantt_methods  = [\r\n\t\t\t'_isProjectEnd',\r\n\t\t\t'_getProjectEnd',\r\n\t\t\t'_getSlack'\r\n\t\t];\r\n\r\n\r\n\r\n\t\tif(this.mode == 'auto'){\r\n\t\t\tif(gantt.config.highlight_critical_path){\r\n\t\t\t\toverride_gantt = gantt_methods;\r\n\t\t\t}\r\n\t\t}else if(this.mode === true){\r\n\t\t\toverride_gantt = gantt_methods;\r\n\t\t}\r\n\r\n\t\tthis.wrap_methods(override_gantt, gantt);\r\n\r\n\t},\r\n\tupdate_if_changed: function(gantt){\r\n\t\tvar changed = (this.critical_path_mode != gantt.config.highlight_critical_path ||\r\n\t\t\t\t\t\tthis.mode !== gantt.config.optimize_render);\r\n\t\tif(changed){\r\n\t\t\tthis.critical_path_mode = gantt.config.highlight_critical_path;\r\n\t\t\tthis.mode = gantt.config.optimize_render;\r\n\t\t\tthis.setup(gantt);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nfunction activate(){\r\n\tgantt._cached_functions.update_if_changed(gantt);\r\n\tif(!gantt._cached_functions.active){\r\n\t\tgantt._cached_functions.activate();\r\n\t}\r\n\treturn true;\r\n}\r\ngantt.attachEvent(\"onBeforeGanttRender\", activate);\r\ngantt.attachEvent(\"onBeforeDataRender\", activate);\r\ngantt.attachEvent(\"onBeforeSmartRender\",  function(){\r\n\tactivate();\r\n});\r\ngantt.attachEvent(\"onBeforeParse\", activate);\r\ngantt.attachEvent(\"onDataRender\", function(){\r\n\tgantt._cached_functions.deactivate();\r\n});\r\nvar deactivTimeout = null;\r\ngantt.attachEvent(\"onSmartRender\", function(){\r\n\tif(deactivTimeout)\r\n\t\tclearTimeout(deactivTimeout);\r\n\tdeactivTimeout = setTimeout(function(){\r\n\t\tgantt._cached_functions.deactivate();\r\n\t}, 1000);\r\n});\r\n\r\ngantt.attachEvent(\"onBeforeGanttReady\", function(){\r\n\tgantt._cached_functions.update_if_changed(gantt);\r\n\treturn true;\r\n});\r\n\r\n};","function extend(gantt){\r\n\r\n\tgantt.destructor = function(){\r\n\t\tthis.clearAll();\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\r\n\t\tthis._getDatastores().forEach(function(store){\r\n\t\t\tstore.destructor();\r\n\t\t});\r\n\r\n\t\tif(this.$root){\r\n\t\t\tdelete this.$root.gantt;\r\n\t\t}\r\n\r\n\t\tif(this._eventRemoveAll){\r\n\t\t\tthis._eventRemoveAll();\r\n\t\t}\r\n\r\n\t\tif(this.$layout){\r\n\t\t\tthis.$layout.destructor();\r\n\t\t}\r\n\r\n\t\tif(this.resetLightbox){\r\n\t\t\tthis.resetLightbox();\r\n\t\t}\r\n\r\n\t\t// GS-99. Call this here to detach the events\r\n\t\tif (this.ext.inlineEditors && this.ext.inlineEditors.destructor) {\r\n\t\t\tthis.ext.inlineEditors.destructor();\r\n\t\t}\r\n\r\n\t\tif(this._dp && this._dp.destructor){\r\n\t\t\tthis._dp.destructor();\r\n\t\t}\r\n\t\tthis.$services.destructor();\r\n\r\n\t\t// detachAllEvents should be called last, because in components may be attached events\r\n\t\tthis.detachAllEvents();\r\n\r\n\t\tfor(var i in this){\r\n\t\t\tif(i.indexOf(\"$\") === 0){\r\n\t\t\t\tdelete this[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.$destroyed = true;\r\n\t};\r\n}\r\n\r\nexport default extend;\r\n","import ar from \"./locale_ar\";\r\nimport be from \"./locale_be\";\r\nimport ca from \"./locale_ca\";\r\nimport cn from \"./locale_cn\";\r\nimport cs from \"./locale_cs\";\r\nimport da from \"./locale_da\";\r\nimport de from \"./locale_de\";\r\nimport el from \"./locale_el\";\r\nimport en from \"./locale_en\";\r\nimport es from \"./locale_es\";\r\nimport fa from \"./locale_fa\";\r\nimport fi from \"./locale_fi\";\r\nimport fr from \"./locale_fr\";\r\nimport he from \"./locale_he\";\r\nimport hr from \"./locale_hr\";\r\nimport hu from \"./locale_hu\";\r\nimport id from \"./locale_id\";\r\nimport it from \"./locale_it\";\r\nimport jp from \"./locale_jp\";\r\nimport kr from \"./locale_kr\";\r\n\r\nimport LocaleManager from \"./locale_manager\";\r\n\r\nimport nb from \"./locale_nb\";\r\nimport nl from \"./locale_nl\";\r\nimport no from \"./locale_no\";\r\nimport pl from \"./locale_pl\";\r\nimport pt from \"./locale_pt\";\r\nimport ro from \"./locale_ro\";\r\nimport ru from \"./locale_ru\";\r\nimport si from \"./locale_si\";\r\nimport sk from \"./locale_sk\";\r\nimport sv from \"./locale_sv\";\r\nimport tr from \"./locale_tr\";\r\nimport ua from \"./locale_ua\";\r\n\r\nexport default function(){\r\n\treturn new LocaleManager({\r\n\t\ten,\r\n\t\tar,\r\n\t\tbe,\r\n\t\tca,\r\n\t\tcn,\r\n\t\tcs,\r\n\t\tda,\r\n\t\tde,\r\n\t\tel,\r\n\t\tes,\r\n\t\tfa,\r\n\t\tfi,\r\n\t\tfr,\r\n\t\the,\r\n\t\thr,\r\n\t\thu,\r\n\t\tid,\r\n\t\tit,\r\n\t\tjp,\r\n\t\tkr,\r\n\t\tnb,\r\n\t\tnl,\r\n\t\tno,\r\n\t\tpl,\r\n\t\tpt,\r\n\t\tro,\r\n\t\tru,\r\n\t\tsi,\r\n\t\tsk,\r\n\t\tsv,\r\n\t\ttr,\r\n\t\tua\r\n\t});\r\n}","import * as utils from \"../../utils/utils\";\r\nimport * as domHelpers from \"./utils/dom_helpers\";\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar boxAttribute = \"data-dhxbox\";\r\n\r\n\tvar _dhx_msg_cfg = null;\r\n\r\n\tfunction callback(config, result) {\r\n\t\tvar usercall = config.callback;\r\n\t\tmodalBox.hide(config.box);\r\n\r\n\t\t_dhx_msg_cfg = config.box = null;\r\n\t\tif (usercall)\r\n\t\t\tusercall(result);\r\n\t}\r\n\r\n\tfunction modal_key(event) {\r\n\t\tif (_dhx_msg_cfg) {\r\n\r\n\t\t\tvar code = event.which || event.keyCode;\r\n\t\t\tvar preventDefault = false;\r\n\r\n\t\t\tif (messageBox.keyboard) {\r\n\t\t\t\tif (code == 13 || code == 32) {\r\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\r\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\r\n\t\t\t\t\tvar target = event.target || event.srcElement;\r\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"gantt_popup_button\") > -1 && target.click) {\r\n\t\t\t\t\t\ttarget.click();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\r\n\t\t\t\t\t\tpreventDefault = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (code == 27) {\r\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\r\n\t\t\t\t\tpreventDefault = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (preventDefault) {\r\n\t\t\t\tif (event.preventDefault){\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\t\t\t\treturn !(event.cancelBubble = true);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document;\r\n\tgantt.event(eventElement, \"keydown\", modal_key, true);\r\n\r\n\tfunction modality(mode) {\r\n\t\tif (!modality.cover) {\r\n\t\t\tmodality.cover = document.createElement(\"div\");\r\n\t\t\t//necessary for IE only\r\n\t\t\tmodality.cover.onkeydown = modal_key;\r\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\r\n\t\t\tdocument.body.appendChild(modality.cover);\r\n\t\t}\r\n\r\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\r\n\t}\r\n\r\n\tfunction button(text, className, result) {\r\n\t\tvar buttonAriaAttrs = gantt._waiAria.messageButtonAttrString(text);\r\n\t\tvar name = className.toLowerCase().replace(/ /g, \"_\");\r\n\t\tvar button_css = \"gantt_\" + name + \"_button\";\r\n\t\treturn \"<div \" + buttonAriaAttrs + \" class='gantt_popup_button \" + button_css + \"' data-result='\" + result + \"' result='\" + result + \"' ><div>\" + text + \"</div></div>\";\r\n\t}\r\n\r\n\tfunction info(text) {\r\n\t\tif (!messageBox.area) {\r\n\t\t\tmessageBox.area = document.createElement(\"div\");\r\n\t\t\tmessageBox.area.className = \"gantt_message_area\";\r\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\r\n\t\t}\r\n\t\tif (!domHelpers.isChildOf(messageBox.area, document.body)){\r\n\t\t\tdocument.body.appendChild(messageBox.area);\r\n\t\t}\r\n\r\n\t\tmessageBox.hide(text.id);\r\n\t\tvar message = document.createElement(\"div\");\r\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\r\n\t\tmessage.className = \"gantt-info gantt-\" + text.type;\r\n\t\tmessage.onclick = function () {\r\n\t\t\tmessageBox.hide(text.id);\r\n\t\t\ttext = null;\r\n\t\t};\r\n\r\n\t\tgantt._waiAria.messageInfoAttr(message);\r\n\r\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\r\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\r\n\t\telse\r\n\t\t\tmessageBox.area.appendChild(message);\r\n\r\n\t\tif (text.expire > 0)\r\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\r\n\t\t\t\t// GS-1213: We need that when Gantt is destroyed\r\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\r\n\t\t\t}, text.expire);\r\n\r\n\t\tmessageBox.pull[text.id] = message;\r\n\t\tmessage = null;\r\n\r\n\t\treturn text.id;\r\n\t}\r\n\r\n\tfunction getFirstDefined() {\r\n\t\tvar values = [].slice.apply(arguments, [0]);\r\n\r\n\t\tfor (var i = 0; i < values.length; i++) {\r\n\t\t\tif (values[i]) {\r\n\t\t\t\treturn values[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction _boxStructure(config, ok, cancel) {\r\n\t\tvar box = document.createElement(\"div\");\r\n\r\n\t\tvar contentId = utils.uid();\r\n\t\tgantt._waiAria.messageModalAttr(box, contentId);\r\n\r\n\r\n\t\tbox.className = \" gantt_modal_box gantt-\" + config.type;\r\n\t\tbox.setAttribute(boxAttribute, 1);\r\n\r\n\t\tvar inner = '';\r\n\r\n\t\tif (config.width)\r\n\t\t\tbox.style.width = config.width;\r\n\t\tif (config.height)\r\n\t\t\tbox.style.height = config.height;\r\n\t\tif (config.title)\r\n\t\t\tinner += '<div class=\"gantt_popup_title\">' + config.title + '</div>';\r\n\t\tinner += '<div class=\"gantt_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"gantt_popup_controls\">';\r\n\t\tif (ok)\r\n\t\t\tinner += button(getFirstDefined(config.ok, gantt.locale.labels.message_ok, \"OK\"), \"ok\", true);\r\n\t\tif (cancel)\r\n\t\t\tinner += button(getFirstDefined(config.cancel, gantt.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\r\n\r\n\t\tif (config.buttons) {\r\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\r\n\t\t\t\tvar btn = config.buttons[i];\r\n\t\t\t\tif (typeof btn == \"object\") {\r\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\r\n\t\t\t\t\tvar label = btn.label;\r\n\t\t\t\t\tvar css = btn.css || (\"gantt_\" + btn.label.toLowerCase() + \"_button\");\r\n\t\t\t\t\tvar value = btn.value || i;\r\n\t\t\t\t\tinner += button(label, css, value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tinner += button(btn, btn, i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tinner += '</div>';\r\n\t\tbox.innerHTML = inner;\r\n\r\n\t\tif (config.content) {\r\n\t\t\tvar node = config.content;\r\n\t\t\tif (typeof node == \"string\")\r\n\t\t\t\tnode = document.getElementById(node);\r\n\t\t\tif (node.style.display == 'none')\r\n\t\t\t\tnode.style.display = \"\";\r\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\r\n\t\t}\r\n\r\n\t\tbox.onclick = function (event) {\r\n\t\t\tvar source = event.target || event.srcElement;\r\n\t\t\tif (!source.className) source = source.parentNode;\r\n\t\t\tif (domHelpers.closest(source, \".gantt_popup_button\")) {\r\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\r\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\r\n\t\t\t\tcallback(config, result);\r\n\t\t\t}\r\n\t\t};\r\n\t\tconfig.box = box;\r\n\t\tif (ok || cancel)\r\n\t\t\t_dhx_msg_cfg = config;\r\n\r\n\t\treturn box;\r\n\t}\r\n\r\n\tfunction _createBox(config, ok, cancel) {\r\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\r\n\r\n\t\tif (!config.hidden)\r\n\t\t\tmodality(true);\r\n\t\tdocument.body.appendChild(box);\r\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\r\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\r\n\t\tif (config.position == \"top\")\r\n\t\t\tbox.style.top = \"-3px\";\r\n\t\telse\r\n\t\t\tbox.style.top = y + 'px';\r\n\t\tbox.style.left = x + 'px';\r\n\t\t//necessary for IE only\r\n\t\tbox.onkeydown = modal_key;\r\n\r\n\t\tmodalBox.focus(box);\r\n\r\n\t\tif (config.hidden)\r\n\t\t\tmodalBox.hide(box);\r\n\r\n\t\tgantt.callEvent(\"onMessagePopup\", [box]);\r\n\t\treturn box;\r\n\t}\r\n\r\n\tfunction alertPopup(config) {\r\n\t\treturn _createBox(config, true, false);\r\n\t}\r\n\r\n\tfunction confirmPopup(config) {\r\n\t\treturn _createBox(config, true, true);\r\n\t}\r\n\r\n\tfunction boxPopup(config) {\r\n\t\treturn _createBox(config);\r\n\t}\r\n\r\n\tfunction box_params(text, type, callback) {\r\n\t\tif (typeof text != \"object\") {\r\n\t\t\tif (typeof type == \"function\") {\r\n\t\t\t\tcallback = type;\r\n\t\t\t\ttype = \"\";\r\n\t\t\t}\r\n\t\t\ttext = {text: text, type: type, callback: callback};\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\r\n\tfunction params(text, type, expire, id) {\r\n\t\tif (typeof text != \"object\")\r\n\t\t\ttext = {text: text, type: type, expire: expire, id: id};\r\n\t\ttext.id = text.id || utils.uid();\r\n\t\ttext.expire = text.expire || messageBox.expire;\r\n\t\treturn text;\r\n\t}\r\n\r\n\tvar alertBox = function () {\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"confirm\";\r\n\t\treturn alertPopup(text);\r\n\t};\r\n\tvar confirmBox = function () {\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"alert\";\r\n\t\treturn confirmPopup(text);\r\n\t};\r\n\tvar modalBox = function () {\r\n\t\tvar text = box_params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"alert\";\r\n\t\treturn boxPopup(text);\r\n\t};\r\n\tmodalBox.hide = function (node) {\r\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\r\n\t\t\tnode = node.parentNode;\r\n\t\tif (node) {\r\n\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\tmodality(false);\r\n\r\n\t\t\tgantt.callEvent(\"onAfterMessagePopup\", [node]);\r\n\t\t}\r\n\t};\r\n\r\n\tmodalBox.focus = function (node) {\r\n\t\tsetTimeout(function () {\r\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\r\n\t\t\tif (focusable.length) {\r\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\r\n\t\t\t}\r\n\t\t}, 1);\r\n\t};\r\n\r\n\tvar messageBox = function (text, type, expire, id) {\r\n\t\ttext = params.apply(this, arguments);\r\n\t\ttext.type = text.type || \"info\";\r\n\r\n\t\tvar subtype = text.type.split(\"-\")[0];\r\n\t\tswitch (subtype) {\r\n\t\t\tcase \"alert\":\r\n\t\t\t\treturn alertPopup(text);\r\n\t\t\tcase \"confirm\":\r\n\t\t\t\treturn confirmPopup(text);\r\n\t\t\tcase \"modalbox\":\r\n\t\t\t\treturn boxPopup(text);\r\n\t\t\tdefault:\r\n\t\t\t\treturn info(text);\r\n\t\t}\r\n\t};\r\n\r\n\tmessageBox.seed = (new Date()).valueOf();\r\n\tmessageBox.uid = utils.uid;\r\n\tmessageBox.expire = 4000;\r\n\tmessageBox.keyboard = true;\r\n\tmessageBox.position = \"top\";\r\n\tmessageBox.pull = {};\r\n\tmessageBox.timers = {};\r\n\r\n\tmessageBox.hideAll = function () {\r\n\t\tfor (var key in messageBox.pull)\r\n\t\t\tmessageBox.hide(key);\r\n\t};\r\n\tmessageBox.hide = function (id) {\r\n\t\tvar obj = messageBox.pull[id];\r\n\t\tif (obj && obj.parentNode) {\r\n\t\t\twindow.setTimeout(function () {\r\n\t\t\t\tobj.parentNode.removeChild(obj);\r\n\t\t\t\tobj = null;\r\n\t\t\t}, 2000);\r\n\t\t\tobj.className += \" hidden\";\r\n\r\n\t\t\tif (messageBox.timers[id])\r\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\r\n\t\t\tdelete messageBox.pull[id];\r\n\t\t}\r\n\t};\r\n\r\n\tvar popups = [];\r\n\tgantt.attachEvent(\"onMessagePopup\", function(box){\r\n\t\tpopups.push(box);\r\n\t});\r\n\tgantt.attachEvent(\"onAfterMessagePopup\", function(box){\r\n\t\tfor(var i = 0; i < popups.length; i++){\r\n\t\t\tif(popups[i] === box){\r\n\t\t\t\tpopups.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\tif(modality.cover && modality.cover.parentNode){\r\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\r\n\t\t}\r\n\r\n\t\tfor(var i = 0; i < popups.length; i++){\r\n\t\t\tif(popups[i].parentNode){\r\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tpopups = null;\r\n\r\n\t\tif(messageBox.area && messageBox.area.parentNode){\r\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\r\n\t\t}\r\n\t\tmessageBox = null;\r\n\t});\r\n\r\n\treturn {\r\n\t\talert: alertBox,\r\n\t\tconfirm: confirmBox,\r\n\t\tmessage: messageBox,\r\n\t\tmodalbox: modalBox\r\n\t};\r\n};","import * as utils from \"../../utils/utils\";\r\n\r\nfunction extendSettings (store, parentSettings){\r\n\tvar own = this.$config[store];\r\n\r\n\tif(own){\r\n\t\tif(!own.$extendedConfig){\r\n\t\t\town.$extendedConfig = true;\r\n\t\t\tObject.setPrototypeOf(own, parentSettings);\r\n\t\t}\r\n\t\treturn own;\r\n\t}else{\r\n\t\treturn parentSettings;\r\n\t}\r\n}\r\n\r\nvar configurable = function(parentView){\r\n\tvar parentConfig,\r\n\t\tparentTemplates;\r\n\r\n\treturn {\r\n\t\t$getConfig: function(){\r\n\t\t\tif(!parentConfig){\r\n\t\t\t\tparentConfig = parentView ? parentView.$getConfig() : this.$gantt.config;\r\n\t\t\t}\r\n\t\t\tif(!this.$config.config){\r\n\t\t\t\treturn parentConfig;\r\n\t\t\t}else{\r\n\t\t\t\treturn extendSettings.call(this, \"config\", parentConfig);\r\n\t\t\t}\r\n\t\t},\r\n\t\t$getTemplates: function(){\r\n\t\t\tif(!parentTemplates){\r\n\t\t\t\tparentTemplates = parentView ? parentView.$getTemplates() : this.$gantt.templates;\r\n\t\t\t}\r\n\t\t\tif(!this.$config.templates){\r\n\t\t\t\treturn parentTemplates;\r\n\t\t\t}else{\r\n\t\t\t\treturn extendSettings.call(this, \"templates\", parentTemplates);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default function(obj, parent){\r\n\tutils.mixin(obj, configurable(parent));\r\n};","import * as utils from \"../../utils/utils\";\r\nimport configurable from \"./configurable\";\r\n\r\nvar uiFactory = function createFactory(gantt){\r\n\tvar views = {};\r\n\r\n\tfunction ui(cell, parentView) {\r\n\t\tvar content;\r\n\t\tvar view = \"cell\";\r\n\t\tif (cell.view){\r\n\t\t\tview = \"viewcell\";\r\n\t\t}else if (cell.resizer) {\r\n\t\t\tview = \"resizer\";\r\n\t\t}\r\n\t\telse if (cell.rows || cell.cols) {\r\n\t\t\tview = \"layout\";\r\n\t\t}\r\n\t\telse if (cell.views) {\r\n\t\t\tview = \"multiview\";\r\n\t\t}\r\n\r\n\t\tcontent = createView.call(this, view, null, cell, parentView);\r\n\t\treturn content;\r\n\t}\r\n\t\r\n\tvar createdViews = {};\r\n\r\n\tfunction createView(name, parent, config, parentView) {\r\n\t\tvar creator = views[name];\r\n\r\n\t\tif(!creator || !creator.create)\r\n\t\t\treturn false;\r\n\r\n\t\tif(name == \"resizer\" && !config.mode){\r\n\t\t\tif(parentView.$config.cols){\r\n\t\t\t\tconfig.mode = \"x\";\r\n\t\t\t}else{\r\n\t\t\t\tconfig.mode = \"y\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(name == \"viewcell\" && config.view == \"scrollbar\" && !config.scroll){\r\n\t\t\tif(parentView.$config.cols){\r\n\t\t\t\tconfig.scroll = \"y\";\r\n\t\t\t}else{\r\n\t\t\t\tconfig.scroll = \"x\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar config = utils.copy(config);\r\n\r\n\t\tif(!config.id && !createdViews[config.view]){\r\n\t\t\tconfig.id = config.view;\r\n\t\t}\r\n\r\n\t\tif(config.id && !config.css){\r\n\t\t\tconfig.css = config.id+\"_cell\";\r\n\t\t}\r\n\r\n\t\tvar view = new creator.create(parent, config, this, gantt);\r\n\r\n\t\tif(creator.configure){\r\n\t\t\tcreator.configure(view);\r\n\t\t}\r\n\r\n\t\tconfigurable(view, parentView);\r\n\t\tif(!view.$id){\r\n\t\t\tview.$id = config.id || gantt.uid();\r\n\t\t}\r\n\r\n\t\tif(!view.$parent && typeof parent == \"object\"){\r\n\t\t\tview.$parent = parent;\r\n\t\t}\r\n\t\tif(!view.$config){\r\n\t\t\tview.$config = config;\r\n\t\t}\r\n\r\n\t\tif(createdViews[view.$id]){\r\n\t\t\tview.$id = gantt.uid();\r\n\t\t}\r\n\r\n\t\tcreatedViews[view.$id] = view;\r\n\r\n\t\treturn view;\r\n\t}\r\n\r\n\tfunction reset(){\r\n\t\tcreatedViews = {};\r\n\t}\r\n\r\n\tfunction register(name, viewConstructor, configure){\r\n\t\tviews[name] = {create: viewConstructor, configure: configure};\r\n\t}\r\n\r\n\tfunction getView(id){\r\n\t\treturn createdViews[id];\r\n\t}\r\n\r\n\tvar factory = {\r\n\t\tinitUI:ui,\r\n\t\treset: reset,\r\n\t\tregisterView: register,\r\n\t\tcreateView: createView,\r\n\t\tgetView: getView\r\n\t};\r\n\r\n\treturn factory;\r\n};\r\n\r\nexport default {\r\n\tcreateFactory: uiFactory\r\n};\r\n\r\n","import * as domHelpers from \"./utils/dom_helpers\";\r\n\r\nvar createMouseHandler = (function(domHelpers) {\r\n\treturn function (gantt) {\r\n\t\tvar eventHandlers = {\r\n\t\t\t\"click\": {},\r\n\t\t\t\"doubleclick\": {},\r\n\t\t\t\"contextMenu\": {}\r\n\t\t};\r\n\r\n\t\tfunction addEventTarget(event, className, handler, root) {\r\n\t\t\tif(!eventHandlers[event][className]){\r\n\t\t\t\teventHandlers[event][className] = [];\r\n\t\t\t}\r\n\r\n\t\t\teventHandlers[event][className].push({\r\n\t\t\t\thandler: handler,\r\n\t\t\t\troot: root\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfunction callHandler(eventName, className, root, args) {\r\n\t\t\tvar handlers = eventHandlers[eventName][className];\r\n\t\t\tif(handlers){\r\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\r\n\t\t\t\t\tif(!(root || handlers[i].root) || handlers[i].root === root){\r\n\t\t\t\t\t\thandlers[i].handler.apply(this, args);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onClick(e) {\r\n\t\t\te = e || window.event;\r\n\t\t\tvar id = gantt.locate(e);\r\n\r\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.click);\r\n\t\t\tvar res = true;\r\n\t\t\tif (id !== null) {\r\n\t\t\t\tres = !gantt.checkEvent(\"onTaskClick\") || gantt.callEvent(\"onTaskClick\", [id, e]);\r\n\t\t\t} else {\r\n\t\t\t\tgantt.callEvent(\"onEmptyClick\", [e]);\r\n\t\t\t}\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\r\n\t\t\t\tif (!default_action)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t// GS-1025: if we don't do that, the dropdown or date select will be closed for unselected tasks\r\n\t\t\t\t// GS-1078: or for the built-in select inline editor\r\n\t\t\t\tswitch(e.target.nodeName) {\r\n\t\t\t\t\tcase \"SELECT\":\r\n\t\t\t\t\tcase 'INPUT':\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//allow task selection when the multiselect plugin is not enabled\r\n\t\t\t\tif (id && gantt.getTask(id) && !gantt._multiselect && gantt.config.select_task) {\r\n\t\t\t\t\tgantt.selectTask(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onContextMenu(e) {\r\n\t\t\te = e || window.event;\r\n\t\t\tvar src = e.target || e.srcElement,\r\n\t\t\t\ttaskId = gantt.locate(src),\r\n\t\t\t\tlinkId = gantt.locate(src, gantt.config.link_attribute);\r\n\r\n\t\t\tvar res = !gantt.checkEvent(\"onContextMenu\") || gantt.callEvent(\"onContextMenu\", [taskId, linkId, e]);\r\n\t\t\tif (!res) {\r\n\t\t\t\tif (e.preventDefault)\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\telse\r\n\t\t\t\t\te.returnValue = false;\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t}\r\n\r\n\t\tfunction findEventHandlers(e, hash){\r\n\t\t\tvar trg = e.target || e.srcElement;\r\n\t\t\tvar handlers = [];\r\n\t\t\twhile (trg) {\r\n\t\t\t\tvar css = domHelpers.getClassName(trg);\r\n\t\t\t\tif (css) {\r\n\t\t\t\t\tcss = css.split(\" \");\r\n\t\t\t\t\tfor (var i = 0; i < css.length; i++) {\r\n\t\t\t\t\t\tif (!css[i]) continue;\r\n\t\t\t\t\t\tif (hash[css[i]]) {\r\n\t\t\t\t\t\t\tvar delegateHandlers = hash[css[i]];\r\n\r\n\t\t\t\t\t\t\tfor(var h = 0; h < delegateHandlers.length; h++){\r\n\t\t\t\t\t\t\t\tif(delegateHandlers[h].root){\r\n\t\t\t\t\t\t\t\t\tif(!domHelpers.isChildOf(trg, delegateHandlers[h].root)){\r\n\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\thandlers.push(delegateHandlers[h].handler);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttrg = trg.parentNode;\r\n\t\t\t}\r\n\t\t\treturn handlers;\r\n\t\t}\r\n\r\n\t\tfunction callEventHandlers(handlers, e, id){\r\n\t\t\tvar res = true;\r\n\r\n\t\t\tfor(var i = 0; i < handlers.length; i++){\r\n\t\t\t\tvar handlerResult =  handlers[i].call(gantt, e, id, e.target || e.srcElement);\r\n\t\t\t\tres = res && !(typeof handlerResult != \"undefined\" && handlerResult !== true);\r\n\t\t\t}\r\n\r\n\t\t\treturn res;\r\n\t\t}\r\n\r\n\r\n\t\tfunction onDoubleClick(e) {\r\n\t\t\te = e || window.event;\r\n\t\t\tvar id = gantt.locate(e);\r\n\r\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.doubleclick);\r\n\t\t\t// when doubleclick fired not on task, id === null\r\n\t\t\tvar res = !gantt.checkEvent(\"onTaskDblClick\") || id === null || gantt.callEvent(\"onTaskDblClick\", [id, e]);\r\n\t\t\tif (res) {\r\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\r\n\t\t\t\tif (!default_action)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif (id !== null && gantt.getTask(id)) {\r\n\t\t\t\t\tif (res && gantt.config.details_on_dblclick && !gantt.isReadonly(id)) {\r\n\t\t\t\t\t\tgantt.showLightbox(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction onMouseMove(e) {\r\n\t\t\tif (gantt.checkEvent(\"onMouseMove\")) {\r\n\t\t\t\tvar id = gantt.locate(e);\r\n\t\t\t\tgantt._last_move_event = e;\r\n\t\t\t\tgantt.callEvent(\"onMouseMove\", [id, e]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction detach(eventName, className, handler, root) {\r\n\t\t\tif (eventHandlers[eventName] && eventHandlers[eventName][className]) {\r\n\t\t\t\tvar handlers = eventHandlers[eventName];\r\n\t\t\t\tvar elementHandlers = handlers[className];\r\n\t\t\t\tfor(var i = 0; i < elementHandlers.length; i++){\r\n\t\t\t\t\tif(elementHandlers[i].root == root){\r\n\t\t\t\t\t\telementHandlers.splice(i, 1);\r\n\t\t\t\t\t\ti--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(!elementHandlers.length){\r\n\t\t\t\t\tdelete handlers[className];\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar domEvents = gantt._createDomEventScope();\r\n\r\n\t\tfunction reset(node){\r\n\r\n\t\t\tdomEvents.detachAll();\r\n\r\n\t\t\tif(node){\r\n\t\t\t\tdomEvents.attach(node, \"click\", onClick);\r\n\t\t\t\tdomEvents.attach(node, \"dblclick\", onDoubleClick);\r\n\t\t\t\tdomEvents.attach(node, \"mousemove\", onMouseMove);\r\n\t\t\t\tdomEvents.attach(node, \"contextmenu\", onContextMenu);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\treturn {\r\n\t\t\treset: reset,\r\n\t\t\tglobal: function(event, classname, handler){\r\n\t\t\t\taddEventTarget(event, classname, handler, null);\r\n\t\t\t},\r\n\t\t\tdelegate: addEventTarget,\r\n\t\t\tdetach: detach,\r\n\t\t\tcallHandler: callHandler,\r\n\t\t\tonDoubleClick: onDoubleClick,\r\n\t\t\tonMouseMove: onMouseMove,\r\n\t\t\tonContextMenu: onContextMenu,\r\n\t\t\tonClick: onClick,\r\n\t\t\tdestructor: function(){\r\n\t\t\t\treset();\r\n\t\t\t\teventHandlers = null;\r\n\t\t\t\tdomEvents = null;\r\n\t\t\t}\r\n\r\n\t\t};\r\n\t};\r\n\r\n})(domHelpers);\r\n\r\n\r\nexport default {\r\n\tinit:createMouseHandler\r\n};","export default function(viewport, box, gantt){\r\n\tif(!box){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(box.left > viewport.x_end || box.left + box.width < viewport.x){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(box.top > viewport.y_end || box.top + box.height < viewport.y){\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\treturn true;\r\n};","export default function(gantt){\r\n\treturn gantt.config.smart_rendering && gantt._smart_render;\r\n};","export default function(item, view, config){\r\n\treturn {\r\n\t\ttop: view.getItemTop(item.id),\r\n\t\theight: view.getItemHeight(item.id),\r\n\t\tleft: 0,\r\n\t\tright: Infinity\r\n\t};\r\n};","export default function getVisibleTasksRange(gantt, view, config, datastore, viewport){\r\n\tvar buffer = 1;\r\n\tvar start = view.getItemIndexByTopPosition(viewport.y) || 0;\r\n\tvar end = view.getItemIndexByTopPosition(viewport.y_end) || datastore.count();\r\n\tvar indexStart = Math.max(0, start - buffer);\r\n\tvar indexEnd =  Math.min(datastore.count(), end + buffer);\r\n\t// GS-2481 and GS-1715, need to take into account selected task when using keyboard shortcuts and when the inline editor is opened \r\n\tconst extraTasksIds= [];\r\n\tif (gantt.config.keyboard_navigation && gantt.getSelectedId()) {\r\n\t\tlet task = gantt.getTask(gantt.getSelectedId());\r\n\t\t// GS-2661 and GS-2835: The selected task shouldn't be a split child \r\n\t\t// and its parent shouldn't be collapsed\r\n\t\tif(task.$expanded_branch && !task.$split_subtask) {\r\n\t\t\textraTasksIds.push(gantt.getSelectedId());\r\n\t\t}\r\n\t}\r\n\tif (gantt.$ui.getView(\"grid\") && gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id) {\r\n\t\tlet inlineEditorId = gantt.ext.inlineEditors.getState().id;\r\n\t\tif (datastore.exists(inlineEditorId)){\r\n\t\t\textraTasksIds.push(inlineEditorId);\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart: indexStart,\r\n\t\tend: indexEnd,\r\n\t\tids: extraTasksIds \r\n\t};\r\n};","import genericViewPortChecker from \"./viewport/is_in_viewport\";\r\nimport isLegacyRender from \"./is_legacy_smart_render\";\r\nimport basicGetRectangle from \"./viewport/get_grid_row_rectangle\";\r\nimport basicGetRange from \"./viewport/get_visible_bars_range\";\r\nvar rendererFactory = function(gantt){\r\n\r\n\t//hash of dom elements is needed to redraw single bar/link\r\n\tvar task_area_pulls = {},\r\n\t\ttask_area_renderers = {};\r\n\r\n\tfunction getView(layer){\r\n\t\tvar view = null;\r\n\t\tif (typeof layer.view === \"string\") {\r\n\t\t\tview = gantt.$ui.getView(layer.view);\r\n\t\t} else if (layer.view) {\r\n\t\t\tview = layer.view;\r\n\t\t}\r\n\t\treturn view;\r\n\t}\r\n\r\n\tfunction getRenderer(id, layer, node) {\r\n\t\t\r\n\t\tif (task_area_renderers[id])\r\n\t\t\treturn task_area_renderers[id];\r\n\r\n\t\tif (!layer.renderer)\r\n\t\t\tgantt.assert(false, \"Invalid renderer call\");\r\n\r\n\t\tvar renderMethod = null;\r\n\t\tvar updateMethod = null;\r\n\t\tvar getRectangle = null;\r\n\t\tvar renderCallbackMethod = null;\r\n\t\tvar specializedViewPortChecker = null;\r\n\r\n\t\tif(typeof layer.renderer === \"function\"){\r\n\t\t\trenderMethod = layer.renderer;\r\n\t\t\tgetRectangle = basicGetRectangle;\r\n\t\t}else{\r\n\t\t\trenderMethod = layer.renderer.render;\r\n\t\t\tupdateMethod = layer.renderer.update;\r\n\t\t\trenderCallbackMethod = layer.renderer.onrender;\r\n\t\t\t\r\n\t\t\tif(layer.renderer.isInViewPort){\r\n\t\t\t\tspecializedViewPortChecker = layer.renderer.isInViewPort;\r\n\t\t\t}else{\r\n\t\t\t\tgetRectangle = layer.renderer.getRectangle;\r\n\t\t\t}\r\n\r\n\t\t\tif (!getRectangle && getRectangle !== null) {\r\n\t\t\t\tgetRectangle = basicGetRectangle;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar filter = layer.filter;\r\n\r\n\t\tif (node)\r\n\t\t\tnode.setAttribute(gantt.config.layer_attribute, true);\r\n\r\n\t\ttask_area_renderers[id] = {\r\n\t\t\trender_item: function (item, container, viewPort, layerView, viewConfig) {\r\n\t\t\t\tcontainer = container || node;\r\n\t\t\t\tif (filter) {\r\n\t\t\t\t\tif (!filter(item)) {\r\n\t\t\t\t\t\tthis.remove_item(item.id);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar view = layerView || getView(layer);\r\n\t\t\t\tvar config = viewConfig || (view ? view.$getConfig() : null);\r\n\t\t\t\tvar rendererViewPort = viewPort;\r\n\t\t\t\tif(!rendererViewPort && config && config.smart_rendering){\r\n\t\t\t\t\trendererViewPort = view.getViewPort();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar dom = null;\r\n\t\t\t\tif(!isLegacyRender(gantt) && (getRectangle || specializedViewPortChecker) && rendererViewPort){\r\n\t\t\t\t\tvar isVisible = false;\r\n\t\t\t\t\tif(specializedViewPortChecker){\r\n\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, rendererViewPort, view, config, gantt);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tisVisible = genericViewPortChecker(rendererViewPort, getRectangle(item, view, config, gantt), gantt);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(isVisible){\r\n\t\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\r\n\t\t\t\t}\r\n\t\t\t\tthis.append(item, dom, container);\r\n\r\n\t\t\t\tvar useBuffer = container.nodeType == 11;//DocumentFragment\r\n\t\t\t\tif(renderCallbackMethod && !useBuffer && dom) {\r\n\t\t\t\t\trenderCallbackMethod.call(gantt, item, dom, view);\r\n\t\t\t\t} \r\n\t\t\t},\r\n\r\n\t\t\tclear: function (container) {\r\n\r\n\t\t\t\tthis.rendered = task_area_pulls[id] = {};\r\n\t\t\t\tif(!layer.append)\r\n\t\t\t\t\tthis.clear_container(container);\r\n\t\t\t},\r\n\t\t\tclear_container: function (container) {\r\n\t\t\t\tcontainer = container || node;\r\n\t\t\t\tif (container){\r\n\t\t\t\t\tcontainer.innerHTML = \"\";\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget_visible_range: function(datastore){\r\n\t\t\t\tvar view = getView(layer);\r\n\t\t\t\tvar viewport;\r\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\r\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\r\n\t\t\t\t\tviewport = view.getViewPort();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar range;\r\n\t\t\t\tif(view && viewport){\r\n\t\t\t\t\tif(typeof layer.renderer === \"function\"){\r\n\t\t\t\t\t\trange = basicGetRange(gantt, view, viewConfig, datastore, viewport);\r\n\t\t\t\t\t}else if(layer.renderer && layer.renderer.getVisibleRange){\r\n\t\t\t\t\t\trange = layer.renderer.getVisibleRange(gantt, view, viewConfig, datastore, viewport);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(!range){\r\n\t\t\t\t\trange = {\r\n\t\t\t\t\t\tstart: 0,\r\n\t\t\t\t\t\tend: datastore.count()\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn range;\r\n\t\t\t},\r\n\t\t\tprepare_data: function(items){\r\n\t\t\t\tif(layer.renderer && layer.renderer.prepareData){\r\n\t\t\t\t\treturn layer.renderer.prepareData(items, gantt, layer);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trender_items: function (items, container) {\r\n\t\t\t\tcontainer = container || node;\r\n\r\n\t\t\t\tvar buffer = document.createDocumentFragment();\r\n\t\t\t\tthis.clear(container);\r\n\r\n\t\t\t\tvar viewPort = null;\r\n\t\t\t\tvar view = getView(layer);\r\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\r\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\r\n\t\t\t\t\tviewPort = view.getViewPort();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\r\n\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontainer.appendChild(buffer, container);\r\n\r\n\t\t\t\tvar itemsSearch = {};\r\n\t\t\t\titems.forEach(function(item){\r\n\t\t\t\t\titemsSearch[item.id] = item;\r\n\t\t\t\t});\r\n\t\t\t\tvar renderedItems = {};\r\n\t\t\t\tif (renderCallbackMethod) {\r\n\t\t\t\t\tvar newElements = {};\r\n\t\t\t\t\tfor(var i in this.rendered) {\r\n\t\t\t\t\t\tif(!renderedItems[i]){\r\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\r\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupdate_items: function (items, container) {\r\n\t\t\t\tvar view = getView(layer);\r\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\r\n\t\t\t\tif(!view || !view.$getConfig().smart_rendering || isLegacyRender(gantt)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!this.rendered){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!(getRectangle || specializedViewPortChecker)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontainer = container || node;\r\n\r\n\t\t\t\tvar buffer = document.createDocumentFragment();\r\n\r\n\t\t\t\tvar viewPort = null;\r\n\t\t\t\tif(view){\r\n\t\t\t\t\tviewPort = view.getViewPort();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar itemsSearch = {};\r\n\t\t\t\titems.forEach(function(item){\r\n\t\t\t\t\titemsSearch[item.id] = item;\r\n\t\t\t\t});\r\n\t\t\t\tvar renderedItems = {};\r\n\r\n\t\t\t\tvar nodesToRemove = {};\r\n\t\t\t\tfor(var i in this.rendered){\r\n\t\t\t\t\tnodesToRemove[i] = true;\r\n\t\t\t\t\trenderedItems[i] = true;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar renderCalledFor = {};\r\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\r\n\t\t\t\t\tvar item = items[i];\r\n\t\t\t\t\tvar itemNode = this.rendered[item.id];\r\n\t\t\t\t\tnodesToRemove[item.id] = false;\r\n\t\t\t\t\tif (itemNode && itemNode.parentNode) {\r\n\t\t\t\t\t\tvar isVisible = false;\r\n\t\t\t\t\t\tif(specializedViewPortChecker){\r\n\t\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, viewPort, view, viewConfig, gantt);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tisVisible = genericViewPortChecker(viewPort, getRectangle(item, view, viewConfig, gantt), gantt);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!isVisible) {\r\n\t\t\t\t\t\t\tnodesToRemove[item.id] = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif(updateMethod){\r\n\t\t\t\t\t\t\t\tupdateMethod.call(gantt, item, itemNode, view, viewConfig, viewPort);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.restore(item, buffer);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trenderCalledFor[items[i].id] = true;\r\n\t\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor(var i in nodesToRemove){\r\n\t\t\t\t\tif(nodesToRemove[i]){\r\n\t\t\t\t\t\tthis.hide(i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(buffer.childNodes.length){\r\n\t\t\t\t\tcontainer.appendChild(buffer, container);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (renderCallbackMethod) {\r\n\t\t\t\t\tvar newElements = {};\r\n\t\t\t\t\tfor(var i in this.rendered) {\r\n\t\t\t\t\t\tif(!renderedItems[i] || renderCalledFor[i]){\r\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\r\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tappend: function (item, node, container) {\r\n\t\t\t\tif(!this.rendered){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!node) {\r\n\t\t\t\t\tif (this.rendered[item.id]) {\r\n\t\t\t\t\t\tthis.remove_item(item.id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.rendered[item.id] && this.rendered[item.id].parentNode) {\r\n\t\t\t\t\tthis.replace_item(item.id, node);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontainer.appendChild(node);\r\n\t\t\t\t}\r\n\t\t\t\tthis.rendered[item.id] = node;\r\n\t\t\t},\r\n\t\t\treplace_item: function (item_id, newNode) {\r\n\t\t\t\tvar item = this.rendered[item_id];\r\n\t\t\t\tif (item && item.parentNode) {\r\n\t\t\t\t\titem.parentNode.replaceChild(newNode, item);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.rendered[item_id] = newNode;\r\n\t\t\t},\r\n\t\t\tremove_item: function (item_id) {\r\n\t\t\t\tthis.hide(item_id);\r\n\t\t\t\tdelete this.rendered[item_id];\r\n\t\t\t},\r\n\t\t\thide: function (item_id) {\r\n\t\t\t\tvar item = this.rendered[item_id];\r\n\t\t\t\tif (item && item.parentNode) {\r\n\t\t\t\t\titem.parentNode.removeChild(item);\r\n\t\t\t\t}\r\n\t\t\t\tdelete this.rendered[item_id];\r\n\t\t\t},\r\n\t\t\trestore: function (item, container) {\r\n\t\t\t\tvar dom = this.rendered[item.id];\r\n\t\t\t\tif (dom) {\r\n\t\t\t\t\tif (!dom.parentNode) {\r\n\t\t\t\t\t\tthis.append(item, dom, container || node);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.render_item(item, container || node);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange_id: function (oldid, newid) {\r\n\t\t\t\tthis.rendered[newid] = this.rendered[oldid];\r\n\t\t\t\tdelete this.rendered[oldid];\r\n\t\t\t},\r\n\t\t\trendered: task_area_pulls[id],\r\n\t\t\tnode: node,\r\n\t\t\tdestructor: function () {\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tdelete task_area_renderers[id];\r\n\t\t\t\tdelete task_area_pulls[id];\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn task_area_renderers[id];\r\n\t}\r\n\r\n\r\n\tfunction clearRenderers() {\r\n\t\tfor (var i in task_area_renderers) {\r\n\t\t\tgetRenderer(i).destructor();\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetRenderer: getRenderer,\r\n\t\tclearRenderers: clearRenderers\r\n\t};\r\n\r\n};\r\n\r\nexport default rendererFactory;","import renderFactoryProvider from \"./render_factory\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\nimport isLegacyRender from \"./is_legacy_smart_render\";\r\n\r\nvar layerFactory = function(gantt){\r\n\r\n\tvar renderFactory = renderFactoryProvider(gantt);\r\n\treturn {\r\n\tcreateGroup: function (getContainer, relativeRoot, defaultFilters, initLayer) {\r\n\r\n\t\tvar renderGroup = {\r\n\t\t\ttempCollection: [],\r\n\t\t\trenderers: {},\r\n\t\t\tcontainer: getContainer,\r\n\t\t\tfilters: [],\r\n\t\t\tgetLayers: function () {\r\n\t\t\t\tthis._add();// add pending layers\r\n\r\n\t\t\t\tvar res = [];\r\n\t\t\t\tfor (var i in this.renderers) {\r\n\t\t\t\t\tres.push(this.renderers[i]);\r\n\t\t\t\t}\r\n\t\t\t\treturn res;\r\n\t\t\t},\r\n\t\t\tgetLayer: function (id) {\r\n\t\t\t\treturn this.renderers[id];\r\n\t\t\t},\r\n\t\t\t_add: function (layer) {\r\n\t\t\t\tif (layer) {\r\n\t\t\t\t\tlayer.id = layer.id || utils.uid();\r\n\t\t\t\t\tthis.tempCollection.push(layer);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst container = this.container();\r\n\t\t\t\tconst pending = this.tempCollection;\r\n\t\t\t\tfor (let i = 0; i < pending.length; i++) {\r\n\t\t\t\t\tlayer = pending[i];\r\n\t\t\t\t\t// GS-2803: in case of Salesforce domHelpers.isChildOf check with document.body doesn't work\r\n\t\t\t\t\t// instead we check it with isConnected property\r\n\t\t\t\t\tif (!this.container() && !(layer && layer.container && layer.container.isConnected)) continue;\r\n\r\n\t\t\t\t\tlet node = layer.container,\r\n\t\t\t\t\t\tid = layer.id,\r\n\t\t\t\t\t\ttopmost = layer.topmost;\r\n\t\t\t\t\tif (!node.parentNode) {\r\n\t\t\t\t\t\t//insert on top or below the tasks\r\n\t\t\t\t\t\tif (topmost) {\r\n\t\t\t\t\t\t\tcontainer.appendChild(node);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet rel = relativeRoot ? relativeRoot() : container.firstChild;\r\n\t\t\t\t\t\t\t// GS-1274: if we don't add the second check, Gantt stops working if\r\n\t\t\t\t\t\t\t// we add the task layer without the timeline and switch to a layout with the timeline\r\n\t\t\t\t\t\t\tif (rel && rel.parentNode == container)\r\n\t\t\t\t\t\t\t\tcontainer.insertBefore(node, rel);\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tcontainer.appendChild(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.renderers[id] = renderFactory.getRenderer(\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tlayer,\r\n\t\t\t\t\t\tnode\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (initLayer) {\r\n\t\t\t\t\t\tinitLayer(layer, gantt);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.tempCollection.splice(i, 1);\r\n\t\t\t\t\ti--;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\taddLayer: function (config) {\r\n\t\t\t\tif(config){\r\n\t\t\t\t\tif(typeof config == \"function\"){\r\n\t\t\t\t\t\tconfig = {renderer: config};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(config.filter === undefined){\r\n\t\t\t\t\t\tconfig.filter = mergeFilters(defaultFilters || []);\r\n\t\t\t\t\t}else if(config.filter instanceof Array){\r\n\t\t\t\t\t\tconfig.filter.push(defaultFilters);\r\n\t\t\t\t\t\tconfig.filter = mergeFilters(config.filter);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!config.container){\r\n\t\t\t\t\t\tconfig.container = document.createElement(\"div\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar self = this;\r\n\t\t\t\t\tconfig.requestUpdate = function(){\r\n\t\t\t\t\t\tif(gantt.config.smart_rendering && !isLegacyRender(gantt)){\r\n\t\t\t\t\t\t\tif(self.renderers[config.id]){\r\n\t\t\t\t\t\t\t\tself.onUpdateRequest(self.renderers[config.id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._add(config);\r\n\t\t\t\treturn (config ? config.id : undefined);\r\n\t\t\t},\r\n\t\t\tonUpdateRequest: function(layer){\r\n\r\n\t\t\t},\r\n\r\n\t\t\teachLayer: function(code){\r\n\t\t\t\tfor (var i in this.renderers) {\r\n\t\t\t\t\tcode(this.renderers[i]);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tremoveLayer: function (id) {\r\n\t\t\t\tif(!this.renderers[id])\r\n\t\t\t\t\treturn;\r\n\t\t\t\tthis.renderers[id].destructor();\r\n\t\t\t\tdelete this.renderers[id];\r\n\t\t\t},\r\n\t\t\tclear: function () {\r\n\t\t\t\tfor (var i in this.renderers) {\r\n\t\t\t\t\tthis.renderers[i].destructor();\r\n\t\t\t\t}\r\n\t\t\t\tthis.renderers = {};\r\n\t\t\t}//,\r\n\t\t\t//prepareConfig: prepareConfig\r\n\t\t};\r\n\r\n\t\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\t\trenderGroup.clear();\r\n\t\t\trenderGroup = null;\r\n\t\t});\r\n\r\n\t\treturn renderGroup;\r\n\t}\r\n};};\r\n\r\n\r\nfunction mergeFilters(filter_methods){\r\n\tif(!(filter_methods instanceof Array)){\r\n\t\tfilter_methods = Array.prototype.slice.call(arguments, 0);\r\n\t}\r\n\r\n\treturn function(obj){\r\n\t\tvar res = true;\r\n\t\tfor(var i = 0, len = filter_methods.length; i < len; i++){\r\n\t\t\tvar filter_method = filter_methods[i];\r\n\t\t\tif(filter_method){\r\n\t\t\t\tres = res && (filter_method(obj.id, obj) !== false);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t};\r\n}\r\n\r\n\r\nexport default layerFactory;\r\n","export default function(item, view, config){\r\n\tif(!item.start_date || !item.end_date){\r\n\t\treturn null;\r\n\t}\r\n\tvar padding = 200;\r\n\tvar startCoord = view.posFromDate(item.start_date);\r\n\tvar endCoord = view.posFromDate(item.end_date);\r\n\tvar left = Math.min(startCoord, endCoord) - padding;\r\n\tvar right = Math.max(startCoord, endCoord) + padding;\r\n\treturn {\r\n\t\ttop: view.getItemTop(item.id),\r\n\t\theight: view.getItemHeight(item.id),\r\n\t\tleft: left,\r\n\t\twidth: right - left\r\n\t};\r\n};","import getLinkRectangle from \"../get_link_rectangle\";\r\n\r\nexport default function(){\r\n\tvar coordinates = [];\r\n\tvar calculated = false;\r\n\r\n\tfunction clearCache(){\r\n\t\tcoordinates = [];\r\n\t\tcalculated = false;\r\n\t}\r\n\r\n\tfunction buildCache(datastore, view, gantt){\r\n\t\tvar config = view.$getConfig();\r\n\t\tvar visibleItems = datastore.getVisibleItems();\r\n\t\t//datastore.eachItem(function(link){\r\n\t\tvisibleItems.forEach(function(link){\r\n\t\t\tvar rec = getLinkRectangle(link, view, config, gantt);\r\n\t\t\tif(!rec){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tcoordinates.push({id: link.id, rec: rec});\r\n\t\t});\r\n\r\n\t\tcoordinates.sort(function(a, b){\r\n\t\t\tif(a.rec.right < b.rec.right){\r\n\t\t\t\treturn -1;\r\n\t\t\t}else {\r\n\t\t\t\treturn 1;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tcalculated = true;\r\n\t}\r\n\r\n\tvar initialized = false;\r\n\tfunction init(datastore){\r\n\t\tif(initialized){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tinitialized = true;\r\n\t\tdatastore.attachEvent(\"onPreFilter\", clearCache);\r\n\t\tdatastore.attachEvent(\"onStoreUpdated\", clearCache);\r\n\t\tdatastore.attachEvent(\"onClearAll\", clearCache);\r\n\t\tdatastore.attachEvent(\"onBeforeStoreUpdate\", clearCache);\r\n\t}\r\n\r\n\treturn function getVisibleLinksRange(gantt, view, config, datastore, viewport){\r\n\t\tinit(datastore);\r\n\t\tif(!calculated){\r\n\t\t\tbuildCache(datastore, view, gantt);\r\n\t\t}\r\n\r\n\t\tvar visibleBoxes = [];\r\n\t\tfor(var i = 0; i < coordinates.length; i++){\r\n\t\t\tvar item = coordinates[i];\r\n\t\t\tvar box = item.rec;\r\n\t\t\tif(box.right < viewport.x){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif(box.left < viewport.x_end && box.right > viewport.x && box.top < viewport.y_end && box.bottom > viewport.y){\r\n\t\t\t\tvisibleBoxes.push(item.id);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\tids: visibleBoxes\r\n\t\t};\r\n\t};\r\n};","\r\n\r\nimport barRectangle from \"./get_bar_rectangle\";\r\n\r\nexport default function getLinkBox(item, view, config, gantt){\r\n\tif(!gantt.isTaskExists(item.source)){\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif(!gantt.isTaskExists(item.target)){\r\n\t\treturn null;\r\n\t}\r\n\tvar sourceBox = barRectangle(gantt.getTask(item.source), view, gantt);\r\n\tvar targetBox = barRectangle(gantt.getTask(item.target), view, gantt);\r\n\r\n\tif(!sourceBox || !targetBox){\r\n\t\treturn null;\r\n\t}\r\n\r\n\tvar padding = 100;\r\n\tvar left = Math.min(sourceBox.left, targetBox.left) - padding;\r\n\tvar right = Math.max(sourceBox.left + sourceBox.width, targetBox.left + targetBox.width) + padding;\r\n\tvar top = Math.min(sourceBox.top, targetBox.top) - padding;\r\n\tvar bottom = Math.max(sourceBox.top + sourceBox.height, targetBox.top + targetBox.height) + padding;\r\n\r\n\treturn {\r\n\t\ttop: top,\r\n\t\theight: bottom - top,\r\n\t\tbottom,\r\n\t\tleft: left,\r\n\t\twidth: right - left,\r\n\t\tright\r\n\t};\r\n};\r\n","\r\n// optimized checker for links smart rendering\r\n\r\n// first check the vertical position since it's easier to calculate\r\n\r\nexport default function isLinkInViewPort(item, viewport, view, config, gantt){\r\n\tvar source = view.$gantt.getTask(item.source);\r\n\tvar target = view.$gantt.getTask(item.target);\r\n\t// check vertical visibility first since it's a lighter check\r\n\tvar sourceTop = view.getItemTop(source.id);\r\n\tvar sourceHeight = view.getItemHeight(source.id);\r\n\r\n\tvar targetTop = view.getItemTop(target.id);\r\n\tvar targetHeight = view.getItemHeight(target.id);\r\n\r\n\tif(viewport.y > sourceTop + sourceHeight &&\r\n\t\tviewport.y > targetTop + targetHeight){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(viewport.y_end < targetTop &&\r\n\t\tviewport.y_end < sourceTop){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar padding = 100;\r\n\tvar sourceLeft = view.posFromDate(source.start_date);\r\n\tvar sourceRight = view.posFromDate(source.end_date);\r\n\tvar targetLeft = view.posFromDate(target.start_date);\r\n\tvar targetRight = view.posFromDate(target.end_date);\r\n\r\n\tif(sourceLeft > sourceRight){\r\n\t\t// rtl\r\n\t\tvar tmp = sourceRight;\r\n\t\tsourceRight = sourceLeft;\r\n\t\tsourceLeft = tmp;\r\n\t}\r\n\tif(targetLeft > targetRight){\r\n\t\t// rtl\r\n\t\tvar tmp = targetRight;\r\n\t\ttargetRight = targetLeft;\r\n\t\ttargetLeft = tmp;\r\n\t}\r\n\tsourceLeft += -padding; // add buffer for custom elements\r\n\tsourceRight += padding;\r\n\ttargetLeft += -padding; // add buffer for custom elements\r\n\ttargetRight += padding;\r\n\r\n\tif(viewport.x > sourceRight &&\r\n\t\tviewport.x > targetRight){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(viewport.x_end < sourceLeft &&\r\n\t\tviewport.x_end < targetLeft){\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n","import createLayerFactory from \"./render/layer_engine\";\r\n\r\nimport getVisibleTaskRange from \"./render/viewport/get_visible_bars_range\";\r\nimport getVisibleLinksRangeFactory from \"./render/viewport/factory/get_visible_link_range\";\r\n\r\nimport isLinkInViewport from \"./render/viewport/is_link_in_viewport\";\r\n\r\nfunction initLayer(layer, gantt){\r\n\tif(!layer.view){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar view = layer.view;\r\n\tif(typeof view === \"string\"){\r\n\t\tview = gantt.$ui.getView(view);\r\n\t}\r\n\r\n\tif(view && view.attachEvent){\r\n\t\tview.attachEvent(\"onScroll\", function(){\r\n\t\t\tvar state = gantt.$services.getService(\"state\");\r\n\t\t\t// don't repaint if we're inside batchUpdate, a complete repaint will be called afterwards\r\n\t\t\tif(!state.getState(\"batchUpdate\").batch_update && !view.$config.$skipSmartRenderOnScroll){\r\n\t\t\t\tif(layer.requestUpdate){\r\n\t\t\t\t\tlayer.requestUpdate();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nvar createLayerEngine = function(gantt){\r\n\tvar factory = createLayerFactory(gantt);\r\n\treturn {\r\n\t\tgetDataRender: function(name){\r\n\t\t\treturn gantt.$services.getService(\"layer:\" + name) || null;\r\n\t\t},\r\n\t\tcreateDataRender: function(config){\r\n\t\t\tvar name = config.name,\r\n\t\t\t\tdefaultContainer = config.defaultContainer,\r\n\t\t\t\tpreviusSiblingContainer = config.defaultContainerSibling;\r\n\r\n\t\t\tvar layers = factory.createGroup(\r\n\t\t\t\tdefaultContainer,\r\n\t\t\t\tpreviusSiblingContainer,\r\n\t\t\t\tfunction(itemId, item){\r\n\t\t\t\t\tif(layers.filters){\r\n\t\t\t\t\t\tfor(var i = 0; i < layers.filters.length; i++){\r\n\t\t\t\t\t\t\tif(layers.filters[i](itemId, item) === false){\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tinitLayer\r\n\t\t\t);\r\n\r\n\t\t\tgantt.$services.setService(\"layer:\" + name, function(){\r\n\t\t\t\treturn layers;\r\n\t\t\t});\r\n\r\n\t\t\tgantt.attachEvent(\"onGanttReady\", function () {\r\n\t\t\t\tlayers.addLayer();// init layers on start\r\n\t\t\t});\r\n\r\n\t\t\treturn layers;\r\n\t\t},\r\n\t\tinit: function(){\r\n\t\t\tvar taskLayers = this.createDataRender({\r\n\t\t\t\tname: \"task\",\r\n\t\t\t\tdefaultContainer: function(){\r\n\t\t\t\t\tif(gantt.$task_data){\r\n\t\t\t\t\t\treturn gantt.$task_data;\r\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\r\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tdefaultContainerSibling: function(){\r\n\t\t\t\t\tif(gantt.$task_links){\r\n\t\t\t\t\t\treturn gantt.$task_links;\r\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\r\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_links;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfilter: function(item){\r\n\r\n\t\t\t\t}\r\n\t\t\t}, gantt);\r\n\r\n\t\t\tvar linkLayers = this.createDataRender({\r\n\t\t\t\tname: \"link\",\r\n\t\t\t\tdefaultContainer: function(){\r\n\t\t\t\t\tif(gantt.$task_data){\r\n\t\t\t\t\t\treturn gantt.$task_data;\r\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\r\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, gantt);\r\n\r\n\t\t\treturn {\r\n\t\t\t\taddTaskLayer: function(config){\r\n\t\t\t\t\tconst rangeFunction = getVisibleTaskRange;\r\n\t\t\t\t\tif(typeof config === \"function\"){\r\n\t\t\t\t\t\tconfig = {\r\n\t\t\t\t\t\t\trenderer: {\r\n\t\t\t\t\t\t\t\trender: config,\r\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\r\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconfig.view = \"timeline\";\r\n\r\n\t\t\t\t\treturn taskLayers.addLayer(config);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_getTaskLayers: function(){\r\n\t\t\t\t\treturn taskLayers.getLayers();\r\n\t\t\t\t},\r\n\t\t\t\tremoveTaskLayer: function(id){\r\n\t\t\t\t\ttaskLayers.removeLayer(id);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_clearTaskLayers: function(){\r\n\t\t\t\t\ttaskLayers.clear();\r\n\t\t\t\t},\r\n\t\t\t\taddLinkLayer: function(config){\r\n\t\t\t\t\tconst rangeFunction = getVisibleLinksRangeFactory();\r\n\t\t\t\t\tif(typeof config === \"function\"){\r\n\t\t\t\t\t\tconfig = {\r\n\t\t\t\t\t\t\trenderer: {\r\n\t\t\t\t\t\t\t\trender: config,\r\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\r\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconfig.view = \"timeline\";\r\n\t\t\t\t\tif(config && config.renderer){\r\n\t\t\t\t\t\tif(!config.renderer.getRectangle && !config.renderer.isInViewPort){\r\n\t\t\t\t\t\t\tconfig.renderer.isInViewPort = isLinkInViewport;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn linkLayers.addLayer(config);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_getLinkLayers: function(){\r\n\t\t\t\t\treturn linkLayers.getLayers();\r\n\t\t\t\t},\r\n\t\t\t\tremoveLinkLayer: function(id){\r\n\t\t\t\t\tlinkLayers.removeLayer(id);\r\n\t\t\t\t},\r\n\r\n\t\t\t\t_clearLinkLayers: function(){\r\n\t\t\t\t\tlinkLayers.clear();\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport default createLayerEngine;","import * as utils from \"../../../utils/utils\";\r\nimport eventable from \"../../../utils/eventable\";\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\n\r\nvar Cell = (function () {\r\n\t\"use strict\";\r\n\r\n\tfunction Cell(parent, config, factory, gantt) {\r\n\t\tif (parent) {\r\n\t\t\tthis.$container = domHelpers.toNode(parent);\r\n\t\t\tthis.$parent = parent;\r\n\t\t}\r\n\t\t// save config\r\n\t\tthis.$config = utils.mixin(config, {\r\n\t\t\theaderHeight: 33\r\n\t\t});\r\n\t\tthis.$gantt = gantt;\r\n\t\tthis.$domEvents = gantt._createDomEventScope();\r\n\t\t// set id\r\n\t\tthis.$id = config.id || \"c\" + utils.uid();\r\n\r\n\t\tthis.$name = \"cell\";\r\n\t\tthis.$factory = factory;\r\n\t\tthis.$externalComponent = null;\r\n\r\n\t\teventable(this);\r\n\r\n\t}\r\n\r\n\tCell.prototype.destructor = function () {\r\n\t\tthis.$parent = this.$container = this.$view = null;\r\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\r\n\t\tmouse.detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\r\n\t\tthis.$domEvents.detachAll();\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\t\tthis.detachAllEvents();\r\n\t};\r\n\tCell.prototype.cell = function (id) {\r\n\t\treturn null;\r\n\t};\r\n\r\n\tCell.prototype.scrollTo = function(left, top){\r\n\r\n\t\t//GS-333 Add a way to scroll the HTML views:\r\n\t\tvar cell = this.$view;\r\n\t\tif (this.$config.html) cell = this.$view.firstChild;\r\n\r\n\t\tif (left*1 == left){\r\n\t\t\tcell.scrollLeft = left;\r\n\t\t}\r\n\t\tif(top*1 == top){\r\n\t\t\tcell.scrollTop = top;\r\n\t\t}\r\n\t};\r\n\r\n\tCell.prototype.clear = function(){\r\n\t\tthis.getNode().innerHTML = \"\";\r\n\t\tthis.getNode().className = \"gantt_layout_content\";\r\n\t\tthis.getNode().style.padding = \"0\";\r\n\t};\r\n\r\n\tCell.prototype.resize = function (final) {\r\n\t\tif (this.$parent) {\r\n\t\t\treturn this.$parent.resize(final);\r\n\t\t}\r\n\r\n\t\tif(final === false){\r\n\t\t\tthis.$preResize = true;\r\n\t\t}\r\n\r\n\t\tvar topCont = this.$container;\r\n\t\tvar x = topCont.offsetWidth;\r\n\t\tvar y = topCont.offsetHeight;\r\n\t\tvar topSize = this.getSize();\r\n\t\tif (topCont === document.body) {\r\n\t\t\tx = document.body.offsetWidth;\r\n\t\t\ty = document.body.offsetHeight;\r\n\t\t}\r\n\t\tif (x < topSize.minWidth) {\r\n\t\t\tx = topSize.minWidth;\r\n\t\t}\r\n\t\tif (x > topSize.maxWidth) {\r\n\t\t\tx = topSize.maxWidth;\r\n\t\t}\r\n\t\tif (y < topSize.minHeight) {\r\n\t\t\ty = topSize.minHeight;\r\n\t\t}\r\n\t\tif (y > topSize.maxHeight) {\r\n\t\t\ty = topSize.maxHeight;\r\n\t\t}\r\n\t\tthis.setSize(x, y);\r\n\r\n\t\tif(!this.$preResize){\r\n\t\t//\tself.callEvent(\"onResize\", [x, y]);\r\n\t\t}\r\n\t\tthis.$preResize = false;\r\n\t};\r\n\r\n\tCell.prototype.hide = function () {\r\n\t\tthis._hide(true);\r\n\t\tthis.resize();\r\n\t};\r\n\tCell.prototype.show = function (force) {\r\n\t\tthis._hide(false);\r\n\t\tif (force && this.$parent) {\r\n\t\t\tthis.$parent.show();\r\n\t\t}\r\n\t\tthis.resize();\r\n\t};\r\n\tCell.prototype._hide = function (mode) {\r\n\t\tif (mode === true && this.$view.parentNode) {\r\n\t\t\tthis.$view.parentNode.removeChild(this.$view);\r\n\t\t}\r\n\t\telse if (mode === false && !this.$view.parentNode) {\r\n\t\t\tvar index = this.$parent.cellIndex(this.$id);\r\n\t\t\tthis.$parent.moveView(this, index);\r\n\t\t}\r\n\t\tthis.$config.hidden = mode;\r\n\t};\r\n\tCell.prototype.$toHTML = function (content, css) {\r\n\t\tif (content === void 0) { content = \"\"; }\r\n\t\tcss = [(css || \"\"), (this.$config.css || \"\")].join(\" \");\r\n\t\tvar obj = this.$config;\r\n\t\tvar header = \"\";\r\n\t\tif (obj.raw) {\r\n\t\t\tcontent = typeof obj.raw === \"string\" ? obj.raw : \"\";\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (!content) {\r\n\t\t\t\tlet renderedElement = null;\r\n\t\t\t\tif(typeof obj.html === \"function\"){\r\n\t\t\t\t\trenderedElement = obj.html();\r\n\t\t\t\t}else{\r\n\t\t\t\t\trenderedElement = obj.html;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(this.$gantt.config.external_render && this.$gantt.config.external_render.isElement(renderedElement)){\r\n\t\t\t\t\tthis.$externalComponent = renderedElement;\r\n\t\t\t\t\trenderedElement = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontent = \"<div class='gantt_layout_content' \"+(css ? \" class='\"+css+\"' \" : \"\")+\" >\" + (renderedElement || \"\") + \"</div>\";\r\n\t\t\t}\r\n\t\t\tif (obj.header) {\r\n\t\t\t\tvar collapseIcon = obj.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\";\r\n\t\t\t\theader = \"<div class='gantt_layout_header'>\" + collapseIcon + \"<div class='gantt_layout_header_content'>\" + obj.header + \"</div></div>\";\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"<div class='gantt_layout_cell \" + css + \"' data-cell-id='\" + this.$id + \"'>\" + header + content + \"</div>\";\r\n\t};\r\n\tCell.prototype.$fill = function (node, parent) {\r\n\t\tthis.$view = node;\r\n\t\tthis.$parent = parent;\r\n\t\tthis.init();\r\n\t};\r\n\tCell.prototype.getNode = function () {\r\n\t\treturn (this.$view.querySelector(\"gantt_layout_cell\") || this.$view);\r\n\t};\r\n\tCell.prototype.init = function () {\r\n\t\t// [NOT-GOOD] code is executed for each component, while it still has only one handler, it is no good\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tthis._headerClickHandler = function(e){\r\n\t\t\tvar cellId = domHelpers.locateAttribute(e, \"data-cell-id\");\r\n\t\t\tif(cellId == self.$id){\r\n\t\t\t\tself.toggle();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\r\n\t\tmouse.delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\r\n\r\n\t\tthis.callEvent(\"onReady\", []);\r\n\t};\r\n\tCell.prototype.toggle = function () {\r\n\t\tthis.$config.collapsed = !this.$config.collapsed;\r\n\t\tthis.resize();\r\n\t};\r\n\tCell.prototype.getSize = function () {\r\n\t\tvar size = {\r\n\t\t\theight: this.$config.height || 0,\r\n\t\t\twidth: this.$config.width || 0,\r\n\t\t\tgravity: this.$config.gravity || 1,\r\n\t\t\tminHeight: this.$config.minHeight || 0,\r\n\t\t\tminWidth: this.$config.minWidth || 0,\r\n\t\t\tmaxHeight: this.$config.maxHeight || 100000000000,\r\n\t\t\tmaxWidth: this.$config.maxWidth || 100000000000\r\n\t\t};\r\n\t\tif (this.$config.collapsed) {\r\n\t\t\tvar mode = this.$config.mode === \"x\";\r\n\t\t\tsize[mode ? \"width\" : \"height\"] = size[mode ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\r\n\t\t}\r\n\t\treturn size;\r\n\t};\r\n\r\n\tCell.prototype.getContentSize = function(){\r\n\r\n\t\tvar width = this.$lastSize.contentX;\r\n\t\tif(width !== width*1){\r\n\t\t\twidth = this.$lastSize.width;\r\n\t\t}\r\n\r\n\t\tvar height = this.$lastSize.contentY;\r\n\t\tif(height !== height*1){\r\n\t\t\theight = this.$lastSize.height;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\twidth: width,\r\n\t\t\theight: height\r\n\t\t};\r\n\t};\r\n\r\n\tCell.prototype._getBorderSizes = function(){\r\n\t\tvar borders = {\r\n\t\t\ttop: 0,\r\n\t\t\tright: 0,\r\n\t\t\tbottom: 0,\r\n\t\t\tleft: 0,\r\n\t\t\thorizontal: 0,\r\n\t\t\tvertical: 0\r\n\t\t};\r\n\t\tif(this._currentBorders){\r\n\t\t\tif(this._currentBorders[this._borders.left]){\r\n\t\t\t\tborders.left = 1;\r\n\t\t\t\tborders.horizontal++;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._currentBorders[this._borders.right]){\r\n\t\t\t\tborders.right = 1;\r\n\t\t\t\tborders.horizontal++;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._currentBorders[this._borders.top]){\r\n\t\t\t\tborders.top = 1;\r\n\t\t\t\tborders.vertical++;\r\n\t\t\t}\r\n\r\n\t\t\tif(this._currentBorders[this._borders.bottom]){\r\n\t\t\t\tborders.bottom = 1;\r\n\t\t\t\tborders.vertical++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn borders;\r\n\r\n\t};\r\n\r\n\tCell.prototype.setSize = function (x, y) {\r\n\t\tthis.$view.style.width = x + \"px\";\r\n\t\tthis.$view.style.height = y + \"px\";\r\n\r\n\t\tvar borders = this._getBorderSizes();\r\n\t\tvar contentY = y - borders.vertical;\r\n\t\tvar contentX = x - borders.horizontal;\r\n\r\n\t\tthis.$lastSize = { x: x, y: y, contentX: contentX, contentY: contentY };\r\n\t\tif (this.$config.header) {\r\n\t\t\tthis._sizeHeader();\r\n\t\t}else{\r\n\t\t\tthis._sizeContent();\r\n\t\t}\r\n\t};\r\n\r\n\tCell.prototype._borders = {\r\n\t\t\"left\":\"gantt_layout_cell_border_left\",\r\n\t\t\"right\":\"gantt_layout_cell_border_right\",\r\n\t\t\"top\":\"gantt_layout_cell_border_top\",\r\n\t\t\"bottom\":\"gantt_layout_cell_border_bottom\"\r\n\t};\r\n\r\n\tCell.prototype._setBorders = function(css, view){\r\n\t\tif(!view) {\r\n\t\t\tview = this;\r\n\t\t}\r\n\t\tvar node = view.$view;\r\n\r\n\t\tfor( var i in this._borders){\r\n\t\t\tdomHelpers.removeClassName(node, this._borders[i]);\r\n\t\t}\r\n\r\n\t\tif(typeof css == \"string\"){\r\n\t\t\tcss = [css];\r\n\t\t}\r\n\r\n\t\tvar cssHash = {};\r\n\r\n\t\tfor(var i = 0; i < css.length; i++){\r\n\t\t\tdomHelpers.addClassName(node, css[i]);\r\n\t\t\tcssHash[css[i]] = true;\r\n\t\t}\r\n\r\n\t\tview._currentBorders = cssHash;\r\n\t};\r\n\r\n\r\n\tCell.prototype._sizeContent = function(){\r\n\t\tvar content = this.$view.childNodes[0];\r\n\t\tif(content && content.className == \"gantt_layout_content\"){\r\n\t\t\tcontent.style.height = this.$lastSize.contentY + \"px\";\r\n\t\t}\r\n\t};\r\n\r\n\tCell.prototype._sizeHeader = function () {\r\n\t\tvar size = this.$lastSize;\r\n\t\tsize.contentY -= this.$config.headerHeight;\r\n\t\tvar header = this.$view.childNodes[0];\r\n\t\tvar content = this.$view.childNodes[1];\r\n\t\tvar xLayout = this.$config.mode === \"x\";\r\n\t\tif (this.$config.collapsed) {\r\n\t\t\tcontent.style.display = \"none\";\r\n\t\t\tif (xLayout) {\r\n\t\t\t\theader.className = \"gantt_layout_header collapsed_x\";\r\n\t\t\t\theader.style.width = size.y + \"px\";\r\n\t\t\t\tvar d = Math.floor(size.y / 2 - size.x / 2);\r\n\t\t\t\theader.style.transform = \"rotate(90deg) translate(\" + d + \"px, \" + d + \"px)\";\r\n\t\t\t\tcontent.style.display = \"none\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\theader.className = \"gantt_layout_header collapsed_y\";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (xLayout) {\r\n\t\t\t\theader.className = \"gantt_layout_header\";\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\theader.className = \"gantt_layout_header vertical\";\r\n\t\t\t}\r\n\t\t\theader.style.width = 'auto';\r\n\t\t\theader.style.transform = '';\r\n\t\t\tcontent.style.display = \"\";\r\n\t\t\tcontent.style.height = size.contentY + \"px\";\r\n\t\t}\r\n\t\theader.style.height = this.$config.headerHeight + \"px\";\r\n\t};\r\n\treturn Cell;\r\n}());\r\n\r\nexport default Cell;\r\n","export default function (d, b) {\r\n\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\tfunction __() { this.constructor = d; }\r\n\td.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n};","import __extends from \"../../../utils/extends\";\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\nimport Cell from \"./cell\";\r\n\r\nvar Layout = (function (_super) {\r\n\t\"use strict\";\r\n\r\n\t__extends(Layout, _super);\r\n\tfunction Layout(parent, config, factory) {\r\n\t\tvar _this = _super.apply(this, arguments) || this;\r\n\r\n\t\tif(parent)\r\n\t\t\t_this.$root = true;\r\n\r\n\t\t_this._parseConfig(config);\r\n\t\t_this.$name = \"layout\";\r\n\t\treturn _this;\r\n\t}\r\n\r\n\tLayout.prototype.destructor = function () {\r\n\t\tif (this.$container && this.$view) {\r\n\t\t\tdomHelpers.removeNode(this.$view);\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\tvar child = this.$cells[i];\r\n\t\t\tchild.destructor();\r\n\t\t}\r\n\t\tthis.$cells = [];\r\n\r\n\t\t_super.prototype.destructor.call(this);\r\n\t};\r\n\r\n\tLayout.prototype._resizeScrollbars = function(autosize, scrollbars){\r\n\t\tvar scrollChanged = false;\r\n\t\tvar visibleScrollbars = [],\r\n\t\t\thiddenScrollbars = [];\r\n\r\n\t\tconst scrollbarsToHide = [];\r\n\r\n\t\tfunction showScrollbar(scrollbar){\r\n\t\t\tscrollbar.$parent.show();\r\n\t\t\tscrollChanged = true;\r\n\t\t\tvisibleScrollbars.push(scrollbar);\r\n\t\t}\r\n\t\tfunction hideScrollbar(scrollbar){\r\n\t\t\tscrollbar.$parent.hide();\r\n\t\t\tscrollChanged = true;\r\n\t\t\thiddenScrollbars.push(scrollbar);\r\n\t\t}\r\n\r\n\t\tvar scrollbar;\r\n\t\tfor(var i = 0; i < scrollbars.length; i++){\r\n\t\t\tscrollbar = scrollbars[i];\r\n\r\n\t\t\tif(autosize[scrollbar.$config.scroll]) {\r\n\t\t\t\thideScrollbar(scrollbar);\r\n\t\t\t}else if(scrollbar.shouldHide()){\r\n\t\t\t\t//hideScrollbar(scrollbar);\r\n\t\t\t\tscrollbarsToHide.push(scrollbar);\r\n\t\t\t}else if(scrollbar.shouldShow()){\r\n\t\t\t\tshowScrollbar(scrollbar);\r\n\t\t\t}else{\r\n\t\t\t\tif(scrollbar.isVisible()){\r\n\t\t\t\t\tvisibleScrollbars.push(scrollbar);\r\n\t\t\t\t}else{\r\n\t\t\t\t\thiddenScrollbars.push(scrollbar);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar visibleGroups = {};\r\n\t\tfor(var i = 0; i < visibleScrollbars.length; i++){\r\n\t\t\tif(visibleScrollbars[i].$config.group){\r\n\t\t\t\tvisibleGroups[visibleScrollbars[i].$config.group] = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// GS-2220\r\n\t\tscrollbarsToHide.forEach(function(scrollbar){\r\n\t\t\tif(!(scrollbar.$config.group && visibleGroups[scrollbar.$config.group])){\r\n\t\t\t\thideScrollbar(scrollbar);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tfor(var i = 0; i < hiddenScrollbars.length; i++){\r\n\t\t\tscrollbar = hiddenScrollbars[i];\r\n\r\n\t\t\tif(scrollbar.$config.group && visibleGroups[scrollbar.$config.group]){\r\n\t\t\t\tshowScrollbar(scrollbar);\r\n\t\t\t\t// GS-707 If the scrollbar was hidden then showed, the container resize shouldn't happen because of that\r\n\t\t\t\tfor(var j = 0; j < visibleScrollbars.length; j++){\r\n\t\t\t\t\tif(visibleScrollbars[j] == scrollbar){\r\n\t\t\t\t\t\tthis.$gantt.$scrollbarRepaint = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn scrollChanged;\r\n\t};\r\n\r\n\tLayout.prototype.getScrollbarsInfo = function(){\r\n\t\tconst scrollbars = this.getCellsByType(\"scroller\");\r\n\t\tconst scrollbarsInfo = [];\r\n\t\tscrollbars.forEach(scrollbar => {\r\n\t\t\tlet obj = {};\r\n\t\t\tconst {visible, direction, size, scrollSize, position} = scrollbar.getScrollState();\r\n\t\t\tlet linkedViews = scrollbar._getLinkedViews();\r\n\t\t\tlet boundViews = linkedViews.map(view => view.$config.id);\r\n\r\n\t\t\tobj.id = scrollbar.$id;\r\n\t\t\tobj.visible = visible;\r\n\t\t\tobj.boundViews = boundViews;\r\n\t\t\tif(direction === \"x\"){\r\n\t\t\t\tobj.x = size;\r\n\t\t\t\tobj.x_inner = scrollSize;\r\n\t\t\t\tobj.x_pos = position || 0;\r\n\t\t\t} else {\r\n\t\t\t\tobj.y = size;\r\n\t\t\t\tobj.y_inner = scrollSize;\r\n\t\t\t\tobj.y_pos = position || 0;\r\n\t\t\t}\r\n\t\t\tscrollbarsInfo.push(obj);\r\n\t\t});\r\n\t\treturn scrollbarsInfo;\r\n\t};\r\n\r\n\tLayout.prototype._syncCellSizes = function(groupName, newSize){\r\n\t\tif(!groupName)\r\n\t\t\treturn;\r\n\r\n\t\tvar groups = {};\r\n\r\n\t\tthis._eachChild(function(cell){\r\n\t\t\tif(cell.$config.group && cell.$name != \"scrollbar\" && cell.$name != \"resizer\"){\r\n\t\t\t\tif(!groups[cell.$config.group]){\r\n\t\t\t\t\tgroups[cell.$config.group] = [];\r\n\t\t\t\t}\r\n\t\t\t\tgroups[cell.$config.group].push(cell);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif(groups[groupName]){\r\n\t\t\tthis._syncGroupSize(groups[groupName], newSize);\r\n\t\t}\r\n\t\treturn groups[groupName];\r\n\t};\r\n\r\n\tLayout.prototype._syncGroupSize = function(cells, newSize){\r\n\t\tif(!cells.length) return;\r\n\r\n\t\tvar property = cells[0].$parent._xLayout ? \"width\" : \"height\";\r\n\t\tvar direction = cells[0].$parent.getNextSibling(cells[0].$id) ? 1 : -1;\r\n\r\n\t\tvar newSizeValue = newSize.value;\r\n\t\tvar isGravity = newSize.isGravity;\r\n\t\tfor(var i = 0; i < cells.length; i++){\r\n\t\t\tvar ownSize = cells[i].getSize();\r\n\r\n\t\t\tvar resizeSibling = direction > 0 ? cells[i].$parent.getNextSibling(cells[i].$id) : cells[i].$parent.getPrevSibling(cells[i].$id);\r\n\t\t\tif(resizeSibling.$name == \"resizer\"){\r\n\t\t\t\tresizeSibling = direction > 0 ? resizeSibling.$parent.getNextSibling(resizeSibling.$id) : resizeSibling.$parent.getPrevSibling(resizeSibling.$id);\r\n\t\t\t}\r\n\t\t\tvar siblingSize = resizeSibling.getSize();\r\n\r\n\t\t\tif(!isGravity) {\r\n\t\t\t\tif(resizeSibling[property]){\r\n\t\t\t\t\tvar totalGravity = ownSize.gravity + siblingSize.gravity;\r\n\t\t\t\t\tvar totalSize = ownSize[property] + siblingSize[property];\r\n\t\t\t\t\tvar k = totalGravity / totalSize;\r\n\t\t\t\t\tcells[i].$config.gravity = k * newSizeValue;\r\n\r\n\t\t\t\t\tresizeSibling.$config[property] = totalSize - newSizeValue;\r\n\t\t\t\t\tresizeSibling.$config.gravity = totalGravity - k * newSizeValue;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tcells[i].$config[property] = newSizeValue;\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tcells[i].$config.gravity = newSizeValue;\r\n\t\t\t}\r\n\r\n\t\t\tvar mainGrid = this.$gantt.$ui.getView(\"grid\");\r\n\t\t\tif(mainGrid && cells[i].$content === mainGrid && !mainGrid.$config.scrollable && !isGravity){\r\n\t\t\t\tthis.$gantt.config.grid_width = newSizeValue;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype.resize = function(startStage){\r\n\t\tvar mainCall = false;\r\n\t\tif(this.$root && !this._resizeInProgress){\r\n\t\t\tthis.callEvent(\"onBeforeResize\", []);\r\n\t\t\tmainCall = true;\r\n\t\t\tthis._resizeInProgress = true;\r\n\t\t}\r\n\r\n\t\t_super.prototype.resize.call(this, true);\r\n\t\t_super.prototype.resize.call(this, false);\r\n\r\n\t\tif(mainCall){\r\n\r\n\t\t\tvar contentViews = [];\r\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewCell\"));\r\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewLayout\"));\r\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"hostCell\"));\r\n\r\n\t\t\tvar scrollbars = this.getCellsByType(\"scroller\");\r\n\r\n\t\t\tfor(var i = 0; i < contentViews.length; i++){\r\n\t\t\t\tif(!contentViews[i].$config.hidden)\r\n\t\t\t\t\tcontentViews[i].setContentSize();\r\n\t\t\t}\r\n\r\n\t\t\tvar autosize = this._getAutosizeMode(this.$config.autosize);\r\n\r\n\t/* // possible to rollback set content size when autisize is disabled, not sure if need to\r\n\t\t\tcontentViews.forEach(function(view){\r\n\t\t\t\tconst parent = view.$parent;\r\n\t\t\t\tif(!autosize.x){\r\n\t\t\t\t\tif(parent.$config.$originalWidthStored){\r\n\t\t\t\t\t\tparent.$config.$originalWidthStored = false;\r\n\t\t\t\t\t\tparent.$config.width = parent.$config.$originalWidth;\r\n\t\t\t\t\t\tparent.$config.$originalWidth = undefined;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!autosize.y){\r\n\t\t\t\t\tif(parent.$config.$originalHeightStored){\r\n\t\t\t\t\t\tparent.$config.$originalHeightStored = false;\r\n\t\t\t\t\t\tparent.$config.height = parent.$config.$originalHeight;\r\n\t\t\t\t\t\tparent.$config.$originalHeight = undefined;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});*/\r\n\t\t\t\r\n\t\t\tvar scrollChanged = this._resizeScrollbars(autosize, scrollbars);\r\n\r\n\t\t\tif(this.$config.autosize){\r\n\t\t\t\tthis.autosize(this.$config.autosize);\r\n\t\t\t\tcontentViews.forEach(function(view){\r\n\t\t\t\t\tconst parent = view.$parent;\r\n\t\t\t\t\tconst sizes = parent.getContentSize(autosize);\r\n\t\t\t\t\tif(autosize.x){\r\n\t\t\t\t\t\tif(!parent.$config.$originalWidthStored){\r\n\t\t\t\t\t\t\tparent.$config.$originalWidthStored = true;\r\n\t\t\t\t\t\t\tparent.$config.$originalWidth = parent.$config.width;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparent.$config.width = sizes.width;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(autosize.y){\r\n\t\t\t\t\t\tif(!parent.$config.$originalHeightStored){\r\n\t\t\t\t\t\t\tparent.$config.$originalHeightStored = true;\r\n\t\t\t\t\t\t\tparent.$config.$originalHeight = parent.$config.height;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparent.$config.height = sizes.height;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tscrollChanged = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(scrollChanged){\r\n\t\t\t\tthis.resize();\r\n\t\t\t\tfor(var i = 0; i < contentViews.length; i++){\r\n\t\t\t\t\tif(!contentViews[i].$config.hidden)\r\n\t\t\t\t\t\tcontentViews[i].setContentSize();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.callEvent(\"onResize\", []);\r\n\t\t}\r\n\t\tif(mainCall){\r\n\t\t\tthis._resizeInProgress = false;\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype._eachChild = function(code, cell){\r\n\t\tcell = cell || this;\r\n\t\tcode(cell);\r\n\t\tif(cell.$cells){\r\n\t\t\tfor(var i = 0; i < cell.$cells.length; i++){\r\n\t\t\t\tthis._eachChild(code, cell.$cells[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype.isChild = function(view){\r\n\t\tvar res = false;\r\n\t\tthis._eachChild(function(child){\r\n\t\t\tif(child === view || child.$content === view){\r\n\t\t\t\tres = true;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn res;\r\n\t};\r\n\r\n\tLayout.prototype.getCellsByType = function(type){\r\n\t\tvar res = [];\r\n\t\tif(type === this.$name){\r\n\t\t\tres.push(this);\r\n\t\t}\r\n\r\n\t\tif(this.$content && this.$content.$name == type){\r\n\t\t\tres.push(this.$content);\r\n\t\t}\r\n\r\n\t\tif(this.$cells){\r\n\t\t\tfor(var i = 0; i < this.$cells.length; i++){\r\n\t\t\t\tvar children = Layout.prototype.getCellsByType.call(this.$cells[i], type);\r\n\t\t\t\tif(children.length){\r\n\t\t\t\t\tres.push.apply(res, children);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\tLayout.prototype.getNextSibling = function(cellId){\r\n\t\tvar index = this.cellIndex(cellId);\r\n\t\tif(index >= 0 && this.$cells[index + 1]){\r\n\t\t\treturn this.$cells[index + 1];\r\n\t\t}else{\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype.getPrevSibling = function(cellId){\r\n\t\tvar index = this.cellIndex(cellId);\r\n\t\tif(index >= 0 && this.$cells[index - 1]){\r\n\t\t\treturn this.$cells[index - 1];\r\n\t\t}else{\r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tLayout.prototype.cell = function (id) {\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\tvar child = this.$cells[i];\r\n\t\t\tif (child.$id === id) {\r\n\t\t\t\treturn child;\r\n\t\t\t}\r\n\t\t\tvar sub = child.cell(id);\r\n\t\t\tif (sub) {\r\n\t\t\t\treturn sub;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tLayout.prototype.cellIndex = function (id) {\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\tif (this.$cells[i].$id === id) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t};\r\n\tLayout.prototype.moveView = function (view, ind) {\r\n\t\tif (this.$cells[ind] !== view) {\r\n\t\t\treturn window.alert(\"Not implemented\");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tind += this.$config.header ? 1 : 0;\r\n\t\t\tvar node = this.$view;\r\n\t\t\tif (ind >= node.childNodes.length) {\r\n\t\t\t\tnode.appendChild(view.$view);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnode.insertBefore(view.$view, node.childNodes[ind]);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tLayout.prototype._parseConfig = function (config) {\r\n\t\tthis.$cells = [];\r\n\t\tthis._xLayout = !config.rows;\r\n\t\tvar cells = config.rows || config.cols || config.views;\r\n\t\tfor (var i = 0; i < cells.length; i++) {\r\n\t\t\tvar cell = cells[i];\r\n\t\t\tcell.mode = this._xLayout ? \"x\" : \"y\";\r\n\t\t\tvar $content = this.$factory.initUI(cell, this);\r\n\t\t\tif(!$content){\r\n\t\t\t\tcells.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}else{\r\n\t\t\t\t$content.$parent = this;\r\n\t\t\t\tthis.$cells.push($content);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tLayout.prototype.getCells = function () {\r\n\t\treturn this.$cells;\r\n\t};\r\n\tLayout.prototype.render = function () {\r\n\t\tvar view = domHelpers.insertNode(this.$container, this.$toHTML());\r\n\r\n\t\tthis.$fill(view, null);\r\n\r\n\t\tconst gantt = this.$gantt;\r\n\t\tthis._eachChild((cell) => {\r\n\t\t\tif(cell.$externalComponent){\r\n\t\t\t\tgantt.config.external_render.renderElement(\r\n\t\t\t\t\tcell.$externalComponent, \r\n\t\t\t\t\tcell.$view.querySelector(\".gantt_layout_content\")\r\n\t\t\t\t);\r\n\t\t\t\tcell.$externalComponent = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.callEvent(\"onReady\", []);\r\n\t\tthis.resize();\r\n\r\n\t\t// do simple repaint after the first call\r\n\t\tthis.render = this.resize;\r\n\t};\r\n\tLayout.prototype.$fill = function (node, parent) {\r\n\t\tthis.$view = node;\r\n\t\tthis.$parent = parent;\r\n\t\tvar cells = domHelpers.getChildNodes(node, \"gantt_layout_cell\");\r\n\t\tfor (var i = cells.length - 1; i >= 0; i--) {\r\n\t\t\tvar sub = this.$cells[i];\r\n\t\t\tsub.$fill(cells[i], this);\r\n\t\t\t// initially hidden cell\r\n\t\t\tif (sub.$config.hidden) {\r\n\t\t\t\tsub.$view.parentNode.removeChild(sub.$view);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tLayout.prototype.$toHTML = function () {\r\n\t\tvar mode = this._xLayout ? \"x\" : \"y\";\r\n\t\tvar html = [];\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\thtml.push(this.$cells[i].$toHTML());\r\n\t\t}\r\n\t\treturn _super.prototype.$toHTML.call(this, html.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + mode);\r\n\t};\r\n\r\n\tLayout.prototype.getContentSize = function(mode){\r\n\t\tvar contentWidth = 0,\r\n\t\t\tcontentHeight = 0;\r\n\r\n\t\tvar cellSize, cell, borders;\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\tcell = this.$cells[i];\r\n\t\t\tif(cell.$config.hidden)\r\n\t\t\t\tcontinue;\r\n\r\n\t\t\tcellSize = cell.getContentSize(mode);\r\n\r\n\t\t\tif(cell.$config.view === \"scrollbar\" && mode[cell.$config.scroll]){\r\n\t\t\t\tcellSize.height = 0;\r\n\t\t\t\tcellSize.width = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif(cell.$config.resizer){\r\n\t\t\t\tif(this._xLayout){\r\n\t\t\t\t\tcellSize.height = 0;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tcellSize.width = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tborders = cell._getBorderSizes();\r\n\r\n\t\t\tif(this._xLayout){\r\n\t\t\t\tcontentWidth += (cellSize.width + borders.horizontal);\r\n\t\t\t\tcontentHeight = Math.max(contentHeight, (cellSize.height + borders.vertical));\r\n\t\t\t}else{\r\n\t\t\t\tcontentWidth = Math.max(contentWidth, cellSize.width + borders.horizontal);\r\n\t\t\t\tcontentHeight += cellSize.height + borders.vertical;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tborders = this._getBorderSizes();\r\n\t\tcontentWidth += borders.horizontal;\r\n\t\tcontentHeight += borders.vertical;\r\n\r\n\t\t// GS-149 & GS-150: By default this code only increases the container sizes, because of that, the cell sizes\r\n\t\t// are also increased. Keep this code here in the case if something goes wrong\r\n\t\t/*\r\n\t\tif(this.$root){\r\n\t\t\tcontentWidth += 1;\r\n\t\t\tcontentHeight += 1;\r\n\t\t}\r\n\t\t*/\r\n\t\treturn {\r\n\t\t\twidth: contentWidth,\r\n\t\t\theight: contentHeight\r\n\t\t};\r\n\t};\r\n\r\n\tLayout.prototype._cleanElSize = function(value){\r\n\t\treturn ((value || \"\").toString().replace(\"px\", \"\") * 1 || 0);\r\n\t};\r\n\tLayout.prototype._getBoxStyles = function(div){\r\n\t\tvar computed = null;\r\n\t\tif(window.getComputedStyle){\r\n\t\t\tcomputed = window.getComputedStyle(div, null);\r\n\t\t}else{\r\n\t\t\t//IE with elem.currentStyle does not calculate sizes from %, so will use the default approach\r\n\t\t\tcomputed = {\r\n\t\t\t\t\"width\":div.clientWidth,\r\n\t\t\t\t\"height\":div.clientHeight\r\n\t\t\t};\r\n\t\t}\r\n\t\tvar properties = [\r\n\t\t\t\"width\",\r\n\t\t\t\"height\",\r\n\r\n\t\t\t\"paddingTop\",\r\n\t\t\t\"paddingBottom\",\r\n\t\t\t\"paddingLeft\",\r\n\t\t\t\"paddingRight\",\r\n\r\n\t\t\t\"borderLeftWidth\",\r\n\t\t\t\"borderRightWidth\",\r\n\t\t\t\"borderTopWidth\",\r\n\t\t\t\"borderBottomWidth\"\r\n\t\t];\r\n\t\tvar styles = {\r\n\t\t\tboxSizing:(computed.boxSizing == \"border-box\")\r\n\t\t};\r\n\r\n\t\tif(computed.MozBoxSizing){\r\n\t\t\tstyles.boxSizing = (computed.MozBoxSizing == \"border-box\");\r\n\t\t}\r\n\t\tfor(var i =0; i < properties.length; i++){\r\n\t\t\tstyles[properties[i]] = computed[properties[i]] ? this._cleanElSize(computed[properties[i]]) : 0;\r\n\t\t}\r\n\r\n\r\n\t\tvar box = {\r\n\t\t\thorPaddings : (styles.paddingLeft + styles.paddingRight + styles.borderLeftWidth + styles.borderRightWidth),\r\n\t\t\tvertPaddings : (styles.paddingTop + styles.paddingBottom + styles.borderTopWidth + styles.borderBottomWidth),\r\n\t\t\tborderBox: styles.boxSizing,\r\n\t\t\tinnerWidth : styles.width,\r\n\t\t\tinnerHeight : styles.height,\r\n\t\t\touterWidth : styles.width,\r\n\t\t\touterHeight : styles.height\r\n\t\t};\r\n\r\n\r\n\t\tif(box.borderBox){\r\n\t\t\tbox.innerWidth -= box.horPaddings;\r\n\t\t\tbox.innerHeight -= box.vertPaddings;\r\n\t\t}else{\r\n\t\t\tbox.outerWidth += box.horPaddings;\r\n\t\t\tbox.outerHeight += box.vertPaddings;\r\n\t\t}\r\n\r\n\t\treturn box;\r\n\t};\r\n\r\n\tLayout.prototype._getAutosizeMode = function(config){\r\n\t\tvar res = {x:false, y:false};\r\n\t\tif(config === \"xy\"){\r\n\t\t\tres.x = res.y = true;\r\n\t\t}else if(config === \"y\" || config === true){\r\n\t\t\tres.y = true;\r\n\t\t}else if(config === \"x\"){\r\n\t\t\tres.x = true;\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\tLayout.prototype.autosize = function(mode) {\r\n\t\tvar res = this._getAutosizeMode(mode);\r\n\t\tvar boxSizes = this._getBoxStyles(this.$container);\r\n\t\tvar contentSizes = this.getContentSize(mode);\r\n\r\n\t\tvar node = this.$container;\r\n\t\tif(res.x){\r\n\t\t\tif(boxSizes.borderBox){\r\n\t\t\t\tcontentSizes.width += boxSizes.horPaddings;\r\n\t\t\t}\r\n\t\t\tnode.style.width = contentSizes.width + \"px\";\r\n\t\t}\r\n\t\tif(res.y){\r\n\t\t\tif(boxSizes.borderBox){\r\n\t\t\t\tcontentSizes.height += boxSizes.vertPaddings;\r\n\t\t\t}\r\n\t\t\tnode.style.height = contentSizes.height + \"px\";\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype.getSize = function () {\r\n\t\tthis._sizes = [];\r\n\t\tvar width = 0;\r\n\t\tvar minWidth = 0;\r\n\t\tvar maxWidth = 100000000000;\r\n\t\tvar height = 0;\r\n\t\tvar maxHeight = 100000000000;\r\n\t\tvar minHeight = 0;\r\n\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\r\n\t\t\tvar size = this._sizes[i] = this.$cells[i].getSize();\r\n\t\t\tif (this.$cells[i].$config.hidden) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (this._xLayout) {\r\n\t\t\t\tif (!size.width && size.minWidth) {\r\n\t\t\t\t\twidth += size.minWidth;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\twidth += size.width;\r\n\t\t\t\t}\r\n\t\t\t\tmaxWidth += size.maxWidth;\r\n\t\t\t\tminWidth += size.minWidth;\r\n\t\t\t\theight = Math.max(height, size.height);\r\n\t\t\t\tmaxHeight = Math.min(maxHeight, size.maxHeight); // min of maxHeight\r\n\t\t\t\tminHeight = Math.max(minHeight, size.minHeight); // max of minHeight\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!size.height && size.minHeight) {\r\n\t\t\t\t\theight += size.minHeight;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\theight += size.height;\r\n\t\t\t\t}\r\n\t\t\t\tmaxHeight += size.maxHeight;\r\n\t\t\t\tminHeight += size.minHeight;\r\n\t\t\t\twidth = Math.max(width, size.width);\r\n\t\t\t\tmaxWidth = Math.min(maxWidth, size.maxWidth); // min of maxWidth\r\n\t\t\t\tminWidth = Math.max(minWidth, size.minWidth); // max of minWidth\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar self = _super.prototype.getSize.call(this);\r\n\t\t// maxWidth\r\n\t\tif (self.maxWidth >= 100000) {\r\n\t\t\tself.maxWidth = maxWidth;\r\n\t\t}\r\n\t\t// maxHeight\r\n\t\tif (self.maxHeight >= 100000) {\r\n\t\t\tself.maxHeight = maxHeight;\r\n\t\t}\r\n\t\t// minWidth\r\n\t\tself.minWidth = self.minWidth !== self.minWidth ? 0 : self.minWidth;// || self.width || Math.max(minWidth, width);\r\n\t\t// minHeight\r\n\t\tself.minHeight = self.minHeight !== self.minHeight ? 0 : self.minHeight;//self.minHeight || self.height || Math.max(minHeight, height);\r\n\t\t// sizes with paddings and margins\r\n\t\tif (this._xLayout) {\r\n\t\t\tself.minWidth += this.$config.margin * (this.$cells.length) || 0;\r\n\t\t\tself.minWidth += this.$config.padding * 2 || 0;\r\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tself.minHeight += this.$config.margin * (this.$cells.length) || 0;\r\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\r\n\t\t}\r\n\t\t\r\n\t\treturn self;\r\n\t};\r\n\t// calc total gravity and free space\r\n\tLayout.prototype._calcFreeSpace = function (s, cell, xLayout) {\r\n\t\tvar min = xLayout ? cell.minWidth : cell.minHeight;\r\n\t\tvar max = xLayout ? cell.maxWidth : cell.maxWidth;\r\n\t\tvar side = s;\r\n\t\tif (!side) {\r\n\t\t\tside = Math.floor(this._free / this._gravity * cell.gravity);\r\n\t\t\tif (side > max) {\r\n\t\t\t\tside = max;\r\n\t\t\t\tthis._free -= side;\r\n\t\t\t\tthis._gravity -= cell.gravity;\r\n\t\t\t}\r\n\t\t\tif (side < min) {\r\n\t\t\t\tside = min;\r\n\t\t\t\tthis._free -= side;\r\n\t\t\t\tthis._gravity -= cell.gravity;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (side > max) {\r\n\t\t\t\tside = max;\r\n\t\t\t}\r\n\t\t\tif (side < min) {\r\n\t\t\t\tside = min;\r\n\t\t\t}\r\n\t\t\tthis._free -= side;\r\n\t\t}\r\n\t\treturn side;\r\n\t};\r\n\tLayout.prototype._calcSize = function (s, size, xLayout) {\r\n\t\tvar side = s;\r\n\t\tvar min = xLayout ? size.minWidth : size.minHeight;\r\n\t\tvar max = xLayout ? size.maxWidth : size.maxHeight;\r\n\t\tif (!side) {\r\n\t\t\tside = Math.floor(this._free / this._gravity * size.gravity);\r\n\t\t}\r\n\t\tif (side > max) {\r\n\t\t\tside = max;\r\n\t\t}\r\n\t\tif (side < min) {\r\n\t\t\tside = min;\r\n\t\t}\r\n\t\treturn side;\r\n\t};\r\n\r\n\tLayout.prototype._configureBorders = function(){\r\n\t\tif(this.$root){\r\n\t\t\tthis._setBorders([\r\n\t\t\t\tthis._borders.left,\r\n\t\t\t\tthis._borders.top,\r\n\t\t\t\tthis._borders.right,\r\n\t\t\t\tthis._borders.bottom\r\n\t\t\t],\r\n\t\t\tthis);\r\n\t\t}\r\n\r\n\t\tvar borderClass = this._xLayout ? this._borders.right : this._borders.bottom;\r\n\r\n\t\tvar cells = this.$cells;\r\n\r\n\t\tvar lastVisibleIndex = cells.length - 1;\r\n\t\tfor(var i = lastVisibleIndex; i >= 0; i--){\r\n\t\t\tif (!cells[i].$config.hidden) {\r\n\t\t\t\tlastVisibleIndex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var i = 0; i < cells.length; i++) {\r\n\t\t\tif (cells[i].$config.hidden) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar lastCell = i >= lastVisibleIndex;\r\n\t\t\tvar borderColorClass = \"\";\r\n\t\t\tif(!lastCell && cells[i + 1]){\r\n\t\t\t\tif(cells[i + 1].$config.view == \"scrollbar\"){\r\n\t\t\t\t\tif(this._xLayout){\r\n\t\t\t\t\t\tlastCell = true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tborderColorClass = \"gantt_layout_cell_border_transparent\";\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tthis._setBorders(lastCell ? [] : [borderClass, borderColorClass], cells[i]);\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype._updateCellVisibility = function(){\r\n\t\tvar oldVisibleCells = this._visibleCells || {};\r\n\t\tvar firstCall = !this._visibleCells;\r\n\t\tvar visibleCells = {};\r\n\t\tvar cell = null;\r\n\t\tvar parentVisibility = [];\r\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\r\n\t\t\tcell = this.$cells[i];\r\n\t\t\tif (cell.$config.hide_empty){\r\n\t\t\t\tparentVisibility.push(cell);\r\n\t\t\t}\r\n\r\n\t\t\tif (!firstCall && cell.$config.hidden && oldVisibleCells[cell.$id]) {\r\n\t\t\t\tcell._hide(true);\r\n\t\t\t}else if(!cell.$config.hidden && !oldVisibleCells[cell.$id]){\r\n\t\t\t\tcell._hide(false);\r\n\t\t\t}\r\n\r\n\t\t\tif(!cell.$config.hidden){\r\n\t\t\t\tvisibleCells[cell.$id] = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._visibleCells = visibleCells;\r\n\r\n\t\t// GS-27. A way to hide the whole cell if all its children are hidden\r\n\t\tfor (var i = 0; i < parentVisibility.length; i++) {\r\n\t\t\tvar cell = parentVisibility[i];\r\n\t\t\tvar children = cell.$cells;\r\n\t\t\tvar hideCell = true;\r\n\t\t\tchildren.forEach(function(child){\r\n\t\t\t\tif (!child.$config.hidden && !child.$config.resizer){\r\n\t\t\t\t\thideCell = false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tcell.$config.hidden = hideCell;\r\n\t\t}\r\n\t};\r\n\r\n\tLayout.prototype.setSize = function (x, y) {\r\n\t\tthis._configureBorders();\r\n\t\t_super.prototype.setSize.call(this, x, y);\r\n\t\ty = this.$lastSize.contentY;\r\n\t\tx = this.$lastSize.contentX;\r\n\r\n\t\tvar padding = (this.$config.padding || 0);\r\n\t\tthis.$view.style.padding = padding + \"px\";\r\n\t\tthis._gravity = 0;\r\n\t\tthis._free = this._xLayout ? x : y;\r\n\t\tthis._free -= padding * 2;\r\n\t\t// calc all gravity\r\n\r\n\t\tvar cell,\r\n\t\t\tsize;\r\n\r\n\t\tthis._updateCellVisibility();\r\n\r\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\r\n\t\t\tcell = this.$cells[i];\r\n\r\n\t\t\tif (cell.$config.hidden) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tvar margin = (this.$config.margin || 0);\r\n\t\t\tif(cell.$name == \"resizer\" && !margin){\r\n\t\t\t\tmargin = -1;\r\n\t\t\t}\r\n\r\n\t\t\t// set margins to child cell\r\n\t\t\tvar cellView = cell.$view;\r\n\r\n\t\t\tvar marginSide = this._xLayout ? \"marginRight\" : \"marginBottom\";\r\n\t\t\tif (i !== this.$cells.length - 1) {\r\n\t\t\t\tcellView.style[marginSide] = margin + \"px\";\r\n\t\t\t\tthis._free -= margin; // calc free space without margin\r\n\t\t\t}\r\n\t\t\tsize = this._sizes[i];\r\n\t\t\tif (this._xLayout) {\r\n\t\t\t\tif (!size.width) {\r\n\t\t\t\t\tthis._gravity += size.gravity;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!size.height) {\r\n\t\t\t\t\tthis._gravity += size.gravity;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\r\n\t\t\tcell = this.$cells[i];\r\n\r\n\t\t\tif (cell.$config.hidden) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tsize = this._sizes[i];\r\n\t\t\tvar width = size.width;\r\n\t\t\tvar height = size.height;\r\n\t\t\tif (this._xLayout) {\r\n\t\t\t\tthis._calcFreeSpace(width, size, true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._calcFreeSpace(height, size, false);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\tcell = this.$cells[i];\r\n\r\n\t\t\tif (cell.$config.hidden) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tsize = this._sizes[i];\r\n\t\t\tvar dx = void 0;\r\n\t\t\tvar dy = void 0;\r\n\t\t\tif (this._xLayout) {\r\n\t\t\t\tdx = this._calcSize(size.width, size, true);\r\n\t\t\t\tdy = y - padding * 2; // layout height without paddings\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdx = x - padding * 2; // layout width without paddings\r\n\t\t\t\tdy = this._calcSize(size.height, size, false);\r\n\t\t\t}\r\n\r\n\t\t\tcell.setSize(dx, dy);\r\n\t\t}\r\n\r\n\t};\r\n\r\n\treturn Layout;\r\n}(Cell));\r\n\r\nexport default Layout;","import __extends from \"../../../utils/extends\";\r\nimport Layout from \"./layout\";\r\nimport Cell from \"./cell\";\r\n\r\nvar ViewLayout = (function (_super) {\r\n\t\"use strict\";\r\n\r\n\t__extends(ViewLayout, _super);\r\n\tfunction ViewLayout(parent, config, factory) {\r\n\t\tvar _this = _super.apply(this, arguments) || this;\r\n\t\tfor (var i = 0; i < _this.$cells.length; i++) {\r\n\t\t\t_this.$cells[i].$config.hidden = (i !== 0);\r\n\t\t}\r\n\t\t_this.$cell = _this.$cells[0];\r\n\t\t_this.$name = \"viewLayout\";\r\n\r\n\t\treturn _this;\r\n\t}\r\n\tViewLayout.prototype.cell = function (id) {\r\n\t\tvar cell = _super.prototype.cell.call(this, id);\r\n\t\tif (!cell.$view) {\r\n\t\t\tthis.$fill(null, this);\r\n\t\t}\r\n\t\treturn cell;\r\n\t};\r\n\tViewLayout.prototype.moveView = function (view) {\r\n\t\tvar body = this.$view;\r\n\t\tif (this.$cell) {\r\n\t\t\tthis.$cell.$config.hidden = true;\r\n\t\t\tbody.removeChild(this.$cell.$view);\r\n\t\t}\r\n\t\tthis.$cell = view;\r\n\t\tbody.appendChild(view.$view);\r\n\t};\r\n\tViewLayout.prototype.setSize = function (x, y) {\r\n\t\tCell.prototype.setSize.call(this, x, y);\r\n\t};\r\n\r\n\tViewLayout.prototype.setContentSize = function(){\r\n\t\tvar size = this.$lastSize;\r\n\t\tthis.$cell.setSize(size.contentX, size.contentY);\r\n\t};\r\n\r\n\tViewLayout.prototype.getSize = function () {\r\n\t\tvar sizes = _super.prototype.getSize.call(this);\r\n\t\tif (this.$cell) {\r\n\t\t\tvar cellSize = this.$cell.getSize();\r\n\t\t\tif (this.$config.byMaxSize) {\r\n\t\t\t\tfor (var i = 0; i < this.$cells.length; i++) {\r\n\t\t\t\t\tvar otherCell = this.$cells[i].getSize();\r\n\t\t\t\t\tfor (var cell in cellSize) {\r\n\t\t\t\t\t\tcellSize[cell] = Math.max(cellSize[cell], otherCell[cell]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (var size in sizes) {\r\n\t\t\t\tsizes[size] = sizes[size] || cellSize[size];\r\n\t\t\t}\r\n\t\t\tsizes.gravity = Math.max(sizes.gravity, cellSize.gravity);\r\n\t\t}\r\n\t\treturn sizes;\r\n\t};\r\n\treturn ViewLayout;\r\n}(Layout));\r\n\r\nexport default ViewLayout;","import __extends from \"../../../utils/extends\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport Cell from \"./cell\";\r\n\r\nvar ViewCell = (function (_super) {\r\n\t\"use strict\";\r\n\r\n\t__extends(ViewCell, _super);\r\n\tfunction ViewCell(parent, config, factory) {\r\n\r\n\t\tvar _this = _super.apply(this, arguments) || this;\r\n\r\n\t\tif(config.view){\r\n\t\t\tif(config.id){\r\n\t\t\t\t// pass id to the nested view\r\n\t\t\t\tthis.$id = utils.uid();\r\n\t\t\t}\r\n\t\t\tvar childConfig = utils.copy(config);\r\n\t\t\tdelete childConfig.config;\r\n\t\t\tdelete childConfig.templates;\r\n\r\n\t\t\tthis.$content = this.$factory.createView(config.view, this, childConfig, this);\r\n\t\t\tif(!this.$content)\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t_this.$name = \"viewCell\";\r\n\t\treturn _this;\r\n\t}\r\n\r\n\tViewCell.prototype.destructor = function(){\r\n\t\tthis.clear();\r\n\t\t_super.prototype.destructor.call(this);\r\n\t};\r\n\r\n\tViewCell.prototype.clear = function(){\r\n\r\n\t\tthis.$initialized = false;\r\n\r\n\t\t// call destructor\r\n\t\tif (this.$content){\r\n\t\t\tvar method = this.$content.unload || this.$content.destructor;\r\n\t\t\tif (method){\r\n\t\t\t\tmethod.call(this.$content);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t_super.prototype.clear.call(this);\r\n\r\n\t};\r\n\r\n\tViewCell.prototype.scrollTo = function(left, top){\r\n\r\n\t\tif(this.$content && this.$content.scrollTo){\r\n\t\t\tthis.$content.scrollTo(left, top);\r\n\t\t}else{\r\n\t\t\t_super.prototype.scrollTo.call(this, left, top);\r\n\t\t}\r\n\t};\r\n\r\n\tViewCell.prototype._setContentSize = function(x, y){\r\n\t\tvar borders = this._getBorderSizes();\r\n\t\tif(typeof x === \"number\"){\r\n\t\t\tvar outerX = x + borders.horizontal;\r\n\t\t\tthis.$config.width = outerX;\r\n\t\t}\r\n\t\tif(typeof y === \"number\"){\r\n\t\t\tvar outerY = y + borders.vertical;\r\n\t\t\tthis.$config.height = outerY;\r\n\t\t}\r\n\t};\r\n\r\n\tViewCell.prototype.setSize = function(x, y){\r\n\t\t_super.prototype.setSize.call(this, x, y);\r\n\r\n\t\tif(!this.$preResize && this.$content) {\r\n\t\t\tif (!this.$initialized) {\r\n\t\t\t\tthis.$initialized = true;\r\n\t\t\t\tvar header = this.$view.childNodes[0];\r\n\t\t\t\tvar content = this.$view.childNodes[1];\r\n\t\t\t\tif(!content) content = header;\r\n\r\n\t\t\t\t/*if(this.$content.$config){\r\n\t\t\t\t\tthis.$content.$config.width = this.$lastSize.contentX;\r\n\t\t\t\t\tthis.$content.$config.height = this.$lastSize.contentY;\r\n\t\t\t\t}*/\r\n\t\t\t\tthis.$content.init(content);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tViewCell.prototype.setContentSize = function(){\r\n\t\tif(!this.$preResize && this.$content) {\r\n\t\t\tif (this.$initialized) {\r\n\t\t\t\tthis.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tViewCell.prototype.getContentSize = function(){\r\n\t\tvar size = _super.prototype.getContentSize.call(this);\r\n\r\n\t\tif(this.$content && this.$initialized){\r\n\t\t\tvar childSize = this.$content.getSize();\r\n\t\t\tsize.width = childSize.contentX === undefined ? childSize.width : childSize.contentX;\r\n\t\t\tsize.height = childSize.contentY === undefined ? childSize.height : childSize.contentY;\r\n\t\t}\r\n\r\n\t\tvar borders = this._getBorderSizes();\r\n\t\tsize.width += borders.horizontal;\r\n\t\tsize.height += borders.vertical;\r\n\r\n\t\treturn size;\r\n\t};\r\n\r\n\treturn ViewCell;\r\n}(Cell));\r\n\r\nexport default ViewCell;","import __extends from \"../../../utils/extends\";\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport env from \"../../../utils/env\";\r\nimport Cell from \"./cell\";\r\n\r\nvar ScrollbarCell = (function (_super) {\r\n\t\"use strict\";\r\n\r\n\tvar SCROLL_MODIFIER_KEYS = [\"altKey\", \"shiftKey\", \"metaKey\"]; // it's no way to disable ctrl+wheel\r\n\t__extends(ScrollbarCell, _super);\r\n\tfunction ScrollbarCell(parent, config, factory, gantt) {\r\n\r\n\t\tvar _this = _super.apply(this, arguments) || this;\r\n\t\tthis.$config = utils.mixin(config, {scroll: \"x\"});\r\n\t\t_this._scrollHorizontalHandler = utils.bind(_this._scrollHorizontalHandler, _this);\r\n\t\t_this._scrollVerticalHandler = utils.bind(_this._scrollVerticalHandler, _this);\r\n\t\t_this._outerScrollVerticalHandler = utils.bind(_this._outerScrollVerticalHandler, _this);\r\n\t\t_this._outerScrollHorizontalHandler = utils.bind(_this._outerScrollHorizontalHandler, _this);\r\n\t\t_this._mouseWheelHandler = utils.bind(_this._mouseWheelHandler, _this);\r\n\r\n\t\tthis.$config.hidden = true;\r\n\t\tvar size = gantt.config.scroll_size;\r\n\r\n\t\tif(gantt.env.isIE){\r\n\t\t\t// full element height/width must be bigger than just a browser scrollbar,\r\n\t\t\t// otherwise the scrollbar element won't be scrolled on click\r\n\t\t\tsize += 1;\r\n\t\t}\r\n\r\n\t\tif(this._isHorizontal()){\r\n\t\t\t_this.$config.height = size;\r\n\t\t\t_this.$parent.$config.height = size;\r\n\t\t}else{\r\n\t\t\t_this.$config.width = size;\r\n\t\t\t_this.$parent.$config.width = size;\r\n\t\t}\r\n\r\n\t\tthis.$config.scrollPosition = 0;\r\n\r\n\t\t_this.$name = \"scroller\";\r\n\t\treturn _this;\r\n\t}\r\n\r\n\tScrollbarCell.prototype.init = function(container){\r\n\t\tcontainer.innerHTML = this.$toHTML();\r\n\t\tthis.$view = container.firstChild;\r\n\r\n\t\tif(!this.$view){\r\n\t\t\tthis.init();\r\n\t\t}\r\n\t\tif(this._isVertical()){\r\n\t\t\tthis._initVertical();\r\n\t\t}else{\r\n\t\t\tthis._initHorizontal();\r\n\t\t}\r\n\t\tthis._initMouseWheel();\r\n\t\tthis._initLinkedViews();\r\n\t};\r\n\r\n\tScrollbarCell.prototype.$toHTML = function () {\r\n\t\tvar className = this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\";\r\n\t\treturn \"<div class='gantt_layout_cell \"+className+\"'><div style='\"+(this._isHorizontal() ? \"width:2000px\" : \"height:2000px\")+\"'></div></div>\";\r\n\t};\r\n\r\n\tScrollbarCell.prototype._getRootParent = function(){\r\n\t\tvar parent = this.$parent;\r\n\t\twhile(parent && parent.$parent){\r\n\t\t\tparent = parent.$parent;\r\n\t\t}\r\n\t\tif(parent){\r\n\t\t\treturn parent;\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tfunction eachCell(root, res){\r\n\t\tres.push(root);\r\n\t\tif(root.$cells){\r\n\t\t\tfor(var i = 0; i < root.$cells.length; i++){\r\n\t\t\t\teachCell(root.$cells[i], res);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tScrollbarCell.prototype._eachView = function(){\r\n\t\tvar res = [];\r\n\t\teachCell(this._getRootParent(), res);\r\n\t\treturn res;\r\n\t};\r\n\r\n\tScrollbarCell.prototype._getLinkedViews = function(){\r\n\t\tvar views = this._eachView();\r\n\t\tvar res = [];\r\n\t\tfor(var i = 0; i < views.length; i++){\r\n\t\t\tif(views[i].$config && ((this._isVertical() && views[i].$config.scrollY == this.$id) || (this._isHorizontal() && views[i].$config.scrollX == this.$id)) ){\r\n\t\t\t\tres.push(views[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t};\r\n\r\n\r\n\tScrollbarCell.prototype._initHorizontal = function(){\r\n\t\tthis.$scroll_hor = this.$view;\r\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\r\n\r\n\t};\r\n\r\n\tScrollbarCell.prototype._initLinkedViews = function(){\r\n\t\tvar views = this._getLinkedViews();\r\n\t\tvar css = this._isVertical() ?\"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\";\r\n\t\tfor(var i = 0; i < views.length; i++){\r\n\t\t\t//views[i].$config.css = [views[i].$config.css || \"\", css].join(\" \");\r\n\t\t\tdomHelpers.addClassName(views[i].$view || views[i].getNode(), css);\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype._initVertical = function(){\r\n\t\tthis.$scroll_ver = this.$view;\r\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\r\n\t};\r\n\r\n\tScrollbarCell.prototype._updateLinkedViews = function(){\r\n\t};\r\n\r\n\tScrollbarCell.prototype._initMouseWheel = function(){\r\n\t\tvar ff = env.isFF;\r\n\t\tif (ff)\r\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {passive: false});\r\n\t\telse\r\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {passive: false});\r\n\t};\r\n\r\n\r\n\r\n\r\n\tScrollbarCell.prototype.scrollHorizontally = function(left){\r\n\t\tif(this._scrolling) return;\r\n\t\tthis._scrolling = true;\r\n\r\n\t\tthis.$scroll_hor.scrollLeft = left;\r\n\t\tthis.$config.codeScrollLeft = left;\r\n\t\tleft = this.$scroll_hor.scrollLeft;\r\n\r\n\t\tvar views = this._getLinkedViews();\r\n\t\tfor(var i = 0; i < views.length; i++){\r\n\t\t\tif(views[i].scrollTo){\r\n\t\t\t\tviews[i].scrollTo(left, undefined);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oldSize = this.$config.scrollPosition;\r\n\t\tthis.$config.scrollPosition = left;\r\n\t\tthis.callEvent(\"onScroll\", [oldSize, left, this.$config.scroll]);\r\n\t\tthis._scrolling = false;\r\n\t};\r\n\tScrollbarCell.prototype.scrollVertically = function(top){\r\n\t\tif(this._scrolling) return;\r\n\t\tthis._scrolling = true;\r\n\r\n\t\tthis.$scroll_ver.scrollTop = top;\r\n\t\ttop = this.$scroll_ver.scrollTop;\r\n\r\n\t\tvar views = this._getLinkedViews();\r\n\r\n\t\tfor(var i = 0; i < views.length; i++){\r\n\t\t\tif(views[i].scrollTo){\r\n\t\t\t\tviews[i].scrollTo(undefined, top);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar oldSize = this.$config.scrollPosition;\r\n\t\tthis.$config.scrollPosition = top;\r\n\t\tthis.callEvent(\"onScroll\", [oldSize, top, this.$config.scroll]);\r\n\t\tthis._scrolling = false;\r\n\t};\r\n\r\n\tScrollbarCell.prototype._isVertical = function(){\r\n\t\treturn this.$config.scroll == \"y\";\r\n\t};\r\n\tScrollbarCell.prototype._isHorizontal = function(){\r\n\t\treturn this.$config.scroll == \"x\";\r\n\t};\r\n\tScrollbarCell.prototype._scrollHorizontalHandler = function (e) {\r\n\t\tif(this._isVertical() || this._scrolling){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//in safari we can catch previous onscroll after setting new value from mouse-wheel event\r\n\t\t//set delay to prevent value drifiting\r\n\t\tif ((new Date()) - ( this._wheel_time || 0 ) < 100) return true;\r\n\t\t//if (this.$gantt._touch_scroll_active) return;\r\n\t\tvar left = this.$scroll_hor.scrollLeft;\r\n\r\n\t\tthis.scrollHorizontally(left);\r\n\r\n\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\r\n\t};\r\n\tScrollbarCell.prototype._outerScrollHorizontalHandler = function(e){\r\n\t\tif(this._isVertical()){\r\n\t\t\treturn;\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype.show = function(){\r\n\t\tthis.$parent.show();\r\n\t};\r\n\tScrollbarCell.prototype.hide = function(){\r\n\t\tthis.$parent.hide();\r\n\t};\r\n\r\n\tScrollbarCell.prototype._getScrollSize = function(){\r\n\t\tvar scrollSize = 0;\r\n\t\tvar outerSize = 0;\r\n\t\tvar isHorizontal = this._isHorizontal();\r\n\r\n\t\tvar linked = this._getLinkedViews();\r\n\t\tvar view;\r\n\t\tvar scrollProperty = isHorizontal ? \"scrollWidth\" : \"scrollHeight\",\r\n\t\t\tinnerSizeProperty = isHorizontal ? \"contentX\" : \"contentY\";\r\n\t\tvar outerProperty = isHorizontal ? \"x\" : \"y\";\r\n\t\tvar offset = this._getScrollOffset();\r\n\r\n\t\tfor(var i = 0; i < linked.length; i++){\r\n\t\t\tview = linked[i];\r\n\t\t\tif(!(view && view.$content && view.$content.getSize && !view.$config.hidden)) continue;\r\n\r\n\t\t\tvar sizes = view.$content.getSize();\r\n\t\t\tvar cellScrollSize;\r\n\t\t\tif(sizes.hasOwnProperty(scrollProperty)){\r\n\t\t\t\tcellScrollSize = sizes[scrollProperty];\r\n\t\t\t}else{\r\n\t\t\t\tcellScrollSize = sizes[innerSizeProperty];\r\n\t\t\t}\r\n\r\n\t\t\tif(offset){\r\n\t\t\t\t// precalculated vertical/horizontal offsets of scrollbar to emulate 4.x look\r\n\t\t\t\tif(sizes[innerSizeProperty] > sizes[outerProperty] && sizes[innerSizeProperty] > scrollSize && (cellScrollSize > (sizes[outerProperty] - offset + 2))){\r\n\t\t\t\t\tscrollSize = cellScrollSize + (isHorizontal ? 0 : 2);\r\n\t\t\t\t\touterSize = sizes[outerProperty];\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n\t\t\t\tvar nonScrollableSize = Math.max(sizes[innerSizeProperty] - cellScrollSize, 0);\r\n\t\t\t\tvar scrollableViewPortSize = Math.max(sizes[outerProperty] - nonScrollableSize, 0);\r\n\t\t\t\tcellScrollSize = cellScrollSize + nonScrollableSize;\r\n\r\n\t\t\t\tif(cellScrollSize > scrollableViewPortSize && (cellScrollSize > scrollSize) ){\r\n\t\t\t\t\t//|| (cellScrollSize === scrollSize && sizes[outerProperty] < outerSize) // same scroll width but smaller scrollable view port\r\n\r\n\t\t\t\t\tscrollSize = cellScrollSize;\r\n\t\t\t\t\touterSize = sizes[outerProperty];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\touterScroll: outerSize,\r\n\t\t\tinnerScroll: scrollSize\r\n\t\t};\r\n\t};\r\n\r\n\tScrollbarCell.prototype.scroll = function(position){\r\n\t\tif(this._isHorizontal()){\r\n\t\t\tthis.scrollHorizontally(position);\r\n\t\t}else{\r\n\t\t\tthis.scrollVertically(position);\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype.getScrollState = function(){\r\n\t\treturn {\r\n\t\t\tvisible: this.isVisible(),\r\n\t\t\tdirection: this.$config.scroll,\r\n\t\t\tsize: this.$config.outerSize,\r\n\t\t\tscrollSize: this.$config.scrollSize || 0,\r\n\t\t\tposition: this.$config.scrollPosition || 0\r\n\t\t};\r\n\t};\r\n\r\n\tScrollbarCell.prototype.setSize = function(width, height){\r\n\t\t_super.prototype.setSize.apply(this, arguments);\r\n\r\n\t\tvar scrollSizes = this._getScrollSize();\r\n\r\n\t\tvar ownSize = (this._isVertical() ? height : width) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\r\n\r\n\t\tif(scrollSizes.innerScroll && ownSize > scrollSizes.outerScroll){\r\n\t\t\tscrollSizes.innerScroll += (ownSize - scrollSizes.outerScroll);\r\n\t\t}\r\n\t\tthis.$config.scrollSize = scrollSizes.innerScroll;\r\n\r\n\t\tthis.$config.width = width;\r\n\t\tthis.$config.height = height;\r\n\t\tthis._setScrollSize(scrollSizes.innerScroll);\r\n\t};\r\n\r\n\tScrollbarCell.prototype.isVisible = function(){\r\n\t\treturn !!(this.$parent && this.$parent.$view.parentNode);\r\n\t};\r\n\r\n\tScrollbarCell.prototype.shouldShow = function(){\r\n\t\tvar scrollSizes = this._getScrollSize();\r\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\r\n\t\t\treturn false;\r\n\t\t}else if(scrollSizes.innerScroll && !(this.$parent && this.$parent.$view.parentNode)){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype.shouldHide = function(){\r\n\t\tvar scrollSizes = this._getScrollSize();\r\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tScrollbarCell.prototype.toggleVisibility = function(){\r\n\t\tif(this.shouldHide()){\r\n\t\t\tthis.hide();\r\n\t\t}else if(this.shouldShow()){\r\n\t\t\tthis.show();\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype._getScaleOffset = function(view){\r\n\t\tvar offset = 0;\r\n\t\tif(view && (view.$config.view == \"timeline\" || view.$config.view == \"grid\")){\r\n\t\t\toffset = view.$content.$getConfig().scale_height;\r\n\t\t}\r\n\t\treturn offset;\r\n\t};\r\n\r\n\tScrollbarCell.prototype._getScrollOffset = function(){\r\n\t\tvar offset = 0;\r\n\t\tif(this._isVertical()){\r\n\t\t\tvar parentLayout = this.$parent.$parent;\r\n\t\t\toffset = Math.max(\r\n\t\t\t\tthis._getScaleOffset(parentLayout.getPrevSibling(this.$parent.$id)),\r\n\t\t\t\tthis._getScaleOffset(parentLayout.getNextSibling(this.$parent.$id))\r\n\t\t\t\t);\r\n\t\t}else{\r\n\t\t\tvar linked = this._getLinkedViews();\r\n\r\n\t\t\tfor (var i = 0; i < linked.length; i++) {\r\n\t\t\t\tvar view = linked[i],\r\n\t\t\t\t\tvparent = view.$parent;\r\n\t\t\t\tvar cells = vparent.$cells;\r\n\r\n\t\t\t\tvar last = cells[cells.length - 1];\r\n\r\n\t\t\t\tif (last && last.$config.view == \"scrollbar\" && last.$config.hidden === false) {\r\n\t\t\t\t\toffset = last.$config.width;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn offset || 0;\r\n\t};\r\n\r\n\tScrollbarCell.prototype._setScrollSize = function(size){\r\n\t\tvar property = this._isHorizontal() ? \"width\" : \"height\";\r\n\t\tvar scrollbar = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver;\r\n\r\n\t\tvar offset = this._getScrollOffset();\r\n\r\n\t\tvar node = scrollbar.firstChild;\r\n\r\n\t\tif(offset){\r\n\t\t\tif(this._isVertical()){\r\n\r\n\t\t\t\tthis.$config.outerSize = (this.$config.height - offset + 3);\r\n\t\t\t\tscrollbar.style.height = this.$config.outerSize + \"px\";\r\n\t\t\t\tscrollbar.style.top = (offset-1) + \"px\";\r\n\t\t\t\tdomHelpers.addClassName(scrollbar, this.$parent._borders.top);\r\n\t\t\t\tdomHelpers.addClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\r\n\t\t\t}else{\r\n\t\t\t\tthis.$config.outerSize = (this.$config.width - offset + 1);\r\n\t\t\t\tscrollbar.style.width = this.$config.outerSize + \"px\";\r\n\t\t\t\t//domHelpers.addClassName(scrollbar, this.$parent._borders.right);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tscrollbar.style.top = \"auto\";\r\n\t\t\tdomHelpers.removeClassName(scrollbar, this.$parent._borders.top);\r\n\t\t\tdomHelpers.removeClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\r\n\t\t\tthis.$config.outerSize = this.$config.height;\r\n\t\t}\r\n\r\n\t\tnode.style[property] = size + \"px\";\r\n\t};\r\n\r\n\tScrollbarCell.prototype._scrollVerticalHandler = function (e) {\r\n\t\tif(this._scrollHorizontalHandler() || this._scrolling){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//if (this.$gantt._touch_scroll_active) return;\r\n\t\tvar top = this.$scroll_ver.scrollTop;\r\n\t\tvar prev = this._oldTop;\r\n\t\tif(top == prev) return;\r\n\r\n\t\tthis.scrollVertically(top);\r\n\r\n\t\tthis._oldTop = this.$scroll_ver.scrollTop;\r\n\r\n\t};\r\n\tScrollbarCell.prototype._outerScrollVerticalHandler = function(e){\r\n\t\tif(this._scrollHorizontalHandler()){\r\n\t\t\treturn;\r\n\t\t}\r\n\t};\r\n\r\n\tScrollbarCell.prototype._checkWheelTarget = function(targetNode){\r\n\t\tvar connectedViews = this._getLinkedViews().concat(this);\r\n\r\n\t\tfor(var i = 0; i < connectedViews.length; i++){\r\n\t\t\tvar node = connectedViews[i].$view;\r\n\t\t\tif(domHelpers.isChildOf(targetNode, node)){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\tScrollbarCell.prototype._mouseWheelHandler = function(e){\r\n\t\tvar target = e.target || e.srcElement;\r\n\r\n\t\tif(!this._checkWheelTarget(target))\r\n\t\t\treturn;\r\n\r\n\t\tthis._wheel_time = new Date();\r\n\r\n\t\tvar res = {};\r\n\r\n\t\tvar wheelSpeed = {x: 1, y: 1};\r\n\t\tvar wheelSpeedConfig = this.$gantt.config.wheel_scroll_sensitivity;\r\n\r\n\t\tif (typeof wheelSpeedConfig == \"number\" && !!wheelSpeedConfig) {\r\n\t\t\twheelSpeed = {x: wheelSpeedConfig, y: wheelSpeedConfig};\r\n\t\t}\r\n\t\telse if (({}).toString.apply(wheelSpeedConfig) == \"[object Object]\") {\r\n\t\t\twheelSpeed = {x: wheelSpeedConfig.x, y: wheelSpeedConfig.y};\r\n\t\t}\r\n\r\n\t\tvar ff = env.isFF;\r\n\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\r\n\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\r\n\r\n\t\tvar multiplier = -20;\r\n\t\tif (ff) {\r\n\t\t\t// GS-1500. Firefox had many changes during the versions\r\n\t\t\tconst version = parseInt(navigator.userAgent.split(\"Firefox/\")[1]);\r\n\t\t\tif (version <= 87){\r\n\t\t\t\tif (e.deltaMode !== 0) {\r\n\t\t\t\t\tmultiplier = -40;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmultiplier = -10;\r\n\t\t\t\t}\r\n\t\t\t} else if (version <= 90){\r\n\t\t\t\tmultiplier = -3;\r\n\t\t\t} else if (version <= 96){\r\n\t\t\t\tmultiplier = -1.5;\r\n\t\t\t} else {\r\n\t\t\t\tmultiplier = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\r\n\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\r\n\r\n\t\tvar horizontalScrollModifier = this.$gantt.config.horizontal_scroll_key;\r\n\r\n\t\tif (horizontalScrollModifier !== false) {\r\n\t\t\tif (SCROLL_MODIFIER_KEYS.indexOf(horizontalScrollModifier) >= 0) {\r\n\t\t\t\tif(e[horizontalScrollModifier] && !(e.deltaX || e.wheelDeltaX)){\r\n\t\t\t\t\t// shift+mousewheel for horizontal scroll\r\n\t\t\t\t\twx = wy*2;\r\n\t\t\t\t\twy = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\r\n\t\t\tif(this._isVertical()){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(res.x) return true;//no horisontal scroll, must not block scrolling\r\n\t\t\tif(!this.$scroll_hor || !this.$scroll_hor.offsetWidth) return true;\r\n\r\n\t\t\tvar dir  = wx/-40;\r\n\t\t\tvar oldLeft = this._oldLeft;\r\n\t\t\tvar left = oldLeft+dir*30;\r\n\t\t\tthis.scrollHorizontally(left);\r\n\t\t\tthis.$scroll_hor.scrollLeft = left;\r\n\t\t\t// not block scroll if position hasn't changed\r\n\t\t\tif(oldLeft == this.$scroll_hor.scrollLeft){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\r\n\t\t} else {\r\n\t\t\tif(this._isHorizontal()){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(res.y) return true;//no vertical scroll, must not block scrolling\r\n\t\t\tif(!this.$scroll_ver || !this.$scroll_ver.offsetHeight) return true;\r\n\r\n\t\t\tvar dir  = wy/-40;\r\n\t\t\tif (typeof wy == \"undefined\")\r\n\t\t\t\tdir = e.detail;\r\n\r\n\t\t\tvar oldTop = this._oldTop;\r\n\t\t\tvar top = this.$scroll_ver.scrollTop+dir*30;\r\n\r\n\t\t\t//if(!this.$gantt.config.prevent_default_scroll &&\r\n\t\t\t//\t(this.$gantt._cached_scroll_pos && ((this.$gantt._cached_scroll_pos.y == top) || (this.$gantt._cached_scroll_pos.y <= 0 && top <= 0)))) return true;\r\n\r\n\r\n\t\t\tthis.scrollVertically(top);\r\n\t\t\tthis.$scroll_ver.scrollTop = top;\r\n\r\n\t\t\t// not block scroll if position hasn't changed\r\n\t\t\tif(oldTop == this.$scroll_ver.scrollTop){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tthis._oldTop = this.$scroll_ver.scrollTop;\r\n\t\t}\r\n\r\n\t\tif (e.preventDefault)\r\n\t\t\te.preventDefault();\r\n\t\te.cancelBubble=true;\r\n\t\treturn false;\r\n\t};\r\n\r\n\treturn ScrollbarCell;\r\n})(Cell);\r\n\r\nexport default ScrollbarCell;","import quickPositionHelperFactory from \"./row_position_fixed_height\";\r\n\r\nfunction createMixin(view){\r\n\tvar getItemTopCache = {};\r\n\tvar getRowTopCache = {};\r\n\tvar getItemHeightCache = null;\r\n\tvar totalHeightCache = -1;\r\n\tvar getItemHeightCacheState = null;\r\n\r\n\tvar quickPosition = quickPositionHelperFactory(view);\r\n\r\n\treturn {\r\n\t\t_resetTopPositionHeight: function(){\r\n\t\t\tgetItemTopCache = {};\r\n\t\t\tgetRowTopCache = {};\r\n\t\t\tquickPosition.resetCache();\r\n\t\t},\r\n\t\t_resetHeight: function(){\r\n\t\t\tvar store = this.$config.rowStore;\r\n\t\t\tvar newState = this.getCacheStateTotalHeight(store);\r\n\t\t\tif(!getItemHeightCacheState){\r\n\t\t\t\tgetItemHeightCacheState = newState;\r\n\t\t\t}else if(this.shouldClearHeightCache(getItemHeightCacheState, newState)){\r\n\t\t\t\tgetItemHeightCacheState = newState;\r\n\t\t\t\tgetItemHeightCache = null;\r\n\t\t\t}\r\n\r\n\t\t\ttotalHeightCache = -1;\r\n\t\t\tquickPosition.resetCache();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get top coordinate by row index (order)\r\n\t\t * @param {number} index\r\n\t\t */\r\n\t\tgetRowTop: function(index){\r\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\r\n\t\t\t\treturn quickPosition.getRowTop(index);\r\n\t\t\t}\r\n\r\n\t\t\tvar store = this.$config.rowStore;\r\n\t\t\tif(!store){\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tif(getRowTopCache[index] !== undefined){\r\n\t\t\t\treturn getRowTopCache[index];\r\n\t\t\t}else {\r\n\t\t\t\tvar all = store.getIndexRange();\r\n\t\t\t\tvar top = 0;\r\n\t\t\t\tvar result = 0;\r\n\t\t\t\tfor(var i = 0; i < all.length; i++){\r\n\t\t\t\t\tgetRowTopCache[i] = top;\r\n\t\t\t\t\ttop += this.getItemHeight(all[i].id);\r\n\t\t\t\t\tif(i < index){\r\n\t\t\t\t\t\tresult = top;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get top coordinate by item id\r\n\t\t * @param {*} task_id\r\n\t\t */\r\n\t\tgetItemTop: function (taskId) {\r\n\t\t\tif(this.$config.rowStore){\r\n\t\t\t\tif(getItemTopCache[taskId] !== undefined){\r\n\t\t\t\t\treturn getItemTopCache[taskId];\r\n\t\t\t\t}\r\n\t\t\t\tvar store = this.$config.rowStore;\r\n\t\t\t\tif(!store) return 0;\r\n\r\n\t\t\t\tvar itemIndex = store.getIndexById(taskId);\r\n\r\n\t\t\t\tif (itemIndex === -1 && store.getParent && store.exists(taskId)) {\r\n\t\t\t\t\tvar parentId = store.getParent(taskId);\r\n\t\t\t\t\tif (store.exists(parentId)) {\r\n\t\t\t\t\t\t// if task is not found in list - maybe it's parent is a split task and we should use parents index instead\r\n\t\t\t\t\t\tvar parent = store.getItem(parentId);\r\n\t\t\t\t\t\tif (this.$gantt.isSplitTask(parent)) {\r\n\t\t\t\t\t\t\treturn this.getItemTop(parentId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgetItemTopCache[taskId] = this.getRowTop(itemIndex);\r\n\t\t\t\treturn getItemTopCache[taskId];\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get height of the item by item id\r\n\t\t * @param {*} itemId\r\n\t\t */\r\n\t\tgetItemHeight: function (itemId) {\r\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\r\n\t\t\t\treturn quickPosition.getItemHeight(itemId);\r\n\t\t\t}\r\n\r\n\t\t\tif(!getItemHeightCache && this.$config.rowStore){\r\n\t\t\t\tthis._fillHeightCache(this.$config.rowStore);\r\n\t\t\t}\r\n\r\n\t\t\tif(getItemHeightCache[itemId] !== undefined){\r\n\t\t\t\treturn getItemHeightCache[itemId];\r\n\t\t\t}\r\n\r\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\r\n\r\n\t\t\tif(this.$config.rowStore){\r\n\t\t\t\tvar store = this.$config.rowStore;\r\n\t\t\t\tif(!store) return defaultHeight;\r\n\r\n\t\t\t\tvar item = store.getItem(itemId);\r\n\r\n\t\t\t\treturn getItemHeightCache[itemId] = item && item.row_height || defaultHeight;\r\n\t\t\t}else{\r\n\t\t\t\treturn defaultHeight;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_fillHeightCache: function(store){\r\n\t\t\tif(!store){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgetItemHeightCache = {};\r\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\r\n\t\t\tstore.eachItem(function(item){\r\n\t\t\t\treturn getItemHeightCache[item.id] = item && item.row_height || defaultHeight;\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tgetCacheStateTotalHeight: function(store){\r\n\r\n\t\t\tvar globalHeight = this.$getConfig().row_height;\r\n\t\t\tvar itemHeightCache = {};\r\n\t\t\tvar items = [];\r\n\t\t\tvar sumHeight = 0;\r\n\t\t\tif(store){\r\n\t\t\t\tstore.eachItem(function(item){\r\n\t\t\t\t\titems.push(item);\r\n\t\t\t\t\titemHeightCache[item.id] = item.row_height;\r\n\t\t\t\t\tsumHeight += item.row_height || globalHeight;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\r\n\t\t\treturn {\r\n\t\t\t\tglobalHeight: globalHeight,\r\n\t\t\t\titems: items,\r\n\t\t\t\tcount: items.length,\r\n\t\t\t\tsumHeight: sumHeight\r\n\t\t\t};\r\n\t\t},\r\n\t\tshouldClearHeightCache: function(oldState, newState){\r\n\r\n\t\t\tif(oldState.count != newState.count){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif(oldState.globalHeight != newState.globalHeight){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tif(oldState.sumHeight != newState.sumHeight){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfor(var i in oldState.items){\r\n\t\t\t\tvar newValue = newState.items[i];\r\n\t\t\t\tif(newValue !== undefined && newValue != oldState.items[i]){\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\t/**\r\n\t\t * Get total height of items\r\n\t\t */\r\n\t\tgetTotalHeight: function () {\r\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\r\n\t\t\t\treturn quickPosition.getTotalHeight();\r\n\t\t\t}\r\n\r\n\t\t\tif(totalHeightCache != -1){\r\n\t\t\t\treturn totalHeightCache;\r\n\t\t\t}\r\n\r\n\t\t\tif(this.$config.rowStore){\r\n\t\t\t\tvar store = this.$config.rowStore;\r\n\t\t\t\tthis._fillHeightCache(store);\r\n\t\t\t\tvar getHeight = this.getItemHeight.bind(this);\r\n\t\t\t\tvar visibleItems = store.getVisibleItems();\r\n\t\t\t\tvar totalHeight = 0;\r\n\r\n\t\t\t\tvisibleItems.forEach(function(item){\r\n\t\t\t\t\ttotalHeight += getHeight(item.id);\r\n\t\t\t\t});\r\n\r\n\t\t\t\ttotalHeightCache = totalHeight;\r\n\t\t\t\treturn totalHeight;\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get item by top position\r\n\t\t * @param {*} top\r\n\t\t */\r\n\t\tgetItemIndexByTopPosition: function (top) {\r\n\t\t\tif(this.$config.rowStore){\r\n\t\t\t\tif(quickPosition.canUseSimpleCalculation()){\r\n\t\t\t\t\treturn quickPosition.getItemIndexByTopPosition(top);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar store = this.$config.rowStore;\r\n\t\t\t\tfor(var i = 0; i < store.countVisible(); i++){\r\n\t\t\t\t\tvar current = this.getRowTop(i);\r\n\t\t\t\t\tvar next = this.getRowTop(i+1);\r\n\t\t\t\t\tif(!next){\r\n\t\t\t\t\t\tvar taskId = store.getIdByIndex(i);\r\n\t\t\t\t\t\tnext = current + this.getItemHeight(taskId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(top >= current && top < next){\r\n\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// GS-1723: If we iterated all tasks and didn't find the position, the target is below all other tasks\r\n\t\t\t\treturn store.countVisible() + 2;\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default createMixin;","function createHelper(view){\r\n\tvar cachedRowHeight = -1;\r\n\tvar canUseSimpleCalc = -1;\r\n\treturn {\r\n\t\tresetCache: function(){\r\n\t\t\tcachedRowHeight = -1;\r\n\t\t\tcanUseSimpleCalc = -1;\r\n\t\t},\r\n\t\t_getRowHeight: function(){\r\n\t\t\tif(cachedRowHeight === -1){\r\n\t\t\t\tcachedRowHeight = view.$getConfig().row_height;\r\n\t\t\t}\r\n\t\t\treturn cachedRowHeight;\r\n\t\t},\r\n\t\t_refreshState: function(){\r\n\t\t\tthis.resetCache();\r\n\t\t\tcanUseSimpleCalc = true;\r\n\t\t\tvar store = view.$config.rowStore;\r\n\t\t\tif(!store){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar globalRowHeight = this._getRowHeight();\r\n\t\t\tfor (var i=0; i<store.fullOrder.length; i++) {\r\n\t\t\t\tvar item = store.getItem(store.fullOrder[i]);\r\n\t\t\t\t// GS-1491: ignore the task when it is filtered:\r\n\t\t\t\tif (!item) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif(item.row_height && item.row_height !== globalRowHeight){\r\n\t\t\t\t\tcanUseSimpleCalc = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t},\r\n\t\tcanUseSimpleCalculation: function(){\r\n\t\t\tif(canUseSimpleCalc === -1){\r\n\t\t\t\tthis._refreshState();\r\n\t\t\t}\r\n\t\t\treturn canUseSimpleCalc;\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get top coordinate by row index (order)\r\n\t\t * @param {number} index\r\n\t\t */\r\n\t\tgetRowTop: function(index){\r\n\t\t\tvar store = view.$config.rowStore;\r\n\t\t\tif(!store){\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\treturn index * this._getRowHeight();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get height of the item by item id\r\n\t\t * @param {*} itemId\r\n\t\t */\r\n\t\tgetItemHeight: function (itemId) {\r\n\t\t\treturn this._getRowHeight();\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get total height of items\r\n\t\t */\r\n\t\tgetTotalHeight: function () {\r\n\t\t\tif(view.$config.rowStore){\r\n\t\t\t\tvar store = view.$config.rowStore;\r\n\t\t\t\treturn store.countVisible() * this._getRowHeight();\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Get item by top position\r\n\t\t * @param {*} top\r\n\t\t */\r\n\t\tgetItemIndexByTopPosition: function (top) {\r\n\t\t\tif(view.$config.rowStore){\r\n\t\t\t\treturn Math.floor(top / this._getRowHeight());\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default createHelper;","var createStaticBgHelper = function(){\r\n\treturn {\r\n\t\trender: function () { },\r\n\t\tdestroy: function () { }\r\n\t};\r\n};\r\n\r\nexport default {\r\n\tcreate: function(){\r\n\t\treturn createStaticBgHelper();\r\n\t}\r\n};\r\n\r\n","import ScaleHelper from \"./scales_ignore\";\r\nimport eventable from \"../../../utils/eventable\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport * as helpers from \"../../../utils/helpers\";\r\nimport topPositionMixin from \"../row_position_mixin\";\r\nimport canvasRender from \"./tasks_canvas_render\";\r\nimport createLayerConfig from \"./timeline_layers\";\r\n\r\nvar Timeline = function(parent, config, factory, gantt){\r\n\tthis.$config = utils.mixin({}, config || {});\r\n\tthis.$scaleHelper = new ScaleHelper(gantt);\r\n\tthis.$gantt = gantt;\r\n\tthis._posFromDateCache = {};\r\n\tthis._timelineDragScroll = null;\r\n\tutils.mixin(this, topPositionMixin(this));\r\n\teventable(this);\r\n};\r\n\r\nTimeline.prototype = {\r\n\tinit: function(container) {\r\n\t\tcontainer.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\";\r\n\t\tthis.$task = container.childNodes[0];\r\n\r\n\t\tthis.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\";\r\n\t\tthis.$task_scale = this.$task.childNodes[0];\r\n\r\n\t\tthis.$task_data = this.$task.childNodes[1];\r\n\t\tconst taskBg = \"<div class='gantt_task_bg'></div>\";\r\n\t\tconst links = \"<div class='gantt_links_area'></div>\";\r\n\t\tconst taskBars = \"<div class='gantt_bars_area'></div>\";\r\n\r\n\t\tconst taskConstraints = \"<div class='gantt_task_constraints'></div>\";\r\n\t\tconst taskDeadlines = \"<div class='gantt_task_deadlines'></div>\";\r\n\t\tconst taskBaselines = \"<div class='gantt_task_baselines'></div>\";\r\n\r\n\t\tthis.$task_data.innerHTML = taskBg + taskBaselines + links + taskBars + taskConstraints + taskDeadlines;\r\n\r\n\t\tthis.$task_bg = this.$task_data.childNodes[0];\r\n\t\tthis.$task_baselines = this.$task_data.childNodes[1];\r\n\t\tthis.$task_links = this.$task_data.childNodes[2];\r\n\t\tthis.$task_bars = this.$task_data.childNodes[3];\r\n\t\tthis.$task_constraints = this.$task_data.childNodes[4];\r\n\t\tthis.$task_deadlines = this.$task_data.childNodes[5];\r\n\r\n\t\tthis._tasks = {\r\n\t\t\tcol_width: 0,\r\n\t\t\twidth: [], // width of each column\r\n\t\t\tfull_width: 0, // width of all columns\r\n\t\t\ttrace_x: [],\r\n\t\t\trendered: {}\r\n\t\t};\r\n\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar attr = config[this.$config.bind + \"_attribute\"];\r\n\t\tvar linksAttr = config[this.$config.bindLinks + \"_attribute\"];\r\n\t\tif(!attr && this.$config.bind){\r\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\r\n\t\t}\r\n\t\tif(!linksAttr && this.$config.bindLinks){\r\n\t\t\tlinksAttr = \"data-\" + this.$config.bindLinks + \"-id\";\r\n\t\t}\r\n\t\tthis.$config.item_attribute = attr || null;\r\n\t\tthis.$config.link_attribute = linksAttr || null;\r\n\r\n\t\tvar layers = this._createLayerConfig();\r\n\t\tif(!this.$config.layers){\r\n\t\t\tthis.$config.layers = layers.tasks;\r\n\t\t}\r\n\t\tif(!this.$config.linkLayers){\r\n\t\t\tthis.$config.linkLayers = layers.links;\r\n\t\t}\r\n\r\n\t\tthis._attachLayers(this.$gantt);\r\n\r\n\t\tthis.callEvent(\"onReady\", []);\r\n\t\t//this.refresh();\r\n\t\tif (this.$gantt.ext.dragTimeline) {\r\n\t\t\tthis._timelineDragScroll = this.$gantt.ext.dragTimeline.create();\r\n\t\t\tthis._timelineDragScroll.attach(this);\r\n\t\t}\r\n\t},\r\n\r\n\tsetSize: function(width, height){\r\n\t\tvar config = this.$getConfig();\r\n\r\n\t\tif(width*1 === width){\r\n\t\t\tthis.$config.width = width;\r\n\t\t}\r\n\t\tif(height*1 === height){\r\n\r\n\t\t\tthis.$config.height = height;\r\n\t\t\tvar dataHeight = Math.max(this.$config.height - config.scale_height);\r\n\t\t\tthis.$task_data.style.height = dataHeight + 'px';\r\n\t\t}\r\n\r\n\t\tthis.refresh();\r\n\t\tthis.$task_bg.style.backgroundImage = \"\";\r\n\r\n\t\tif(config.smart_rendering && this.$config.rowStore){\r\n\t\t\tthis.$task_bg.style.height = this.getTotalHeight() +\"px\";\r\n\t\t}else{\r\n\t\t\tthis.$task_bg.style.height = \"\";\r\n\t\t}\r\n\r\n\t\tvar scale = this._tasks;\r\n\t\t//timeline area layers\r\n\t\tvar data_els = this.$task_data.childNodes;\r\n\t\tfor(var i= 0, len = data_els.length; i < len; i++){\r\n\t\t\tvar el = data_els[i];\r\n\t\t\tif(el.hasAttribute(\"data-layer\") && el.style)\r\n\t\t\t\tel.style.width = scale.full_width + \"px\";\r\n\t\t}\r\n\t},\r\n\r\n\tisVisible: function(){\r\n\t\tif(this.$parent && this.$parent.$config){\r\n\t\t\treturn !this.$parent.$config.hidden;\r\n\t\t}else{\r\n\t\t\treturn this.$task.offsetWidth;\r\n\t\t}\r\n\t},\r\n\r\n\tgetSize: function(){\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar store = this.$config.rowStore;\r\n\r\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\r\n\t\t\tcontentWidth = this.isVisible() ? this._tasks.full_width : 0;\r\n\r\n\t\treturn {\r\n\t\t\tx: this.isVisible() ? this.$config.width : 0,\r\n\t\t\ty: this.isVisible() ? this.$config.height : 0,\r\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\r\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\r\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\r\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\r\n\t\t};\r\n\t},\r\n\r\n\tscrollTo: function(left, top){\r\n\t\tif(!this.isVisible())\r\n\t\t\treturn;\r\n\r\n\t\tvar scrolled = false;\r\n\r\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\r\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\r\n\t\tif(top*1 === top){\r\n\t\t\tthis.$config.scrollTop = top;\r\n\t\t\tthis.$task_data.scrollTop = this.$config.scrollTop;\r\n\t\t\tscrolled = true;\r\n\t\t}\r\n\t\tif (left*1 === left){\r\n\t\t\tthis.$task.scrollLeft = left;\r\n\t\t\tthis.$config.scrollLeft = this.$task.scrollLeft;\r\n\t\t\tthis._refreshScales();\r\n\t\t\tscrolled = true;\r\n\t\t}\r\n\r\n\t\tif(scrolled){\r\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\r\n\t\t}\r\n\t},\r\n\r\n\t_refreshScales: function _refreshScales() {\r\n\t\tif(!this.isVisible())\r\n\t\t\treturn;\r\n\r\n\t\tvar config = this.$getConfig();\r\n\t\tif (!config.smart_scales) return;\r\n\r\n\t\tvar viewPort = this.getViewPort();\r\n\r\n\t\tvar scales = this._scales;\r\n\t\tthis.$task_scale.innerHTML = this._getScaleChunkHtml(scales, viewPort.x, viewPort.x_end);\r\n\t},\r\n\r\n\tgetViewPort: function(){\r\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\r\n\t\tvar scrollTop = this.$config.scrollTop || 0;\r\n\t\tvar height = this.$config.height || 0;\r\n\t\tvar width = this.$config.width || 0;\r\n\t\treturn {\r\n\t\t\ty: scrollTop,\r\n\t\t\ty_end: scrollTop + height,\r\n\t\t\tx: scrollLeft,\r\n\t\t\tx_end: scrollLeft + width,\r\n\t\t\theight: height,\r\n\t\t\twidth: width\r\n\t\t};\r\n\t},\r\n\r\n\t_createLayerConfig: createLayerConfig,\r\n\r\n\t_attachLayers: function(gantt){\r\n\t\tthis._taskLayers = [];\r\n\t\tthis._linkLayers = [];\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\r\n\r\n\t\tif(this.$config.bind){\r\n\r\n\t\t\tthis._bindStore();\r\n\t\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\r\n\r\n\t\t\tif(!taskRenderer){\r\n\t\t\t\ttaskRenderer = layers.createDataRender({\r\n\t\t\t\t\tname: this.$config.bind,\r\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\ttaskRenderer.container = function(){ return self.$task_data;};\r\n\r\n\t\t\tvar taskLayers = this.$config.layers;\r\n\t\t\tfor(var i = 0; taskLayers && i < taskLayers.length; i++){\r\n\t\t\t\tvar layer = taskLayers[i];\r\n\r\n\t\t\t\tif(typeof layer == \"string\"){\r\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(typeof layer == \"function\" || (layer && layer.render && layer.update)){\r\n\t\t\t\t\tlayer = {renderer: layer};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlayer.view = this;\r\n\r\n\t\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\r\n\t\t\t\tthis._taskLayers.push(bar_layer);\r\n\t\t\t\tif(layer.expose){\r\n\t\t\t\t\tthis._taskRenderer = taskRenderer.getLayer(bar_layer);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._initStaticBackgroundRender();\r\n\t\t}\r\n\r\n\t\tif(this.$config.bindLinks){\r\n\t\t\tself.$config.linkStore = self.$gantt.getDatastore(self.$config.bindLinks);\r\n\r\n\t\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\r\n\r\n\t\t\tif(!linkRenderer){\r\n\t\t\t\tlinkRenderer = layers.createDataRender({\r\n\t\t\t\t\tname: this.$config.bindLinks,\r\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tvar linkLayers = this.$config.linkLayers;\r\n\t\t\tfor(var i = 0; linkLayers && i < linkLayers.length; i++){\r\n\r\n\t\t\t\tif(typeof layer == \"string\"){\r\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar layer = linkLayers[i];\r\n\t\t\t\tlayer.view = this;\r\n\t\t\t//\tlayer.getViewPort = getViewPort;\r\n\t\t\t//\tsubscribeSmartRender(layer);\r\n\t\t\t\tvar linkLayer = linkRenderer.addLayer(layer);\r\n\t\t\t\tthis._taskLayers.push(linkLayer);\r\n\t\t\t\tif(linkLayers[i].expose){\r\n\t\t\t\t\tthis._linkRenderer = linkRenderer.getLayer(linkLayer);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t_initStaticBackgroundRender: function(){\r\n\t\tvar self = this;\r\n\t\tvar staticRender = canvasRender.create();\r\n\t\tvar store = self.$config.rowStore;\r\n\t\tif(!store) return;\r\n\r\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", function(id, item, mode){\r\n\t\t\tif(id !== null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(!self.isVisible())\r\n\t\t\t\treturn;\r\n\t\t\tvar config = self.$getConfig();\r\n\t\t\tif(config.static_background || config.timeline_placeholder) {\r\n\t\t\t\tvar store = self.$gantt.getDatastore(self.$config.bind);\r\n\t\t\t\tvar staticBgContainer = self.$task_bg_static;\r\n\t\t\t\tif(!staticBgContainer){\r\n\t\t\t\t\tstaticBgContainer = document.createElement(\"div\");\r\n\t\t\t\t\tstaticBgContainer.className = \"gantt_task_bg\";\r\n\t\t\t\t\tself.$task_bg_static = staticBgContainer;\r\n\t\t\t\t\tif(self.$task_bg.nextSibling){\r\n\t\t\t\t\t\tself.$task_data.insertBefore(staticBgContainer, self.$task_bg.nextSibling);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tself.$task_data.appendChild(staticBgContainer);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (store) {\r\n\t\t\t\t\tvar staticBackgroundHeight = self.getTotalHeight();\r\n\t\t\t\t\tif (config.timeline_placeholder){\r\n\t\t\t\t\t\tstaticBackgroundHeight = config.timeline_placeholder.height || self.$task_data.offsetHeight || 99999;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstaticRender.render(staticBgContainer, config, self.getScale(), staticBackgroundHeight, self.getItemHeight(item ? item.id : null));\r\n\t\t\t\t}\r\n\t\t\t}else if(config.static_background){\r\n\t\t\t\tif(self.$task_bg_static && self.$task_bg_static.parentNode){\r\n\t\t\t\t\tself.$task_bg_static.parentNode.removeChild(self.$task_bg_static);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.attachEvent(\"onDestroy\", function () {\r\n\t\t\tstaticRender.destroy();\r\n\t\t});\r\n\t\tthis._initStaticBackgroundRender = function(){};//init once\r\n\t},\r\n\r\n\t_clearLayers: function(gantt){\r\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\r\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\r\n\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\r\n\r\n\t\tif (this._taskLayers) {\r\n\t\t\tfor(var i = 0; i < this._taskLayers.length; i++){\r\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this._linkLayers) {\r\n\t\t\tfor(var i = 0; i < this._linkLayers.length; i++){\r\n\t\t\t\tlinkRenderer.removeLayer(this._linkLayers[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._linkLayers = [];\r\n\t\tthis._taskLayers = [];\r\n\t},\r\n\r\n\t_render_tasks_scales: function _render_tasks_scales() {\r\n\t\tvar config = this.$getConfig();\r\n\r\n\t\tvar scales_html = \"\",\r\n\t\t\touter_width = 0,\r\n\t\t\tscale_height = 0;\r\n\r\n\t\tvar state = this.$gantt.getState();\r\n\r\n\t\tif (this.isVisible()) {\r\n\t\t\tvar helpers = this.$scaleHelper;\r\n\t\t\tvar scales = this._getScales();\r\n\t\t\tscale_height = config.scale_height;\r\n\r\n\t\t\tvar availWidth = this.$config.width;\r\n\t\t\tif(config.autosize == \"x\" || config.autosize == \"xy\"){\r\n\t\t\t\tavailWidth = Math.max(config.autosize_min_width, 0);\r\n\t\t\t}\r\n\r\n\t\t\tvar cfgs = helpers.prepareConfigs(scales, config.min_column_width, availWidth, scale_height - 1, state.min_date, state.max_date, config.rtl);\r\n\t\t\tvar cfg = this._tasks = cfgs[cfgs.length - 1];\r\n\t\t\tthis._scales = cfgs;\r\n\t\t\tthis._posFromDateCache = {};\r\n\r\n\t\t\tscales_html = this._getScaleChunkHtml(cfgs, 0, this.$config.width);\r\n\r\n\t\t\touter_width = cfg.full_width + \"px\";//cfg.full_width + (this._scroll_sizes().y ? scrollSizes.scroll_size : 0) + \"px\";\r\n\t\t\tscale_height += \"px\";\r\n\t\t}\r\n\r\n\t\tthis.$task_scale.style.height = scale_height;\r\n\r\n\t\tthis.$task_data.style.width =\r\n\t\t\tthis.$task_scale.style.width = outer_width;\r\n\r\n\t\tthis.$task_scale.innerHTML = scales_html;\r\n\r\n\t},\r\n\r\n\t_getScaleChunkHtml: function _get_scale_chunk_html (scales, fromPos, toPos) {\r\n\t\tvar templates = this.$gantt.templates;\r\n\t\tvar html = [];\r\n\r\n\t\tvar css = templates.scale_row_class;\r\n\t\tfor (var i = 0; i < scales.length; i++) {\r\n\t\t\tvar cssClass = \"gantt_scale_line\";\r\n\t\t\tvar tplClass = css(scales[i]);\r\n\t\t\tif (tplClass) {\r\n\t\t\t\tcssClass += \" \" + tplClass;\r\n\t\t\t}\r\n\r\n\t\t\thtml.push(\"<div class=\\\"\" + cssClass + \"\\\" style=\\\"height:\" + (scales[i].height) +\r\n\t\t\t\t\"px;position:relative;line-height:\" + (scales[i].height) + \"px\\\">\" + this._prepareScaleHtml(scales[i], fromPos, toPos, i) + \"</div>\");\r\n\t\t}\r\n\r\n\t\treturn html.join(\"\");\r\n\t},\r\n\t_prepareScaleHtml: function _prepare_scale_html(config, fromPos, toPos, index) {\r\n\t\tvar globalConfig = this.$getConfig();\r\n\t\tvar globalTemplates = this.$gantt.templates;\r\n\r\n\t\tvar cells = [];\r\n\t\tvar date = null, css = null;\r\n\r\n\t\tvar content = config.format || config.template || config.date;\r\n\r\n\t\tif(typeof content === \"string\"){\r\n\t\t\tcontent = this.$gantt.date.date_to_str(content);\r\n\t\t}\r\n\r\n\t\tvar startIndex = 0,\r\n\t\t\tendIndex = config.count;\r\n\r\n\t\tif (globalConfig.smart_scales && (!isNaN(fromPos) && !isNaN(toPos))) {\r\n\t\t\tstartIndex = helpers.findBinary(config.left, fromPos);\r\n\t\t\tendIndex = helpers.findBinary(config.left, toPos) + 1;\r\n\t\t}\r\n\r\n\t\tcss = config.css || function () {\r\n\t\t\t};\r\n\t\tif (!config.css && globalConfig.inherit_scale_class) {\r\n\t\t\tcss = globalTemplates.scale_cell_class;\r\n\t\t}\r\n\r\n\t\tfor (var i = startIndex; i < endIndex; i++) {\r\n\t\t\tif (!config.trace_x[i]) break;\r\n\r\n\t\t\tdate = new Date(config.trace_x[i]);\r\n\t\t\tvar value = content.call(this, date),\r\n\t\t\t\twidth = config.width[i],\r\n\t\t\t\theight = config.height,\r\n\t\t\t\tleft = config.left[i],\r\n\t\t\t\tstyle = \"\",\r\n\t\t\t\ttemplate = \"\",\r\n\t\t\t\tcssclass = \"\";\r\n\r\n\t\t\tif (width) {\r\n\t\t\t\tvar position = globalConfig.smart_scales ? (\"position:absolute;left:\" + left + \"px\") : \"\";\r\n\r\n\t\t\t\tstyle = \"width:\" + (width) + \"px;\" + position;\r\n\t\t\t\t// GS-1188: Display the scale value in the viewport for long cells\r\n\t\t\t\tconst viewPort = this.getViewPort();\r\n\t\t\t\tconst floatConfig = (globalConfig.scales[index] || {}).sticky; // for old scale settings\r\n\r\n\t\t\t\tlet labelPosition = '';\r\n\t\t\t\tconst approxLabelWidth = 70;\r\n\t\t\t\t// if sticky config is not specified - sticky labels are enabled for long cells only\r\n\t\t\t\tif ((floatConfig !== false && width > approxLabelWidth) || floatConfig === true) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (left < viewPort.x && left + width/2 - approxLabelWidth/2 < viewPort.x){\r\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${viewPort.x  - left + 10}px;' `;\r\n\t\t\t\t\t} else if(left + width/2 + approxLabelWidth/2 > viewPort.x_end && width > approxLabelWidth){\r\n\t\t\t\t\t\tlet labelPos = viewPort.x_end - left - 10;\r\n\t\t\t\t\t\tlet translateValue = \"-100%\";\r\n\t\t\t\t\t\tif(labelPos < approxLabelWidth) {\r\n\t\t\t\t\t\t\tlabelPos = approxLabelWidth;\r\n\t\t\t\t\t\t\ttranslateValue = `-${labelPos}px`;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${labelPos}px;transform: translate(${translateValue},0);' `;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcssclass = \"gantt_scale_cell\" + (i == config.count - 1 ? \" gantt_last_cell\" : \"\");\r\n\r\n\t\t\t\ttemplate = css.call(this, date);\r\n\t\t\t\tif (template) cssclass += \" \" + template;\r\n\r\n\t\t\t\tvar ariaAttr = this.$gantt._waiAria.getTimelineCellAttr(value);\r\n\t\t\t\tvar cell = `<div class='${cssclass}' ${ariaAttr} style='${style}'><span ${labelPosition}>${value}</span></div>`;\r\n\t\t\t\tcells.push(cell);\r\n\t\t\t} else {\r\n\t\t\t\t//do not render ignored cells\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\treturn cells.join(\"\");\r\n\t},\r\n\tdateFromPos: function dateFromPos(x) {\r\n\t\tvar scale = this._tasks;\r\n\t\tif (x < 0 || x > scale.full_width || !scale.full_width) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar ind = helpers.findBinary(this._tasks.left, x);\r\n\t\tvar summ = this._tasks.left[ind];\r\n\r\n\t\tvar col_width = scale.width[ind] || scale.col_width;\r\n\t\tvar part = 0;\r\n\t\tif (col_width) {\r\n\t\t\tpart = (x - summ) / col_width;\r\n\t\t\tif(scale.rtl){\r\n\t\t\t\tpart = 1 - part;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar unit = 0;\r\n\t\tif (part) {\r\n\t\t\tunit = this._getColumnDuration(scale, scale.trace_x[ind]);\r\n\t\t}\r\n\r\n\t\tvar date = new Date(scale.trace_x[ind].valueOf() + Math.round(part * unit));\r\n\t\treturn date;\r\n\t},\r\n\tposFromDate: function posFromDate(date) {\r\n\t\tif (!this.isVisible())\r\n\t\t\treturn 0;\r\n\r\n\t\tif(!date){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tvar dateValue = String(date.valueOf());\r\n\r\n\t\tif(this._posFromDateCache[dateValue] !== undefined){\r\n\t\t\treturn this._posFromDateCache[dateValue];\r\n\t\t}\r\n\t\tvar ind = this.columnIndexByDate(date);\r\n\t\tthis.$gantt.assert(ind >= 0, \"Invalid day index\");\r\n\r\n\t\tvar wholeCells = Math.floor(ind);\r\n\t\tvar partCell = ind % 1;\r\n\r\n\t\tvar pos = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\r\n\t\tif (wholeCells == this._tasks.width.length)\r\n\t\t\tpos += this._tasks.width[this._tasks.width.length - 1];\r\n\t\t//for(var i=1; i <= wholeCells; i++)\r\n\t\t//\tpos += gantt._tasks.width[i-1];\r\n\r\n\t\tif (partCell) {\r\n\t\t\tif (wholeCells < this._tasks.width.length) {\r\n\t\t\t\tpos += this._tasks.width[wholeCells] * (partCell % 1);\r\n\t\t\t} else {\r\n\t\t\t\tpos += 1;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar roundPos = Math.round(pos);\r\n\t\tthis._posFromDateCache[dateValue] = roundPos;\r\n\t\treturn Math.round(roundPos);\r\n\t},\r\n\r\n\t_getNextVisibleColumn: function (startIndex, columns, ignores) {\r\n\t\t// iterate columns to the right\r\n\t\tvar date = +columns[startIndex];\r\n\t\tvar visibleDateIndex = startIndex;\r\n\t\twhile (ignores[date]) {\r\n\t\t\tvisibleDateIndex++;\r\n\t\t\tdate = +columns[visibleDateIndex];\r\n\t\t}\r\n\r\n\t\treturn visibleDateIndex;\r\n\t},\r\n\t_getPrevVisibleColumn: function (startIndex, columns, ignores) {\r\n\t\t// iterate columns to the left\r\n\t\tvar date = +columns[startIndex];\r\n\t\tvar visibleDateIndex = startIndex;\r\n\t\twhile (ignores[date]) {\r\n\t\t\tvisibleDateIndex--;\r\n\t\t\tdate = +columns[visibleDateIndex];\r\n\t\t}\r\n\t\treturn visibleDateIndex;\r\n\t},\r\n\t_getClosestVisibleColumn: function (startIndex, columns, ignores) {\r\n\t\tvar visibleDateIndex = this._getNextVisibleColumn(startIndex, columns, ignores);\r\n\t\tif (!columns[visibleDateIndex]) {\r\n\t\t\tvisibleDateIndex =  this._getPrevVisibleColumn(startIndex, columns, ignores);\r\n\t\t}\r\n\t\treturn visibleDateIndex;\r\n\t},\r\n\tcolumnIndexByDate: function columnIndexByDate(date) {\r\n\t\tvar pos = new Date(date).valueOf();\r\n\t\tvar days = this._tasks.trace_x_ascending,\r\n\t\t\tignores = this._tasks.ignore_x;\r\n\r\n\t\tvar state = this.$gantt.getState();\r\n\r\n\t\tif (pos <= state.min_date) {\r\n\t\t\tif(this._tasks.rtl){\r\n\t\t\t\treturn days.length;\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (pos >= state.max_date) {\r\n\t\t\tif(this._tasks.rtl){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn days.length;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar dateIndex = helpers.findBinary(days, pos);\r\n\r\n\t\tvar visibleIndex = this._getClosestVisibleColumn(dateIndex, days, ignores);\r\n\t\tvar visibleDate = days[visibleIndex];\r\n\t\tvar transition = this._tasks.trace_index_transition;\r\n\r\n\t\tif(!visibleDate){\r\n\t\t\tif(transition){\r\n\t\t\t\treturn transition[0];\r\n\t\t\t}else{\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar part = ((date - days[visibleIndex]) / this._getColumnDuration(this._tasks, days[visibleIndex]));\r\n\t\tif(transition){\r\n\t\t\treturn transition[visibleIndex] + (1 - part);\r\n\t\t}else{\r\n\t\t\treturn visibleIndex + part;\r\n\t\t}\r\n\t},\r\n\tgetItemPosition:function (task, start_date, end_date) {\r\n\t\tvar xLeft, xRight, width;\r\n\r\n\t\tlet displayStart = start_date || task.start_date || task.$auto_start_date;\r\n\t\tlet displayEnd = end_date || task.end_date || task.$auto_end_date;\r\n\t\tif(this._tasks.rtl){\r\n\t\t\txRight = this.posFromDate(displayStart);\r\n\t\t\txLeft = this.posFromDate(displayEnd);\r\n\t\t}else{\r\n\t\t\txLeft = this.posFromDate(displayStart);\r\n\t\t\txRight = this.posFromDate(displayEnd);\r\n\t\t}\r\n\t\twidth =  Math.max((xRight - xLeft), 0);\r\n\r\n\t\tvar y = this.getItemTop(task.id);\r\n\r\n\t\tvar height = this.getBarHeight(task.id);\r\n\t\tvar rowHeight = this.getItemHeight(task.id);\r\n\t\treturn {\r\n\t\t\tleft: xLeft,\r\n\t\t\ttop: y,\r\n\t\t\theight: height,\r\n\t\t\twidth: width,\r\n\t\t\trowHeight: rowHeight\r\n\t\t};\r\n\t},\r\n\r\n\tgetBarHeight: function(taskId, isMilestoneRender){\r\n\t\tvar config = this.$getConfig();\r\n\r\n\t\tvar task = this.$config.rowStore.getItem(taskId);\r\n\t\t// height of the bar item\r\n\t\tvar height = task.task_height || task.bar_height || config.bar_height || config.task_height;\r\n\t\tvar rowHeight = this.getItemHeight(taskId);\r\n\r\n\t\tif (height == \"full\") {\r\n\t\t\tvar offset = config.bar_height_padding || 3;\r\n\t\t\theight = rowHeight - offset;\r\n\t\t}\r\n\t\t//item height cannot be bigger than row height\r\n\t\theight = Math.min(height, rowHeight);\r\n\t\tif (isMilestoneRender) { // to get correct height for addapting Milestone to the row\r\n\t\t\theight = Math.round(height / Math.sqrt(2));\r\n\t\t}\r\n\t\treturn Math.max(height, 0);\r\n\t},\r\n\r\n\tgetScale: function(){\r\n\t\treturn this._tasks;\r\n\t},\r\n\r\n\t_getScales: function _get_scales() {\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar helpers = this.$scaleHelper;\r\n\t\tvar scales = [helpers.primaryScale(config)].concat(helpers.getSubScales(config));\r\n\r\n\t\thelpers.sortScales(scales);\r\n\t\treturn scales;\r\n\t},\r\n\r\n\t_getColumnDuration: function _get_coll_duration(scale, date) {\r\n\t\treturn this.$gantt.date.add(date, scale.step, scale.unit) - date;\r\n\t},\r\n\t_bindStore: function () {\r\n\t\tif (this.$config.bind){\r\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\r\n\t\t\tthis.$config.rowStore = rowStore;\r\n\t\t\tif(rowStore && !rowStore._timelineCacheAttached){\r\n\t\t\t\tvar self = this;\r\n\t\t\t\trowStore._timelineCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\r\n\t\t\t\t\tself._resetTopPositionHeight();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_unbindStore: function(){\r\n\t\tif (this.$config.bind){\r\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\r\n\t\t\tif(rowStore && rowStore._timelineCacheAttached){\r\n\t\t\t\trowStore.detachEvent(rowStore._timelineCacheAttached);\r\n\t\t\t\trowStore._timelineCacheAttached = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\trefresh: function(){\r\n\t\tthis._bindStore();\r\n\r\n\t\tif(this.$config.bindLinks) {\r\n\t\t\tthis.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks);\r\n\t\t}\r\n\r\n\t\tthis._resetTopPositionHeight();\r\n\t\tthis._resetHeight();\r\n\t\tthis._initStaticBackgroundRender();\r\n\t\tthis._render_tasks_scales();\r\n\t},\r\n\r\n\tdestructor: function(){\r\n\t\tvar gantt = this.$gantt;\r\n\t\tthis._clearLayers(gantt);\r\n\t\tthis._unbindStore();\r\n\t\tthis.$task = null;\r\n\t\tthis.$task_scale = null;\r\n\t\tthis.$task_data = null;\r\n\t\tthis.$task_bg = null;\r\n\t\tthis.$task_links = null;\r\n\t\tthis.$task_bars = null;\r\n\r\n\t\tthis.$gantt = null;\r\n\r\n\t\tif(this.$config.rowStore){\r\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\r\n\t\t\tthis.$config.rowStore = null;\r\n\t\t}\r\n\t\tif(this.$config.linkStore){\r\n\t\t\tthis.$config.linkStore = null;\r\n\t\t}\r\n\r\n\t\tif(this._timelineDragScroll) {\r\n\t\t\tthis._timelineDragScroll.destructor();\r\n\t\t\tthis._timelineDragScroll = null;\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\t\tthis.detachAllEvents();\r\n\r\n\t}\r\n};\r\n\r\nexport default Timeline;","\r\nexport default function(){\r\n\tvar self = this;\r\n\tvar taskFilter = function(){\r\n\t\treturn self.isVisible();\r\n\t};\r\n\r\n\tvar barVisible = function(id, task){\r\n\t\treturn !task.hide_bar;\r\n\t};\r\n\r\n\tconst gantt = this.$gantt;\r\n\r\n\tvar taskLayers = [\r\n\t\t{\r\n\t\t\texpose: true,\r\n\t\t\trenderer: this.$gantt.$ui.layers.taskBar(),\r\n\t\t\tcontainer: this.$task_bars,\r\n\t\t\tfilter: [taskFilter, barVisible]\r\n\t\t}\r\n\t];\r\n\r\n\ttaskLayers.push({\r\n\t\trenderer: this.$gantt.$ui.layers.taskBg(),\r\n\t\tcontainer: this.$task_bg,\r\n\t\tfilter: [\r\n\t\t\t//function(){\r\n\t\t\t//\treturn !self.$getConfig().static_background;\r\n\t\t\t//},\r\n\t\t\ttaskFilter\r\n\t\t]\r\n\t});\r\n\r\n\tvar linkLayers = [\r\n\t\t{\r\n\t\t\texpose: true,\r\n\t\t\trenderer: this.$gantt.$ui.layers.link(),\r\n\t\t\tcontainer: this.$task_links,\r\n\t\t\tfilter: [taskFilter]\r\n\t\t}\r\n\t];\r\n\r\n\treturn {\r\n\t\ttasks: taskLayers,\r\n\t\tlinks: linkLayers\r\n\t};\r\n\r\n};","const SENSITIVITY = 20;\r\nconst TIMEOUT = 50;\r\nconst SCROLLSTEP = 10;\r\n\r\nexport default class ScrollableGrid {\r\n\tpublic getCurrentX;\r\n\tprivate $gantt;\r\n\tprivate $grid;\r\n\tprivate _dnd;\r\n\tprivate _scrollView;\r\n\tprivate _scrollOrder: 0 | 1 | -1 = 0;\r\n\r\n\tconstructor(params) {\r\n\t\tconst {gantt, grid, dnd, getCurrentX} = params;\r\n\t\tthis.$gantt = gantt;\r\n\t\tthis.$grid = grid;\r\n\t\tthis._dnd = dnd;\r\n\t\tthis.getCurrentX = getCurrentX;\r\n\t\tthis._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX);\r\n\t\tthis.attachEvents();\r\n\t}\r\n\tattachEvents() {\r\n\t\tif (this.isScrollable()) {\r\n\t\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\r\n\t\t\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\r\n\t\t\t\tconst maxLeft = gridBoundingRect.right;\r\n\t\t\t\tconst minLeft = gridBoundingRect.left;\r\n\t\t\t\tconst currentX = this.getCurrentX(e.clientX);\r\n\r\n\t\t\t\tif (currentX >= maxLeft - SENSITIVITY) {\r\n\t\t\t\t\tthis.autoscrollRight();\r\n\t\t\t\t\tthis.autoscrollStart();\r\n\t\t\t\t}\r\n\t\t\t\tif (currentX <= minLeft + SENSITIVITY) {\r\n\t\t\t\t\tthis.autoscrollLeft();\r\n\t\t\t\t\tthis.autoscrollStart();\r\n\t\t\t\t}\r\n\t\t\t\tif (currentX < maxLeft - SENSITIVITY && currentX > minLeft + SENSITIVITY) {\r\n\t\t\t\t\tthis.autoscrollStop();\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t});\r\n\t\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\r\n\t\t\t\tthis.autoscrollStop();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tautoscrollStart() {\r\n\t\tif (this._scrollOrder === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst scrollStep = SCROLLSTEP * this._scrollOrder;\r\n\t\tconst scrollState = this._scrollView.getScrollState();\r\n\t\tthis._scrollView.scrollTo(scrollState.position + scrollStep);\r\n\t\tsetTimeout(() => { this.autoscrollStart(); }, TIMEOUT);\r\n\t}\r\n\tautoscrollRight() {\r\n\t\tthis._scrollOrder = 1;\r\n\t}\r\n\tautoscrollLeft() {\r\n\t\tthis._scrollOrder = -1;\r\n\t}\r\n\tautoscrollStop() {\r\n\t\tthis._scrollOrder = 0;\r\n\t}\r\n\tgetCorrection() {\r\n\t\tif (!this.isScrollable()) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this._scrollView.getScrollState().position;\r\n\t}\r\n\tisScrollable() {\r\n\t\treturn !!this.$grid.$config.scrollable;\r\n\t}\r\n}","import * as domHelpers from \"../../utils/dom_helpers\";\r\nimport ScrollableGrid from \"./scrollable_grid\";\r\n\r\nconst COLUMN_ID_ATTR_NAME = \"data-column-id\";\r\n\r\nexport class ColumnsGridDnd {\r\n\tprivate $gantt;\r\n\tprivate $grid;\r\n\tprivate _dragX;\r\n\tprivate _dnd;\r\n\tprivate _originAutoscroll;\r\n\tprivate _scrollableGrid: ScrollableGrid;\r\n\tprivate _draggedCell;\r\n\tprivate _targetMarker = null;\r\n\tprivate _gridConfig;\r\n\tconstructor(gantt, grid) {\r\n\t\tthis.$gantt = gantt;\r\n\t\tthis.$grid = grid;\r\n\t}\r\n\tinit() {\r\n\t\tconst DND = this.$gantt.$services.getService(\"dnd\");\r\n\t\tthis._dnd = new DND(this.$grid.$grid_scale, { updates_per_second: 60 });\r\n\t\tthis._scrollableGrid = new ScrollableGrid({\r\n\t\t\tgantt: this.$gantt,\r\n\t\t\tgrid: this.$grid,\r\n\t\t\tdnd: this._dnd,\r\n\t\t\tgetCurrentX: this.calculateCurrentPosition\r\n\t\t});\r\n\t\tthis.attachEvents();\r\n\t}\r\n\tattachEvents() {\r\n\t\tthis._dnd.attachEvent(\"onBeforeDragStart\", (obj, e) => {\r\n\t\t\tthis._draggedCell = this.$gantt.utils.dom.closest(e.target, \".gantt_grid_head_cell\");\r\n\t\t\tif(!this._draggedCell){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst columns = this.$grid.$getConfig().columns;\r\n\t\t\tconst columnName = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\r\n\t\t\tlet draggedColumn;\r\n\t\t\tlet draggedIndex;\r\n\t\t\tcolumns.map(function(column, index){\r\n\t\t\t\tif(column.name === columnName){\r\n\t\t\t\t\tdraggedColumn = column;\r\n\t\t\t\t\tdraggedIndex = index;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (this.$grid.callEvent(\"onBeforeColumnDragStart\", [{ draggedColumn, draggedIndex}]) === false) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._draggedCell || !draggedColumn) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis._gridConfig = this.$grid.$getConfig();\r\n\t\t\tthis._originAutoscroll = this.$gantt.config.autoscroll;\r\n\t\t\tthis.$gantt.config.autoscroll = false;\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tthis._dnd.attachEvent(\"onAfterDragStart\", (obj, e) => {\r\n\t\t\tif (!this._draggedCell) {\r\n\t\t\t\treturn; // GS-1333: don't try to reorder a column when we resize it\r\n\t\t\t}\r\n\t\t\tthis._dnd.config.column = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\r\n\t\t\tthis._dnd.config.marker.innerHTML = this._draggedCell.outerHTML;\r\n\t\t\tthis._dnd.config.marker.classList.add(\"gantt_column_drag_marker\");\r\n\t\t\tthis._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\";\r\n\t\t\tthis._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\";\r\n\t\t\tthis._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\");\r\n\t\t});\r\n\r\n\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\r\n\t\t\tif(!this._draggedCell){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._dragX = e.clientX;\r\n\t\t\tconst x = this.calculateCurrentPosition(e.clientX);\r\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\r\n\t\t\tthis.setMarkerPosition(x);\r\n\t\t\tthis.drawTargetMarker(columnIndexes);\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\r\n\t\t\tif (!this._draggedCell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\r\n\t\t\tconst targetIndex = columnIndexes.targetIndex;\r\n\t\t\tconst draggedIndex = columnIndexes.draggedIndex;\r\n\t\t\tconst columns = this.$grid.$getConfig().columns;\r\n\r\n\t\t\tconst draggedColumn = columns[draggedIndex];\r\n\t\t\tconst targetColumn = columns[targetIndex];\r\n\t\t\tif (this.$grid.callEvent(\"onColumnDragMove\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\r\n\t\t\t\tthis.cleanTargetMarker();\r\n\t\t\t\tthis.$gantt.render();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.$gantt.config.autoscroll = this._originAutoscroll;\r\n\t\t\tthis._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\");\r\n\t\t\tthis.cleanTargetMarker();\r\n\t\t\tthis.reorderColumns();\r\n\t\t});\r\n\r\n\t}\r\n\treorderColumns() {\r\n\t\tconst { targetIndex, draggedIndex } = this.findColumnsIndexes();\r\n\r\n\t\tconst columns = this.$grid.$getConfig().columns;\r\n\t\tconst draggedColumn = columns[draggedIndex];\r\n\t\tconst targetColumn = columns[targetIndex];\r\n\r\n\t\tif (this.$grid.callEvent(\"onBeforeColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (targetIndex === draggedIndex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcolumns.splice(draggedIndex, 1);\r\n\t\tcolumns.splice(targetIndex, 0, draggedColumn);\r\n\t\tthis.$gantt.render();\r\n\t\tthis.$grid.callEvent(\"onAfterColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]);\r\n\t}\r\n\tfindColumnsIndexes() {\r\n\t\tconst draggedId = this._dnd.config.column;\r\n\t\tconst columns = this.$grid.$getConfig().columns;\r\n\t\tlet targetIndex: number;\r\n\t\tlet draggedIndex: number;\r\n\t\tlet xBefore: number;\r\n\t\tlet xAfter: number;\r\n\t\tconst currentColumn = { startX: 0, endX: 0 };\r\n\r\n\t\tlet start = 0;\r\n\t\tlet end = columns.length - 1;\r\n\t\tlet compare = (a, b) => a <= b;\r\n\t\tlet next = (index) => ++index;\r\n\t\tif (this.$gantt.config.rtl) {\r\n\t\t\tstart = columns.length - 1;\r\n\t\t\tend = 0;\r\n\t\t\tcompare = (a, b) => a >= b;\r\n\t\t\tnext = (index) => --index;\r\n\t\t}\r\n\r\n\t\tlet columnRelativePos: number;\r\n\r\n\t\tconst relativeX = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\r\n\t\tfor (let i = start; compare(i, end); i = next(i)) {\r\n\t\t\tif (targetIndex !== undefined && draggedIndex !== undefined) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif(!columns[i].hide) {\r\n\t\t\t\tcurrentColumn.startX = currentColumn.endX;\r\n\t\t\t\tcurrentColumn.endX += columns[i].width;\r\n\r\n\t\t\t\t// if drop on a column or drop after the last column\r\n\t\t\t\tif (relativeX >= currentColumn.startX && (relativeX <= currentColumn.endX || !compare(next(i), end))) {\r\n\t\t\t\t\ttargetIndex = i;\r\n\t\t\t\t\txBefore = currentColumn.startX;\r\n\t\t\t\t\txAfter = currentColumn.endX;\r\n\t\t\t\t\tcolumnRelativePos = (relativeX - currentColumn.startX) / (currentColumn.endX - currentColumn.startX);\r\n\t\t\t\t}\r\n\t\t\t\tif (draggedId === columns[i].name) {\r\n\t\t\t\t\tdraggedIndex = i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\ttargetIndex,\r\n\t\t\tdraggedIndex,\r\n\t\t\txBefore,\r\n\t\t\txAfter,\r\n\t\t\tcolumnRelativePos\r\n\t\t};\r\n\t}\r\n\tsetMarkerPosition(x: number, y: number = 10) {\r\n\t\tconst { marker } = this._dnd.config;\r\n\t\tconst gridOffset = this._dnd._obj.getBoundingClientRect();\r\n\t\tmarker.style.top = `${gridOffset.y + y}px`;\r\n\t\tmarker.style.left = `${x}px`;\r\n\t}\r\n\tcalculateCurrentPosition = (eventX: number) => {\r\n\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\r\n\t\tconst maxLeft = gridBoundingRect.right;\r\n\t\tconst minLeft = gridBoundingRect.left;\r\n\t\tlet x = eventX;\r\n\t\tif (x > maxLeft) {\r\n\t\t\tx = maxLeft;\r\n\t\t}\r\n\t\tif (x < minLeft) {\r\n\t\t\tx = minLeft;\r\n\t\t}\r\n\t\treturn x;\r\n\t};\r\n\tdrawTargetMarker({ targetIndex, draggedIndex, xBefore, xAfter, columnRelativePos }) {\r\n\t\tif (!this._targetMarker) {\r\n\t\t\tthis._targetMarker = document.createElement(\"div\");\r\n\t\t\tdomHelpers.addClassName(this._targetMarker, \"gantt_grid_target_marker\");\r\n\t\t\tthis._targetMarker.style.display = \"none\";\r\n\t\t\tthis._targetMarker.style.height = `${this._gridConfig.scale_height}px`;\r\n\t\t}\r\n\r\n\t\t// marker can be detached after gantt.render\r\n\t\tif(!this._targetMarker.parentNode){\r\n\t\t\tthis.$grid.$grid_scale.appendChild(this._targetMarker);\r\n\t\t}\r\n\r\n\t\tlet nextPosition: number;\r\n\t\tif (targetIndex > draggedIndex) {\r\n\t\t\tnextPosition = xAfter;\r\n\t\t} else if (targetIndex < draggedIndex) {\r\n\t\t\tnextPosition = xBefore;\r\n\t\t} else {\r\n\t\t\tif(columnRelativePos > 0.5){\r\n\t\t\t\tnextPosition = xAfter;\r\n\t\t\t}else{\r\n\t\t\t\tnextPosition = xBefore;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._targetMarker.style.left = `${nextPosition}px`;\r\n\t\tthis._targetMarker.style.display = \"block\";\r\n\t}\r\n\tcleanTargetMarker() {\r\n\t\tif (this._targetMarker && this._targetMarker.parentNode) {\r\n\t\t\tthis.$grid.$grid_scale.removeChild(this._targetMarker);\r\n\t\t}\r\n\t\tthis._targetMarker = null;\r\n\t}\r\n}","function create(gantt){\r\n\tvar events = [];\r\n\r\n\treturn {\r\n\t\tdelegate:function(event, className, handler, root) {\r\n\t\t\tevents.push([event, className, handler, root]);\r\n\r\n\t\t\tvar helper = gantt.$services.getService(\"mouseEvents\");\r\n\t\t\thelper.delegate(event, className, handler, root);\r\n\t\t},\r\n\t\tdestructor: function(){\r\n\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\r\n\t\t\tfor(var i = 0; i < events.length; i++){\r\n\t\t\t\tvar h = events[i];\r\n\t\t\t\tmouseEvents.detach(h[0], h[1], h[2], h[3]);\r\n\t\t\t}\r\n\t\t\tevents = [];\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default create;","import * as domHelpers from \"../utils/dom_helpers\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport eventable from \"../../../utils/eventable\";\r\nimport gridResize from \"./grid_resize\";\r\nimport topPositionMixin from \"../row_position_mixin\";\r\nimport rowResize from \"./task_grid_row_resize\";\r\n\r\nimport ColumnDnd from \"../plugins/column_grid_dnd\";\r\n\r\nimport mouseEventContainer from \"../mouse_event_container\";\r\n\r\nvar Grid = function (parent, config, factory, gantt) {\r\n\tthis.$config = utils.mixin({}, config || {});\r\n\tthis.$gantt = gantt;\r\n\tthis.$parent = parent;\r\n\teventable(this);\r\n\tthis.$state = {};\r\n\tutils.mixin(this, topPositionMixin(this));\r\n};\r\n\r\n\r\nGrid.prototype = {\r\n\tinit: function(container) {\r\n\t\tvar gantt = this.$gantt;\r\n\t\tvar gridAriaAttr = gantt._waiAria.gridAttrString();\r\n\t\tvar gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\r\n\t\tvar _ganttConfig = this.$getConfig();\r\n\t\tvar reorderColumns = _ganttConfig.reorder_grid_columns || false;\r\n\t\tif (this.$config.reorder_grid_columns !== undefined) {\r\n\t\t\treorderColumns = this.$config.reorder_grid_columns;\r\n\t\t}\r\n\r\n\r\n\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + gridAriaAttr + \"></div>\";\r\n\t\tthis.$grid = container.childNodes[0];\r\n\r\n\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\r\n\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\r\n\r\n\t\tthis.$grid_scale = this.$grid.childNodes[0];\r\n\t\tthis.$grid_data = this.$grid.childNodes[1];\r\n\r\n\t\tvar attr = _ganttConfig[this.$config.bind + \"_attribute\"];\r\n\t\tif (!attr && this.$config.bind) {\r\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\r\n\t\t}\r\n\t\tthis.$config.item_attribute = attr || null;\r\n\r\n\t\tif (!this.$config.layers) {\r\n\t\t\tvar layers = this._createLayerConfig();\r\n\t\t\tthis.$config.layers = layers;\r\n\t\t}\r\n\r\n\t\tvar resizer = gridResize(gantt, this);\r\n\t\tresizer.init();\r\n\t\tthis._renderHeaderResizers = resizer.doOnRender;\r\n\t\tthis._mouseDelegates = mouseEventContainer(gantt);\r\n\r\n\t\tvar resizerrow = rowResize(gantt, this);\r\n\t\tresizerrow.init();\r\n\r\n\t\tthis._addLayers(this.$gantt);\r\n\t\tthis._initEvents();\r\n\r\n\t\tif (reorderColumns) {\r\n\t\t\tthis._columnDND = new ColumnDnd(gantt, this);\r\n\t\t\tthis._columnDND.init();\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onReady\", []);\r\n\t\t//this.refresh();\r\n\t},\r\n\r\n\t_validateColumnWidth: function (column, property) {\r\n\t\t// user can set {name:\"text\", width:\"200\",...} for some reason,\r\n\t\t// check and convert it to number when possible\r\n\t\tvar value = column[property];\r\n\t\tif (value && value != \"*\") {\r\n\t\t\tvar gantt = this.$gantt;\r\n\t\t\tvar numericWidth = value * 1;\r\n\t\t\tif (isNaN(numericWidth)) {\r\n\t\t\t\tgantt.assert(false, \"Wrong \" + property + \" value of column \" + column.name);\r\n\t\t\t} else {\r\n\t\t\t\tcolumn[property] = numericWidth;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tsetSize: function (width, height) {\r\n\t\tthis.$config.width = this.$state.width = width;\r\n\t\tthis.$config.height = this.$state.height = height;\r\n\r\n\t\t// TODO: maybe inherit and override in a subclass instead of extending here\r\n\r\n\t\tvar columns = this.getGridColumns(),\r\n\t\t\tinnerWidth = 0;\r\n\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar elasticColumns = config.grid_elastic_columns;\r\n\r\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\r\n\t\t\tthis._validateColumnWidth(columns[i], \"min_width\");\r\n\t\t\tthis._validateColumnWidth(columns[i], \"max_width\");\r\n\t\t\tthis._validateColumnWidth(columns[i], \"width\");\r\n\r\n\t\t\tinnerWidth += columns[i].width * 1;\r\n\t\t}\r\n\r\n\t\tvar outerWidth;\r\n\t\tif (isNaN(innerWidth) || !this.$config.scrollable) {\r\n\t\t\touterWidth = this._setColumnsWidth(width + 1);\r\n\t\t\tinnerWidth = outerWidth;\r\n\t\t}\r\n\r\n\t\tif(this.$config.scrollable && elasticColumns && !isNaN(innerWidth)){\r\n\t\t\t// GS-1352: Allow resizing the grid columns, then the grid width is increased\r\n\t\t\t// or keep the grid width, but don't allow column resize to affect the grid width\r\n\t\t\tlet columnProperty = \"width\";\r\n\t\t\tif (elasticColumns == \"min_width\"){\r\n\t\t\t\tcolumnProperty = \"min_width\";\r\n\t\t\t}\r\n\t\t\tlet newColumnWidth = 0;\r\n\t\t\tcolumns.forEach(function(col){\r\n\t\t\t\tnewColumnWidth += col[columnProperty] || config.min_grid_column_width;\r\n\t\t\t});\r\n\t\t\t//newColumnWidth--; // the total column width shouldn't match the outerWidth // GS-2190 reducing width seems to be not needed\r\n\t\t\tvar columnsWidth = Math.max(newColumnWidth, width);\r\n\t\t\tinnerWidth = this._setColumnsWidth(columnsWidth);\r\n\t\t\touterWidth = width;\r\n\t\t}\r\n\r\n\t\tif (this.$config.scrollable) {\r\n\t\t\tthis.$grid_scale.style.width = innerWidth + \"px\";\r\n\t\t\tthis.$grid_data.style.width = innerWidth + \"px\";\r\n\t\t} else {\r\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\r\n\t\t\tthis.$grid_data.style.width = \"inherit\";\r\n\t\t}\r\n\t\tthis.$config.width -= 1;\r\n\r\n\t\tvar config = this.$getConfig();\r\n\t\tif (outerWidth !== width) {\r\n\t\t\tif(outerWidth !== undefined){\r\n\t\t\t\tconfig.grid_width = outerWidth;\r\n\t\t\t\tthis.$config.width = outerWidth - 1;\r\n\t\t\t}else{\r\n\t\t\t\tif(!isNaN(innerWidth)){\r\n\t\t\t\t\tthis._setColumnsWidth(innerWidth);\r\n\t\t\t\t\tconfig.grid_width = innerWidth;\r\n\t\t\t\t\tthis.$config.width = innerWidth - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar dataHeight = Math.max(this.$state.height - config.scale_height, 0);\r\n\t\tthis.$grid_data.style.height = dataHeight + \"px\";\r\n\t\tthis.refresh();\r\n\t},\r\n\tgetSize: function () {\r\n\r\n\t\tvar config = this.$getConfig();\r\n\r\n\t\tvar store = this.$config.rowStore;\r\n\r\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\r\n\t\t\tcontentWidth = this._getGridWidth();\r\n\r\n\t\tvar size = {\r\n\t\t\tx: this.$state.width,\r\n\t\t\ty: this.$state.height,\r\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\r\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\r\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\r\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\r\n\t\t};\r\n\r\n\t\treturn size;\r\n\t},\r\n\r\n\t_bindStore: function () {\r\n\t\tif (this.$config.bind){\r\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\r\n\t\t\tthis.$config.rowStore = rowStore;\r\n\t\t\tif(rowStore && !rowStore._gridCacheAttached){\r\n\t\t\t\tvar self = this;\r\n\t\t\t\trowStore._gridCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\r\n\t\t\t\t\tself._resetTopPositionHeight();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t_unbindStore: function(){\r\n\t\tif (this.$config.bind){\r\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\r\n\t\t\tif(rowStore && rowStore._gridCacheAttached){\r\n\t\t\t\trowStore.detachEvent(rowStore._gridCacheAttached);\r\n\t\t\t\trowStore._gridCacheAttached = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\trefresh: function () {\r\n\t\tthis._bindStore();\r\n\r\n\t\tthis._resetTopPositionHeight();\r\n\t\tthis._resetHeight();\r\n\t\tthis._initSmartRenderingPlaceholder();\r\n\r\n\t\tthis._calculateGridWidth();\r\n\t\tthis._renderGridHeader();\r\n\t},\r\n\r\n\tgetViewPort: function(){\r\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\r\n\t\tvar scrollTop = this.$config.scrollTop || 0;\r\n\t\tvar height = this.$config.height || 0;\r\n\t\tvar width = this.$config.width || 0;\r\n\t\treturn {\r\n\t\t\ty: scrollTop,\r\n\t\t\ty_end: scrollTop + height,\r\n\t\t\tx: scrollLeft,\r\n\t\t\tx_end: scrollLeft + width,\r\n\t\t\theight: height,\r\n\t\t\twidth: width\r\n\t\t};\r\n\t},\r\n\r\n\tscrollTo: function (left, top) {\r\n\t\tif (!this.isVisible())\r\n\t\t\treturn;\r\n\r\n\t\tvar scrolled = false;\r\n\r\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\r\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\r\n\r\n\t\tif (left * 1 == left) {\r\n\t\t\tthis.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = left;\r\n\t\t\tscrolled = true;\r\n\t\t}\r\n\r\n\t\t// var config = this.$getConfig();\r\n\t\tif (top * 1 == top) {\r\n\t\t\tthis.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = top;\r\n\t\t\tscrolled = true;\r\n\t\t}\r\n\r\n\t\tif(scrolled){\r\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\r\n\t\t}\r\n\t},\r\n\r\n\tgetColumnIndex: function (name, excludeHidden) {\r\n\t\tvar columns = this.$getConfig().columns;\r\n\t\tvar hiddenIndexShift = 0;\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\r\n\t\t\tif (excludeHidden && columns[i].hide){\r\n\t\t\t\thiddenIndexShift++;\r\n\t\t\t}\r\n\t\t\tif (columns[i].name == name) {\r\n\t\t\t\treturn i - hiddenIndexShift;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\r\n\tgetColumn: function (name) {\r\n\t\tvar index = this.getColumnIndex(name);\r\n\t\tif (index === null) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this.$getConfig().columns[index];\r\n\t},\r\n\r\n\tgetGridColumns: function () {\r\n\t\tvar config = this.$getConfig();\r\n\t\treturn config.columns.slice();\r\n\t},\r\n\tisVisible: function () {\r\n\t\tif (this.$parent && this.$parent.$config) {\r\n\t\t\treturn !this.$parent.$config.hidden;\r\n\t\t} else {\r\n\t\t\treturn this.$grid.offsetWidth;\r\n\t\t}\r\n\t},\r\n\r\n\t// getItemHeight: function () {\r\n\t// \tvar config = this.$getConfig();\r\n\t// \treturn config.row_height;\r\n\t// },\r\n\r\n\t_createLayerConfig: function () {\r\n\t\tvar gantt = this.$gantt;\r\n\t\tvar self = this;\r\n\t\tvar layers = [\r\n\t\t\t{\r\n\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\r\n\t\t\t\tcontainer: this.$grid_data,\r\n\t\t\t\tfilter: [function () {\r\n\t\t\t\t\treturn self.isVisible();\r\n\t\t\t\t}]\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\r\n\t\t\t\tcontainer: this.$grid_data,\r\n\t\t\t\tappend: true,\r\n\t\t\t\tfilter: [function () {\r\n\t\t\t\t\treturn gantt.config.resize_rows;\r\n\t\t\t\t}]\r\n\t\t\t}\r\n\t\t];\r\n\t\treturn layers;\r\n\t},\r\n\r\n\t_addLayers: function (gantt) {\r\n\t\tif (!this.$config.bind)\r\n\t\t\treturn;\r\n\r\n\t\tthis._taskLayers = [];\r\n\r\n\t\tvar self = this;\r\n\r\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\r\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\r\n\r\n\t\tif (!taskRenderer) {\r\n\t\t\ttaskRenderer = layers.createDataRender({\r\n\t\t\t\tname: this.$config.bind,\r\n\t\t\t\tdefaultContainer: function () { return self.$grid_data; }\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tvar taskLayers = this.$config.layers;\r\n\t\tfor (var i = 0; taskLayers && i < taskLayers.length; i++) {\r\n\t\t\tvar layer = taskLayers[i];\r\n\t\t\tlayer.view = this;\r\n\r\n\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\r\n\t\t\tthis._taskLayers.push(bar_layer);\r\n\t\t}\r\n\r\n\t\tthis._bindStore();\r\n\r\n\t\tthis._initSmartRenderingPlaceholder();\r\n\t},\r\n\r\n\t_refreshPlaceholderOnStoreUpdate: function (id) {\r\n\t\tvar config = this.$getConfig(),\r\n\t\t\tstore = this.$config.rowStore;\r\n\r\n\t\tif (!store || id !== null || !this.isVisible() || !config.smart_rendering) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar contentHeight;\r\n\t\tif (this.$config.scrollY) {\r\n\t\t\tvar scroll = this.$gantt.$ui.getView(this.$config.scrollY);\r\n\t\t\tif (scroll)\r\n\t\t\t\tcontentHeight = scroll.getScrollState().scrollSize;\r\n\t\t}\r\n\r\n\t\tif (!contentHeight) {\r\n\t\t\tcontentHeight = store ? this.getTotalHeight() : 0;\r\n\t\t}\r\n\r\n\t\tif (contentHeight) {\r\n\t\t\tif (this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode) {\r\n\t\t\t\tthis.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\r\n\t\t\t}\r\n\r\n\t\t\tvar placeholder = this.$rowsPlaceholder = document.createElement(\"div\");\r\n\t\t\tplaceholder.style.visibility = \"hidden\";\r\n\t\t\tplaceholder.style.height = contentHeight + \"px\";\r\n\t\t\tplaceholder.style.width = \"1px\";\r\n\t\t\tthis.$grid_data.appendChild(placeholder);\r\n\t\t}\r\n\t},\r\n\r\n\t_initSmartRenderingPlaceholder: function () {\r\n\t\tvar store = this.$config.rowStore;\r\n\t\tif (!store) {\r\n\t\t\treturn;\r\n\t\t} else {\r\n\t\t\tthis._initSmartRenderingPlaceholder = function () { };\r\n\t\t}\r\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", utils.bind(this._refreshPlaceholderOnStoreUpdate, this));\r\n\t},\r\n\r\n\t_initEvents: function () {\r\n\t\tvar gantt = this.$gantt;\r\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_close\", gantt.bind(function (e, id, trg) {\r\n\t\t\tvar store = this.$config.rowStore;\r\n\t\t\tif (!store) return true;\r\n\r\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\r\n\t\t\tif (target) {\r\n\t\t\t\tstore.close(target.getAttribute(this.$config.item_attribute));\r\n\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}, this), this.$grid);\r\n\r\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_open\", gantt.bind(function (e, id, trg) {\r\n\t\t\tvar store = this.$config.rowStore;\r\n\t\t\tif (!store) return true;\r\n\r\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\r\n\t\t\tif (target) {\r\n\t\t\t\tstore.open(target.getAttribute(this.$config.item_attribute));\r\n\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}, this), this.$grid);\r\n\t},\r\n\r\n\t_clearLayers: function (gantt) {\r\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\r\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\r\n\r\n\t\tif (this._taskLayers) {\r\n\t\t\tfor (var i = 0; i < this._taskLayers.length; i++) {\r\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._taskLayers = [];\r\n\t},\r\n\r\n\t_getColumnWidth: function (column, config, width) {\r\n\t\tvar min_width = column.min_width || config.min_grid_column_width;\r\n\t\tvar new_width = Math.max(width, min_width || 10);\r\n\t\tif (column.max_width)\r\n\t\t\tnew_width = Math.min(new_width, column.max_width);\r\n\t\treturn new_width;\r\n\t},\r\n\t// set min width only if width < than config.min_grid_column_width\r\n\t_checkGridColumnMinWidthLimits: function (columns, config) {\r\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\r\n\t\t\tvar width = columns[i].width * 1;\r\n\t\t\tif (!columns[i].min_width && width < config.min_grid_column_width){\r\n\t\t\t\tcolumns[i].min_width = width;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t// return min and max possible grid width according to restricts\r\n\t_getGridWidthLimits: function () {\r\n\t\tvar config = this.$getConfig(),\r\n\t\t\tcolumns = this.getGridColumns(),\r\n\t\t\tmin_limit = 0,\r\n\t\t\tmax_limit = 0;\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tmin_limit += columns[i].min_width ? columns[i].min_width : config.min_grid_column_width;\r\n\t\t\tif (max_limit !== undefined) {\r\n\t\t\t\tmax_limit = columns[i].max_width ? (max_limit + columns[i].max_width) : undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._checkGridColumnMinWidthLimits(columns, config); // FIX ME: should it be before calculating limits?\r\n\t\treturn [min_limit, max_limit];\r\n\t},\r\n\t// resize columns to get total newWidth, starting from columns[start_index]\r\n\t_setColumnsWidth: function (newWidth, start_index) {\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar columns = this.getGridColumns(),\r\n\t\t\tcolumns_width = 0,\r\n\t\t\tfinal_width = newWidth;\r\n\r\n\t\tstart_index = !window.isNaN(start_index) ? start_index : -1;\r\n\r\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\r\n\t\t\tcolumns_width += columns[i].width * 1;\r\n\t\t}\r\n\r\n\t\tif (window.isNaN(columns_width)) {\r\n\t\t\tthis._calculateGridWidth();\r\n\t\t\tcolumns_width = 0;\r\n\t\t\tfor (var i = 0, l = columns.length; i < l; i++) {\r\n\t\t\t\tcolumns_width += columns[i].width * 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar extra_width = final_width - columns_width;\r\n\r\n\t\tvar start_width = 0;\r\n\t\tfor (var i = 0; i < start_index + 1; i++) {\r\n\t\t\tstart_width += columns[i].width;\r\n\t\t}\r\n\r\n\t\tcolumns_width -= start_width;\r\n\r\n\t\tfor (var i = start_index + 1; i < columns.length; i++) {\r\n\r\n\t\t\tvar col = columns[i];\r\n\t\t\tvar share = Math.round(extra_width * (col.width / columns_width));\r\n\r\n\t\t\t// columns have 2 additional restrict fields - min_width & max_width that are set by user\r\n\t\t\tif (extra_width < 0) {\r\n\t\t\t\tif (col.min_width && col.width + share < col.min_width)\r\n\t\t\t\t\tshare = col.min_width - col.width;\r\n\t\t\t\telse if (!col.min_width && config.min_grid_column_width && col.width + share < config.min_grid_column_width)\r\n\t\t\t\t\tshare = config.min_grid_column_width - col.width;\r\n\t\t\t} else if (col.max_width && col.width + share > col.max_width)\r\n\t\t\t\tshare = col.max_width - col.width;\r\n\r\n\t\t\tcolumns_width -= col.width;\r\n\t\t\tcol.width += share;\r\n\t\t\textra_width -= share;\r\n\r\n\t\t}\r\n\r\n\t\tvar iterator = extra_width > 0 ? 1 : -1;\r\n\t\twhile ((extra_width > 0 && iterator === 1) || (extra_width < 0 && iterator === -1)) {\r\n\t\t\tvar curExtra = extra_width;\r\n\t\t\tfor (i = start_index + 1; i < columns.length; i++) {\r\n\t\t\t\tvar new_width = columns[i].width + iterator;\r\n\r\n\t\t\t\tif (new_width == this._getColumnWidth(columns[i], config, new_width)) {\r\n\t\t\t\t\textra_width -= iterator;\r\n\t\t\t\t\tcolumns[i].width = new_width;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!extra_width)\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (curExtra == extra_width)\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// if impossible to resize the right-side columns, resize the start column\r\n\t\tif (extra_width && start_index > -1) {\r\n\t\t\tvar new_width = columns[start_index].width + extra_width;\r\n\t\t\tif (new_width == this._getColumnWidth(columns[start_index], config, new_width))\r\n\t\t\t\tcolumns[start_index].width = new_width;\r\n\t\t}\r\n\r\n\t\t//if (this.callEvent(\"onGridResizeEnd\", [config.grid_width, final_width]) === false)\r\n\t\t//\treturn;\r\n\r\n\t\treturn this._getColsTotalWidth();\r\n\t},\r\n\r\n\t_getColsTotalWidth: function () {\r\n\t\tvar columns = this.getGridColumns();\r\n\t\tvar cols_width = 0;\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tvar v = parseFloat(columns[i].width);\r\n\t\t\tif (window.isNaN(v)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tcols_width += v;\r\n\t\t}\r\n\t\treturn cols_width;\r\n\t},\r\n\t_calculateGridWidth: function () {\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar columns = this.getGridColumns();\r\n\t\tvar cols_width = 0;\r\n\t\tvar unknown = [];\r\n\t\tvar width = [];\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tvar v = parseFloat(columns[i].width);\r\n\t\t\tif (window.isNaN(v)) {\r\n\t\t\t\tv = config.min_grid_column_width || 10;\r\n\t\t\t\tunknown.push(i);\r\n\t\t\t}\r\n\t\t\twidth[i] = v;\r\n\t\t\tcols_width += v;\r\n\t\t}\r\n\t\tvar gridWidth = this._getGridWidth() + 1;\r\n\t\tif (config.autofit || unknown.length) {\r\n\t\t\tvar diff = gridWidth - cols_width;\r\n\t\t\t// TODO: logic may be improved for proportional changing of width\r\n\r\n\t\t\t// autofit adjusts columns widths to the outer grid width\r\n\t\t\t// it doesn't makes sense if grid has inner scroll with elastic columns\r\n\t\t\tif (config.autofit && !config.grid_elastic_columns) {\r\n\t\t\t\t// delta must be added for all columns\r\n\t\t\t\tfor (var i = 0; i < width.length; i++) {\r\n\t\t\t\t\tvar delta = Math.round(diff / (width.length - i));\r\n\t\t\t\t\twidth[i] += delta;\r\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[i], config, width[i]);\r\n\r\n\t\t\t\t\tif (new_width != width[i]) {\r\n\t\t\t\t\t\tdelta = new_width - width[i];\r\n\t\t\t\t\t\twidth[i] = new_width;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdiff -= delta;\r\n\t\t\t\t}\r\n\t\t\t} else if (unknown.length) {\r\n\t\t\t\t// there are several columns with undefined width\r\n\t\t\t\tfor (var i = 0; i < unknown.length; i++) {\r\n\t\t\t\t\tvar delta = Math.round(diff / (unknown.length - i)); // no float values, just integer\r\n\t\t\t\t\tvar index = unknown[i];\r\n\t\t\t\t\twidth[index] += delta;\r\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[index], config, width[index]);\r\n\t\t\t\t\tif (new_width != width[index]) {\r\n\t\t\t\t\t\tdelta = new_width - width[index];\r\n\t\t\t\t\t\twidth[index] = new_width;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdiff -= delta;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < width.length; i++) {\r\n\t\t\t\tcolumns[i].width = width[i];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar changed = (gridWidth != cols_width);\r\n\t\t\tthis.$config.width = cols_width - 1;\r\n\t\t\tconfig.grid_width = cols_width;\r\n\t\t\tif (changed) {\r\n\t\t\t\tthis.$parent._setContentSize(this.$config.width, null);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t_renderGridHeader: function () {\r\n\t\tvar gantt = this.$gantt;\r\n\t\tvar config = this.$getConfig();\r\n\t\tvar locale = this.$gantt.locale;\r\n\t\tvar templates = this.$gantt.templates;\r\n\r\n\t\tvar columns = this.getGridColumns();\r\n\t\tif (config.rtl) {\r\n\t\t\tcolumns = columns.reverse();\r\n\t\t}\r\n\t\tvar cells = [];\r\n\t\tvar width = 0,\r\n\t\t\tlabels = locale.labels;\r\n\r\n\t\tvar lineHeigth = config.scale_height - 1;\r\n\r\n\t\tconst renderableComponents = {};\r\n\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tvar last = i == columns.length - 1;\r\n\t\t\tvar col = columns[i];\r\n\r\n\t\t\t// ensure columns have non-empty names\r\n\t\t\tif (!col.name) {\r\n\t\t\t\tcol.name = gantt.uid() + \"\";\r\n\t\t\t}\r\n\r\n\t\t\tvar colWidth = col.width * 1;\r\n\r\n\t\t\tvar gridWidth = this._getGridWidth();\r\n\t\t\tif (last && gridWidth > width + colWidth)\r\n\t\t\t\tcol.width = colWidth = gridWidth - width;\r\n\t\t\twidth += colWidth;\r\n\t\t\tvar sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\r\n\t\t\tvar cssClass = [\"gantt_grid_head_cell\",\r\n\t\t\t\t(\"gantt_grid_head_\" + col.name),\r\n\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\r\n\t\t\t\ttemplates.grid_header_class(col.name, col)].join(\" \");\r\n\r\n\t\t\tvar style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\r\n\t\t\tvar label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\r\n\t\t\tif(typeof label === \"function\"){\r\n\t\t\t\tlabel = label.call(gantt, col.name, col);\r\n\t\t\t}\r\n\t\t\tlabel = label || \"\";\r\n\t\t\tlet componentLabel = false;\r\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(label)){\r\n\t\t\t\tcomponentLabel = true;\r\n\t\t\t\trenderableComponents[col.name] = label;\r\n\t\t\t}\r\n\r\n\t\t\tvar ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\r\n\r\n\t\t\tvar cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \r\n\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\r\n\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\r\n\t\t\t\t\">\" + (!componentLabel ? label : \"<div data-component-container></div>\") + sort + \"</div>\";\r\n\t\t\tcells.push(cell);\r\n\t\t}\r\n\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\r\n\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\r\n\t\t//this.$grid_scale.style.width = \"inherit\";\r\n\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\r\n\t\tfor(let i in renderableComponents){\r\n\t\t\tgantt.config.external_render.renderElement(renderableComponents[i], this.$grid_scale.querySelector(\"[data-column-id='\" + i + \"'] [data-component-container]\"));\r\n\t\t}\r\n\r\n\t\tif (this._renderHeaderResizers) {\r\n\t\t\tthis._renderHeaderResizers();\r\n\t\t}\r\n\t},\r\n\r\n\t_getGridWidth: function () {\r\n\t\t// TODO: refactor/remove/comment some of _getGridWidth/this.$config.width/this.$state.width, it's not clear what they do\r\n\t\treturn this.$config.width;\r\n\t},\r\n\r\n\tdestructor: function () {\r\n\t\tthis._clearLayers(this.$gantt);\r\n\t\tif (this._mouseDelegates) {\r\n\t\t\tthis._mouseDelegates.destructor();\r\n\t\t\tthis._mouseDelegates = null;\r\n\t\t}\r\n\t\tthis._unbindStore();\r\n\t\tthis.$grid = null;\r\n\t\tthis.$grid_scale = null;\r\n\t\tthis.$grid_data = null;\r\n\t\tthis.$gantt = null;\r\n\t\tif (this.$config.rowStore) {\r\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\r\n\t\t\tthis.$config.rowStore = null;\r\n\t\t}\r\n\r\n\t\tthis.callEvent(\"onDestroy\", []);\r\n\t\tthis.detachAllEvents();\r\n\t}\r\n};\r\n\r\nexport default Grid;\r\n","function createResizer(gantt, grid){\r\n\treturn {\r\n\t\tinit: function(){},\r\n\t\tdoOnRender: function(){}\r\n\t};\r\n}\r\n\r\nexport default createResizer;","import * as domHelpers from \"../utils/dom_helpers\";\r\n\r\nfunction createRowResizer(gantt, grid){\r\n\r\n\tvar _task_grid_row_resize = {\r\n\t\trow_before_start: gantt.bind(function (dnd, obj, e) {\r\n\t\t\tvar config = grid.$getConfig();\r\n\t\t\tvar store = grid.$config.rowStore;\r\n\r\n\t\t\tvar el = domHelpers.locateAttribute(e, config.task_grid_row_resizer_attribute);\r\n\t\t\tif (!el) return false;\r\n\r\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute),\r\n\t\t\t\trow = store.getItem(row_id);\r\n\r\n\t\t\tif (grid.callEvent(\"onBeforeRowResize\", [row]) === false)\r\n\t\t\t\treturn false;\r\n\t\t}, gantt),\r\n\r\n\t\trow_after_start: gantt.bind(function (dnd, obj, e) {\r\n\t\t\tvar config = grid.$getConfig();\r\n\r\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute);\r\n\t\t\tdnd.config.marker.innerHTML = \"\";\r\n\r\n\t\t\tdnd.config.marker.className += \" gantt_row_grid_resize_area\";\r\n\t\t\tdnd.config.marker.style.width = grid.$grid.offsetWidth + \"px\";\r\n\t\t\tdnd.config.drag_id = row_id;\r\n\r\n\t\t}, gantt),\r\n\r\n\t\trow_drag_move: gantt.bind(function (dnd, obj, e) {\r\n\t\t\tvar store = grid.$config.rowStore;\r\n\t\t\tvar config = grid.$getConfig();\r\n\t\t\tvar dd = dnd.config;\r\n\t\t\tvar id = dd.drag_id,\r\n\t\t\t\titemHeight = grid.getItemHeight(id),\r\n\t\t\t\titemTop = grid.getItemTop(id) - obj.scrollTop;\r\n\t\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data),\r\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.top, 10),\r\n\t\t\t\tmarkerStartPosition = itemTop + pos.y,\r\n\t\t\t\tmarker_height = 0,\r\n\t\t\t\tminPointerPosition = config.min_task_grid_row_height;\r\n\r\n\t\t\tmarker_height = pointerPosition - markerStartPosition;\r\n\t\t\tif(marker_height < minPointerPosition){\r\n\t\t\t\tmarker_height = minPointerPosition;\r\n\t\t\t}\r\n\r\n\t\t\tdd.marker.style.left = pos.x + \"px\";\r\n\t\t\tdd.marker.style.top = markerStartPosition - 1 + \"px\";\r\n\t\t\tdd.marker.style.height = Math.abs(marker_height) + 1 + \"px\";\r\n\r\n\t\t\tdd.marker_height = marker_height;\r\n\t\t\t\r\n\t\t\tgrid.callEvent(\"onRowResize\", [id, store.getItem(id), marker_height + itemHeight]);\r\n\t\t\treturn true;\r\n\t\t}, gantt),\r\n\r\n\t\trow_drag_end: gantt.bind(function (dnd, obj, e) {\r\n\t\t\tvar store = grid.$config.rowStore;\r\n\t\t\tvar dd = dnd.config;\r\n\t\t\tvar id = dd.drag_id,\r\n\t\t\t\titem = store.getItem(id),\r\n\t\t\t\toldItemHeight = grid.getItemHeight(id);\r\n\r\n\t\t\tvar finalHeight = dd.marker_height;\r\n\r\n\t\t\tif (grid.callEvent(\"onBeforeRowResizeEnd\", [id, item, finalHeight]) === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (item.row_height == finalHeight)\r\n\t\t\t\treturn;\r\n\r\n\t\t\titem.row_height = finalHeight;\r\n\t\t\t// GS-2275: case for resizing resource grid row and others\r\n\t\t\tstore.updateItem(id);\r\n\t\t\tgrid.callEvent(\"onAfterRowResize\", [id, item, oldItemHeight, finalHeight]);\r\n\r\n\t\t\tthis.render();\r\n\t\t}, gantt)\r\n\t};\r\n\r\n\t// calls the initialization of the D'n'D events for resize elements\r\n\tvar _init_resize = function () {\r\n\r\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\r\n\r\n\t\tvar config = grid.$getConfig();\r\n\r\n\t\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\r\n\t\tif (gantt.defined(config.dnd_sensitivity))\r\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\r\n\r\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\r\n\t\t\treturn _task_grid_row_resize.row_before_start(dnd, obj, e);\r\n\t\t});\r\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\r\n\t\t\treturn _task_grid_row_resize.row_after_start(dnd, obj, e);\r\n\t\t});\r\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\r\n\t\t\treturn _task_grid_row_resize.row_drag_move(dnd, obj, e);\r\n\t\t});\r\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\r\n\t\t\treturn _task_grid_row_resize.row_drag_end(dnd, obj, e);\r\n\t\t});\r\n\r\n\t};\r\n\r\n\treturn {\r\n\t\tinit: _init_resize\r\n\t};\r\n}\r\n\r\nexport default createRowResizer;","export default {\r\n\tinit: function (controller, grid) {\r\n\t\tvar gantt = grid.$gantt;\r\n\r\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\r\n\t\t\tif (gantt._is_icon_open_click(e))\r\n\t\t\t\treturn true;\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tvar cell = controller.locateCell(e.target);\r\n\r\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\r\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\r\n\t\t\t\t\t// do nothing if editor is already active in this cell\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\r\n\t\t\tif (controller.isVisible() && controller.isChanged()) {\r\n\t\t\t\tcontroller.save();\r\n\t\t\t} else {\r\n\t\t\t\tcontroller.hide();\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onTaskDblClick\", function (id, e) {\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tvar cell = controller.locateCell(e.target);\r\n\t\t\tif (cell && controller.isVisible() && cell.columnName == state.columnName) {\r\n\t\t\t\t//GS-933 probably, we don't need to hide the inline editor because the lightbox cannot be opened if you double-click on an inline editor\r\n\t\t\t\t//remove this code later if people don't complain\r\n\t\t\t\t//controller.hide();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t},\r\n\r\n\tonShow: function (controller, placeholder, grid) {\r\n\t\tvar gantt = grid.$gantt;\r\n\t\t\r\n\r\n\t\tif(gantt.ext && gantt.ext.keyboardNavigation){\r\n\t\t\tvar keyNav = gantt.ext.keyboardNavigation;\r\n\t\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\r\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\r\n\t\t\t\tvar keyCode = e.keyCode;\r\n\t\t\t\tvar preventKeyNav = false;\r\n\r\n\t\t\t\tswitch (keyCode){\r\n\t\t\t\t\tcase keyboard.SPACE:\r\n\t\t\t\t\t\tif(controller.isVisible()){\r\n\t\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (preventKeyNav){\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else{\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tplaceholder.onkeydown = function (e) {\r\n\t\t\te = e || window.event;\r\n\r\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\r\n\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar shouldPrevent = true;\r\n\t\t\tswitch (e.keyCode) {\r\n\t\t\t\tcase gantt.keys.edit_save:\r\n\t\t\t\t\tcontroller.save();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase gantt.keys.edit_cancel:\r\n\t\t\t\t\tcontroller.hide();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.UP:\r\n\t\t\t\tcase keyboard.DOWN:\r\n\t\t\t\t\tif (controller.isVisible()) {\r\n\t\t\t\t\t\tcontroller.hide();\r\n\t\t\t\t\t\tshouldPrevent = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.TAB:\r\n\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\tcontroller.editPrevCell(true);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontroller.editNextCell(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tshouldPrevent = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (shouldPrevent) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\tonHide: function () {\r\n\r\n\t},\r\n\r\n\tdestroy: function () {\r\n\r\n\t}\r\n};\r\n\r\n","export default {\r\n\tinit: function(controller, grid){\r\n\t\tvar self = controller;\r\n\t\tvar gantt = grid.$gantt;\r\n\r\n\t\tvar onBlurDelay = null;\r\n\t\tvar keyNav = gantt.ext.keyboardNavigation;\r\n\t\tkeyNav.attachEvent(\"onBeforeFocus\", function (node) {\r\n\t\t\tvar activeCell = controller.locateCell(node);\r\n\t\t\tclearTimeout(onBlurDelay);\r\n\t\t\tif (activeCell) {\r\n\t\t\t\tvar columnName = activeCell.columnName;\r\n\t\t\t\tvar id = activeCell.id;\r\n\r\n\t\t\t\tvar editorState = self.getState();\r\n\t\t\t\tif(self.isVisible()){\r\n\t\t\t\t\tif(editorState.id == id && editorState.columnName === columnName) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tkeyNav.attachEvent(\"onFocus\", function (node) {\r\n\t\t\tvar activeCell = controller.locateCell(node);\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tclearTimeout(onBlurDelay);\r\n\t\t\tif (activeCell && !(activeCell.id == state.id && activeCell.columnName == state.columnName)) {\r\n\t\t\t\tif(self.isVisible()){\r\n\t\t\t\t\tself.save();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tcontroller.attachEvent(\"onHide\", function(){\r\n\t\t\tclearTimeout(onBlurDelay);\r\n\t\t});\r\n\r\n\t\tkeyNav.attachEvent(\"onBlur\", function () {\r\n\t\t\tonBlurDelay = setTimeout(function(){\r\n\t\t\t\tself.save();\r\n\t\t\t});\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onTaskDblClick\", function(id,e){\r\n\t\t\t// block lightbox on double click inside editor\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tvar cell = controller.locateCell(e.target);\r\n\t\t\tif(cell && controller.isVisible() && cell.columnName == state.columnName){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\r\n\t\t\tif(gantt._is_icon_open_click(e))\r\n\t\t\t\treturn true;\r\n\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tvar cell = controller.locateCell(e.target);\r\n\r\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\r\n\t\t\t\tif(controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName){\r\n\t\t\t\t\t// do nothing if editor is already active in this cell\r\n\t\t\t\t}else{\r\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\r\n\t\t\tself.save();\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\r\n\t\t\tvar activeCell = controller.locateCell(e.target);\r\n\t\t\tvar hasEditor = activeCell ? controller.getEditorConfig(activeCell.columnName) : false;\r\n\r\n\t\t\tvar state = controller.getState();\r\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\r\n\t\t\tvar keyCode = e.keyCode;\r\n\t\t\tvar preventKeyNav = false;\r\n\r\n\t\t\tswitch (keyCode){\r\n\t\t\t\tcase keyboard.ENTER:\r\n\t\t\t\t\tif(controller.isVisible()){\r\n\t\t\t\t\t\tcontroller.save();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}else if(hasEditor && !(e.ctrlKey || e.metaKey || e.shiftKey)){\r\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.ESC:\r\n\t\t\t\t\tif(controller.isVisible()){\r\n\t\t\t\t\t\tcontroller.hide();\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.UP:\r\n\t\t\t\tcase keyboard.DOWN:\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.LEFT:\r\n\t\t\t\tcase keyboard.RIGHT:\r\n\t\t\t\t\tif((hasEditor && controller.isVisible()) || state.editorType === \"date\"){\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.SPACE:\r\n\t\t\t\t\tif(controller.isVisible()){\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\r\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.DELETE:\r\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\r\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t} else if(hasEditor && controller.isVisible()){\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase keyboard.TAB:\r\n\t\t\t\t\tif(controller.isVisible()){\r\n\r\n\t\t\t\t\t\tif(e.shiftKey){\r\n\t\t\t\t\t\t\tcontroller.editPrevCell(true);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tcontroller.editNextCell(true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar newState = controller.getState();\r\n\t\t\t\t\t\tif(newState.id){\r\n\t\t\t\t\t\t\tkeyNav.focus({type:\"taskCell\", id: newState.id, column:newState.columnName});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tif(controller.isVisible())\r\n\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\telse{\r\n\r\n\t\t\t\t\t\t// start editing on character key\r\n\t\t\t\t\t\tif((keyCode >= 48 && keyCode <= 57) || // [0-9]\r\n\t\t\t\t\t\t\t(keyCode > 95 && keyCode < 112) || // numpad\r\n\t\t\t\t\t\t\t(keyCode >= 64 && keyCode <= 91) || // [a-z]\r\n\t\t\t\t\t\t\t(keyCode > 185 && keyCode < 193) || //;=-,etc\r\n\t\t\t\t\t\t\t(keyCode > 218  && keyCode < 223)\r\n\t\t\t\t\t\t){\r\n\t\t\t\t\t\t\tvar modifiers = command.modifiers;\r\n\r\n\t\t\t\t\t\t\tvar anyModifier = modifiers.alt || modifiers.ctrl || modifiers.meta || modifiers.shift;\r\n\t\t\t\t\t\t\tif(modifiers.alt){\r\n\t\t\t\t\t\t\t\t// don't start editing on alt+key\r\n\t\t\t\t\t\t\t}else if (anyModifier && keyNav.getCommandHandler(command, \"taskCell\")){\r\n\t\t\t\t\t\t\t\t// don't start editing if command already have a keyboard shortcut\r\n\t\t\t\t\t\t\t}else if(hasEditor && !controller.isVisible()){\r\n\t\t\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\r\n\t\t\t\t\t\t\t\tpreventKeyNav = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (preventKeyNav){\r\n\t\t\t\treturn false;\r\n\t\t\t} else{\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t},\r\n\tonShow: function(controller, placeholder, grid){},\r\n\tonHide: function(controller, placeholder, grid){\r\n\t\tconst gantt = grid.$gantt;\r\n\t\tif (gantt){\r\n\t\t\tgantt.focus();\r\n\t\t}\r\n\r\n\t},\r\n\tdestroy: function(){}\r\n};\r\n\r\n","export default function (gantt) {\r\n\r\n\tvar BaseEditor = function () {\r\n\t};\r\n\r\n\tBaseEditor.prototype = {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t},\r\n\t\thide: function () {\r\n\t\t},\r\n\t\tset_value: function (value, id, column, node) {\r\n\t\t\tthis.get_input(node).value = value;\r\n\t\t},\r\n\t\tget_value: function (id, column, node) {\r\n\t\t\treturn this.get_input(node).value || \"\";\r\n\t\t},\r\n\t\tis_changed: function (value, id, column, node) {\r\n\t\t\tvar currentValue = this.get_value(id, column, node);\r\n\t\t\tif (currentValue && value && currentValue.valueOf && value.valueOf) {\r\n\t\t\t\treturn currentValue.valueOf() != value.valueOf();\r\n\t\t\t} else {\r\n\t\t\t\treturn currentValue != value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tis_valid: function (value, id, column, node) {\r\n\t\t\treturn true;\r\n\t\t},\r\n\r\n\t\tsave: function (id, column, node) {\r\n\r\n\t\t},\r\n\t\tget_input: function (node) {\r\n\t\t\treturn node.querySelector(\"input\");\r\n\t\t},\r\n\t\tfocus: function (node) {\r\n\t\t\tvar input = this.get_input(node);\r\n\t\t\tif (!input) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (input.focus) {\r\n\t\t\t\tinput.focus();\r\n\t\t\t}\r\n\r\n\t\t\tif (input.select) {\r\n\t\t\t\tinput.select();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn BaseEditor;\r\n};","import BaseFactory from \"./base\";\r\nimport * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\r\n\tfunction TextEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(TextEditor, BaseEditor);\r\n\r\n\tutils.mixin(TextEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\r\n\t\t\tplaceholder.innerHTML = html;\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn TextEditor;\r\n};","import BaseFactory from \"./base\";\r\nimport * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\r\n\tfunction NumberEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(NumberEditor, BaseEditor);\r\n\r\n\tutils.mixin(NumberEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tvar min = config.min || 0,\r\n\t\t\t\tmax = config.max || 100;\r\n\r\n\t\t\tvar html = `<div role='cell'><input type='number' min='${min}' max='${max}' name='${column.name}' title='${column.name}'></div>`;\r\n\t\t\tplaceholder.innerHTML = html;\r\n\r\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\r\n\t\t\tplaceholder.oninput = function (e) {\r\n\t\t\t\tif (+e.target.value < min) {\r\n\t\t\t\t\te.target.value = min;\r\n\t\t\t\t}\r\n\t\t\t\tif (+e.target.value > max) {\r\n\t\t\t\t\te.target.value = max;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tget_value: function (id, column, node) {\r\n\t\t\treturn this.get_input(node).value || \"\";\r\n\t\t},\r\n\t\tis_valid: function (value, id, column, node) {\r\n\t\t\treturn !isNaN(parseInt(value, 10));\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn NumberEditor;\r\n};","import BaseFactory from \"./base\";\r\nimport * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\r\n\tfunction SelectEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(SelectEditor, BaseEditor);\r\n\r\n\tutils.mixin(SelectEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tvar html = `<div role='cell'><select name='${column.name}' title='${column.name}'>`;\r\n\t\t\tvar optionsHtml = [],\r\n\t\t\t\toptions = config.options || [];\r\n\r\n\t\t\tfor (var i = 0; i < options.length; i++) {\r\n\t\t\t\toptionsHtml.push(\"<option value='\" + config.options[i].key + \"'>\" + options[i].label + \"</option>\");\r\n\t\t\t}\r\n\r\n\t\t\thtml += optionsHtml.join(\"\") + \"</select></div>\";\r\n\t\t\tplaceholder.innerHTML = html;\r\n\t\t},\r\n\t\tget_input: function (node) {\r\n\t\t\treturn node.querySelector(\"select\");\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn SelectEditor;\r\n};","import * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\nimport BaseFactory from \"./base\";\r\n\r\nexport default function (gantt) {\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\t\r\n\t\r\n\r\n\tvar html5DateFormat = \"%Y-%m-%d\";\r\n\r\n\tvar dateToStr = null;\r\n\tvar strToDate = null;\r\n\r\n\tfunction init() {\r\n\t\tif (!dateToStr) {\r\n\t\t\tdateToStr = gantt.date.date_to_str(html5DateFormat);\r\n\t\t}\r\n\t\tif (!strToDate) {\r\n\t\t\tstrToDate = gantt.date.str_to_date(html5DateFormat);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction DateEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(DateEditor, BaseEditor);\r\n\r\n\tutils.mixin(DateEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tinit();\r\n\t\t\tvar minValue = null;\r\n\t\t\tvar maxValue = null;\r\n\r\n\t\t\tif(typeof config.min === \"function\"){\r\n\t\t\t\tminValue = config.min(id, column);\r\n\t\t\t}else{\r\n\t\t\t\tminValue = config.min;\r\n\t\t\t}\r\n\r\n\t\t\tif(typeof config.max === \"function\"){\r\n\t\t\t\tmaxValue = config.max(id, column);\r\n\t\t\t}else{\r\n\t\t\t\tmaxValue = config.max;\r\n\t\t\t}\r\n\r\n\t\t\tvar minAttr = minValue ? \" min='\" + dateToStr(minValue)+\"' \"  : \"\";\r\n\t\t\tvar maxAttr = maxValue ? \" max='\" + dateToStr(maxValue)+\"' \"  : \"\";\r\n\t\t\tvar html = `<div style='width:140px' role='cell'><input type='date' ${minAttr} ${maxAttr} name='${column.name}' title='${column.name}'></div>`;\r\n\t\t\tplaceholder.innerHTML = html;\r\n\r\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\r\n\t\t\tplaceholder.oninput = function (e) {\r\n\t\t\t\tif (e.target.value && (minValue || maxValue)){\r\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) < +minValue) {\r\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(minValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) > +maxValue) {\r\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(maxValue);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tset_value: function (value, id, column, node) {\r\n\t\t\tif (value && value.getFullYear) {\r\n\t\t\t\tthis.get_input(node).value = dateToStr(value);\r\n\t\t\t} else {\r\n\t\t\t\tthis.get_input(node).value = value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tis_valid: function (value, id, column, node) {\r\n\t\t\tif (!value || isNaN(value.getTime()))\r\n\t\t\t\treturn false;\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tget_value: function (id, column, node) {\r\n\t\t\tvar parsed;\r\n\t\t\ttry {\r\n\t\t\t\tparsed = strToDate(this.get_input(node).value || \"\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\tparsed = null;// return null will cancel changes\r\n\t\t\t}\r\n\r\n\t\t\treturn parsed;\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn DateEditor;\r\n};\r\n","import BaseFactory from \"./base\";\r\nimport * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\r\n\tfunction PredecessorEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(PredecessorEditor, BaseEditor);\r\n\r\n\tfunction getFormatter(config) {\r\n\t\treturn config.formatter || gantt.ext.formatters.linkFormatter();\r\n\t}\r\n\r\n\tfunction parseInputString(value, config) {\r\n\t\tvar predecessors = (value || \"\").split(config.delimiter || \",\");\r\n\t\tfor (var i = 0; i < predecessors.length; i++) {\r\n\t\t\tvar val = predecessors[i].trim();\r\n\t\t\tif (val) {\r\n\t\t\t\tpredecessors[i] = val;\r\n\t\t\t} else {\r\n\t\t\t\tpredecessors.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t\tpredecessors.sort();\r\n\t\treturn predecessors;\r\n\t}\r\n\r\n\tfunction formatPredecessors(task, config, gantt) {\r\n\t\tvar links = task.$target;\r\n\t\tvar labels = [];\r\n\t\tfor (var i = 0; i < links.length; i++) {\r\n\t\t\tvar link = gantt.getLink(links[i]);\r\n\t\t\tlabels.push(getFormatter(config).format(link));\r\n\t\t}\r\n\t\treturn labels.join((config.delimiter || \",\") + \" \");\r\n\t}\r\n\r\n\tfunction getSelectedLinks(taskId, predecessorCodes, config) {\r\n\t\tvar links = [];\r\n\t\t// select only unique codes GS-1439\r\n\t\t[...new Set(predecessorCodes)].forEach(function (code) {\r\n\t\t\tvar link = getFormatter(config).parse(code);\r\n\t\t\tif(link){\r\n\t\t\t\tlink.target = taskId;\r\n\t\t\t\t// GS-1290 A way to preserve the link. Otherwise validation will return false\r\n\t\t\t\t// because the existing link ID is not passed there\r\n\t\t\t\tlink.id = \"predecessor_generated\";\r\n\t\t\t\tif (gantt.isLinkAllowed(link)) {\r\n\t\t\t\t\tlink.id = undefined;\r\n\t\t\t\t\tlinks.push(link);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn links;\r\n\t}\r\n\r\n\tfunction formatLinkKey(link){\r\n\t\treturn link.source + \"_\" + link.target + \"_\" + link.type + \"_\" + (link.lag||0);\r\n\t}\r\n\r\n\tfunction getLinksDiff(task, predecessorCodes, config) {\r\n\t\tvar selectedLinks = getSelectedLinks(task.id, predecessorCodes, config);\r\n\t\tvar existingLinksSearch = {};\r\n\t\ttask.$target.forEach(function (linkId) {\r\n\t\t\tvar link = gantt.getLink(linkId);\r\n\t\t\texistingLinksSearch[formatLinkKey(link)] = link.id;\r\n\t\t});\r\n\r\n\t\tvar linksToAdd = [];\r\n\t\tselectedLinks.forEach(function (link) {\r\n\t\t\tvar linkKey = formatLinkKey(link);\r\n\t\t\tif (!existingLinksSearch[linkKey]) {\r\n\t\t\t\tlinksToAdd.push(link);\r\n\t\t\t} else {\r\n\t\t\t\tdelete existingLinksSearch[linkKey];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tvar linksToDelete = [];\r\n\t\tfor (var i in existingLinksSearch) {\r\n\t\t\tlinksToDelete.push(existingLinksSearch[i]);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tadd: linksToAdd,\r\n\t\t\tremove: linksToDelete\r\n\t\t};\r\n\t}\r\n\r\n\tutils.mixin(PredecessorEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\r\n\t\t\tplaceholder.innerHTML = html;\r\n\t\t},\r\n\t\thide: function () {\r\n\t\t},\r\n\t\tset_value: function (value, id, column, node) {\r\n\t\t\tthis.get_input(node).value = formatPredecessors(value, column.editor, gantt);\r\n\t\t},\r\n\t\tget_value: function (id, column, node) {\r\n\t\t\treturn parseInputString((this.get_input(node).value || \"\"), column.editor);\r\n\t\t},\r\n\t\tsave: function (id, column, node) {\r\n\t\t\tvar task = gantt.getTask(id);\r\n\r\n\t\t\tvar linksDiff = getLinksDiff(task, this.get_value(id, column, node), column.editor);\r\n\r\n\t\t\tif (linksDiff.add.length || linksDiff.remove.length) {\r\n\t\t\t\tgantt.batchUpdate(function () {\r\n\t\t\t\t\tlinksDiff.add.forEach(function (link) {\r\n\t\t\t\t\t\tgantt.addLink(link);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlinksDiff.remove.forEach(function (linkId) {\r\n\t\t\t\t\t\tgantt.deleteLink(linkId);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (gantt.autoSchedule)\r\n\t\t\t\t\t\tgantt.autoSchedule();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tis_changed: function (value, id, column, node) {\r\n\t\t\tvar inputPredecessors = this.get_value(id, column, node);\r\n\t\t\tvar taskPredecessors = parseInputString(formatPredecessors(value, column.editor, gantt), column.editor);\r\n\r\n\t\t\treturn inputPredecessors.join() !== taskPredecessors.join();\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn PredecessorEditor;\r\n};","import BaseFactory from \"./base\";\r\nimport * as utils from \"../../../../../utils/utils\";\r\nimport __extends from \"../../../../../utils/extends\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tvar BaseEditor = BaseFactory(gantt);\r\n\r\n\tfunction TextEditor() {\r\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(TextEditor, BaseEditor);\r\n\r\n\tfunction getFormatter(config) {\r\n\t\treturn config.formatter || gantt.ext.formatters.durationFormatter();\r\n\t}\r\n\tutils.mixin(TextEditor.prototype, {\r\n\t\tshow: function (id, column, config, placeholder) {\r\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\r\n\t\t\tplaceholder.innerHTML = html;\r\n\t\t},\r\n\t\tset_value: function (value, id, column, node) {\r\n\t\t\tthis.get_input(node).value = getFormatter(column.editor).format(value);\r\n\t\t},\r\n\t\tget_value: function (id, column, node) {\r\n\t\t\treturn getFormatter(column.editor).parse(this.get_input(node).value || \"\");\r\n\t\t}\r\n\t}, true);\r\n\r\n\treturn TextEditor;\r\n};","export default function (gantt) {\r\n\treturn function processTaskDateProperties(item, mapTo, mode) {\r\n\t\tif (mode == \"keepDates\") {\r\n\t\t\tkeepDatesOnEdit(item, mapTo);\r\n\t\t} else if (mode == \"keepDuration\") {\r\n\t\t\tkeepDurationOnEdit(item, mapTo);\r\n\t\t} else {\r\n\t\t\tdefaultActionOnEdit(item, mapTo);\r\n\t\t}\r\n\t};\r\n\r\n\t// resize task\r\n\t// resize task when start/end/duration changes\r\n\tfunction keepDatesOnEdit(item, mapTo) {\r\n\t\tif (mapTo == \"duration\") {\r\n\t\t\titem.end_date = gantt.calculateEndDate(item);\r\n\t\t} else if (mapTo == \"end_date\" || mapTo == \"start_date\") {\r\n\t\t\titem.duration = gantt.calculateDuration(item);\r\n\t\t}\r\n\t}\r\n\r\n\t// move task(before 6.2)\r\n\t// move task when start/end dates changes\r\n\t// resize task when duration changes\r\n\tfunction keepDurationOnEdit(item, mapTo) {\r\n\t\tif (mapTo == \"end_date\") {\r\n\t\t\titem.start_date = decreaseStartDate(item);\r\n\t\t} else if (mapTo == \"start_date\" || mapTo == \"duration\") {\r\n\t\t\titem.end_date = gantt.calculateEndDate(item);\r\n\t\t}\r\n\t}\r\n\r\n\t// default behavior\r\n\t// move task when start date changes\r\n\t// resize task when end date/duration changes\r\n\tfunction defaultActionOnEdit(item, mapTo) {\r\n\t\tif (gantt.config.schedule_from_end){\r\n\t\t\tif (mapTo == \"end_date\" || mapTo == \"duration\") {\r\n\t\t\t\titem.start_date = decreaseStartDate(item);\r\n\t\t\t} else if (mapTo == \"start_date\") {\r\n\t\t\t\titem.duration = gantt.calculateDuration(item);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (mapTo == \"start_date\" || mapTo == \"duration\") {\r\n\t\t\t\titem.end_date = gantt.calculateEndDate(item);\r\n\t\t\t} else if (mapTo == \"end_date\") {\r\n\t\t\t\titem.duration = gantt.calculateDuration(item);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction decreaseStartDate(item){\r\n\t\treturn gantt.calculateEndDate({\r\n\t\t\tstart_date: item.end_date,\r\n\t\t\tduration: -item.duration,\r\n\t\t\ttask: item\r\n\t\t});\r\n\t}\r\n};","import getKeyboardMapping from \"./keyboard_mappings\";\r\nimport textEditorFactory from \"./editors/text\";\r\nimport numberEditorFactory from \"./editors/number\";\r\nimport selectEditorFactory from \"./editors/select\";\r\nimport dateEditorFactory from \"./editors/date\";\r\nimport predecessorEditorFactory from \"./editors/predecessor\";\r\nimport durationEditorFactory from \"./editors/duration\";\r\nimport * as utils from \"../../../../utils/utils\";\r\nimport * as domHelpers from \"../../utils/dom_helpers\";\r\nimport eventable from \"../../../../utils/eventable\";\r\nimport linkedPropertiesProcessor from \"./linked_properties\";\r\n\r\nfunction initConfigs(gantt){\r\n\tgantt.config.editor_types = {\r\n\t\ttext: new (textEditorFactory(gantt))(),\r\n\t\tnumber: new (numberEditorFactory(gantt))(),\r\n\t\tselect: new (selectEditorFactory(gantt))(),\r\n\t\tdate: new (dateEditorFactory(gantt))(),\r\n\t\tpredecessor: new (predecessorEditorFactory(gantt))(),\r\n\t\tduration: new (durationEditorFactory(gantt))()\r\n\t};\r\n}\r\n\r\nfunction create(gantt){\r\n\tvar keyboardMapping = getKeyboardMapping(gantt);\r\n\r\n\tvar eventBus = {};\r\n\teventable(eventBus);\r\n\r\n\tfunction createGridEditors(grid) {\r\n\r\n\t\tfunction _getGridCellFromNode(node){\r\n\t\t\tif(!domHelpers.isChildOf(node, grid.$grid)){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tvar row = domHelpers.locateAttribute(node, grid.$config.item_attribute);\r\n\t\t\tvar cell = domHelpers.locateAttribute(node, \"data-column-name\");\r\n\t\t\tif(row && cell){\r\n\t\t\t\tvar columnName = cell.getAttribute(\"data-column-name\");\r\n\t\t\t\tvar id = row.getAttribute(grid.$config.item_attribute);\r\n\t\t\t\treturn {\r\n\t\t\t\t\tid: id,\r\n\t\t\t\t\tcolumnName: columnName\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\r\n\t\t}\r\n\r\n\t\tfunction _getEditorPosition(itemId, columnName) {\r\n\t\t\tvar config = grid.$getConfig();\r\n\t\t\tvar top = grid.getItemTop(itemId);\r\n\t\t\tvar height = grid.getItemHeight(itemId);\r\n\t\t\tvar cols = grid.getGridColumns();\r\n\t\t\tvar left = 0,\r\n\t\t\t\tright = 0,\r\n\t\t\t\twidth = 0;\r\n\r\n\t\t\tfor (var i = 0; i < cols.length; i++) {\r\n\t\t\t\tif (cols[i].name == columnName) {\r\n\t\t\t\t\twidth = cols[i].width;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tif (config.rtl) {\r\n\t\t\t\t\tright += cols[i].width;\r\n\t\t\t\t}\telse {\r\n\t\t\t\t\tleft += cols[i].width;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif (config.rtl) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttop: top,\r\n\t\t\t\t\tright: right,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\twidth: width\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttop: top,\r\n\t\t\t\t\tleft: left,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\twidth: width\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction findVisibleIndex(grid, columnName) {\r\n\t\t\tvar columns = grid.getGridColumns();\r\n\t\t\tfor (var i = 0; i < columns.length; i++){\r\n\t\t\t\tif(columns[i].name == columnName){\r\n\t\t\t\t\treturn i;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tfunction _createPlaceholder(itemId, columnName) {\r\n\t\t\tvar config = grid.$getConfig();\r\n\t\t\tvar pos = _getEditorPosition(itemId, columnName);\r\n\t\t\tvar el = document.createElement(\"div\");\r\n\t\t\tel.className = \"gantt_grid_editor_placeholder\";\r\n\t\t\tel.setAttribute(grid.$config.item_attribute, itemId);\r\n\t\t\tel.setAttribute(grid.$config.bind + \"_id\", itemId);// for backward compatibility\r\n\r\n\t\t\tel.setAttribute(\"data-column-name\", columnName);\r\n\r\n\t\t\tvar visibleIndex = findVisibleIndex(grid, columnName);\r\n\t\t\tel.setAttribute(\"data-column-index\", visibleIndex);\r\n\r\n\t\t\tgantt._waiAria.inlineEditorAttr(el);\r\n\r\n\t\t\tif (config.rtl) {\r\n\t\t\t\tel.style.cssText = [\r\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\r\n\t\t\t\t\t\"right:\" + pos.right + \"px\",\r\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\r\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\r\n\t\t\t\t].join(\";\");\r\n\t\t\t} else {\r\n\t\t\t\tel.style.cssText = [\r\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\r\n\t\t\t\t\t\"left:\" + pos.left + \"px\",\r\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\r\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\r\n\t\t\t\t].join(\";\");\r\n\t\t\t}\r\n\r\n\t\t\treturn el;\r\n\t\t}\r\n\r\n\t\tvar updateTaskDateProperties = linkedPropertiesProcessor(gantt);\r\n\r\n\t\tvar handlers = [];\r\n\t\tvar ganttHandlers = [];\r\n\t\tvar store = null;\r\n\t\tvar controller = {\r\n\t\t\t_itemId: null,\r\n\t\t\t_columnName: null,\r\n\t\t\t_editor: null,\r\n\t\t\t_editorType: null,\r\n\t\t\t_placeholder: null,\r\n\r\n\t\t\tlocateCell: _getGridCellFromNode,\r\n\t\t\tgetEditorConfig: function (columnName) {\r\n\t\t\t\tvar column = grid.getColumn(columnName);\r\n\t\t\t\treturn column.editor;\r\n\t\t\t},\r\n\r\n\t\t\tinit: function () {\r\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\r\n\t\t\t\tif(mapping.init){\r\n\t\t\t\t\tmapping.init(this, grid);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstore = grid.$gantt.getDatastore(grid.$config.bind);\r\n\r\n\t\t\t\tvar self = this;\r\n\r\n\t\t\t\thandlers.push(store.attachEvent(\"onIdChange\", function(oldId, newId){\r\n\t\t\t\t\tif(self._itemId == oldId){\r\n\t\t\t\t\t\tself._itemId = newId;\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\t\t\t\thandlers.push(store.attachEvent(\"onStoreUpdated\", function(){\r\n\t\t\t\t\tif(grid.$gantt.getState(\"batchUpdate\").batch_update){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(self.isVisible() && !store.isVisible(self._itemId)){\r\n\t\t\t\t\t\tself.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\r\n\t\t\t\tganttHandlers.push(gantt.attachEvent(\"onDataRender\", function(){\r\n\t\t\t\t\tif(self._editor && self._placeholder && !domHelpers.isChildOf(self._placeholder, gantt.$root)){\r\n\t\t\t\t\t\tgrid.$grid_data.appendChild(self._placeholder);\r\n\t\t\t\t\t}\r\n\t\t\t\t}));\r\n\r\n\t\t\t\tthis.init = function(){};\r\n\t\t\t},\r\n\r\n\t\t\tgetState: function(){\r\n\t\t\t\treturn {\r\n\t\t\t\t\teditor: this._editor,\r\n\t\t\t\t\teditorType: this._editorType,\r\n\t\t\t\t\tplaceholder: this._placeholder,\r\n\t\t\t\t\tid: this._itemId,\r\n\t\t\t\t\tcolumnName: this._columnName\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tstartEdit: function(itemId, columnName) {\r\n\t\t\t\tif (this.isVisible()) {\r\n\t\t\t\t\tthis.save();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(!store.exists(itemId)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\r\n\t\t\t\tif (gantt.isReadonly(store.getItem(itemId))) {\r\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.callEvent(\"onBeforeEditStart\", [editorState]) === false) {\r\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst asyncShow = this.show(editorState.id, editorState.columnName);\r\n\t\t\t\tif(asyncShow && asyncShow.then){\r\n\t\t\t\t\tasyncShow.then(function(){\r\n\t\t\t\t\t\tthis.setValue();\r\n\r\n\t\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\r\n\t\t\t\t\t}.bind(this));\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.setValue();\r\n\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisVisible: function(){\r\n\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt.$root));\r\n\t\t\t},\r\n\t\t\tshow: function (itemId, columnName) {\r\n\t\t\t\tif (this.isVisible()) {\r\n\t\t\t\t\tthis.save();\r\n\t\t\t\t}\r\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\r\n\r\n\t\t\t\tvar column = grid.getColumn(editorState.columnName);\r\n\t\t\t\tvar editorConfig = this.getEditorConfig(column.name);\r\n\t\t\t\tif(!editorConfig)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar editor = grid.$getConfig().editor_types[editorConfig.type];\r\n\r\n\t\t\t\tvar placeholder = _createPlaceholder(editorState.id, editorState.columnName);\r\n\t\t\t\tgrid.$grid_data.appendChild(placeholder);\r\n\r\n\t\t\t\tconst onAfterShow = (function(){\r\n\t\t\t\t\tthis._editor = editor;\r\n\t\t\t\t\tthis._placeholder = placeholder;\r\n\t\t\t\t\tthis._itemId = editorState.id;\r\n\t\t\t\t\tthis._columnName = editorState.columnName;\r\n\t\t\t\t\tthis._editorType = editorConfig.type;\r\n\r\n\t\t\t\t\tvar mapping = keyboardMapping.getMapping();\r\n\t\t\t\t\tif(mapping.onShow){\r\n\t\t\t\t\t\tmapping.onShow(this, placeholder, grid);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplaceholder._onReMount = (function(){\r\n\t\t\t\t\t\tthis.setValue();\r\n\t\t\t\t\t}).bind(this);\r\n\t\t\t\t}).bind(this);\r\n\r\n\t\t\t\tconst editorResult = editor.show(editorState.id, column, editorConfig, placeholder);\r\n\t\t\t\tif(editorResult && editorResult.then){\r\n\t\t\t\t\treturn editorResult.then(() => {\r\n\t\t\t\t\t\tonAfterShow();\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tonAfterShow();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tsetValue: function () {\r\n\t\t\t\tvar state = this.getState();\r\n\t\t\t\tvar itemId = state.id,\r\n\t\t\t\t\tcolumnName = state.columnName;\r\n\r\n\t\t\t\tvar column = grid.getColumn(columnName);\r\n\t\t\t\tvar item = store.getItem(itemId);\r\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\r\n\r\n\t\t\t\tif(!editorConfig)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar value = item[editorConfig.map_to];\r\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\r\n\t\t\t\t\tvalue = store.getItem(itemId);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._editor.set_value(value, itemId, column, this._placeholder);\r\n\t\t\t\tthis.focus();\r\n\t\t\t},\r\n\r\n\t\t\tfocus: function(){\r\n\t\t\t\tthis._editor.focus(this._placeholder);\r\n\t\t\t},\r\n\r\n\t\t\tgetValue: function () {\r\n\t\t\t\tvar column = grid.getColumn(this._columnName);\r\n\t\t\t\treturn this._editor.get_value(this._itemId, column, this._placeholder);\r\n\t\t\t},\r\n\r\n\t\t\t_getItemValue: function() {\r\n\t\t\t\tvar editorConfig = this.getEditorConfig(this._columnName);\r\n\r\n\t\t\t\tif(!editorConfig)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar item = gantt.getTask(this._itemId);\r\n\t\t\t\tvar value = item[editorConfig.map_to];\r\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\r\n\t\t\t\t\tvalue = store.getItem(this._itemId);\r\n\t\t\t\t}\r\n\t\t\t\treturn value;\r\n\t\t\t},\r\n\r\n\t\t\tisChanged: function(){\r\n\r\n\t\t\t\tvar column = grid.getColumn(this._columnName);\r\n\r\n\t\t\t\tvar value = this._getItemValue();\r\n\r\n\t\t\t\treturn this._editor.is_changed(value, this._itemId, column, this._placeholder);\r\n\t\t\t},\r\n\r\n\t\t\thide: function () {\r\n\t\t\t\tif(!this._itemId)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tvar itemId = this._itemId,\r\n\t\t\t\t\tcolumnName = this._columnName;\r\n\r\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\r\n\t\t\t\tif(mapping.onHide){\r\n\t\t\t\t\tmapping.onHide(this, this._placeholder, grid);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._itemId = null;\r\n\t\t\t\tthis._columnName = null;\r\n\t\t\t\tthis._editorType = null;\r\n\t\t\t\tif (!this._placeholder) return;\r\n\r\n\t\t\t\tif (this._editor && this._editor.hide) {\r\n\t\t\t\t\tthis._editor.hide(this._placeholder);\r\n\t\t\t\t}\r\n\t\t\t\tthis._editor = null;\r\n\t\t\t\tif (this._placeholder.parentNode) {\r\n\t\t\t\t\tthis._placeholder.parentNode.removeChild(this._placeholder);\r\n\t\t\t\t}\r\n\t\t\t\tthis._placeholder = null;\r\n\r\n\t\t\t\tthis.callEvent(\"onEditEnd\", [{id: itemId, columnName: columnName}]);\r\n\t\t\t},\r\n\t\t\tsave: function () {\r\n\t\t\t\tif(!(this.isVisible() && store.exists(this._itemId) && this.isChanged())) {\r\n\t\t\t\t\tthis.hide();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar itemId = this._itemId,\r\n\t\t\t\t\tcolumnName = this._columnName;\r\n\r\n\t\t\t\tif(!store.exists(itemId)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar item = store.getItem(itemId);\r\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\r\n\t\t\t\tvar editorState = {\r\n\t\t\t\t\tid: itemId,\r\n\t\t\t\t\tcolumnName: columnName,\r\n\t\t\t\t\tnewValue: this.getValue(),\r\n\t\t\t\t\toldValue: this._getItemValue()\r\n\t\t\t\t};\r\n\t\t\t\tif (this.callEvent(\"onBeforeSave\", [editorState]) !== false) {\r\n\t\t\t\t\tif (!this._editor.is_valid || this._editor.is_valid(editorState.newValue, editorState.id, grid.getColumn(columnName), this._placeholder)) {\r\n\r\n\t\t\t\t\t\tvar mapTo = editorConfig.map_to;\r\n\t\t\t\t\t\tvar value = editorState.newValue;\r\n\t\t\t\t\t\tif (mapTo != \"auto\") {\r\n\t\t\t\t\t\t\titem[mapTo] = value;\r\n\t\t\t\t\t\t\tupdateTaskDateProperties(item, mapTo, gantt.config.inline_editors_date_processing);\r\n\r\n\t\t\t\t\t\t\tstore.updateItem(itemId);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis._editor.save(itemId, grid.getColumn(columnName), this._placeholder);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.callEvent(\"onSave\", [editorState]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.hide();\r\n\t\t\t},\r\n\r\n\t\t\t_findEditableCell: function findEditableCell(start, direction){\r\n\t\t\t\tvar nextIndex = start;\r\n\t\t\t\tvar columns = grid.getGridColumns();\r\n\t\t\t\tvar nextColumn = columns[nextIndex];\r\n\r\n\t\t\t\tvar columnName = nextColumn ? nextColumn.name : null;\r\n\t\t\t\tif(columnName){\r\n\t\t\t\t\twhile(columnName && !this.getEditorConfig(columnName)){\r\n\t\t\t\t\t\tcolumnName = this._findEditableCell(start + direction, direction);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn columnName;\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t},\r\n\r\n\t\t\tgetNextCell: function moveCell(dir){\r\n\t\t\t\t// GS-1257. true means to exclude hidden columns\r\n\t\t\t\treturn this._findEditableCell(grid.getColumnIndex(this._columnName, true) + dir, dir);\r\n\t\t\t},\r\n\r\n\t\t\tgetFirstCell: function getFirstCell(){\r\n\t\t\t\treturn this._findEditableCell(0, 1);\r\n\t\t\t},\r\n\r\n\t\t\tgetLastCell: function getLastCell(){\r\n\t\t\t\treturn this._findEditableCell(grid.getGridColumns().length - 1, -1);\r\n\t\t\t},\r\n\r\n\t\t\teditNextCell: function nextCell(canChangeRow){\r\n\t\t\t\tvar cell = this.getNextCell(1);\r\n\t\t\t\tif(cell){\r\n\t\t\t\t\tvar nextColumn = this.getNextCell(1);\r\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\r\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(canChangeRow && this.moveRow(1)){\r\n\t\t\t\t\tvar task = this.moveRow(1);\r\n\t\t\t\t\tcell = this.getFirstCell();\r\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\r\n\t\t\t\t\t\tthis.startEdit(task, cell);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\teditPrevCell: function prevCell(canChangeRow){\r\n\t\t\t\tvar cell = this.getNextCell(-1);\r\n\t\t\t\tif(cell){\r\n\t\t\t\t\tvar nextColumn = this.getNextCell(-1);\r\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\r\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(canChangeRow && this.moveRow(-1)){\r\n\t\t\t\t\tvar task = this.moveRow(-1);\r\n\t\t\t\t\tcell = this.getLastCell();\r\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\r\n\t\t\t\t\t\tthis.startEdit(task, cell);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tmoveRow: function moveRow(dir) {\r\n\t\t\t\tvar moveTask = dir > 0 ? gantt.getNext : gantt.getPrev;\r\n\t\t\t\tmoveTask = gantt.bind(moveTask, gantt);\r\n\r\n\t\t\t\tvar nextItem = moveTask(this._itemId);\r\n\t\t\t\t// skip readonly rows\r\n\t\t\t\twhile (gantt.isTaskExists(nextItem) && gantt.isReadonly(gantt.getTask(nextItem))) {\r\n\t\t\t\t\tnextItem = moveTask(nextItem);\r\n\t\t\t\t}\r\n\t\t\t\treturn nextItem;\r\n\t\t\t},\r\n\r\n\t\t\teditNextRow: function nextRow(skipReadonly){\r\n\t\t\t\tvar id = this.getState().id;\r\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\r\n\r\n\t\t\t\tvar next = null;\r\n\t\t\t\tif (skipReadonly){\r\n\t\t\t\t\tnext = this.moveRow(1);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnext = gantt.getNext(id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (gantt.isTaskExists(next)){\r\n\t\t\t\t\tthis.startEdit(next, this._columnName);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\teditPrevRow: function prevRow(skipReadonly){\r\n\t\t\t\tvar id = this.getState().id;\r\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\r\n\r\n\t\t\t\tvar prev = null;\r\n\t\t\t\tif (skipReadonly){\r\n\t\t\t\t\tprev = this.moveRow(-1);\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tprev = gantt.getPrev(id);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (gantt.isTaskExists(prev)){\r\n\t\t\t\t\tthis.startEdit(prev, this._columnName);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdetachStore: function(){\r\n\t\t\t\thandlers.forEach(function(handlerId){\r\n\t\t\t\t\tstore.detachEvent(handlerId);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tganttHandlers.forEach(function(handlerId){\r\n\t\t\t\t\tgantt.detachEvent(handlerId);\r\n\t\t\t\t});\r\n\t\t\t\thandlers = [];\r\n\t\t\t\tganttHandlers = [];\r\n\r\n\t\t\t\tstore = null;\r\n\t\t\t\tthis.hide();\r\n\t\t\t},\r\n\t\t\tdestructor: function(){\r\n\t\t\t\tthis.detachStore();\r\n\t\t\t\tthis.detachAllEvents();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tutils.mixin(controller, keyboardMapping);\r\n\t\tutils.mixin(controller, eventBus);\r\n\r\n\t\treturn controller;\r\n\t}\r\n\r\n\r\n\tvar inlineEditController = {\r\n\t\tinit: initConfigs,\r\n\t\tcreateEditors: createGridEditors\r\n\t};\r\n\r\n\tutils.mixin(inlineEditController, keyboardMapping);\r\n\tutils.mixin(inlineEditController, eventBus);\r\n\r\n\treturn inlineEditController;\r\n}\r\n\r\n\r\n\r\n\r\nexport default create;","import defaultMapping from \"./keyboard_mappings/default\";\r\nimport keyNavMappings from \"./keyboard_mappings/keyboard_navigation\";\r\n\r\nexport default function(gantt){\r\n\r\n\tvar mapping = null;\r\n\r\n\treturn {\r\n\t\tsetMapping: function(map){\r\n\t\t\tmapping = map;\r\n\t\t},\r\n\t\tgetMapping: function(){\r\n\r\n\t\t\tif(mapping){\r\n\t\t\t\treturn mapping;\r\n\t\t\t}else if(gantt.config.keyboard_navigation_cells && gantt.ext.keyboardNavigation){\r\n\t\t\t\treturn keyNavMappings;\r\n\t\t\t}else{\r\n\t\t\t\treturn defaultMapping;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n};\r\n","// optimized checker for task bars smart rendering\r\n\r\n// first check the vertical position since it's easier to calculate\r\nexport default function isBarInViewport(item, viewport, view, config, gantt){\r\n\tif(!item.start_date || !item.end_date){\r\n\t\treturn null;\r\n\t}\r\n\r\n\tvar top = view.getItemTop(item.id);\r\n\tvar height = view.getItemHeight(item.id);\r\n\r\n\tif(top > viewport.y_end || top + height < viewport.y){\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar padding = 200;\r\n\tvar startCoord = view.posFromDate(item.start_date);\r\n\tvar endCoord = view.posFromDate(item.end_date);\r\n\tvar left = Math.min(startCoord, endCoord) - padding;\r\n\tvar right = Math.max(startCoord, endCoord) + padding;\r\n\r\n\tif(left > viewport.x_end || right < viewport.x){\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn true;\r\n};","function createTaskRenderer(gantt) {\r\n\r\n\tfunction _render_task_element(task, view, config) {\r\n\t\tvar config = view.$getConfig();\r\n\t\tvar painters = config.type_renderers;\r\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\r\n\t\t\tdefaultRenderer = _task_default_render;\r\n\r\n\t\tif (!renderer) {\r\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\r\n\t\t}else{\r\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _task_default_render(task, view, config) {\r\n\t\tif (gantt._isAllowedUnscheduledTask(task))\r\n\t\t\treturn;\r\n\r\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar pos = view.getItemPosition(task);\r\n\r\n\t\tvar cfg = config,\r\n\t\t\ttemplates = view.$getTemplates();\r\n\r\n\t\tvar taskType = gantt.getTaskType(task.type);\r\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\r\n\r\n\t\tvar controlsMargin = 0;\r\n\t\tif (taskType == cfg.types.milestone) {\r\n\t\t\tcontrolsMargin = (height - pos.height)/2;\r\n\t\t}\r\n\r\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\r\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\r\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\r\n\t\tif (hasBaselines && baselinesOnDifferentRow){\r\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\r\n\t\t\t\tif (taskType === cfg.types.milestone){\r\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\r\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\r\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpadd = 2;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t//\tif(task.type == cfg.types.milestone){\r\n\t//\t\tpadd -= 1;\r\n\t//\t}\r\n\t//\tif (taskType == cfg.types.milestone && cfg.link_line_width > 1) {\r\n\t//\t\t//little adjust milestone position, so horisontal corners would match link arrow when thickness of link line is more than 1px\r\n\t//\t\tpadd += 1;\r\n\t//\t}\r\n\r\n\t\tif (taskType == cfg.types.milestone) {\r\n\t\t\tpos.left -= Math.round(height / 2);\r\n\t\t\tpos.width = height;\r\n\t\t}\r\n\r\n\t\tvar div = document.createElement(\"div\");\r\n\r\n\t\tvar width = Math.round(pos.width);\r\n\r\n\t\tif(view.$config.item_attribute) {\r\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\r\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\r\n\t\t}\r\n\r\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\r\n\t\t\t_render_task_progress(task, div, width, cfg, templates);\r\n\t\t}\r\n\r\n\t\t//use separate div to display content above progress bar\r\n\t\tvar content = _render_task_content(task, width, templates);\r\n\r\n\t\tdiv.appendChild(content);\r\n\r\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\r\n\t\t\ttemplates.task_class(task.start_date, task.end_date, task),\r\n\t\t\ttask.id,\r\n\t\t\tview);\r\n\t\tif (task.color || task.progressColor || task.textColor) {\r\n\t\t\tcss += \" gantt_task_inline_color\";\r\n\t\t}\r\n\t\tif (pos.width < 20){\r\n\t\t\tcss += \" gantt_thin_task\";\r\n\t\t}\r\n\t\tdiv.className = css;\r\n\r\n\t\tvar styles = [\r\n\t\t\t\"left:\" + pos.left + \"px\",\r\n\t\t\t\"top:\" + (padd + pos.top) + 'px',\r\n\t\t\t\"height:\" + (height) + 'px',\r\n\t\t\t\"line-height:\" + (Math.max(height < 30 ? height - 2 : height, 0)) + 'px',\r\n\t\t\t\"width:\" + width + 'px'\r\n\t\t];\r\n\r\n\t\tdiv.style.cssText = styles.join(\";\");\r\n\t\tif (task.color) {\r\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\r\n\t\t}\r\n\t\tif (task.textColor) {\r\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\r\n\t\t}\r\n\r\n\t\tif (task.progressColor) {\r\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\r\n\t\t}\r\n\r\n\t\t\r\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\r\n\t\tif (side) div.appendChild(side);\r\n\r\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\r\n\t\tif (side) div.appendChild(side);\r\n\r\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\r\n\r\n\t\tvar state = gantt.getState();\r\n\t\tconst taskEditable = !gantt.isReadonly(task);\r\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\r\n\r\n\t\tif (taskEditable || timelineDrag) {\r\n\t\t\tif (cfg.drag_resize && !gantt.isSummaryTask(task) && taskType != cfg.types.milestone) {\r\n\t\t\t\t_render_pair(div, \"gantt_task_drag\", task, function (css) {\r\n\t\t\t\t\tvar el = document.createElement(\"div\");\r\n\t\t\t\t\tel.className = css;\r\n\t\t\t\t\treturn el;\r\n\t\t\t\t}, cfg);\r\n\t\t\t}\r\n\t\t\tif (cfg.drag_links && cfg.show_links) {\r\n\t\t\t\t_render_pair(div, \"gantt_link_control\", task, function (css) {\r\n\t\t\t\t\tvar outer = document.createElement(\"div\");\r\n\t\t\t\t\touter.className = css;\r\n\t\t\t\t\touter.style.cssText = [\r\n\t\t\t\t\t\t\"height:\" + height + 'px',\r\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\r\n\t\t\t\t\t].join(\";\");\r\n\t\t\t\t\tvar inner = document.createElement(\"div\");\r\n\t\t\t\t\tinner.className = \"gantt_link_point\";\r\n\r\n\t\t\t\t\tvar showLinkPoints = false;\r\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\r\n\t\t\t\t\t\tshowLinkPoints = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\r\n\t\t\t\t\touter.appendChild(inner);\r\n\t\t\t\t\treturn outer;\r\n\t\t\t\t}, cfg, controlsMargin);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn div;\r\n\t}\r\n\r\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\r\n\t\tif (!template) return null;\r\n\r\n\t\tvar text = template(task.start_date, task.end_date, task);\r\n\t\tif (!text) return null;\r\n\t\tvar content = document.createElement(\"div\");\r\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\r\n\t\tcontent.innerHTML = text;\r\n\t\tif(marginStyle){\r\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\r\n\t\t}\r\n\t\treturn content;\r\n\t}\r\n\r\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\r\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\r\n\t\tvar marginStyle = null;\r\n\t\tif(margin){\r\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\r\n\t\t}\r\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\r\n\t}\r\n\r\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\r\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\r\n\t\tvar marginStyle = null;\r\n\t\tif(margin){\r\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\r\n\t\t}\r\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\r\n\t}\r\n\r\n\tfunction _get_link_crossing_css(left, task) {\r\n\t\tvar cond = _get_conditions(left);\r\n\r\n\t\tfor (var i in cond) {\r\n\t\t\tvar links = task[i];\r\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\r\n\t\t\t\tvar link = gantt.getLink(links[ln]);\r\n\r\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\r\n\t\t\t\t\tif (link.type == cond[i][tp]) {\r\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\r\n\tfunction _render_task_content(task, width, templates) {\r\n\t\tvar content = document.createElement(\"div\");\r\n\t\tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\r\n\t\t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\r\n\t\t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\r\n\t\t\tcontent.style.height = content.style.width = width + \"px\";\r\n\t\t}\r\n\t\tcontent.className = \"gantt_task_content\";\r\n\t\t//content.style.width = width + 'px';\r\n\t\treturn content;\r\n\t}\r\n\r\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\r\n\t\tvar done = task.progress * 1 || 0;\r\n\t\t//GS-2776: borders were removed in v9.0\r\n\t\tmaxWidth = Math.max(maxWidth, 0);\r\n\t\tvar pr = document.createElement(\"div\");\r\n\t\tvar width = Math.round(maxWidth * done);\r\n\r\n\t\twidth = Math.min(maxWidth, width);\r\n\r\n\t\tpr.style.width = width + 'px';\r\n\t\tpr.className = \"gantt_task_progress\";\r\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\r\n\r\n\t\tif(cfg.rtl){\r\n\t\t\tpr.style.position = \"absolute\";\r\n\t\t\tpr.style.right = \"0px\";\r\n\t\t}\r\n\r\n\t\tvar wrapper = document.createElement(\"div\");\r\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\r\n\t\twrapper.appendChild(pr);\r\n\t\telement.appendChild(wrapper);\r\n\r\n\t\tconst taskEditable = !gantt.isReadonly(task);\r\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\r\n\r\n\t\tif (gantt.config.drag_progress && (taskEditable || timelineDrag)) {\r\n\t\t\tvar drag = document.createElement(\"div\");\r\n\r\n\t\t\tvar markerPos = width;\r\n\t\t\tif(cfg.rtl){\r\n\t\t\t\tmarkerPos = maxWidth - width;\r\n\t\t\t}\r\n\r\n\t\t\tdrag.style.left = markerPos + 'px';\r\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\r\n\t\t\tdrag.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\r\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\r\n</svg>`;\r\n\t\t\tpr.appendChild(drag);\r\n\t\t\telement.appendChild(drag);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _get_conditions(leftside) {\r\n\t\tif (leftside) {\r\n\t\t\treturn {\r\n\t\t\t\t$source: [\r\n\t\t\t\t\tgantt.config.links.start_to_start\r\n\t\t\t\t],\r\n\t\t\t\t$target: [\r\n\t\t\t\t\tgantt.config.links.start_to_start,\r\n\t\t\t\t\tgantt.config.links.finish_to_start\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\treturn {\r\n\t\t\t\t$source: [\r\n\t\t\t\t\tgantt.config.links.finish_to_start,\r\n\t\t\t\t\tgantt.config.links.finish_to_finish\r\n\t\t\t\t],\r\n\t\t\t\t$target: [\r\n\t\t\t\t\tgantt.config.links.finish_to_finish\r\n\t\t\t\t]\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _combine_item_class(basic, template, itemId, view) {\r\n\t\tvar cfg = view.$getConfig();\r\n\t\tvar css = [basic];\r\n\t\tif (template)\r\n\t\t\tcss.push(template);\r\n\r\n\t\tvar state = gantt.getState();\r\n\r\n\t\tvar task = gantt.getTask(itemId);\r\n\r\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\r\n\t\t\tcss.push(\"gantt_milestone\");\r\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\r\n\t\t\tcss.push(\"gantt_project\");\r\n\t\t}\r\n\r\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\r\n\r\n\r\n\t\tif (gantt.isSummaryTask(task))\r\n\t\t\tcss.push(\"gantt_dependent_task\");\r\n\r\n\t\tif (gantt.isSplitTask(task) && ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks)) {\r\n\t\t\tcss.push(\"gantt_split_parent\");\r\n\t\t}\r\n\r\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\r\n\t\t\tcss.push(\"gantt_selected\");\r\n\t\t}\r\n\r\n\t\tif (itemId == state.drag_id) {\r\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\r\n\t\t\tif (state.touch_drag) {\r\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state.link_source_id == itemId){\r\n\t\t\tcss.push(\"gantt_link_source\");\r\n\t\t\tif(state.link_from_start) {\r\n\t\t\t\tcss.push(\"gantt_link_from_start\");\r\n\t\t\t}else{\r\n\t\t\t\tcss.push(\"gantt_link_from_end\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (state.link_target_id == itemId)\r\n\t\t\tcss.push(\"gantt_link_target\");\r\n\r\n\r\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\r\n\t\t\tif (gantt.isCriticalTask(task))\r\n\t\t\t\tcss.push(\"gantt_critical_task\");\r\n\t\t}\r\n\r\n\t\tif (state.link_landing_area &&\r\n\t\t\t(state.link_target_id && state.link_source_id) &&\r\n\t\t\t(state.link_target_id != state.link_source_id) &&\r\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\r\n\r\n\t\t\tvar from_id = state.link_source_id;\r\n\t\t\tvar from_start = state.link_from_start;\r\n\t\t\tvar to_start = state.link_to_start;\r\n\r\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\r\n\r\n\t\t\tvar dragClass = \"\";\r\n\t\t\tif (allowDrag) {\r\n\t\t\t\tif (to_start)\r\n\t\t\t\t\tdragClass = \"link_start_allow\";\r\n\t\t\t\telse\r\n\t\t\t\t\tdragClass = \"link_finish_allow\";\r\n\t\t\t} else {\r\n\t\t\t\tif (to_start)\r\n\t\t\t\t\tdragClass = \"link_start_deny\";\r\n\t\t\t\telse\r\n\t\t\t\t\tdragClass = \"link_finish_deny\";\r\n\t\t\t}\r\n\t\t\tcss.push(dragClass);\r\n\t\t}\r\n\t\treturn css.join(\" \");\r\n\t}\r\n\r\n\tfunction _render_pair(parent, css, task, content, config, margin) {\r\n\t\tvar state = gantt.getState();\r\n\t\tvar className, element;\r\n\t\tif (+task.start_date >= +state.min_date) {\r\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\r\n\t\t\telement = content(className.join(\" \"));\r\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\r\n\t\t\tif(margin){\r\n\t\t\t\telement.style.marginLeft = margin + \"px\";\r\n\t\t\t}\r\n\t\t\tparent.appendChild(element);\r\n\t\t}\r\n\r\n\t\tif (+task.end_date <= +state.max_date){\r\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\r\n\t\t\telement = content(className.join(\" \"));\r\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\r\n\t\t\tif(margin){\r\n\t\t\t\telement.style.marginRight = margin + \"px\";\r\n\t\t\t}\r\n\t\t\tparent.appendChild(element);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\treturn _render_task_element;\r\n}\r\n\r\nexport default createTaskRenderer;","import isInViewPort from \"./viewport/is_bar_in_viewport\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\nimport createBaseBarRender from \"./task_bar_render\";\r\n\r\nexport default function createTaskRenderer(gantt){\r\n\tvar defaultRender = createBaseBarRender(gantt);\r\n\treturn {\r\n\t\trender: defaultRender,\r\n\t\tupdate: null,\r\n\t\t//getRectangle: getBarRectangle\r\n\t\tisInViewPort: isInViewPort,\r\n\t\tgetVisibleRange: getVisibleRange\r\n\t};\r\n};","export default function () {\r\n  // eslint-disable-next-line no-console\r\n  console.error(\"You are trying to use a Pro feature that is not available in the GPL version.\");\r\n  return {\r\n    render: function (){},\r\n    isInViewPort: function (){},\r\n    getVisibleRange: function (){}\r\n  };\r\n};\r\n","export default function(item, view, config){\r\n\treturn {\r\n\t\ttop: view.getItemTop(item.id),\r\n\t\theight: view.getItemHeight(item.id),\r\n\t\tleft: 0,\r\n\t\tright: Infinity\r\n\t};\r\n};","export default function getVisibleCellsRange(scale, viewport){\r\n\tvar firstCellIndex = 0;\r\n\tvar lastCellIndex = scale.left.length - 1;\r\n\tif(viewport){\r\n\t\tfor(var i = 0; i < scale.left.length; i++){\r\n\t\t\tvar left = scale.left[i];\r\n\t\t\tif(left < viewport.x){\r\n\t\t\t\tfirstCellIndex = i;\r\n\t\t\t}\r\n\t\t\tif(left > viewport.x_end){\r\n\t\t\t\tlastCellIndex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tstart: firstCellIndex,\r\n\t\tend: lastCellIndex\r\n\t};\r\n};","import isLegacyRender from \"../is_legacy_smart_render\";\r\n\r\nexport default function isColumnVisible(columnIndex, scale, viewPort, gantt){\r\n\tvar width = scale.width[columnIndex];\r\n\tif(width <= 0){\r\n\t\treturn false;\r\n\t}\r\n\tif(!gantt.config.smart_rendering || isLegacyRender(gantt)){\r\n\t\treturn true;\r\n\t}\r\n\tvar cellLeftCoord = scale.left[columnIndex] - width;\r\n\tvar cellRightCoord = scale.left[columnIndex] + width;\r\n\treturn (cellLeftCoord <= viewPort.x_end && cellRightCoord >= viewPort.x);//do not render skipped columns\r\n};","export default function (items, gantt){\r\n\tvar placeholderConfig = gantt.config.timeline_placeholder;\r\n\titems = items || [];\r\n\tif (placeholderConfig && items.filter(e => e.id === 'timeline_placeholder_task').length === 0){\r\n\t\tvar state = gantt.getState();\r\n\t\tvar lastTaskId = null;\r\n\t\tvar start_date = state.min_date;\r\n\t\tvar end_date = state.max_date;\r\n\t\tif (items.length){\r\n\t\t\tlastTaskId = items[items.length -1].id;\r\n\t\t}\r\n\t\tvar placeholderTask = {\r\n\t\t\tstart_date: start_date, \r\n\t\t\tend_date: end_date, \r\n\t\t\trow_height: placeholderConfig.height || 0,\r\n\t\t\tid: \"timeline_placeholder_task\", \r\n\t\t\tunscheduled: true,\r\n\t\t\tlastTaskId: lastTaskId, \r\n\t\t\tcalendar_id: placeholderConfig.calendar || \"global\",\r\n\t\t\t$source:[], \r\n\t\t\t$target: []\r\n\t\t};\r\n\t\titems.push(placeholderTask);\r\n\t}\r\n};","import isInViewPort from \"./viewport/is_link_in_viewport\";\r\nimport getVisibleRange from \"./viewport/factory/get_visible_link_range\";\r\nimport { childrenHaveBaselines, getMaxParentHeight } from \"./baseline_helper\";\r\n\r\n\r\nfunction createLinkRender(gantt){\r\n\r\nfunction _render_link_element(link, view, config) {\r\n\tvar source = gantt.getTask(link.source);\r\n\tif(source.hide_bar){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar target = gantt.getTask(link.target);\r\n\tif(target.hide_bar){\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar pt = path_builder.get_endpoint(link, view, source, target);\r\n\tvar dy = pt.e_y - pt.y;\r\n\tvar dx = pt.e_x - pt.x;\r\n\tif(!dx && !dy){\r\n\t\treturn null;\r\n\t}\r\n\r\n\r\n\tvar dots = path_builder.get_points(link, view, source, target);\r\n\tconst lines = drawer.get_lines(dots, view);\r\n\r\n\tconst shapes = transform_lines_to_shapes(lines.filter(l => l.size > 0), config);\r\n  \r\n\tconst div = render_shapes(shapes, view, link, config);\r\n\r\n\r\n\tvar css = \"gantt_task_link\";\r\n\r\n\tif (link.color) {\r\n\t\tcss += \" gantt_link_inline_color\";\r\n\t}\r\n\tvar cssTemplate = gantt.templates.link_class ? gantt.templates.link_class(link) : \"\";\r\n\tif (cssTemplate) {\r\n\t\tcss += \" \" + cssTemplate;\r\n\t}\r\n\r\n\tif (config.highlight_critical_path && gantt.isCriticalLink) {\r\n\t\tif (gantt.isCriticalLink(link))\r\n\t\t\tcss += \" gantt_critical_link\";\r\n\t}\r\n\r\n\tdiv.className = css;\r\n\r\n\tif(view.$config.link_attribute){\r\n\t\tdiv.setAttribute(view.$config.link_attribute, link.id);\r\n\t\tdiv.setAttribute(\"link_id\", link.id);\r\n\t}\r\n\tif (link.color) {\r\n\t\tdiv.style.setProperty(\"--dhx-gantt-link-background\", link.color);\r\n\t}\r\n\r\n\tgantt._waiAria.linkAttr(link, div);\r\n\r\n\treturn div;\r\n}\r\n\r\n\tfunction render_shapes(shapes, view, link, config) {\r\n\t\tconst container = document.createElement(\"div\");\r\n\r\n\t\tshapes.forEach(shape => {\r\n\t\t\tlet element;\r\n\t\t\tif (shape.type === 'line') {\r\n\t\t\t\telement = drawer.render_line(shape.data, null, view, link.source);\r\n\t\t\t} else if (shape.type === 'corner') {\r\n\t\t\t\telement = drawer.render_corner(shape.data, view);\r\n\t\t\t}else if (shape.type === 'arrow') {\r\n\t\t\t\telement = drawer.render_arrow(shape.data, config);\r\n\t\t\t}\r\n\r\n\t\t\tcontainer.appendChild(element);\r\n\t\t});\r\n\r\n\t\treturn container;\r\n\t}\r\n\r\n\tfunction transform_lines_to_shapes(lines, config) {\r\n\t\tconst radius = config.link_radius || 4;\r\n\t\tconst arrowSize = config.link_arrow_size || 6; // Arrow size from config\r\n\t\tconst shapes = [];\r\n\t\r\n\t\tfor (let i = 0; i < lines.length; i++) {\r\n\t\t\tconst line = lines[i];\r\n\t\t\tconst nextLine = lines[i + 1];\r\n\t\r\n\t\t\tif (!nextLine || config.link_radius <= 1) {\r\n\t\t\t\tshapes.push({ type: 'line', data: line });\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\r\n\t\t\tif (line.direction !== nextLine.direction) {\r\n\t\t\t\tif(line.size < radius || nextLine.size < radius){\r\n\t\t\t\t\tshapes.push({ type: 'line', data: line });\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tline.size -= radius;\r\n\t\t\t\tshapes.push({ type: 'line', data: line });\r\n\t\r\n\t\t\t\tlet cornerX = line.x;\r\n\t\t\t\tlet cornerY = line.y - config.link_line_width / 2;\r\n\t\r\n\t\t\t\tswitch (line.direction) {\r\n\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\tcornerX += line.size;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\tcornerX -= line.size;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'down':\r\n\t\t\t\t\t\tcornerY += line.size;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'up':\r\n\t\t\t\t\t\tcornerY -= line.size;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tconst corner = {\r\n\t\t\t\t\tx: cornerX,\r\n\t\t\t\t\ty: cornerY,\r\n\t\t\t\t\tdirection: { from: line.direction, to: nextLine.direction },\r\n\t\t\t\t\tradius\r\n\t\t\t\t};\r\n\t\t\t\tshapes.push({ type: 'corner', data: corner });\r\n\t\r\n\t\t\t\tswitch (nextLine.direction) {\r\n\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\tnextLine.x += radius;\r\n\t\t\t\t\t\tnextLine.size -= radius;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\tnextLine.x -= radius;\r\n\t\t\t\t\t\tnextLine.size -= radius;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'down':\r\n\t\t\t\t\t\tnextLine.y += radius;\r\n\t\t\t\t\t\tnextLine.size -= radius;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'up':\r\n\t\t\t\t\t\tnextLine.y -= radius;\r\n\t\t\t\t\t\tnextLine.size -= radius;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tshapes.push({ type: 'line', data: line });\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tconst lastLine = lines[lines.length - 1];\r\n\t\r\n\t\tif (lastLine.direction === 'right' || lastLine.direction === 'left') {\r\n\t\t\tlastLine.size -= arrowSize*3/4; \r\n\t\r\n\t\t\tlet arrowX = lastLine.direction === 'right' ? (lastLine.x + lastLine.size) : lastLine.x - lastLine.size - arrowSize/2;\r\n\t\t\tlet arrowY = lastLine.y - (config.link_line_width / 2) - (arrowSize / 2) + 1;\r\n\t\r\n\t\t\tif(lastLine.direction === 'left'){\r\n\t\t\t\tarrowY -= 1;// left pointing arrows for some reason need adjustments\r\n\t\t\t\tarrowX -= 2;\r\n\t\t\t}else{\r\n\t\t\t\tarrowX -= 1;\r\n\t\t\t}\r\n\t\t\tconst arrow = {\r\n\t\t\t\tx: arrowX,\r\n\t\t\t\ty: arrowY,\r\n\t\t\t\tsize: arrowSize,\r\n\t\t\t\tdirection: lastLine.direction\r\n\t\t\t};\r\n\t\r\n\t\t\tshapes.push({ type: 'line', data: lastLine });\r\n\t\t\tshapes.push({ type: 'arrow', data: arrow });\r\n\t\t} else {\r\n\t\t\tshapes.push({ type: 'line', data: lastLine });\r\n\t\t}\r\n\t\r\n\t\treturn shapes;\r\n\t}\r\n\t\r\n\r\n\r\nvar drawer = {\r\n\tcurrent_pos: null,\r\n\tdirs: {\"left\": 'left', \"right\": 'right', \"up\": 'up', \"down\": 'down'},\r\n\tpath: [],\r\n\tclear: function () {\r\n\t\tthis.current_pos = null;\r\n\t\tthis.path = [];\r\n\t},\r\n\tpoint: function (pos) {\r\n\t\tthis.current_pos = gantt.copy(pos);\r\n\t},\r\n\tget_lines: function (dots) {\r\n\t\tthis.clear();\r\n\t\tthis.point(dots[0]);\r\n\t\tfor (var i = 1; i < dots.length; i++) {\r\n\t\t\tthis.line_to(dots[i]);\r\n\t\t}\r\n\t\treturn this.get_path();\r\n\t},\r\n\tline_to: function (pos) {\r\n\t\tvar next = gantt.copy(pos);\r\n\t\tvar prev = this.current_pos;\r\n\r\n\t\tvar line = this._get_line(prev, next);\r\n\t\tthis.path.push(line);\r\n\t\tthis.current_pos = next;\r\n\t},\r\n\tget_path: function () {\r\n\t\treturn this.path;\r\n\t},\r\n\tget_wrapper_sizes: function (v, view, itemId) {\r\n\t\tvar config = view.$getConfig();\r\n\t\tvar res,\r\n\t\t\twrapper_size = config.link_wrapper_width,\r\n\t\t\ty = v.y - (wrapper_size) / 2;\r\n\t\tswitch (v.direction) {\r\n\t\t\tcase this.dirs.left:\r\n\t\t\t\tres = {\r\n\t\t\t\t\ttop: y,\r\n\t\t\t\t\theight: wrapper_size,\r\n\t\t\t\t\tlineHeight: wrapper_size,\r\n\t\t\t\t\tleft: v.x - v.size - wrapper_size / 2,\r\n\t\t\t\t\twidth: v.size + wrapper_size\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase this.dirs.right:\r\n\t\t\t\tres = {\r\n\t\t\t\t\ttop: y,\r\n\t\t\t\t\tlineHeight: wrapper_size,\r\n\t\t\t\t\theight: wrapper_size,\r\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\r\n\t\t\t\t\twidth: v.size + wrapper_size\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase this.dirs.up:\r\n\t\t\t\tres = {\r\n\t\t\t\t\ttop: y - v.size,\r\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\r\n\t\t\t\t\theight: v.size + wrapper_size,\r\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\r\n\t\t\t\t\twidth: wrapper_size\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase this.dirs.down:\r\n\t\t\t\tres = {\r\n\t\t\t\t\ttop: y /*- wrapper_size/2*/,\r\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\r\n\t\t\t\t\theight: v.size + wrapper_size,\r\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\r\n\t\t\t\t\twidth: wrapper_size\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t},\r\n\tget_line_sizes: function (v, view) {\r\n\t\tvar config = view.$getConfig();\r\n\t\tvar res,\r\n\t\t\tline_size = config.link_line_width,\r\n\t\t\twrapper_size = config.link_wrapper_width,\r\n\t\t\tsize = v.size + line_size;\r\n\t\tswitch (v.direction) {\r\n\t\t\tcase this.dirs.left:\r\n\t\t\tcase this.dirs.right:\r\n\t\t\t\tres = {\r\n\t\t\t\t\theight: line_size,\r\n\t\t\t\t\twidth: size,\r\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\r\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tcase this.dirs.up:\r\n\t\t\tcase this.dirs.down:\r\n\t\t\t\tres = {\r\n\t\t\t\t\theight: size,\r\n\t\t\t\t\twidth: line_size,\r\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\r\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\r\n\t\t\t\t};\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\r\n\t\treturn res;\r\n\t},\r\n\trender_line: function (v, end, view, itemId) {\r\n\t\tvar pos = this.get_wrapper_sizes(v, view, itemId);\r\n\t\tvar wrapper = document.createElement(\"div\");\r\n\t\twrapper.style.cssText = [\r\n\t\t\t\"top:\" + pos.top + \"px\",\r\n\t\t\t\"left:\" + pos.left + \"px\",\r\n\t\t\t\"height:\" + pos.height + \"px\",\r\n\t\t\t\"width:\" + pos.width + \"px\"\r\n\t\t].join(';');\r\n\t\twrapper.className = \"gantt_line_wrapper\";\r\n\r\n\t\tvar innerPos = this.get_line_sizes(v, view);\r\n\t\tvar inner = document.createElement(\"div\");\r\n\t\tinner.style.cssText = [\r\n\t\t\t\"height:\" + innerPos.height + \"px\",\r\n\t\t\t\"width:\" + innerPos.width + \"px\",\r\n\t\t\t\"margin-top:\" + innerPos.marginTop + \"px\",\r\n\t\t\t\"margin-left:\" + innerPos.marginLeft + \"px\"\r\n\t\t].join(\";\");\r\n\r\n\t\tinner.className = \"gantt_link_line_\" + v.direction;\r\n\t\twrapper.appendChild(inner);\r\n\r\n\t\treturn wrapper;\r\n\t},\r\n\r\n\trender_corner: function (corner, view) {\r\n\t\tconst radius = corner.radius;\r\n\t\tconst config = view.$getConfig();\r\n\t\tconst lineWidth = config.link_line_width || 2;\r\n\t\tconst cornerDiv = document.createElement(\"div\");\r\n\t\r\n\t\tcornerDiv.classList.add(\"gantt_link_corner\");\r\n\t\tcornerDiv.classList.add(`gantt_link_corner_${corner.direction.from}_${corner.direction.to}`);\r\n\t\r\n\t\tcornerDiv.style.width = `${radius}px`;\r\n\t\tcornerDiv.style.height = `${radius}px`;\r\n\t\r\n\t\tlet borderVertical;\r\n\t\tlet borderHorizontal;\r\n\r\n\t\tif (corner.direction.from === 'right' && corner.direction.to === 'down') {\r\n\t\t\tborderVertical = \"Right\";\r\n\t\t\tborderHorizontal = \"Top\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\r\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'right') {\r\n\t\t\tborderVertical = \"Left\";\r\n\t\t\tborderHorizontal = \"Bottom\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\r\n\t\t} else if (corner.direction.from === 'right' && corner.direction.to === 'up') {\r\n\t\t\tborderVertical = \"Right\";\r\n\t\t\tborderHorizontal = \"Bottom\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\r\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'right') {\r\n\t\t\tborderVertical = \"Left\";\r\n\t\t\tborderHorizontal = \"Top\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\r\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'down') {\r\n\t\t\tborderVertical = \"Left\";\r\n\t\t\tborderHorizontal = \"Top\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\r\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'left') {\r\n\t\t\tborderVertical = \"Right\";\r\n\t\t\tborderHorizontal = \"Bottom\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\r\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'up') {\r\n\t\t\tborderVertical = \"Left\";\r\n\t\t\tborderHorizontal = \"Bottom\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\r\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'left') {\r\n\t\t\tborderVertical = \"Right\";\r\n\t\t\tborderHorizontal = \"Top\";\r\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\r\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\r\n\t\t}\r\n\r\n\t\tcornerDiv.style[`border${borderHorizontal}Width`] = `${lineWidth}px`;\r\n\t\tcornerDiv.style[`border${borderVertical}Width`] = `${lineWidth}px`;\r\n\t\tcornerDiv.style[`border${borderVertical}Style`] = `solid`;\r\n\t\tcornerDiv.style[`border${borderHorizontal}Style`] = `solid`;\r\n\t\tcornerDiv.style[`border${borderHorizontal}${borderVertical}Radius`] = `${radius}px`;\r\n\r\n\t\r\n\t\treturn cornerDiv;\r\n\t},\r\n\r\n\trender_arrow(arrow, config) {\r\n\t\tvar div = document.createElement(\"div\");\r\n\t\tvar top = arrow.y;\r\n\t\tvar left = arrow.x;\r\n\t\r\n\t\tvar size = config.link_arrow_size;\r\n\t\tdiv.style.setProperty(\"--dhx-gantt-icon-size\", `${size}px`);\r\n\t\r\n\t\tvar className = \"gantt_link_arrow gantt_link_arrow_\" + arrow.direction;\r\n\r\n\t\tdiv.style.top = top + \"px\";\r\n\t\tdiv.style.left = left + 'px';\r\n\t\tdiv.className = className;\r\n\t\r\n\t\treturn div;\r\n\t},\r\n\t\r\n\t_get_line: function (from, to) {\r\n\t\tvar direction = this.get_direction(from, to);\r\n\t\tvar vect = {\r\n\t\t\tx: from.x,\r\n\t\t\ty: from.y,\r\n\t\t\tdirection: this.get_direction(from, to)\r\n\t\t};\r\n\t\tif (direction == this.dirs.left || direction == this.dirs.right) {\r\n\t\t\tvect.size = Math.abs(from.x - to.x);\r\n\t\t} else {\r\n\t\t\tvect.size = Math.abs(from.y - to.y);\r\n\t\t}\r\n\t\treturn vect;\r\n\t},\r\n\tget_direction: function (from, to) {\r\n\t\tvar direction = 0;\r\n\t\tif (to.x < from.x) {\r\n\t\t\tdirection = this.dirs.left;\r\n\t\t} else if (to.x > from.x) {\r\n\t\t\tdirection = this.dirs.right;\r\n\t\t} else if (to.y > from.y) {\r\n\t\t\tdirection = this.dirs.down;\r\n\t\t} else {\r\n\t\t\tdirection = this.dirs.up;\r\n\t\t}\r\n\t\treturn direction;\r\n\t}\r\n\r\n};\r\n\r\nvar path_builder = {\r\n\r\n\tpath: [],\r\n\tclear: function () {\r\n\t\tthis.path = [];\r\n\t},\r\n\tcurrent: function () {\r\n\t\treturn this.path[this.path.length - 1];\r\n\t},\r\n\tpoint: function (next) {\r\n\t\tif (!next)\r\n\t\t\treturn this.current();\r\n\r\n\t\tthis.path.push(gantt.copy(next));\r\n\t\treturn next;\r\n\t},\r\n\tpoint_to: function (direction, diff, point) {\r\n\t\tif (!point)\r\n\t\t\tpoint = gantt.copy(this.point());\r\n\t\telse\r\n\t\t\tpoint = {x: point.x, y: point.y};\r\n\t\tvar dir = drawer.dirs;\r\n\t\tswitch (direction) {\r\n\t\t\tcase (dir.left):\r\n\t\t\t\tpoint.x -= diff;\r\n\t\t\t\tbreak;\r\n\t\t\tcase (dir.right):\r\n\t\t\t\tpoint.x += diff;\r\n\t\t\t\tbreak;\r\n\t\t\tcase (dir.up):\r\n\t\t\t\tpoint.y -= diff;\r\n\t\t\t\tbreak;\r\n\t\t\tcase (dir.down):\r\n\t\t\t\tpoint.y += diff;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this.point(point);\r\n\t},\r\n\tget_points: function (link, view, source, target) {\r\n\t\tvar pt = this.get_endpoint(link, view, source, target);\r\n\t\tvar xy = gantt.config;\r\n\r\n\t\tvar dy = pt.e_y - pt.y;\r\n\t\tvar dx = pt.e_x - pt.x;\r\n\r\n\t\tvar dir = drawer.dirs;\r\n\r\n\t\tvar rowHeight = view.getItemHeight(link.source);\r\n\r\n\t\tthis.clear();\r\n\t\tthis.point({x: pt.x, y: pt.y});\r\n\r\n\t\tvar shiftX = 2 * xy.link_arrow_size;//just random size for first line\r\n\t\tvar lineType = this.get_line_type(link, view.$getConfig());\r\n\r\n\t\tvar forward = (pt.e_x > pt.x);\r\n\t\tif (lineType.from_start && lineType.to_start) {\r\n\t\t\tthis.point_to(dir.left, shiftX);\r\n\t\t\tif (forward) {\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t} else {\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t}\r\n\t\t\tthis.point_to(dir.right, shiftX);\r\n\r\n\t\t} else if (!lineType.from_start && lineType.to_start) {\r\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\r\n\t\t\tif (dy !== 0){\r\n\t\t\t\tforward = (pt.e_x > (pt.x + 2 * shiftX));\r\n\t\t\t}\r\n\t\t\tthis.point_to(dir.right, shiftX);\r\n\t\t\tif (forward) {\r\n\t\t\t\tdx -= shiftX;\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t} else {\r\n\t\t\t\tdx -= 2 * shiftX;\r\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\r\n\r\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\r\n\t\t\t\tthis.point_to(dir.right, shiftX);\r\n\t\t\t}\r\n\r\n\t\t} else if (!lineType.from_start && !lineType.to_start) {\r\n\t\t\tthis.point_to(dir.right, shiftX);\r\n\t\t\tif (forward) {\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t} else {\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t}\r\n\t\t\tthis.point_to(dir.left, shiftX);\r\n\t\t} else if (lineType.from_start && !lineType.to_start) {\r\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\r\n\t\t\tif (dy !== 0){\r\n\t\t\t\tforward = (pt.e_x > (pt.x - 2 * shiftX));\r\n\t\t\t}\r\n\t\t\tthis.point_to(dir.left, shiftX);\r\n\r\n\t\t\tif (!forward) {\r\n\t\t\t\tdx += shiftX;\r\n\t\t\t\tthis.point_to(dir.down, dy);\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t} else {\r\n\t\t\t\tdx += 2 * shiftX;\r\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\r\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\r\n\t\t\t\tthis.point_to(dir.right, dx);\r\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\r\n\t\t\t\tthis.point_to(dir.left, shiftX);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn this.path;\r\n\t},\r\n\tget_line_type: function(link, config){\r\n\t\tvar types = config.links;\r\n\t\tvar from_start = false, to_start = false;\r\n\t\tif (link.type == types.start_to_start) {\r\n\t\t\tfrom_start = to_start = true;\r\n\t\t} else if (link.type == types.finish_to_finish) {\r\n\t\t\tfrom_start = to_start = false;\r\n\t\t} else if (link.type == types.finish_to_start) {\r\n\t\t\tfrom_start = false;\r\n\t\t\tto_start = true;\r\n\t\t} else if (link.type == types.start_to_finish) {\r\n\t\t\tfrom_start = true;\r\n\t\t\tto_start = false;\r\n\t\t} else {\r\n\t\t\tgantt.assert(false, \"Invalid link type\");\r\n\t\t}\r\n\r\n\t\tif(config.rtl){\r\n\t\t\tfrom_start = !from_start;\r\n\t\t\tto_start = !to_start;\r\n\t\t}\r\n\r\n\t\treturn {from_start: from_start, to_start: to_start};\r\n\t},\r\n\r\n\tget_endpoint: function (link, view, source, target) {\r\n\t\tvar config = view.$getConfig();\r\n\r\n\t\tvar lineType = this.get_line_type(link, config);\r\n\t\tvar from_start = lineType.from_start,\r\n\t\t\tto_start = lineType.to_start;\r\n\r\n\t\tvar from = getMilestonePosition(source, view, config),\r\n\t\t\tto = getMilestonePosition(target, view, config);\r\n\r\n\t\treturn {\r\n\t\t\tx: from_start ? from.left : (from.left + from.width),\r\n\t\t\te_x: to_start ? to.left : (to.left + to.width),\r\n\t\t\ty: from.top + (from.rowHeight/2) - 1,\r\n\t\t\te_y: to.top + (to.rowHeight/2) - 1\r\n\t\t};\r\n\t}\r\n};\r\n\r\nfunction getMilestonePosition(task, view, config){\r\n\tvar pos = view.getItemPosition(task);\r\n\r\n\t// GS-2270: Link to the split children shouldn't exceed the parent row height\r\n\tlet splitParams = getMaxParentHeight(gantt, view, task);\r\n\tlet maxHeight = splitParams.maxHeight;\r\n\r\n\tlet splitChild = splitParams.splitChild;\r\n\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\r\n\tconst baselines = baselinesOnDifferentRow && task.baselines && task.baselines.length;\r\n\r\n\tif (splitParams.shrinkHeight){\r\n\t\tpos.rowHeight = maxHeight;\r\n\t}\r\n\r\n\tlet milestoneWidth;\r\n\tlet milestoneTask = gantt.getTaskType(task.type) == config.types.milestone;\r\n\tif(milestoneTask){\r\n\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\r\n\t\tmilestoneWidth = Math.sqrt(2*milestoneHeight*milestoneHeight);\r\n\t\tif (splitParams.shrinkHeight && maxHeight < milestoneHeight){\r\n\t\t\tmilestoneHeight = maxHeight;\r\n\t\t\tmilestoneWidth = maxHeight;\r\n\t\t}\r\n\t\tpos.left -= milestoneWidth / 2;\r\n\t\tpos.width = milestoneWidth;\r\n\t} \r\n\tif (splitChild){\r\n\t\tif (maxHeight >= pos.height) {\r\n\t\t\tconst siblingBaselines = childrenHaveBaselines(gantt, task.parent);\r\n\t\t\tif (baselines || siblingBaselines){\r\n\t\t\t\tif (milestoneTask){\r\n\t\t\t\t\tpos.rowHeight = pos.height + 4;\r\n\t\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\r\n\t\t\t\t\tpos.width = pos.rowHeight - 3;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tpos.rowHeight = pos.height + 6;\r\n\t\t\t\t}\r\n\t\t\t} else if (milestoneTask) {\r\n\t\t\t\tpos.left += (milestoneWidth - pos.height) / 2;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tpos.rowHeight = maxHeight + 2;\r\n\t\t\tif (milestoneTask){\r\n\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\r\n\t\t\t\tpos.width = pos.rowHeight - 3;\r\n\t\t\t}\r\n\t\t}\r\n\t} else if (baselines){\r\n\t\tpos.rowHeight = pos.height + 4;\r\n\t}\r\n\r\n\treturn pos;\r\n}\r\n\r\n\r\nreturn {\r\n\trender: _render_link_element,\r\n\tupdate: null,\r\n\t//getRectangle: getLinkRectangle\r\n\tisInViewPort: isInViewPort,\r\n\tgetVisibleRange: getVisibleRange()\r\n};\r\n}\r\n\r\nexport default createLinkRender;","export default function(item, viewport, view, config, gantt){\r\n    // GS-2481 and GS-1715, don't remove selected task when using keyboard shortcuts and when the inline editor is opened\r\n    if(gantt.$ui.getView(\"grid\") && ((gantt.config.keyboard_navigation && gantt.getSelectedId()) || (gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id))) {\r\n\t\t//GS-2661: selected task might be collapsed\r\n\t\tif(!item.$expanded_branch) return false;\r\n\t\treturn true;\r\n\t}\r\n    var top = view.getItemTop(item.id);\r\n\tvar height = view.getItemHeight(item.id);\r\n\r\n\tif(top > viewport.y_end || top + height < viewport.y){\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn true;\r\n};","import * as helpers from \"../utils/helpers\";\r\n\r\nexport default function createResourceTimelineBuilder(gantt){\r\n\r\n\tlet resourceTaskCache = {};\r\n\r\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\r\n\t\tresourceTaskCache = {};\r\n\t});\r\n\r\n\tfunction getResourceLoad(resource, resourceProperty, scale, timeline){\r\n\t\tconst cacheKey = resource.id + \"_\" + resourceProperty  + \"_\" + scale.unit + \"_\" + scale.step;\r\n\t\tlet res;\r\n\t\tif (!resourceTaskCache[cacheKey]) {\r\n\t\t\tres = resourceTaskCache[cacheKey] = calculateResourceLoad(resource, resourceProperty, scale, timeline);\r\n\r\n\t\t} else {\r\n\t\t\tres = resourceTaskCache[cacheKey];\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n\r\n\tfunction calculateResourceLoadFromAssignments(items, scale, assignmentsPassed){\r\n\t\tconst scaleUnit = scale.unit;\r\n\t\tconst scaleStep = scale.step;\r\n\t\tconst timegrid = {};\r\n\r\n\t\tconst precalculatedTimes = {};\r\n\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\tconst item = items[i];\r\n\t\t\tlet task = item;\r\n\t\t\tif(assignmentsPassed){\r\n\t\t\t\ttask = gantt.getTask(item.task_id);\r\n\t\t\t}\r\n\t\t\tif (task.unscheduled){\r\n\t\t\t\tcontinue; // do not process assignments for unscheduled tasks\r\n\t\t\t}\r\n\t\t\tlet minDate = (item.start_date || task.start_date);\r\n\t\t\tlet maxDate = (item.end_date || task.end_date);\r\n\t\t\tif(assignmentsPassed){\r\n\t\t\t\tif(item.start_date){\r\n\t\t\t\t\tminDate = new Date(Math.max(item.start_date.valueOf(), task.start_date.valueOf()));\r\n\t\t\t\t}\r\n\t\t\t\tif(item.end_date){\r\n\t\t\t\t\tmaxDate = new Date(Math.min(item.end_date.valueOf(), task.end_date.valueOf()));\r\n\t\t\t\t}\r\n\t\t\t\t// GS-2063: handle case with fixedDates mode\r\n\t\t\t\tif(item.mode && item.mode == \"fixedDates\"){\r\n\t\t\t\t\tminDate = item.start_date;\r\n\t\t\t\t\tmaxDate = item.end_date;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlet firstColumn = helpers.findBinary(scale.trace_x, minDate.valueOf());\r\n\t\t\tlet minScaleDate = new Date(scale.trace_x[firstColumn] || gantt.date[scaleUnit + \"_start\"](new Date(minDate)));\r\n\t\t\t// GS-2307: need to take into account that task could start before the min scale date\r\n\t\t\t// so the task would be added to timegrid\r\n\t\t\tlet currDate = new Date(Math.min(minDate.valueOf(), minScaleDate.valueOf())); \r\n\r\n\t\t\tlet calendar = gantt.config.work_time ? gantt.getTaskCalendar(task) : gantt;\r\n\t\t\tprecalculatedTimes[calendar.id] = {};\r\n\t\t\twhile (currDate < maxDate) {\r\n\t\t\t\tconst cachedTimes = precalculatedTimes[calendar.id];\r\n\r\n\t\t\t\tlet date = currDate;\r\n\t\t\t\tconst timestamp = date.valueOf();\r\n\r\n\t\t\t\tcurrDate = gantt.date.add(currDate, scaleStep, scaleUnit);\r\n\r\n\t\t\t\tif(cachedTimes[timestamp] === false){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!timegrid[timestamp]){\r\n\t\t\t\t\ttimegrid[timestamp] = {tasks: [], assignments: []};\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttimegrid[timestamp].tasks.push(task);\r\n\t\t\t\tif(assignmentsPassed){\r\n\t\t\t\t\ttimegrid[timestamp].assignments.push(item);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn timegrid;\r\n\t}\r\n\r\n\tfunction calculateResourceLoad(resource, resourceProperty, scale, timeline) {\r\n\r\n\t\tlet items;\r\n\t\tlet assignmentsPassed = false;\r\n\t\tlet timegrid = {};\r\n\r\n\t\tif(gantt.config.process_resource_assignments && resourceProperty === gantt.config.resource_property){\r\n\t\t\tif(resource.$role == \"task\"){\r\n\t\t\t\titems = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\r\n\t\t\t}else{\r\n\t\t\t\titems = gantt.getResourceAssignments(resource.id);\r\n\t\t\t}\r\n\r\n\t\t\tassignmentsPassed = true;\r\n\t\t}else if(resource.$role == \"task\"){\r\n\t\t\titems = [];\r\n\t\t}else{\r\n\t\t\titems = gantt.getTaskBy(resourceProperty, resource.id);\r\n\t\t}\r\n\r\n\t\ttimegrid = calculateResourceLoadFromAssignments(items, scale, assignmentsPassed);\r\n\t\tconst scaleUnit = scale.unit;\r\n\t\tconst scaleStep = scale.step;\r\n\r\n\t\tconst timetable = [];\r\n\t\tlet start, end, tasks, assignments, cell;\r\n\t\tconst config = timeline.$getConfig();\r\n\r\n\t\tfor(let i = 0; i < scale.trace_x.length; i++){\r\n\t\t\tstart = new Date(scale.trace_x[i]);\r\n\t\t\tend = gantt.date.add(start, scaleStep, scaleUnit);\r\n\t\t\tcell = timegrid[start.valueOf()] || {};\r\n\t\t\ttasks = cell.tasks || [];\r\n\t\t\tassignments = cell.assignments || [];\r\n\t\t\tif(tasks.length || config.resource_render_empty_cells){\r\n\t\t\t\ttimetable.push({\r\n\t\t\t\t\tstart_date: start,\r\n\t\t\t\t\tend_date: end,\r\n\t\t\t\t\ttasks: tasks,\r\n\t\t\t\t\tassignments: assignments\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\ttimetable.push(null);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn timetable;\r\n\t}\r\n\r\n\r\n\r\n\treturn getResourceLoad;\r\n};","import * as domHelpers from \"../utils/dom_helpers\";\r\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\r\n\r\nfunction _init_dnd(gantt, grid) {\r\n\tvar DnD = gantt.$services.getService(\"dnd\");\r\n\r\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction locate(e){\r\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\r\n\t}\r\n\r\n\tfunction getStore(){\r\n\t\treturn gantt.getDatastore(grid.$config.bind);\r\n\t}\r\n\r\n\tfunction checkPlaceholderTask(id){\r\n\t\treturn isPlaceholderTask(id, gantt, getStore());\r\n\t}\r\n\r\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\r\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\r\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\r\n\r\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\r\n\t\tvar el = locate(e);\r\n\t\tif (!el) return false;\r\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\r\n\r\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\r\n\t\tif (checkPlaceholderTask(id)) return false;\r\n\r\n\t\tvar datastore = getStore();\r\n\r\n\t\tvar task = datastore.getItem(id);\r\n\r\n\t\tif (gantt.isReadonly(task))\r\n\t\t\treturn false;\r\n\r\n\t\tdnd.config.initial_open_state = task.$open;\r\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}, gantt));\r\n\r\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\r\n\t\tvar el = locate(e);\r\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\r\n\t\tvar element = dnd.config.marker.firstChild;\r\n\t\tif(element){\r\n\t\t\telement.style.position = \"static\";\r\n\t\t}\r\n\r\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\r\n\r\n\t\tvar store = getStore();\r\n\r\n\t\tvar task = store.getItem(dnd.config.id);\r\n\t\tdnd.config.index = store.getBranchIndex(dnd.config.id);\r\n\t\tdnd.config.parent = task.parent;\r\n\t\ttask.$open = false;\r\n\t\ttask.$transparent = true;\r\n\t\tthis.refreshData();\r\n\t}, gantt));\r\n\r\n\tdnd.lastTaskOfLevel = function (level) {\r\n\t\tvar last_item = null;\r\n\t\tvar store = getStore();\r\n\t\tvar tasks = store.getItems();\r\n\t\tfor (var i = 0, len = tasks.length; i < len; i++) {\r\n\t\t\tif (tasks[i].$level == level) {\r\n\t\t\t\tlast_item = tasks[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn last_item ? last_item.id : null;\r\n\t};\r\n\tdnd._getGridPos = gantt.bind(function (e) {\r\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\r\n\t\t// row offset\r\n\t\tvar x = pos.x + grid.$grid.scrollLeft;\r\n\t\tvar y = e.pos.y - 10;\r\n\r\n\t\tvar rowHeight = grid.getItemHeight(dnd.config.id);\r\n\t\t// prevent moving row out of grid_data container\r\n\t\tif (y < pos.y) y = pos.y;\r\n\t\tvar gridHeight = grid.getTotalHeight();\r\n\t\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\r\n\t\tconst maxBottom = pos.y + pos.height;\r\n\t\tif (y > maxBottom - rowHeight) {\r\n\t\t\ty = maxBottom - rowHeight;\r\n\t\t}\r\n\r\n\t\tpos.x = x;\r\n\t\tpos.y = y;\r\n\t\treturn pos;\r\n\t}, gantt);\r\n\tdnd._getTargetY = gantt.bind(function (e) {\r\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\r\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\r\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos;\r\n\r\n\t\tvar y = e.pageY - pos.y + scrollPos;\r\n\t\tif (y > maxBottom) {\r\n\t\t\ty = maxBottom;\r\n\t\t} else if (y < scrollPos) {\r\n\t\t\ty = scrollPos;\r\n\t\t}\r\n\t\treturn y;\r\n\t}, gantt);\r\n\tdnd._getTaskByY = gantt.bind(function (y, dropIndex) {\r\n\r\n\t\tvar store = getStore();\r\n\r\n\t\ty = y || 0;\r\n\r\n\t\tvar index = grid.getItemIndexByTopPosition(y);\r\n\t\tindex = dropIndex < index ? index - 1 : index;\r\n\r\n\t\tif (index > store.countVisible() - 1)\r\n\t\t\treturn null;\r\n\r\n\t\treturn store.getIdByIndex(index);\r\n\t}, gantt);\r\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\r\n\t\tvar gridDataSizes = gantt.$grid_data.getBoundingClientRect();\r\n\t\tvar maxBottom = gridDataSizes.height + gridDataSizes.y + (grid.$state.scrollTop || 0) + window.scrollY;\r\n\t\tvar dd = dnd.config;\r\n\t\tvar pos = dnd._getGridPos(e);\r\n\r\n\t\tgantt._waiAria.reorderMarkerAttr(dd.marker);\r\n\r\n\t\tvar config = grid.$getConfig(),\r\n\t\t\tstore = getStore();\r\n\r\n\t\t// setting position of row\r\n\t\tif (pos.y < maxBottom) {\r\n\t\t\tdd.marker.style.top = pos.y + \"px\";\r\n\t\t} else {\r\n\t\t\tdd.marker.style.top = maxBottom + \"px\";\r\n\t\t}\r\n\t\tdd.marker.style.left = pos.x + 10 + \"px\";\r\n\t\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\r\n\t\tif (pos.width > containerSize.width){\r\n\t\t\tdd.marker.style.width = containerSize.width - 10 - 2 + \"px\";\r\n\t\t\tdd.marker.style.overflow = \"hidden\";\t\r\n\t\t}\r\n\r\n\t\t// highlight row when mouseover\r\n\t\tvar item = store.getItem(dnd.config.id);\r\n\t\tvar targetY = dnd._getTargetY(e);\r\n\t\tvar el = dnd._getTaskByY(targetY, store.getIndexById(item.id));\r\n\r\n\t\tif (!store.exists(el)) {\r\n\t\t\tel = dnd.lastTaskOfLevel(config.order_branch_free ? item.$level : 0);\r\n\t\t\tif (el == dnd.config.id) {\r\n\t\t\t\tel = null;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction allowedLevel(next, item) {\r\n\t\t\treturn (!(store.isChildOf(over.id, item.id)) && (next.$level == item.$level || config.order_branch_free));\r\n\t\t}\r\n\r\n\t\tif (store.exists(el)) {\r\n\t\t\tvar over = store.getItem(el);\r\n\r\n\t\t\tvar itemTop = grid.getItemTop(over.id);\r\n\t\t\tvar itemHeight = grid.getItemHeight(over.id);\r\n\t\t\tif (itemTop + itemHeight / 2 < targetY) {\r\n\t\t\t\t//hovering over bottom part of item, check can be drop to bottom\r\n\t\t\t\tvar index = store.getIndexById(over.id);\r\n\t\t\t\tvar nextId = store.getNext(over.id);//adds +1 when hovering over placeholder\r\n\t\t\t\tvar next = store.getItem(nextId);\r\n\t\t\t\tif (checkPlaceholderTask(nextId)){\r\n\t\t\t\t\tvar prevId = store.getPrev(next.id);\r\n\t\t\t\t\tnext = store.getItem(prevId);\r\n\t\t\t\t}\r\n\t\t\t\tif (next) {\r\n\t\t\t\t\tif (next.id != item.id) {\r\n\t\t\t\t\t\tover = next; //there is a valid target\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif (config.order_branch_free) {\r\n\t\t\t\t\t\t\tif (!(store.isChildOf(item.id, over.id) && store.getChildren(over.id).length == 1))\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tstore.move(item.id, store.getBranchIndex(over.id) + 1, store.getParent(over.id));\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//we at end of the list, check and drop at the end of list\r\n\t\t\t\t\tnextId = store.getIdByIndex(index);\r\n\t\t\t\t\tnext = store.getItem(nextId);\r\n\r\n\t\t\t\t\tif (checkPlaceholderTask(nextId)){\r\n\t\t\t\t\t\tvar prevId = store.getPrev(next.id);\r\n\t\t\t\t\t\tnext = store.getItem(prevId);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (allowedLevel(next, item) && next.id != item.id) {\r\n\t\t\t\t\t\tstore.move(item.id, -1, store.getParent(next.id));\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (config.order_branch_free) {\r\n\t\t\t\tif (over.id != item.id && allowedLevel(over, item) && !checkPlaceholderTask(over.id)) {\r\n\t\t\t\t\tif (!store.hasChild(over.id)) {\r\n\t\t\t\t\t\tover.$open = true;\r\n\t\t\t\t\t\tstore.move(item.id, -1, over.id);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (store.getIndexById(over.id) || itemHeight / 3 < targetY) return;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//if item is on different level, check the one before it\r\n\t\t\tvar index = store.getIndexById(over.id),\r\n\t\t\t\tprevId = store.getIdByIndex(index - 1);\r\n\r\n\t\t\tvar prev = store.getItem(prevId);\r\n\r\n\t\t\tvar shift = 1;\r\n\t\t\twhile ((!prev || prev.id == over.id) && index - shift >= 0) {\r\n\r\n\t\t\t\tprevId = store.getIdByIndex(index - shift);\r\n\t\t\t\tprev = store.getItem(prevId);\r\n\t\t\t\tshift++;\r\n\t\t\t}\r\n\r\n\t\t\tif (item.id == over.id || checkPlaceholderTask(over.id)) return;\r\n\t\t\t//replacing item under cursor\r\n\t\t\tif (allowedLevel(over, item) && item.id != over.id) {\r\n\t\t\t\tstore.move(item.id, 0, 0, over.id);\r\n\r\n\t\t\t} else if (over.$level == item.$level - 1 && !store.getChildren(over.id).length) {\r\n\t\t\t\tstore.move(item.id, 0, over.id);\r\n\r\n\t\t\t} else if (prev && (allowedLevel(prev, item)) && (item.id != prev.id)) {\r\n\t\t\t\tstore.move(item.id, -1, store.getParent(prev.id));\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}, gantt));\r\n\r\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\r\n\t\tvar store = getStore();\r\n\t\tvar task = store.getItem(dnd.config.id);\r\n\t\ttask.$transparent = false;\r\n\t\ttask.$open = dnd.config.initial_open_state;\r\n\r\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, dnd.config.parent, dnd.config.index]) === false) {\r\n\t\t\tstore.move(dnd.config.id, dnd.config.index, dnd.config.parent);\r\n\t\t\ttask.$drop_target = null;\r\n\t\t} else {\r\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, task.$drop_target]);\r\n\t\t}\r\n\t\tgantt.render();\r\n\t\tthis.refreshData();\r\n\t}, gantt));\r\n}\r\n\r\nexport default {\r\n\tinit: _init_dnd\r\n};","/**\r\n * The state object for order branch drag and drop\r\n */\r\n\r\nimport * as utils from \"../../../../utils/utils\";\r\n\r\nexport default {\r\n\tcreateDropTargetObject: function createDropTargetObject(parent) {\r\n\t\tvar res = {\r\n\t\t\ttargetParent: null,\r\n\t\t\ttargetIndex: 0,\r\n\t\t\ttargetId: null,\r\n\t\t\tchild: false,\r\n\t\t\tnextSibling: false,\r\n\t\t\tprevSibling: false\r\n\t\t};\r\n\r\n\t\tif (parent) {\r\n\t\t\tutils.mixin(res, parent, true);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnextSiblingTarget: function nextSiblingTarget(dndTaskId, targetTaskId, store) {\r\n\t\tvar result = this.createDropTargetObject();\r\n\t\tresult.targetId = targetTaskId;\r\n\t\tresult.nextSibling = true;\r\n\t\tresult.targetParent = store.getParent(result.targetId);\r\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\r\n\t\tif(store.getParent(dndTaskId) != result.targetParent || result.targetIndex < store.getBranchIndex(dndTaskId)){\r\n\t\t\tresult.targetIndex += 1;\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\tprevSiblingTarget: function prevSiblingTarget(dndTaskId, targetTaskId, store) {\r\n\t\tvar result = this.createDropTargetObject();\r\n\t\tresult.targetId = targetTaskId;\r\n\t\tresult.prevSibling = true;\r\n\t\tresult.targetParent = store.getParent(result.targetId);\r\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\r\n\t\tif(store.getParent(dndTaskId) == result.targetParent && result.targetIndex > store.getBranchIndex(dndTaskId)){\r\n\t\t\tresult.targetIndex -= 1;\r\n\t\t}\r\n\t\treturn result;\r\n\t},\r\n\tfirstChildTarget: function firstChildTarget(dndTaskId, targetTaskId, store) {\r\n\t\tvar result = this.createDropTargetObject();\r\n\t\tresult.targetId = targetTaskId;\r\n\t\tresult.targetParent = result.targetId;\r\n\t\tresult.targetIndex = 0;\r\n\t\tresult.child = true;\r\n\t\treturn result;\r\n\t},\r\n\tlastChildTarget: function lastChildTarget(dndTaskId, targetTaskId, store) {\r\n\t\tvar children = store.getChildren(targetTaskId);\r\n\t\tvar result = this.createDropTargetObject();\r\n\t\tresult.targetId = children[children.length - 1];\r\n\t\tresult.targetParent = targetTaskId;\r\n\t\tresult.targetIndex = children.length;\r\n\t\tresult.nextSibling = true;\r\n\t\treturn result;\r\n\t}\r\n};","/**\r\n * resolve dnd position of the task when gantt.config.order_branch_free = false\r\n */\r\n\r\nimport dropTarget from \"./drop_target\";\r\n\r\nfunction getLast(store){\r\n\tvar current = store.getNext();\r\n\twhile(store.exists(current)){\r\n\r\n\t\tvar next = store.getNext(current);\r\n\t\tif(!store.exists(next)){\r\n\t\t\treturn current;\r\n\t\t}else{\r\n\t\t\tcurrent = next;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction findClosesTarget(dndTaskId, taskId, allowedLevel, store, up){\r\n\tvar prev = taskId;\r\n\twhile(store.exists(prev)){\r\n\t\tvar targetLevel = store.calculateItemLevel(store.getItem(prev));\r\n\t\tif((targetLevel === allowedLevel || targetLevel === (allowedLevel - 1)) && store.getBranchIndex(prev) > -1){\r\n\t\t\tbreak;\r\n\t\t}else {\r\n\t\t\tprev = up ? store.getPrev(prev) : store.getNext(prev);\r\n\t\t}\r\n\t}\r\n\r\n\tif(store.exists(prev)){\r\n\t\tif(store.calculateItemLevel(store.getItem(prev)) === allowedLevel){\r\n\t\t\treturn up ? dropTarget.nextSiblingTarget(dndTaskId, prev, store) : dropTarget.prevSiblingTarget(dndTaskId, prev, store);\r\n\t\t}else{\r\n\t\t\treturn dropTarget.firstChildTarget(dndTaskId, prev, store);\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction findTargetAbove(dndTaskId, taskId, allowedLevel, store){\r\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, true);\r\n}\r\nfunction findTargetBelow(dndTaskId, taskId, allowedLevel, store){\r\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, false);\r\n}\r\n\r\nexport default function getSameLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store, level){\r\n\tvar result;\r\n\tif(targetTaskId !== store.$getRootId()){\r\n\t\tvar targetTask = store.getItem(targetTaskId);\r\n\t\tvar targetLevel = store.calculateItemLevel(targetTask);\r\n\t\tif(targetLevel === level){\r\n\t\t\tvar prevSibling = store.getPrevSibling(targetTaskId);\r\n\t\t\tif(relTargetPos < 0.5 && !prevSibling){\r\n\t\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\r\n\t\t\t}else{\r\n\t\t\t\tif(relTargetPos < 0.5){\r\n\t\t\t\t\ttargetTaskId = prevSibling;\r\n\t\t\t\t}\r\n\t\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\r\n\t\t\t}\r\n\t\t}else if(targetLevel > level){\r\n\t\t\tstore.eachParent(function(parent){\r\n\t\t\t\tif(store.calculateItemLevel(parent) === level){\r\n\t\t\t\t\ttargetTaskId = parent.id;\r\n\t\t\t\t}\r\n\t\t\t}, targetTask); \r\n\t\t\tresult = findTargetAbove(dndTaskId, targetTaskId, level, store);\r\n\t\t}else{\r\n\t\t\tvar targetAbove = findTargetAbove(dndTaskId, targetTaskId, level, store);\r\n\t\t\tvar targetBelow = findTargetBelow(dndTaskId, targetTaskId, level, store);\r\n\t\t\tresult = (relTargetPos < 0.5) ? targetAbove : targetBelow;\r\n\t\t}\r\n\t}else{\r\n\t\tvar rootId = store.$getRootId();\r\n\t\tvar rootLevel = store.getChildren(rootId);\r\n\t\tresult = dropTarget.createDropTargetObject();\r\n\t\tif(rootLevel.length && eventTop >= 0){\r\n\t\t\tresult = findTargetAbove(dndTaskId, getLast(store), level, store);\r\n\t\t}else{\r\n\t\t\tresult = findTargetBelow(dndTaskId, rootId, level, store);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n};\r\n","import * as domHelpers from \"../../utils/dom_helpers\";\r\n\r\n/**\r\n * methods for highlighting current drag and drop position\r\n */\r\n\r\nfunction highlightPosition(target, root, grid){\r\n\tvar markerPos = getTaskMarkerPosition(target, grid);\r\n\t// setting position of row\r\n\troot.marker.style.left = markerPos.x + 9 + \"px\";\r\n\troot.marker.style.width = markerPos.width + \"px\";\r\n\troot.marker.style.overflow = \"hidden\";\r\n\tvar markerLine = root.markerLine;\r\n\tif(!markerLine){\r\n\t\tmarkerLine = document.createElement(\"div\");\r\n\t\tmarkerLine.className = \"gantt_drag_marker gantt_grid_dnd_marker\";\r\n\t\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\r\n\t\tmarkerLine.style.pointerEvents = \"none\";\r\n\t}\r\n\r\n\tif(target.child){\r\n\t\thighlightFolder(target, markerLine, grid);\r\n\t}else{\r\n\t\thighlightRow(target, markerLine, grid);\r\n\t}\r\n\r\n\tif(!root.markerLine){\r\n\t\tdocument.body.appendChild(markerLine);\r\n\t\troot.markerLine = markerLine;\r\n\t}\r\n}\r\n\r\nfunction removeLineHighlight(root){\r\n\tif(root.markerLine && root.markerLine.parentNode){\r\n\t\troot.markerLine.parentNode.removeChild(root.markerLine);\r\n\t}\r\n\troot.markerLine = null;\r\n}\r\n\r\nfunction highlightRow(target, markerLine, grid){\r\n\tvar linePos = getLineMarkerPosition(target, grid);\r\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\r\n\r\n\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\r\n\tmarkerLine.style.left = linePos.x + \"px\";\r\n\tmarkerLine.style.height = \"4px\";\r\n\r\n\tvar markerLineTop = linePos.y - 2;\r\n\tmarkerLine.style.top = markerLineTop + \"px\";\r\n\tmarkerLine.style.width = linePos.width + \"px\";\r\n\r\n\tif (markerLineTop > maxBottom) {\r\n\t\tmarkerLine.style.top = maxBottom + 'px';\r\n\t}\r\n\r\n\treturn markerLine;\r\n}\r\nfunction highlightFolder(target, markerFolder, grid){\r\n\tvar id = target.targetParent;\r\n\tvar pos = gridToPageCoordinates({x: 0, y: grid.getItemTop(id)}, grid);\r\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\r\n\r\n\tlet folderHighlightWidth = setWidthWithinContainer(grid.$gantt, grid.$grid_data.offsetWidth);\t\r\n\r\n\tmarkerFolder.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\";\r\n\tmarkerFolder.style.width = folderHighlightWidth + \"px\";\r\n\tmarkerFolder.style.top = pos.y + \"px\";\r\n\tmarkerFolder.style.left = pos.x  + \"px\";\r\n\tmarkerFolder.style.height = grid.getItemHeight(id) + \"px\";\r\n\tif (pos.y > maxBottom) {\r\n\t\tmarkerFolder.style.top = maxBottom + 'px';\r\n\t}\r\n\r\n\treturn markerFolder;\r\n}\r\n\r\nfunction getLineMarkerPosition(target, grid){\r\n\tvar store = grid.$config.rowStore;\r\n\tvar pos = {x:0, y:0};\r\n\tvar indentNode = grid.$grid_data.querySelector(\".gantt_tree_indent\");\r\n\tvar indent = 15;\r\n\tvar level = 0;\r\n\tif(indentNode){\r\n\t\tindent = indentNode.offsetWidth;\r\n\t}\r\n\tvar iconWidth = 40;\r\n\tif(target.targetId !== store.$getRootId()){\r\n\t\tvar itemTop = grid.getItemTop(target.targetId);\r\n\t\tvar itemHeight = grid.getItemHeight(target.targetId);\r\n\t\tlevel = store.exists(target.targetId) ? store.calculateItemLevel(store.getItem(target.targetId)) : 0;\r\n\r\n\t\tif(target.prevSibling){\r\n\t\t\tpos.y = itemTop;\r\n\t\t}else if(target.nextSibling){\r\n\t\t\tvar childCount = 0;\r\n\t\t\tstore.eachItem(function(child){\r\n\t\t\t\tif(store.getIndexById(child.id) !== -1)\r\n\t\t\t\t\tchildCount++;\r\n\t\t\t}, target.targetId);\r\n\r\n\t\t\tpos.y = itemTop + itemHeight + childCount*itemHeight;\r\n\t\t}else {\r\n\t\t\tpos.y = itemTop + itemHeight;\r\n\t\t\tlevel += 1;\r\n\t\t}\r\n\t}\r\n\tpos.x = iconWidth + level * indent;\r\n\tpos.width = setWidthWithinContainer(grid.$gantt, Math.max(grid.$grid_data.offsetWidth - pos.x, 0), pos.x);\r\n\treturn gridToPageCoordinates(pos, grid);\r\n}\r\n\r\nfunction gridToPageCoordinates(pos, grid){\r\n\tvar gridPos = domHelpers.getNodePosition(grid.$grid_data);\r\n\tpos.x += gridPos.x + grid.$grid.scrollLeft;\r\n\tpos.y += gridPos.y - grid.$grid_data.scrollTop;\r\n\treturn pos;\r\n}\r\n\r\nfunction getTaskMarkerPosition(e, grid) {\r\n\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\r\n\tvar ePos = domHelpers.getRelativeEventPosition(e, grid.$grid_data);\r\n\t// row offset\r\n\tvar x = pos.x + grid.$grid.scrollLeft;\r\n\tvar y = ePos.y - 10;\r\n\r\n\tvar rowHeight = grid.getItemHeight(e.targetId);\r\n\t// prevent moving row out of grid_data container\r\n\tif (y < pos.y) y = pos.y;\r\n\tvar gridHeight = grid.getTotalHeight();\r\n\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\r\n\r\n\tpos.x = x;\r\n\tpos.y = y;\r\n\tpos.width = setWidthWithinContainer(grid.$gantt, pos.width, 9);\r\n\treturn pos;\r\n}\r\n\r\nfunction setWidthWithinContainer(gantt, width, offset = 0){\r\n\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\r\n\tif (width > containerSize.width){\r\n\t\twidth = containerSize.width - offset - 2;\r\n\t}\r\n\treturn width;\r\n}\r\n\r\nexport default {\r\n\tremoveLineHighlight: removeLineHighlight,\r\n\thighlightPosition: highlightPosition\r\n};\r\n","import * as domHelpers from \"../utils/dom_helpers\";\r\nimport dropTarget from \"./tasks_grid_dnd_marker_helpers/drop_target\";\r\nimport getLockedLevelTarget from \"./tasks_grid_dnd_marker_helpers/locked_level\";\r\nimport getMultiLevelTarget from \"./tasks_grid_dnd_marker_helpers/multi_level\";\r\nimport higlighter from \"./tasks_grid_dnd_marker_helpers/highlight\";\r\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\r\n\r\nfunction _init_dnd(gantt, grid) {\r\n\tvar DnD = gantt.$services.getService(\"dnd\");\r\n\r\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction locate(e){\r\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\r\n\t}\r\n\r\n\tfunction getStore(){\r\n\t\treturn gantt.getDatastore(grid.$config.bind);\r\n\t}\r\n\r\n\tfunction checkPlaceholderTask(id){\r\n\t\treturn isPlaceholderTask(id, gantt, getStore());\r\n\t}\r\n\r\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\r\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\r\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\r\n\r\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\r\n\t\tvar el = locate(e);\r\n\t\tif (!el) return false;\r\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\r\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\r\n\t\tvar datastore = grid.$config.rowStore;\r\n\t\tvar task = datastore.getItem(id);\r\n\r\n\t\tif (gantt.isReadonly(task) || checkPlaceholderTask(id))\r\n\t\t\treturn false;\r\n\r\n\t\tdnd.config.initial_open_state = task.$open;\r\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}, gantt));\r\n\r\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\r\n\t\tvar el = locate(e);\r\n\r\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\r\n\t\tvar element = dnd.config.marker.firstChild;\r\n\t\tif(element){\r\n\t\t\tdnd.config.marker.style.opacity = 0.4;\r\n\t\t\telement.style.position = \"static\";\r\n\t\t\telement.style.pointerEvents = \"none\";\r\n\t\t}\r\n\r\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\r\n\r\n\t\tvar store = grid.$config.rowStore;\r\n\r\n\t\tvar task = store.getItem(dnd.config.id);\r\n\t\tdnd.config.level = store.calculateItemLevel(task);\r\n\t\tdnd.config.drop_target = dropTarget.createDropTargetObject({\r\n\t\t\ttargetParent: store.getParent(task.id),\r\n\t\t\ttargetIndex: store.getBranchIndex(task.id),\r\n\t\t\ttargetId: task.id,\r\n\t\t\tnextSibling: true\r\n\t\t});\r\n\r\n\t\ttask.$open = false;\r\n\t\ttask.$transparent = true;\r\n\t\tthis.refreshData();\r\n\t}, gantt));\r\n\r\n\tfunction getTargetTaskId(e){\r\n\t\tvar y = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\r\n\t\tvar store = grid.$config.rowStore;\r\n\r\n\t\tif (!document.doctype){\r\n\t\t\ty += window.scrollY;\r\n\t\t}\r\n\t\ty = y || 0;\r\n\r\n\t\t// limits for the marker according to the layout layer\r\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\r\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos + window.scrollY;\r\n\t\tvar minTop = scrollPos;\r\n\r\n\t\tvar firstVisibleTaskIndex = grid.getItemIndexByTopPosition(grid.$state.scrollTop);\r\n\t\tif (!store.exists(firstVisibleTaskIndex)){\r\n\t\t\tfirstVisibleTaskIndex = store.countVisible() - 1;\r\n\t\t}\r\n\t\tif (firstVisibleTaskIndex < 0) {\r\n\t\t\treturn store.$getRootId();\r\n\t\t}\r\n\r\n\t\tvar firstVisibleTaskId = store.getIdByIndex(firstVisibleTaskIndex);\r\n\r\n\t\tvar firstVisibleTaskPos = grid.$state.scrollTop / grid.getItemHeight(firstVisibleTaskId);\r\n\t\tvar hiddenTaskPart = firstVisibleTaskPos - Math.floor(firstVisibleTaskPos);\r\n\t\tif (hiddenTaskPart > 0.1 && hiddenTaskPart < 0.9) {\r\n\t\t\tmaxBottom = maxBottom - grid.getItemHeight(firstVisibleTaskId) * hiddenTaskPart;\r\n\t\t\tminTop = minTop + grid.getItemHeight(firstVisibleTaskId) * (1 - hiddenTaskPart);\r\n\t\t}\r\n\r\n\t\t// GS-715. The placeholder task row shouldn't be draggable below the Gantt container\r\n\t\tconst gridPosition = domHelpers.getNodePosition(grid.$grid_data);\r\n\t\tconst gridBottom = gridPosition.y + gridPosition.height;\r\n\t\tconst placeholderRowHeight = dnd.config.marker.offsetHeight;\r\n\t\tif (y + placeholderRowHeight + window.scrollY >= maxBottom){\r\n\t\t\tdnd.config.marker.style.top = gridBottom - placeholderRowHeight\t+ \"px\";\r\n\t\t}\r\n\r\n\t\tif (y >= maxBottom) {\r\n\t\t\ty = maxBottom;\r\n\t\t} else if (y <= minTop) {\r\n\t\t\ty = minTop;\r\n\t\t\tdnd.config.marker.style.top = gridPosition.y + \"px\";\r\n\t\t}\r\n\r\n\t\tvar index = grid.getItemIndexByTopPosition(y);\r\n\r\n\t\tif (index > store.countVisible() - 1 || index < 0) {\r\n\t\t\treturn store.$getRootId();\r\n\t\t}\r\n\r\n\t\tvar targetId = store.getIdByIndex(index);\r\n\t\tif (checkPlaceholderTask(targetId)) {\r\n\t\t\treturn store.getPrevSibling(targetId);\r\n\t\t}\r\n\r\n\t\treturn store.getIdByIndex(index);\r\n\t}\r\n\r\n\tfunction getDropPosition(e){\r\n\t\tvar targetTaskId = getTargetTaskId(e);\r\n\t\tvar relTargetPos = null;\r\n\t\tvar store = grid.$config.rowStore;\r\n\t\tvar config = grid.$getConfig();\r\n\t\tvar lockLevel = !config.order_branch_free;\r\n\r\n\t\tvar eventTop = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\r\n\t\tif (!document.doctype){\r\n\t\t\teventTop += window.scrollY;\r\n\t\t}\r\n\r\n\t\tif(targetTaskId !== store.$getRootId()) {\r\n\t\t\tvar rowTop = grid.getItemTop(targetTaskId);\r\n\t\t\tvar rowHeight = grid.getItemHeight(targetTaskId);\r\n\t\t\trelTargetPos = (eventTop - rowTop) / rowHeight;\r\n\t\t}\r\n\r\n\t\tvar result;\r\n\t\tif(!lockLevel){\r\n\t\t\tresult = getMultiLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store);\r\n\t\t}else{\r\n\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\r\n\t\t\tif(result && result.targetParent && checkPlaceholderTask(result.targetParent)){\r\n\t\t\t\ttargetTaskId = store.getPrevSibling(result.targetParent);\r\n\t\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\r\n\t\tvar target = getDropPosition(e);\r\n\r\n\t\tif(!target ||\r\n\t\t\tgantt.callEvent(\"onBeforeRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]) === false){\r\n\t\t\t\ttarget = dropTarget.createDropTargetObject(dnd.config.drop_target);\r\n\t\t\t}\r\n\r\n\t\thiglighter.highlightPosition(target, dnd.config, grid);\r\n\t\tdnd.config.drop_target = target;\r\n\t\tgantt._waiAria.reorderMarkerAttr(dnd.config.marker);\r\n\r\n\t\tthis.callEvent(\"onRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]);\r\n\t\treturn true;\r\n\t}, gantt));\r\n\r\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\r\n\t\tvar store = grid.$config.rowStore;\r\n\t\tvar task = store.getItem(dnd.config.id);\r\n\r\n\t\thiglighter.removeLineHighlight(dnd.config);\r\n\r\n\t\ttask.$transparent = false;\r\n\t\ttask.$open = dnd.config.initial_open_state;\r\n\t\tvar target = dnd.config.drop_target;\r\n\r\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]) === false) {\r\n\t\t\ttask.$drop_target = null;\r\n\t\t} else {\r\n\t\t\tstore.move(dnd.config.id, target.targetIndex, target.targetParent);\r\n\t\t\tgantt.render();\r\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]);\r\n\t\t}\r\n\t\tstore.refresh(task.id);\r\n\t}, gantt));\r\n}\r\n\r\nexport default {\r\n\tinit: _init_dnd\r\n};","/**\r\n * resolve dnd position of the task when gantt.config.order_branch_free = true\r\n */\r\n\r\nimport dropTarget from \"./drop_target\";\r\n\r\nexport default function getMultiLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store){\r\n\tvar result;\r\n\r\n\tif(targetTaskId !== store.$getRootId()){\r\n\t\tif(relTargetPos < 0.25){\r\n\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\r\n\t\t}else if(relTargetPos > 0.60 && !(store.hasChild(targetTaskId) && store.getItem(targetTaskId).$open)){\r\n\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\r\n\t\t}else {\r\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, targetTaskId, store);\r\n\t\t}\r\n\t}else{\r\n\t\tvar rootId = store.$getRootId();\r\n\t\tif(store.hasChild(rootId) && eventTop >= 0){\r\n\t\t\tresult = dropTarget.lastChildTarget(dndTaskId, rootId, store);\r\n\t\t}else{\r\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, rootId, store);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n};","import * as utils from \"../../../utils/utils\";\r\nimport rowDnd from \"./tasks_grid_dnd\";\r\nimport rowDndMarker from \"./tasks_grid_dnd_marker\";\r\nimport mouseEventContainer from \"../mouse_event_container\";\r\n\r\nvar initializer = (function(){\r\n\treturn function(gantt){\r\n\t\treturn {\r\n\t\t\tonCreated: function (grid) {\r\n\t\t\t\tgrid.$config = utils.mixin(grid.$config, {\r\n\t\t\t\t\tbind: \"task\"\r\n\t\t\t\t});\r\n\t\t\t\tif(grid.$config.id == \"grid\") {\r\n\t\t\t\t\tthis.extendGantt(grid);\r\n\t\t\t\t\tgantt.ext.inlineEditors = gantt.ext._inlineEditors.createEditors(grid);\r\n\t\t\t\t\tgantt.ext.inlineEditors.init();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._mouseDelegates = mouseEventContainer(gantt);\r\n\t\t\t},\r\n\t\t\tonInitialized: function (grid) {\r\n\t\t\t\tvar config = grid.$getConfig();\r\n\t\t\t\tif (config.order_branch) {\r\n\t\t\t\t\tif(config.order_branch == \"marker\"){\r\n\t\t\t\t\t\trowDndMarker.init(grid.$gantt, grid);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\trowDnd.init(grid.$gantt, grid);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.initEvents(grid, gantt);\r\n\t\t\t\tif(grid.$config.id == \"grid\") {\r\n\t\t\t\t\tthis.extendDom(grid);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonDestroyed: function (grid) {\r\n\t\t\t\tif(grid.$config.id == \"grid\") {\r\n\t\t\t\t\t// GS-1288. We need to only detach the store and its events without detaching the\r\n\t\t\t\t\t// inline editor's events. Otherwise, we won't be able to access them\r\n\t\t\t\t\tgantt.ext.inlineEditors.detachStore();\r\n\t\t\t\t}\r\n\t\t\t\tthis.clearEvents(grid, gantt);\r\n\t\t\t},\r\n\r\n\t\t\tinitEvents: function (grid, gantt) {\r\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\r\n\t\t\t\t\tconst config = grid.$getConfig();\r\n\t\t\t\t\tif (id !== null) {\r\n\t\t\t\t\t\tconst task = this.getTask(id);\r\n\t\t\t\t\t\tif (config.scroll_on_click) {\r\n\t\t\t\t\t\t\tconst notOpenIcon = !gantt._is_icon_open_click(e);\r\n\t\t\t\t\t\t\tconst visibleTimeline = gantt.$ui.getView(\"timeline\");\r\n\t\t\t\t\t\t\t// don't need to scroll to the date when the timeline is not visible\r\n\t\t\t\t\t\t\t// or when we click on the open/close icon\r\n\t\t\t\t\t\t\tif (notOpenIcon && visibleTimeline){\r\n\t\t\t\t\t\t\t\tthis.showDate(task.start_date);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgantt.callEvent(\"onTaskRowClick\", [id, trg]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, gantt), grid.$grid);\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", gantt.bind(function (e, id, trg) {\r\n\t\t\t\t\tvar column = trg.getAttribute(\"data-column-id\");\r\n\r\n\t\t\t\t\tif (!gantt.callEvent(\"onGridHeaderClick\", [column, e]))\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tvar config = grid.$getConfig();\r\n\r\n\t\t\t\t\tif (column == \"add\") {\r\n\t\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\r\n\t\t\t\t\t\tmouseEvents.callHandler(\"click\", \"gantt_add\", grid.$grid, [e, config.root_id]);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (config.sort && column) { // GS-929: if there is no column name, we cannot sort the column\r\n\t\t\t\t\t\tvar sorting_method = column,\r\n\t\t\t\t\t\t\tconf;\r\n\r\n\t\t\t\t\t\tfor (var i = 0; i < config.columns.length; i++) {\r\n\t\t\t\t\t\t\tif (config.columns[i].name == column) {\r\n\t\t\t\t\t\t\t\tconf = config.columns[i];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (conf && conf.sort !== undefined && conf.sort !== true) {\r\n\t\t\t\t\t\t\tsorting_method = conf.sort;\r\n\r\n\t\t\t\t\t\t\tif (!sorting_method) { // column sort property 'false', no sorting\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar sort = (this._sort && this._sort.direction && this._sort.name == column) ? this._sort.direction : \"desc\";\r\n\t\t\t\t\t\t// invert sort direction\r\n\t\t\t\t\t\tsort = (sort == \"desc\") ? \"asc\" : \"desc\";\r\n\t\t\t\t\t\tthis._sort = {\r\n\t\t\t\t\t\t\tname: column,\r\n\t\t\t\t\t\t\tdirection: sort\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis.sort(sorting_method, sort == \"desc\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}, gantt), grid.$grid);\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_add\", gantt.bind(function (e, id, trg) {\r\n\t\t\t\t\tvar config = grid.$getConfig();\r\n\t\t\t\t\tif (config.readonly) return;\r\n\r\n\t\t\t\t\tvar item = {};\r\n\t\t\t\t\tthis.createTask(item, id ? id : gantt.config.root_id);\r\n\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}, gantt), grid.$grid);\r\n\r\n\t\t\t},\r\n\r\n\t\t\tclearEvents: function(grid, gantt){\r\n\t\t\t\tthis._mouseDelegates.destructor();\r\n\t\t\t\tthis._mouseDelegates = null;\r\n\t\t\t},\r\n\r\n\t\t\textendDom: function(grid){\r\n\t\t\t\tgantt.$grid = grid.$grid;\r\n\t\t\t\tgantt.$grid_scale = grid.$grid_scale;\r\n\t\t\t\tgantt.$grid_data = grid.$grid_data;\r\n\t\t\t},\r\n\t\t\textendGantt: function(grid){\r\n\t\t\t\tgantt.getGridColumns = gantt.bind(grid.getGridColumns, grid);\r\n\r\n\t\t\t\tgrid.attachEvent(\"onColumnResizeStart\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeStart\", arguments);\r\n\t\t\t\t});\r\n\t\t\t\tgrid.attachEvent(\"onColumnResize\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResize\", arguments);\r\n\t\t\t\t});\r\n\t\t\t\tgrid.attachEvent(\"onColumnResizeEnd\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeEnd\", arguments);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tgrid.attachEvent(\"onColumnResizeComplete\", function(columns, totalWidth){\r\n\t\t\t\t\tgantt.config.grid_width = totalWidth;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResize\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResize\", arguments);\r\n\t\t\t\t});\r\n\t\t\t\tgrid.attachEvent(\"onRowResize\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onRowResize\", arguments);\r\n\t\t\t\t});\r\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResizeEnd\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResizeEnd\", arguments);\r\n\t\t\t\t});\r\n\t\t\t\tgrid.attachEvent(\"onAfterRowResize\", function(){\r\n\t\t\t\t\treturn gantt.callEvent(\"onAfterRowResize\", arguments);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n})();\r\n\r\nexport default initializer;","import * as domHelpers from \"../utils/dom_helpers\";\r\nimport * as utils from \"../../../utils/utils\";\r\nimport timeout from \"../../../utils/timeout\";\r\nimport * as helpers from \"../../../utils/helpers\";\r\n\r\nfunction createTaskDND(timeline, gantt) {\r\n\tvar services = gantt.$services;\r\n\treturn {\r\n\t\tdrag: null,\r\n\t\tdragMultiple: {},\r\n\t\t_events: {\r\n\t\t\tbefore_start: {},\r\n\t\t\tbefore_finish: {},\r\n\t\t\tafter_finish: {}\r\n\t\t},\r\n\t\t_handlers: {},\r\n\t\tinit: function() {\r\n\t\t\tthis._domEvents = gantt._createDomEventScope();\r\n\t\t\tthis.clear_drag_state();\r\n\t\t\tvar drag = gantt.config.drag_mode;\r\n\t\t\tthis.set_actions();\r\n\r\n\t\t\tvar stateService = services.getService(\"state\");\r\n\t\t\tstateService.registerProvider(\"tasksDnd\", utils.bind(function() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdrag_id : this.drag ? this.drag.id : undefined,\r\n\t\t\t\t\tdrag_mode : this.drag ? this.drag.mode : undefined,\r\n\t\t\t\t\tdrag_from_start : this.drag ? this.drag.left : undefined\r\n\t\t\t\t};\r\n\t\t\t}, this));\r\n\r\n\t\t\tvar evs = {\r\n\t\t\t\t\"before_start\": \"onBeforeTaskDrag\",\r\n\t\t\t\t\"before_finish\": \"onBeforeTaskChanged\",\r\n\t\t\t\t\"after_finish\": \"onAfterTaskDrag\"\r\n\t\t\t};\r\n\t\t\t//for now, all drag operations will trigger the same events\r\n\t\t\tfor (var stage in this._events) {\r\n\t\t\t\tfor (var mode in drag) {\r\n\t\t\t\t\tthis._events[stage][mode] = evs[stage];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._handlers[drag.move] = this._move;\r\n\t\t\tthis._handlers[drag.resize] = this._resize;\r\n\t\t\tthis._handlers[drag.progress] = this._resize_progress;\r\n\t\t},\r\n\t\tset_actions: function() {\r\n\t\t\tvar data = timeline.$task_data;\r\n\t\t\tthis._domEvents.attach(data, \"mousemove\", gantt.bind(function(e) {\r\n\t\t\t\tthis.on_mouse_move(e);\r\n\t\t\t}, this));\r\n\t\t\tthis._domEvents.attach(data, \"mousedown\", gantt.bind(function(e) {\r\n\t\t\t\tthis.on_mouse_down(e);\r\n\t\t\t}, this));\r\n\t\t\tthis._domEvents.attach(document.body, \"mouseup\", gantt.bind(function(e) {\r\n\t\t\t\tthis.on_mouse_up(e);\r\n\t\t\t}, this));\r\n\t\t},\r\n\r\n\t\tclear_drag_state: function() {\r\n\t\t\tthis.drag = {\r\n\t\t\t\tid: null,\r\n\t\t\t\tmode: null,\r\n\t\t\t\tpos: null,\r\n\t\t\t\tstart_x: null,\r\n\t\t\t\tstart_y: null,\r\n\t\t\t\tobj: null,\r\n\t\t\t\tleft: null\r\n\t\t\t};\r\n\t\t\tthis.dragMultiple = {};\r\n\t\t},\r\n\t\t_resize: function(task, shift, drag) {\r\n\t\t\tvar cfg = timeline.$getConfig();\r\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\r\n\t\t\tif (drag.left) {\r\n\t\t\t\ttask.start_date = gantt.dateFromPos(coords_x.start + shift);\r\n\t\t\t\tif (!task.start_date) {\r\n\t\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttask.end_date = gantt.dateFromPos(coords_x.end + shift);\r\n\t\t\t\tif (!task.end_date) {\r\n\t\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar minDurationInUnits = this._calculateMinDuration(cfg.min_duration, cfg.duration_unit);\r\n\t\t\tif (task.end_date - task.start_date < cfg.min_duration) {\r\n\t\t\t\tif (drag.left)\r\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate(task.end_date, -minDurationInUnits, cfg.duration_unit, task);\r\n\t\t\t\telse\r\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate(task.start_date, minDurationInUnits, cfg.duration_unit, task);\r\n\t\t\t}\r\n\t\t\tgantt._init_task_timing(task);\r\n\t\t},\r\n\t\t_calculateMinDuration: function(duration, unit) {\r\n\t\t\tvar inMs = {\r\n\t\t\t\t\"minute\": 60000,\r\n\t\t\t\t\"hour\": 3600000,\r\n\t\t\t\t\"day\": 86400000,\r\n\t\t\t\t\"week\": 604800000,\r\n\t\t\t\t\"month\": 2419200000,\r\n\t\t\t\t\"year\": 31356000000\r\n\t\t\t};\r\n\t\t\treturn Math.ceil(duration / inMs[unit]);\r\n\t\t},\r\n\t\t_resize_progress: function(task, shift, drag) {\r\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\r\n\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tvar diffValue = !config.rtl ? (drag.pos.x - coords_x.start) : (coords_x.start - drag.pos.x);\r\n\r\n\t\t\tvar diff = Math.max(0, diffValue);\r\n\t\t\ttask.progress = Math.min(1, diff / Math.abs(coords_x.end - coords_x.start));\r\n\t\t},\r\n\t\t_find_max_shift: function(dragItems, shift) {\r\n\t\t\tvar correctShift;\r\n\t\t\tfor (var i in dragItems) {\r\n\t\t\t\tvar drag = dragItems[i];\r\n\t\t\t\tvar task = gantt.getTask(drag.id);\r\n\t\t\t\tif (task.unscheduled){\r\n\t\t\t\t\t// GS-1674. There is no need to check the tasks that are ignored by projects\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar coords_x = this._drag_task_coords(task, drag);\r\n\t\t\t\tvar minX = gantt.posFromDate(new Date(gantt.getState().min_date));\r\n\t\t\t\tvar maxX = gantt.posFromDate(new Date(gantt.getState().max_date));\r\n\r\n\t\t\t\tif (coords_x.end + shift > maxX) {\r\n\t\t\t\t\tvar maxShift = maxX - coords_x.end;\r\n\t\t\t\t\tif (maxShift < correctShift || correctShift === undefined) {\r\n\t\t\t\t\t\tcorrectShift = maxShift;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (coords_x.start + shift < minX) {\r\n\t\t\t\t\tvar minShift = minX - coords_x.start;\r\n\t\t\t\t\tif (minShift > correctShift || correctShift === undefined) {\r\n\t\t\t\t\t\tcorrectShift = minShift;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn correctShift;\r\n\t\t},\r\n\t\t_move: function(task, shift, drag, multipleDragShift) {\r\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\r\n\t\t\tvar new_start = null,\r\n\t\t\tnew_end = null;\r\n\t\t\t// GS-454: If we drag multiple tasks, rely on the dates instead of timeline coordinates\r\n\t\t\tif (multipleDragShift){\r\n\t\t\t\tnew_start = new Date(+drag.obj.start_date + multipleDragShift),\r\n\t\t\t\tnew_end = new Date(+drag.obj.end_date + multipleDragShift);\r\n\t\t\t} else {\r\n\t\t\t\tnew_start = gantt.dateFromPos(coords_x.start + shift),\r\n\t\t\t\tnew_end = gantt.dateFromPos(coords_x.end + shift);\r\n\t\t\t}\r\n\t\t\tif (!new_start) {\r\n\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\r\n\t\t\t\ttask.end_date = gantt.dateFromPos(gantt.posFromDate(task.start_date) + (coords_x.end - coords_x.start));\r\n\t\t\t} else if (!new_end) {\r\n\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\r\n\t\t\t\ttask.start_date = gantt.dateFromPos(gantt.posFromDate(task.end_date) - (coords_x.end - coords_x.start));\r\n\t\t\t} else {\r\n\t\t\t\ttask.start_date = new_start;\r\n\t\t\t\ttask.end_date = new_end;\r\n\t\t\t}\r\n\t\t},\r\n\t\t_drag_task_coords: function(t, drag) {\r\n\t\t\tvar start = drag.obj_s_x = drag.obj_s_x || gantt.posFromDate(t.start_date);\r\n\t\t\tvar end = drag.obj_e_x = drag.obj_e_x || gantt.posFromDate(t.end_date);\r\n\t\t\treturn {\r\n\t\t\t\tstart: start,\r\n\t\t\t\tend: end\r\n\t\t\t};\r\n\t\t},\r\n\t\t_mouse_position_change: function(oldPos, newPos) {\r\n\t\t\tvar dx = oldPos.x - newPos.x,\r\n\t\t\t\tdy = oldPos.y - newPos.y;\r\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\r\n\t\t},\r\n\t\t_is_number: function(n) {\r\n\t\t\treturn !isNaN(parseFloat(n)) && isFinite(n);\r\n\t\t},\r\n\r\n\t\ton_mouse_move: function(e) {\r\n\t\t\tif (this.drag.start_drag) {\r\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\r\n\r\n\t\t\t\tvar sX = this.drag.start_drag.start_x,\r\n\t\t\t\t\tsY = this.drag.start_drag.start_y;\r\n\r\n\t\t\t\tif ((Date.now() - this.drag.timestamp > 50) ||\r\n\t\t\t\t\t(this._is_number(sX) && this._is_number(sY) && this._mouse_position_change({\r\n\t\t\t\t\t\tx: sX,\r\n\t\t\t\t\t\ty: sY\r\n\t\t\t\t\t}, pos) > 20)) {\r\n\t\t\t\t\tthis._start_dnd(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar drag = this.drag;\r\n\r\n\t\t\tif (drag.mode) {\r\n\t\t\t\tif (!timeout(this, 40))//limit update frequency\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tthis._update_on_move(e);\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_update_item_on_move: function(shift, id, mode, drag, e, multipleDragShift) {\r\n\t\t\tvar task = gantt.getTask(id);\r\n\t\t\tvar original = gantt.mixin({}, task);\r\n\t\t\tvar copy = gantt.mixin({}, task);\r\n\t\t\tthis._handlers[mode].apply(this, [copy, shift, drag, multipleDragShift]);\r\n\t\t\tgantt.mixin(task, copy, true);\r\n\t\t\t//gantt._update_parents(drag.id, true);\r\n\t\t\tgantt.callEvent(\"onTaskDrag\", [task.id, mode, copy, original, e]);\r\n\t\t\tgantt.mixin(task, copy, true);\r\n\t\t\tgantt.refreshTask(id);\r\n\t\t},\r\n\r\n\t\t_update_on_move: function(e) {\r\n\t\t\tvar drag = this.drag;\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tif (drag.mode) {\r\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\r\n\t\t\t\tif (drag.pos && drag.pos.x == pos.x)\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tdrag.pos = pos;\r\n\r\n\t\t\t\tvar curr_date = gantt.dateFromPos(pos.x);\r\n\t\t\t\tif (!curr_date || isNaN(curr_date.getTime()))\r\n\t\t\t\t\treturn;\r\n\r\n\r\n\t\t\t\tvar shift = pos.x - drag.start_x;\r\n\t\t\t\tvar task = gantt.getTask(drag.id);\r\n\t\t\t\tif (this._handlers[drag.mode]) {\r\n\t\t\t\t\tif (drag.mode === config.drag_mode.move) {\r\n\t\t\t\t\t\tvar dragHash = {};\r\n\r\n\t\t\t\t\t\tif (this._isMultiselect()) {\r\n\t\t\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\r\n\t\t\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\r\n\t\t\t\t\t\t\t\tdragHash = this.dragMultiple;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar dragProject = false;\r\n\t\t\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\r\n\t\t\t\t\t\t\tvar initialDrag = {};\r\n\t\t\t\t\t\t\tinitialDrag[drag.id] = utils.copy(drag);\r\n\t\t\t\t\t\t\tdragProject = true;\r\n\t\t\t\t\t\t\tdragHash = utils.mixin(initialDrag, this.dragMultiple);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tvar maxShift = this._find_max_shift(dragHash, shift);\r\n\t\t\t\t\t\tif (maxShift !== undefined) {\r\n\t\t\t\t\t\t\tshift = maxShift;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\r\n\r\n\t\t\t\t\t\tlet multipleDragShift;\r\n\t\t\t\t\t\tif (maxShift === undefined) {\r\n\t\t\t\t\t\t\t// GS-2593. If the timeline is repainted during the drag (infinite scale scenario)\r\n\t\t\t\t\t\t\t// we need to update the initial drag position to correctly update\r\n\t\t\t\t\t\t\t// the position of other dragged tasks\r\n\t\t\t\t\t\t\tconst newStartPos = gantt.posFromDate(drag.obj.start_date);\r\n\t\t\t\t\t\t\tconst newEndPos = gantt.posFromDate(drag.obj.end_date);\r\n\t\t\t\t\t\t\t// calculate the offset only when the drag started\r\n\t\t\t\t\t\t\tif (drag.handle_offset === undefined){\r\n\t\t\t\t\t\t\t\tconst width = newEndPos - newStartPos;\r\n\t\t\t\t\t\t\t\tconst dragPos = drag.start_x - newStartPos;\r\n\t\t\t\t\t\t\t\tdrag.handle_offset = dragPos / width;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst newWidth = Math.abs(newEndPos - newStartPos);\r\n\t\t\t\t\t\t\tlet dragX = newStartPos + newWidth * drag.handle_offset;\r\n\r\n\t\t\t\t\t\t\t// GS-454: Calculate the date shift in milliseconds instead of pixels\r\n\t\t\t\t\t\t\tconst shiftDate = gantt.dateFromPos(dragX);\r\n\t\t\t\t\t\t\tmultipleDragShift = curr_date - shiftDate;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor (var i in dragHash) {\r\n\t\t\t\t\t\t\tvar childDrag = dragHash[i];\r\n\t\t\t\t\t\t\tif(dragProject && childDrag.id != drag.id){\r\n\t\t\t\t\t\t\t\tgantt._bulk_dnd = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis._update_item_on_move(shift, childDrag.id, childDrag.mode, childDrag, e, multipleDragShift);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgantt._bulk_dnd = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// for resize and progress\r\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgantt._update_parents(drag.id);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ton_mouse_down: function(e, src) {\r\n\t\t\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\r\n\t\t\t// let's ignore right mouse button then\r\n\t\t\tif (e.button == 2 && e.button !== undefined)\r\n\t\t\t\treturn;\r\n\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tvar id = gantt.locate(e);\r\n\t\t\tvar task = null;\r\n\t\t\tif (gantt.isTaskExists(id)) {\r\n\t\t\t\ttask = gantt.getTask(id);\r\n\t\t\t}\r\n\r\n\t\t\tif (gantt.isReadonly(task) || this.drag.mode) return;\r\n\r\n\t\t\tthis.clear_drag_state();\r\n\r\n\t\t\tsrc = src || (e.target || e.srcElement);\r\n\r\n\t\t\tvar className = domHelpers.getClassName(src);\r\n\t\t\tvar drag = this._get_drag_mode(className, src);\r\n\r\n\t\t\tif (!className || !drag) {\r\n\t\t\t\tif (src.parentNode)\r\n\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\r\n\t\t\t\telse\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!drag) {\r\n\t\t\t\tif (gantt.checkEvent(\"onMouseDown\") && gantt.callEvent(\"onMouseDown\", [className.split(\" \")[0]])) {\r\n\t\t\t\t\tif (src.parentNode)\r\n\t\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\r\n\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (drag.mode && drag.mode != config.drag_mode.ignore && config[\"drag_\" + drag.mode]) {\r\n\t\t\t\t\tid = gantt.locate(src);\r\n\t\t\t\t\ttask = gantt.copy(gantt.getTask(id) || {});\r\n\r\n\t\t\t\t\tif (gantt.isReadonly(task)) {\r\n\t\t\t\t\t\tthis.clear_drag_state();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && !(task.auto_scheduling === false) && !config.drag_project) && drag.mode != config.drag_mode.progress) {//only progress drag is allowed for tasks with flexible duration\r\n\t\t\t\t\t\tthis.clear_drag_state();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdrag.id = id;\r\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\r\n\r\n\t\t\t\t\tdrag.start_x = pos.x;\r\n\t\t\t\t\tdrag.start_y = pos.y;\r\n\t\t\t\t\tdrag.obj = task;\r\n\t\t\t\t\tthis.drag.start_drag = drag;\r\n\t\t\t\t\tthis.drag.timestamp = Date.now();\r\n\r\n\t\t\t\t} else\r\n\t\t\t\t\tthis.clear_drag_state();\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fix_dnd_scale_time: function(task, drag) {\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tvar unit = gantt.getScale().unit,\r\n\t\t\t\tstep = gantt.getScale().step;\r\n\t\t\tif (!config.round_dnd_dates) {\r\n\t\t\t\tunit = 'minute';\r\n\t\t\t\tstep = config.time_step;\r\n\t\t\t}\r\n\r\n\t\t\tfunction fixStart(task) {\r\n\t\t\t\tif (!gantt.config.correct_work_time)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tvar config = timeline.$getConfig();\r\n\t\t\t\tif (!gantt.isWorkTime(task.start_date, undefined, task))\r\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate({\r\n\t\t\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\t\t\tduration: -1,\r\n\t\t\t\t\t\tunit: config.duration_unit,\r\n\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tfunction fixEnd(task) {\r\n\t\t\t\tif (!gantt.config.correct_work_time)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tvar config = timeline.$getConfig();\r\n\t\t\t\tif (!gantt.isWorkTime(new Date(task.end_date - 1), undefined, task))\r\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate({\r\n\t\t\t\t\t\tstart_date: task.end_date,\r\n\t\t\t\t\t\tduration: 1,\r\n\t\t\t\t\t\tunit: config.duration_unit,\r\n\t\t\t\t\t\ttask: task\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (drag.mode == config.drag_mode.resize) {\r\n\t\t\t\tif (drag.left) {\r\n\t\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\r\n\t\t\t\t\tfixStart(task);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttask.end_date = gantt.roundDate({date: task.end_date, unit: unit, step: step});\r\n\t\t\t\t\tfixEnd(task);\r\n\t\t\t\t}\r\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\r\n\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\r\n\t\t\t\tfixStart(task);\r\n\t\t\t\ttask.end_date = gantt.calculateEndDate(task);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_fix_working_times: function(task, drag) {\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tvar drag = drag || {mode: config.drag_mode.move};\r\n\r\n\t\t\tif (drag.mode == config.drag_mode.resize) {\r\n\t\t\t\tif (drag.left) {\r\n\t\t\t\t\ttask.start_date = gantt.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttask.end_date = gantt.getClosestWorkTime({date: task.end_date, dir: 'past', task: task});\r\n\t\t\t\t}\r\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\r\n\t\t\t\tgantt.correctTaskWorkTime(task);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_finalize_mouse_up: function(taskId, config, drag, e) {\r\n\t\t\tvar task = gantt.getTask(taskId);\r\n\r\n\t\t\tif (config.work_time && config.correct_work_time) {\r\n\t\t\t\tthis._fix_working_times(task, drag);\r\n\t\t\t}\r\n\r\n\t\t\tthis._fix_dnd_scale_time(task, drag);\r\n\r\n\t\t\tif (!this._fireEvent(\"before_finish\", drag.mode, [taskId, drag.mode, gantt.copy(drag.obj), e])) {\r\n\t\t\t\t//drag.obj._dhx_changed = false;\r\n\t\t\t\tthis.clear_drag_state();\r\n\t\t\t\tif (taskId == drag.id) {\r\n\t\t\t\t\tdrag.obj._dhx_changed = false;\r\n\t\t\t\t\tgantt.mixin(task, drag.obj, true);\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tgantt.refreshTask(task.id);\r\n\t\t\t\t// GS-2013. Repaint parent projects when the drag is cancelled\r\n\t\t\t\tif (task.$level > 100){\r\n\t\t\t\t\t// When there are too many tasks to repaint, it is better to repaint Gantt\r\n\t\t\t\t\tlet shouldRepaint = false;\r\n\t\t\t\t\tgantt.eachParent(function(parent){\r\n\t\t\t\t\t\tif (!shouldRepaint && parent.type === gantt.config.types.project) {\r\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\r\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\r\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\r\n\t\t\t\t\t\t\t\tshouldRepaint = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},task.id);\r\n\t\t\t\t\tif (shouldRepaint){\r\n\t\t\t\t\t\tgantt.refreshData();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// If there are not so many parents especially if there are split tasks,\r\n\t\t\t\t\t// it is better to repaint individual tasks\r\n\t\t\t\t\tgantt.eachParent(function(parent){\r\n\t\t\t\t\t\tif (parent.type === gantt.config.types.project) {\r\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\r\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\r\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\r\n\t\t\t\t\t\t\t\tgantt.refreshTask(parent.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},task.id);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar drag_id = taskId;\r\n\r\n\t\t\t\tgantt._init_task_timing(task);\r\n\r\n\t\t\t\tthis.clear_drag_state();\r\n\t\t\t\tgantt.updateTask(task.id);\r\n\t\t\t\tthis._fireEvent(\"after_finish\", drag.mode, [drag_id, drag.mode, e]);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\ton_mouse_up: function(e) {\r\n\r\n\t\t\tvar drag = this.drag;\r\n\t\t\tif (drag.mode && drag.id) {\r\n\t\t\t\tvar config = timeline.$getConfig();\r\n\t\t\t\t//drop\r\n\t\t\t\tvar task = gantt.getTask(drag.id);\r\n\t\t\t\tvar dragMultiple = this.dragMultiple;\r\n\r\n\t\t\t\tvar finalizingBulkMove = false;\r\n\t\t\t\tvar moveCount = 0;\r\n\t\t\t\tif (drag.mode === config.drag_mode.move) {\r\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && config.drag_project) || (this._isMultiselect())) {\r\n\t\t\t\t\t\tfinalizingBulkMove = true;\r\n\t\t\t\t\t\tmoveCount = Object.keys(dragMultiple).length;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar doFinalize = function doFinalize(){\r\n\t\t\t\t\tif(finalizingBulkMove){\r\n\t\t\t\t\t\tfor (var i in dragMultiple) {\r\n\t\t\t\t\t\t\t// GS-1057: Don't call drag events for the dragged task as they will be called later\r\n\t\t\t\t\t\t\tif (dragMultiple[i].id != drag.id){\r\n\t\t\t\t\t\t\t\tthis._finalize_mouse_up(dragMultiple[i].id, config, dragMultiple[i], e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis._finalize_mouse_up(drag.id, config, drag, e);\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif(finalizingBulkMove && moveCount > 10){// 10 - arbitrary threshold for bulk dnd at which we start doing complete repaint to refresh\r\n\t\t\t\t\tgantt.batchUpdate(function(){\r\n\t\t\t\t\t\tdoFinalize.call(this);\r\n\t\t\t\t\t}.bind(this));\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdoFinalize.call(this);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.clear_drag_state();\r\n\t\t},\r\n\t\t_get_drag_mode: function(className, el) {\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tvar modes = config.drag_mode;\r\n\t\t\tvar classes = (className || \"\").split(\" \");\r\n\t\t\tvar classname = classes[0];\r\n\t\t\tvar drag = {mode: null, left: null};\r\n\t\t\tswitch (classname) {\r\n\t\t\t\tcase \"gantt_task_line\":\r\n\t\t\t\tcase \"gantt_task_content\":\r\n\t\t\t\t\tdrag.mode = modes.move;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"gantt_task_drag\":\r\n\t\t\t\t\tdrag.mode = modes.resize;\r\n\r\n\t\t\t\t\tvar dragProperty = el.getAttribute(\"data-bind-property\");\r\n\r\n\t\t\t\t\tif (dragProperty == \"start_date\") {\r\n\t\t\t\t\t\tdrag.left = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdrag.left = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"gantt_task_progress_drag\":\r\n\t\t\t\t\tdrag.mode = modes.progress;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"gantt_link_control\":\r\n\t\t\t\tcase \"gantt_link_point\":\r\n\t\t\t\t\tdrag.mode = modes.ignore;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tdrag = null;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\treturn drag;\r\n\r\n\t\t},\r\n\r\n\t\t_start_dnd: function(e) {\r\n\t\t\tvar drag = this.drag = this.drag.start_drag;\r\n\t\t\tdelete drag.start_drag;\r\n\r\n\t\t\tvar cfg = timeline.$getConfig();\r\n\t\t\tvar id = drag.id;\r\n\r\n\t\t\tif (!cfg[\"drag_\" + drag.mode] || !gantt.callEvent(\"onBeforeDrag\", [id, drag.mode, e]) || !this._fireEvent(\"before_start\", drag.mode, [id, drag.mode, e])) {\r\n\t\t\t\tthis.clear_drag_state();\r\n\t\t\t} else {\r\n\t\t\t\tdelete drag.start_drag;\r\n\t\t\t\tvar task = gantt.getTask(id);\r\n\t\t\t\tif (gantt.isReadonly(task)){\r\n\t\t\t\t\tthis.clear_drag_state();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (this._isMultiselect()) {\r\n\t\t\t\t\t// for don't move selected tasks when drag unselected task\r\n\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\r\n\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\r\n\t\t\t\t\t\thelpers.forEach(selectedTasksIds, gantt.bind(function(taskId) {\r\n\t\t\t\t\t\t\tvar selectedTask = gantt.getTask(taskId);\r\n\t\t\t\t\t\t\tif (gantt.isSummaryTask(selectedTask) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\r\n\t\t\t\t\t\t\t\tthis._addSubtasksToDragMultiple(selectedTask.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tthis.dragMultiple[taskId] = gantt.mixin({\r\n\t\t\t\t\t\t\t\tid: selectedTask.id,\r\n\t\t\t\t\t\t\t\tobj: gantt.copy(selectedTask)\r\n\t\t\t\t\t\t\t}, this.drag);\r\n\t\t\t\t\t\t}, this));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// for move unselected summary\r\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\r\n\t\t\t\t\tthis._addSubtasksToDragMultiple(task.id);\r\n\t\t\t\t}\r\n\t\t\t\tgantt.callEvent(\"onTaskDragStart\", []);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\t_fireEvent: function(stage, mode, params) {\r\n\t\t\tgantt.assert(this._events[stage], \"Invalid stage:{\" + stage + \"}\");\r\n\r\n\t\t\tvar trigger = this._events[stage][mode];\r\n\r\n\t\t\tgantt.assert(trigger, \"Unknown after drop mode:{\" + mode + \"}\");\r\n\t\t\tgantt.assert(params, \"Invalid event arguments\");\r\n\r\n\r\n\t\t\tif (!gantt.checkEvent(trigger))\r\n\t\t\t\treturn true;\r\n\r\n\t\t\treturn gantt.callEvent(trigger, params);\r\n\t\t},\r\n\r\n\t\tround_task_dates: function(task) {\r\n\t\t\tvar drag_state = this.drag;\r\n\t\t\tvar config = timeline.$getConfig();\r\n\t\t\tif (!drag_state) {\r\n\t\t\t\tdrag_state = {mode: config.drag_mode.move};\r\n\t\t\t}\r\n\t\t\tthis._fix_dnd_scale_time(task, drag_state);\r\n\t\t},\r\n\t\tdestructor: function() {\r\n\t\t\tthis._domEvents.detachAll();\r\n\t\t},\r\n\t\t_isMultiselect: function() {\r\n\t\t\treturn gantt.config.drag_multiple && !!(gantt.getSelectedTasks && gantt.getSelectedTasks().length > 0);\r\n\t\t},\r\n\t\t_addSubtasksToDragMultiple: function(summaryId) {\r\n\t\t\tgantt.eachTask(function(child) {\r\n\t\t\t\tthis.dragMultiple[child.id] = gantt.mixin({\r\n\t\t\t\t\tid: child.id,\r\n\t\t\t\t\tobj: gantt.copy(child)\r\n\t\t\t\t}, this.drag);\r\n\t\t\t}, summaryId, this);\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction initTaskDND() {\r\n\tvar _tasks_dnd;\r\n\treturn {\r\n\t\textend: function(timeline) {\r\n\t\t\ttimeline.roundTaskDates = function(task) {\r\n\t\t\t\t_tasks_dnd.round_task_dates(task);\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\tinit: function(timeline, gantt) {\r\n\t\t\t_tasks_dnd = createTaskDND(timeline, gantt);\r\n\t\t\t// TODO: entry point for touch handlers, move touch to timeline\r\n\t\t\ttimeline._tasks_dnd = _tasks_dnd;\r\n\t\t\treturn _tasks_dnd.init(gantt);\r\n\t\t},\r\n\t\tdestructor: function() {\r\n\t\t\tif (_tasks_dnd) {\r\n\t\t\t\t_tasks_dnd.destructor();\r\n\t\t\t\t_tasks_dnd = null;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default {\r\n\tcreateTaskDND: initTaskDND\r\n};","import * as domHelpers from \"../utils/dom_helpers\";\r\n\r\nvar initLinksDND = function(timeline, gantt) {\r\n\tvar _link_landing,\r\n\t\t_link_target_task,\r\n\t\t_link_target_task_start,\r\n\t\t_link_source_task,\r\n\t\t_link_source_task_start,\r\n\t\tmarkerDefaultOffset = 10,\r\n\t\tscrollDefaultSize = 18;\r\n\r\n\tfunction getDndState(){\r\n\t\treturn {\r\n\t\t\tlink_source_id : _link_source_task,\r\n\t\t\tlink_target_id : _link_target_task,\r\n\t\t\tlink_from_start : _link_source_task_start,\r\n\t\t\tlink_to_start : _link_target_task_start,\r\n\t\t\tlink_landing_area : _link_landing\r\n\t\t};\r\n\t}\r\n\r\n\tvar services = gantt.$services;\r\n\r\n\tvar state = services.getService(\"state\");\r\n\tvar DnD = services.getService(\"dnd\");\r\n\r\n\tstate.registerProvider(\"linksDnD\", getDndState);\r\n\r\n\tvar start_marker = \"task_start_date\",\r\n\t\tend_marker = \"task_end_date\",\r\n\t\tlink_edge_marker = \"gantt_link_point\",\r\n\t\tlink_landing_hover_area = \"gantt_link_control\";\r\n\r\n\tvar dnd = new DnD(timeline.$task_bars, {\r\n\t\tsensitivity : 0,\r\n\t\tupdates_per_second : 60,\r\n\t\tmousemoveContainer: gantt.$root,\r\n\t\tselector: \".\" + link_edge_marker,\r\n\t\tpreventDefault: true\r\n\t});\r\n\r\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function(obj,e) {\r\n\t\tvar target = (e.target||e.srcElement);\r\n\t\tresetDndState();\r\n\t\tif(gantt.getState(\"tasksDnd\").drag_id)\r\n\t\t\treturn false;\r\n\r\n\t\tif(domHelpers.locateClassName(target, link_edge_marker)){\r\n\t\t\tif(domHelpers.locateClassName(target, start_marker))\r\n\t\t\t\t_link_source_task_start = true;\r\n\r\n\t\t\tvar sid = gantt.locate(e);\r\n\t\t\t_link_source_task = sid;\r\n\r\n\t\t\tvar t = gantt.getTask(sid);\r\n\t\t\tif(gantt.isReadonly(t)){\r\n\t\t\t\tresetDndState();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tthis._dir_start = {\r\n\t\t\t\tx: dnd.config.original_element_sizes.x + dnd.config.original_element_sizes.width/2,\r\n\t\t\t\ty: dnd.config.original_element_sizes.y + dnd.config.original_element_sizes.height/2\r\n\t\t\t};\r\n\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t}, this));\r\n\r\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function(obj,e) {\r\n\t\tif(gantt.config.touch) {\r\n\t\t\tgantt.refreshData();\r\n\t\t}\r\n\t\tupdateMarkedHtml(dnd.config.marker);\r\n\t}, this));\r\n\r\n\tfunction getVieportSize(){\r\n\t\tvar root = gantt.$root;\r\n\t\treturn { right: root.offsetWidth, bottom: root.offsetHeight };\r\n\t}\r\n\tfunction getMarkerSize (marker){\r\n\t\tvar width = 0, height = 0;\r\n\t\tif(marker){\r\n\t\t\twidth = marker.offsetWidth || 0;\r\n\t\t\theight = marker.offsetHeight || 0;\r\n\t\t}\r\n\t\treturn { width: width, height: height };\r\n\t}\r\n\r\n\tfunction getPosition(e, marker){\r\n\t\tvar oldPos = dnd.getPosition(e);\r\n\r\n\t\tvar markerSize = getMarkerSize(marker);\r\n\t\tvar viewportSize = getVieportSize();\r\n\r\n\t\tvar offsetX = gantt.config.tooltip_offset_x || markerDefaultOffset;\r\n\t\tvar offsetY = gantt.config.tooltip_offset_y || markerDefaultOffset;\r\n\r\n\t\tvar scrollSize = gantt.config.scroll_size || scrollDefaultSize;\r\n\r\n\t\t// GS-1315: Add offset if there are elements above Gantt\r\n\t\tvar ganttOffsetY = gantt.$container.getBoundingClientRect().y + window.scrollY;\r\n\r\n\t\tvar position = {\r\n\t\t\ty: oldPos.y + offsetY,\r\n\t\t\tx: oldPos.x + offsetX,\r\n\t\t\tbottom: oldPos.y + markerSize.height + offsetY + scrollSize,\r\n\t\t\tright: oldPos.x + markerSize.width + offsetX + scrollSize\r\n\t\t};\r\n\r\n\t\tif(position.bottom > viewportSize.bottom + ganttOffsetY){\r\n\t\t\tposition.y = viewportSize.bottom + ganttOffsetY - markerSize.height - offsetY;\r\n\t\t}\r\n\r\n\t\tif(position.right > viewportSize.right){\r\n\t\t\tposition.x = viewportSize.right - markerSize.width - offsetX;\r\n\t\t}\r\n\t\treturn position;\r\n\t}\r\n\r\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function(obj,e) {\r\n\t\tvar dd = dnd.config;\r\n\t\tvar pos = getPosition(e, dd.marker);\r\n\t\tadvanceMarker(dd.marker, pos);\r\n\t\tvar landing = !!domHelpers.locateClassName(e, link_landing_hover_area);\r\n\r\n\t\tvar prevTarget = _link_target_task;\r\n\t\tvar prevLanding = _link_landing;\r\n\t\tvar prevToStart = _link_target_task_start;\r\n\r\n\t\tvar targ = gantt.locate(e),\r\n\t\t\tto_start = true;\r\n\r\n\t\t// can drag and drop link to another gantt on the page, such links are not supported\r\n\t\tvar eventTarget = domHelpers.getTargetNode(e);\r\n\r\n\t\tvar sameGantt = domHelpers.isChildOf(eventTarget, gantt.$root);\r\n\t\tif(!sameGantt){\r\n\t\t\tlanding = false;\r\n\t\t\ttarg = null;\r\n\t\t}\r\n\r\n\t\tif(landing){\r\n\t\t\t//refreshTask\r\n\t\t\tto_start = !domHelpers.locateClassName(e, end_marker);\r\n\t\t\tlanding = !!targ;\r\n\t\t}\r\n\r\n\t\t_link_target_task = targ;\r\n\t\t_link_landing = landing;\r\n\t\t_link_target_task_start = to_start;\r\n\r\n\t\tif(landing){\r\n\r\n\t\t\tvar node = domHelpers.locateClassName(e, link_landing_hover_area);\r\n\t\t\r\n\t\t\tconst point = node.querySelector(`.${link_edge_marker}`);\r\n\t\t\tif(point){\r\n\t\t\t\tconst absCoords = domHelpers.getRelativeNodePosition(point, timeline.$task_bg);\r\n\t\t\t\tthis._dir_end = {\r\n\t\t\t\t\tx: absCoords.x + point.offsetWidth/2,\r\n\t\t\t\t\ty: absCoords.y + point.offsetHeight/2\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t}else{\r\n\t\t\tthis._dir_end = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\r\n\t\t\tif(gantt.env.isEdge){ // to fix margin collapsing\r\n\t\t\t\tthis._dir_end.y += window.scrollY;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar targetChanged = !(prevLanding == landing && prevTarget == targ && prevToStart == to_start);\r\n\t\tif(targetChanged){\r\n\t\t\tif(prevTarget)\r\n\t\t\t\tgantt.refreshTask(prevTarget, false);\r\n\t\t\tif(targ)\r\n\t\t\t\tgantt.refreshTask(targ, false);\r\n\t\t}\r\n\r\n\t\tif(targetChanged){\r\n\t\t\tupdateMarkedHtml(dd.marker);\r\n\t\t}\r\n\r\n\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\r\n\r\n\t\treturn true;\r\n\t}, this));\r\n\r\n\r\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function() {\r\n\t\tvar drag = getDndState();\r\n\r\n\t\tif(drag.link_source_id && drag.link_target_id && drag.link_source_id != drag.link_target_id){\r\n\t\t\tvar type = gantt._get_link_type(drag.link_from_start, drag.link_to_start);\r\n\r\n\t\t\tvar link = {source : drag.link_source_id, target: drag.link_target_id, type:type};\r\n\t\t\tif(link.type && gantt.isLinkAllowed(link)) {\r\n\t\t\t\tif(gantt.callEvent(\"onLinkCreated\", [link])){\r\n\t\t\t\t\tgantt.addLink(link);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tresetDndState();\r\n\r\n\t\tif(gantt.config.touch) {\r\n\t\t\tgantt.refreshData();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (drag.link_source_id)\r\n\t\t\t\tgantt.refreshTask(drag.link_source_id, false);\r\n\t\t\tif (drag.link_target_id)\r\n\t\t\t\tgantt.refreshTask(drag.link_target_id, false);\r\n\t\t}\r\n\t\tremoveDirectionLine();\r\n\t}, this));\r\n\r\n\tfunction updateMarkedHtml(marker){\r\n\t\tvar link = getDndState();\r\n\r\n\t\tvar css = [\"gantt_link_tooltip\"];\r\n\t\tif(link.link_source_id && link.link_target_id){\r\n\t\t\tif(gantt.isLinkAllowed(link.link_source_id, link.link_target_id, link.link_from_start, link.link_to_start)){\r\n\t\t\t\tcss.push(\"gantt_allowed_link\");\r\n\t\t\t}else{\r\n\t\t\t\tcss.push(\"gantt_invalid_link\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar className = gantt.templates.drag_link_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start);\r\n\t\tif(className)\r\n\t\t\tcss.push(className);\r\n\r\n\t\tvar html = \"<div class='\"+className+ \"'>\" +\r\n\t\t\tgantt.templates.drag_link(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start) +\r\n\t\t\t\"</div>\";\r\n\t\tmarker.innerHTML = html;\r\n\t}\r\n\r\n\tfunction advanceMarker(marker, pos){\r\n\t\tmarker.style.left = pos.x + \"px\";\r\n\t\tmarker.style.top = pos.y + \"px\";\r\n\t}\r\n\r\n\tfunction resetDndState(){\r\n\t\t_link_source_task =\r\n\t\t\t_link_source_task_start =\r\n\t\t\t\t_link_target_task = null;\r\n\t\t_link_target_task_start = true;\r\n\t}\r\n\tfunction showDirectingLine(s_x, s_y, e_x, e_y){\r\n\t\tvar div = getDirectionLine();\r\n\r\n\t\tvar link = getDndState();\r\n\r\n\t\tvar css = [\"gantt_link_direction\"];\r\n\t\tif(gantt.templates.link_direction_class){\r\n\t\t\tcss.push(gantt.templates.link_direction_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start));\r\n\t\t}\r\n\r\n\t\tvar dist =Math.sqrt( (Math.pow(e_x - s_x, 2)) + (Math.pow(e_y - s_y, 2)) );\r\n\t\tdist = Math.max(0, dist - 3);\r\n\t\tif(!dist)\r\n\t\t\treturn;\r\n\r\n\t\tdiv.className = css.join(\" \");\r\n\t\tvar tan = (e_y - s_y)/(e_x - s_x),\r\n\t\t\tangle = Math.atan(tan);\r\n\r\n\t\tif(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 2){\r\n\t\t\tangle += Math.PI;\r\n\t\t}else if(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 3){\r\n\t\t\tangle -= Math.PI;\r\n\t\t}\r\n\r\n\r\n\r\n\t\tvar sin = Math.sin(angle),\r\n\t\t\tcos = Math.cos(angle),\r\n\t\t\ttop = Math.round(s_y),\r\n\t\t\tleft = Math.round(s_x);\r\n\r\n\r\n\t\tvar style = [\r\n\t\t\t\"-webkit-transform: rotate(\"+angle+\"rad)\",\r\n\t\t\t\"-moz-transform: rotate(\"+angle+\"rad)\",\r\n\t\t\t\"-ms-transform: rotate(\"+angle+\"rad)\",\r\n\t\t\t\"-o-transform: rotate(\"+angle+\"rad)\",\r\n\t\t\t\"transform: rotate(\"+angle+\"rad)\",\r\n\t\t\t\"width:\" + Math.round(dist) + \"px\"\r\n\t\t];\r\n\r\n\t\tif(window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1){\r\n\t\t\t//ms-filter breaks styles in ie9, so add it only for 8th\r\n\t\t\tstyle.push(\"-ms-filter: \\\"\" + ieTransform(sin, cos) + \"\\\"\");\r\n\r\n\t\t\tvar shiftLeft = Math.abs(Math.round(s_x - e_x)),\r\n\t\t\t\tshiftTop = Math.abs(Math.round(e_y - s_y));\r\n\t\t\t//fix rotation axis\r\n\t\t\tswitch(coordinateCircleQuarter(s_x, e_x, s_y, e_y)){\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\ttop -= shiftTop;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tleft -= shiftLeft;\r\n\t\t\t\t\ttop -= shiftTop;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tleft -= shiftLeft;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tstyle.push(\"top:\" +  top + \"px\");\r\n\t\tstyle.push(\"left:\" +  left + \"px\");\r\n\r\n\t\tdiv.style.cssText = style.join(\";\");\r\n\t}\r\n\r\n\tfunction ieTransform(sin, cos){\r\n\t\treturn \"progid:DXImageTransform.Microsoft.Matrix(\"+\r\n\t\t\t\"M11 = \"+cos+\",\"+\r\n\t\t\t\"M12 = -\"+sin+\",\"+\r\n\t\t\t\"M21 = \"+sin+\",\"+\r\n\t\t\t\"M22 = \"+cos+\",\"+\r\n\t\t\t\"SizingMethod = 'auto expand'\"+\r\n\t\t\")\";\r\n\t}\r\n\tfunction coordinateCircleQuarter(sX, eX, sY, eY){\r\n\t\tif(eX >= sX){\r\n\t\t\tif(eY <= sY){\r\n\t\t\t\treturn 1;\r\n\t\t\t}else{\r\n\t\t\t\treturn 4;\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tif(eY <= sY){\r\n\t\t\t\treturn 2;\r\n\t\t\t}else{\r\n\t\t\t\treturn 3;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\tfunction getDirectionLine(){\r\n\t\tif(!dnd._direction || !dnd._direction.parentNode){\r\n\t\t\tdnd._direction = document.createElement(\"div\");\r\n\t\t\ttimeline.$task_links.appendChild(dnd._direction);\r\n\t\t}\r\n\t\treturn dnd._direction;\r\n\t}\r\n\tfunction removeDirectionLine(){\r\n\t\tif(dnd._direction){\r\n\t\t\tif (dnd._direction.parentNode)\t//the event line can be detached because of data refresh\r\n\t\t\t\tdnd._direction.parentNode.removeChild(dnd._direction);\r\n\r\n\t\t\tdnd._direction = null;\r\n\t\t}\r\n\t}\r\n\tgantt.attachEvent(\"onGanttRender\", gantt.bind(function() {\r\n\t\tif(dnd._direction){\r\n\t\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\r\n\t\t}\r\n\t}, this));\r\n};\r\n\r\nexport default {\r\n\tcreateLinkDND: function(){\r\n\t\treturn {\r\n\t\t\tinit: initLinksDND\r\n\t\t};\r\n\t}\r\n};","import * as utils from \"../../../utils/utils\";\r\nimport taskDnD from \"./tasks_dnd\";\r\nimport linkDnD from \"./links_dnd\";\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\nimport MouseDelegates from \"../mouse_event_container\";\r\n\r\nvar initializer = (function(){\r\n\treturn function(gantt){\r\n\t\tvar services = gantt.$services;\r\n\t\treturn {\r\n\t\t\tonCreated: function (timeline) {\r\n\t\t\t\tvar config = timeline.$config;\r\n\t\t\t\tconfig.bind = utils.defined(config.bind) ? config.bind : \"task\";\r\n\t\t\t\tconfig.bindLinks = utils.defined(config.bindLinks) ? config.bindLinks : \"link\";\r\n\r\n\t\t\t\ttimeline._linksDnD = linkDnD.createLinkDND();\r\n\t\t\t\ttimeline._tasksDnD = taskDnD.createTaskDND();\r\n\t\t\t\ttimeline._tasksDnD.extend(timeline);\r\n\r\n\t\t\t\tthis._mouseDelegates = MouseDelegates(gantt);\r\n\t\t\t},\r\n\t\t\tonInitialized: function (timeline) {\r\n\t\t\t\tthis._attachDomEvents(gantt);\r\n\r\n\t\t\t\tthis._attachStateProvider(gantt, timeline);\r\n\r\n\t\t\t\ttimeline._tasksDnD.init(timeline, gantt);\r\n\t\t\t\ttimeline._linksDnD.init(timeline, gantt);\r\n\r\n\t\t\t\tif(timeline.$config.id == \"timeline\"){\r\n\t\t\t\t\tthis.extendDom(timeline);\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tonDestroyed: function (timeline) {\r\n\t\t\t\tthis._clearDomEvents(gantt);\r\n\t\t\t\tthis._clearStateProvider(gantt);\r\n\t\t\t\tif (timeline._tasksDnD) {\r\n\t\t\t\t\ttimeline._tasksDnD.destructor();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\textendDom: function(timeline){\r\n\t\t\t\tgantt.$task = timeline.$task;\r\n\t\t\t\tgantt.$task_scale = timeline.$task_scale;\r\n\t\t\t\tgantt.$task_data = timeline.$task_data;\r\n\t\t\t\tgantt.$task_bg = timeline.$task_bg;\r\n\t\t\t\tgantt.$task_links = timeline.$task_links;\r\n\t\t\t\tgantt.$task_bars = timeline.$task_bars;\r\n\t\t\t},\r\n\r\n\t\t\t_clearDomEvents: function(){\r\n\t\t\t\tthis._mouseDelegates.destructor();\r\n\t\t\t\tthis._mouseDelegates = null;\r\n\t\t\t},\r\n\r\n\t\t\t_attachDomEvents: function(gantt){\r\n\t\t\t\tfunction _delete_link_handler(id, e) {\r\n\t\t\t\t\tif (id && this.callEvent(\"onLinkDblClick\", [id, e])) {\r\n\r\n\t\t\t\t\t\tvar link = this.getLink(id);\r\n\t\t\t\t\t\tif (this.isReadonly(link)) return;\r\n\r\n\t\t\t\t\t\tvar title = \"\";\r\n\t\t\t\t\t\tvar question = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(id)) + \" \" + this.locale.labels.confirm_link_deleting;\r\n\r\n\t\t\t\t\t\twindow.setTimeout(function () {\r\n\t\t\t\t\t\t\tgantt._delete_link_confirm({\r\n\t\t\t\t\t\t\t\tlink: link,\r\n\t\t\t\t\t\t\t\tmessage: question,\r\n\t\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\t\tcallback: function () {\r\n\t\t\t\t\t\t\t\t\tgantt.deleteLink(id);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}, (this.config.touch ? 300 : 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_task_link\", gantt.bind(function (e, trg) {\r\n\t\t\t\t\tvar id = this.locate(e, this.config.link_attribute);\r\n\t\t\t\t\tif (id) {\r\n\t\t\t\t\t\tthis.callEvent(\"onLinkClick\", [id, e]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, gantt), this.$task);\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", gantt.bind(function (e, trg) {\r\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\r\n\t\t\t\t\tvar date = gantt.dateFromPos(pos.x);\r\n\t\t\t\t\tvar coll = Math.floor(gantt.columnIndexByDate(date));\r\n\r\n\t\t\t\t\tvar coll_date = gantt.getScale().trace_x[coll];\r\n\r\n\t\t\t\t\tgantt.callEvent(\"onScaleClick\", [e, coll_date]);\r\n\t\t\t\t}, gantt), this.$task);\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", gantt.bind(function (e, id, trg) {\r\n\t\t\t\t\tvar id = this.locate(e, gantt.config.link_attribute);\r\n\t\t\t\t\t_delete_link_handler.call(this, id, e);\r\n\t\t\t\t}, gantt), this.$task);\r\n\r\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", gantt.bind(function (e, id, trg) {\r\n\t\t\t\t\tvar id = this.locate(e),\r\n\t\t\t\t\t\ttask = this.getTask(id);\r\n\r\n\t\t\t\t\tvar link = null;\r\n\t\t\t\t\tif (trg.parentNode && domHelpers.getClassName(trg.parentNode)) {\r\n\t\t\t\t\t\tif (domHelpers.getClassName(trg.parentNode).indexOf(\"_left\") > -1) {\r\n\t\t\t\t\t\t\tlink = task.$target[0];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlink = task.$source[0];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (link)\r\n\t\t\t\t\t\t_delete_link_handler.call(this, link, e);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}, gantt), this.$task);\r\n\t\t\t},\r\n\r\n\t\t\t_attachStateProvider: function(gantt, timeline){\r\n\t\t\t\tvar self = timeline;\r\n\t\t\t\tvar state = services.getService(\"state\");\r\n\t\t\t\tstate.registerProvider(\"tasksTimeline\", function(){\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tscale_unit: self._tasks ? self._tasks.unit : undefined,\r\n\t\t\t\t\t\tscale_step:  self._tasks ? self._tasks.step  : undefined\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t_clearStateProvider: function(){\r\n\t\t\t\tvar state = services.getService(\"state\");\r\n\t\t\t\tstate.unregisterProvider(\"tasksTimeline\");\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n})();\r\n\r\nexport default initializer;","import * as domHelpers from \"./utils/dom_helpers\";\r\n\r\nvar initializer = (function() {\r\n\treturn function (gantt) {\r\n\t\treturn {\r\n\r\n\t\t\tgetVerticalScrollbar: function(){\r\n\t\t\t\treturn gantt.$ui.getView(\"scrollVer\");\r\n\t\t\t},\r\n\t\t\tgetHorizontalScrollbar: function(){\r\n\t\t\t\treturn gantt.$ui.getView(\"scrollHor\");\r\n\t\t\t},\r\n\r\n\t\t\t_legacyGridResizerClass: function(layout){\r\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\r\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\r\n\t\t\t\t\tvar r = resizers[i];\r\n\t\t\t\t\tvar gridResizer = false;\r\n\r\n\t\t\t\t\tvar prev = r.$parent.getPrevSibling(r.$id);\r\n\t\t\t\t\tif(prev && prev.$config && prev.$config.id === \"grid\"){\r\n\t\t\t\t\t\tgridResizer= true;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tvar next = r.$parent.getNextSibling(r.$id);\r\n\t\t\t\t\t\tif(next && next.$config && next.$config.id === \"grid\"){\r\n\t\t\t\t\t\t\tgridResizer= true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(gridResizer){\r\n\t\t\t\t\t\tr.$config.css = (r.$config.css ? r.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonCreated: function(layout) {\r\n\t\t\t\tvar first = true;\r\n\r\n\t\t\t\tthis._legacyGridResizerClass(layout);\r\n\r\n\t\t\t\tlayout.attachEvent(\"onBeforeResize\", function() {\r\n\t\t\t\t\tvar mainTimeline = gantt.$ui.getView(\"timeline\");\r\n\t\t\t\t\tif (mainTimeline)\r\n\t\t\t\t\t\tmainTimeline.$config.hidden = mainTimeline.$parent.$config.hidden = !gantt.config.show_chart;\r\n\r\n\t\t\t\t\tvar mainGrid = gantt.$ui.getView(\"grid\");\r\n\r\n\t\t\t\t\tif(!mainGrid)\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tvar colsWidth = mainGrid._getColsTotalWidth();\r\n\t\t\t\t\tvar hideGrid = !gantt.config.show_grid || !gantt.config.grid_width || colsWidth === 0;\r\n\t\t\t\t\tif (first && !hideGrid && colsWidth !== false){\r\n\t\t\t\t\t\t\tgantt.config.grid_width = colsWidth;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmainGrid.$config.hidden = mainGrid.$parent.$config.hidden = hideGrid;\r\n\r\n\t\t\t\t\tif (!mainGrid.$config.hidden) {\r\n\t\t\t\t\t\t/* restrict grid width due to min_width, max_width, min_grid_column_width */\r\n\t\t\t\t\t\tvar grid_limits = mainGrid._getGridWidthLimits();\r\n\t\t\t\t\t\tif (grid_limits[0] && gantt.config.grid_width < grid_limits[0])\r\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[0];\r\n\t\t\t\t\t\tif (grid_limits[1] && gantt.config.grid_width > grid_limits[1])\r\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[1];\r\n\t\t\t\t\t\tif (mainTimeline && gantt.config.show_chart){\r\n\r\n\t\t\t\t\t\t\tmainGrid.$config.width = gantt.config.grid_width - 1;\r\n\r\n\t\t\t\t\t\t\t// GS-1314: Don't let the non-scrollable grid to be larger than the container with the correct width\r\n\t\t\t\t\t\t\tif (!mainGrid.$config.scrollable && mainGrid.$config.scrollY && gantt.$root.offsetWidth){\r\n\t\t\t\t\t\t\t\tvar ganttContainerWidth = mainGrid.$gantt.$layout.$container.offsetWidth;\r\n\t\t\t\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(mainGrid.$config.scrollY);\r\n\t\t\t\t\t\t\t\tvar verticalScrollbarWidth = verticalScrollbar.$config.width;\r\n\r\n\t\t\t\t\t\t\t\t// GS-2488: to prevent grid from occupying the whole gantt container(timeline will be disabled) \r\n\t\t\t\t\t\t\t\t// need to leave min width for timeline\r\n\t\t\t\t\t\t\t\tvar gridOverflow = ganttContainerWidth - (mainGrid.$config.width + verticalScrollbarWidth) - 4;\r\n\t\t\t\t\t\t\t\tif (gridOverflow < 0){\r\n\t\t\t\t\t\t\t\t\tmainGrid.$config.width += gridOverflow;\r\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width += gridOverflow;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (!first) {\r\n\t\t\t\t\t\t\t\tif (mainTimeline && !domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\r\n\t\t\t\t\t\t\t\t\t// timeline is being displayed after being not visible, reset grid with from full screen\r\n\t\t\t\t\t\t\t\t\tif (!mainGrid.$config.original_grid_width) {\r\n\t\t\t\t\t\t\t\t\t\tvar skinSettings = gantt.skins[gantt.skin];\r\n\t\t\t\t\t\t\t\t\t\tif(skinSettings && skinSettings.config && skinSettings.config.grid_width){\r\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width =  skinSettings.config.grid_width;\r\n\t\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = 0;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width = mainGrid.$config.original_grid_width;\r\n\t\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tmainGrid.$parent._setContentSize(mainGrid.$config.width, null);\r\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: gantt.config.grid_width, isGravity: false});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\r\n\t\t\t\t\t\t\t\tif (mainGrid.$parent.$config.group) {\r\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: mainGrid.$parent.$config.width, isGravity: false});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (mainTimeline && domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\r\n\t\t\t\t\t\t\t\t// hiding timeline, remember grid with to restore it when timeline is displayed again\r\n\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = gantt.config.grid_width;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!first) {\r\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = 0;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfirst = false;\r\n\t\t\t\t});\r\n\t\t\t\tthis._initScrollStateEvents(layout);\r\n\t\t\t},\r\n\r\n\t\t\t_initScrollStateEvents: function(layout) {\r\n\t\t\t\tgantt._getVerticalScrollbar = this.getVerticalScrollbar;\r\n\t\t\t\tgantt._getHorizontalScrollbar = this.getHorizontalScrollbar;\r\n\r\n\t\t\t\tvar vertical = this.getVerticalScrollbar();\r\n\t\t\t\tvar horizontal = this.getHorizontalScrollbar();\r\n\t\t\t\tif (vertical) {\r\n\t\t\t\t\tvertical.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\r\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\r\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [scrollState.x, oldPos, scrollState.x, newPos]);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (horizontal) {\r\n\t\t\t\t\thorizontal.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\r\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\r\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [oldPos, scrollState.y, newPos, scrollState.y]);\r\n\r\n\t\t\t\t\t\t// if the grid doesn't fit the width, scroll the row container\r\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\t\tif (grid && grid.$grid_data && !grid.$config.scrollable){\r\n\t\t\t\t\t\t\tgrid.$grid_data.style.left = grid.$grid.scrollLeft + \"px\";\r\n\t\t\t\t\t\t\tgrid.$grid_data.scrollLeft = grid.$grid.scrollLeft;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlayout.attachEvent(\"onResize\", function(){\r\n\t\t\t\t\tif (vertical && !gantt.$scroll_ver){\r\n\t\t\t\t\t\tgantt.$scroll_ver = vertical.$scroll_ver;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (horizontal && !gantt.$scroll_hor){\r\n\t\t\t\t\t\tgantt.$scroll_hor = horizontal.$scroll_hor;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\r\n\t\t\t_findGridResizer: function(layout, grid){\r\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\r\n\r\n\t\t\t\tvar gridFirst = true;\r\n\t\t\t\tvar gridResizer;\r\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\r\n\t\t\t\t\tvar res = resizers[i];\r\n\t\t\t\t\tres._getSiblings();\r\n\t\t\t\t\tvar prev = res._behind;\r\n\t\t\t\t\tvar next = res._front;\r\n\t\t\t\t\tif(prev && prev.$content === grid || (prev.isChild && prev.isChild(grid))){\r\n\t\t\t\t\t\tgridResizer = res;\r\n\t\t\t\t\t\tgridFirst = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}else if(next && next.$content === grid || (next.isChild && next.isChild(grid))){\r\n\t\t\t\t\t\tgridResizer = res;\r\n\t\t\t\t\t\tgridFirst = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tresizer: gridResizer,\r\n\t\t\t\t\tgridFirst: gridFirst\r\n\t\t\t\t};\r\n\t\t\t},\r\n\r\n\t\t\tonInitialized: function (layout) {\r\n\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\r\n\r\n\t\t\t\tvar resizeInfo = this._findGridResizer(layout, grid);\r\n\r\n\t\t\t\t// expose grid resize events\r\n\t\t\t\tif(resizeInfo.resizer){\r\n\t\t\t\t\tvar gridFirst = resizeInfo.gridFirst,\r\n\t\t\t\t\t\tnext = resizeInfo.resizer;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif(next.$config.mode !== \"x\"){\r\n\t\t\t\t\t\treturn;// track only horizontal resize\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar initialWidth;\r\n\t\t\t\t\tnext.attachEvent(\"onResizeStart\", function(prevCellWidth, nextCellWidth){\r\n\r\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\r\n\t\t\t\t\t\tif(viewCell){\r\n\t\t\t\t\t\t\tvar limits = grid._getGridWidthLimits();\r\n\r\n\t\t\t\t\t\t\t// min grid width is defined by min widths of its columns, unless grid has horizontal scroll\r\n\t\t\t\t\t\t\tif(!grid.$config.scrollable)\r\n\t\t\t\t\t\t\t\tviewCell.$config.minWidth = limits[0];\r\n\r\n\t\t\t\t\t\t\tviewCell.$config.maxWidth = limits[1];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tinitialWidth = gridFirst ? prevCellWidth : nextCellWidth;\r\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResizeStart\", [initialWidth]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.attachEvent(\"onResize\", function(newBehindSize, newFrontSize){\r\n\t\t\t\t\t\tvar newSize = gridFirst ? newBehindSize : newFrontSize;\r\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResize\", [initialWidth, newSize]);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnext.attachEvent(\"onResizeEnd\", function(oldBackSize, oldFrontSize, newBackSize, newFrontSize){\r\n\r\n\t\t\t\t\t\tvar oldSize = gridFirst ? oldBackSize : oldFrontSize;\r\n\t\t\t\t\t\tvar newSize = gridFirst ? newBackSize : newFrontSize;\r\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\r\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\r\n\t\t\t\t\t\tif(viewCell){\r\n\t\t\t\t\t\t\tviewCell.$config.minWidth = undefined;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar res = gantt.callEvent(\"onGridResizeEnd\", [oldSize, newSize]);\r\n\t\t\t\t\t\tif(res && newSize !== 0){// new size may be numeric zero when cell size is defined by 'gravity', actual size will be calculated by layout later\r\n\t\t\t\t\t\t\tgantt.config.grid_width = newSize;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn res;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tonDestroyed: function (timeline) {\r\n\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t};\r\n})();\r\n\r\nexport default initializer;","import uiFactory from \"./ui_factory\";\r\nimport mouseEvents from \"./mouse\";\r\nimport createLayers from \"./gantt_layers\";\r\nimport Cell from \"./layout/cell\";\r\nimport Layout from \"./layout/layout\";\r\nimport ViewLayout from \"./layout/view_layout\";\r\nimport ViewCell from \"./layout/view_cell\";\r\nimport Resizer from \"./layout/resizer_cell\";\r\nimport Scrollbar from \"./layout/scrollbar_cell\";\r\nimport Timeline from \"./timeline/timeline\";\r\nimport Grid from \"./grid/grid\";\r\nimport ResourceGrid from \"./grid/resource_grid\";\r\nimport ResourceTimeline from \"./timeline/resource_timeline\";\r\nimport ResourceHistogram from \"./timeline/resource_histogram\";\r\n\r\n\r\nimport gridEditorsFactory from \"./grid/editors/controller\";\r\n\r\nimport renderTaskBar from \"./render/task_bar_smart_render\";\r\nimport renderTimedProjectBar from \"./render/task_project_smart_render\";\r\nimport renderSplitTaskBar from \"./render/task_split_render\";\r\nimport renderRollupTaskBar from \"./render/task_rollup_render\";\r\nimport renderTaskBg from \"./render/task_bg_render\";\r\nimport renderLink from \"./render/link_render\";\r\nimport gridRenderer from \"./render/task_grid_line_render\";\r\nimport resourceMatrixRenderer from \"./render/resource_matrix_render\";\r\nimport resourceHistogramRenderer from \"./render/resource_histogram_render\";\r\nimport gridTaskRowResizerRenderer from \"./render/task_grid_row_resize_render\";\r\nimport renderConstraints from \"./render/task_constraints_render\";\r\nimport renderDeadline from \"./render/task_deadline_render\";\r\nimport renderBaselines from \"./render/task_baselines_render\";\r\nimport mainGridInitializer from \"./grid/main_grid_initializer\";\r\nimport mainTimelineInitializer from \"./timeline/main_timeline_initializer\";\r\nimport mainLayoutInitializer from \"./main_layout_initializer\";\r\n\r\nfunction initUI(gantt){\r\n\tfunction attachInitializer(view, initializer){\r\n\t\tvar ext = initializer(gantt);\r\n\t\tif(ext.onCreated)\r\n\t\t\text.onCreated(view);\r\n\t\tview.attachEvent(\"onReady\", function(){\r\n\t\t\tif(ext.onInitialized)\r\n\t\t\t\text.onInitialized(view);\r\n\t\t});\r\n\t\tview.attachEvent(\"onDestroy\", function(){\r\n\t\t\tif(ext.onDestroyed)\r\n\t\t\t\text.onDestroyed(view);\r\n\t\t});\r\n\t}\r\n\r\n\tvar factory = uiFactory.createFactory(gantt);\r\n\tfactory.registerView(\"cell\", Cell);\r\n\tfactory.registerView(\"resizer\", Resizer);\r\n\tfactory.registerView(\"scrollbar\", Scrollbar);\r\n\tfactory.registerView(\"layout\", Layout, function(view){\r\n\t\tvar id = view.$config ? view.$config.id : null;\r\n\t\tif(id === \"main\"){\r\n\t\t\tattachInitializer(view, mainLayoutInitializer);\r\n\t\t}\r\n\t});\r\n\tfactory.registerView(\"viewcell\", ViewCell);\r\n\tfactory.registerView(\"multiview\", ViewLayout);\r\n\tfactory.registerView(\"timeline\", Timeline, function(view){\r\n\t\tvar id = view.$config ? view.$config.id : null;\r\n\t\tif(id === \"timeline\" || view.$config.bind == \"task\"){\r\n\t\t\tattachInitializer(view, mainTimelineInitializer);\r\n\t\t}\r\n\t});\r\n\tfactory.registerView(\"grid\", Grid, function(view){\r\n\t\tvar id = view.$config ? view.$config.id : null;\r\n\t\tif(id === \"grid\" || view.$config.bind == \"task\"){\r\n\t\t\tattachInitializer(view, mainGridInitializer);\r\n\t\t}\r\n\t});\r\n\r\n\tfactory.registerView(\"resourceGrid\", ResourceGrid);\r\n\tfactory.registerView(\"resourceTimeline\", ResourceTimeline);\r\n\tfactory.registerView(\"resourceHistogram\", ResourceHistogram);\r\n\r\n\tvar layersEngine = createLayers(gantt);\r\n\r\n\tvar inlineEditors = gridEditorsFactory(gantt);\r\n\r\n\tgantt.ext.inlineEditors = inlineEditors;\r\n\tgantt.ext._inlineEditors = inlineEditors;\r\n\tinlineEditors.init(gantt);\r\n\r\n\treturn {\r\n\t\tfactory:factory,\r\n\t\tmouseEvents: mouseEvents.init(gantt),\r\n\t\tlayersApi: layersEngine.init(),\r\n\t\trender:{\r\n\t\t\tgridLine: function(){\r\n\t\t\t\treturn gridRenderer(gantt);\r\n\t\t\t},\r\n\t\t\ttaskBg: function(){\r\n\t\t\t\treturn renderTaskBg(gantt);\r\n\t\t\t},\r\n\t\t\ttaskBar: function(){\r\n\t\t\t\treturn renderTaskBar(gantt);\r\n\t\t\t},\r\n\t\t\ttimedProjectBar: function(){\r\n\t\t\t\treturn renderTimedProjectBar(gantt);\r\n\t\t\t},\r\n\t\t\ttaskRollupBar: function() {\r\n\t\t\t\treturn renderRollupTaskBar(gantt);\r\n\t\t\t},\r\n\t\t\ttaskSplitBar: function(){\r\n\t\t\t\treturn renderSplitTaskBar(gantt);\r\n\t\t\t},\r\n\t\t\ttaskConstraints: function(){\r\n\t\t\t\treturn renderConstraints(gantt);\r\n\t\t\t},\r\n\t\t\ttaskDeadline: function(){\r\n\t\t\t\treturn renderDeadline(gantt);\r\n\t\t\t},\r\n\t\t\ttaskBaselines: function(){\r\n\t\t\t\treturn renderBaselines(gantt);\r\n\t\t\t},\r\n\t\t\tlink: function(){\r\n\t\t\t\treturn renderLink(gantt);\r\n\t\t\t},\r\n\t\t\tresourceRow: function(){\r\n\t\t\t\treturn resourceMatrixRenderer(gantt);\r\n\t\t\t},\r\n\t\t\tresourceHistogram: function(){\r\n\t\t\t\treturn resourceHistogramRenderer(gantt);\r\n\t\t\t},\r\n\t\t\tgridTaskRowResizer: function(){\r\n\t\t\t\treturn gridTaskRowResizerRenderer(gantt);\r\n\t\t\t}\r\n\t\t},\r\n\t\tlayersService: {\r\n\t\t\tgetDataRender: function(name){\r\n\t\t\t\treturn layersEngine.getDataRender(name, gantt);\r\n\t\t\t},\r\n\t\t\tcreateDataRender: function(config){\r\n\t\t\t\treturn layersEngine.createDataRender(config, gantt);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport default {\r\n\tinit: initUI\r\n};","export default null;","import * as helpers from \"../../../utils/helpers\";\r\nimport getRowRectangle from \"./viewport/get_grid_row_rectangle\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\nimport isInViewPort from \"./viewport/is_grid_row_in_viewport\";\r\n\r\nfunction createGridLineRender(gantt){\r\n\r\n\tfunction _render_grid_item(item, view, config, viewport) {\r\n\t\tvar columns = view.getGridColumns();\r\n\t\tvar templates = view.$getTemplates();\r\n\r\n\t\tvar store = view.$config.rowStore;\r\n\r\n\t\tvar cells = [];\r\n\t\tvar has_child;\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tvar last = i == columns.length - 1;\r\n\t\t\tvar col = columns[i];\r\n\t\t\tvar cell;\r\n\r\n\t\t\tvar value;\r\n\t\t\tvar textValue;\r\n\t\t\tif (col.name == \"add\") {\r\n\t\t\t\tvar aria = gantt._waiAria.gridAddButtonAttrString(col);\r\n\r\n\t\t\t\tvalue = \"<div \" + aria + \" class='gantt_add'></div>\";\r\n\t\t\t\ttextValue = \"\";\r\n\t\t\t} else {\r\n\t\t\t\tif (col.template)\r\n\t\t\t\t\tvalue = col.template(item);\r\n\t\t\t\telse\r\n\t\t\t\t\tvalue = item[col.name];\r\n\r\n\t\t\t\tif (helpers.isDate(value)){\r\n\t\t\t\t\tvalue = templates.date_grid(value, item, col.name);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (value === null || value === undefined) {\r\n\t\t\t\t\tvalue = \"\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttextValue = value;\r\n\t\t\t\tvalue = \"<div class='gantt_tree_content'>\" + value + \"</div>\";\r\n\t\t\t}\r\n\t\t\tvar css = \"gantt_cell\" + (last ? \" gantt_last_cell\" : \"\");\r\n\r\n\t\t\tvar tree = [];\r\n\t\t\tif (col.tree) {\r\n\t\t\t\tcss += \" gantt_cell_tree\";\r\n\t\t\t\tfor (var j = 0; j < item.$level; j++)\r\n\t\t\t\t\ttree.push(templates.grid_indent(item));\r\n\r\n\t\t\t\thas_child = store.hasChild(item.id) && !(gantt.isSplitTask(item) && !gantt.config.open_split_tasks);\r\n\t\t\t\tif (has_child) {\r\n\t\t\t\t\ttree.push(templates.grid_open(item));\r\n\t\t\t\t\ttree.push(templates.grid_folder(item));\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttree.push(templates.grid_blank(item));\r\n\t\t\t\t\ttree.push(templates.grid_file(item));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar style = \"width:\" + (col.width - (last ? 1 : 0)) + \"px;\";\r\n\t\t\tif (this.defined(col.align)){\r\n\t\t\t\tvar flexAlign = {\r\n\t\t\t\t\tright: \"flex-end\",\r\n\t\t\t\t\tleft: \"flex-start\",\r\n\t\t\t\t\tcenter: \"center\"\r\n\t\t\t\t};\r\n\t\t\t\tvar justifyContent = flexAlign[col.align];\r\n\r\n\t\t\t\tstyle += \"text-align:\" + col.align + \";justify-content:\"  + justifyContent + \";\";\r\n\t\t\t}\r\n\r\n\t\t\tvar aria = gantt._waiAria.gridCellAttrString(col, textValue, item);\r\n\r\n\t\t\ttree.push(value);\r\n\t\t\tcell = \"<div class='\" + css + \"' data-column-index='\"+i+\"' data-column-name='\"+col.name+\"' style='\" + style + \"' \" + aria + \">\" + tree.join(\"\") + \"</div>\";\r\n\t\t\tcells.push(cell);\r\n\t\t}\r\n\t\t// GS-291. The odd class should be assigned correctly\r\n\t\tcss = \"\";\r\n\t\tconst storeName = store.$config.name;\r\n\t\tswitch (storeName) {\r\n\t\t\tcase \"task\":\r\n\t\t\t\tcss = gantt.getGlobalTaskIndex(item.id) % 2 === 0 ? \"\" : \" odd\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"resource\":\r\n\t\t\t\tcss = store.visibleOrder.indexOf(item.id) % 2 === 0 ? \"\" : \" odd\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tcss += (item.$transparent) ? \" gantt_transparent\" : \"\";\r\n\r\n\t\tcss += (item.$dataprocessor_class ? \" \" + item.$dataprocessor_class : \"\");\r\n\r\n\t\tif (templates.grid_row_class) {\r\n\t\t\tvar css_template = templates.grid_row_class.call(gantt, item.start_date, item.end_date, item);\r\n\t\t\tif (css_template)\r\n\t\t\t\tcss += \" \" + css_template;\r\n\t\t}\r\n\r\n\t\tif(store.isSelected(item.id)) {\r\n\t\t\tcss += \" gantt_selected\";\r\n\t\t}\r\n\r\n\t\tvar el = document.createElement(\"div\");\r\n\t\tel.className = \"gantt_row\" + css + \" gantt_row_\" + gantt.getTaskType(item.type);\r\n\t\tvar height = view.getItemHeight(item.id);\r\n\t\tel.style.height = height + \"px\";\r\n\t\tel.style.lineHeight = height + \"px\";\r\n\r\n\t\tif(config.smart_rendering){\r\n\t\t\tel.style.position = \"absolute\";\r\n\t\t\tel.style.left = \"0px\";\r\n\t\t\tel.style.top = view.getItemTop(item.id) + \"px\";\r\n\t\t}\r\n\r\n\t\tif(view.$config.item_attribute){\r\n\t\t\tel.setAttribute(view.$config.item_attribute, item.id);\r\n\t\t\tel.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\r\n\t\t}\r\n\r\n\t\tgantt._waiAria.taskRowAttr(item, el);\r\n\r\n\t\tel.innerHTML = cells.join(\"\");\r\n\t\treturn el;\r\n\t}\r\n\r\n\tfunction onrender(item, rowNode, view){\r\n\t\tvar columns = view.getGridColumns();\r\n\t\tfor (var i = 0; i < columns.length; i++) {\r\n\t\t\tvar column = columns[i];\r\n\t\t\tif (column.onrender){\r\n\r\n\t\t\t\t// find cell node for current column\r\n\t\t\t\tvar cellNode = rowNode.querySelector(`[data-column-name=\"${column.name}\"]`);\r\n\t\t\t\tif (cellNode) {\r\n\t\t\t\t\tvar content = column.onrender(item, cellNode);\r\n\t\t\t\t\tif (content && typeof content === \"string\") {\r\n\t\t\t\t\t\tcellNode.innerHTML = content;\r\n\t\t\t\t\t} else if (content && typeof content === \"object\") {\r\n\t\t\t\t\t\t// render object to node using additional functionality\r\n\t\t\t\t\t\tif (gantt.config.external_render){\r\n\t\t\t\t\t\t\tvar adapter = gantt.config.external_render;\r\n\t\t\t\t\t\t\tif (adapter.isElement(content)){\r\n\t\t\t\t\t\t\t\tadapter.renderElement(content, cellNode);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\trender: _render_grid_item,\r\n\t\tupdate: null,\r\n\t\tgetRectangle: getRowRectangle,\r\n\t\tisInViewPort: isInViewPort,\r\n\t\tgetVisibleRange: getVisibleRange,\r\n\t\tonrender: onrender\r\n\t};\r\n}\r\n\r\nexport default createGridLineRender;","import getRowRectangle from \"./viewport/get_bg_row_rectangle\";\r\nimport isLegacyRender from \"./is_legacy_smart_render\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\r\nimport isColumnVisible from \"./viewport/is_column_visible\";\r\nimport bgPlaceholder from \"./prerender/task_bg_placeholder\";\r\n\r\nfunction createTaskBgRender(gantt){\r\n\tvar renderedCells = {};\r\n\tvar visibleCells = {};\r\n\r\n\tfunction isRendered(item, columnIndex){\r\n\t\tif(renderedCells[item.id][columnIndex] && renderedCells[item.id][columnIndex].parentNode){\r\n\t\t\treturn true;\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction detachRenderedCell(itemId, columnIndex){\r\n\t\tif(renderedCells[itemId] && renderedCells[itemId][columnIndex] &&\r\n\t\t\trenderedCells[itemId][columnIndex].parentNode\r\n\t\t\t){\r\n\t\t\t\trenderedCells[itemId][columnIndex].parentNode.removeChild(renderedCells[itemId][columnIndex]);\r\n\t\t\t}\r\n\t}\r\n\r\n\tfunction getCellClassTemplate(view){\r\n\t\tvar templates = view.$getTemplates();\r\n\t\tvar cssTemplate;\r\n\t\tif (typeof templates.task_cell_class !== \"undefined\") {\r\n\t\t\tcssTemplate = templates.task_cell_class;\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tvar log = console.warn || console.log;\r\n\t\t\tlog('gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.');\r\n\t\t} else {\r\n\t\t\tcssTemplate = templates.timeline_cell_class;\r\n\t\t}\r\n\t\treturn cssTemplate;\r\n\t}\r\n\tfunction getCellContentTemplate(view){\r\n\t\tvar templates = view.$getTemplates();\r\n\t\tvar contentTemplate = templates.timeline_cell_content;\r\n\t\treturn contentTemplate;\r\n\t}\r\n\r\n\tfunction renderCells(item, node, view, config, viewPort){\r\n\t\tvar cfg = view.getScale();\r\n\t\tvar count = cfg.count;\r\n\t\tvar cssTemplate = getCellClassTemplate(view);\r\n\t\tvar contentTemplate = getCellContentTemplate(view);\r\n\r\n\t\tif (config.show_task_cells) {\r\n\t\t\tif(!renderedCells[item.id]){\r\n\t\t\t\trenderedCells[item.id] = {};\r\n\t\t\t}\r\n\t\t\tif(!visibleCells[item.id]){\r\n\t\t\t\tvisibleCells[item.id] = {};\r\n\t\t\t}\r\n\r\n\t\t\tvar range = getVisibleCellsRange(cfg, viewPort);\r\n\r\n\t\t\tfor(var i in visibleCells[item.id]){\r\n\t\t\t\tvar index = visibleCells[item.id][i];\r\n\r\n\t\t\t\tif(Number(index) < range.start || Number(index) > range.end){\r\n\t\t\t\t\tdetachRenderedCell(item.id, index);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvisibleCells[item.id] = {};\r\n\t\t\t// TODO: do not iterate all cell, only ones in the viewport and once that are already rendered\r\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\r\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config);\r\n\t\t\t\tif(!cell && isRendered(item, columnIndex)){\r\n\t\t\t\t\tdetachRenderedCell(item.id, columnIndex);\r\n\t\t\t\t}else if (cell && !cell.parentNode){\r\n\t\t\t\t\tnode.appendChild(cell);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction renderOneCell(scale, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config){\r\n\t\tvar width = scale.width[columnIndex],\r\n\t\t\tcssclass = \"\";\r\n\r\n\t\tif (isColumnVisible(columnIndex, scale, viewPort, gantt)) {//do not render skipped columns\r\n\r\n\t\t\tvar cssTemplateContent = cssTemplate(item, scale.trace_x[columnIndex]);\r\n\t\t\tvar htmlTemplateContent = \"\";\r\n\t\t\tif (contentTemplate) {// for backward compatibility, contentTemplate was added in 7.2.0+, will be undefined if someone used copy of old config/template object\r\n\t\t\t\thtmlTemplateContent = contentTemplate(item, scale.trace_x[columnIndex]);\r\n\t\t\t}\r\n\r\n\t\t\tif(config.static_background){\r\n\t\t\t\t// if cell render in static background is not allowed, or if it's a blank cell\r\n\t\t\t\tvar customCell = !!(cssTemplateContent || htmlTemplateContent);\r\n\t\t\t\tif(!(config.static_background_cells && customCell)){\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(renderedCells[item.id][columnIndex]){\r\n\t\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\r\n\t\t\t\treturn renderedCells[item.id][columnIndex];\r\n\t\t\t}\r\n\t\t\tvar cell = document.createElement(\"div\");\r\n\t\t\tcell.style.width = (width) + \"px\";\r\n\r\n\t\t\tcssclass = \"gantt_task_cell\" + (columnIndex == count - 1 ? \" gantt_last_cell\" : \"\");\r\n\t\t\tif (cssTemplateContent) {\r\n\t\t\t\tcssclass += \" \" + cssTemplateContent;\r\n\t\t\t}\r\n\t\t\tcell.className = cssclass;\r\n\r\n\t\t\tif (htmlTemplateContent) {\r\n\t\t\t\tcell.innerHTML = htmlTemplateContent;\r\n\t\t\t}\r\n\r\n\t\t\tcell.style.position = \"absolute\";\r\n\t\t\tcell.style.left = scale.left[columnIndex] + \"px\";\r\n\t\t\trenderedCells[item.id][columnIndex] = cell;\r\n\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\r\n\r\n\t\t\treturn cell;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction _render_bg_line(item, view, config, viewPort) {\r\n\t\tvar templates = view.$getTemplates();\r\n\t\tvar cfg = view.getScale();\r\n\t\tvar count = cfg.count;\r\n\r\n\t\tif(config.static_background && !config.static_background_cells){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar row = document.createElement(\"div\");\r\n\r\n\t\tvar cellCssTemplate = getCellClassTemplate(view);\r\n\t\tvar cellHtmlTemplate = getCellContentTemplate(view);\r\n\r\n\t\tvar range;\r\n\r\n\t\tif(!viewPort || !config.smart_rendering || isLegacyRender(gantt)){\r\n\t\t\trange = {\r\n\t\t\t\tstart: 0,\r\n\t\t\t\tend: count - 1\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\trange = getVisibleCellsRange(cfg, viewPort.x);\r\n\t\t}\r\n\t\tif (config.show_task_cells) {\r\n\t\t\trenderedCells[item.id] = {};\r\n\t\t\tvisibleCells[item.id] = {};\r\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\r\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cellCssTemplate, cellHtmlTemplate, config);\r\n\t\t\t\tif(cell){\r\n\t\t\t\t\trow.appendChild(cell);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// GS-291. The odd class should be assigned correctly\r\n\t\tconst store = view.$config.rowStore;\r\n\t\tconst odd = store.getIndexById(item.id) % 2 !== 0;\r\n\r\n\t\tvar cssTemplate = templates.task_row_class(item.start_date, item.end_date, item);\r\n\t\tvar css = \"gantt_task_row\" + (odd ? \" odd\" : \"\") + (cssTemplate ? ' ' + cssTemplate : '');\r\n\r\n\t\tif(store.isSelected(item.id)) {\r\n\t\t\tcss += \" gantt_selected\";\r\n\t\t}\r\n\r\n\t\trow.className = css;\r\n\r\n\t\tif (config.smart_rendering) {\r\n\t\t\trow.style.position = \"absolute\";\r\n\t\t\trow.style.top = view.getItemTop(item.id) + \"px\";\r\n\t\t\trow.style.width = \"100%\";\r\n\t\t}else{\r\n\t\t\trow.style.position = \"relative\";\r\n\t\t}\r\n\t\trow.style.height = (view.getItemHeight(item.id)) + \"px\";\r\n\r\n\t\tif (item.id == \"timeline_placeholder_task\"){\r\n\t\t\tvar placeholderTop = 0;\r\n\t\t\tif (item.lastTaskId){\r\n\t\t\t\tvar lastTaskTop = view.getItemTop(item.lastTaskId);\r\n\t\t\t\tvar lastTaskHeight = view.getItemHeight(item.lastTaskId);\r\n\t\t\t\tplaceholderTop = lastTaskTop + lastTaskHeight;\t\r\n\t\t\t}\r\n\r\n\t\t\tvar maxHeight = item.row_height || view.$task_data.offsetHeight;\r\n\r\n\t\t\tvar placeholderHeight = maxHeight - placeholderTop;\r\n\t\t\t// So that it won't exceed the placeholder timeline height\r\n\t\t\tif (placeholderHeight < 0){\r\n\t\t\t\tplaceholderHeight = 0;\r\n\t\t\t}\r\n\r\n\t\t\tif (config.smart_rendering) {\r\n\t\t\t\trow.style.top = placeholderTop + \"px\";\t\r\n\t\t\t}\r\n\t\t\trow.style.height = placeholderHeight + \"px\";\r\n\t\t}\r\n\r\n\r\n\t\tif(view.$config.item_attribute){\r\n\t\t\trow.setAttribute(view.$config.item_attribute, item.id);\r\n\t\t\trow.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\r\n\t\t}\r\n\r\n\t\treturn row;\r\n\t}\r\n\r\n\treturn {\r\n\t\trender: _render_bg_line,\r\n\t\tupdate: renderCells,\r\n\t\tgetRectangle: getRowRectangle,\r\n\t\tgetVisibleRange: getVisibleRange,\r\n\t\tprepareData: bgPlaceholder\r\n\t};\r\n}\r\n\r\nexport default createTaskBgRender;\r\n","import createBaseBarRender from \"./task_bar_render\";\r\nimport isInViewPort from \"./viewport/is_bar_in_viewport\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\n\r\nfunction createTaskRenderer(gantt){\r\n\tconst defaultRender = createBaseBarRender(gantt);\r\n\r\n\tconst renderedNodes = {};\r\n\r\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\r\n\t\tlet isVisible = true;\r\n\t\t// GS-2123. Don't render rollup tasks that are outside the viewport\r\n\t\tif (config.smart_rendering){\r\n\t\t\tisVisible = isInViewPort(child, viewPort, timeline, config, gantt);\r\n\t\t}\r\n\t\treturn isVisible;\r\n\t}\r\n\r\n\tfunction generateChildElement(task, child, timeline, sizes){\r\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\r\n\t\tchildCopy.$rendered_at = task.id;\r\n\t\t// a way to filter rollup tasks:\r\n\t\tconst displayRollup = gantt.callEvent(\"onBeforeRollupTaskDisplay\", [childCopy.id, childCopy, task.id]);\r\n\t\tif (displayRollup === false){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst element = defaultRender(childCopy, timeline);\r\n\t\tif(!element){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst height = timeline.getBarHeight(task.id, child.type == gantt.config.types.milestone);\r\n\t\tconst padding = Math.floor((timeline.getItemHeight(task.id) - height) / 2);\r\n\r\n\t\telement.style.top = (sizes.top + padding) + \"px\";\r\n\t\telement.classList.add(\"gantt_rollup_child\");\r\n\t\telement.setAttribute(\"data-rollup-parent-id\", task.id);\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tfunction getKey(childId, renderParentId){\r\n\t\treturn childId + \"_\" + renderParentId;\r\n\t}\r\n\r\n\r\n\tfunction renderRollupTask(task, timeline, config, viewPort) {\r\n\t\tif (task.rollup !== false && task.$rollup && task.$rollup.length) {\r\n\t\t\tconst el = document.createElement('div'),\r\n\t\t\t\tsizes = gantt.getTaskPosition(task);\r\n\r\n\t\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\r\n\t\t\tif (viewPort){\r\n\t\t\t\tviewPort.y = 0;\r\n\t\t\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\r\n\t\t\t}\r\n\r\n\t\t\ttask.$rollup.forEach(function(itemId){\r\n\t\t\t\tif (!gantt.isTaskExists(itemId)){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst child = gantt.getTask(itemId);\r\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\r\n\t\t\t\tif (!isVisible){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\r\n\t\t\t\tif (element) {\r\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\r\n\t\t\t\t\tel.appendChild(element);\r\n\t\t\t\t} else{\r\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\treturn el;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfunction repaintRollupTask(task, itemNode, timeline, config, viewPort) {\r\n\t\tconst el = document.createElement(\"div\"),\r\n\t\tsizes = gantt.getTaskPosition(task);\r\n\r\n\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\r\n\t\tviewPort.y = 0;\r\n\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\r\n\r\n\t\ttask.$rollup.forEach(function(itemId){\r\n\t\t\tconst child = gantt.getTask(itemId);\r\n\t\t\tconst rollupKey = getKey(child.id, task.id);\r\n\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\r\n\t\t\tif (isVisible !== !!renderedNodes[rollupKey]) {\r\n\r\n\t\t\t\tif (isVisible) {\r\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\r\n\t\t\t\t\trenderedNodes[rollupKey] = element || false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\trenderedNodes[rollupKey] = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!!renderedNodes[rollupKey]) {\r\n\t\t\t\tel.appendChild(renderedNodes[rollupKey]);\r\n\t\t\t}\r\n\t\t\titemNode.innerHTML = \"\";\r\n\t\t\titemNode.appendChild(el);\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\treturn {\r\n\t\trender: renderRollupTask,\r\n\t\tupdate: repaintRollupTask,\r\n\t\t//getRectangle: getBarRectangle\r\n\t\tisInViewPort: isInViewPort,\r\n\t\tgetVisibleRange: getVisibleRange\r\n\t};\r\n}\r\n\r\nexport default createTaskRenderer;","import getRectangle from \"./viewport/get_bg_row_rectangle\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\r\nimport isColumnVisible from \"./viewport/is_column_visible\";\r\nimport resourceTimetable from \"../../resource_timetable_builder\";\r\n\r\nfunction generateRenderResourceLine(gantt){\r\n\tvar getResourceLoad = resourceTimetable(gantt);\r\n\tvar renderedResourceLines = {};\r\n\r\n\tfunction renderResourceLineCell(resource, day, templates, config, timeline){\r\n\t\tvar css = templates.resource_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\r\n\t\tvar content = templates.resource_cell_value(day.start_date, day.end_date, resource, day.tasks, day.assignments);\r\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\r\n\r\n\t\tif (css || content){\r\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\r\n\t\t\tvar el = document.createElement('div');\r\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\r\n\t\t\tel.className = [\"gantt_resource_marker\", css].join(\" \");\r\n\r\n\t\t\tel.style.cssText = [\r\n\t\t\t\t'left:' + sizes.left + 'px',\r\n\t\t\t\t'width:' + sizes.width + 'px',\r\n\t\t\t\t'height:' + (height) + 'px',\r\n\t\t\t\t'line-height:' + (height) + 'px',\r\n\t\t\t\t'top:' + sizes.top + 'px'\r\n\t\t\t].join(\";\");\r\n\r\n\t\t\tif(content)\r\n\t\t\t\tel.innerHTML = content;\r\n\r\n\t\t\treturn el;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tfunction detachRenderedResourceLine(id, index){\r\n\t\tif(renderedResourceLines[id] && renderedResourceLines[id][index] &&\r\n\t\t\trenderedResourceLines[id][index].parentNode\r\n\t\t\t){\r\n\t\t\t\trenderedResourceLines[id][index].parentNode.removeChild(renderedResourceLines[id][index]);\r\n\t\t\t}\r\n\t}\r\n\r\n\tfunction renderResourceLine(resource, timeline, config, viewport) {\r\n\t\tvar templates = timeline.$getTemplates();\r\n\t\tvar scale = timeline.getScale();\r\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\r\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\r\n\t\tvar cells = [];\r\n\t\trenderedResourceLines[resource.id] = {};\r\n\r\n\t\tvar range = getVisibleCellsRange(scale, viewport);\r\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\r\n\r\n\t\t\tvar day = timetable[columnIndex];\r\n\t\t\tif(!day){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\r\n\t\t\tif(cell){\r\n\t\t\t\tcells.push(cell);\r\n\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar row = null;\r\n\t\tif(cells.length){\r\n\t\t\trow = document.createElement(\"div\");\r\n\t\t\tfor(var i = 0; i < cells.length; i++){\r\n\t\t\t\trow.appendChild(cells[i]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn row;\r\n\t}\r\n\r\n\tfunction updateResourceLine(resource, node, timeline, config, viewport) {\r\n\t\tvar templates = timeline.$getTemplates();\r\n\t\tvar scale = timeline.getScale();\r\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\r\n\r\n\t\tvar range = getVisibleCellsRange(scale, viewport);\r\n\r\n\t\tvar checkedColumns = {};\r\n\t\tif(renderedResourceLines && renderedResourceLines[resource.id]){\r\n\t\t\tfor(var i in renderedResourceLines[resource.id]){\r\n\t\t\t\tcheckedColumns[i] = i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\r\n\t\t\tvar day = timetable[columnIndex];\r\n\t\t\tcheckedColumns[columnIndex] = false;\r\n\t\t\tif(!day){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(!isColumnVisible(columnIndex, scale, viewport, gantt)){\r\n\t\t\t\tdetachRenderedResourceLine(resource.id, columnIndex);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif(!renderedResourceLines[resource.id] || !renderedResourceLines[resource.id][columnIndex]){\r\n\t\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\r\n\t\t\t\tif(cell){\r\n\t\t\t\t\tnode.appendChild(cell);\r\n\t\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if(renderedResourceLines[resource.id] && renderedResourceLines[resource.id][columnIndex] && !renderedResourceLines[resource.id][columnIndex].parentNode){\r\n\t\t\t\tnode.appendChild(renderedResourceLines[resource.id][columnIndex]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor(var i in checkedColumns){\r\n\t\t\tif(checkedColumns[i] !== false){\r\n\t\t\t\tdetachRenderedResourceLine(resource.id, i);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\trender: renderResourceLine,\r\n\t\tupdate: updateResourceLine,\r\n\t\tgetRectangle: getRectangle,\r\n\t\tgetVisibleRange: getVisibleRange\r\n\t};\r\n}\r\n\r\nexport default generateRenderResourceLine;","import getRowRectangle from \"./viewport/get_grid_row_rectangle\";\r\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\r\n\r\nfunction createGridTaskRowResizerRender(gantt){\r\n\r\n\tfunction _render_grid_item(item, view, viewport) {\r\n\r\n\t\tvar config = view.$getConfig();\r\n\t\tvar resize_el = document.createElement(\"div\");\r\n\t\tresize_el.className = \"gantt_task_grid_row_resize_wrap\";\r\n\r\n\t\tresize_el.style.top = (view.getItemTop(item.id) + view.getItemHeight(item.id)) + \"px\";\r\n\r\n\t\tresize_el.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\";\r\n\t\tresize_el.setAttribute(config.task_grid_row_resizer_attribute, item.id);\r\n\r\n\t\tgantt._waiAria.rowResizerAttr(resize_el);\r\n\t\treturn resize_el;\r\n\t}\r\n\r\n\treturn {\r\n\t\trender: _render_grid_item,\r\n\t\tupdate: null,\r\n\t\tgetRectangle: getRowRectangle,\r\n\t\tgetVisibleRange: getVisibleRange\r\n\t};\r\n}\r\n\r\nexport default createGridTaskRowResizerRender;","function _configure(col, data, force) {\r\n\tfor (var key in data)\r\n\t\tif (typeof col[key] == \"undefined\" || force)\r\n\t\t\tcol[key] = data[key];\r\n}\r\n\r\nfunction _get_skin(force, gantt) {\r\n\r\n\tconst styles = getComputedStyle(gantt.$root);\r\n\tconst themeVar = styles.getPropertyValue(\"--dhx-gantt-theme\");\r\n\tlet isCssVarTheme = !!themeVar;\r\n\tlet themeName;\r\n\r\n\t\r\n\tif(isCssVarTheme){\r\n\t\tthemeName = themeVar;\r\n\t}else{\r\n\t\tvar skin = gantt.skin;\r\n\t\tthemeName = skin;\r\n\t\tif (!skin || force) {\r\n\t\t\tvar links = document.getElementsByTagName(\"link\");\r\n\t\t\tfor (var i = 0; i < links.length; i++) {\r\n\t\t\t\tvar res = links[i].href.match(\"dhtmlxgantt_([a-z_]+).css\");\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\tif (gantt.skins[res[1]] || !skin) {\r\n\t\t\t\t\t\tthemeName = res[1];\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tgantt._theme_info = {\r\n\t\ttheme: themeName,\r\n\t\tcssVarTheme: isCssVarTheme\r\n\t};\r\n\r\n\r\n\r\n\tgantt.skin = themeName || \"terrace\";\r\n\tvar skinset = gantt.skins[gantt.skin] || gantt.skins[\"terrace\"];\r\n\r\n\t//apply skin related settings\r\n\t_configure(gantt.config, skinset.config, force);\r\n\r\n\tif(!isCssVarTheme){\r\n\t\tgantt.config.link_radius = 1;\r\n\t}\r\n\r\n\tvar config = gantt.getGridColumns();\r\n\tif (config[1] && !gantt.defined(config[1].width))\r\n\t\tconfig[1].width = skinset._second_column_width;\r\n\tif (config[2] && !gantt.defined(config[2].width))\r\n\t\tconfig[2].width = skinset._third_column_width;\r\n\t\r\n\tfor (var i=0; i<config.length; i++) {\r\n\t\tvar column = config[i];\r\n\t\tif (column.name == \"add\") {\r\n\t\t\tif(!column.width){\r\n\t\t\t\tcolumn.width = 44;\r\n\t\t\t}\r\n\t\t\tif (!(gantt.defined(column.min_width) && gantt.defined(column.max_width))) {\r\n\t\t\t\tcolumn.min_width = column.min_width || column.width;\r\n\t\t\t\tcolumn.max_width = column.max_width || column.width;\r\n\t\t\t}\r\n\t\t\tif (column.min_width)\r\n\t\t\t\tcolumn.min_width = +column.min_width;\r\n\t\t\tif (column.max_width)\r\n\t\t\t\tcolumn.max_width = +column.max_width;\r\n\t\t\tif (column.width) {\r\n\t\t\t\tcolumn.width = +column.width;\r\n\t\t\t\tcolumn.width = (column.min_width && column.min_width > column.width) ? column.min_width : column.width;\r\n\t\t\t\tcolumn.width = (column.max_width && column.max_width < column.width) ? column.max_width : column.width;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (skinset.config.task_height){\r\n\t\tgantt.config.task_height = skinset.config.task_height || \"full\";\r\n\t}\r\n\tif (skinset.config.bar_height){\r\n\t\tgantt.config.bar_height = skinset.config.bar_height || \"full\";\r\n\t}\r\n\r\n\tif (skinset._lightbox_template)\r\n\t\tgantt._lightbox_template = skinset._lightbox_template;\r\n\r\n\tif (skinset._redefine_lightbox_buttons) {\r\n\t\tgantt.config.buttons_right = skinset._redefine_lightbox_buttons[\"buttons_right\"];\r\n\t\tgantt.config.buttons_left = skinset._redefine_lightbox_buttons[\"buttons_left\"];\r\n\t}\r\n\r\n\r\n\tgantt.resetLightbox();\r\n}\r\n\r\n\r\n\r\nexport default function(gantt) {\r\n\t\r\n\tif(!gantt.resetSkin){\r\n\t\tgantt.resetSkin = function () {\r\n\t\t\tthis.skin = \"\";\r\n\t\t\t_get_skin(true, this);\r\n\t\t};\r\n\t\tgantt.skins = {};\r\n\r\n\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\r\n\t\t\t_get_skin(false, this);\r\n\t\t\tmonitorThemeChange();\r\n\t\t});\r\n\t}\r\n\r\n\tgantt._addThemeClass = function(){\r\n\t\tdocument.documentElement.setAttribute(\"data-gantt-theme\", gantt.skin);\r\n\t};\r\n\r\n\tgantt.setSkin = function(value){\r\n\t\tconst skinChanged = this.skin !== value;\r\n\t\tthis.skin = value;\r\n\t\tgantt._addThemeClass();\r\n\t\tmonitorThemeChange();\r\n\t\tif(gantt.$root){\r\n\t\t\t_get_skin(skinChanged ? false : true, gantt);\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t\t\r\n\t\t//\r\n\t};\r\n\r\n\r\n\tlet monitorIntervalId = null;\r\n\tfunction monitorThemeChange(){\r\n\t\tconst container = gantt.$root;\r\n\t\t\r\n\t\tif(monitorIntervalId){\r\n\t\t\tclearInterval(monitorIntervalId);\r\n\t\t}\r\n\t\t\r\n\t\tif(container){\r\n\t\t\tmonitorIntervalId = setInterval(() => {\r\n\t\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-gantt-theme');\r\n\t\t\t\tif(csstheme && csstheme !== gantt.skin){\r\n\t\t\t\t\tgantt.setSkin(csstheme);\r\n\t\t\t\t}\r\n\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t}\r\n\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\tclearInterval(monitorIntervalId);\r\n\t});\r\n};","import * as domHelpers from \"../utils/dom_helpers\";\r\nimport isHeadless from \"../../../utils/is_headless\";\r\n\r\nexport default function(gantt){\r\n\r\n\tvar scrollRange = 50,\r\n\t\tscrollStep = 30,\r\n\t\tscrollDelay = 10,\r\n\t\tscrollSpeed = 50;\r\n\r\n\tvar interval = null,\r\n\t\tisMove = false,\r\n\t\tdelayTimeout = null,\r\n\t\tstartPos = {\r\n\t\t\tstarted: false\r\n\t\t},\r\n\t\teventPos = {};\r\n\r\n\r\n\tfunction isDisplayed(element){\r\n\t\treturn element &&\r\n\t\t\tdomHelpers.isChildOf(element, gantt.$root) &&\r\n\t\t\telement.offsetHeight;\r\n\t}\r\n\r\n\tfunction getAutoscrollContainer(){\r\n\t\tvar element;\r\n\t\tif(isDisplayed(gantt.$task)){\r\n\t\t\telement = gantt.$task;\r\n\t\t}else if(isDisplayed(gantt.$grid)){\r\n\t\t\telement = gantt.$grid;\r\n\t\t}else{\r\n\t\t\telement = gantt.$root;\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\t}\r\n\r\n\tfunction isScrollState() {\r\n\t\tvar dragMarker = !!document.querySelector(\".gantt_drag_marker\");\r\n\t\tvar isResize = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\")\r\n\t\t\t|| !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\") ;\r\n\t\tvar isLink = !!document.querySelector(\".gantt_link_direction\");\r\n\t\tvar state = gantt.getState();\r\n\t\tvar isClickDrag = state.autoscroll;\r\n\t\tisMove = dragMarker && !isResize && !isLink;\r\n\r\n\t\treturn !((!state.drag_mode && !dragMarker) || isResize) || isClickDrag;\r\n\t}\r\n\r\n\tfunction defineDelayTimeout(state) {\r\n\t\tif (delayTimeout) {\r\n\t\t\tclearTimeout(delayTimeout);\r\n\t\t\tdelayTimeout = null;\r\n\t\t}\r\n\t\tif (state) {\r\n\t\t\tvar speed = gantt.config.autoscroll_speed;\r\n\t\t\tif (speed && speed < 10) // limit speed value to 10\r\n\t\t\t\tspeed = 10;\r\n\r\n\t\t\tdelayTimeout = setTimeout(function() {\r\n\t\t\t\tinterval = setInterval(tick, speed || scrollSpeed);\r\n\t\t\t}, gantt.config.autoscroll_delay || scrollDelay);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction defineScrollInterval(state) {\r\n\t\tif (state) {\r\n\t\t\tdefineDelayTimeout(true);\r\n\t\t\tif (!startPos.started) {\r\n\t\t\t\tstartPos.x = eventPos.x;\r\n\t\t\t\tstartPos.y = eventPos.y;\r\n\t\t\t\tstartPos.started = true;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (interval) {\r\n\t\t\t\tclearInterval(interval);\r\n\t\t\t\tinterval = null;\r\n\t\t\t}\r\n\t\t\tdefineDelayTimeout(false);\r\n\t\t\tstartPos.started = false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction autoscrollInterval(event) {\r\n\t\tvar isScroll = isScrollState();\r\n\r\n\t\tif ((interval || delayTimeout) && !isScroll) {\r\n\t\t\tdefineScrollInterval(false);\r\n\t\t}\r\n\r\n\t\tif (!gantt.config.autoscroll || !isScroll) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\teventPos = {\r\n\t\t\tx: event.clientX,\r\n\t\t\ty: event.clientY\r\n\t\t};\r\n\r\n\t\t// if it is a mobile device, we need to detect the touch event coords\r\n\t\tif (event.type == \"touchmove\"){\r\n\t\t\teventPos.x = event.targetTouches[0].clientX;\r\n\t\t\teventPos.y = event.targetTouches[0].clientY;\r\n\t\t}\r\n\r\n\t\tif (!interval && isScroll) {\r\n\t\t\tdefineScrollInterval(true);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction tick() {\r\n\r\n\t\tif (!isScrollState()) {\r\n\t\t\tdefineScrollInterval(false);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar container = getAutoscrollContainer();\r\n\t\tif(!container){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\r\n\t\tvar gridDrag = false;\r\n\t\tvar gridMarkers = [\r\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\r\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\r\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\r\n\t\t];\r\n\t\tgridMarkers.forEach(function (selector) {\r\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\r\n\t\t});\r\n\t\tif (gridDrag){\r\n\t\t\tcontainer = gantt.$grid;\r\n\t\t}\r\n\r\n\t\tvar box = domHelpers.getNodePosition(container);\r\n\r\n\t\tvar posX = eventPos.x - box.x;\r\n\t\tvar posY = eventPos.y - box.y + window.scrollY; // GS-1315: window.scrollY here and below for the elements above Gantt\r\n\r\n\t\tvar scrollLeft = isMove ? 0 : need_scroll(posX, box.width, startPos.x - box.x);\r\n\t\tvar scrollTop = need_scroll(posY, box.height, startPos.y - box.y + window.scrollY);\r\n\r\n\t\tvar scrollState = gantt.getScrollState();\r\n\r\n\t\tvar currentScrollTop = scrollState.y,\r\n\t\t\tscrollOuterHeight = scrollState.inner_height,\r\n\t\t\tscrollInnerHeight = scrollState.height,\r\n\t\t\tcurrentScrollLeft = scrollState.x,\r\n\t\t\tscrollOuterWidth = scrollState.inner_width,\r\n\t\t\tscrollInnerWidth = scrollState.width;\r\n\r\n\t\t// do scrolling only if we have scrollable area to do so\r\n\t\tif (scrollTop && !scrollOuterHeight) {\r\n\t\t\tscrollTop = 0;\r\n\t\t} else if (scrollTop < 0 && !currentScrollTop) {\r\n\t\t\tscrollTop = 0;\r\n\t\t} else if (scrollTop > 0 && currentScrollTop + scrollOuterHeight >= scrollInnerHeight + 2) {\r\n\t\t\tscrollTop = 0;\r\n\t\t}\r\n\r\n\t\tif (scrollLeft && !scrollOuterWidth) {\r\n\t\t\tscrollLeft = 0;\r\n\t\t} else if (scrollLeft < 0 && !currentScrollLeft) {\r\n\t\t\tscrollLeft = 0;\r\n\t\t} else if (scrollLeft > 0 && currentScrollLeft + scrollOuterWidth >= scrollInnerWidth) {\r\n\t\t\tscrollLeft = 0;\r\n\t\t}\r\n\r\n\t\tvar step = gantt.config.autoscroll_step;\r\n\r\n\t\tif (step && step < 2) // limit step value to 2\r\n\t\t\tstep = 2;\r\n\r\n\t\tscrollLeft = scrollLeft * (step || scrollStep);\r\n\t\tscrollTop = scrollTop * (step || scrollStep);\r\n\r\n\t\tif (scrollLeft || scrollTop) {\r\n\t\t\tscroll(scrollLeft, scrollTop);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction need_scroll(pos, boxSize, startCoord) {\r\n\t\tif ((pos - scrollRange < 0) && (pos < startCoord))\r\n\t\t\treturn -1;\r\n\t\telse if ((pos > boxSize - scrollRange) && (pos > startCoord))\r\n\t\t\treturn 1;\r\n\t\treturn 0;\r\n\t}\r\n\r\n\tfunction scroll(left, top) {\r\n\t\tvar scrollState = gantt.getScrollState();\r\n\r\n\t\tvar scrollLeft = null,\r\n\t\t\tscrollTop = null;\r\n\r\n\t\tif (left) {\r\n\t\t\tscrollLeft = scrollState.x + left;\r\n\t\t\tscrollLeft = Math.min(scrollState.width, scrollLeft);\r\n\t\t\tscrollLeft = Math.max(0, scrollLeft);\r\n\t\t}\r\n\r\n\t\tif (top) {\r\n\t\t\tscrollTop = scrollState.y + top;\r\n\t\t\tscrollTop = Math.min(scrollState.height, scrollTop);\r\n\t\t\tscrollTop = Math.max(0, scrollTop);\r\n\t\t}\r\n\r\n\t\tgantt.scrollTo(scrollLeft, scrollTop);\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onGanttReady\", function() {\r\n\t\tif(!isHeadless(gantt)){\r\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\r\n\t\t\tgantt.eventRemove(eventElement, \"mousemove\", autoscrollInterval);\r\n\t\t\tgantt.event(eventElement, \"mousemove\", autoscrollInterval);\r\n\r\n\t\t\tgantt.eventRemove(eventElement, \"touchmove\", autoscrollInterval);\r\n\t\t\tgantt.event(eventElement, \"touchmove\", autoscrollInterval);\r\n\r\n\t\t\tgantt.eventRemove(eventElement, \"pointermove\", autoscrollInterval);\r\n\t\t\tgantt.event(eventElement, \"pointermove\", autoscrollInterval);\r\n\t\t}\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onDestroy\", function(){\r\n\t\tdefineScrollInterval(false);\r\n\t});\r\n\r\n};","if (typeof window !== \"undefined\" && window.jQuery){\r\n\r\n\t(function( $ ){\r\n\r\n\t\tvar methods = [];\r\n\t\t$.fn.dhx_gantt = function(config){\r\n\t\t\tconfig = config || {};\r\n\t\t\tif (typeof(config) === 'string') {\r\n\t\t\t\tif (methods[config] ) {\r\n\t\t\t\t\treturn methods[config].apply(this, []);\r\n\t\t\t\t}else {\r\n\t\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_gantt');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar views = [];\r\n\t\t\t\tthis.each(function() {\r\n\t\t\t\t\tif (this && this.getAttribute){\r\n\t\t\t\t\t\tif (!this.gantt && !(window.gantt.$root == this)){\r\n\r\n\t\t\t\t\t\t\tvar newgantt = (window.gantt.$container && window.Gantt) ? window.Gantt.getGanttInstance():window.gantt;\r\n\t\t\t\t\t\t\tfor (var key in config)\r\n\t\t\t\t\t\t\t\tif (key!=\"data\")\r\n\t\t\t\t\t\t\t\t\tnewgantt.config[key] = config[key];\r\n\r\n\t\t\t\t\t\t\tnewgantt.init(this);\r\n\t\t\t\t\t\t\tif (config.data)\r\n\t\t\t\t\t\t\t\tnewgantt.parse(config.data);\r\n\r\n\t\t\t\t\t\t\tviews.push(newgantt);\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tviews.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\r\n\t\t\t\tif (views.length === 1) return views[0];\r\n\t\t\t\treturn views;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t})(window.jQuery);\r\n\r\n}\r\n\r\n\r\nexport default null;","if (typeof window !== \"undefined\" && window.dhtmlx){\r\n\r\n\tif (!window.dhtmlx.attaches)\r\n\twindow.dhtmlx.attaches = {};\r\n\r\n\twindow.dhtmlx.attaches.attachGantt=function(start, end, gantt){\r\n\t\tvar obj = document.createElement(\"DIV\");\r\n\r\n\t\tgantt = gantt || window.gantt;\r\n\r\n\t\tobj.id = \"gantt_\"+ gantt.uid();\r\n\t\tobj.style.width = \"100%\";\r\n\t\tobj.style.height = \"100%\";\r\n\t\tobj.cmp = \"grid\";\r\n\r\n\t\tdocument.body.appendChild(obj);\r\n\t\tthis.attachObject(obj.id);\r\n\t\tthis.dataType = \"gantt\";\r\n\t\tthis.dataObj = gantt;\r\n\r\n\t\tvar that = this.vs[this.av];\r\n\t\tthat.grid = gantt;\r\n\r\n\t\tgantt.init(obj.id, start, end);\r\n\t\tobj.firstChild.style.border = \"none\";\r\n\r\n\t\tthat.gridId = obj.id;\r\n\t\tthat.gridObj = obj;\r\n\r\n\t\tvar method_name=\"_viewRestore\";\r\n\t\treturn this.vs[this[method_name]()].grid;\r\n\t};\r\n\r\n}\r\nif (typeof window !== \"undefined\" && typeof(window.dhtmlXCellObject) != \"undefined\") {\r\n\r\n\twindow.dhtmlXCellObject.prototype.attachGantt=function(start, end, gantt){\r\n\t\tgantt = gantt || window.gantt;\r\n\r\n\t\tvar obj = document.createElement(\"DIV\");\r\n\t\tobj.id = \"gantt_\"+gantt.uid();\r\n\t\tobj.style.width = \"100%\";\r\n\t\tobj.style.height = \"100%\";\r\n\t\tobj.cmp = \"grid\";\r\n\r\n\t\tdocument.body.appendChild(obj);\r\n\t\tthis.attachObject(obj.id);\r\n\r\n\t\tthis.dataType = \"gantt\";\r\n\t\tthis.dataObj = gantt;\r\n\r\n\t\tgantt.init(obj.id, start, end);\r\n\t\tobj.firstChild.style.border = \"none\";\r\n\r\n\t\tobj = null;\r\n\t\tthis.callEvent(\"_onContentAttach\",[]);\r\n\r\n\t\treturn this.dataObj;\r\n\t};\r\n}\r\n\r\nexport default null;","import env from \"../../../utils/env\";\r\nimport eventable from \"../../../utils/eventable\";\r\nimport { IScale, TModifierKeys } from \"../../common/config\";\r\n\r\ninterface ITimelineZoomConfig {\r\n\thandler?: (e: Event) => {};\r\n\tstartDate?: Date;\r\n\tendDate?: Date;\r\n\tlevels: IZoomLevel[];\r\n\tactiveLevelIndex?: number;\r\n\twidthStep?: number;\r\n\tminColumnWidth?: number;\r\n\tmaxColumnWidth?: number;\r\n\tuseKey?: \"ctrlKey\" | \"altKey\" | \"shiftKey\";\r\n\ttrigger?: \"wheel\" | null | undefined;\r\n\telement?: Element | (() => Element);\r\n}\r\n\r\nconst USE_KEY = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"];\r\n\r\ninterface IZoomLevel {\r\n\tname?: string;\r\n\tscale_height?: number;\r\n\tmin_column_width: number;\r\n\tscales: IScale[];\r\n}\r\n\r\nconst _defaultScales = [\r\n\t[\r\n\t\t{\r\n\t\t\tunit: \"month\",\r\n\t\t\tdate: \"%M\",\r\n\t\t\tstep: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\tunit: \"day\",\r\n\t\t\tdate: \"%d\",\r\n\t\t\tstep: 1\r\n\t\t}\r\n\t],\r\n\t[\r\n\t\t{\r\n\t\t\tunit: \"day\",\r\n\t\t\tdate: \"%d %M\",\r\n\t\t\tstep: 1\r\n\t\t}\r\n\t],\r\n\t[\r\n\t\t{\r\n\t\t\tunit: \"day\",\r\n\t\t\tdate: \"%d %M\",\r\n\t\t\tstep: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\tunit: \"hour\",\r\n\t\t\tdate: \"%H:00\",\r\n\t\t\tstep: 8\r\n\t\t}\r\n\t],\r\n\t[\r\n\t\t{\r\n\t\t\tunit: \"day\",\r\n\t\t\tdate: \"%d %M\",\r\n\t\t\tstep: 1\r\n\t\t},\r\n\t\t{\r\n\t\t\tunit: \"hour\",\r\n\t\t\tdate: \"%H:00\",\r\n\t\t\tstep: 1\r\n\t\t}\r\n\t]\r\n];\r\n\r\nexport default class TimelineZoom {\r\n\tpublic attachEvent: (eventName: string, handler: () => void) => string;\r\n\tpublic callEvent: (eventName: string, args: any[]) => any;\r\n\tpublic detachEvent: (eventName: string) => any;\r\n\tprotected _initialStartDate: Date;\r\n\tprotected _initialEndDate: Date;\r\n\tprotected _activeLevelIndex: number;\r\n\tprotected _levels: IZoomLevel[];\r\n\tprotected _handler: (e: any) => void;\r\n\tprotected $gantt;\r\n\tprotected _widthStep: number;\r\n\tprotected _minColumnWidth: number;\r\n\tprotected _maxColumnWidth: number;\r\n\tprotected _useKey: TModifierKeys;\r\n\tprotected _visibleDate: Date;\r\n\tprotected _initialized: boolean;\r\n\tprotected _domEvents: any;\r\n\r\n\tconstructor(gantt) {\r\n\t\tthis.$gantt = gantt;\r\n\t\tthis._domEvents = this.$gantt._createDomEventScope();\r\n\t}\r\n\r\n\tpublic init(config: ITimelineZoomConfig) {\r\n\t\t// GS-1354 and GS-1318. If we check the headless mode using the function,\r\n\t\t// it will return false when Gantt is not initialized, but we may want to do it later\r\n\t\tif(this.$gantt.env.isNode){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._initialStartDate = config.startDate;\r\n\t\tthis._initialEndDate = config.endDate;\r\n\t\tthis._activeLevelIndex = config.activeLevelIndex ? config.activeLevelIndex : 0;\r\n\t\tthis._levels = this._mapScales(config.levels || _defaultScales);\r\n\t\tthis._handler = config.handler || this._defaultHandler;\r\n\t\tthis._minColumnWidth = config.minColumnWidth || 60;\r\n\t\tthis._maxColumnWidth = config.maxColumnWidth || 240;\r\n\t\tthis._widthStep = config.widthStep || 3/8 * config.minColumnWidth;\r\n\t\tthis._useKey = config.useKey;\r\n\r\n\t\tif(!this._initialized){\r\n\t\t\teventable(this);\r\n\t\t\tthis.$gantt.attachEvent(\"onGanttScroll\", () => {\r\n\t\t\t\tthis._getVisibleDate();\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis._domEvents.detachAll();\r\n\r\n\t\tif(config.trigger === \"wheel\"){\r\n\t\t\tif(this.$gantt.$root){\r\n\t\t\t\tthis._attachWheelEvent(config);\r\n\t\t\t}else{\r\n\t\t\t\t// GS-1322. This way the handler works for the init and resetLayout methods\r\n\t\t\t\tthis.$gantt.attachEvent(\"onGanttLayoutReady\", () => {\r\n\t\t\t\t\tthis.$gantt.attachEvent(\"onGanttRender\", () => {\r\n\t\t\t\t\t\tthis._attachWheelEvent(config);\r\n\t\t\t\t\t}, {once: true});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._initialized = true;\r\n\t\tthis.setLevel(this._activeLevelIndex);\r\n\t}\r\n\r\n\tpublic zoomIn = () => {\r\n\t\tconst index = this.getCurrentLevel() - 1;\r\n\t\tif(index < 0){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.setLevel(index);\r\n\t};\r\n\r\n\tpublic zoomOut = () => {\r\n\t\tconst index = this.getCurrentLevel() + 1;\r\n\t\tif(index > this._levels.length - 1){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.setLevel(index);\r\n\t};\r\n\r\n\tpublic getCurrentLevel = () => {\r\n\t\treturn this._activeLevelIndex;\r\n\t};\r\n\r\n\tpublic getLevels = () => {\r\n\t\treturn this._levels;\r\n\t};\r\n\r\n\tpublic setLevel = (level: number|string) => {\r\n\t\tconst zoomLevel = this._getZoomIndexByName(level);\r\n\r\n\t\tif(zoomLevel === -1){\r\n\t\t\tthis.$gantt.assert(zoomLevel !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + level + \" is not an expected value.\");\r\n\t\t}\r\n\t\tthis._setLevel(zoomLevel, 0);\r\n\t};\r\n\r\n\tprotected _getZoomIndexByName = (levelName: number|string) => {\r\n\t\tlet zoomLevel:number = -1;\r\n\t\tif(typeof levelName === \"string\"){\r\n\t\t\tif(!isNaN(Number(levelName)) &&  this._levels[Number(levelName)]){\r\n\t\t\t\tzoomLevel = Number(levelName);\r\n\t\t\t}else{\r\n\t\t\t\tfor(let i = 0; i < this._levels.length; i++){\r\n\t\t\t\t\tif(this._levels[i].name === levelName){\r\n\t\t\t\t\t\tzoomLevel = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tzoomLevel = levelName;\r\n\t\t}\r\n\t\treturn zoomLevel;\r\n\t};\r\n\r\n\tprotected _mapScales(levels: IScale[][] | any): IZoomLevel[]{\r\n\t\treturn levels.map((l) => {\r\n\t\t\tif(Array.isArray(l)){\r\n\t\t\t\treturn {\r\n\t\t\t\t\tscales: l\r\n\t\t\t\t};\r\n\t\t\t}else{\r\n\t\t\t\treturn l;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprotected _getVisibleDate = () => {\r\n\t\t// GS-1450. Don't try to get the visible date if there is no timeline\r\n\t\tif (!this.$gantt.$task){\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst scrollPos = this.$gantt.getScrollState().x;\r\n\t\tconst viewPort = this.$gantt.$task.offsetWidth;\r\n\t\tthis._visibleDate = this.$gantt.dateFromPos(scrollPos + viewPort/2);\r\n\t};\r\n\r\n\tprotected _setLevel = (level: number, cursorOffset: number) => {\r\n\t\tthis._activeLevelIndex = level;\r\n\r\n\t\tconst gantt = this.$gantt;\r\n\t\tconst nextConfig = gantt.copy(this._levels[this._activeLevelIndex]);\r\n\t\tconst chartConfig = gantt.copy(nextConfig);\r\n\t\tdelete chartConfig.name;\r\n\r\n\t\tgantt.mixin(gantt.config, chartConfig, true);\r\n\r\n\t\t// GS-1148: Change scales for the resource views\r\n\t\tconst resourceViews = [\r\n\t\t\t\"resourceTimeline\",\r\n\t\t\t\"resourceHistogram\"\r\n\t\t];\r\n\r\n\t\tresourceViews.forEach(function(name){\r\n\t\t\tconst resourceView = gantt.$ui.getView(name);\r\n\t\t\tif (resourceView){\r\n\t\t\t\tconst resourceConfig = resourceView.$getConfig();\r\n\t\t\t\tif (!resourceConfig.fixed_scales){\r\n\t\t\t\t\tgantt.mixin(resourceConfig, chartConfig, true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst isRendered = !!gantt.$root && !!gantt.$task;\r\n\r\n\t\tif(isRendered){\r\n\t\t\tif(cursorOffset){\r\n\t\t\t\tconst cursorDate = this.$gantt.dateFromPos(cursorOffset + this.$gantt.getScrollState().x);\r\n\t\t\t\tthis.$gantt.render();\r\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(cursorDate);\r\n\t\t\t\tthis.$gantt.scrollTo(newPosition - cursorOffset);\r\n\t\t\t}else{\r\n\t\t\t\tconst viewPort = this.$gantt.$task.offsetWidth;\r\n\t\t\t\tif(!this._visibleDate){\r\n\t\t\t\t\tthis._getVisibleDate();\r\n\t\t\t\t}\r\n\t\t\t\tconst middleDate = this._visibleDate;\r\n\t\t\t\tthis.$gantt.render();\r\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(middleDate);\r\n\t\t\t\tthis.$gantt.scrollTo(newPosition - viewPort/2);\r\n\t\t\t}\r\n\r\n\t\t\tthis.callEvent(\"onAfterZoom\", [this._activeLevelIndex, nextConfig]);\r\n\t\t}\r\n\t};\r\n\r\n\tprivate _attachWheelEvent = (config) => {\r\n\t\tconst event = env.isFF ? \"wheel\" : \"mousewheel\";\r\n\t\tlet el: Element;\r\n\t\tif(typeof config.element === \"function\"){\r\n\t\t\tel = config.element();\r\n\t\t}else{\r\n\t\t\tel = config.element as Element;\r\n\t\t}\r\n\t\tif (!el){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._domEvents.attach(el, event, this.$gantt.bind(function(e) {\r\n\t\t\tif (this._useKey) {\r\n\t\t\t\tif (USE_KEY.indexOf(this._useKey) < 0) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (!e[this._useKey]) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (typeof this._handler === \"function\") {\r\n\t\t\t\tthis._handler.apply(this, [e]);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}, this), {passive: false});\r\n\t};\r\n\r\n\tprivate _defaultHandler = (e: any):void => {\r\n\t\tconst timelineOffset = this.$gantt.$task.getBoundingClientRect().x;\r\n\t\tconst cursorOffset = e.clientX - timelineOffset;\r\n\t\tconst wheelY = this.$gantt.env.isFF ? (e.deltaY*-40) : e.wheelDelta;\r\n\t\tlet wheelUp = false;\r\n\t\tif (wheelY > 0) {\r\n\t\t\twheelUp = true;\r\n\t\t}\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t\tthis._setScaleSettings(wheelUp, cursorOffset);\r\n\t};\r\n\r\n\tprivate _setScaleSettings(wheelUp: boolean, cursorOffset: number) {\r\n\t\tif (wheelUp) {\r\n\t\t\tthis._stepUp(cursorOffset);\r\n\t\t} else {\r\n\t\t\tthis._stepDown(cursorOffset);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _setScaleDates = () => {\r\n\t\tif(this._initialStartDate && this._initialEndDate){\r\n\t\t\tthis.$gantt.config.start_date = this._initialStartDate;\r\n\t\t\tthis.$gantt.config.end_date = this._initialEndDate;\r\n\t\t}\r\n\t};\r\n\r\n\tprivate _stepUp(cursorOffset) {\r\n\t\tif (this._activeLevelIndex >= this._levels.length - 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet nextLevel = this._activeLevelIndex;\r\n\t\tthis._setScaleDates();\r\n\r\n\t\tif(this._widthStep){\r\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width + this._widthStep;\r\n\t\t\tif (newColumnWidth > this._maxColumnWidth) {\r\n\t\t\t\tnewColumnWidth = this._minColumnWidth;\r\n\t\t\t\tnextLevel++;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\r\n\t\t}else{\r\n\t\t\tnextLevel++;\r\n\t\t}\r\n\t\tthis._setLevel(nextLevel, cursorOffset);\r\n\t}\r\n\tprivate _stepDown(cursorOffset) {\r\n\t\tif (this._activeLevelIndex < 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet nextLevel = this._activeLevelIndex;\r\n\t\tthis._setScaleDates();\r\n\r\n\t\tif(this._widthStep){\r\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width - this._widthStep;\r\n\t\t\tif (newColumnWidth < this._minColumnWidth) {\r\n\t\t\t\tnewColumnWidth = this._maxColumnWidth;\r\n\t\t\t\tnextLevel--;\r\n\t\t\t}\r\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\r\n\t\t}else{\r\n\t\t\tnextLevel--;\r\n\t\t}\r\n\t\tthis._setLevel(nextLevel, cursorOffset);\r\n\t}\r\n}","export default function(gantt) {\r\n\r\n\tgantt.config.touch_drag = 75; //nearly immediate dnd\r\n\tgantt.config.touch = true;\r\n\tgantt.config.touch_feedback = true;\r\n\tgantt.config.touch_feedback_duration = 1;\r\n\tgantt._prevent_touch_scroll = false;\r\n\r\n\r\n\tgantt._touch_feedback = function () {\r\n\t\tif (gantt.config.touch_feedback) {\r\n\t\t\tif (navigator.vibrate)\r\n\t\t\t\tnavigator.vibrate(gantt.config.touch_feedback_duration);\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tif (gantt.$container)\t{\r\n\t\t\taddTouchEvents();\r\n\t\t}\r\n\t});\r\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\r\n\t\tif (gantt.$container)\t{\r\n\t\t\t\tgantt.attachEvent(\"onGanttRender\", addTouchEvents, {once: true});\r\n\t\t}\r\n\t});\r\n\r\n\tfunction addTouchEvents(){\r\n\t\tif (gantt.config.touch != \"force\")\r\n\t\t\tgantt.config.touch = gantt.config.touch &&\r\n\t\t\t\t((navigator.userAgent.indexOf(\"Mobile\") != -1) ||\r\n\t\t\t\t\t(navigator.userAgent.indexOf(\"iPad\") != -1) ||\r\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Android\") != -1) ||\r\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Touch\") != -1)) ||\r\n\t\t\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\r\n\r\n\t\tif (gantt.config.touch) {\r\n\r\n\t\t\tvar touchEventsSupported = true;\r\n\t\t\ttry {\r\n\t\t\t\tdocument.createEvent(\"TouchEvent\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\ttouchEventsSupported = false;\r\n\t\t\t}\r\n\r\n\t\t\tif (touchEventsSupported) {\r\n\t\t\t\tgantt._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\r\n\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\r\n\t\t\t\t\tif (ev.touches[0])\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\ttarget: ev.target,\r\n\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\r\n\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\r\n\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\r\n\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treturn ev;\r\n\t\t\t\t}, function (ev) {\r\n\t\t\t\t\treturn ev.defaultPrevented;\r\n\t\t\t\t});\r\n\t\t\t} else if (window.navigator.pointerEnabled) {\r\n\t\t\t\tgantt._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\r\n\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\r\n\t\t\t\t\treturn ev;\r\n\t\t\t\t}, function (ev) {\r\n\t\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\r\n\t\t\t\t});\r\n\t\t\t} else if (window.navigator.msPointerEnabled) {\r\n\t\t\t\tgantt._touch_events([\"MSPointerMove\", \"MSPointerDown\", \"MSPointerUp\"], function (ev) {\r\n\t\t\t\t\tif (ev.pointerType == ev.MSPOINTER_TYPE_MOUSE) return null;\r\n\t\t\t\t\treturn ev;\r\n\t\t\t\t}, function (ev) {\r\n\t\t\t\t\treturn (!ev || ev.pointerType == ev.MSPOINTER_TYPE_MOUSE);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tfunction findTargetView(event){\r\n\t\tvar allViews = gantt.$layout.getCellsByType(\"viewCell\");\r\n\r\n\t\tfor(var i = 0; i < allViews.length; i++){\r\n\t\t\tvar box = allViews[i].$view.getBoundingClientRect();\r\n\t\t\tif(event.clientX >= box.left && event.clientX <= box.right &&\r\n\t\t\t\tevent.clientY <= box.bottom && event.clientY >= box.top){\r\n\t\t\t\t\treturn allViews[i];\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getScrollState(view){\r\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\r\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\r\n\r\n\t\tvar scrollState = {x: null, y: null};\r\n\t\tif(scrollX){\r\n\t\t\tvar state = scrollX.getScrollState();\r\n\t\t\tif(state.visible){\r\n\t\t\t\tscrollState.x = scrollX.$view.scrollLeft;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(scrollY){\r\n\t\t\tvar state = scrollY.getScrollState();\r\n\t\t\tif(state.visible){\r\n\t\t\t\tscrollState.y = scrollY.$view.scrollTop;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn scrollState;\r\n\t}\r\n\r\n\tfunction scrollView(view, left, top){\r\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\r\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\r\n\r\n\t\tif(scrollX){\r\n\t\t\tscrollX.scrollTo(left, null);\r\n\t\t}\r\n\t\tif(scrollY){\r\n\t\t\tscrollY.scrollTo(null, top);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getTaskDND(){\r\n\t\tvar tasksDnD;\r\n\t\tif(gantt.$ui.getView(\"timeline\")){\r\n\t\t\ttasksDnD = gantt.$ui.getView(\"timeline\")._tasks_dnd;\r\n\t\t}\r\n\t\treturn tasksDnD;\r\n\t}\r\n\r\n\tvar touchHandlers = [];\r\n\r\n//we can't use native scrolling, as we need to sync momentum between different parts\r\n//so we will block native scroll and use the custom one\r\n//in future we can add custom momentum\r\n\tgantt._touch_events = function (names, accessor, ignore) {\r\n\t\t//webkit on android need to be handled separately\r\n\t\tvar dblclicktime = 0;\r\n\t\tvar actionMode = false;\r\n\t\tvar scrollMode = false;\r\n\t\tvar actionStart = null;\r\n\t\tvar scrollState;\r\n\t\tvar longTapTimer = null;\r\n\t\tvar currentDndId = null;\r\n\t\tvar dndNodes = [];\r\n\t\tvar targetView = null;\r\n\t\tlet multiTouchEvents = {};\r\n\r\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\r\n\t\t\tgantt.eventRemove(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\r\n\t\t}\r\n\t\ttouchHandlers = [];\r\n\r\n\t\t//touch move\r\n\t\ttouchHandlers.push([gantt.$container, names[0], function (e) {\r\n\t\t\tvar tasksDnD = getTaskDND();\r\n\r\n\t\t\t\tif (ignore(e)) return;\r\n\r\n\t\t\t\t//ignore common and scrolling moves\r\n\t\t\t\tif (!actionMode) return;\r\n\r\n\t\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\r\n\r\n\t\t\t\tvar source = accessor(e);\r\n\t\t\t\tif (tasksDnD && (tasksDnD.drag.id || tasksDnD.drag.start_drag)) {\r\n\t\t\t\t\ttasksDnD.on_mouse_move(source);\r\n\t\t\t\t\tif (e.preventDefault)\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.cancelBubble = true;\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tif (!gantt._prevent_touch_scroll) {\r\n\t\t\t\t\tif (source && actionStart) {\r\n\t\t\t\t\t\tvar dx = actionStart.pageX - source.pageX;\r\n\t\t\t\t\t\tvar dy = actionStart.pageY - source.pageY;\r\n\t\t\t\t\t\tif (!scrollMode && (Math.abs(dx) > 5 || Math.abs(dy) > 5)) {\r\n\t\t\t\t\t\t\tscrollMode = true;\r\n\t\t\t\t\t\t\t//gantt._touch_scroll_active = scroll_mode = true;\r\n\t\t\t\t\t\t\tdblclicktime = 0;\r\n\r\n\t\t\t\t\t\t\tif(targetView){\r\n\t\t\t\t\t\t\t\tscrollState = getScrollState(targetView);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tscrollState = gantt.getScrollState();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (scrollMode) {\r\n\r\n\t\t\t\t\t\t\tvar newScrollState;\r\n\t\t\t\t\t\t\tvar scrollX = scrollState.x + dx;\r\n\t\t\t\t\t\t\tvar scrollY = scrollState.y + dy;\r\n\t\t\t\t\t\t\tif(targetView){\r\n\t\t\t\t\t\t\t\tscrollView(targetView, scrollX, scrollY);\r\n\t\t\t\t\t\t\t\tnewScrollState = getScrollState(targetView);\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\tgantt.scrollTo(scrollX, scrollY);\r\n\t\t\t\t\t\t\t\tnewScrollState = gantt.getScrollState();\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ((scrollState.x != newScrollState.x && dy > 2 * dx) ||\r\n\t\t\t\t\t\t\t\t(scrollState.y != newScrollState.y && dx > 2 * dy )) {\r\n\t\t\t\t\t\t\t\treturn block_action(e);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn block_action(e);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}]);\r\n\r\n\t\t// prevent page drag on touch move\r\n\t\ttry{\r\n\t\t\tdocument.addEventListener('touchmove', function(e) {\r\n\t\t\t\tif (gantt._touch_drag) {\r\n\t\t\t\t\tblock_action(e);\r\n\t\t\t\t}\r\n\t\t\t}, { passive: false });\r\n\t\t}\r\n\t\tcatch(e){\r\n\t\t\t// eslint-disable-next-line no-console\r\n\t\t\tconsole.warn(\"Cannot prevent touch event for the page drag\");\r\n\t\t}\r\n\r\n\t\t//block touch context menu in IE10\r\n\t\ttouchHandlers.push([this.$container, \"contextmenu\", function (e) {\r\n\t\t\tif (actionMode)\r\n\t\t\t\treturn block_action(e);\r\n\t\t}]);\r\n\r\n\t\t//touch start\r\n\t\ttouchHandlers.push([this.$container, names[1], function (e) {\r\n\t\t\tmultiTouchEvents = e.touches.length;\r\n\t\t\t// block pull-to-refresh\r\n\t\t\tif(document && document.body){\r\n\t\t\t\tdocument.body.classList.add(\"gantt_touch_active\");\r\n\t\t\t}\r\n\r\n\t\t\tif (ignore(e)) return;\r\n\t\t\tif (e.touches && e.touches.length > 1) {\r\n\t\t\t\tactionMode = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tactionStart = accessor(e);\r\n\t\t\ttargetView = findTargetView(actionStart);\r\n\t\t\tif (!gantt._locate_css(actionStart, \"gantt_hor_scroll\") && !gantt._locate_css(actionStart, \"gantt_ver_scroll\")) {\r\n\t\t\t\tactionMode = true;\r\n\t\t\t}\r\n\t\t\tvar tasksDnD = getTaskDND();\r\n\r\n\t\t\t//long tap\r\n\t\t\tlongTapTimer = setTimeout(function () {\r\n\t\t\t\tvar taskId = gantt.locate(actionStart);\r\n\t\t\t\tif (tasksDnD && (taskId && !gantt._locate_css(actionStart, \"gantt_link_control\") && !gantt._locate_css(actionStart, \"gantt_grid_data\"))) {\r\n\t\t\t\t\ttasksDnD.on_mouse_down(actionStart);\r\n\r\n\t\t\t\t\tif (tasksDnD.drag && tasksDnD.drag.start_drag) {\r\n\t\t\t\t\t\t// we need that as touch events break if the target node is removed from the DOM\r\n\t\t\t\t\t\tcloneTaskRendered(taskId);\r\n\t\t\t\t\t\ttasksDnD._start_dnd(actionStart);\r\n\t\t\t\t\t\tgantt._touch_drag = true;\r\n\r\n\t\t\t\t\t\tgantt.refreshTask(taskId);\r\n\r\n\t\t\t\t\t\tgantt._touch_feedback();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlongTapTimer = null;\r\n\t\t\t}, gantt.config.touch_drag);\r\n\t\t}]);\r\n\r\n\t\t//touch end\r\n\t\ttouchHandlers.push([this.$container, names[2], function (e) {\r\n\t\t\tif(document && document.body){\r\n\t\t\t\tdocument.body.classList.remove(\"gantt_touch_active\");\r\n\t\t\t}\r\n\t\t\tif (ignore(e)) return;\r\n\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\r\n\t\t\tgantt._touch_drag = false;\r\n\t\t\tactionMode = false;\r\n\t\t\tvar source = accessor(e);\r\n\r\n\t\t\tvar tasksDnD = getTaskDND();\r\n\r\n\t\t\tif(tasksDnD)\r\n\t\t\t\ttasksDnD.on_mouse_up(source);\r\n\r\n\t\t\tif (currentDndId && gantt.isTaskExists(currentDndId)) {\r\n\t\t\t\tgantt.refreshTask(currentDndId);\r\n\t\t\t\tif(dndNodes.length){\r\n\t\t\t\t\tdndNodes.forEach(function(node){\r\n\t\t\t\t\t\tif(node.parentNode){\r\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgantt._touch_feedback();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//gantt._touch_scroll_active = action_mode = scroll_mode = false;\r\n\t\t\tactionMode = scrollMode = false;\r\n\t\t\tdndNodes = [];\r\n\t\t\tcurrentDndId = null;\r\n\r\n\t\t\t//dbl-tap handling\r\n\t\t\tif (actionStart && dblclicktime) {\r\n\t\t\t\tvar now = new Date();\r\n\t\t\t\t// doubletap shouldn't happen with multitouch\r\n\t\t\t\tif ((now - dblclicktime) < 500 && multiTouchEvents <= 1) {\r\n\r\n\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\r\n\t\t\t\t\tmouseEvents.onDoubleClick(actionStart);\r\n\t\t\t\t\tblock_action(e);\r\n\t\t\t\t} else\r\n\t\t\t\t\tdblclicktime = now;\r\n\t\t\t} else {\r\n\t\t\t\tdblclicktime = new Date();\r\n\t\t\t}\r\n\t\t}]);\r\n\r\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\r\n\t\t\tgantt.event(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\r\n\t\t}\r\n\r\n\t\t//common helper, prevents event\r\n\t\tfunction block_action(e) {\r\n\t\t\tif (e && e.preventDefault && e.cancelable){\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t\te.cancelBubble = true;\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tfunction cloneTaskRendered(taskId) {\r\n\t\t\tconst renders = gantt._getTaskLayers();\r\n\t\t\tlet task = gantt.getTask(taskId);\r\n\t\t\tif (task) {\r\n\t\t\t\tlet visible = gantt.isTaskVisible(taskId);\r\n\t\t\t\tif (visible){\r\n\t\t\t\t\tcurrentDndId = taskId;\r\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\r\n\t\t\t\t\t\ttask = renders[i].rendered[taskId];\r\n\t\t\t\t\t\tif (task && task.getAttribute(gantt.config.task_attribute) && task.getAttribute(gantt.config.task_attribute) == taskId) {\r\n\t\t\t\t\t\t\tconst copy = task.cloneNode(true);\r\n\t\t\t\t\t\t\tdndNodes.push(task);\r\n\t\t\t\t\t\t\trenders[i].rendered[taskId] = copy;\r\n\t\t\t\t\t\t\ttask.style.display = \"none\";\r\n\t\t\t\t\t\t\tcopy.className += \" gantt_drag_move \";\r\n\t\t\t\t\t\t\ttask.parentNode.appendChild(copy);\r\n\t\t\t\t\t\t\t//return copy;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (task.$split_subtask){\r\n\t\t\t\t\tlet renderedParent = task.$rendered_parent;\r\n\t\t\t\t\tvisible = gantt.isTaskVisible(renderedParent);\r\n\t\t\t\t\tif (!visible){\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcurrentDndId = taskId;\r\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\r\n\t\t\t\t\t\tconst parent = renders[i].rendered[renderedParent];\r\n\t\t\t\t\t\tlet taskNode;\r\n\t\t\t\t\t\tif (parent && parent.childNodes){\r\n\t\t\t\t\t\t\ttaskNode = parent.querySelector(`[${gantt.config.task_attribute}=\"${task.id}\"]`);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (taskNode) {\r\n\t\t\t\t\t\t\t// move the child node to a different parent as the task bar will be repainted\r\n\t\t\t\t\t\t\t// and the initial node will be lost\r\n\t\t\t\t\t\t\tconst copy = taskNode.cloneNode(true);\r\n\t\t\t\t\t\t\ttaskNode.parentNode.appendChild(copy);\r\n\r\n\t\t\t\t\t\t\tgantt.$task_bars.appendChild(taskNode);\r\n\t\t\t\t\t\t\ttaskNode.style.display = \"none\";\r\n\r\n\t\t\t\t\t\t\t// don't add the node as rendered otherwise it will be lost:\r\n\t\t\t\t\t\t\t// renders[i].rendered[taskId] = taskNode;\r\n\t\t\t\t\t\t\t// instead, add it to dndNodes as its elements will be removed after drag\r\n\t\t\t\t\t\t\tdndNodes.push(taskNode);\r\n\r\n\t\t\t\t\t\t\ttaskNode = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n};","function dummy() {\r\n\t// eslint-disable-next-line\r\n\tconsole.log(\"Method is not implemented.\"); \r\n}\r\nfunction BaseControl() {\r\n}\r\n\r\n// base methods will be runned in gantt context\r\nBaseControl.prototype.render = dummy; // arguments: sns\r\nBaseControl.prototype.set_value = dummy; // arguments: node, value, ev, sns(config)\r\nBaseControl.prototype.get_value = dummy; // arguments node, ev, sns(config)\r\nBaseControl.prototype.focus = dummy; // arguments: node\r\n\r\nexport default function(gantt) { // we could send current instance of gantt to module\r\n\treturn BaseControl;\r\n};","import * as helpers from \"../../../utils/helpers\";\r\n\r\nvar htmlHelpers = {\r\n\tgetHtmlSelect: function(options, attributes, value) {\r\n\t\tvar innerHTML = \"\";\r\n\t\tvar _this = this;\r\n\r\n\t\toptions = options || [];\r\n\t\t\r\n\t\thelpers.forEach(options, function(entry) {\r\n\t\t\tvar _attributes = [{ key: \"value\", value: entry.key }];\r\n\r\n\t\t\tif (value == entry.key) {\r\n\t\t\t\t_attributes[_attributes.length] = { key: \"selected\", value: \"selected\" };\r\n\t\t\t}\r\n\t\t\tif (entry.attributes) {\r\n\t\t\t\t_attributes = _attributes.concat(entry.attributes);\r\n\t\t\t}\r\n\t\t\tinnerHTML += _this.getHtmlOption({ innerHTML: entry.label }, _attributes);\r\n\t\t});\r\n\r\n\t\treturn _getHtmlContainer(\"select\", { innerHTML: innerHTML }, attributes);\r\n\t},\r\n\tgetHtmlOption: function(options, attributes) { return _getHtmlContainer(\"option\", options, attributes); },\r\n\tgetHtmlButton: function(options, attributes) { return _getHtmlContainer(\"button\", options, attributes); },\r\n\tgetHtmlDiv: function(options, attributes) { return _getHtmlContainer(\"div\", options, attributes); },\r\n\tgetHtmlLabel: function(options, attributes) { return _getHtmlContainer(\"label\", options, attributes); },\r\n\tgetHtmlInput: function(attributes) {\r\n\t\treturn \"<input\" + _getHtmlAttributes(attributes || []) + \">\";\r\n\t}\r\n};\r\n\r\nfunction _getHtmlContainer(tag, options, attributes) {\r\n\tvar html;\r\n\r\n\toptions = options || [];\r\n\t\r\n\thtml = \"<\" + tag + _getHtmlAttributes(attributes || []) + \">\" + (options.innerHTML || \"\") + \"</\" + tag +\">\";\r\n\treturn html;\r\n\r\n}\r\n\r\nfunction _getHtmlAttributes(attributes) {\r\n\tvar html = \"\";\r\n\r\n\thelpers.forEach(attributes, function(entry) {\r\n\t\thtml += \" \" + entry.key + \"='\" + entry.value + \"'\";\r\n\t});\r\n\treturn html;\r\n}\r\n\r\nexport default htmlHelpers;","import __extends from \"../../../../utils/extends\";\r\nimport htmlHelpers from \"../../utils/html_helpers\";\r\n\r\nimport Super from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction SelectControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\t\r\n\t\treturn self; \r\n\t}\r\n\t\r\n\t__extends(SelectControl, _super);\r\n\t\r\n\tSelectControl.prototype.render = function(sns) {\r\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\r\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\r\n\r\n\t\thtml += htmlHelpers.getHtmlSelect(sns.options, [{ key: \"style\", value: \"width:100%;\" }, { key: \"title\", value: sns.name }]);\r\n\t\thtml += \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tSelectControl.prototype.set_value = function(node, value, ev, sns) {\r\n\t\tvar select = node.firstChild;\r\n\t\tif (!select._dhx_onchange && sns.onchange) {\r\n\t\t\tselect.onchange = sns.onchange;\r\n\t\t\tselect._dhx_onchange = true;\r\n\t\t}\r\n\t\tif (typeof value === \"undefined\")\r\n\t\t\tvalue = (select.options[0] || {}).value;\r\n\t\tselect.value = value || \"\";\r\n\t};\r\n\t\r\n\tSelectControl.prototype.get_value = function(node) {\r\n\t\treturn node.firstChild.value;\r\n\t};\r\n\t\r\n\tSelectControl.prototype.focus = function(node) {\r\n\t\tvar a = node.firstChild;\r\n\t\tgantt._focus(a, true);\r\n\t};\r\n\t\r\n\treturn SelectControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\nimport SelectControl from \"./select_control\";\r\nexport default function(gantt) {\r\n\tvar _super = SelectControl(gantt);\r\n\r\n\tfunction ParentControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this; \r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\t__extends(ParentControl, _super);\r\n\r\n\r\n\tParentControl.prototype.render = function(sns) {\r\n\t\treturn _display(sns, false);\r\n\t};\r\n\r\n\tParentControl.prototype.set_value = function(node, value, ev, config) {\r\n\t\t// GS-1051. If the value is `0`, the set_value function in the select control won't select \r\n\t\t// the first child because (0 || '') = '';\r\n\t\tif (value === 0) value = \"0\";\r\n\r\n\t\t// GS-1374. Usually, the ID is not specified,\r\n\t\t// we need to add it to keep the options and exclude the current task\r\n\t\tif (!ev.id && gantt.getState().lightbox) {\r\n\t\t\tev.id = gantt.getLightboxValues().id;\r\n\t\t}\r\n\r\n\t\tvar tmpDom = document.createElement(\"div\");\r\n\t\ttmpDom.innerHTML = _display(config, ev.id);\r\n\t\tvar newOptions = tmpDom.removeChild(tmpDom.firstChild);\r\n\t\tnode.onselect = null;\r\n\t\tnode.parentNode.replaceChild(newOptions, node);\r\n\r\n\t\treturn gantt.form_blocks.select.set_value.apply(gantt, [newOptions, value, ev, config]);\r\n\t};\r\n\r\n\tfunction _display(config, item_id) {\r\n\t\tvar tasks = [],\r\n\t\t\toptions = [];\r\n\t\tif (item_id) {\r\n\t\t\ttasks = gantt.getTaskByTime();\r\n\t\t\tif (config.allow_root) {\r\n\t\t\t\ttasks.unshift({id: gantt.config.root_id, text: config.root_label || \"\"});\r\n\t\t\t}\r\n\t\t\ttasks = _filter(tasks, config, item_id);\r\n\t\t\tif (config.sort) {\r\n\t\t\t\ttasks.sort(config.sort);\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar text = config.template || gantt.templates.task_text;\r\n\t\tfor (var i = 0; i < tasks.length; i++) {\r\n\t\t\tvar label = text.apply(gantt, [tasks[i].start_date, tasks[i].end_date, tasks[i]]);\r\n\t\t\tif (label === undefined) {\r\n\t\t\t\tlabel = \"\";\r\n\t\t\t}\r\n\t\t\toptions.push({\r\n\t\t\t\tkey: tasks[i].id,\r\n\t\t\t\tlabel: label\r\n\t\t\t});\r\n\t\t}\r\n\t\tconfig.options = options;\r\n\t\tconfig.map_to = config.map_to || \"parent\";\r\n\t\treturn gantt.form_blocks.select.render.apply(this, arguments);\r\n\t}\r\n\r\n\tfunction _filter(options, config, item_id) {\r\n\t\tvar filter = config.filter || function() {\r\n\t\t\treturn true;\r\n\t\t};\r\n\r\n\t\toptions = options.slice(0);\r\n\r\n\t\tfor (var i = 0; i < options.length; i++) {\r\n\t\t\tvar task = options[i];\r\n\t\t\tif (task.id == item_id || gantt.isChildOf(task.id, item_id) || filter(task.id, task) === false) {\r\n\t\t\t\toptions.splice(i, 1);\r\n\t\t\t\ti--;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn options;\r\n\t}\r\n\treturn ParentControl;\r\n};","import TemplateControlConstructor from \"./controls/template_control\";\r\nimport TextareaControlConstructor from \"./controls/textarea_control\";\r\nimport TimeControlConstructor from \"./controls/time_control\";\r\nimport SelectControlConstructor from \"./controls/select_control\";\r\nimport CheckboxControlConstructor from \"./controls/checkbox_control\";\r\nimport RadioControlConstructor from \"./controls/radio_control\";\r\nimport DurationControlConstructor from \"./controls/duration_control\";\r\nimport ParentControlConstructor from \"./controls/parent_control\";\r\nimport ResourcesControlConstructor from \"./controls/resources_control\";\r\nimport ConstraintControlConstructor from \"./controls/constraint_control\";\r\nimport TypeselectControlConstructor from \"./controls/typeselect_control\";\r\nimport BaselineControlConstructor from \"./controls/baseline_control\";\r\n\r\nimport * as domHelpers from \"../utils/dom_helpers\";\r\nimport * as helpers from \"../../../utils/helpers\";\r\n\t\r\n\r\nexport default function (gantt) {\r\n\r\n\r\n\tvar TemplateControl = TemplateControlConstructor(gantt);\r\n\tvar TextareaControl = TextareaControlConstructor(gantt);\r\n\tvar TimeControl = TimeControlConstructor(gantt);\r\n\tvar SelectControl = SelectControlConstructor(gantt);\r\n\tvar CheckboxControl = CheckboxControlConstructor(gantt);\r\n\tvar RadioControl = RadioControlConstructor(gantt);\r\n\tvar DurationControl = DurationControlConstructor(gantt);\r\n\tvar ParentControl = ParentControlConstructor(gantt);\r\n\tvar ResourcesControl = ResourcesControlConstructor(gantt);\r\n\tvar ConstraintControl = ConstraintControlConstructor(gantt);\r\n\tvar TypeselectControl = TypeselectControlConstructor(gantt);\r\n\tvar BaselineControl = BaselineControlConstructor(gantt);\r\n\r\n\tgantt._lightbox_methods = {};\r\n\tgantt._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\";\r\n\tgantt._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\r\n</div>\r\n<div class=\"gantt_cal_ltitle_controls\">\r\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\r\n\r\n</div></div><div class='gantt_cal_larea'></div>`;\r\n\r\n\t// GS-1952. Attaching the lightbox to the BODY element is not considered secure.\r\n\t// Attach it to Gantt container for Salesforce and other secure environments\r\n\tgantt._lightbox_root = gantt.$root;\r\n\tfunction setParentNode() {\r\n\t\tconst cspEnvironment = gantt.config.csp === true;\r\n\t\tif (cspEnvironment || gantt.env.isSalesforce) {\r\n\t\t\tgantt._lightbox_root = gantt.$root;\r\n\t\t} else {\r\n\t\t\tgantt._lightbox_root = document.body;\r\n\t\t}\r\n\t}\r\n\r\n\t//TODO: gantt._lightbox_id is changed from data.js and accessed from autoscheduling, check if it can be removed from gantt object\r\n\tvar state = gantt.$services.getService(\"state\");\r\n\tstate.registerProvider(\"lightbox\", function () {\r\n\t\treturn {\r\n\t\t\tlightbox: gantt._lightbox_id\r\n\t\t};\r\n\t});\r\n\r\n\tgantt.showLightbox = function (id) {\r\n\t\tvar task = this.getTask(id);\r\n\t\tif (!this.callEvent(\"onBeforeLightbox\", [id])) {\r\n\t\t\tif(gantt.isTaskExists(id) && gantt.getTask(id).$new){\r\n\t\t\t\t//GS-2340 if 'onBeforeLightbox' returns 'false' need update the order in datastore\r\n\t\t\t\tthis.$data.tasksStore._updateOrder();\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar box = this.getLightbox(this.getTaskType(task.type));\r\n\r\n\t\tthis.showCover(box);\r\n\t\tthis._fill_lightbox(id, box);\r\n\t\tthis._setLbPosition(box);\r\n\t\tthis._waiAria.lightboxVisibleAttr(box);\r\n\r\n\t\tthis.callEvent(\"onLightbox\", [id]);\r\n\t};\r\n\r\n\tfunction _is_chart_visible(gantt) {\r\n\t\tvar timeline = gantt.$ui.getView(\"timeline\");\r\n\t\tif (timeline && timeline.isVisible()) {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tgantt._get_timepicker_step = function () {\r\n\t\tif (this.config.round_dnd_dates) {\r\n\t\t\tvar step;\r\n\t\t\tif (_is_chart_visible(this)) {\r\n\t\t\t\tvar scale = gantt.getScale();\r\n\t\t\t\tstep = (helpers.getSecondsInUnit(scale.unit) * scale.step) / 60;//timepicker step is measured in minutes\r\n\t\t\t}\r\n\r\n\t\t\tif (!step || step >= 60 * 24) {\r\n\t\t\t\tstep = this.config.time_step;\r\n\t\t\t}\r\n\t\t\treturn step;\r\n\t\t}\r\n\t\treturn this.config.time_step;\r\n\t};\r\n\tgantt.getLabel = function (property, key) {\r\n\t\tvar sections = this._get_typed_lightbox_config();\r\n\t\tfor (var i = 0; i < sections.length; i++) {\r\n\t\t\tif (sections[i].map_to == property) {\r\n\t\t\t\tvar options = sections[i].options;\r\n\t\t\t\tfor (var j = 0; j < options.length; j++) {\r\n\t\t\t\t\tif (options[j].key == key) {\r\n\t\t\t\t\t\treturn options[j].label;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t};\r\n\r\n\tgantt.updateCollection = function (list_name, collection) {\r\n\t\tcollection = collection.slice(0);\r\n\t\tvar list = gantt.serverList(list_name);\r\n\t\tif (!list) return false;\r\n\t\tlist.splice(0, list.length);\r\n\t\tlist.push.apply(list, collection || []);\r\n\t\tgantt.resetLightbox();\r\n\t};\r\n\tgantt.getLightboxType = function () {\r\n\t\treturn this.getTaskType(this._lightbox_type);\r\n\t};\r\n\tgantt.getLightbox = function (type) {\r\n\t\tvar lightboxDiv;\r\n\t\tvar fullWidth;\r\n\t\tvar html;\r\n\t\tvar sns;\r\n\t\tvar ds;\r\n\t\tvar classNames = \"\";\r\n\t\tsetParentNode();\r\n\r\n\t\tif (type === undefined)\r\n\t\t\ttype = this.getLightboxType();\r\n\r\n\t\tif (!this._lightbox || this.getLightboxType() != this.getTaskType(type)) {\r\n\t\t\tthis._lightbox_type = this.getTaskType(type);\r\n\t\t\tlightboxDiv = document.createElement(\"div\");\r\n\t\t\tclassNames = \"gantt_cal_light\";\r\n\t\t\tfullWidth = this._is_lightbox_timepicker();\r\n\r\n\t\t\tif (gantt.config.wide_form)\r\n\t\t\t\tclassNames += \" gantt_cal_light_wide\";\r\n\r\n\t\t\tif (fullWidth) {\r\n\t\t\t\tclassNames += \" gantt_cal_light_full\";\r\n\t\t\t}\r\n\r\n\t\t\tlightboxDiv.className = classNames;\r\n\r\n\t\t\tlightboxDiv.style.visibility = \"hidden\";\r\n\t\t\thtml = this._lightbox_template;\r\n\t\t\thtml += \"<div class='gantt_cal_lcontrols'>\";\r\n\t\t\thtml += getHtmlButtons(this.config.buttons_left);\r\n\t\t\thtml += \"<div class='gantt_cal_lcontrols_push_right'></div>\";\r\n\t\t\thtml += getHtmlButtons(this.config.buttons_right, true);\r\n\t\t\thtml += \"</div>\";\r\n\r\n\t\t\tlightboxDiv.innerHTML = html;\r\n\r\n\t\t\tgantt._waiAria.lightboxAttr(lightboxDiv);\r\n\r\n\t\t\tif (gantt.config.drag_lightbox) {\r\n\t\t\t\tlightboxDiv.firstChild.onmousedown = gantt._ready_to_dnd;\r\n\t\t\t\tlightboxDiv.firstChild.ontouchstart = function (e){\r\n\t\t\t\t\tgantt._ready_to_dnd(e.touches[0]);\r\n\t\t\t\t};\r\n\t\t\t\tlightboxDiv.firstChild.onselectstart = function () {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t};\r\n\t\t\t\tlightboxDiv.firstChild.style.cursor = \"pointer\";\r\n\t\t\t\tgantt._init_dnd_events();\r\n\t\t\t}\r\n\r\n\t\t\t// GS-1428: If there is lightbox node, we need to remove it from the DOM\r\n\t\t\tif (this._lightbox){\r\n\t\t\t\tthis.resetLightbox();\r\n\t\t\t}\r\n\t\t\tshow_cover();\r\n\t\t\tthis._cover.insertBefore(lightboxDiv, this._cover.firstChild);\r\n\t\t\tthis._lightbox = lightboxDiv;\r\n\r\n\t\t\tsns = this._get_typed_lightbox_config(type);\r\n\t\t\thtml = this._render_sections(sns);\r\n\r\n\t\t\tds = lightboxDiv.querySelector(\"div.gantt_cal_larea\");\r\n\t\t\t\r\n\t\t\t//GS-1131. If gantt_cal_larea is displayed, Firefox renders buttons incorrectly;\r\n\t\t\tvar backup_overflow = ds.style.overflow;\r\n\t\t\tds.style.overflow = 'hidden';\r\n\r\n\t\t\tds.innerHTML = html;\r\n\r\n\t\t\t\r\n\r\n\t\t\tbindLabelsToInputs(sns);\r\n\r\n\t\t\tds.style.overflow = backup_overflow;\r\n\r\n\t\t\tthis._init_lightbox_events(this);\r\n\t\t\tlightboxDiv.style.display = \"none\";\r\n\t\t\tlightboxDiv.style.visibility = \"visible\";\r\n\t\t}\r\n\t\treturn this._lightbox;\r\n\t};\r\n\r\n\tgantt._render_sections = function (sns) {\r\n\t\tvar html = \"\";\r\n\t\tfor (var i = 0; i < sns.length; i++) {\r\n\t\t\tvar block = this.form_blocks[sns[i].type];\r\n\t\t\tif (!block) continue; //ignore incorrect blocks\r\n\t\t\tsns[i].id = \"area_\" + this.uid();\r\n\r\n\t\t\tvar display = sns[i].hidden ? \" style='display:none'\" : \"\";\r\n\t\t\tvar button = \"\";\r\n\t\t\tif (sns[i].button) {\r\n\t\t\t\tbutton = \"<div class='gantt_custom_button' data-index='\" + i + \"'><div class='gantt_custom_button_\" + sns[i].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + sns[i].button] + \"</div></div>\";\r\n\t\t\t}\r\n\t\t\tif (sns[i].type == \"baselines\") {\r\n\t\t\t\tbutton = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div>\" +\r\n\t\t\t\t\"<div class='gantt_custom_button gantt_add_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\";\r\n\t\t\t}\r\n\t\t\tif (this.config.wide_form) {\r\n\t\t\t\thtml += \"<div class='gantt_wrap_section' \" + display + \">\";\r\n\t\t\t}\r\n\t\t\thtml += \"<div id='\" + sns[i].id + \"' class='gantt_cal_lsection'><label>\" + button + (sns[i].label || this.locale.labels[\"section_\" + sns[i].name]||sns[i].name) + \"</label></div>\" + block.render.call(this, sns[i]);\r\n\t\t\thtml += \"</div>\";\r\n\t\t}\r\n\t\treturn html;\r\n\t};\r\n\r\n\tgantt._center_lightbox = function(box){\r\n\t\tgantt._setLbPosition(box);\r\n\t};\r\n\tgantt._setLbPosition = function(box) {\r\n\t\tif(!box){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\r\n\t\tbox.style.top = Math.max(rootElement.offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\r\n\t\tbox.style.left = Math.max(rootElement.offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\r\n\t};\r\n\r\n\tgantt.showCover = function (box) {\r\n\t\tif (box){\r\n\t\t\tbox.style.display=\"block\";\r\n\t\r\n\t\t\tthis._setLbPosition(box);\r\n\t\t}\r\n\t\tshow_cover();\r\n\t\tthis._cover.style.display = \"\";\r\n\t};\r\n\tconst show_cover=function(){\r\n\t\tif(gantt._cover) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\r\n\t\tgantt._cover=document.createElement(\"div\");\r\n\t\tgantt._cover.className=\"gantt_cal_cover\";\r\n\t\tgantt._cover.style.display = \"none\";\r\n\t\r\n\t\tgantt.event(gantt._cover, \"mousemove\", gantt._move_while_dnd);\r\n\t\tgantt.event(gantt._cover, \"mouseup\", gantt._finish_dnd);\r\n\t\r\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\r\n\t\trootElement.appendChild(gantt._cover);\r\n\t};\r\n\r\n\tgantt._init_lightbox_events = function () {\r\n\t\tgantt.lightbox_events = {};\r\n\r\n\r\n\t\tgantt.lightbox_events.gantt_save_btn = function () {\r\n\t\t\tgantt._save_lightbox();\r\n\t\t};\r\n\r\n\r\n\t\tgantt.lightbox_events.gantt_delete_btn = function () {\r\n\t\t\tgantt._lightbox_current_type = null;\r\n\t\t\tif (!gantt.callEvent(\"onLightboxDelete\", [gantt._lightbox_id]))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tif (gantt.isTaskExists(gantt._lightbox_id)) {\r\n\t\t\t\tgantt.$click.buttons[\"delete\"](gantt._lightbox_id);\r\n\t\t\t} else {\r\n\t\t\t\tgantt.hideLightbox();\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\r\n\t\tgantt.lightbox_events.gantt_cancel_btn = function () {\r\n\t\t\tgantt._cancel_lightbox();\r\n\t\t};\r\n\r\n\r\n\t\tgantt.lightbox_events[\"default\"] = function (e, src) {\r\n\t\t\tif (src.getAttribute(\"data-dhx-button\")) {\r\n\t\t\t\tgantt.callEvent(\"onLightboxButton\", [src.className, src, e]);\r\n\t\t\t} else {\r\n\t\t\t\tvar index, block, sec;\r\n\r\n\t\t\t\tvar className = domHelpers.getClassName(src);\r\n\t\t\t\tif (className.indexOf(\"gantt_custom_button\") != -1) {\r\n\t\t\t\t\tif (className.indexOf(\"gantt_custom_button_\") != -1) {\r\n\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"data-index\");\r\n\t\t\t\t\t\tsec = src;\r\n\t\t\t\t\t\twhile (sec && domHelpers.getClassName(sec).indexOf(\"gantt_cal_lsection\") == -1) {\r\n\t\t\t\t\t\t\tsec = sec.parentNode;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tindex = src.getAttribute(\"data-index\");\r\n\t\t\t\t\t\tsec = src.closest(\".gantt_cal_lsection\");\r\n\t\t\t\t\t\tsrc = src.firstChild;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar sections = gantt._get_typed_lightbox_config();\r\n\r\n\t\t\t\tif (index) {\r\n\t\t\t\t\tindex = index * 1;\r\n\t\t\t\t\tblock = gantt.form_blocks[sections[index * 1].type];\r\n\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.event(gantt.getLightbox(), \"click\", function (e) {\r\n\t\t\tif(e.target.closest(\".gantt_cal_ltitle_close_btn\")){\r\n\t\t\t\tgantt._cancel_lightbox();\r\n\t\t\t}\r\n\t\t\tvar src = domHelpers.getTargetNode(e);\r\n\r\n\t\t\tvar className = domHelpers.getClassName(src);\r\n\t\t\tif (!className) {\r\n\t\t\t\tsrc = src.previousSibling;\r\n\t\t\t\tclassName = domHelpers.getClassName(src);\r\n\t\t\t}\r\n\t\t\tif (src && className && className.indexOf(\"gantt_btn_set\") === 0) {\r\n\t\t\t\tsrc = src.firstChild;\r\n\t\t\t\tclassName = domHelpers.getClassName(src);\r\n\t\t\t}\r\n\t\t\tif (src && className) {\r\n\t\t\t\tvar func = gantt.defined(gantt.lightbox_events[src.className]) ? gantt.lightbox_events[src.className] : gantt.lightbox_events[\"default\"];\r\n\t\t\t\treturn func(e, src);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tgantt.getLightbox().onkeydown = function (e) {\r\n\t\t\tvar event = e || window.event;\r\n\t\t\tvar target = e.target || e.srcElement;\r\n\t\t\tvar buttonTarget = domHelpers.getClassName(target).indexOf(\"gantt_btn_set\") > -1;\r\n\r\n\t\t\tswitch ((e || event).keyCode) {\r\n\t\t\t\tcase gantt.constants.KEY_CODES.SPACE: {\r\n\t\t\t\t\tif ((e || event).shiftKey) return;\r\n\t\t\t\t\tif (buttonTarget && target.click) {\r\n\t\t\t\t\t\ttarget.click();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase gantt.keys.edit_save:\r\n\t\t\t\t\tif ((e || event).shiftKey) return;\r\n\t\t\t\t\tif (buttonTarget && target.click) {\r\n\t\t\t\t\t\ttarget.click();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tgantt._save_lightbox();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase gantt.keys.edit_cancel:\r\n\t\t\t\t\tgantt._cancel_lightbox();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tgantt._cancel_lightbox = function () {\r\n\t\tvar task = this.getLightboxValues();\r\n\t\tgantt._lightbox_current_type = null;\r\n\t\tthis.callEvent(\"onLightboxCancel\", [this._lightbox_id, task.$new]);\r\n\t\tif (gantt.isTaskExists(task.id) && task.$new) {\r\n\t\t\tthis.silent(function () {\r\n\t\t\t\tgantt.$data.tasksStore.removeItem(task.id);\r\n\t\t\t\tgantt._update_flags(task.id, null);\r\n\t\t\t});\r\n\t\t\tthis.refreshData();\r\n\t\t}\r\n\r\n\t\tthis.hideLightbox();\r\n\t};\r\n\r\n\tgantt._save_lightbox = function () {\r\n\t\tvar task = this.getLightboxValues();\r\n\t\tgantt._lightbox_current_type = null;\r\n\t\tif (!this.callEvent(\"onLightboxSave\", [this._lightbox_id, task, !!task.$new]))\r\n\t\t\treturn;\r\n\r\n\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\r\n\t\t// as they will be recalculated in the `refreshData`\r\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\r\n\t\tif (task.$new) {\r\n\t\t\tdelete task.$new;\r\n\t\t\tthis.addTask(task, task.parent, this.getTaskIndex(task.id));\r\n\t\t} else if (this.isTaskExists(task.id)) {\r\n\t\t\tthis.mixin(this.getTask(task.id), task, true);\r\n\t\t\tthis.refreshTask(task.id);\r\n\t\t\tthis.updateTask(task.id);\r\n\t\t}\r\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\r\n\t\tthis.refreshData();\r\n\r\n\t\t// TODO: do we need any blockable events here to prevent closing lightbox?\r\n\t\tthis.hideLightbox();\r\n\t};\r\n\r\n\tgantt._resolve_default_mapping = function (section) {\r\n\t\tvar mapping = section.map_to;\r\n\t\tvar time_controls = { \"time\": true, \"time_optional\": true, \"duration\": true, \"duration_optional\": true };\r\n\t\tif (time_controls[section.type]) {\r\n\t\t\tif (section.map_to == \"auto\") {\r\n\t\t\t\tmapping = { start_date: \"start_date\", end_date: \"end_date\", duration: \"duration\" };\r\n\t\t\t} else if (typeof (section.map_to) === \"string\") {\r\n\t\t\t\tmapping = { start_date: section.map_to };\r\n\t\t\t}\r\n\t\t} else if (section.type === \"constraint\") {\r\n\t\t\tif (!section.map_to || typeof (section.map_to) === \"string\") {\r\n\t\t\t\tmapping = { constraint_type: \"constraint_type\", constraint_date: \"constraint_date\" };\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn mapping;\r\n\t};\r\n\r\n\tgantt.getLightboxValues = function () {\r\n\t\tlet task = {};\r\n\r\n\t\tif (gantt.isTaskExists(this._lightbox_id)) {\r\n\t\t\ttask = this.mixin({}, this.getTask(this._lightbox_id));\r\n\t\t}\r\n\r\n\t\tconst sns = this._get_typed_lightbox_config();\r\n\t\t// GS-2370: if there is a resource with its calendar\r\n\t\t// need to place time section at the end\r\n\t\tconst sortedSns = [...sns].sort((a, b) => {\r\n\t\t\tif (a.name === \"time\") return 1;\r\n\t\t\tif (b.name === \"time\") return -1;\r\n\t\t\treturn 0;\r\n\t\t});\r\n\t\tfor (let i = 0; i < sortedSns.length; i++) {\r\n\t\t\tlet node = gantt._lightbox_root.querySelector(\"#\" + sortedSns[i].id);\r\n\t\t\tnode = (node ? node.nextSibling : node);\r\n\t\t\tlet block = this.form_blocks[sortedSns[i].type];\r\n\t\t\tif (!block) continue;\r\n\t\t\tlet res = block.get_value.call(this, node, task, sortedSns[i]);\r\n\t\t\tlet map_to = gantt._resolve_default_mapping(sortedSns[i]);\r\n\t\t\tif (typeof map_to == \"string\" && map_to != \"auto\") {\r\n\t\t\t\ttask[map_to] = res;\r\n\t\t\t} else if (typeof map_to == \"object\") {\r\n\t\t\t\tfor (let property in map_to) {\r\n\t\t\t\t\tif (map_to[property])\r\n\t\t\t\t\t\ttask[map_to[property]] = res[property];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// GS-1282 We need to preserve the task type even if the lightbox doesn't have the typeselect section\r\n\t\t// GS-2460 set the current type from selector\r\n\t\tif (gantt._lightbox_current_type) {\r\n\t\t\ttask.type = gantt._lightbox_current_type;\r\n\t\t}\r\n\r\n\t\treturn task;\r\n\t};\r\n\r\n\r\n\tgantt.hideLightbox = function () {\r\n\t\tvar box = this.getLightbox();\r\n\t\tif (box) box.style.display = \"none\";\r\n\r\n\t\tthis._waiAria.lightboxHiddenAttr(box);\r\n\t\tthis._lightbox_id = null;\r\n\r\n\t\tthis.hideCover(box);\r\n\t\tthis.resetLightbox();\r\n\t\tthis.callEvent(\"onAfterLightbox\", []);\r\n\t};\r\n\tgantt.hideCover = function (box) {\r\n\t\tif(box){\r\n\t\t\tbox.style.display = \"none\";\r\n\t\t}\r\n\t\tif (this._cover)\r\n\t\t\tthis._cover.parentNode.removeChild(this._cover);\r\n\t\tthis._cover = null;\r\n\t};\r\n\r\n\tgantt.resetLightbox = function () {\r\n\t\tif (gantt._lightbox && !gantt._custom_lightbox)\r\n\t\t\tgantt._lightbox.remove();\r\n\t\tgantt._lightbox = null;\r\n\t};\r\n\tgantt._set_lightbox_values = function (data, box) {\r\n\t\tvar task = data;\r\n\t\tvar s = box.getElementsByTagName(\"span\");\r\n\t\tvar lightboxHeader = [];\r\n\t\tif (gantt.templates.lightbox_header) {\r\n\t\t\tlightboxHeader.push(\"\");\r\n\t\t\tlightboxHeader.push(gantt.templates.lightbox_header(task.start_date, task.end_date, task));\r\n\t\t\ts[1].innerHTML = \"\";\r\n\t\t\ts[2].innerHTML = gantt.templates.lightbox_header(task.start_date, task.end_date, task);\r\n\t\t} else {\r\n\t\t\tlightboxHeader.push(this.templates.task_time(task.start_date, task.end_date, task));\r\n\t\t\tlightboxHeader.push(String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70)); //IE6 fix\r\n\t\t\ts[1].innerHTML = this.templates.task_time(task.start_date, task.end_date, task);\r\n\t\t\ts[2].innerHTML = String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70); //IE6 fix\r\n\t\t}\r\n\t\ts[1].innerHTML = lightboxHeader[0];\r\n\t\ts[2].innerHTML = lightboxHeader[1];\r\n\r\n\t\tgantt._waiAria.lightboxHeader(box, lightboxHeader.join(\" \"));\r\n\r\n\t\tvar sns = this._get_typed_lightbox_config(this.getLightboxType());\r\n\t\tfor (var i = 0; i < sns.length; i++) {\r\n\t\t\tvar section = sns[i];\r\n\r\n\t\t\tif (!this.form_blocks[section.type]) {\r\n\t\t\t\tcontinue;//skip incorrect sections, same check is done during rendering\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + section.id).nextSibling;\r\n\t\t\tvar block = this.form_blocks[section.type];\r\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\r\n\t\t\tvar value = this.defined(task[map_to]) ? task[map_to] : section.default_value;\r\n\t\t\tblock.set_value.call(gantt, node, value, task, section);\r\n\r\n\t\t\tif (section.focus)\r\n\t\t\t\tblock.focus.call(gantt, node);\r\n\t\t}\r\n\t\tif (gantt.isTaskExists(data.id)){\r\n\t\t\tgantt._lightbox_id = data.id;\r\n\t\t}\r\n\t};\r\n\tgantt._fill_lightbox = function (id, box) {\r\n\t\tvar task = this.getTask(id);\r\n\t\tthis._set_lightbox_values(task, box);\r\n\t};\r\n\r\n\r\n\tgantt.getLightboxSection = function (name) {\r\n\t\tvar config = this._get_typed_lightbox_config();\r\n\t\tvar i = 0;\r\n\t\tfor (i; i < config.length; i++)\r\n\t\t\tif (config[i].name == name)\r\n\t\t\t\tbreak;\r\n\t\tvar section = config[i];\r\n\t\tif (!section)\r\n\t\t\treturn null;\r\n\r\n\t\tif (!this._lightbox)\r\n\t\t\tthis.getLightbox();\r\n\t\tvar header = gantt._lightbox_root.querySelector(\"#\" + section.id);\r\n\t\tvar node = header.nextSibling;\r\n\r\n\t\tvar result = {\r\n\t\t\tsection: section,\r\n\t\t\theader: header,\r\n\t\t\tnode: node,\r\n\t\t\tgetValue: function (ev) {\r\n\t\t\t\treturn gantt.form_blocks[section.type].get_value.call(gantt, node, (ev || {}), section);\r\n\t\t\t},\r\n\t\t\tsetValue: function (value, ev) {\r\n\t\t\t\treturn gantt.form_blocks[section.type].set_value.call(gantt, node, value, (ev || {}), section);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tvar handler = this._lightbox_methods[\"get_\" + section.type + \"_control\"];\r\n\t\treturn handler ? handler(result) : result;\r\n\t};\r\n\r\n\tgantt._lightbox_methods.get_template_control = function (result) {\r\n\t\tresult.control = result.node;\r\n\t\treturn result;\r\n\t};\r\n\tgantt._lightbox_methods.get_select_control = function (result) {\r\n\t\tresult.control = result.node.getElementsByTagName(\"select\")[0];\r\n\t\treturn result;\r\n\t};\r\n\tgantt._lightbox_methods.get_textarea_control = function (result) {\r\n\t\tresult.control = result.node.getElementsByTagName(\"textarea\")[0];\r\n\t\treturn result;\r\n\t};\r\n\tgantt._lightbox_methods.get_time_control = function (result) {\r\n\t\tresult.control = result.node.getElementsByTagName(\"select\"); // array\r\n\t\treturn result;\r\n\t};\r\n\r\n\r\n\tgantt._init_dnd_events = function () {\r\n\t\tvar eventElement = gantt._lightbox_root;\r\n\t\tthis.event(eventElement, \"mousemove\", gantt._move_while_dnd);\r\n\t\tthis.event(eventElement, \"mouseup\", gantt._finish_dnd);\r\n\t\tthis.event(eventElement, \"touchmove\", function (e){\r\n\t\t\tgantt._move_while_dnd(e.touches[0]);\r\n\t\t});\r\n\t\tthis.event(eventElement, \"touchend\", function (e){\r\n\t\t\tgantt._finish_dnd(e.touches[0]);\r\n\t\t});\r\n\t\t// GS-1952: In Salesforce environment, the lightbox is attached to the Gantt container. \r\n\t\t// So when Gantt is reinitialized, the events are no longer attached to the Gantt container.\r\n\t\t// gantt._init_dnd_events = function () {\r\n\t\t// };\r\n\t};\r\n\tgantt._move_while_dnd = function (event) {\r\n\t\tif (gantt._dnd_start_lb) {\r\n\t\t\tif (!document.gantt_unselectable) {\r\n\t\t\t\tgantt._lightbox_root.className += \" gantt_unselectable\";\r\n\t\t\t\tdocument.gantt_unselectable = true;\r\n\t\t\t}\r\n\t\t\tvar lb = gantt.getLightbox();\r\n\t\t\tvar now = [event.pageX, event.pageY];\r\n\t\t\tlb.style.top = gantt._lb_start[1] + now[1] - gantt._dnd_start_lb[1] + \"px\";\r\n\t\t\tlb.style.left = gantt._lb_start[0] + now[0] - gantt._dnd_start_lb[0] + \"px\";\r\n\t\t}\r\n\t};\r\n\tgantt._ready_to_dnd = function (event) {\r\n\t\tvar lb = gantt.getLightbox();\r\n\t\tgantt._lb_start = [lb.offsetLeft, lb.offsetTop];\r\n\t\tgantt._dnd_start_lb = [event.pageX, event.pageY];\r\n\t};\r\n\tgantt._finish_dnd = function () {\r\n\t\tif (gantt._lb_start) {\r\n\t\t\tgantt._lb_start = gantt._dnd_start_lb = false;\r\n\t\t\tgantt._lightbox_root.className = gantt._lightbox_root.className.replace(\" gantt_unselectable\", \"\");\r\n\t\t\tdocument.gantt_unselectable = false;\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tgantt._focus = function (node, select) {\r\n\t\tif (node && node.focus) {\r\n\t\t\tif (gantt.config.touch) {\r\n\t\t\t\t//do not focus editor, to prevent auto-zoom\r\n\t\t\t} else {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (select && node.select) node.select();\r\n\t\t\t\t\tnode.focus();\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t// silent errors\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\r\n\tgantt.form_blocks = {\r\n\t\tgetTimePicker: function (sns, hidden) {\r\n\t\t\tvar html = \"\";\r\n\t\t\tvar cfg = this.config;\r\n\t\t\tvar i;\r\n\t\t\tvar options;\r\n\t\t\tvar ariaAttrs;\r\n\t\t\tvar readonly;\r\n\t\t\tvar display;\r\n\t\t\tvar settings = {\r\n\t\t\t\tfirst: 0,\r\n\t\t\t\tlast: 24 * 60,\r\n\t\t\t\tdate: this.date.date_part(new Date(gantt._min_date.valueOf())),\r\n\t\t\t\ttimeFormat: getTimeFormat(sns)\r\n\t\t\t};\r\n\r\n\t\t\t// map: default order => real one\r\n\t\t\tsns._time_format_order = { size: 0 };\r\n\r\n\t\t\tif (gantt.config.limit_time_select) {\r\n\t\t\t\tsettings.first = 60 * cfg.first_hour;\r\n\t\t\t\tsettings.last = 60 * cfg.last_hour + 1;\r\n\t\t\t\tsettings.date.setHours(cfg.first_hour);\r\n\t\t\t}\r\n\r\n\t\t\tfor (i = 0; i < settings.timeFormat.length; i++) {\r\n\t\t\t\t// adding spaces between selects\r\n\t\t\t\tif (i > 0) {\r\n\t\t\t\t\thtml += \" \";\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions = getHtmlTimePickerOptions(sns, i, settings);\r\n\r\n\t\t\t\tif (options) {\r\n\t\t\t\t\tariaAttrs = gantt._waiAria.lightboxSelectAttrString(settings.timeFormat[i]);\r\n\t\t\t\t\treadonly = sns.readonly ? \"disabled='disabled'\" : \"\";\r\n\t\t\t\t\tdisplay = hidden ? \" style='display:none' \" : \"\";\r\n\t\t\t\t\thtml += \"<select \" + readonly + display + ariaAttrs + \">\" + options + \"</select>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn html;\r\n\t\t},\r\n\t\tgetTimePickerValue: function (selects, config, offset) {\r\n\t\t\tvar map = config._time_format_order;\r\n\t\t\tvar needSetTime = gantt.defined(map[3]);\r\n\r\n\t\t\tvar time;\r\n\t\t\tvar hours = 0;\r\n\t\t\tvar minutes = 0;\r\n\r\n\t\t\tvar mapOffset = offset || 0;\r\n\r\n\t\t\tif (needSetTime) {\r\n\t\t\t\ttime = parseInt(selects[map[3] + mapOffset].value, 10);\r\n\t\t\t\thours = Math.floor(time / 60);\r\n\t\t\t\tminutes = time % 60;\r\n\t\t\t}\r\n\t\t\treturn new Date(selects[map[2] + mapOffset].value, selects[map[1] + mapOffset].value, selects[map[0] + mapOffset].value, hours, minutes);\r\n\t\t},\r\n\r\n\t\t_fill_lightbox_select: function (s, i, d, map) {\r\n\t\t\ts[i + map[0]].value = d.getDate();\r\n\t\t\ts[i + map[1]].value = d.getMonth();\r\n\t\t\ts[i + map[2]].value = d.getFullYear();\r\n\t\t\tif (gantt.defined(map[3])) {\r\n\t\t\t\tvar v = d.getHours() * 60 + d.getMinutes();\r\n\t\t\t\tv = Math.round(v / gantt._get_timepicker_step()) * gantt._get_timepicker_step();\r\n\t\t\t\tvar input = s[i + map[3]];\r\n\t\t\t\tinput.value = v;\r\n\t\t\t\t//in case option not shown\r\n\t\t\t\tinput.setAttribute(\"data-value\", v);\r\n\t\t\t}\r\n\t\t},\r\n\t\ttemplate: new TemplateControl(),\r\n\t\ttextarea: new TextareaControl(),\r\n\t\tselect: new SelectControl(),\r\n\t\ttime: new TimeControl(),\r\n\t\tduration: new DurationControl(),\r\n\t\tparent: new ParentControl(),\r\n\t\tradio: new RadioControl(),\r\n\t\tcheckbox: new CheckboxControl(),\r\n\t\tresources: new ResourcesControl(),\r\n\t\tconstraint: new ConstraintControl(),\r\n\t\tbaselines: new BaselineControl(),\r\n\t\ttypeselect: new TypeselectControl()\r\n\t};\r\n\r\n\tgantt._is_lightbox_timepicker = function () {\r\n\t\tvar s = this._get_typed_lightbox_config();\r\n\t\tfor (var i = 0; i < s.length; i++)\r\n\t\t\tif (s[i].name == \"time\" && s[i].type == \"time\")\r\n\t\t\t\treturn true;\r\n\t\treturn false;\r\n\t};\r\n\r\n\tgantt._delete_task_confirm = function ({task, message, title, callback, ok}){\r\n\t\tgantt._simple_confirm(message, title, callback, ok);\r\n\t};\r\n\tgantt._delete_link_confirm = function({link, message, title, callback, ok}){\r\n\t\tgantt._simple_confirm(message, title, callback, ok);\r\n\t};\r\n\r\n\tgantt._simple_confirm = function (message, title, callback, ok) {\r\n\t\tif (!message)\r\n\t\t\treturn callback();\r\n\t\tvar opts = { text: message };\r\n\t\tif (title)\r\n\t\t\topts.title = title;\r\n\t\tif (ok) {\r\n\t\t\topts.ok = ok;\r\n\t\t}\r\n\t\tif (callback) {\r\n\t\t\topts.callback = function (result) {\r\n\t\t\t\tif (result)\r\n\t\t\t\t\tcallback();\r\n\t\t\t};\r\n\t\t}\r\n\t\tgantt.confirm(opts);\r\n\t};\r\n\r\n\tfunction _get_type_name(type_value) {\r\n\t\tfor (var i in this.config.types) {\r\n\t\t\tif (this.config.types[i] == type_value) {\r\n\t\t\t\treturn i;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"task\";\r\n\t}\r\n\r\n\tgantt._get_typed_lightbox_config = function (type) {\r\n\t\tif (type === undefined) {\r\n\t\t\ttype = this.getLightboxType();\r\n\t\t}\r\n\r\n\t\tvar field = _get_type_name.call(this, type);\r\n\r\n\t\tif (gantt.config.lightbox[field + \"_sections\"]) {\r\n\t\t\treturn gantt.config.lightbox[field + \"_sections\"];\r\n\t\t} else {\r\n\t\t\treturn gantt.config.lightbox.sections;\r\n\t\t}\r\n\t};\r\n\r\n\tgantt._silent_redraw_lightbox = function (type) {\r\n\t\tvar oldType = this.getLightboxType();\r\n\r\n\t\tif (this.getState().lightbox) {\r\n\t\t\tvar taskId = this.getState().lightbox;\r\n\t\t\tvar formData = this.getLightboxValues(),\r\n\t\t\t\ttask = this.copy(this.getTask(taskId));\r\n\r\n\t\t\tthis.resetLightbox();\r\n\r\n\t\t\tvar updTask = this.mixin(task, formData, true);\r\n\t\t\tvar box = this.getLightbox(type ? type : undefined);\r\n\t\t\tthis._set_lightbox_values(updTask, box);\r\n\t\t\tthis.showCover(box);\r\n\t\t} else {\r\n\t\t\tthis.resetLightbox();\r\n\t\t\tthis.getLightbox(type ? type : undefined);\r\n\t\t}\r\n\t\tthis.callEvent(\"onLightboxChange\", [oldType, this.getLightboxType()]);\r\n\t};\r\n\r\n\tfunction bindLabelsToInputs(sns) {\r\n\t\tvar section;\r\n\t\tvar label;\r\n\t\tvar labelBlock;\r\n\t\tvar inputBlock;\r\n\t\tvar input;\r\n\t\tvar i;\r\n\r\n\t\tfor (i = 0; i < sns.length; i++) {\r\n\t\t\tsection = sns[i];\r\n\t\t\tlabelBlock = gantt._lightbox_root.querySelector(\"#\" + section.id);\r\n\r\n\t\t\tif (!section.id || !labelBlock) continue;\r\n\r\n\t\t\tlabel = labelBlock.querySelector(\"label\");\r\n\t\t\tinputBlock = labelBlock.nextSibling;\r\n\r\n\t\t\tif (!inputBlock) continue;\r\n\r\n\t\t\tinput = inputBlock.querySelector(\"input, select, textarea\");\r\n\t\t\tif (input) {\r\n\t\t\t\tinput.id = input.id || \"input_\" + gantt.uid();\r\n\t\t\t\tsection.inputId = input.id;\r\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getHtmlButtons(buttons, floatRight) {\r\n\t\tvar button;\r\n\t\tvar ariaAttr;\r\n\t\tvar html = \"\";\r\n\t\tvar i;\r\n\r\n\t\tfor (i = 0; i < buttons.length; i++) {\r\n\t\t\t// needed to migrate from 'dhx_something' to 'gantt_something' naming in a lightbox\r\n\t\t\tbutton = gantt.config._migrate_buttons[buttons[i]] ? gantt.config._migrate_buttons[buttons[i]] : buttons[i];\r\n\r\n\t\t\tariaAttr = gantt._waiAria.lightboxButtonAttrString(button);\r\n\t\t\thtml += \"<div \" + ariaAttr + \" class='gantt_btn_set gantt_left_btn_set \" + button + \"_set'\" + \"><div dhx_button='1' data-dhx-button='1' class='\" + button + \"'></div><div>\" + gantt.locale.labels[button] + \"</div></div>\";\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n\r\n\tfunction getTimeFormat(sns) {\r\n\t\tvar scale;\r\n\t\tvar unit;\r\n\t\tvar result;\r\n\r\n\t\tif (sns.time_format) return sns.time_format;\r\n\r\n\t\t// default order\r\n\t\tresult = [\"%d\", \"%m\", \"%Y\"];\r\n\t\tscale = gantt.getScale();\r\n\t\tunit = scale ? scale.unit : gantt.config.duration_unit;\r\n\t\tif (helpers.getSecondsInUnit(unit) < helpers.getSecondsInUnit(\"day\")) {\r\n\t\t\tresult.push(\"%H:%i\");\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfunction getHtmlTimePickerOptions(sns, index, settings) {\r\n\t\tvar range;\r\n\t\tvar offset;\r\n\t\tvar start_year;\r\n\t\tvar end_year;\r\n\t\tvar i;\r\n\t\tvar time;\r\n\t\tvar diff;\r\n\t\tvar tdate;\r\n\t\tvar html = \"\";\r\n\r\n\t\tswitch (settings.timeFormat[index]) {\r\n\t\t\tcase \"%Y\":\r\n\t\t\t\tsns._time_format_order[2] = index;\r\n\t\t\t\tsns._time_format_order.size++;\r\n\t\t\t\t//year\r\n\r\n\t\t\t\tif (sns.year_range) {\r\n\t\t\t\t\tif (!isNaN(sns.year_range)) {\r\n\t\t\t\t\t\trange = sns.year_range;\r\n\t\t\t\t\t} else if (sns.year_range.push) {\r\n\t\t\t\t\t\t// if\r\n\t\t\t\t\t\tstart_year = sns.year_range[0];\r\n\t\t\t\t\t\tend_year = sns.year_range[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\trange = range || 10;\r\n\t\t\t\toffset = offset || Math.floor(range / 2);\r\n\t\t\t\tstart_year = start_year || settings.date.getFullYear() - offset;\r\n\t\t\t\tend_year = end_year || gantt.getState().max_date.getFullYear() + offset;\r\n\r\n\t\t\t\tfor (i = start_year; i <= end_year; i++)\r\n\t\t\t\t\thtml += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%m\":\r\n\t\t\t\tsns._time_format_order[1] = index;\r\n\t\t\t\tsns._time_format_order.size++;\r\n\t\t\t\t//month\r\n\t\t\t\tfor (i = 0; i < 12; i++)\r\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + gantt.locale.date.month_full[i] + \"</option>\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%d\":\r\n\t\t\t\tsns._time_format_order[0] = index;\r\n\t\t\t\tsns._time_format_order.size++;\r\n\t\t\t\t//days\r\n\t\t\t\tfor (i = 1; i < 32; i++)\r\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + i + \"</option>\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"%H:%i\":\r\n\t\t\t\t//  var last = 24*60, first = 0;\r\n\t\t\t\tsns._time_format_order[3] = index;\r\n\t\t\t\tsns._time_format_order.size++;\r\n\t\t\t\t//hours\r\n\t\t\t\ti = settings.first;\r\n\t\t\t\ttdate = settings.date.getDate();\r\n\t\t\t\tsns._time_values = [];\r\n\r\n\t\t\t\twhile (i < settings.last) {\r\n\t\t\t\t\ttime = gantt.templates.time_picker(settings.date);\r\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\r\n\t\t\t\t\tsns._time_values.push(i);\r\n\t\t\t\t\tsettings.date.setTime(settings.date.valueOf() + gantt._get_timepicker_step() * 60 * 1000);\r\n\t\t\t\t\tdiff = (settings.date.getDate() != tdate) ? 1 : 0; // moved or not to the next day\r\n\t\t\t\t\ti = diff * 24 * 60 + settings.date.getHours() * 60 + settings.date.getMinutes();\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn html;\r\n\t}\r\n};","import __extends from \"../../../../utils/extends\";\r\n\r\nimport Super from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction TemplateControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this; \r\n\t\treturn self; \r\n\t}\r\n\r\n\t__extends(TemplateControl, _super);\r\n\r\n\r\n\tTemplateControl.prototype.render = function(sns) {\r\n\t\tlet height = sns.height ? `${sns.height}px` : '';\r\n\t\treturn `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}></div>`;\r\n\t};\r\n\r\n\tTemplateControl.prototype.set_value = function(node, value) {\r\n\t\tnode.innerHTML = value || \"\";\r\n\t};\r\n\r\n\tTemplateControl.prototype.get_value = function(node) {\r\n\t\treturn node.innerHTML || \"\";\r\n\t};\r\n\r\n\tTemplateControl.prototype.focus = function() {};\r\n\r\n\treturn TemplateControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\n\r\nimport Super from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction TextareaControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\t__extends(TextareaControl, _super);\r\n\r\n\tTextareaControl.prototype.render = function(sns) {\r\n\t\tconst height = (sns.height || \"130\") + \"px\";\r\n\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\r\n\t\treturn `<div class='gantt_cal_ltext gantt_section_${sns.name}' style='height:${height};' ${placeholder}><textarea></textarea></div>`;\r\n\t};\r\n\r\n\tTextareaControl.prototype.set_value = function(node, value) {\r\n\t\tgantt.form_blocks.textarea._get_input(node).value = value || \"\";\r\n\t};\r\n\r\n\tTextareaControl.prototype.get_value = function(node) {\r\n\t\treturn gantt.form_blocks.textarea._get_input(node).value;\r\n\t};\r\n\r\n\tTextareaControl.prototype.focus = function(node) {\r\n\t\tvar a = gantt.form_blocks.textarea._get_input(node);\r\n\t\tgantt._focus(a, true);\r\n\t};\r\n\r\n\tTextareaControl.prototype._get_input = function(node) {\r\n\t\treturn node.querySelector(\"textarea\");\r\n\t};\r\n\r\n\treturn TextareaControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\n\r\nimport Super from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction TimeControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(TimeControl, _super);\r\n\r\n\tTimeControl.prototype.render = function (sns) {\r\n\t\tvar time = gantt.form_blocks.getTimePicker.call(this, sns);\r\n\t\tlet sectionClassName = \"gantt_section_time\";\r\n\t\tif (sns.name !== \"time\"){\r\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\r\n\t\t}\r\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + sectionClassName + \"'>\";\r\n\t\thtml += time;\r\n\r\n\t\tif (sns.single_date) {\r\n\t\t\ttime = gantt.form_blocks.getTimePicker.call(this, sns, true);\r\n\t\t\thtml += \"<span></span>\";\r\n\t\t} else {\r\n\t\t\thtml += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\";\r\n\t\t}\r\n\r\n\t\thtml += time;\r\n\t\thtml += \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tTimeControl.prototype.set_value = function (node, value, ev, config) {\r\n\t\tvar cfg = config;\r\n\t\tvar s = node.getElementsByTagName(\"select\");\r\n\t\tvar map = config._time_format_order;\r\n\r\n\t\tif (cfg.auto_end_date) {\r\n\t\t\tvar _update_lightbox_select = function () {\r\n\t\t\t\tstart_date = new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, 0, 0);\r\n\t\t\t\tend_date = gantt.calculateEndDate({ start_date: start_date, duration: 1, task: ev });\r\n\t\t\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\r\n\t\t\t};\r\n\t\t\tfor (var i = 0; i < 4; i++) {\r\n\t\t\t\ts[i].onchange = _update_lightbox_select;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar mapping = gantt._resolve_default_mapping(config);\r\n\r\n\t\tif (typeof (mapping) === \"string\") mapping = { start_date: mapping };\r\n\r\n\t\tvar start_date = ev[mapping.start_date] || new Date();\r\n\t\tvar end_date = ev[mapping.end_date] || gantt.calculateEndDate({\r\n\t\t\tstart_date: start_date,\r\n\t\t\tduration: 1,\r\n\t\t\ttask: ev\r\n\t\t});\r\n\r\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, cfg);\r\n\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\r\n\t};\r\n\r\n\tTimeControl.prototype.get_value = function (node, ev, config) {\r\n\t\tvar selects = node.getElementsByTagName(\"select\");\r\n\t\tvar startDate;\r\n\t\tvar map = config._time_format_order;\r\n\t\tfunction _getEndDate(selects, map, startDate) {\r\n\t\t\tvar endDate = gantt.form_blocks.getTimePickerValue(selects, config, map.size);\r\n\t\t\t// GS-1010: We need to add a way to obtain exact end_date for validation\r\n\t\t\tif (endDate <= startDate) {  // when end date seems wrong\r\n\t\t\t\tif (config.autofix_end !== false || config.single_date) { // auto correct it in two cases - when the auto correction is not disabled, or when we have 'single date' control and the user don't have the UI to specify the end date\r\n\t\t\t\t\treturn gantt.date.add(startDate, gantt._get_timepicker_step(), \"minute\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn endDate;\r\n\t\t}\r\n\r\n\t\tstartDate = gantt.form_blocks.getTimePickerValue(selects, config);\r\n\r\n\t\tif (typeof gantt._resolve_default_mapping(config) === \"string\") {\r\n\t\t\treturn startDate;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tstart_date: startDate,\r\n\t\t\tend_date: _getEndDate(selects, map, startDate)\r\n\t\t};\r\n\t};\r\n\r\n\tTimeControl.prototype.focus = function (node) {\r\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\r\n\t};\r\n\r\n\treturn TimeControl;\r\n};","import * as helpers from \"../../../../utils/helpers\";\r\nimport __extends from \"../../../../utils/extends\";\r\nimport BaseConstrutor from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tvar _super = BaseConstrutor(gantt);\r\n\r\n\tfunction CheckboxControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\t__extends(CheckboxControl, _super);\r\n\r\n\tCheckboxControl.prototype.render = function(sns) {\r\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\r\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\r\n\r\n\t\tif (sns.options && sns.options.length) {\r\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\r\n\t\t\t\thtml += \"<label><input type='checkbox' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tsns.single_value = true;\r\n\t\t\thtml += \"<label><input type='checkbox' name='\" + sns.name + \"'></label>\";\r\n\t\t}\r\n\t\thtml += \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tCheckboxControl.prototype.set_value = function(node, value, ev, sns) {\r\n\t\tvar checkboxes = Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]\"));\r\n\r\n\t\tif (!node._dhx_onchange && sns.onchange) {\r\n\t\t\tnode.onchange = sns.onchange;\r\n\t\t\tnode._dhx_onchange = true;\r\n\t\t}\r\n\r\n\t\tif(sns.single_value){\r\n\t\t\tvar box = checkboxes[0];\r\n\t\t\tbox.checked = !!value;\r\n\t\t}else{\r\n\t\t\thelpers.forEach(checkboxes, function(entry) {\r\n\t\t\t\tentry.checked = value ? value.indexOf(entry.value) >= 0 : false;\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tCheckboxControl.prototype.get_value = function(node, task, sns) {\r\n\t\tif(sns.single_value){\r\n\t\t\tvar box = node.querySelector(\"input[type=checkbox]\");\r\n\t\t\treturn box.checked;\r\n\t\t}else{\r\n\t\t\treturn helpers.arrayMap(Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]:checked\")), function(entry) {\r\n\t\t\t\treturn entry.value;\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tCheckboxControl.prototype.focus = function(node) {\r\n\t\tgantt._focus(node.querySelector(\"input[type=checkbox]\"));\r\n\t};\r\n\r\n\treturn CheckboxControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\nimport Super from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction RadioControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\t__extends(RadioControl, _super);\r\n\r\n\tRadioControl.prototype.render = function(sns) {\r\n\t\tconst height = sns.height ? `${sns.height}px` : '';\r\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}>`;\r\n\r\n\t\tif (sns.options && sns.options.length) {\r\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\r\n\t\t\t\thtml += \"<label><input type='radio' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\thtml += \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tRadioControl.prototype.set_value = function(node, value, ev, sns) {\r\n\t\tvar radio;\r\n\r\n\t\tif (!sns.options || !sns.options.length) return;\r\n\r\n\t\tradio = node.querySelector(\"input[type=radio][value='\" + value + \"']\") ||\r\n\t\t\t\tnode.querySelector(\"input[type=radio][value='\" + sns.default_value + \"']\");\r\n\r\n\t\tif (!radio) return;\r\n\r\n\t\tif (!node._dhx_onchange && sns.onchange) {\r\n\t\t\tnode.onchange = sns.onchange;\r\n\t\t\tnode._dhx_onchange = true;\r\n\t\t}\r\n\r\n\t\tradio.checked = true;\r\n\t};\r\n\r\n\tRadioControl.prototype.get_value = function(node, ev) {\r\n\t\tvar result = node.querySelector(\"input[type=radio]:checked\");\r\n\r\n\t\treturn result ? result.value : \"\";\r\n\t};\r\n\r\n\tRadioControl.prototype.focus = function(node) {\r\n\t\tgantt._focus(node.querySelector(\"input[type=radio]\"));\r\n\t};\r\n\r\n\treturn RadioControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\n\r\nimport DurationFormatterNumeric from  \"../../../common/duration_formatter_numeric\";\r\nimport BaseConstrutor from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tvar _super = BaseConstrutor(gantt);\r\n\r\n\tfunction DurationControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this; \r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\tfunction getFormatter(config) {\r\n\t\treturn config.formatter || new DurationFormatterNumeric();\r\n\t}\r\n\r\n\t__extends(DurationControl, _super);\r\n\r\n\tDurationControl.prototype.render = function(sns) {\r\n\t\tvar time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</div>\";\r\n\t\tvar label = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\r\n\t\tvar singleDate = sns.single_date ? \" style='display:none'\" : \"\";\r\n\t\tvar readonly = sns.readonly ? \" disabled='disabled'\" : \"\";\r\n\t\tvar ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(sns);\r\n\r\n\t\tvar durationInputClass = \"gantt_duration_value\";\r\n\t\tif(sns.formatter) {\r\n\t\t\tlabel = \"\";\r\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\" ;\r\n\t\t}\r\n\r\n\t\tvar duration = \"<div class='gantt_duration' \" + singleDate + \">\" +\r\n\t\t\"<div class='gantt_duration_inputs'>\" +\r\n\t\t\t\"<input type='button' class='gantt_duration_dec' value=''\" + readonly + \">\" +\r\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\r\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\r\n\t\t\t\"</div>\" +\r\n\t\t\t\"<div class='gantt_duration_end_date'>\"+label+\"<span></span></div>\" +\r\n\t\t\t\"</div>\" +\r\n\t\t\t\"</div>\";\r\n\t\tlet sectionClassName = \"gantt_section_time gantt_section_duration\";\r\n\t\tif (sns.name !== \"time\"){\r\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\r\n\t\t}\t\r\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;' class='\" + sectionClassName + \"'>\" + time + \" \" + duration + \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tDurationControl.prototype.set_value = function(node, value, ev, config) {\r\n\t\tvar s = node.getElementsByTagName(\"select\");\r\n\t\tvar inps = node.getElementsByTagName(\"input\");\r\n\t\tvar duration = inps[1];\r\n\t\tvar btns = [inps[0], inps[2]];\r\n\t\tvar endspan = node.getElementsByTagName(\"span\")[0];\r\n\t\tvar map = config._time_format_order;\r\n\t\tvar mapping;\r\n\t\tvar start_date;\r\n\t\tvar end_date;\r\n\t\tvar duration_val;\r\n\r\n\t\tfunction _calc_date() {\r\n\t\t\tvar start_date = _getStartDate.call(gantt, node, config);\r\n\t\t\tvar duration = _getDuration.call(gantt, node, config);\r\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: ev});\r\n\r\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\r\n\t\t\tendspan.innerHTML = template(end_date);\r\n\t\t}\r\n\r\n\t\tfunction _change_duration(step) {\r\n\t\t\tvar value = duration.value;\r\n\r\n\t\t\tvalue = getFormatter(config).parse(value);\r\n\t\t\tif (window.isNaN(value))\r\n\t\t\t\tvalue = 0;\r\n\t\t\tvalue += step;\r\n\t\t\tif (value < 1) value = 1;\r\n\t\t\tduration.value = getFormatter(config).format(value);\r\n\t\t\t_calc_date();\r\n\t\t}\r\n\r\n\t\tbtns[0].onclick = gantt.bind(function() {\r\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\r\n\t\t}, this);\r\n\t\tbtns[1].onclick = gantt.bind(function() {\r\n\t\t\t_change_duration(1 * gantt.config.duration_step);\r\n\t\t}, this);\r\n\t\ts[0].onchange = _calc_date;\r\n\t\ts[1].onchange = _calc_date;\r\n\t\ts[2].onchange = _calc_date;\r\n\t\tif (s[3]) s[3].onchange = _calc_date;\r\n\r\n\t\tduration.onkeydown = gantt.bind(function(e) {\r\n\t\t\tvar code; \r\n\r\n\t\t\te = e || window.event;\r\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\r\n\t\t\t\r\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\r\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\r\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\twindow.setTimeout(_calc_date, 1);\r\n\t\t}, this);\r\n\r\n\t\tduration.onchange = gantt.bind(_calc_date, this);\r\n\r\n\t\tmapping = gantt._resolve_default_mapping(config);\r\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\r\n\r\n\t\tstart_date = ev[mapping.start_date] || new Date();\r\n\t\tend_date = ev[mapping.end_date] || gantt.calculateEndDate({\r\n\t\t\tstart_date: start_date,\r\n\t\t\tduration: 1,\r\n\t\t\ttask: ev\r\n\t\t});\r\n\t\tduration_val = Math.round(ev[mapping.duration]) || gantt.calculateDuration({\r\n\t\t\tstart_date: start_date,\r\n\t\t\tend_date: end_date,\r\n\t\t\ttask: ev\r\n\t\t});\r\n\t\tduration_val = getFormatter(config).format(duration_val);\r\n\r\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\r\n\t\tduration.value = duration_val;\r\n\t\t_calc_date();\r\n\t};\r\n\r\n\tDurationControl.prototype.get_value = function(node, ev, config) {\r\n\t\tvar startDate = _getStartDate(node, config);\r\n\t\tvar duration = _getDuration(node, config);\r\n\t\tvar endDate = gantt.calculateEndDate({start_date: startDate, duration: duration, task: ev});\r\n\r\n\t\tif (typeof gantt._resolve_default_mapping(config) == \"string\") {\r\n\t\t\treturn startDate;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tstart_date: startDate,\r\n\t\t\tend_date: endDate,\r\n\t\t\tduration: duration\r\n\t\t};\r\n\t};\r\n\r\n\tDurationControl.prototype.focus = function(node) {\r\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\r\n\t};\r\n\r\n\r\n\tfunction _getStartDate(node, config) {\r\n\t\tvar s = node.getElementsByTagName(\"select\");\r\n\t\tvar map = config._time_format_order;\r\n\t\tvar hours = 0;\r\n\t\tvar minutes = 0;\r\n\r\n\t\tif (gantt.defined(map[3])) {\r\n\t\t\tvar input = s[map[3]];\r\n\t\t\tvar time = parseInt(input.value, 10);\r\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\r\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\r\n\t\t\t}\r\n\r\n\t\t\thours = Math.floor(time / 60);\r\n\t\t\tminutes = time % 60;\r\n\t\t}\r\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\r\n\t}\r\n\r\n\tfunction _getDuration(node, config) {\r\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\r\n\r\n\t\tduration = getFormatter(config).parse(duration.value);\r\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\r\n\t\tif (duration < 0) duration *= -1;\r\n\t\treturn duration;\r\n\t}\r\n\r\n\treturn DurationControl; \r\n};","import __extends from \"../../../../utils/extends\";\r\nimport htmlHelpers from \"../../utils/html_helpers\";\r\nimport BaseConstrutor from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tvar _super = BaseConstrutor(gantt);\r\n\r\n\tfunction ConstraintControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(ConstraintControl, _super);\r\n\r\n\tfunction isNonTimedConstraint(value) {\r\n\t\tif (!value || value === gantt.config.constraint_types.ASAP || value === gantt.config.constraint_types.ALAP) {\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction toggleTimeSelect(timeSelects, typeValue) {\r\n\t\tvar isNonTimed = isNonTimedConstraint(typeValue);\r\n\t\tfor (var i = 0; i < timeSelects.length; i++) {\r\n\t\t\ttimeSelects[i].disabled = isNonTimed;\r\n\t\t}\r\n\t}\r\n\r\n\tConstraintControl.prototype.render = function (sns) {\r\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\r\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\r\n\r\n\t\tvar options = [];\r\n\t\tfor (var i in gantt.config.constraint_types) {\r\n\t\t\toptions.push({ key: gantt.config.constraint_types[i], label: gantt.locale.labels[gantt.config.constraint_types[i]] });\r\n\t\t}\r\n\r\n\t\tsns.options = sns.options || options;\r\n\r\n\t\thtml += \"<span data-constraint-type-select>\" + htmlHelpers.getHtmlSelect(sns.options, [{ key: \"data-type\", value: \"constraint-type\" }]) + \"</span>\";\r\n\r\n\t\tvar timeLabel = gantt.locale.labels[\"constraint_date\"] || \"Constraint date\";\r\n\t\thtml += \"<label data-constraint-time-select>\" + timeLabel + \": \" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</label>\";\r\n\r\n\t\thtml += \"</div>\";\r\n\t\treturn html;\r\n\t};\r\n\r\n\tConstraintControl.prototype.set_value = function (node, value, task, config) {\r\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\r\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\r\n\t\tvar map = config._time_format_order;\r\n\r\n\t\tvar mapping = gantt._resolve_default_mapping(config);\r\n\r\n\t\tif (!typeSelect._eventsInitialized) {\r\n\t\t\ttypeSelect.addEventListener(\"change\", function (e) {\r\n\t\t\t\ttoggleTimeSelect(timeSelects, e.target.value);\r\n\t\t\t});\r\n\t\t\ttypeSelect._eventsInitialized = true;\r\n\t\t}\r\n\r\n\t\tvar constraintDate = task[mapping.constraint_date] || new Date();\r\n\t\tgantt.form_blocks._fill_lightbox_select(timeSelects, 0, constraintDate, map, config);\r\n\r\n\t\tvar constraintType = task[mapping.constraint_type] || gantt.getConstraintType(task);\r\n\t\ttypeSelect.value = constraintType;\r\n\t\ttoggleTimeSelect(timeSelects, constraintType);\r\n\t};\r\n\r\n\tConstraintControl.prototype.get_value = function (node, task, config) {\r\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\r\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\r\n\r\n\t\tvar constraintType = typeSelect.value;\r\n\t\tvar constraintDate = null;\r\n\t\tif (!isNonTimedConstraint(constraintType)) {\r\n\t\t\tconstraintDate = gantt.form_blocks.getTimePickerValue(timeSelects, config);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tconstraint_type: constraintType,\r\n\t\t\tconstraint_date: constraintDate\r\n\t\t};\r\n\t};\r\n\r\n\tConstraintControl.prototype.focus = function (node) {\r\n\t\tgantt._focus(node.querySelector(\"select\"));\r\n\t};\r\n\r\n\treturn ConstraintControl;\r\n};","import __extends from \"../../../../utils/extends\";\r\n\r\nimport Super from \"./select_control\";\r\n\r\nexport default function(gantt) {\r\n\tconst _super = Super(gantt);\r\n\r\n\tfunction TypeselectControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this;\r\n\r\n\t\treturn self;\r\n\t}\r\n\r\n\t__extends(TypeselectControl, _super);\r\n\r\n\tTypeselectControl.prototype.render = function(sns) {\r\n\t\tvar types = gantt.config.types,\r\n\t\t\tlocale = gantt.locale.labels,\r\n\t\t\toptions = [];\r\n\r\n\t\tvar filter = sns.filter || function (typeKey, typeValue) {\r\n\t\t\tif (!types.placeholder || typeValue !== types.placeholder) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\t\tfor (var i in types) {\r\n\t\t\tif (!filter(i, types[i]) === false) {\r\n\t\t\t\toptions.push({ key: types[i], label: locale[\"type_\" + i] });\r\n\t\t\t}\r\n\t\t}\r\n\t\tsns.options = options;\r\n\r\n\t\tvar oldOnChange = sns.onchange;\r\n\t\tsns.onchange = function () {\r\n\t\t\tgantt._lightbox_current_type = this.value;\r\n\t\t\tgantt.changeLightboxType(this.value);\r\n\t\t\tif (typeof oldOnChange == 'function') {\r\n\t\t\t\toldOnChange.apply(this, arguments);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn _super.prototype.render.apply(this, arguments);\r\n\t};\r\n\r\n\treturn TypeselectControl;\r\n};\r\n","\r\nimport __extends from \"../../../../utils/extends\";\r\nimport DurationFormatterNumeric from \"../../../common/duration_formatter_numeric\";\r\nimport BaseConstrutor from \"./base_control\";\r\n\r\nexport default function(gantt) {\r\n\tvar _super = BaseConstrutor(gantt);\r\n\r\n\tfunction DurationControl() {\r\n\t\tvar self = _super.apply(this, arguments) || this; \r\n\r\n\t\treturn self; \r\n\t}\r\n\r\n\tfunction getFormatter(config) {\r\n\t\treturn config.formatter || new DurationFormatterNumeric();\r\n\t}\r\n\r\n\tfunction _generateBaselineRow (node, baseline, task, config){\r\n\t\tconst time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(gantt, config) + \"</div>\";\r\n\t\tlet durationLabel = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\r\n\t\tconst singleDate = config.single_date ? \" style='display:none'\" : \"\";\r\n\t\tconst readonly = config.readonly ? \" disabled='disabled'\" : \"\";\r\n\t\tconst ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(config);\r\n\t\tconst deleteLabel = gantt.locale.labels.baselines_remove_button;\r\n\r\n\t\tlet durationInputClass = \"gantt_duration_value\";\r\n\t\tif(config.formatter) {\r\n\t\t\tdurationLabel = \"\";\r\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\";\r\n\t\t}\r\n\r\n\t\tconst durationEl = \"<div class='gantt_duration' \" + singleDate + \">\" +\r\n\t\t\"<div class='gantt_duration_inputs'>\" +\r\n\t\t\t\"<input type='button' class='gantt_duration_dec' value=''\" + readonly + \">\" +\r\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\r\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\r\n\t\t\t\"</div>\" +\r\n\t\t\t\"<div class='gantt_duration_end_date'>\"+durationLabel+\"<span></span></div>\" +\r\n\t\t\t\"</div>\" +\r\n\t\t\t\"</div>\";\r\n\r\n\t\tconst deleteButton = `<div><div class='baseline_delete_button gantt_custom_button'>${deleteLabel}</div></div>`;\r\n\r\n\t\tconst baselineRow = document.createElement(\"div\");\r\n\t\tbaselineRow.className = \"gantt_section_time gantt_section_duration\";\r\n\t\tbaselineRow.setAttribute(\"data-baseline-id\", baseline.id);\r\n\t\tbaselineRow.innerHTML = time + durationEl + deleteButton + \"<br>\";\r\n\t\tnode.appendChild(baselineRow);\r\n\r\n\t\tvar s = baselineRow.getElementsByTagName(\"select\");\r\n\t\tvar inps = baselineRow.getElementsByTagName(\"input\");\r\n\t\tvar duration = inps[1];\r\n\t\tvar btns = [inps[0], inps[2]];\r\n\t\tvar endspan = baselineRow.getElementsByTagName(\"span\")[0];\r\n\t\tvar map = config._time_format_order;\r\n\t\tvar mapping;\r\n\t\tvar start_date;\r\n\t\tvar end_date;\r\n\t\tvar duration_val;\r\n\r\n\t\tconst deleteEl = baselineRow.querySelector(\".baseline_delete_button\");\r\n\t\tdeleteEl.onclick = function(e){\r\n\t\t\tconst section = baselineRow.parentNode;\r\n\t\t\tbaselineRow.innerHTML = \"\";\r\n\t\t\tbaselineRow.remove();\r\n\t\t\tif (section.innerHTML === \"\"){\r\n\t\t\t\tsection.innerHTML = gantt.locale.labels.baselines_section_placeholder;\r\n\t\t\t}\r\n\t\t};\r\n\t\t\r\n\r\n\t\tfunction _calc_date() {\r\n\t\t\tvar start_date = _getStartDate.call(gantt, baselineRow, config);\r\n\t\t\tvar duration = _getDuration.call(gantt, baselineRow, config);\r\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: task});\r\n\r\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\r\n\t\t\tendspan.innerHTML = template(end_date);\r\n\t\t}\r\n\r\n\t\tfunction _change_duration(step) {\r\n\t\t\tvar value = duration.value;\r\n\r\n\t\t\tvalue = getFormatter(config).parse(value);\r\n\t\t\tif (window.isNaN(value))\r\n\t\t\t\tvalue = 0;\r\n\t\t\tvalue += step;\r\n\t\t\tif (value < 1) value = 1;\r\n\t\t\tduration.value = getFormatter(config).format(value);\r\n\t\t\t_calc_date();\r\n\t\t}\r\n\r\n\t\tbtns[0].onclick = gantt.bind(function() {\r\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\r\n\t\t}, gantt);\r\n\t\tbtns[1].onclick = gantt.bind(function() {\r\n\t\t\t_change_duration(1 * gantt.config.duration_step);\r\n\t\t}, gantt);\r\n\t\ts[0].onchange = _calc_date;\r\n\t\ts[1].onchange = _calc_date;\r\n\t\ts[2].onchange = _calc_date;\r\n\t\tif (s[3]) s[3].onchange = _calc_date;\r\n\r\n\t\tduration.onkeydown = gantt.bind(function(e) {\r\n\t\t\tvar code; \r\n\r\n\t\t\te = e || window.event;\r\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\r\n\t\t\t\r\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\r\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\r\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\twindow.setTimeout(_calc_date, 1);\r\n\t\t}, gantt);\r\n\r\n\t\tduration.onchange = gantt.bind(_calc_date, gantt);\r\n\r\n\t\tmapping = gantt._resolve_default_mapping(config);\r\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\r\n\r\n\t\tstart_date = baseline.start_date || new Date();\r\n\t\tend_date = baseline.end_date || gantt.calculateEndDate({\r\n\t\t\tstart_date: start_date,\r\n\t\t\tduration: 1,\r\n\t\t\ttask\r\n\t\t});\r\n\t\tduration_val = gantt.calculateDuration({\r\n\t\t\tstart_date: start_date,\r\n\t\t\tend_date: end_date,\r\n\t\t\ttask\r\n\t\t});\r\n\t\tduration_val = getFormatter(config).format(duration_val);\r\n\r\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\r\n\t\tduration.value = duration_val;\r\n\t\t_calc_date();\r\n\t}\r\n\r\n\t__extends(DurationControl, _super);\r\n\r\n\tDurationControl.prototype.render = function(sns) {\r\n\t\tconst baselineSection = `<div style='height: ${sns.height || 100}px; padding-top:0px; font-size:inherit;' class='gantt_section_baselines'></div>`;\r\n\t\treturn baselineSection;\r\n\t};\r\n\r\n\tDurationControl.prototype.set_value = function(node, value, task, config) {\r\n\t\tif (task.baselines){\r\n\t\t\tnode.innerHTML = \"\";\r\n\r\n\t\t\ttask.baselines.forEach((baseline)=>{\r\n\t\t\t\t_generateBaselineRow(node, baseline, task, config);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tnode.innerHTML = gantt.locale.labels.baselines_section_placeholder;\r\n\t\t}\t\t\r\n\r\n\t};\r\n\r\n\tDurationControl.prototype.get_value = function(node, task, config) {\r\n\t\tconst baselines = [];\r\n\t\tconst baselineRows = node.querySelectorAll(`[data-baseline-id]`);\r\n\t\tbaselineRows.forEach((baselineNode)=>{\r\n\t\t\tconst baselineId = baselineNode.dataset.baselineId;\r\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\r\n\t\t\tlet baseline = baselineStore.getItem(baselineId);\r\n\t\t\tlet updatedBaseline;\r\n\t\t\tif (baseline){\r\n\t\t\t\tupdatedBaseline = gantt.copy(baseline);\r\n\t\t\t} else {\r\n\t\t\t\tupdatedBaseline = {\r\n\t\t\t\t\tid: gantt.uid(),\r\n\t\t\t\t\ttask_id: task.id,\r\n\t\t\t\t\ttext: \"Baseline 1\"\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tupdatedBaseline.start_date = _getStartDate(baselineNode, config);\r\n\t\t\tupdatedBaseline.duration = _getDuration(baselineNode, config);\r\n\t\t\tupdatedBaseline.end_date = gantt.calculateEndDate({start_date: updatedBaseline.start_date, duration: updatedBaseline.duration, task});\r\n\r\n\t\t\tbaselines.push(updatedBaseline);\r\n\t\t});\r\n\r\n\t\treturn baselines;\r\n\t};\r\n\r\n\tDurationControl.prototype.button_click = function (index, el, section, container) {\r\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (el.closest(\".gantt_custom_button.gantt_remove_baselines\")){\r\n\t\t\tcontainer.innerHTML = gantt.locale.labels.baselines_section_placeholder;\r\n\t\t}\r\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_baselines\")){\r\n\t\t\tif (container.innerHTML == gantt.locale.labels.baselines_section_placeholder){\r\n\t\t\t\tcontainer.innerHTML = \"\";\r\n\t\t\t}\r\n\t\t\tconst task = gantt.getTask(gantt._lightbox_id);\r\n\t\t\tconst baseline = {\r\n\t\t\t\tid: gantt.uid(),\r\n\t\t\t\ttask_id: task.id,\r\n\t\t\t\ttext: \"Baseline 1\",\r\n\t\t\t\tstart_date: task.start_date,\r\n\t\t\t\tend_date: task.end_date\r\n\t\t\t};\r\n\t\t\tconst config = gantt._get_typed_lightbox_config()[index];\r\n\t\t\t_generateBaselineRow(container, baseline, task, config);\r\n\t\t}\r\n\t};\r\n\r\n\tDurationControl.prototype.focus = function(node) {\r\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\r\n\t};\r\n\r\n\r\n\tfunction _getStartDate(node, config) {\r\n\t\tvar s = node.getElementsByTagName(\"select\");\r\n\t\tvar map = config._time_format_order;\r\n\t\tvar hours = 0;\r\n\t\tvar minutes = 0;\r\n\r\n\t\tif (gantt.defined(map[3])) {\r\n\t\t\tvar input = s[map[3]];\r\n\t\t\tvar time = parseInt(input.value, 10);\r\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\r\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\r\n\t\t\t}\r\n\r\n\t\t\thours = Math.floor(time / 60);\r\n\t\t\tminutes = time % 60;\r\n\t\t}\r\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\r\n\t}\r\n\r\n\tfunction _getDuration(node, config) {\r\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\r\n\r\n\t\tduration = getFormatter(config).parse(duration.value);\r\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\r\n\t\tif (duration < 0) duration *= -1;\r\n\t\treturn duration;\r\n\t}\r\n\r\n\treturn DurationControl; \r\n};","import * as utils from \"../utils/utils\";\r\nimport env from \"../utils/env\";\r\nimport isHeadless from \"../utils/is_headless\";\r\nimport * as domHelpers from \"./ui/utils/dom_helpers\";\r\nimport * as codeHelpers from \"../utils/helpers\";\r\nimport domEventScope from \"./ui/utils/dom_event_scope\";\r\nimport messages from \"./ui/message\";\r\nimport ui from \"./ui/index\";\r\nimport createLayoutFacade from \"./facades/layout\";\r\nimport taskLayers from \"./data_task_layers\";\r\n\r\nimport skin from \"./ui/skin\";\r\nimport skyblue from \"../css/skins/skyblue\";\r\nimport meadow from \"../css/skins/meadow\";\r\nimport terrace from \"../css/skins/terrace\";\r\nimport broadway from \"../css/skins/broadway\";\r\nimport material from \"../css/skins/material\";\r\nimport dark from \"../css/skins/dark\";\r\nimport contrast_black from \"../css/skins/contrast_black\";\r\nimport contrast_white from \"../css/skins/contrast_white\";\r\nimport plugins from \"./ui/plugins\";\r\nimport touch from \"./ui/touch\";\r\nimport lightbox from \"./ui/lightbox\";\r\nimport lightbox_optional_time from \"./ui/lightbox/lightbox_optional_time\";\r\nimport wai_aria from \"./ui/wai_aria\";\r\n\r\n\r\nexport default function(gantt) {\r\n\r\n\tif(!env.isNode){\r\n\r\n\t\tgantt.utils = {\r\n\t\t\tarrayFind: codeHelpers.arrayFind,\r\n\t\t\tdom: domHelpers\r\n\t\t};\r\n\r\n\t\tvar domEvents = domEventScope();\r\n\t\tgantt.event = domEvents.attach;\r\n\t\tgantt.eventRemove = domEvents.detach;\r\n\t\tgantt._eventRemoveAll = domEvents.detachAll;\r\n\t\tgantt._createDomEventScope = domEvents.extend;\r\n\r\n\t\tutils.mixin(gantt, messages(gantt));\r\n\t\tvar uiApi = ui.init(gantt);\r\n\t\tgantt.$ui = uiApi.factory;\r\n\t\tgantt.$ui.layers = uiApi.render;\r\n\t\tgantt.$mouseEvents = uiApi.mouseEvents;\r\n\t\tgantt.$services.setService(\"mouseEvents\", function () {\r\n\t\t\treturn gantt.$mouseEvents;\r\n\t\t});\r\n\t\tgantt.mixin(gantt, uiApi.layersApi);\r\n\r\n\t\ttaskLayers(gantt);\r\n\r\n\t\tgantt.$services.setService(\"layers\", function () {\r\n\t\t\treturn uiApi.layersService;\r\n\t\t});\r\n\r\n\t\tgantt.mixin(gantt, createLayoutFacade());\r\n\t\tskin(gantt);\r\n\t\tskyblue(gantt);\r\n\t\tdark(gantt);\r\n\t\tmeadow(gantt);\r\n\t\tterrace(gantt);\r\n\t\tbroadway(gantt);\r\n\t\tmaterial(gantt);\r\n\t\tcontrast_black(gantt);\r\n\t\tcontrast_white(gantt);\r\n\t\tplugins(gantt);\r\n\t\ttouch(gantt);\r\n\t\tlightbox(gantt);\r\n\t\tlightbox_optional_time(gantt);\r\n\t\twai_aria(gantt);\r\n\r\n\t\tgantt.locate = function(e) {\r\n\t\t\tvar trg = domHelpers.getTargetNode(e);\r\n\r\n\t\t\t// ignore empty rows/cells of the timeline\r\n\t\t\tif(domHelpers.closest(trg, \".gantt_task_row\")){\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tvar targetAttribute = arguments[1] || this.config.task_attribute;\r\n\r\n\t\t\tvar node = domHelpers.locateAttribute(trg, targetAttribute);\r\n\t\t\tif(node){\r\n\t\t\t\treturn node.getAttribute(targetAttribute);\r\n\t\t\t}else{\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tgantt._locate_css = function(e, classname, strict){\r\n\t\t\treturn domHelpers.locateClassName(e, classname, strict);\r\n\t\t};\r\n\r\n\t\tgantt._locateHTML = function(e, attribute) {\r\n\t\t\treturn domHelpers.locateAttribute(e, attribute || this.config.task_attribute);\r\n\t\t};\r\n\t}\r\n\r\n\tgantt.attachEvent(\"onParse\", function(){\r\n\t\tif(!isHeadless(gantt)){\r\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\r\n\t\t\t\tif(gantt.config.initial_scroll){\r\n\t\t\t\t\tvar firstTask = gantt.getTaskByIndex(0);\r\n\t\t\t\t\tvar id = firstTask ? firstTask.id : gantt.config.root_id;\r\n\t\t\t\t\t// GS-1450. Don't scroll to the task if there is no timeline\r\n\t\t\t\t\tif(gantt.isTaskExists(id) && gantt.$task && gantt.utils.dom.isChildOf(gantt.$task, gantt.$container)){\r\n\t\t\t\t\t\tgantt.showTask(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, {once: true});\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\r\n\t\tif (!this.config.scroll_size)\r\n\t\t\tthis.config.scroll_size = domHelpers.getScrollSize() || 15;\r\n\r\n\t\tif(!isHeadless(gantt)){\r\n\t\t\t// detach listeners before clearing old DOM, possible IE errors when accessing detached nodes\r\n\t\t\tthis._eventRemoveAll();\r\n\t\t\tthis.$mouseEvents.reset();\r\n\r\n\t\t\tthis.resetLightbox();\r\n\t\t}\r\n\r\n\t});\r\n\r\n\t// GS-1261: scroll the views to the right side when RTL is enabled\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tif(!isHeadless(gantt) && gantt.config.rtl){\r\n\t\t\tgantt.$layout.getCellsByType(\"viewCell\").forEach(function(cell){ \r\n\t\t\t\tvar attachedScrollbar = cell.$config.scrollX;\r\n\t\t\t\tif (!attachedScrollbar) return;\r\n\r\n\t\t\t\tvar scrollbar = gantt.$ui.getView(attachedScrollbar);\r\n\t\t\t\tif (scrollbar) scrollbar.scrollTo(scrollbar.$config.scrollSize,0);\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t// GS-1649: check if extensions are connected via files\r\n\tgantt.attachEvent(\"onGanttReady\", function(){\r\n\t\tif(!isHeadless(gantt)){\r\n\r\n\t\t\tvar activePlugins = gantt.plugins();\r\n\r\n\t\t\tvar availablePlugins = {\r\n\t\t\t\tauto_scheduling: gantt.autoSchedule,\r\n\t\t\t\tclick_drag: gantt.ext.clickDrag,\r\n\t\t\t\tcritical_path: gantt.isCriticalTask,\r\n\t\t\t\tdrag_timeline: gantt.ext.dragTimeline,\r\n\t\t\t\texport_api: gantt.exportToPDF,\r\n\t\t\t\tfullscreen: gantt.ext.fullscreen,\r\n\t\t\t\tgrouping: gantt.groupBy,\r\n\t\t\t\tkeyboard_navigation: gantt.ext.keyboardNavigation,\r\n\t\t\t\tmarker: gantt.addMarker,\r\n\t\t\t\tmultiselect: gantt.eachSelectedTask,\r\n\t\t\t\toverlay: gantt.ext.overlay,\r\n\t\t\t\tquick_info: gantt.templates.quick_info_content,\r\n\t\t\t\ttooltip: gantt.ext.tooltips,\r\n\t\t\t\tundo: gantt.undo\r\n\t\t\t};\r\n\r\n\t\t\tfor (let plugin in availablePlugins){\r\n\t\t\t\tif (availablePlugins[plugin] && !activePlugins[plugin]){\r\n\t\t\t\t\t// eslint-disable-next-line no-console\r\n\t\t\t\t\tconsole.warn(`You connected the '${plugin}' extension via an obsolete file. \r\nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};","export default function(gantt) {\r\n\tdelete gantt.addTaskLayer;\r\n\tdelete gantt.addLinkLayer;\r\n};","function createLayoutFacade(){\r\n\r\n\tfunction getTimeline(gantt){\r\n\t\treturn gantt.$ui.getView(\"timeline\");\r\n\t}\r\n\r\n\tfunction getGrid(gantt){\r\n\t\treturn gantt.$ui.getView(\"grid\");\r\n\t}\r\n\r\n\tfunction getBaseCell(gantt){\r\n\t\tvar timeline = getTimeline(gantt);\r\n\t\tif (timeline && !timeline.$config.hidden){\r\n\t\t\treturn timeline;\r\n\t\t} else{\r\n\t\t\tvar grid = getGrid(gantt);\r\n\t\t\tif (grid && !grid.$config.hidden){\r\n\t\t\t\treturn grid;\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getVerticalScrollbar(gantt){\r\n\t\tvar baseCell = null;\r\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\r\n\t\tvar gridDrag = false;\r\n\t\tvar gridMarkers = [\r\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\r\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\r\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\r\n\t\t];\r\n\t\tgridMarkers.forEach(function (selector) {\r\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\r\n\t\t});\r\n\t\tif (gridDrag){\r\n\t\t\tbaseCell = getGrid(gantt);\r\n\t\t} else{\r\n\t\t\tbaseCell = getBaseCell(gantt);\r\n\t\t}\r\n\r\n\t\t// GS-1827. If there is no grid and timeline, there is no scrollbar for them\r\n\t\tif (!baseCell){\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tvar verticalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollY\");\r\n\t\treturn verticalScrollbar;\r\n\t}\r\n\r\n\tfunction getHorizontalScrollbar(gantt){\r\n\t\tvar baseCell = getBaseCell(gantt);\r\n\t\tif (!baseCell || baseCell.id == \"grid\"){\r\n\t\t\treturn null; // if the timeline is not displayed, do not return the scrollbar\r\n\t\t}\r\n\t\tvar horizontalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollX\");\r\n\t\treturn horizontalScrollbar;\r\n\t}\r\n\r\n\tfunction getAttachedScrollbar(gantt, cell, type){\r\n\t\tvar attachedScrollbar = cell.$config[type];\r\n\t\tvar scrollbarView = gantt.$ui.getView(attachedScrollbar);\r\n\t\treturn scrollbarView;\r\n\t}\r\n\r\n\tvar DEFAULT_VALUE = \"DEFAULT_VALUE\";\r\n\r\n\tfunction tryCall(getView, method, args, fallback){\r\n\t\tvar view = getView(this);\r\n\t\tif (!(view && view.isVisible())) {\r\n\t\t\tif(fallback){\r\n\t\t\t\treturn fallback();\r\n\t\t\t}else{\r\n\t\t\t\treturn DEFAULT_VALUE;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn view[method].apply(view, args);\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\r\n\t\tgetColumnIndex: function(name) {\r\n\t\t\tvar res = tryCall.call(this, getGrid, \"getColumnIndex\", [name]);\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tdateFromPos: function(x) {\r\n\t\t\tvar res = tryCall.call(this, getTimeline, \"dateFromPos\", Array.prototype.slice.call(arguments));\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn this.getState().min_date;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tposFromDate: function(date) {\r\n\t\t\tvar res = tryCall.call(this, getTimeline, \"posFromDate\", [date]);\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetRowTop: function(index) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getRowTop\", [index],\r\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getRowTop\", [index]);}\r\n\t\t\t\t);\r\n\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetTaskTop: function(id) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemTop\", [id],\r\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemTop\", [id]);}\r\n\t\t\t);\r\n\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\tgetTaskPosition: function(task, start_date, end_date) {\r\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getItemPosition\", [task, start_date, end_date]);\r\n\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\tvar top = this.getTaskTop(task.id);\r\n\t\t\t\tvar height = this.getTaskBarHeight(task.id);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tleft: 0,\r\n\t\t\t\t\ttop: top,\r\n\t\t\t\t\theight: height,\r\n\t\t\t\t\twidth: 0\r\n\t\t\t\t};\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetTaskBarHeight: function(taskId, isMilestoneRender) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getBarHeight\", [taskId, isMilestoneRender],\r\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\r\n\t\t\t);\r\n\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetTaskHeight: function(taskId) {\r\n\t\t\tvar self = this;\r\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemHeight\", [taskId],\r\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\r\n\t\t\t);\r\n\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\tcolumnIndexByDate: function(date) {\r\n\t\t\tvar res = tryCall.call(this, getTimeline, \"columnIndexByDate\", [date]);\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn 0;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\troundTaskDates: function() {\r\n\t\t\ttryCall.call(this, getTimeline, \"roundTaskDates\", []);\r\n\t\t},\r\n\r\n\t\tgetScale: function() {\r\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getScale\", []);\r\n\t\t\tif(res === DEFAULT_VALUE){\r\n\t\t\t\treturn null;\r\n\t\t\t}else{\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tgetTaskNode: function(id) {\r\n\t\t\tvar timeline = getTimeline(this);\r\n\t\t\tif (!timeline || !timeline.isVisible()) {\r\n\t\t\t\treturn null;\r\n\t\t\t} else {\r\n\t\t\t\tvar node = timeline._taskRenderer.rendered[id];\r\n\t\t\t\tif(!node){\r\n\t\t\t\t\tvar domAttr = timeline.$config.item_attribute;\r\n\t\t\t\t\tnode = timeline.$task_bars.querySelector(\"[\" +domAttr+ \"='\"+id+\"']\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn node || null;\r\n\t\t\t}\r\n\t\t},\r\n\r\n\r\n\t\tgetLinkNode: function(id) {\r\n\t\t\tvar timeline = getTimeline(this);\r\n\t\t\tif (!timeline.isVisible()) {\r\n\t\t\t\treturn null;\r\n\t\t\t} else {\r\n\t\t\t\treturn timeline._linkRenderer.rendered[id];\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tscrollTo: function(left, top){\r\n\t\t\tvar vertical = getVerticalScrollbar(this);\r\n\t\t\tvar horizontal = getHorizontalScrollbar(this);\r\n\r\n\t\t\tvar oldH = {position: 0},\r\n\t\t\t\toldV = {position: 0};\r\n\r\n\t\t\tif(vertical){\r\n\t\t\t\toldV = vertical.getScrollState();\r\n\t\t\t}\r\n\t\t\tif(horizontal){\r\n\t\t\t\toldH = horizontal.getScrollState();\r\n\t\t\t}\r\n\r\n\t\t\tvar scrollHorizontal = (horizontal && left*1 == left);\r\n\t\t\tvar scrollVertical = (vertical && top*1 == top);\r\n\t\t\tvar scrollBoth = scrollHorizontal && scrollVertical;\r\n\r\n\t\t\tif(scrollBoth){\r\n\t\t\t\t// some views will be scrolled both horizontally and vertically and smart rendering can be called twice\r\n\t\t\t\t// set flag in order not to invoke smart rendering at the horizontal scroll stage\r\n\t\t\t\t// so it will repaint only once when the scroll is completed\r\n\t\t\t\tvar verticalViews = vertical._getLinkedViews();\r\n\t\t\t\tvar horizontalViews = horizontal._getLinkedViews();\r\n\r\n\t\t\t\tvar commonViews = [];\r\n\t\t\t\tfor(var i = 0; i < verticalViews.length; i++){\r\n\t\t\t\t\tfor(var j = 0; j < horizontalViews.length; j++){\r\n\r\n\t\t\t\t\t\tif(verticalViews[i].$config.id && horizontalViews[j].$config.id && verticalViews[i].$config.id === horizontalViews[j].$config.id){\r\n\t\t\t\t\t\t\tcommonViews.push(verticalViews[i].$config.id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (scrollHorizontal){\r\n\t\t\t\tif(commonViews){\r\n\t\t\t\t\tcommonViews.forEach((function(viewId){\r\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = true;\r\n\t\t\t\t\t}).bind(this));\r\n\t\t\t\t}\r\n\r\n\t\t\t\thorizontal.scroll(left);\r\n\t\t\t\tif(commonViews){\r\n\t\t\t\t\tcommonViews.forEach((function(viewId){\r\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = false;\r\n\t\t\t\t\t}).bind(this));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(scrollVertical){\r\n\t\t\t\tvertical.scroll(top);\r\n\t\t\t}\r\n\r\n\t\t\tvar newV = {position: 0},\r\n\t\t\t\tnewH = {position: 0};\r\n\t\t\tif(vertical){\r\n\t\t\t\tnewV = vertical.getScrollState();\r\n\t\t\t}\r\n\t\t\tif(horizontal){\r\n\t\t\t\tnewH = horizontal.getScrollState();\r\n\t\t\t}\r\n\r\n\t\t\tthis.callEvent(\"onGanttScroll\", [oldH.position, oldV.position, newH.position, newV.position]);\r\n\t\t},\r\n\r\n\t\tshowDate: function(date){\r\n\t\t\tvar date_x = this.posFromDate(date);\r\n\t\t\tvar scroll_to = Math.max(date_x - this.config.task_scroll_offset, 0);\r\n\t\t\tthis.scrollTo(scroll_to);\r\n\t\t},\r\n\t\tshowTask: function(id) {\r\n\t\t\tvar pos = this.getTaskPosition(this.getTask(id));\r\n\r\n\t\t\t// GS-1261: we need to show the start_date even in the RTL mode\r\n\t\t\tvar leftPos = pos.left;\r\n\t\t\tif (this.config.rtl) leftPos = pos.left + pos.width;\r\n\r\n\t\t\tvar left = Math.max(leftPos - this.config.task_scroll_offset, 0);\r\n\r\n\t\t\tvar dataHeight = this._scroll_state().y;\r\n\t\t\tvar top;\r\n\t\t\tif(!dataHeight){\r\n\t\t\t\ttop = pos.top;\r\n\t\t\t}else{\r\n\t\t\t\ttop = pos.top - (dataHeight - this.getTaskBarHeight(id))/2;\r\n\t\t\t}\r\n\r\n\t\t\tthis.scrollTo(left, top);\r\n\t\t\t// GS-1150: if the grid and timeline have different scrollbars, we need to scroll thegrid to show the task\r\n\t\t\tvar gridCell = getGrid(this);\r\n\t\t\tvar timelineCell = getTimeline(this);\r\n\t\t\tif (gridCell && timelineCell && gridCell.$config.scrollY != timelineCell.$config.scrollY){\r\n\t\t\t\tvar gridScrollbar = getAttachedScrollbar(this, gridCell, \"scrollY\");\r\n\t\t\t\tgridScrollbar.scrollTo(null, top);\r\n\t\t\t}\r\n\t\t},\r\n\t\t_scroll_state: function(){\r\n\t\t\tvar result = {\r\n\t\t\t\tx: false,\r\n\t\t\t\ty: false,\r\n\t\t\t\tx_pos: 0,\r\n\t\t\t\ty_pos: 0,\r\n\t\t\t\tscroll_size: this.config.scroll_size + 1,//1px for inner content\r\n\t\t\t\tx_inner: 0,\r\n\t\t\t\ty_inner: 0\r\n\t\t\t};\r\n\r\n\t\t\tvar scrollVer = getVerticalScrollbar(this),\r\n\t\t\t\tscrollHor = getHorizontalScrollbar(this);\r\n\t\t\tif(scrollHor){\r\n\t\t\t\tvar horState = scrollHor.getScrollState();\r\n\t\t\t\tif(horState.visible){\r\n\t\t\t\t\tresult.x = horState.size;\r\n\t\t\t\t\tresult.x_inner = horState.scrollSize;\r\n\t\t\t\t}\r\n\t\t\t\tresult.x_pos = horState.position || 0;\r\n\t\t\t}\r\n\r\n\t\t\tif(scrollVer){\r\n\t\t\t\tvar verState = scrollVer.getScrollState();\r\n\t\t\t\tif(verState.visible){\r\n\t\t\t\t\tresult.y = verState.size;\r\n\r\n\t\t\t\t\tresult.y_inner = verState.scrollSize;\r\n\t\t\t\t}\r\n\t\t\t\tresult.y_pos = verState.position || 0;\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tgetScrollState: function(){\r\n\t\t\tvar state = this._scroll_state();\r\n\t\t\treturn { x:state.x_pos, y:state.y_pos, inner_width:state.x, inner_height:state.y, width: state.x_inner, height: state.y_inner };\r\n\t\t},\r\n\r\n\t\tgetLayoutView: function(cellName){\r\n\t\t\treturn this.$ui.getView(cellName);\r\n\t\t},\r\n\r\n\t\tscrollLayoutCell: function(cellName, left, top){\r\n\t\t\tconst cell = this.$ui.getView(cellName);\r\n\t\t\tif (!cell){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (left !== null){\r\n\t\t\t\tconst horizontalScroll = this.$ui.getView(cell.$config.scrollX);\r\n\t\t\t\tif (horizontalScroll){\r\n\t\t\t\t\thorizontalScroll.scrollTo(left, null);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (top !== null){\r\n\t\t\t\tconst verticalScroll = this.$ui.getView(cell.$config.scrollY);\r\n\t\t\t\tif (verticalScroll){\r\n\t\t\t\t\tverticalScroll.scrollTo(null, top);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t};\r\n\r\n}\r\n\r\nexport default createLayoutFacade;","export default function(gantt) {\r\ngantt.skins.skyblue = {\r\n\tconfig:{\r\n\t\tgrid_width:370,\r\n\t\trow_height: 27,\r\n\t\tbar_height_padding:4,\r\n\t\tscale_height: 27,\r\n\t\tlink_line_width:1,\r\n\t\tlink_arrow_size:8,\r\n\t\tlink_radius:2,\r\n\t\tlightbox_additional_height:75\r\n\t},\r\n\t_second_column_width:95,\r\n\t_third_column_width:80\r\n};\r\n\r\n};","export default function(gantt) {\r\ngantt.skins.dark = {\r\n\tconfig:{\r\n\t\tgrid_width:390,\r\n\t\trow_height: 36,\r\n\t\tscale_height: 36,\r\n\t\tlink_line_width:2,\r\n\t\tlink_arrow_size:12,\r\n\t\tbar_height_padding:9,\r\n\t\tlightbox_additional_height:75\r\n\t},\r\n\t_second_column_width:100,\r\n\t_third_column_width:70\t\t\r\n};\r\n\r\n};","export default function(gantt) {\r\ngantt.skins.meadow = {\r\n\tconfig:{\r\n\t\tgrid_width:380,\r\n\t\trow_height: 27,\r\n\t\tscale_height: 30,\r\n\t\tlink_line_width:2,\r\n\t\tlink_arrow_size:10,\r\n\t\tbar_height_padding:4,\r\n\t\tlightbox_additional_height:72\r\n\t},\r\n\t_second_column_width:95,\r\n\t_third_column_width:80\r\n};\r\n\r\n};","export default function(gantt) {\r\ngantt.skins.terrace = {\r\n\tconfig:{\r\n\t\tgrid_width:390,\r\n\t\trow_height: 36,\r\n\t\tscale_height: 36,\r\n\t\tlink_line_width:2,\r\n\t\tlink_arrow_size:12,\r\n\t\tbar_height_padding:9,\r\n\t\tlightbox_additional_height:75\r\n\t},\r\n\t_second_column_width:100,\r\n\t_third_column_width:70\t\t\r\n};\r\n\r\n};","export default function(gantt) {\r\n\tgantt.skins.broadway = {\r\n\t\tconfig: {\r\n\t\t\tgrid_width: 390,\r\n\t\t\trow_height: 35,\r\n\t\t\tscale_height: 35,\r\n\t\t\tlink_line_width: 1,\r\n\t\t\tlink_arrow_size: 9,\r\n\t\t\tbar_height_padding:4,\r\n\t\t\tlightbox_additional_height: 86\r\n\t\t},\r\n\t\t_second_column_width: 100,\r\n\t\t_third_column_width: 80,\r\n\r\n\t\t_lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\r\n\t\t_config_buttons_left: {},\r\n\t\t_config_buttons_right: {\r\n\t\t\t\"gantt_delete_btn\": \"icon_delete\",\r\n\t\t\t\"gantt_save_btn\": \"icon_save\"\r\n\t\t}\r\n\t};\r\n};","export default function(gantt) {\r\n\tgantt.skins.material = {\r\n\t\tconfig: {\r\n\t\t\tgrid_width: 411,\r\n\t\t\trow_height: 34,\r\n\t\t\tscale_height: 36,\r\n\t\t\tlink_line_width: 2,\r\n\t\t\tlink_arrow_size: 12,\r\n\t\t\tbar_height_padding:9,\r\n\t\t\tlightbox_additional_height: 80\r\n\t\t},\r\n\t\t_second_column_width: 110,\r\n\t\t_third_column_width: 75,\r\n\t\t_redefine_lightbox_buttons: {\r\n\t\t\t\"buttons_left\": [\"dhx_delete_btn\"],\r\n\t\t\t\"buttons_right\": [\"dhx_cancel_btn\", \"dhx_save_btn\"]\r\n\t\t}\r\n\t};\r\n\r\n\tgantt.attachEvent(\"onAfterTaskDrag\", function (id) {\r\n\t\tvar t = gantt.getTaskNode(id);\r\n\t\tif (t) {\r\n\t\t\tt.className += \" gantt_drag_animation\";\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tvar indx = t.className.indexOf(\" gantt_drag_animation\");\r\n\t\t\t\tif (indx > -1) {\r\n\t\t\t\t\tt.className = t.className.slice(0, indx);\r\n\t\t\t\t}\r\n\t\t\t}, 200);\r\n\t\t}\r\n\t});\r\n\r\n};","export default function(gantt) {\r\ngantt.skins[\"contrast_black\"] = {\r\n\tconfig:{\r\n\t\tgrid_width:390,\r\n\t\trow_height: 35,\r\n\t\tscale_height: 35,\r\n\t\tlink_line_width:2,\r\n\t\tlink_arrow_size:12,\r\n\t\tlightbox_additional_height:75\r\n\t},\r\n\t_second_column_width:100,\r\n\t_third_column_width:80\r\n};\r\n\r\n};","export default function(gantt) {\r\ngantt.skins[\"contrast_white\"] = {\r\n\tconfig:{\r\n\t\tgrid_width:390,\r\n\t\trow_height: 35,\r\n\t\tscale_height: 35,\r\n\t\tlink_line_width:2,\r\n\t\tlink_arrow_size:12,\r\n\t\tlightbox_additional_height:75\r\n\t},\r\n\t_second_column_width:100,\r\n\t_third_column_width:80\r\n};\r\n\r\n};","import autoscroll from \"./autoscroll\";\r\nimport jquery_hooks from \"./jquery_hooks\";\r\nimport dhtmlx_hooks from \"./dhtmlx_hooks\";\r\nimport TimelineZoom from \"./timeline_zoom\";\r\n\r\n\r\nexport default function(gantt){\r\n\tif(!gantt.ext){\r\n\t\tgantt.ext = {};\r\n\t}\r\n\r\n\tvar modules = [\r\n\t\tautoscroll,\r\n\t\tjquery_hooks,\r\n\t\tdhtmlx_hooks\r\n\t];\r\n\r\n\tfor(var i = 0; i < modules.length; i++){\r\n\t\tif(modules[i])\r\n\t\t\tmodules[i](gantt);\r\n\t}\r\n\r\n\tgantt.ext.zoom = new TimelineZoom(gantt);\r\n};","export default function(gantt) {\r\n\r\n\tgantt._extend_to_optional = function (lightbox_block) {\r\n\r\n\t\tvar duration = lightbox_block;\r\n\t\tvar optional_time = {\r\n\t\t\trender: duration.render,\r\n\t\t\tfocus: duration.focus,\r\n\t\t\tset_value: function (node, value, task, section) {\r\n\t\t\t\tvar mapping = gantt._resolve_default_mapping(section);\r\n\t\t\t\tif (!task[mapping.start_date] || (mapping.start_date == \"start_date\" && this._isAllowedUnscheduledTask(task))) {\r\n\t\t\t\t\toptional_time.disable(node, section);\r\n\t\t\t\t\tvar val = {};\r\n\r\n\t\t\t\t\tfor (var i in mapping) {\r\n\t\t\t\t\t\t//take default values from the time control from task start/end dates\r\n\t\t\t\t\t\tval[mapping[i]] = task[i];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, val, section);//set default value\r\n\t\t\t\t} else {\r\n\t\t\t\t\toptional_time.enable(node, section);\r\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, task, section);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tget_value: function (node, task, section) {\r\n\t\t\t\tif (section.disabled) {\r\n\t\t\t\t\treturn {start_date: null};\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn duration.get_value.call(gantt, node, task, section);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupdate_block: function (node, section) {\r\n\t\t\t\tgantt.callEvent(\"onSectionToggle\", [gantt._lightbox_id, section]);\r\n\t\t\t\tnode.style.display = section.disabled ? \"none\" : \"\";\r\n\r\n\t\t\t\tif (section.button) {\r\n\t\t\t\t\tvar button = node.previousSibling.querySelector(\".gantt_custom_button_label\"),\r\n\t\t\t\t\t\tlabels = gantt.locale.labels;\r\n\r\n\t\t\t\t\tvar button_text = section.disabled ? labels[section.name + \"_enable_button\"] : labels[section.name + \"_disable_button\"];\r\n\r\n\t\t\t\t\tbutton.innerHTML = button_text;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdisable: function (node, section) {\r\n\t\t\t\tsection.disabled = true;\r\n\t\t\t\toptional_time.update_block(node, section);\r\n\r\n\t\t\t},\r\n\t\t\tenable: function (node, section) {\r\n\t\t\t\tsection.disabled = false;\r\n\t\t\t\toptional_time.update_block(node, section);\r\n\t\t\t},\r\n\t\t\tbutton_click: function (index, el, section, container) {\r\n\t\t\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar config = gantt._get_typed_lightbox_config()[index];\r\n\t\t\t\tif (config.disabled) {\r\n\t\t\t\t\toptional_time.enable(container, config);\r\n\t\t\t\t} else {\r\n\t\t\t\t\toptional_time.disable(container, config);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn optional_time;\r\n\t};\r\n\r\n\tgantt.form_blocks.duration_optional = gantt._extend_to_optional(gantt.form_blocks.duration);\r\n\tgantt.form_blocks.time_optional = gantt._extend_to_optional(gantt.form_blocks.time);\r\n\r\n};","export default function(gantt){\r\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\r\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\r\n\r\n\tfunction stripHTMLLite(htmlText){\r\n\t\treturn (htmlText + \"\")\r\n\t\t\t.replace(htmlTags, \" \").\r\n\t\t\treplace(extraSpaces, \" \");\r\n\t}\r\n\r\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\r\n\tfunction escapeQuotes(text){\r\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\r\n\t}\r\n\r\n\tgantt._waiAria = {\r\n\t\tgetAttributeString: function(attr){\r\n\t\t\tvar attributes = [\" \"];\r\n\t\t\tfor(var i in attr){\r\n\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\r\n\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\r\n\t\t\t}\r\n\t\t\tattributes.push(\" \");\r\n\t\t\treturn attributes.join(\" \");\r\n\r\n\t\t},\r\n\r\n\t\tgetTimelineCellAttr:function(dateString){\r\n\r\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": dateString});\r\n\t\t},\r\n\r\n\t\t_taskCommonAttr: function(task, div){\r\n\r\n\t\t\tif(!(task.start_date && task.end_date))\r\n\t\t\t\treturn;\r\n\r\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(gantt.templates.tooltip_text(task.start_date, task.end_date, task)));\r\n\r\n\t\t\tif(task.$dataprocessor_class){\r\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tsetTaskBarAttr: function(task, div){\r\n\t\t\tthis._taskCommonAttr(task, div);\r\n\r\n\t\t\t// task bars are complex elements that should be treated as a single element\r\n\t\t\tdiv.setAttribute(\"role\", \"img\");\r\n\r\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.drag_move){\r\n\t\t\t\tif(task.id != gantt.getState(\"tasksDnd\").drag_id){\r\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\ttaskRowAttr: function(task, div){\r\n\r\n\t\t\tthis._taskCommonAttr(task, div);\r\n\r\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.order_branch){\r\n\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\r\n\t\t\t}\r\n\r\n\t\t\tdiv.setAttribute(\"role\", \"row\");\r\n\t\t\t// selected attribute should be added only to the grid  because\r\n\t\t\t// other parts don't have the keyboard navigation\r\n\t\t\tdiv.setAttribute(\"aria-selected\", gantt.isSelectedTask(task.id) ? \"true\" : \"false\");\r\n\r\n\t\t\t// allowed values start from 1, set 1 for non-tree datastores\r\n\t\t\tdiv.setAttribute(\"aria-level\", task.$level + 1 || 1);\r\n\r\n\t\t\tif(gantt.hasChild(task.id)){\r\n\t\t\t\tdiv.setAttribute(\"aria-expanded\", task.$open ? \"true\" : \"false\");\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tlinkAttr: function(link, div){\r\n\r\n\t\t\tvar linkTypes = gantt.config.links;\r\n\r\n\t\t\tvar toStart = link.type == linkTypes.finish_to_start || link.type == linkTypes.start_to_start;\r\n\t\t\tvar fromStart = link.type == linkTypes.start_to_start || link.type == linkTypes.start_to_finish;\r\n\r\n\t\t\tvar content = gantt.locale.labels.link + \" \" +  gantt.templates.drag_link(link.source, fromStart, link.target, toStart);\r\n\r\n\t\t\t// links are complex elements that should be treated as a single element\r\n\t\t\tdiv.setAttribute(\"role\", \"img\");\r\n\r\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(content));\r\n\t\t},\r\n\r\n\t\tgridSeparatorAttr: function(div){\r\n\t\t\t// the only valid role for the grid header\r\n\t\t\tdiv.setAttribute(\"role\", \"columnheader\");\r\n\t\t},\r\n\t\trowResizerAttr: function(div){\r\n\t\t\t// the only valid role for the grid header\r\n\t\t\tdiv.setAttribute(\"role\", \"row\");\r\n\t\t},\r\n\r\n\t\tlightboxHiddenAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\r\n\t\t},\r\n\r\n\t\tlightboxVisibleAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\r\n\t\t},\r\n\r\n\t\tlightboxAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\r\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\r\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\r\n\t\t\tdiv.firstChild.setAttribute(\"aria-level\", \"1\");\r\n\t\t},\r\n\r\n\t\tlightboxButtonAttrString:function(buttonName){\r\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":gantt.locale.labels[buttonName], \"tabindex\":\"0\"});\r\n\t\t},\r\n\r\n\t\tlightboxHeader: function(div, headerText){\r\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\r\n\t\t},\r\n\r\n\t\tlightboxSelectAttrString: function(time_option){\r\n\t\t\tvar label = \"\";\r\n\r\n\t\t\tswitch (time_option) {\r\n\t\t\t\tcase \"%Y\":\r\n\t\t\t\t\tlabel = gantt.locale.labels.years;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%m\":\r\n\t\t\t\t\tlabel = gantt.locale.labels.months;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%d\":\r\n\t\t\t\t\tlabel = gantt.locale.labels.days;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"%H:%i\":\r\n\t\t\t\t\tlabel = gantt.locale.labels.hours + gantt.locale.labels.minutes;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": label});\r\n\t\t},\r\n\r\n\t\tlightboxDurationInputAttrString: function(section){\r\n\t\t\treturn this.getAttributeString({\r\n\t\t\t\t\"aria-label\": gantt.locale.labels.column_duration,\r\n\t\t\t\t\"aria-valuemin\": \"0\",\r\n\t\t\t\t\"role\": \"spinbutton\"\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tinlineEditorAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"row\");\r\n\t\t},\r\n\r\n\t\tgridAttrString: function(){\r\n\t\t\treturn [\" role='treegrid'\", gantt.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\r\n\t\t},\r\n\r\n\r\n\t\tgridScaleRowAttrString: function(){\r\n\t\t\treturn \"role='row'\";\r\n\t\t},\r\n\r\n\t\tgridScaleCellAttrString: function(column, label){\r\n\t\t\tvar attrs = \"\";\r\n\t\t\tif(column.name == \"add\"){\r\n\t\t\t\t// a more precise role is button, but it is not valid for the grid header\r\n\t\t\t\tattrs = this.getAttributeString({\"role\":\"columnheader\", \"aria-label\": gantt.locale.labels.new_task});\r\n\t\t\t}else{\r\n\r\n\t\t\t\tvar attributes = {\r\n\t\t\t\t\t\"role\":\"columnheader\",\r\n\t\t\t\t\t\"aria-label\": gantt.config.external_render && gantt.config.external_render.isElement(label) ? \"\" : label\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif(gantt._sort && gantt._sort.name == column.name){\r\n\t\t\t\t\tif(gantt._sort.direction == \"asc\"){\r\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"ascending\";\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"descending\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tattrs = this.getAttributeString(attributes);\r\n\t\t\t}\r\n\t\t\treturn attrs;\r\n\t\t},\r\n\r\n\t\tgridDataAttrString: function(){\r\n\t\t\treturn \"role='rowgroup'\";\r\n\t\t},\r\n\r\n\t\treorderMarkerAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"grid\");\r\n\t\t\tdiv.firstChild.removeAttribute(\"aria-level\");\r\n\t\t\tdiv.firstChild.setAttribute(\"aria-grabbed\", \"true\");\r\n\t\t},\r\n\r\n\t\tgridCellAttrString: function(column, textValue, task){\r\n\t\t\tvar attributes = {\"role\":\"gridcell\", \"aria-label\": textValue};\r\n\t\t\tif(!column.editor || gantt.isReadonly(task)){\r\n\t\t\t\tattributes[\"aria-readonly\"] = true;\r\n\t\t\t}\r\n\r\n\t\t\treturn this.getAttributeString(attributes);\r\n\t\t},\r\n\r\n\t\tgridAddButtonAttrString: function(column){\r\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\": gantt.locale.labels.new_task});\r\n\t\t},\r\n\r\n\t\tmessageButtonAttrString: function(buttonLabel){\r\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\r\n\t\t},\r\n\r\n\t\tmessageInfoAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\r\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\r\n\t\t},\r\n\r\n\t\tmessageModalAttr: function(div, uid){\r\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\r\n\t\t\tif(uid){\r\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\r\n\t\t\t}\r\n\r\n\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\r\n\t\t},\r\n\r\n\t\tquickInfoAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\r\n\t\t},\r\n\r\n\t\tquickInfoHeaderAttrString: function(){\r\n\t\t\treturn \" role='heading' aria-level='1' \";\r\n\t\t},\r\n\r\n\t\tquickInfoHeader: function(div, header){\r\n\t\t\tdiv.setAttribute(\"aria-label\", header);\r\n\t\t},\r\n\r\n\t\tquickInfoButtonAttrString: function(label){\r\n\t\t\treturn gantt._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\r\n\t\t},\r\n\r\n\t\ttooltipAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\r\n\t\t},\r\n\r\n\t\ttooltipVisibleAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\r\n\t\t},\r\n\r\n\t\ttooltipHiddenAttr: function(div){\r\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\r\n\t\t}\r\n\t};\r\n\r\n\tfunction isDisabled(){\r\n\t\treturn !gantt.config.wai_aria_attributes;\r\n\t}\r\n\r\n\tfor(var i in gantt._waiAria){\r\n\t\tgantt._waiAria[i] = (function(payload){\r\n\t\t\treturn function(){\r\n\t\t\t\tif(isDisabled()){\r\n\t\t\t\t\treturn \"\";\r\n\t\t\t\t}\r\n\t\t\t\treturn payload.apply(this, arguments);\r\n\t\t\t};\r\n\t\t})(gantt._waiAria[i]);\r\n\t}\r\n\r\n\r\n};","import extensions from \"./ext/extensions_gpl\";\r\nimport base from \"./factory/make_instance_web\";\r\nimport scope from \"./utils/global\";\r\nconst gantt = (scope as any).gantt = base(extensions);\r\n\r\nexport default gantt;\r\nexport { gantt };","import \"../css/dhtmlxgantt.less\";\r\n\r\nimport factory from \"./make_instance_common\";\r\nimport ui from \"../core/ui_core\";\r\nimport ajaxLoading from \"../core/loading/ajax_loading\";\r\nimport dynamicLoading from \"../core/loading/dynamic_loading\";\r\n\r\nexport default function(supportedExtensions) {\r\n\tvar gantt = factory(supportedExtensions);\r\n\r\n\tif(!gantt.env.isNode){\r\n\t\tui(gantt);\r\n\t\tajaxLoading(gantt);\r\n\t\tdynamicLoading(gantt);\r\n\t}\r\n\r\n\treturn gantt;\r\n};","export default function(gantt) {\r\n\tgantt.load = function (url, type, callback) {\r\n\t\tthis._load_url = url;\r\n\t\tthis.assert(arguments.length, \"Invalid load arguments\");\r\n\r\n\t\tvar tp = 'json', cl = null;\r\n\t\tif (arguments.length >= 3) {\r\n\t\t\ttp = type;\r\n\t\t\tcl = callback;\r\n\t\t} else {\r\n\t\t\tif (typeof arguments[1] == \"string\")\r\n\t\t\t\ttp = arguments[1];\r\n\t\t\telse if (typeof arguments[1] == \"function\")\r\n\t\t\t\tcl = arguments[1];\r\n\t\t}\r\n\r\n\t\tthis._load_type = tp;\r\n\r\n\t\tthis.callEvent(\"onLoadStart\", [url, tp]);\r\n\r\n\t\treturn this.ajax.get(url, gantt.bind(function (l) {\r\n\t\t\tthis.on_load(l, tp);\r\n\t\t\tthis.callEvent(\"onLoadEnd\", [url, tp]);\r\n\t\t\tif (typeof cl == \"function\")\r\n\t\t\t\tcl.call(this);\r\n\t\t}, this));\r\n\t};\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}